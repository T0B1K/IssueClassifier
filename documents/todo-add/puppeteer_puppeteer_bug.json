[{"labels":[null,"bug"],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version:3.0.1\r\n* Platform / OS version:docker (FROM:node:14.0.0-buster)\r\n* URLs (if applicable):\r\n* Node.js version: 14.0.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1. Upgrade node image from 13.13.0 -> 14.0.0\r\n2. Run same codebase (`puppeteer.launch()`)\r\n\r\n**What is the expected result?**\r\ncode runs without issues, just like on 13.13.0\r\n\r\n**What happens instead?**\r\n`Error: Failed to launch the browser process! spawn /opt/app/node_modules/puppeteer/.local-chromium/linux-737027/chrome-linux/chrome ENOENT`\r\n"},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 2.1.1\r\n* Platform / OS version: macOS\r\n* URLs (if applicable): hire.lever.co/candidates (not public)\r\n* Node.js version: 12.16.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1. Try to upload a file using elementHandle.uploadFile\r\n2. It loads the file internally as a data URL before uploading the file\r\n3. Look at the website's console log where we see the CSP error\r\n\r\n![983029b6-b249-4e09-ba2d-32f6aa0a5163](https://user-images.githubusercontent.com/1330677/76650919-c6fc3e00-6520-11ea-9b23-d39d32a53b49.png)\r\n\r\n\r\n**What is the expected result?**\r\nFile gets uploaded properly and is not blocked by CSP\r\n\r\n\r\nI think this might be outside the scope of puppeteer team but I was wondering if there are ways to get around this. Thanks!"},{"labels":[null,"bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 2.1.0\r\n* Platform / OS version: any\r\n* URLs (if applicable): any which shows a file input dialog box\r\n* Node.js version: ~12\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n- Run following script\r\n```\r\nconst puppeteer = require(\"puppeteer\");\r\n\r\n(async () => {\r\n\tconst browser = await puppeteer.launch({ headless: false });\r\n\tconst page = await browser.newPage();\r\n\tawait page.goto(\"https://cgi-lib.berkeley.edu/ex/fup.html\", {\r\n\t\twaitUntil: \"networkidle2\"\r\n\t});\r\n})();\r\n\r\n```\r\n- Click on the \"choose file\" button\r\n\r\nExpectation: A file chooser dialog will appear\r\nResult: Dialog box doesn't appear\r\nEnd issue: Any upload that requires file chooser dialog breaks.\r\nPossible reason: New changes with #5196\r\n\r\nNOTE: It works fine with 2.0.0 release."},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 2.0\r\n* Platform / OS version: Windows\r\n* URLs (if applicable): None\r\n* Node.js version: \r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1. Change the chromium revision to 725038\r\n2. Run HEADFUL tests\r\n\r\n**What is the expected result?**\r\nIt should be green.\r\n\r\n**What happens instead?**\r\n\"headless should be able to read cookies written by headful\" fails.\r\n"},{"labels":["bug"],"text":"With https://crrev.com/683391, chrome no longer throws exceptions when not executing inline script tags due to CSP.\r\n\r\nWe can fix this with probing runtime first - checking if inline scripts have any power. Alternatively, we might want to check current page CSP policy."},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\nhttps://try-puppeteer.appspot.com/\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nhttps://jsbin.com/leruqutesi/2\r\n\r\n```html\r\n<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n    <title>Example</title>\r\n  </head>\r\n  <body>\r\n    <select onchange=\"location.href = 'https://example.com'\">\r\n      <option selected value=\"here\">Here</option>\r\n      <option value=\"there\">There</option>\r\n    </select>\r\n  </body>\r\n</html>\r\n```\r\n\r\nPuppeteer\r\n\r\n```js\r\nconst browser = await puppeteer.launch();\r\n\r\nconst page = await browser.newPage();\r\nawait page.goto('https://jsbin.com/leruqutesi/2');\r\n\r\nawait Promise.all([\r\n  page.waitForNavigation(),\r\n  page.select('select', 'there'),\r\n]);\r\n\r\nconsole.log('success');\r\n\r\nawait browser.close();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\n\"success\" is printed.\r\n\r\n**What happens instead?**\r\n\r\nFrequently (say, 50% of the time), there is an error:\r\n\r\n> Error running your code. Error: Protocol error (Runtime.callFunctionOn): Cannot find context with specified id\r\n\r\n---\r\n\r\nOddly enough  #1591 suggests that this can happen when `page.evaluate` is combined with page navigation.\r\n\r\nI'm not using `page.evaluate`. **But if I do use** `page.evaluate`, then the error **doesn't** happen. \r\n\r\n```js\r\nconst browser = await puppeteer.launch();\r\n\r\nconst page = await browser.newPage();\r\nawait page.goto('https://jsbin.com/leruqutesi/2');\r\n\r\nawait Promise.all([\r\n  page.waitForNavigation(),\r\n  page.evaluate(() => {\r\n    const select = document.querySelector('select');\r\n    select.value = 'there';\r\n    select.dispatchEvent(new Event('change'));\r\n  }),\r\n]);\r\n\r\nconsole.log('success');\r\n\r\nawait browser.close();\r\n```\r\n\r\nAlso, writing the equivalent code for Selenium/WebDriver also fixes the problem."},{"labels":["bug",null,null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.17.0\r\n* Platform / OS version: Mac OS 10.14.5\r\n* URLs (if applicable): no need\r\n* Node.js version: v9.6.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nKeep running the code below will cause memory raising slowly. It seams unusual and I don't how to fix it.\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\npuppeteer.launch({headless : false}).then(async browser => {\r\n\r\n    while (true){\r\n\r\n        let context = await browser.createIncognitoBrowserContext();\r\n        await context.close();\r\n    }\r\n});\r\n```\r\n\r\n**What is the expected result?**\r\nThe memory should be stable.\r\n\r\n**What happens instead?**\r\nBut it's keeping raising."},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.17.0\r\n* Platform / OS version: WSL (Bash on Windows)\r\n* Node.js version: v12.4.0\r\n\r\n**What steps will reproduce the problem?**\r\n```js\r\nconst clickAndWait = function(container, target, btn) {\r\n    return container.evaluate((target, btnNext) => {\r\n        return new Promise((resolve, reject) => {\r\n            let observer = new MutationObserver(function() {\r\n                observer.disconnect(); // use the mutation observer only once\r\n                resolve();\r\n            });\r\n            observer.observe(target, { childList: true, subtree: true, });\r\n\r\n            // some reasonable timeout, in case loading got stuck\r\n            setTimeout(reject.bind(this, 'timeout'), 5000);\r\n\r\n            // puppeteer click() doesn't work, must use native click() in eval\r\n            btn.click();\r\n        });\r\n    }, target, btn);\r\n};\r\n\r\nawait ph.clickAndWait(iframe, someContainer, btnNext);\r\n````\r\n\r\n**What is the expected result?**\r\nThe function evaluates, `MutationObserver` is set up, the button is clicked, `MutationObserver` resolves the Promise and `await` proceeds.\r\n\r\n**What happens instead?**\r\nError:\r\n````\r\n(node:4335) UnhandledPromiseRejectionWarning: Error: Evaluation failed: [object Object]\r\n    at ExecutionContext._evaluateInternal (/d/DATA/WDH/Webseite/workspaces/Ari/www/application/noch-frei/crawl/puppeteer-launch/node_modules/puppeteer/lib/ExecutionContext.js:122:13)\r\n\r\n(node:4335) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block or by rejecting a promise which was not handled with .catch(). (rejection id: 1)\r\n(node:4335) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n````\r\nHow to catch the Promise exception and log the `Object` so I can read the error messages or at least find out what failed during the evaluation?\r\n\r\nAlso, this helper method worked in the past, after changing some of \r\nthe code and moving its invocations, this error occurs."},{"labels":["bug",null,null],"text":"I'm trying to install `puppeteer` on Linux and was shocked by the Chromium size:\r\n\r\n```sh\r\n\r\nnpm i puppeteer@1.17.0\r\n\r\nDownloading Chromium r662092 - **111.6 Mb**\r\n```\r\n\r\n```sh\r\n\r\nnpm i puppeteer@1.18.0\r\n\r\nDownloading Chromium r669486 - **347.1 Mb**\r\n```\r\n\r\nIs Chromium growing so rapidly or is it a bug?"},{"labels":["bug",null,null],"text":"Puppeteer: v1.17.0\r\n\r\nConsider the following code snippet:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\nasync function logRetainedArrays(page) {\r\n  const prototypeHandle = await page.evaluateHandle(() => Array.prototype);\r\n  const instancesHandle = await page.queryObjects(prototypeHandle);\r\n  const retainedArrays = await page.evaluate(instances => instances, instancesHandle);\r\n  console.log(retainedArrays);\r\n  await instancesHandle.dispose();\r\n}\r\n\r\n(async() => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage();\r\n  await page.evaluate(() => {\r\n    window.returnAnArray = () => [42];\r\n    returnAnArray();\r\n  });\r\n  await logRetainedArrays(page);  // [ [ 42 ] ]\r\n  await logRetainedArrays(page);  // [ [ 42 ] ]\r\n  await logRetainedArrays(page);  // [ ]\r\n  await browser.close();\r\n})();\r\n```"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version:1.17.0\r\n* Platform / OS version: Ubuntu 18.04.1 LTS and OSx 10.14\r\n* URLs:\r\n  - https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md\r\n  - https://pastebin.com/XcHLqyNC\r\n* Node.js version: 8.15\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nRun this code\r\n```\r\nconst puppeteer = require(\"puppeteer\");\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch({ headless: false });\r\n  const page = await browser.newPage();\r\n  await page.setViewport({\r\n    width: 1920,\r\n    height: 1080\r\n  });\r\n\r\n  await page.goto(\r\n    \"https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md\",\r\n    {\r\n      waitUntil: \"networkidle0\",\r\n      timeout: 0\r\n    }\r\n  );\r\n\r\n  await page.screenshot({\r\n    path: \"check-this-screenshot.png\",\r\n    fullPage: true\r\n  });\r\n\r\n  await browser.close();\r\n})();\r\n\r\n```\r\n**What is the expected result?**\r\nOne should get a full page screenshot in both the scenario:\r\n1. `headless: true`\r\n1. `headless: false`\r\n\r\n**What happens instead?**\r\n1. `headless: true`: getting the correct full page screenshot\r\n1. `headless: false`: getting the blank screenshot/No screenshot"},{"labels":["bug",null,null],"text":"I receive the following error when I try to run the following example using puppeteer-firefox version 0.5.0:\r\n```\r\nconst pptrFirefox = require('puppeteer-firefox');\r\n(async () => {\r\n  const browser = await pptrFirefox.launch({headless: false});\r\n  const page = await browser.newPage();\r\n  await page.goto('https://www.google.com');\r\n  await page.setCookie({name: 'mycookie', value: 'myvalue'});\r\n})();\r\n\r\n```\r\n\r\n```\r\n$ node sample.js \r\n(node:92226) UnhandledPromiseRejectionWarning: Error: Protocol error (Browser.deleteCookies): ERROR: failed to call method 'Browser.deleteCookies' with parameters {\r\n  \"browserContextId\": null,\r\n  \"cookies\": [\r\n    {\r\n      \"url\": \"https://www.google.com/\",\r\n      \"name\": \"mycookie\"\r\n    }\r\n  ]\r\n}\r\nExpected \"<root>.browserContextId\" to be |string|; found |object| `null` instead. _dispatch@chrome://juggler/content/protocol/Dispatcher.js:100:15\r\n\r\n    at node_modules/puppeteer-firefox/lib/Connection.js:74:56\r\n    at new Promise (<anonymous>)\r\n    at Connection.send (node_modules/puppeteer-firefox/lib/Connection.js:73:12)\r\n    at Page.deleteCookie (node_modules/puppeteer-firefox/lib/Page.js:115:22)\r\n    at Page.<anonymous> (node_modules/puppeteer-firefox/lib/helper.js:32:23)\r\n    at Page.setCookie (node_modules/puppeteer-firefox/lib/Page.js:135:16)\r\n    at Page.<anonymous> (node_modules/puppeteer-firefox/lib/helper.js:32:23)\r\n    at sample.js:6:14\r\n\r\n```"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.16.0\r\n* Platform / OS version: macOS 10.14.4\r\n* URLs (if applicable):\r\n* Node.js version: v12.1.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```const path = require('path');\r\nconst puppeteer = require('puppeteer');\r\nvar fs = require('fs');\r\nfs.writeFileSync(\"/tmp/test.html\", '<!DOCTYPE HTML>\\n<HTML>\\n<HEAD></HEAD>\\n<BODY>\\n<p>Hello World</p>\\n</BODY>\\n</HTML>\\n');\r\n\r\nvar time=Date.now();\r\n(async () => {\r\n    const browser = await puppeteer.launch();\r\n    page = await browser.newPage();\r\n    for(var i=1; i<10000000; ++i) {\r\n        if (i%1000==0) {\r\n            console.log((Date.now()-time)/1000);\r\n            time=Date.now();\r\n        }\r\n        await page.goto('file:///tmp/test.html');\r\n    }\r\n    await page.close();\r\n    await browser.close();\r\n})()\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nTime to process the page should remain stable\r\n\r\n**What happens instead?**\r\n\r\nDuration increases and it eventually times out:\r\n```\r\n10.509\r\n10.128\r\n12.785\r\n14.21\r\n13.737\r\n21.081\r\n12.523\r\n17.11\r\n15.367\r\n19.972\r\n21.461\r\n15.278\r\n28.165\r\n23.606\r\n26.269\r\n29.514\r\n26.32\r\n35.897\r\n45.951\r\n(node:57740) UnhandledPromiseRejectionWarning: TimeoutError: Navigation Timeout Exceeded: 30000ms exceeded\r\n```\r\n"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\nCalling await page.evaluate() hangs on Args key has unicode char\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.16.0\r\n* Platform / OS version: windows10 1809\r\n* URLs (if applicable):\r\n* Node.js version: 8.16.0\r\n\r\n**What steps will reproduce the problem?**\r\n```js\r\nconst puppeteer = require(\"puppeteer\");\r\n\r\n(async () => {\r\n    const browser = await puppeteer.launch()\r\n    try {\r\n        const page = await browser.newPage();\r\n        console.log(\"wait evaluate\");\r\n        await page.evaluate(() => { }, {\"中文字符\": 1 })\r\n    } finally {\r\n        browser.close();\r\n    }\r\n})()\r\n```\r\n\r\n**What is the expected result?**\r\n `await page.evaluate(() => { }, {\"中文字符\": 1 })` should resolve quickly !\r\n\r\n**What happens instead?**\r\nScript hangs on line 8\r\n"},{"labels":["bug",null,null],"text":"* Puppeteer version: 1.14.0\r\n* Platform / OS version: Windows 10\r\n* Node.js version: 10.15.3\r\n\r\nComplete code to reproduce the problem:\r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n    const browser = await puppeteer.launch({ \r\n        headless: false, \r\n        devtools: false\r\n    });\r\n    const page = await browser.newPage();\r\n    await page.setViewport({ width: 1920, height: 1080 });\r\n    await page.setRequestInterception(true);\r\n    page.on('request', request => {\r\n        request.continue();\r\n    });\r\n\r\n    await page.goto('http://123tvnow.com/watch/cbs/',)\r\n    .catch((e) => {console.log(e)})\r\n    // await browser.close();\r\n})();\r\n```\r\n\r\nIf `setRequestInterception` is set to `true`, the page never fully loads event thou all requests seem to be handled. Some sub-pages of the included example website do load, like: `http://123tvnow.com/watch/espn`\r\nIf you enable dev tools you'll need to deactivate breakpoints and resume. It's just the way site owner coded it. \r\n\r\nAfter 30 seconds a `TimeoutError` error will be caught. I would like to understand why this is happening? It is especially confusing because some sub-pages load without a problem so I didn't expect the `xhr` streaming files be an issue or .ttf or something similar."},{"labels":["bug",null],"text":"\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.15.0\r\n* Platform / OS version: Mac OS X \r\n* URLs (if applicable): N/A\r\n* Node.js version: v11.14.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n    const browser = await puppeteer.launch();\r\n    const page = await browser.newPage();\r\n    await page.setContent('hello world' + '\\x7F');\r\n    await page.screenshot({ path: 'example.png' });\r\n    await browser.close();\r\n})();\r\n```\r\n\r\nDoes not render a screenshot errors with:\r\n\r\n```\r\npuppeteer:protocol SEND ► {\"sessionId\":\"01FFD0FBFAF9615CF23C56EE225D4C57\",\"method\":\"Runtime.callFunctionOn\",\"params\":{\"functionDeclaration\":\"html => {\\n      document.open();\\n      document.write(html);\\n      document.close();\\n    }\\n//# sourceURL=__puppeteer_evaluation_script__\\n\",\"executionContextId\":2,\"arguments\":[{\"value\":\"hello world\"}],\"returnByValue\":false,\"awaitPromise\":true,\"userGesture\":true},\"id\":16} +1ms\r\npuppeteer:protocol ◀ RECV {\"error\":{\"code\":-32700,\"message\":\"Message must be a valid JSON\"}} +1ms\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nThe page content is set.\r\n\r\nWhen a browser loads the content from a server everything works perfectly.\r\n\r\n**What happens instead?**\r\n\r\nThe puppeteer.setContent() method does not return and the the program does not terminate as the error is not detected by Puppeteer."},{"labels":["bug",null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n* Puppeteer version: 0.14.0\r\n* Platform / OS version: MacOS (Dockerized in node:10)\r\n* URLs (if applicable): https://j4q389wzv3.codesandbox.io/\r\n* Node.js version: v10.15.3\r\n\r\n**What steps will reproduce the problem?**\r\nOpen Website OR use this file:\r\n```\r\n<html>\r\n  <head>\r\n    <meta charset=\"UTF-8\" />\r\n  </head>\r\n\r\n  <body>\r\n    <input style=\"display: none\" type=\"number\" class=\"my-input-class\" />\r\n    <input type=\"number\" class=\"my-input-class\" />\r\n  </body>\r\n</html>\r\n```\r\n\r\n_Please include code that reproduces the issue._\r\n```\r\nconst browser = await puppeteer.launch();\r\n\r\nconst page = await browser.newPage();\r\nawait page.goto('https://j4q389wzv3.codesandbox.io/');\r\n\r\ntry {\r\n  const visibleInput = await page.waitForSelector('.my-input-class', {visible: true, timeout: 1000 })\r\n  console.log('Found visible Element')\r\n} catch (e) {\r\n  console.log('Could NOT find a visible element ', e.message)\r\n}\r\n\r\nconst inputs = await page.$$('.my-input-class')\r\nconsole.log(`Found ${inputs.length} inputs`)\r\n\r\nawait browser.close()\r\n```\r\n\r\n**What is the expected result?**\r\nThere are 2 elements matching the CSS Selector on the page.  the first one is hidden, the second one is visible.  The `page.waitForSelector` with `{visible: true}` should have found and returned the visible element on the page.\r\n\r\n**What happens instead?**\r\nIt Times Out since there was another HIDDEN element matching the CSS selector higher up in the DOM structure, causing it to wait until timeout even though a visible element exists on the page."},{"labels":["bug",null,null],"text":"Request interception appears to be faulty and results in a navigation error.\r\n\r\n### Environment\r\n* Puppeteer version: `1.14.0-next.1556048038195`, tested 10.11 until `next`\r\n* Chromium version: `r641577`\r\n* Platform / OS version: `macOS 10.14.3 Mojave`\r\n* Node.js version: `8.15.1`, tested up until `10.15.3`\r\n\r\n### Steps to reproduce\r\n1. Clone https://github.com/ps-mariotacke/puppeteer-intercept-issue a stripped down sample\r\n2. Run `npm install`\r\n3. Run `npm start`\r\n\r\n**What is the expected result?**\r\nChromium spawns and takes a screenshot. It should have `setRequestInterception` enabled on the page.\r\n\r\n**What happens instead?**\r\nChromium gets stuck and errors with a navigation error.\r\n\r\n### Additional information\r\n- I included a `broken.html` and `working.html` payload which can be switched in the `index.js` at the top. The only difference between these two payloads is that the broken payload specifies a `<base href=\"...\">` in `<head>`. The working payload does not include the base href and instead specifies the fully qualified url in the script tag.\r\n- https://github.com/ps-mariotacke/puppeteer-intercept-issue\r\n\r\nRelated to #3471 "},{"labels":["bug",null,null],"text":"Hello I have a similar issue than the one you previously corrected in ticket #4274 but this one is still present even with last version of master branch of puppeteer\r\n\r\n## Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: master branch ( 8f8e77492dd91a00d53965b998b4199bcc5e29a3 )\r\n* Platform / OS version: Debian (Dockerized in node:10-stretch-slim)\r\n* URLs (if applicable): https://www.edistat.com/\r\n* Node.js version: v10.15.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nOpen the website\r\nClick on `.list-group .list-group-item:nth-of-type(1) .gotodetail`\r\nWait for the url `https://www.edistat.com/livre_tarifs.php?ean=9782702165485`\r\n\r\n\r\n\r\n_Please include code that reproduces the issue._\r\nNote 1 : this code sample works fine until 1.5.0 of puppeteer and below\r\n\r\n```\r\nconst browser = await puppeteer.launch();\r\n\r\nconst page = await browser.newPage();\r\nawait page.goto('https://www.edistat.com/');\r\n\r\nawait Promise.all([\r\n  page.click('.list-group .list-group-item:nth-of-type(1) .gotodetail'),\r\n  page.waitForNavigation({waitUntil: ['networkidle0', 'load', 'domcontentloaded'], timeout: 30000})\r\n]);\r\nconsole.log(await page.url());\r\nawait page.screenshot({path: 'screenshot.png', fullPage: true});\r\n\r\nawait browser.close();\r\n\r\n```\r\n\r\n\r\n**What is the expected result?**\r\nThe page `https://www.edistat.com/livre_tarifs.php?ean=9782702165485` should be opened when clicking on `.list-group .list-group-item:nth-of-type(1) .gotodetail`\r\n\r\n**What happens instead?**\r\nBrowser is stuck on homepage with the message \r\n\r\n> Error running your code. Error: Node is either not visible or not an HTMLElement\r\n"},{"labels":["bug"],"text":"## Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.14.0\r\n* Platform / OS version: Debian (Dockerized in node:10-stretch-slim)\r\n* URLs (if applicable): https://www.sisley-paris.com/en-GB/\r\n* Node.js version: v10.15.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nOpen the website with a mobile emulation\r\nClick on `#my_account_link`\r\nWait for the url `https://msecure.sisley-paris.com/en-GB/customer/account/login/`\r\n\r\n\r\n\r\n_Please include code that reproduces the issue._\r\nNote 1 : this code sample works fine until 1.5.0 of puppeteer and below\r\nNote 2 : as a workaround changing the selector to `#my_account_link > i.icon-people` will make it works\r\n\r\n```\r\nconst browser = await puppeteer.launch();\r\n\r\nconst page = await browser.newPage();\r\nawait page.setBypassCSP(true);\r\nawait page.emulate({viewport: { width: 375, height:  667, deviceScaleFactor: 2, isMobile: true, hasTouch: true, isLandscape: false}, userAgent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1'});\r\nawait page.goto('https://www.sisley-paris.com/en-GB/', {waitUntil: ['networkidle0', 'load', 'domcontentloaded'], timeout: 30000});\r\n\r\nPromise.all([\r\n  page.click('#my_account_link'),\r\n  page.waitForNavigation( {waitUntil: ['networkidle0', 'load', 'domcontentloaded'], timeout: 30000})\r\n]);\r\nconsole.log(await page.url());\r\nawait page.screenshot({path: 'screenshot.png'});\r\n\r\nawait browser.close();\r\n```\r\n\r\n\r\n**What is the expected result?**\r\nThe page `https://msecure.sisley-paris.com/en-GB/customer/account/login/` should be opened when clicking on `#my_account_link`\r\n\r\n**What happens instead?**\r\nBrowser is stuck on homepage\r\n"},{"labels":["bug",null,null],"text":"* Puppeteer version: 1.14.0\r\n* Platform / OS version: Ubuntu 16.04.6 LTS\r\n* URLs (if applicable):\r\n* Node.js version: 10.15.3\r\n\r\n**What steps will reproduce the problem?**\r\nSimply running the example:\r\n\r\n```js\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage(); \r\nawait page.goto('https://google.com');\r\n\r\n// Create a Map object\r\nawait page.evaluate(() => window.map = new Map());\r\n// Get a handle to the Map object prototype\r\nconst mapPrototype = await page.evaluateHandle(() => Map.prototype);\r\n// Query all map instances into an array\r\nconst mapInstances = await page.queryObjects(mapPrototype);\r\n// Count amount of map objects in heap\r\nconst count = await page.evaluate(maps => maps.length, mapInstances);\r\nawait mapInstances.dispose();\r\nawait mapPrototype.dispose();\r\n```\r\nIt crashes at `page.queryObjects`, when going to a url. If the page doesn't navigate to any page, it works.\r\nThis also works on 1.11.0.\r\n\r\nI believe the error is thrown from here:\r\nhttps://github.com/GoogleChrome/puppeteer/blob/2a7c3fe3e68aac3dbca130065a67a8f0aa7db621/lib/ExecutionContext.js#L173-L175\r\n\r\n**What is the expected result?**\r\n\r\nCode runs through without any error.\r\n\r\n**What happens instead?**\r\n\r\nBrowser crashed with error:\r\n```\r\n    Error [ERR_UNHANDLED_ERROR]: Unhandled error. (Error: Page crashed!)\r\n\r\n      at Page._onTargetCrashed (node_modules/puppeteer/lib/Page.js:185:10)\r\n```\r\n\r\n"},{"labels":["bug"],"text":"When setting a request interception to a page, the page's workers can no longer make network request, because otherwise they will stop responding. both `importScripts` and `fetch`.\r\n\r\nIt is critical to mention that this behavior _does work_ on native CDP\r\n\r\n### Steps to reproduce\r\n\r\n[I've created a repo with a script that does the following](https://github.com/Schniz/puppeteer-workers-bug), and also shows that a \"native\" implementation using CDP alone _does work_:\r\n\r\n* Serve a static site with `worker.js` that makes a network call of some sort\r\n* Create a new browser page with interceptions:\r\n  ```js\r\n  await page.setRequestInterception(true);\r\n  await page.on('request', request => request.continue);\r\n  ```\r\n* See how it causes the worker to stop responding!\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.13.0\r\n* Platform / OS version: OSX\r\n* URLs (if applicable):\r\n* Node.js version: v10.15.3\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1. Clone https://github.com/Schniz/puppeteer-workers-bug\r\n2. `npm i`\r\n3. `node puppeteer.js`\r\n\r\n**What is the expected result?**\r\n\r\n```\r\nThe following works:\r\n--------------------\r\n1\r\n{\r\n  \"userId\": 1,\r\n  \"id\": 1,\r\n  \"title\": \"delectus aut autem\",\r\n  \"completed\": false\r\n}\r\nfinished\r\n\r\nBut when intercepted, it doesn't!\r\n--------------------------\r\n1\r\n\r\nAlthough it does work with CDP directly:\r\n----------------------------------------\r\nhttp://localhost:5000/\r\nhttp://localhost:5000/worker.js\r\nhttps://jsonplaceholder.typicode.com/todos/1\r\n1\r\n{\r\n  \"userId\": 1,\r\n  \"id\": 2,\r\n  \"title\": \"quis ut nam facilis et officia qui\",\r\n  \"completed\": false\r\n}\r\nfinished\r\n```\r\n\r\n**What happens instead?**\r\n```\r\nThe following works:\r\n--------------------\r\n1\r\n{\r\n  \"userId\": 1,\r\n  \"id\": 1,\r\n  \"title\": \"delectus aut autem\",\r\n  \"completed\": false\r\n}\r\nfinished\r\n\r\nBut when intercepted, it doesn't!\r\n--------------------------\r\n1\r\n\r\nAlthough it does work with CDP directly:\r\n----------------------------------------\r\n1\r\n{\r\n  \"userId\": 1,\r\n  \"id\": 2,\r\n  \"title\": \"quis ut nam facilis et officia qui\",\r\n  \"completed\": false\r\n}\r\nfinished\r\n```"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: v1.13.0\r\n* Platform / OS version: MacOS 10.14.3\r\n* URLs (if applicable): x\r\n* Node.js version: 11.12\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nI am unsure whether this is suppose to be possible or not therefore I'm going to skip the repro until we can confirm this is a bug.\r\n\r\nI'm trying to use `setRequestInterception(true)` to 'pause' navigation requests in order to gather information from other failed requests (fetch etc.) and to wait for screenshots (on ever navigation) to be taken and saved.\r\n\r\nI am/was under the impression that `setRequestInterception(true)` would prevent the browser from initiating the page load. But it seems the browser merely gets stuck doing so, which causes other _introspection_ (`response.buffer()` etc) requests to fail (`Protocol error (Network.getResponseBody): No resource with given identifier found`) as the browser appears to no longer be aware of these requests.\r\n\r\nIs there any way to effectively halt *any* browser navigation (including `page.goto`) before it unloads its request information?\r\n\r\nThe relevant code is here:\r\n```ts\r\nimport { HttpMethod, Page, Request } from 'puppeteer';\r\nimport { BrowserLogEntry } from '../setup';\r\nimport { StreamBuffer } from './StreamBuffer';\r\n\r\nexport interface PageRequest {\r\n  readonly url: string;\r\n  readonly method: HttpMethod;\r\n  readonly headers: {\r\n    [key: string]: string;\r\n  };\r\n  readonly data?: string | object;\r\n}\r\n\r\nexport interface PageResponse {\r\n  readonly statusCode: number;\r\n  readonly headers: {\r\n    [key: string]: string;\r\n  };\r\n  readonly data?: string | object;\r\n}\r\n\r\nexport class PageRequestError extends Error {\r\n  constructor(\r\n    message: string,\r\n    public readonly request: PageRequest,\r\n    public readonly response?: PageResponse,\r\n  ) {\r\n      super(message);\r\n    }\r\n}\r\n\r\nfunction tryJSONParse(data?: string): undefined | string | object {\r\n  if (!data) {\r\n    return data;\r\n  }\r\n  try {\r\n    return <object>JSON.parse(data);\r\n  } catch {\r\n    return data;\r\n  }\r\n}\r\n\r\nfunction fetchRequestData(request: Request): PageRequest {\r\n  return {\r\n    data: tryJSONParse(request.postData()),\r\n    headers: request.headers(),\r\n    method: request.method(),\r\n    url: request.url(),\r\n  };\r\n}\r\n\r\nasync function makePageRequestError(request: Request, blocking: boolean): Promise<PageRequestError> {\r\n  const failure = request.failure();\r\n  const response = request.response();\r\n  const reqData = fetchRequestData(request);\r\n  if (failure && failure.errorText.startsWith('net::')) {\r\n    return new PageRequestError(`Request failed with ${failure.errorText}`, reqData);\r\n  }\r\n  return new PageRequestError(\r\n    failure ? failure.errorText : response ? response.status().toString() : 'No Response',\r\n    reqData,\r\n    response ? {\r\n        data: blocking ? tryJSONParse((await response.buffer()).toString()) : 'UNAVAILABLE',\r\n        headers: response.headers(),\r\n        statusCode: response.status(),\r\n    } : undefined);\r\n}\r\n\r\n/**\r\n * Orders a halt of main page navigation.\r\n */\r\nexport interface NavigationInterruptor {\r\n  preventNavigation(source: string): () => void;\r\n}\r\n\r\n/**\r\n * This class is designed to prevent all direct browser navigation until all subsequent requests\r\n * have completed.\r\n *\r\n */\r\nexport class NavigationInterruptor implements NavigationInterruptor {\r\n  private locks = new Set<{ source: string } | Request>();\r\n  constructor(private blocking: boolean, private page: Page, private logBuffer: StreamBuffer<BrowserLogEntry>) {\r\n\r\n  }\r\n\r\n  public async attach() {\r\n    const { blocking, locks, logBuffer, page } = this;\r\n    if (this.blocking) {\r\n      await page.setRequestInterception(true);\r\n      page.on('request', async request => {\r\n        let continued = false;\r\n        try {\r\n          if (request.isNavigationRequest()) {\r\n            await this.hold(request);\r\n            return;\r\n          }\r\n          locks.add(request);\r\n          await request.continue();\r\n          continued = true;\r\n        } catch (error) {\r\n          logBuffer.write({\r\n            error: <Error>error,\r\n            source: 'navblock',\r\n          });\r\n          await request.continue();\r\n          if (!continued) {\r\n            await request.continue();\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    page.on('requestfinished', async request => {\r\n      try {\r\n        const failure = request.failure();\r\n        const response = request.response();\r\n        const statusCode = response && response.status();\r\n        if (!failure && (statusCode && ((statusCode >= 200 && statusCode < 400)) || statusCode === 0)) {\r\n          return;\r\n        }\r\n        logBuffer.write({\r\n          error: await makePageRequestError(request, blocking),\r\n          source: 'requestfinished',\r\n        });\r\n      } catch (error) {\r\n        logBuffer.write({\r\n          error: <Error>error,\r\n          source: 'requestfinished',\r\n        });\r\n      } finally {\r\n        this.finishRequest(request);\r\n      }\r\n    });\r\n\r\n    page.on('requestfailed', async request => {\r\n      try {\r\n        logBuffer.write({\r\n          error: await makePageRequestError(request, blocking),\r\n          source: 'requestfailed',\r\n        });\r\n      } catch (error) {\r\n        logBuffer.write({\r\n          error: <Error>error,\r\n          source: 'requestfailed',\r\n        });\r\n      } finally {\r\n        this.finishRequest(request);\r\n      }\r\n    });\r\n  }\r\n\r\n  public preventNavigation(source: string): () => void {\r\n    const lock = {\r\n      source,\r\n    };\r\n    this.locks.add(lock);\r\n    return () => {\r\n      this.locks.delete(lock);\r\n    };\r\n  }\r\n\r\n  public isHolding(): boolean {\r\n    return this.locks.size > 0;\r\n  }\r\n\r\n  private async hold(request: Request, holdTime = Date.now()) {\r\n    const { locks, logBuffer, page } = this;\r\n    if (locks.size === 0) {\r\n      await request.continue();\r\n      return;\r\n    }\r\n    const diff = Date.now() - holdTime;\r\n    if (diff > 5000) {\r\n      locks.clear();\r\n      logBuffer.write({\r\n        error: new Error('Blocked navigation for more than 2000ms'),\r\n        source: 'navblock',\r\n      });\r\n      await request.continue();\r\n      return;\r\n    }\r\n    await page.waitFor(100);\r\n    await this.hold(request, holdTime);\r\n  }\r\n\r\n  private finishRequest(request: Request) {\r\n    if (!this.blocking || request.isNavigationRequest()) {\r\n      return;\r\n    }\r\n    this.locks.delete(request);\r\n  }\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"I use puppeteer to download video from one site. \r\non the page `requestfinished` event, all the video has download, so I call `var buffer = await response.buffer();` to get the video data. \r\n```\r\nDownloader.prototype.onResponse = async function(response) {\r\n  let url = response.url();\r\n  let [path, quote] = url.split('?');\r\n  if(path.endsWith('.flv')) {\r\n    let buffer = await response.buffer();\r\n    await this.saveFlv(path, buffer);\r\n  }\r\n}\r\n```\r\nthat works ok, but it occur error occasionally.\r\n\r\n``` Promise Promise {\r\n  <rejected> { Error: Protocol error (Network.getResponseBody): Target closed.\r\n    at Promise (/Users/kim/code/node_modules/puppeteer/lib/Connection.js:184:56)\r\n    at new Promise (<anonymous>)\r\n    at CDPSession.send (/Users/kim/code/node_modules/puppeteer/lib/Connection.js:183:12)\r\n    at _contentPromise._bodyLoadedPromise.then (/Users/kim/code/node_modules/puppeteer/lib/NetworkManager.js:597:45)\r\n    at <anonymous>\r\n  message: 'Protocol error (Network.getResponseBody): Target closed.' } }  reason: { Error: Protocol error (Network.getResponseBody): Target closed.\r\n    at Promise (/Users/kim/code/node_modules/puppeteer/lib/Connection.js:184:56)\r\n    at new Promise (<anonymous>)\r\n    at CDPSession.send (/Users/kim/code/node_modules/puppeteer/lib/Connection.js:183:12)\r\n    at _contentPromise._bodyLoadedPromise.then (/Users/kim/code/node_modules/puppeteer/lib/NetworkManager.js:597:45)\r\n    at <anonymous>\r\n  message: 'Protocol error (Network.getResponseBody): Target closed.' }\r\n```\r\n\r\n\r\nI think it is because the devtools session closed before the requestfinished event. please give me some suggestion. thanks.\r\nthe version is  puppeteer@1.13.0, node v8.11.4 on mac."},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.12.2\r\n* Platform / OS version: \r\n    uname -a\r\n    Linux henrique-Latitude-5480 4.15.0-45-generic #⁠48-Ubuntu SMP Tue Jan 29 16:28:13 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\r\n    lsb_release -a\r\n    No LSB modules are available.\r\n    Distributor ID:\tUbuntu\r\n    Description:\tUbuntu 18.04.2 LTS\r\n    Release:\t18.04\r\n    Codename:\tbionic\r\n* URLs (if applicable): \r\n* Node.js version: v10.15.1\r\n\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nI have the following piece of code, in a simplified way:\r\n\r\n```\r\nawait Promise.all([\r\n    _ifrArvoreFrameSEI.waitForNavigation(), //_ifrArvoreFrameSEI is class: Frame\r\n    _ifrVisualizacaoSEI.waitForNavigation(), // _ifrVisualizacaoSEI is class: Frame\r\n    _ifrArvoreFrameSEI.click('a#anchor18335653')\r\n]);\r\n```\r\n\r\n**What is the expected result?**\r\nClick on element 'a#anchor18335653' and resolves the waitForNavigation() promises.\r\n\r\n**What happens instead?**\r\nsometimes waitForNavigation timeouts\r\n\r\n\r\nSo I ran Chrome with graphical interface, and verified that _ifrArvoreFrameSEI.click('a#anchor18335653') doesn't seem to be scrolling. When I have the following screen, it works:\r\n\r\n![image](https://user-images.githubusercontent.com/19354250/53741248-baa4c600-3e74-11e9-9ac1-96141a03f91a.png)\r\n\r\nBut on this one, it doesn't work:\r\n\r\n![image](https://user-images.githubusercontent.com/19354250/53741298-d3ad7700-3e74-11e9-8464-a9760f460e5f.png)\r\n\r\n\r\nI think the problem might be in the scroll bar marked with Red, as puppeteer doesn't seem to be scrolling it. Sorry for the black stripes, I had to add them because the screen potentially shows private data.\r\n\r\n'a#anchor18335653' is shown below.\r\n![image](https://user-images.githubusercontent.com/19354250/53740691-8a105c80-3e73-11e9-90bf-6b36ae60f85c.png)\r\n\r\nWhen I manually scrolled the bar, in the 5 seconds given by Atomics.wait, it works:\r\n```\r\nvar sab = await new SharedArrayBuffer(1024);\r\nvar int32 = await new Int32Array(sab);\r\nawait console.log(\"SLEEPING\");\r\nawait Atomics.wait(int32, 0, 0,5000);\r\n\r\nawait Promise.all([\r\n    _ifrArvoreFrameSEI.waitForNavigation(),\r\n    _ifrVisualizacaoSEI.waitForNavigation(),\r\n    _ifrArvoreFrameSEI.click('a#anchor18335653')\r\n]);\r\n\r\n```\r\n\r\nIt woks if Chrome is launched with `defaultViewport: {width: 2000, height:2000}`\r\n\r\nI've also noticed that the code bellow works fine:\r\n```\r\nawait Promise.all([\r\n    _ifrArvoreFrameSEI.waitForNavigation(), //_ifrArvoreFrameSEI is class: Frame\r\n    _ifrVisualizacaoSEI.waitForNavigation(), // _ifrVisualizacaoSEI is class: Frame\r\n    _ifrArvoreFrameSEI.evaluate( () => document.querySelector('a#anchor18335653').click())\r\n]);\r\n```\r\n\r\nThanks."},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n* Puppeteer version: puppeteer-firebox 0.5.0\r\n* Platform / OS version: macOS 10.14.3, /dev/disk1s1 on / (apfs, local, journaled)\r\n* URLs (if applicable):\r\n* Node.js version: 11.10.1\r\n\r\n**What steps will reproduce the problem?**\r\n`yarn add  puppeteer-firefox`\r\n\r\n**What is the expected result?**\r\nsuccess\r\n\r\n**What happens instead?**\r\n```\r\nerror /Users/jan/workspace/isomorfeus-puppetmaster/ruby/node_modules/puppeteer-firefox: Command failed.\r\nExit code: 1\r\nCommand: node install.js\r\nArguments: \r\nDirectory: /Users/jan/workspace/isomorfeus-puppetmaster/ruby/node_modules/puppeteer-firefox\r\nOutput:\r\nERROR: Failed to download Firefox r2f959d575a3d61f5dda12e4e2dca1f46a92ab569!\r\n{ Error: ENOENT: no such file or directory, chmod '/Users/jan/workspace/isomorfeus-puppetmaster/ruby/node_modules/puppeteer-firefox/.local-browser/firefox-mac-2f959d575a3d61f5dda12e4e2dca1f46a92ab569/firefox/Nightly.app/Contents/MacOS/Firefox'\r\n  -- ASYNC --\r\n    at BrowserFetcher.<anonymous> (/Users/jan/workspace/isomorfeus-puppetmaster/ruby/node_modules/puppeteer-firefox/lib/helper.js:31:27)\r\n    at Object.<anonymous> (/Users/jan/workspace/isomorfeus-puppetmaster/ruby/node_modules/puppeteer-firefox/install.js:47:16)\r\n    at Module._compile (internal/modules/cjs/loader.js:738:30)\r\n    at Object.Module._extensions..js (internal/modules/cjs/loader.js:749:10)\r\n    at Module.load (internal/modules/cjs/loader.js:630:32)\r\n    at tryModuleLoad (internal/modules/cjs/loader.js:570:12)\r\n    at Function.Module._load (internal/modules/cjs/loader.js:562:3)\r\n    at Function.Module.runMain (internal/modules/cjs/loader.js:801:12)\r\n    at internal/main/run_main_module.js:21:11\r\n  errno: -2,\r\n  code: 'ENOENT',\r\n  syscall: 'chmod',\r\n  path:\r\n   '/Users/jan/workspace/isomorfeus-puppetmaster/ruby/node_modules/puppeteer-firefox/.local-browser/firefox-mac-2f959d575a3d61f5dda12e4e2dca1f46a92ab569/firefox/Nightly.app/Contents/MacOS/Firefox' }\r\n```\r\n\r\nIt appears the actual file name is:\r\n'/Users/jan/workspace/isomorfeus-puppetmaster/ruby/node_modules/puppeteer-firefox/.local-browser/firefox-mac-2f959d575a3d61f5dda12e4e2dca1f46a92ab569/firefox/Nightly.app/Contents/MacOS/firefox'\r\n\r\na lower case 'firefox' instead of the requested upper case one."},{"labels":["bug",null],"text":"* Puppeteer version: 1.11.0\r\n* Platform / OS version: 10.14.3\r\n* Node.js version: 11.6.0\r\n\r\n### when it appear\r\n\r\nI have some operations like pagination retrieval that take a long time, page.waitForSelector will throw \"timeout error\" event if there is  element on the page, it seem like the session is closed or connection is closed but no any reject error tell.\r\n\r\n### What is the expected result?\r\n\r\nHere is an example:\r\n\r\n```javascript\r\nasync function click(selector, page) {\r\n    try {\r\n      await page.waitForSelector(selector , {\r\n        timeout: 1000\r\n      })\r\n      await page.click(selector)\r\n    } catch (err) {\r\n      throw err\r\n    }\r\n}\r\n\r\nasync function recordPrice(id, page) {\r\n  try {\r\n    await click(`.search_Table .bgcolor:nth-child(${id + 1}) .link`, page)\r\n   await Promise.all([\r\n    page.waitForSelector('.aui_state_focus', {\r\n      timeout: 6000\r\n    }),\r\n    page.waitForSelector('.aui_dialog .table_list tbody tr:nth-child(2)', {\r\n      timeout: 6000\r\n    })\r\n   ])\r\n  } catch (err) {\r\n    if (err.message.includes('No node found for selector') || err.message.includes('.search_Table')) {\r\n      return false\r\n    }\r\n    throw err\r\n  }\r\n}\r\n\r\n// ...\r\n let prices = [];\r\n for (let id = 0; id < feeLength; id++) {\r\n      prices.push(await recordPrice(id, page))\r\n }\r\n// ...\r\n```\r\n\r\nthe click function inside recordPrice should not throw any error\r\n\r\n### What happens instead?\r\n\r\nafter recordPrice called multiple times, page.waitForSelector(`.search_Table .bgcolor:nth-child(${id + 1}) .link`) will throw timeout error, but I can get response from the console of headless chrome, so the element is exists actually. \r\n\r\nanother, if i comment this lines of click function:\r\n\r\n```javascript\r\n  await page.waitForSelector(selector , {\r\n        timeout: 1000\r\n  })\r\n```\r\n\r\nthe browser pages will be hanging and not end, its confused for me. so, how to fix this so i don't have to restart pages again ? thanks!"},{"labels":["bug"],"text":"The quick summary is that whether I use `raf`, or set `polling` to a number, `waitForFunction` only ever runs once.\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.12.2\r\n* Platform / OS version: macOS Mojave 10.14.3\r\n* URLs (if applicable): example.com\r\n* Node.js version: v8.15.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nThe following puppeteer script is saved as `pup.js`:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer')\r\n\r\npuppeteer.launch().then(async browser => {\r\n  const [page] = await browser.pages()\r\n\r\n  let result = false\r\n\r\n  page.exposeFunction('getResult', () => {\r\n    console.log('here', result)\r\n\r\n    const thisResult = result\r\n\r\n    result = true\r\n\r\n    return thisResult\r\n  })\r\n\r\n  await page.goto('http://example.com')\r\n  await page.waitForFunction('getResult()')\r\n  await page.close()\r\n  await browser.close()\r\n})\r\n```\r\n\r\nMy command to run it is `node pup.js`.\r\n\r\n**What is the expected result?**\r\n\r\nI expect the following output:\r\n\r\n```\r\nhere false\r\nhere true\r\n```\r\n\r\nand a clean exit.\r\n\r\n**What happens instead?**\r\n\r\nI get the following:\r\n\r\n```\r\nhere false\r\n(node:64382) UnhandledPromiseRejectionWarning: TimeoutError: waiting for function failed: timeout 30000ms exceeded\r\n    at new WaitTask (/Users/jstaab/Desktop/cc/client/node_modules/puppeteer/lib/DOMWorld.js:554:28)\r\n    at DOMWorld.waitForFunction (/Users/jstaab/Desktop/cc/client/node_modules/puppeteer/lib/DOMWorld.js:459:12)\r\n    at Frame.waitForFunction (/Users/jstaab/Desktop/cc/client/node_modules/puppeteer/lib/FrameManager.js:636:28)\r\n    at Page.waitForFunction (/Users/jstaab/Desktop/cc/client/node_modules/puppeteer/lib/Page.js:1098:29)\r\n    at puppeteer.launch.then (/Users/jstaab/Desktop/cc/client/pup.js:19:14)\r\n    at <anonymous>\r\n    at process._tickCallback (internal/process/next_tick.js:189:7)\r\n(node:64382) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). (rejection id: 1)\r\n(node:64382) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n```\r\n\r\nAnd it fails to exit (because I never get to `page.close()`).\r\n\r\n"},{"labels":["bug",null],"text":"Not sure if this is by design but requests that were previously cached by service worker are not intercepted after `page.setRequestInterception(true)`.\r\n\r\nSimplified code to reproduce:\r\n```js\r\nconst hostname = 'http://localhost:';\r\nconst {port, proc} = await startServer(); // local implementation\r\nconst browser = await puppeteer.launch({\r\n  args: [\r\n    '--no-sandbox',\r\n    '--disable-setuid-sandbox',\r\n    '--enable-features=NetworkService',\r\n  ],\r\n  ignoreHTTPSErrors: true,\r\n});\r\n\r\nconst page = await browser.newPage();\r\n\r\nawait page.goto(`${hostname}${port}`);\r\nawait page.evaluate('navigator.serviceWorker.ready');\r\n\r\nawait page.setRequestInterception(true); //toggle this\r\npage.on('request', req => {\r\n   console.log('requesting', req.url());\r\n   req.continue().catch(e => e /* not intercepting */);\r\n});\r\n\r\nawait page.reload({waitUntil: 'domcontentloaded'});\r\n\r\nawait browser.close();\r\n```\r\n\r\n1. Set `await page.setRequestInterception(true)`\r\n2. Run test, only URLs not previously cached by service worker are logged\r\n3. Set `await page.setRequestInterception(false)` (or remove Service Worker registration)\r\n4. Run test, all URLs are logged\r\n\r\nAre requests intercepted only when requests are sent through to the network, or is this a bug?\r\n\r\n\r\n"},{"labels":["bug",null],"text":"* Puppeteer version: puppeteer@1.12.1\r\n* Platform / OS version: Windows 10 (20 Core , 64GB Ram)\r\n* Node.js version: v10.15.0\r\n\r\n**What steps will reproduce the problem?**\r\nRun the script and wait to i == 1129 (around 101 page visit) it would just freeze and hang \r\n\r\n\r\n_Please include code that reproduces the issue._\r\nLink to Full Code : https://gist.github.com/rainbowhat/00ee308129fd52b87156b5e0715f8fff\r\n\r\n\r\n**What is the expected result?**\r\nIt's expected to keep running until 10,000\r\n\r\n**What happens instead?**\r\nIt freezes and no errors appear, The output during the freeze is \r\n\r\n```\r\nAfter Page.Content\r\nHit End of Loop\r\nHit After Visit\r\n1127\r\nBefore Page.content\r\n\r\n```\r\n\r\nI have to do a ctrl + c to end the program. \r\n"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version:1.12.2\r\n* Platform / OS version: MAC / UBUNTU\r\n* URLs (if applicable):\r\n* Node.js version: 8.11.4\r\n* chromium command line: ~/node_modules/puppeteer/.local-chromium/linux-624492/chrome-linux/chrome --disable-background-networking --enable-features=NetworkService,NetworkServiceInProcess --disable-background-timer-throttling --disable-backgrounding-occluded-windows --disable-breakpad --disable-client-side-phishing-detection --disable-default-apps --disable-dev-shm-usage --disable-extensions --disable-features=site-per-process,TranslateUI --disable-hang-monitor --disable-ipc-flooding-protection --disable-popup-blocking --disable-prompt-on-repost --disable-renderer-backgrounding --disable-sync --force-color-profile=srgb --metrics-recording-only --no-first-run --safebrowsing-disable-auto-update --enable-automation --password-store=basic --use-mock-keychain --remote-debugging-port=0 --user-data-dir=/tmp/puppeteer_dev_profile-ria4kq --flag-switches-begin --flag-switches-end --file-url-path-alias=/gen=/home/khizar/solutions2/node_modules/puppeteer/.local-chromium/linux-624492/chrome-linux/gen about:blank\r\n--\r\n\r\n\r\n\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_below code can reproduce this error._\r\n\r\n```\r\nconst puppeteer = require('puppeteer');\r\nconst URL=require('url').URL;\r\n(async () => {\r\n  let browser = await puppeteer.launch({\r\n    headless:false,\r\n    isMobile:true,\r\n    hasTouch:true,\r\n    args:[\r\n    ]});\r\n  let whiteDomain=['is.gd'];\r\n  let page = await browser.newPage();\r\n\r\n  //manipulation of header starts\r\n  await page.setRequestInterception(true);\r\n  await page.setExtraHTTPHeaders(['header1:value2','header2:value2']);\r\n\tpage.on('request', request => {    \r\n\t  // Override headers\r\n    let url=request.url();\r\n    let urlObj=new URL(url);\r\n\t  const headers = Object.assign({}, request.headers(), {\r\n\t    foo: 'bar', // set \"foo\" header\r\n\r\n\t  });\r\n    if(whiteDomain.includes(urlObj.hostname))\r\n    {\r\n      console.log(\"adding header\");\r\n      request.continue({headers});\r\n    }\r\n    else\r\n    {\r\n      request.continue();\r\n    }\r\n    console.log(\"continue should be called by now\");\r\n\t});\r\n  //manipulation of header ends;\r\n  await page.goto('http://google.com');\r\n})();\r\n```\r\n\r\n\r\n\r\n**What is the expected result?**\r\nheader should be manipulated and redirected to other page if page response status code is 302\r\n\r\n**What happens instead?**\r\npage loading forever in pending status\r\n"},{"labels":["bug",null],"text":"* Puppeteer version: 1.12.0-post (chromium_revision 624487)\r\n* Platform / OS version: Windows 7 x64\r\n* URLs (if applicable): https://example.org/, https://example.net/, https://example.com/\r\n* Node.js version: 11.9.0\r\n\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async function main() {\r\n  try {\r\n    const browser = await puppeteer.launch({ headless: false });\r\n    const [page] = await browser.pages();\r\n\r\n    await page.goto('https://example.org/');\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n})();\r\n```\r\n```\r\nError: net::ERR_CONNECTION_CLOSED at https://example.org/\r\n    at navigate (puppeteer\\lib\\FrameManager.js:101:37)\r\n    at processTicksAndRejections (internal/process/next_tick.js:81:5)\r\n  -- ASYNC --\r\n    at Frame.<anonymous> (puppeteer\\lib\\helper.js:108:27)\r\n    at Page.goto (puppeteer\\lib\\Page.js:662:49)\r\n    at Page.<anonymous> (puppeteer\\lib\\helper.js:109:23)\r\n    at main (test.js:12:16)\r\n    at processTicksAndRejections (internal/process/next_tick.js:81:5)\r\n```\r\nError page in the browser window: `ERR_CONNECTION_CLOSED`.\r\n\r\nThe same URLs in the desktop browser are OK. Other URLs (google, Github etc) in the puppeteer browser are also OK.\r\n\r\nCan anybody reproduce?\r\n"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: Master branch\r\n* Platform / OS version: MacOS 10.14.2\r\n* Node.js version: v8.10\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```js\r\n(async() => {\r\n    var options =  { headless : true, };\r\n    var browser = await puppeteer.launch(options);\r\n    var browserWSEndpoint = browser.wsEndpoint();\r\n\r\n    var browser2 = await puppeteer.connect({ browserWSEndpoint });\r\n    var page = (await browser2.pages())[0];\r\n    await page.evaluateOnNewDocument(() => {console.log('Loading js helper1');});\r\n    await page.goto(\"https://www.google.com\");\r\n    browser2.disconnect();\r\n\r\n    var browser3 = await puppeteer.connect({ browserWSEndpoint });\r\n    var page2 = (await browser3.pages())[0];\r\n    await page2.goto(\"https://www.google.com\");\r\n    await page2.evaluateOnNewDocument(() => {console.log('Loading js helper1');});\r\n\r\n    browser3.disconnect();\r\n    browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\nIt shouldn't fail.\r\n\r\n**What happens instead?**\r\nI'm getting a \r\n````\r\n(node:28860) UnhandledPromiseRejectionWarning: Error: INTERNAL ERROR: missing context with id = 0\r\nwarning.js:18\r\n    at assert (/Users/neo/Documents/Coding/Open Source/puppeteer/lib/helper.js:278:11)\r\n    at FrameManager.executionContextById (/Users/neo/Documents/Coding/Open Source/puppeteer/lib/FrameManager.js:308:5)\r\n    at Page._onConsoleAPI (/Users/neo/Documents/Coding/Open Source/puppeteer/lib/Page.js:504:40)\r\n    at CDPSession.Page.client.on.event (/Users/neo/Documents/Coding/Open Source/puppeteer/lib/Page.js:133:57)\r\n    at emitOne (events.js:116:13)\r\n    at CDPSession.emit (events.js:211:7)\r\n    at CDPSession._onMessage (/Users/neo/Documents/Coding/Open Source/puppeteer/lib/Connection.js:216:12)\r\n    at Connection._onMessage (/Users/neo/Documents/Coding/Open Source/puppeteer/lib/Connection.js:99:19)\r\n    at WebSocketTransport._ws.addEventListener.event (/Users/neo/Documents/Coding/Open Source/puppeteer/lib/WebSocketTransport.js:41:24)\r\n    at WebSocket.onMessage (/Users/neo/Documents/Coding/Open Source/puppeteer/node_modules/ws/lib/event-target.js:120:16)\r\n(node:28860) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). (rejection id: 1)\r\nwarning.js:18\r\n```\r\n\r\nThis was reported on Puppeteer-Sharp https://github.com/kblok/puppeteer-sharp/issues/856"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.11.0\r\n* Platform / OS version: Windows 10 1803\r\n* Node.js version: 10.14.2\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n````javascript\r\nconst puppeteer = require('puppeteer');\r\nconst readline = require(\"readline\");\r\nconst rl = readline.createInterface({\r\n    input: process.stdin,\r\n    output: process.stdout\r\n});\r\nasync function main() {\r\n    browser = await puppeteer.launch();\r\n    rl.close();\r\n    await browser.close();  \r\n    console.log(\"this line will not be executed.\");\r\n}\r\nmain();\r\n````\r\n\r\n1. run above program, you will find program blocks at `await browser.close();` and `console.log(\"...\")` will never be reached.\r\n2. move rl.close() after `await browser.close();` solves this problem.\r\n3. According to [this answer](https://stackoverflow.com/a/54318611/2661043), this issue also disappears if terminal option of readline.createInterface() is set to false.\r\n\r\n**What is the expected result?**\r\nProgram exits normally. And \"this line will not be executed.\" should be printed.\r\n\r\n**What happens instead?**\r\nProgram hangs, no output.\r\n"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n```\r\nawait page.waitForFunction(`\r\n  (() => true)()`);\r\n```\r\nnever returns, but\r\n\r\n```\r\nawait page.waitForFunction(`(() => true)()`);\r\n```\r\ndoes. I expect them both to return immediately.\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.11.0\r\n* Platform / OS version: MacOS\r\n* URLs (if applicable):\r\n* Node.js version: 8.9.1\r\n"},{"labels":["bug",null],"text":"Puppeteer: v1.11.0\r\n\r\nIn headful mode, `browser.close` doesn't force-close browser, stalling the process in case of beforeunload dialogs. This is a little surprising to me - I'd expect beforeunloads to be ignored by default.\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\n  const browser = await puppeteer.launch({\r\n    headless: false,\r\n    userDataDir: 'ppp',\r\n  });\r\n  const page = await browser.newPage();\r\n  await page.goto('https://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_onbeforeunload');\r\n  const frame = page.frames().find(frame => frame.name() === 'iframeResult');\r\n  await Promise.all([\r\n    // make sure beforeunload triggers once\r\n    new Promise(resolve => page.once('dialog', resolve)).then(dialog => dialog.dismiss()),\r\n    frame.click('a'),\r\n  ]);\r\n  // This will hang forever\r\n  console.log('Exiting...');\r\n  await browser.close();\r\n  console.log('Done.');\r\n})();\r\n```"},{"labels":["bug",null],"text":"I'm using puppeteer just to extract some information from html, setting the content using page.setContent(). This is extremely slow, even though I never navigate to an actual website.\r\n\r\n### Steps to reproduce\r\n\r\n* Puppeteer version: 1.11.0\r\n* Platform / OS version: Ubuntu 18.04\r\n* Node.js version: v11.3.0\r\n\r\n### Minimal example:\r\n\r\n```ts\r\nimport chrome, { Page } from \"puppeteer\"\r\n\r\nconst content = `\r\n<div>\r\n    ${Array(1000)\r\n      .fill(\"<p>test</p>\")\r\n      .join(\"\\n\")}\r\n</div>`\r\n\r\nconst count = 100\r\n\r\nasync function testNoBlank(tab: Page) {\r\n  for (let i = 0; i < count; i++) {\r\n    await tab.setContent(content)\r\n    const ret = await tab.$$eval(\"p\", ps => ps.map(p => p.textContent))\r\n    console.assert(ret.length === 1000)\r\n  }\r\n}\r\nasync function testBlank(tab: Page) {\r\n  for (let i = 0; i < count; i++) {\r\n    await tab.setContent(content)\r\n    const ret = await tab.$$eval(\"p\", ps => ps.map(p => p.textContent))\r\n    console.assert(ret.length === 1000)\r\n    await tab.goto(\"about:blank\")\r\n  }\r\n}\r\n\r\nasync function both() {\r\n  const browser = await chrome.launch({ headless: true })\r\n  const [tab] = await browser.pages()\r\n  console.time(\"blank\")\r\n  await testBlank(tab)\r\n  console.timeEnd(\"blank\")\r\n  await tab.goto(\"about:blank\")\r\n  console.time(\"no blank\")\r\n  await testNoBlank(tab)\r\n  console.timeEnd(\"no blank\")\r\n\r\n  await browser.close()\r\n}\r\n\r\nboth()\r\n```\r\n\r\n### Output:\r\n\r\n```\r\nblank: 3568.199ms\r\nno blank: 191955.917ms\r\nDone in 196.83s.\r\n```\r\n\r\nWithout `goto(\"about:blank\")` in between `setContent` calls  it is 50x! slower.\r\n\r\nI found this by accident. If this can't be fixed, it should at least be mentioned in the docs, since `setContent` seems to be the canonical method to load html from a string."},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.4.2 (puppeteer-firefox)\r\n* Platform / OS version: Ubuntu 18.04.1 LTS\r\n* Node.js version: v10.14.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. Execute `await puppeteer.launch({dumpio: true})` on Ubuntu Trusty (Travis)\r\n2. The following trace can be seen in the console:\r\n\r\n```\r\nFailed to launch Firefox!\r\n    at onClose (/home/travis/build/Mogztter/puppeteer-firefox-travis/node_modules/puppeteer-firefox/lib/firefox/Launcher.js:174:14)\r\n    at Interface.helper.addEventListener (/home/travis/build/Mogztter/puppeteer-firefox-travis/node_modules/puppeteer-firefox/lib/firefox/Launcher.js:163:50)\r\n    at Interface.emit (events.js:187:15)\r\n    at Interface.close (readline.js:379:8)\r\n    at Socket.onend (readline.js:157:10)\r\n    at Socket.emit (events.js:187:15)\r\n    at endReadableNT (_stream_readable.js:1094:12)\r\n    at process._tickCallback (internal/process/next_tick.js:63:19)\r\n```\r\n*Please note that the root cause is not printed.*\r\n\r\n**What is the expected result?**\r\n\r\nThe root cause should be printed in the console since we are using `dumpio` (ie. why Firefox failed to launch).\r\n\r\n**What happens instead?**\r\n\r\nThe Firefox process does not trigger the event `exit` because when Firefox failed to launch, the exception is catch and the process is killed using `killFirefox`:\r\n\r\nhttps://github.com/GoogleChrome/puppeteer/blob/8aaca4eb1ed4020c56d03e3957c1e64e9a0e8b45/experimental/puppeteer-firefox/lib/firefox/Launcher.js#L125-L128\r\n\r\nBasically the error message is lost because the process is killed immediately (ie. the process does not have time to exit gracefully).\r\nI think we should use `waitForFirefoxToClose` promise to give the process a chance to exit gracefully (within a timeout) and only after force kill the process if the process is still not closed:\r\n\r\nhttps://github.com/GoogleChrome/puppeteer/blob/8aaca4eb1ed4020c56d03e3957c1e64e9a0e8b45/experimental/puppeteer-firefox/lib/firefox/Launcher.js#L92-L104\r\n\r\n"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.4.2 (`puppeteer-firefox`)\r\n* Platform / OS version: Ubuntu 18.04.1 LTS\r\n* Node.js version: v10.14.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. Create a file named `main.js` with the following content:\r\n\r\n**main.js**\r\n```js\r\nconst b = process.env.PUPPETEER_BROWSER || 'chrome'\r\nconst puppeteer = b === 'firefox' ?\r\n  require('puppeteer-firefox') :\r\n  require('puppeteer')\r\n\r\nconst path = require('path')\r\n\r\n;(async function () {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage()\r\n  page.on('load', () => console.log('load'))\r\n  page.on('domcontentloaded', () => console.log('domcontentloaded'))\r\n  page.on('console', () => console.log('console'))\r\n  page.on('pageerror', () => console.log('pageerror'))\r\n  await page.goto('file://' + path.join(__dirname, 'index.html'))\r\n  await page.close();\r\n  await browser.close();\r\n})()\r\n```\r\n2. Create a file named `index.html` with the following content:\r\n\r\n**index.html**\r\n\r\n```html\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <title>Hello</title>\r\n  <meta charset=\"utf-8\"/>\r\n</head>\r\n<body>\r\n<script>console.log('hello')</script>\r\n</body>\r\n</html>\r\n```\r\n3. Run the script `main.js` against Chrome:\r\n\r\n```\r\nnode main.js \r\n```\r\n```\r\nconsole\r\nload\r\ndomcontentloaded\r\n```\r\nAll good with `puppeteer` Chrome.\r\n\r\n4. Run the script `main.js` against Firefox\r\n```\r\nPUPPETEER_BROWSER=firefox node main.js\r\n```\r\n```\r\n(empty)\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nFirst of all thanks for this amazing project! :heart_eyes: :clap: \r\nPuppeteer for Firefox should trigger the following events and/or the `Page` should be notified:\r\n\r\n* `console`\r\n* `load`\r\n* `domcontentloaded`\r\n\r\nI'm aware that Puppeteer for Firefox is experimental but the documentation page does list these events as \"Supported API\": https://github.com/GoogleChrome/puppeteer/tree/master/experimental/puppeteer-firefox#readme\r\n\r\n\r\n**What happens instead?**\r\n\r\nNo event was triggered :neutral_face: \r\n\r\n"},{"labels":["bug",null],"text":"Simplification : \r\n\r\nI have a website with links.  \r\nAfter clicking on each link , it goes to a new page that I need to  visit the links ( by **clicking** , not navigating).\r\n\r\nVisualization : \r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\nI've managed to do 99% percent of the job: \r\n\r\n\r\n    (async () =>\r\n    {\r\n        const browser = await puppeteer.launch({headless: false});\r\n        const page = await browser.newPage();\r\n        let url = \"https://www.mutualart.com/Artists\";\r\n        console.log(`Fetching page data for : ${url}...`);\r\n        await page.goto(url);\r\n        await page.waitForSelector(\".item.col-xs-3\");\r\n        let arrMainLinks: ElementHandle[] = await page.$$('.item.col-xs-3 > a');   //get the main links\r\n\r\n        console.log(arrMainLinks.length); // 16\r\n\r\n        \r\n        for (let mainLink of arrMainLinks) //foreach main link let's click it\r\n        {\r\n            let hrefValue =await (await mainLink.getProperty('href')).jsonValue();\r\n            console.log(\"Clicking on \" + hrefValue);\r\n            await Promise.all([\r\n                                  page.waitForNavigation(),\r\n                                  mainLink.click({delay: 100})\r\n                              ]);\r\n\r\n            // let's get the sub links\r\n            let arrSubLinks: ElementHandle[] = await page.$$('.slide >a');\r\n            \r\n            //let's click on each sub click\r\n            for (let sublink of arrSubLinks)\r\n            {\r\n                console.log('██AAA');\r\n               \r\n                await Promise.all([\r\n                                      page.waitForNavigation(),\r\n                                      sublink.click({delay: 100})\r\n                                  ]);\r\n                console.log('██BBB');\r\n               \r\n                // await page.goBack() \r\n                break;\r\n            }\r\n            break;\r\n            \r\n        }\r\n       \r\n        await browser.close();\r\n    })();\r\n\r\n**So where is the problem ?** \r\n\r\nIt reaches the ██AAA   \r\nBut it never reaches ██BBB\r\n\r\nAnd I get an error : \r\n\r\n     C:\\temp\\puppeterr1\\app>node server2.js\r\n    Fetching page data for : https://www.mutualart.com/Artists...\r\n    16\r\n    Clicking on https://www.mutualart.com/Artist/Mr--Brainwash/9B3FED6BB81E6B8E\r\n    ██AAA\r\n    (node:17200) UnhandledPromiseRejectionWarning: TimeoutError: Navigation Timeout Exceeded: 30000ms exceeded\r\n        at Promise.then (C:\\temp\\puppeterr1\\node_modules\\puppeteer\\lib\\FrameManager.js:1230:21)\r\n        at <anonymous>\r\n      -- ASYNC --\r\n        at Frame.<anonymous> (C:\\temp\\puppeterr1\\node_modules\\puppeteer\\lib\\helper.js:144:27)\r\n        at Page.waitForNavigation (C:\\temp\\puppeterr1\\node_modules\\puppeteer\\lib\\Page.js:599:49)\r\n        at Page.<anonymous> (C:\\temp\\puppeterr1\\node_modules\\puppeteer\\lib\\helper.js:145:23)\r\n        at Object.<anonymous> (C:\\temp\\puppeterr1\\app\\server2.js:127:30)\r\n        at step (C:\\temp\\puppeterr1\\app\\server2.js:32:23)\r\n        at Object.next (C:\\temp\\puppeterr1\\app\\server2.js:13:53)\r\n        at fulfilled (C:\\temp\\puppeterr1\\app\\server2.js:4:58)\r\n        at <anonymous>\r\n        at process._tickCallback (internal/process/next_tick.js:188:7)\r\n    (node:17200) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). (rejection id: 1)\r\n    (node:17200) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n\r\n\r\n\r\n**Question:**\r\n\r\nWhat am I missing here ?   \r\nWhy can't it reach the ██BBB ? \r\n\r\nis it a bug ?\r\n\r\n[Complete code][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/oOxJB.png\r\n  [2]: https://gist.github.com/RoyiNamir/f87637161ee02b8f6c790bc9b6a4097c"},{"labels":["bug",null,null],"text":"Umbrella bug for all request interception issues in Puppeteer.\r\nThis mostly depends on upstream Chromium bug: https://crbug.com/899386\r\n\r\n#### Description\r\n\r\nDevTools Protocol emits two events for every intercepted request:\r\n- [`Network.requestWillBeSent(requestId)`](https://vanilla.aslushnikov.com/#Network.requestWillBeSent)\r\n- [`Network.requestIntercepted(interceptionId)`](https://vanilla.aslushnikov.com/#Network.requestIntercepted)\r\n\r\nPuppeteer extracts different pieces of information from these events. However, since `interceptionId` and `requestId` aren't matching, Puppeteer uses [heuristics](https://github.com/GoogleChrome/puppeteer/blob/9800b2c3c2d31379badb9d4dab1cc8fc95aee48a/lib/NetworkManager.js#L640-L672) to match these events together. This is necessary to provide a consistent API to our clients.\r\n\r\nUnfortunately, these heuristics aren't reliable and break under different corner cases: #1664, #2848, #3030, #3369 and so on.\r\n\r\n#### Mitigation\r\n\r\nWe weren't able to fix this upstream up until today due to the network stack refactoring in Chromium. Now, with Network Service getting gradually adopted, we can fix this upstream.\r\n\r\nThe plan is:\r\n1. Enable Network Service by default to Puppeteer users\r\n2. Fix network instrumentation in DevTools protocol for the Network Service and migrate onto it. (see https://crbug.com/899386)."},{"labels":["bug",null,null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n* Puppeteer version: 1.9.0\r\n* Platform / OS version: OSX Mojave\r\n* Node.js version: v8.12.0\r\n\r\n**What steps will reproduce the problem?**\r\n1. create a html file\r\n```html\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <style>\r\n    * {\r\n      margin: 0;\r\n      padding: 0;\r\n    }\r\n\r\n    @page {\r\n      size: 794px 1123px;\r\n      margin: 0;\r\n      overflow: hidden;\r\n    }\r\n\r\n    @media print {\r\n      .page {\r\n        page-break-after: always;\r\n      }\r\n    }\r\n\r\n    .page {\r\n      width: 794px;\r\n      height: 1120px;\r\n      position: relative;\r\n      overflow: hidden;\r\n    }\r\n\r\n    .page>div {\r\n      width: 200px;\r\n      height: 200px;\r\n      font-size: 160px;\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n    }\r\n\r\n    .page .negative-top {\r\n      top: -120px;\r\n    }\r\n\r\n    .page .ok {\r\n      background: greenyellow;\r\n    }\r\n\r\n    .page .problem {\r\n      background: red;\r\n      color: #ffffff;\r\n    }\r\n\r\n  </style>\r\n</head>\r\n\r\n<body>\r\n  <div class=\"page\">\r\n    <div class=\"negative-top ok\">1</div>\r\n  </div>\r\n  <div class=\"page\">\r\n    <div class=\"negative-top problem\">2</div>\r\n  </div>\r\n  <div class=\"page\">\r\n    <div class=\"negative-top problem\">3</div>\r\n  </div>\r\n</body>\r\n\r\n</html>\r\n\r\n```\r\n2. generate a PDF file\r\n```js\r\nconst browser = await puppeteer.launch()\r\nconst page = await browser.newPage()\r\nawait page.goto('html file url', { waitUntil: 'networkidle0' })\r\nawait page.pdf({\r\n    path: 'test.pdf',\r\n    printBackground: true,\r\n    preferCSSPageSize: true,\r\n})\r\nawait browser.close()\r\n```\r\n\r\n3. open the test.pdf  then find the difference between pdf and html in page 2 & 3, page one is render correct.\r\n\r\n**What is the expected result?**\r\nPDF file should render the absolute element  same as the chrome browser \r\n\r\n**What happens instead?**\r\npage one render same as the browser, start from the page 2, absolute element's children is render not correct\r\n\r\n**Browser output**\r\n![browser render](https://user-images.githubusercontent.com/2560843/47726294-2b548f80-dc95-11e8-8e4b-fdb44ac0f530.png)\r\n\r\n***\r\n\r\n**PDF output**\r\n![puppeteer pdf  render](https://user-images.githubusercontent.com/2560843/47726279-1d067380-dc95-11e8-94a1-605626fc71fe.png)\r\n\r\n\r\n\r\n"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.9.0\r\n* Platform / OS version: Ubuntu x64\r\n* Node.js version: v10.12.0\r\n* Chrome version: 71.0.3578.20 (beta)\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nThe smallest example I was able to make:\r\n\r\n```js\r\n    await page.evaluate(() => {\r\n      const url = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=='\r\n\r\n      return window.fetch(url)\r\n        .then(res => res.blob())\r\n        .then(blob => URL.createObjectURL(blob))\r\n        .then(url => window.fetch(url)) // crashes here\r\n        .then(res => res.blob())\r\n    })\r\n```\r\n\r\n**What is the expected result?**\r\nOn Chrome 70 or Chrome 71 headfull it works fine\r\n\r\n**What happens instead?**\r\nOn Chrome 71 in headless mode I get: `Failed to load resource: net::ERR_UNKNOWN_URL_SCHEME`\r\n\r\n"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.9.0-post (chromium_revision 599821)\r\n* Platform / OS version: Windows 7 x64\r\n* URLs (if applicable): any?\r\n* Node.js version: 11.0.0 (or 12.0.0-v8-canary)\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nThis script is OK:\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async function main() {\r\n  try {\r\n    const browser = await puppeteer.launch({\r\n      headless: true,\r\n    });\r\n    const [page] = await browser.pages();\r\n\r\n    await page.goto('https://example.org/');\r\n\r\n    console.log(await page.evaluate(() => document.title));\r\n\r\n    await browser.close();\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n})();\r\n```\r\n\r\nThis hangs with high CPU load and no error messages:\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async function main() {\r\n  try {\r\n    const browser = await puppeteer.launch({\r\n      headless: true,\r\n      userDataDir: 'test-profile-dir',\r\n    });\r\n    const [page] = await browser.pages();\r\n\r\n    await page.goto('https://example.org/');\r\n\r\n    console.log(await page.evaluate(() => document.title));\r\n\r\n    await browser.close();\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n})();\r\n```"},{"labels":["bug",null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\nWhen page.setRequestInterception(true); redirections don't happen correctly\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.7.0\r\n* Platform / OS version: Mac 10.13.6\r\n* URLs (if applicable):\r\n* Node.js version: 8.11.4\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\nasync function checkLink() {\r\n\tlet browser = await puppeteer.launch({ headless: true });\r\n\tlet page = await browser.newPage();\r\n\tawait page.setRequestInterception(true);\r\n\tawait page.setUserAgent('Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5 Build/LMY48B; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/43.0.2357.65 Mobile Safari/537.36');\r\n\tlet redirects = {};\r\n\tpage.on('request', request => {\r\n\t\tif (['image', 'stylesheet', 'font', 'script'].indexOf(request.resourceType()) !== -1) {\r\n\t\t\trequest.abort();\r\n\t\t} else {\r\n\t\t\trequest.continue();\r\n\t\t}\r\n\t});\r\n\tpage.on('requestfailed', (req, resp) => {\r\n\t\tlet failureText = req.failure().errorText;\r\n\t\tif (failureText == 'net::ERR_ABORTED' || failureText == 'net::ERR_UNKNOWN_URL_SCHEME') {\r\n\t\t\tredirects[req.url()] = {\r\n\t\t\t\turl: req.url(),\r\n\t\t\t\tstatus: req.response() ? req.response().status() : 200\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\tpage.on('response', response => {\r\n\t\tlet responseHeaders = response.headers();\r\n\t\tredirects[response.request().url()] = {\r\n\t\t\turl: response.request().url(),\r\n\t\t\tstatus: response.status()\r\n\t\t}\r\n\t})\r\n\ttry {\r\n\t\tconst response = await page.goto('https://demo.vnative.net/5bc72b2fb6920d1c45045435', {\r\n\t\t\ttimeout: 60000,\r\n\t\t\twaitUntil: ['domcontentloaded', 'networkidle0', 'networkidle2']\r\n\t\t});\r\n\t} catch (e) {\r\n\t\tconsole.log(e);\r\n\t}\r\n\tawait page.close();\r\n\tawait browser.close();\r\n\treturn redirects;\r\n}\r\n\r\ncheckLink().then(d => console.log(d)).catch(e => console.log(e));\r\n```\r\n\r\n1. Save the code in the file and run it with Node\r\n\r\n**What is the expected result?**\r\n\r\n```js\r\n{ 'https://demo.vnative.net/5bc72b2fb6920d1c45045435':\r\n   { url: 'https://demo.vnative.net/5bc72b2fb6920d1c45045435',\r\n     status: 200 },\r\n  'https://demo.vnative.net/a/v/blue.gif?ps=NDE=&ans=ODY=&cd=SkC2TvBoTprlPg8EQF9h3YrbSekmTEz2hDX3kC3Owft9LfldPd5n8tA4t18A1Ag42-Lb38mb6ZxXb3N0_uC64IaN089hlidkqkVBCbLi-fJ2LzMFtwT2Xlpt--dSmcxZQGjVhxdnZcHNIIir6Z9hSDNkK30eVJHsUixonheL-NokZstGNDAAikkzkg8ZoFJCH3nfVeXrU7X7y2QlYAiKTND0-l1MSAcq55zTzyx5JsW9j0fLgYi53Ssib4E5hkJgLHjGSQyy7fB9n0R9EjDzfLE7cGVlkcVbmaZVRjCaWXK5oAdAO94UqJF1PBg0C0Ss':\r\n   { url: 'https://demo.vnative.net/a/v/blue.gif?ps=NDE=&ans=ODY=&cd=SkC2TvBoTprlPg8EQF9h3YrbSekmTEz2hDX3kC3Owft9LfldPd5n8tA4t18A1Ag42-Lb38mb6ZxXb3N0_uC64IaN089hlidkqkVBCbLi-fJ2LzMFtwT2Xlpt--dSmcxZQGjVhxdnZcHNIIir6Z9hSDNkK30eVJHsUixonheL-NokZstGNDAAikkzkg8ZoFJCH3nfVeXrU7X7y2QlYAiKTND0-l1MSAcq55zTzyx5JsW9j0fLgYi53Ssib4E5hkJgLHjGSQyy7fB9n0R9EjDzfLE7cGVlkcVbmaZVRjCaWXK5oAdAO94UqJF1PBg0C0Ss',\r\n     status: 200 },\r\n  'https://r4i-1.tlnk.io/serve?action=click&agency_id=1371&campaign_id_android=419342&destination_id_android=433748&publisher_id=31&site_id_android=128738&ref_id=102f5382f5969ff81d4ad4d1daa910&sub_publisher=testing_31_&ios_ifa=&google_aid=&sub3=18587&ckey=15102ae1bd15946317d6bc2aa980f00e&data=5bc73d3d7b741c04afc9c39d':\r\n   { url: 'https://r4i-1.tlnk.io/serve?action=click&agency_id=1371&campaign_id_android=419342&destination_id_android=433748&publisher_id=31&site_id_android=128738&ref_id=102f5382f5969ff81d4ad4d1daa910&sub_publisher=testing_31_&ios_ifa=&google_aid=&sub3=18587&ckey=15102ae1bd15946317d6bc2aa980f00e&data=5bc73d3d7b741c04afc9c39d',\r\n     status: 302 },\r\n  'market://details?id=jp.co.atm.vcon.jp&referrer=mat_click_id%3Db77a8e74734a1967b242af01645de275-20181017-15486':\r\n   { url: 'market://details?id=jp.co.atm.vcon.jp&referrer=mat_click_id%3Db77a8e74734a1967b242af01645de275-20181017-15486',\r\n     status: 200 } }\r\n```\r\nThe given URL redirects to a marketplace URI with opened with Android user agent but with Page.setRequestInterception -> true it fails to complete the request\r\n\r\n**What happens instead?**\r\n\r\n```js\r\n{ 'https://demo.vnative.net/5bc72b2fb6920d1c45045435':\r\n   { url: 'https://demo.vnative.net/5bc72b2fb6920d1c45045435',\r\n     status: 200 },\r\n  'https://r4i-1.tlnk.io/serve?action=click&agency_id=1371&campaign_id_android=419342&destination_id_android=433748&publisher_id=31&site_id_android=128738&ref_id=102f5382f5969ff81d4ad4d1daa910&sub_publisher=testing_31_&ios_ifa=&google_aid=&sub3=18587&ckey=15102ae1bd15946317d6bc2aa980f00e&data=5bc73c95be608d04b897e13c':\r\n   { url: 'https://r4i-1.tlnk.io/serve?action=click&agency_id=1371&campaign_id_android=419342&destination_id_android=433748&publisher_id=31&site_id_android=128738&ref_id=102f5382f5969ff81d4ad4d1daa910&sub_publisher=testing_31_&ios_ifa=&google_aid=&sub3=18587&ckey=15102ae1bd15946317d6bc2aa980f00e&data=5bc73c95be608d04b897e13c',\r\n     status: 200 } }\r\n```\r\n\r\nInstead it fails after the second request https://r4i-1.tlnk.io/serve.. which is sending a 302 response with location header `market://details?id=jp.co.atm.vcon.jp..`\r\n\r\nif you comment out the page.setRequestInterception everything works perfectly but unfortunately I need to intercept the requests.\r\n\r\nAny solution / workaround would be appreciated\r\n"},{"labels":["bug",null],"text":"I've been using this code for a while and it worked flawlessly, until today I found an URL which always fails to load with TimeoutException. Here's the test function code:\r\n\r\n```\r\nconst puppeteer = require(\"puppeteer\");\r\n\r\n(async () => {\r\n\tconst browser = await puppeteer.launch();\r\n\tconst page = await browser.newPage();\r\n\tawait page.setDefaultNavigationTimeout(120000);\r\n\tawait page.setRequestInterception(true);\r\n\tpage.on(\"request\", request => {\r\n\t\trequest.continue();\r\n\t});\r\n\r\n\ttry {\r\n\t\tconst response = await page.goto(\"http://curious.astro.cornell.edu/the-universe/cosmology-and-the-big-bang/104-the-universe/cosmology-and-the-big-bang/expansion-of-the-universe/616-is-the-universe-expanding-faster-than-the-speed-of-light-intermediate\");\r\n\t\tconsole.log(\"Response code: \" + response.status() + (response.ok() ? \" (OK)\" : \" (ERROR)\"));\r\n\t} catch(exc) {\r\n\t\tconsole.log(\"Response: empty.\");\r\n\t}\r\n\r\n\tawait browser.close();\r\n})();\r\n```\r\n\r\nWhen I Initially discovered this bug(?), I was using request interception to filter out images, but then I found out one does not have to abort any requests at all in order for the problem to appear. This `page.goto()` will always time out, as you can see, I even upped the timeout to 2 minutes and it made no difference. But as soon as you comment out the request interception part, it loads no problem in 7-8 seconds and reports status \"200 (OK)\".\r\n\r\n**Environment**:\r\nWindows 10 x64\r\nPuppeteer v 1.9.0, Chromium: bundled\r\nNode v8.11.4"},{"labels":["bug",null,null],"text":"* Puppeteer version: 1.8.0\r\n* Platform / OS version: Windows/ Cent OS\r\n* URLs (if applicable): N/A\r\n* Node.js version: 10.11.0\r\n\r\n**steps will reproduce the problem**\r\n```\r\n<html>\r\n<head>Head Title</head>\r\n<body>\r\n<br/>\r\n<span>www.totallystupid.com</span>\r\n</body>\r\n</html>\r\n```\r\n\r\n```\r\n'use strict';\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\n  const browser = await puppeteer.launch({executablePath: 'C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe'});\r\n  const page = await browser.newPage();\r\n  await page.goto('file:///C:/Users/test/Downloads/test.html', {waitUntil: 'networkidle2'});\r\n  \r\n  // page.pdf() is currently supported only in headless mode.\r\n  // @see https://bugs.chromium.org/p/chromium/issues/detail?id=753118\r\n  \r\n  await page.pdf({\r\n    path: 'test.html.pdf',\r\n    format: 'letter'\r\n  });\r\n\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\nIt should not links for www.totallystupid.com when a PDF is created.\r\n\r\n**What happens instead?**\r\nIt creates links for www.totallystupid.com when a PDF is created.\r\n\r\n"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**My environment:**\r\n\r\n* Puppeteer version: 1.8.0\r\n* Platform / OS version: Windows 10 Home (1803)\r\n* URLs (if applicable): - \r\n* Node.js version: 8.11.2\r\n\r\n**Steps to reproduce the problem:**\r\n\r\n```javascript\r\n...\r\nlet tab = await this.browser.newPage();\r\n\r\nawait tab.setRequestInterception(true);\r\n\r\ntab.on('request', async request => {\r\n    console.log(request.url());\r\n});\r\n```\r\n\r\n1. Create webpage with ajax request to e.g. \"myapp://hello\"\r\n2. Create listener for `request` event\r\n3. Set Request Interception on true.\r\n4. Run\r\n\r\n**What is the expected result?**\r\nPuppeteer should emit `request` event with intercepted request to \"myapp://hello\".\r\n\r\n**What happens instead?**\r\nPuppeter not emiting `request` event with intercepted request to \"myapp://hello\". If `Request Interception` is disabled, working fine but I can't use `request.respond()`,\r\n"},{"labels":["bug",null],"text":"* Puppeteer version: 1.7.0\r\n* Platform / OS version: Linux x64\r\n* Node.js version: v10.0.0\r\n\r\nThis code works on Chorme/Chromium 69, \"Hello from logExposedFunction1\" and \"Hello from logExposedFunction2\" are logged to console, with Chrome 70 only  \"Hello from logExposedFunction2\" is logged.\r\n\r\nI noticed logging `logExposedFunction1` logs `ƒ () { [native code] }` and `logExposedFunction2` logs a js code from `__puppeteer_evaluation_script__:2`\r\n\r\nWas there an API change around this? I did not see anything at the change log \r\n\r\n```js\r\nconst puppeteer = require('puppeteer')\r\n\r\nconst start = async () => {\r\n  const browser = await puppeteer.launch({\r\n    headless: false,\r\n  });\r\n\r\n  const page = await browser.newPage();\r\n\r\n  await page.exposeFunction('logExposedFunction1', () => {\r\n    console.log('Hello from logExposedFunction1')\r\n  })\r\n  await page.evaluateOnNewDocument(() => {\r\n    logExposedFunction1()\r\n  })\r\n\r\n  await page.goto('https://example.com');\r\n\r\n  await page.exposeFunction('logExposedFunction2', () => {\r\n    console.log('Hello from logExposedFunction2')\r\n  })\r\n  await page.evaluate(() => {\r\n    logExposedFunction2()\r\n  })\r\n}\r\n\r\nstart()\r\n```\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.7.0\r\n* Platform / OS version: Windows 7\r\n* URLs (if applicable):\r\n* Node.js version: v9.10.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n    const browser = await puppeteer.launch({ headless: false, defaultViewport: null });\r\n    const page = await browser.newPage();\r\n    await page.goto('https://www.google.com/');\r\n    await page.screenshot({ path: 'example.png', fullPage: true });\r\n    await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\nNo error and screenshot is saved.\r\n\r\n**What happens instead?**\r\n`UnhandledPromiseRejectionWarning: TypeError: Cannot read property 'isMobile' of null`\r\n"},{"labels":["bug",null],"text":"Puppeteer version: 1.7.0\r\nPlatform / OS version: Win10\r\nNode.js version: 9.4.0\r\nChromium Version: r579032\r\n\r\nrequest.abort() works on image but doesn't work for stylesheet.\r\n\r\nFor example:\r\n\r\n```js\r\nvar puppeteer = require('puppeteer');\r\n(async () => {\r\n    const browser = await puppeteer.launch({\r\n        headless: false,\r\n        userDataDir: \"profile\",\r\n        ignoreHTTPSErrors: true,\r\n        dumpio: true,\r\n        args: ['--no-sandbox', '--disable-setuid-sandbox', '--disable-gpu']\r\n    });\r\n    const page = await browser.newPage();\r\n    await page.setCacheEnabled(false);\r\n    await page.setRequestInterception(true);\r\n    await page.on('request', request => {\r\n        if ((request.resourceType() === 'image') || (request.resourceType() === 'stylesheet')) {\r\n            request.abort();\r\n        } else {\r\n            request.continue();\r\n        }\r\n    });\r\n    await page.goto('http://www.milas.bel.tr/index.php?modul=2_16&ID=1246', {\r\n            waitUntil: ['networkidle0', 'load', 'domcontentloaded'],\r\n            timeout: 10000\r\n        })\r\n        .then(async () => {\r\n            //something\r\n        })\r\n        .catch(async (error) => {\r\n            console.log(error);\r\n            await browser.close();\r\n        });\r\n    await browser.close();\r\n})();\r\n```\r\n\r\nAbove code returns \r\n\r\n> \"Error: Navigation Timeout Exceeded: 10000ms exceeded\"\r\n"},{"labels":["bug"],"text":"Puppeteer v1.7.0 doesn't include `--disable-gpu` by default on OS X when launching \r\nhealdess browser.\r\n\r\nOn my MacBook Pro 2017, the following script yields 10x time difference between two launches: with and without `--disable-gpu` flag. **it is much faster to run with `--disable-gpu`**.\r\n\r\nWe should either fix `--disable-gpu` upstream or bring it back by default.\r\n\r\n```js\r\nconst pptr = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await pptr.launch({\r\n    //args: ['--disable-gpu'],\r\n  });\r\n  const page = await browser.newPage();\r\n  await page.setContent(`\r\n    <canvas width=800px height=800px></canvas>\r\n  `);\r\n\r\n  console.time('eval');\r\n  await page.$eval('canvas', canvas => {\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.setTransform(2, 0, 0, 2, 0, 0);\r\n  });\r\n  console.timeEnd('eval');\r\n  await browser.close();\r\n})();\r\n```"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.6.1  \r\n* Platform / OS version: macOS 10.13.6 \r\n* URLs (if applicable): -\r\n* Node.js version: 10.7.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\nconst devices = require('puppeteer/DeviceDescriptors');\r\n\r\nfunction getViewportDimensions () {\r\n  return {\r\n    innerWidth: window.innerWidth,\r\n    innerHeight: window.innerHeight,\r\n    outerWidth: window.outerWidth,\r\n    outerHeight: window.outerHeight,\r\n    devicePixelRatio: window.devicePixelRatio\r\n  };\r\n}\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch({ headless: true });\r\n  const page = await browser.newPage();\r\n  const device = devices['iPhone 6'];\r\n  console.log(device);\r\n  await page.emulate(device);\r\n  await page.target().createCDPSession();\r\n  await page.goto('https://www.google.com/');\r\n  const dimensions = await page.evaluate(getViewportDimensions);\r\n  console.log(dimensions);\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n1. Run the above code\r\n2. Remove the line `await page.target().createCDPSession();`\r\n3. Run the code again\r\n4. Add the line back and set `headless` to `false`\r\n5. Run the code again\r\n6. Set `headless` back to `true` and swap line ` await page.target().createCDPSession();` with line ` await page.emulate(device);`\r\n7. Run the code again\r\n\r\n**What is the expected result?**\r\n\r\nOutput is every time:\r\n\r\n```js\r\n{ innerWidth: 375,\r\n  innerHeight: 667,\r\n  outerWidth: 375,\r\n  outerHeight: 667,\r\n  devicePixelRatio: 2 }\r\n```\r\n\r\n**What happens instead?**\r\n\r\nIn step 1. output is\r\n\r\n```js\r\n{ innerWidth: 375,\r\n  innerHeight: 667,\r\n  outerWidth: 0,\r\n  outerHeight: 0,\r\n  devicePixelRatio: 1 }\r\n```"},{"labels":["bug"],"text":"**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.6.0\r\n* Platform / OS version: Ubuntu 16.04 LTS\r\n\r\nJust to let you know, 1.6.0 is pinned to a Chromium version with broken font rendering on Linux,\r\nso screenshots for Linux users might look bad.\r\n\r\nI think this was caused by a [fontconfig update](https://chromium.googlesource.com/chromium/src/+/a0c1584a2fade0146b7cd3380abe42feda02ad7c) and was eventually fixed in [this commit](https://chromium.googlesource.com/chromium/src.git/+/3ff47e60c5ce645973e57fc8dbe88b43d63edaf4). This should give you the timespan of \"broken\" Chromium builds.\r\n\r\nFor comparison:\r\n\r\n- Revision 574897 (currently pinned)\r\n![news ycombinator com_ 1](https://user-images.githubusercontent.com/6135391/42999787-5f2b5f1c-8c1f-11e8-9c30-b708706d427c.png)\r\n\r\n- Revision 576827 (latest build)\r\n![news ycombinator com_ 2](https://user-images.githubusercontent.com/6135391/42999788-5f487138-8c1f-11e8-999c-e90920e64e3f.png)\r\n\r\n"},{"labels":["bug"],"text":"* Puppeteer version: 1.6\r\n* Platform / OS version: windows 10\r\n* URLs (if applicable): all !\r\n* Node.js version: v8.11.3\r\n\r\nHi guys!\r\nI can not click when I set \"JavascriptEnabled\" to \"false\"!\r\nThis problem is solved only by changing \"false\" to \"true\"!\r\nIs this a problem of the \"puppeteer\" is?\r\n\r\n\r\n**What happens instead?**\r\nWhen \"click\" does not work, no output will not happen and is not even an error\r\n\r\n\r\n**Edit**:\r\nThis problem exists only in v1.6.0\r\nI tested in v1.5.0 and worked fine\r\n"},{"labels":["bug"],"text":"TLDR. I'm desperately hoping someone can help with this. I've been at it for 2 days and it's driving me crazy. I'm working on creating a simplified repro case but I'm hoping someone might be able to point me in the right direction. It feels like puppeteer is possibly getting a bit confused about context when running in a highly parallel environment, but I'm probably wrong. \r\n\r\nThis problem occurs both locally running Docker and on CircleCI.\r\n\r\n### Steps to reproduce\r\n\r\n```bash\r\n FAIL  __tests__/visual-regression/cta.test.js (79.643s)\r\n  ● 99-visual-regression-cta-cta - mobile - ltr\r\n\r\n    INTERNAL ERROR: missing context with id = 2\r\n\r\n      at assert (node_modules/puppeteer/lib/helper.js:251:11)\r\n      at FrameManager.createJSHandle (node_modules/puppeteer/lib/FrameManager.js:223:5)\r\n      at ExecutionContext.evaluateHandle (node_modules/puppeteer/lib/ExecutionContext.js:89:17)\r\n```\r\n\r\nWe an enormous visual regression test suite, a hundred or so prebuilt html files each containing a html component. We test each in 3 different viewports both right to left and left to right, so 6 visual regression tests per file using [jest-image-snapshot](https://github.com/americanexpress/jest-image-snapshot). We have the tests broken down into a bunch of different files so jest is able to run them in parallel. \r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.5.1\r\n* Platform / OS version: [circleci/node:8-browsers](https://hub.docker.com/r/circleci/node/)\r\n* Node.js version: 8\r\n* Jest: 22.4.3\r\n* Jest-image-snapshot: 2.4.0\r\n\r\n**Sample**\r\n\r\nExample runner\r\n```javascript\r\nrequire('../_lib/visual-regression').performVisualRegression('foo/bar/');\r\n```\r\n\r\nSimplified visual-regression.js.\r\n```javascript\r\nfunction performVisualRegression(dir, viewports = viewportSpecs.map((v) => v.id)) {\r\n  const slugs = getSlugs(dir);\r\n\r\n  for (const slug of slugs) {\r\n    for (const viewport of viewportSpecs.filter((v) => viewports.includes(v.id))) {\r\n      for (const direction of ['ltr', 'rtl']) {\r\n        // test.concurrent\r\n        test(`${slug} - ${viewport.id} - ${direction}`, performTest(slug, viewport, customSnapshotsDir, direction), 30000);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction performTest(slug, viewport, customSnapshotsDir, direction = 'ltr') {\r\n  const url = `${global.BASE_URL}/patterns/${slug}/${slug}.rendered.html`;\r\n\r\n  return async() => {\r\n    let page;\r\n\r\n    try {\r\n      page = await browser.newPage();\r\n      await page.setCacheEnabled(false);\r\n      await page.setViewport(viewport);\r\n\r\n      const response = await page.goto(url, { timeout: 15000, waitUntil: ['load', 'networkidle2'] });\r\n      expect(await response.ok()).toBe(true);\r\n\r\n      await page.$eval('html', (div, dir) => div.setAttribute('dir', dir), direction);\r\n\r\n      const elm = await page.$('body > *:not(script):not(style):not(link):not(meta)');\r\n      expect(elm).not.toBeNull();\r\n\r\n      await page.waitFor(250);\r\n\r\n      const screenshot = await elm.screenshot();\r\n\r\n      expect(screenshot).toBeTruthy();\r\n      expect(screenshot instanceof Buffer).toBe(true);\r\n\r\n      let snapshotId = `${name}~~${viewport.id}~~${direction}`;\r\n\r\n      const config = Object.assign({}, defaultSnapshotConfig, { customSnapshotsDir, customSnapshotIdentifier: snapshotId });\r\n      expect(screenshot).toMatchImageSnapshot(config);\r\n\r\n    } finally {\r\n      if (page) {\r\n        await page.close();\r\n      }\r\n    }\r\n  };\r\n}\r\n```\r\n\r\nJest environment.\r\n```javascript\r\nconst NodeEnvironment = require('jest-environment-node');\r\nconst puppeteer = require('puppeteer');\r\n\r\nclass PuppeteerEnvironment extends NodeEnvironment {\r\n  constructor(config) {\r\n    super(config);\r\n\r\n    this.browser = puppeteer.launch({\r\n      headless: true,\r\n      dumpio: false,\r\n      args: [\r\n        '--no-sandbox',\r\n        '--disable-setuid-sandbox',\r\n        '--disable-dev-shm-usage',\r\n      ]\r\n    });\r\n  }\r\n\r\n  async setup() {\r\n    await super.setup();\r\n\r\n    const browser = await this.browser;\r\n\r\n    browser.on('targetcreated', async(target) => {\r\n      if (target.type() !== 'page') {\r\n        return;\r\n      }\r\n\r\n      const page = await target.page();\r\n\r\n      page.evaluateOnNewDocument(() => {\r\n        window.env = 'test';\r\n      });\r\n\r\n      page.on('domcontentloaded', async() => {\r\n        await page.evaluate(async() => {\r\n          window.env = 'test';\r\n\r\n          // Stop videos from mucking up visual regression tests\r\n          document.querySelectorAll('video').forEach((v) => {\r\n            v.removeAttribute('autoplay');\r\n            v.setAttribute('preload', 'auto');\r\n\r\n            v.pause();\r\n            v.currentTime = 0;\r\n            v.load();\r\n          });\r\n        });\r\n      });\r\n    });\r\n\r\n    this.global.BROWSER = browser;\r\n  }\r\n\r\n  async teardown() {\r\n    await super.teardown();\r\n\r\n    const b = await this.browser;\r\n    await b.close();\r\n    this.browser = null;\r\n  }\r\n\r\n  dispose() {\r\n\r\n  }\r\n\r\n  runScript(script) {\r\n    return super.runScript(script);\r\n  }\r\n}\r\n\r\nmodule.exports = PuppeteerEnvironment;\r\n```\r\n\r\nI should add we've also been having other extremely weird stuff going on. Left is the reference, middle is the diff, and right is what was produced during the test run.\r\n\r\nViewport not being honoured, completely the wrong size.\r\n![image](https://user-images.githubusercontent.com/1090602/42004340-5bd2b276-7a67-11e8-8cee-6ae49476d4c9.png)\r\n\r\nCompletely the wrong component\r\n![image](https://user-images.githubusercontent.com/1090602/42004351-6ddf15e0-7a67-11e8-94e8-ca955f987e86.png)"},{"labels":["bug",null],"text":"The targetcreated event is not firing when window.open() is called.\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.5.0\r\n* Platform / OS version: Windows 10.0.17134\r\n* Node.js version: 8.11.2\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. `const newPagePromise = new Promise(x => browser.on('targetCreated', target => x(target.page())));`\r\n2.  `await page.click(\"#bReport\"); //Makes popup`\r\n3.  `const popup = await newPagePromise; //Hangs here`\r\n\r\nIn the website, the button is rigged to call\r\n`var report=window.open(\"\",\"Schedule\",\"menubar=0,scrollbars=1,resizable=1\");`\r\nbefore adding content via an AJAX call.\r\n\r\n**What is the expected result?**\r\nThe popup should appear in a new window, with the variable pointing at the new page created by window.open()\r\n\r\n**What happens instead?**\r\nThe popup does appear, but the promise hangs. I have no way to validate the contents of the popup.\r\n\r\nThis may be a duplicate of #1992. I'm making a new issue to increase visibility and hopefully find a solution.\r\n"},{"labels":["bug",null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:** \r\n\r\n* Puppeteer version:1.5.0\r\n* Platform / OS version:Ubuntu\r\n* URLs (if applicable):https://www.handelsregister.de/rp_web/mask.do?Typ=e\r\n* Node.js version:v8.10\r\n\r\n**What steps will reproduce the problem?**\r\nhttps://stackoverflow.com/questions/51011466/puppeteer-select-link\r\nBasically these https://bitbucket.org/ytNeskews/puppeteer-attempt/src/master/src/index.js\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n**What is the expected result?**\r\nThe expectation is that page.click('p a') should trigger a click. While it appears there is no network request triggered\r\n\r\n**What happens instead?**\r\nClick happens but not on the link. Further debugging suggested that the visible center coordinates seem off. Once I changed the viewport of the page to 1366,768, the click successfully generated a navigation\r\n\r\n![0](https://user-images.githubusercontent.com/2851262/41832506-f45c0d9e-7869-11e8-8585-13b475191734.png)\r\n\r\n\r\nPerhaps something to do with elements staggered across the page (in multiple lines if you will)."},{"labels":["bug",null,null],"text":"Win CI usually fails to cleanup userDataDir folder in some tests. Example: [appveyour build](https://ci.appveyor.com/project/aslushnikov/puppeteer/build/1.0.1672/job/j2bllv92su3uajye)\r\n\r\nIt turns out that on Windows:\r\n- crash pad  is launched in a separate process\r\n- crash pad writes a few files into userDataDir\r\n- crash pad process doesn’t necessarily shutdown when we close browser.\r\n\r\nAs a result, we fail to remove temporary user data directory.\r\n\r\nWe need to disable crash reporting by default. Somehow chrome headless ignores the `--disable-breakpad` flag and launches crashpad anyway; this requires investigation and fixing upstream."},{"labels":["bug"],"text":"* Puppeteer version: 1.5.0-post (chromium_revision 567388)\r\n* Platform / OS version: Windows 7 x64\r\n* URLs (if applicable): see in the example\r\n* Node.js version: 10.4.1\r\n\r\nI have a script that validates links. Sometimes, after getting some URL, all next responses become `null`.\r\n\r\nI've managed to reduce the issue to this case:\r\n\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async function main() {\r\n  try {\r\n    const browser = await puppeteer.launch();\r\n    const [page] = await browser.pages();\r\n\r\n    let response = await page.goto('https://twitter.com/');\r\n    console.log(response ? response.status() : response);\r\n    response = await page.goto('https://github.com/nodejs/node');\r\n    console.log(response ? response.status() : response);\r\n    response = await page.goto('https://github.com/GoogleChrome/puppeteer/');\r\n    console.log(response ? response.status() : response);\r\n\r\n    await browser.close();\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n```\r\n200\r\n200\r\n200\r\n```\r\n\r\n**What happens instead?**\r\n```\r\n200\r\nnull\r\nnull\r\n```\r\n"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.5.0\r\n* Platform / OS version: Mac OS 10.13.3\r\n* URLs (if applicable): https://www.bennish.net/mixed-content.html\r\n* Node.js version: 10.1.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1. Access to a mixed-content page.\r\n2. expose a function by `page.exposeFunction`.\r\n3. the execution is stuck indefinitely.\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n(async() => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage();\r\n\r\n  await page.goto('https://www.bennish.net/mixed-content.html');\r\n  await page.exposeFunction('compute', function(a, b) {\r\n    return Promise.resolve(a * b);\r\n  });\r\n  const result = await page.evaluate(async function() {\r\n    return await compute(3, 5);\r\n  });\r\n  console.log(result);\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nExpose function successfully or at lease throws an error.\r\n\r\n**What happens instead?**\r\n\r\nThe execution is is stuck indefinitely."},{"labels":["bug",null],"text":"This is a reproduction of the upstream chromium bug: https://crbug.com/846099\r\n\r\nRepro steps:\r\n1. Checkout Puppeteer at 469b910a2de82e165a6a065741f5c99a84c891db\r\n2. [Optional] If working on a beefy machine, use `stress` (`sudo apt-get install stress`) to slow it \r\ndown and get higher chances to expose the race: `stress --cpu 1000`\r\n2. Execute the following script:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\n  const browser = await puppeteer.launch();\r\n  const [page] = await browser.pages();\r\n  let i = 0;\r\n  while (true) {\r\n    ++i;\r\n    console.log('iteration: ' + i);\r\n    await page.reload();\r\n    page.evaluate(() => {\r\n      window.worker = new Worker('data:text/javascript,console.log(\"Hello!\");');\r\n    });\r\n    const worker = await new Promise(x => page.once('workercreated', x));\r\n    const result = await (await worker.executionContext()).evaluate('1 + 1');\r\n  }\r\n\r\n  await browser.close();\r\n})();\r\n```\r\n\r\nAfter a while (iteration ~300), this script fails with an exception for me:\r\n```\r\n(node:31770) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Protocol error (Runtime.evaluate): Execution context was destroyed. undefined\r\n```"},{"labels":["bug",null,null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**About my environment:**\r\n\r\n* Puppeteer version: 1.4.0\r\n* Platform / OS version: Linux Ubuntu 17.10\r\n* URLs (if applicable):\r\n* Node.js version: 8.11.1\r\n\r\n**Code to reproduce the problem**\r\n\r\n``const browser = await puppeteer.launch();``\r\n`` const page = await browser.newPage();``\r\n``await page.goto('http://françois.wiki.allmende.io/view/how-to-wiki');``\r\n``await page.screenshot({path: 'example.png', fullPage: true});``\r\n``await browser.close();``\r\n\r\n**What is the expected result?**\r\nit should return full page screenshot.\r\n\r\n**What happens instead?**\r\nIt will return blank screenshot if i set fullpage to true, without fullpage to true or false it will work perfectly. You can use your [dome page](https://try-puppeteer.appspot.com/) with above code to reproduce the issue.\r\n"},{"labels":["bug",null,null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.4.0\r\n* Platform / OS version: ubuntu 18.04\r\n* URLs (if applicable): http://embertribe.com\r\n* Node.js version: 10.1.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\n  const browser = await puppeteer.launch({timeout: 0});\r\n  const page = await browser.newPage();\r\n  await page.goto('http://embertribe.com', {timeout: 0, waitUntil: 'networkidle2'});\r\n  await page.screenshot({path: 'full.png', fullPage: true});\r\n  await browser.close();\r\n})();\r\n```\r\n**What is the expected result?**\r\n\r\n\r\n**What happens instead?**\r\n\r\n<details>\r\n  <summary>result screenshot</summary>\r\n\r\n![full](https://user-images.githubusercontent.com/3434496/40478237-f4676c14-5f61-11e8-93ab-d7f7d8bc49b5.png)\r\n\r\n</details>"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.4.0\r\n* Platform / OS version: Ubuntu 18\r\n* URLs (if applicable): https://output.jsbin.com/sabewolufu\r\n* Node.js version: 10.0.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nhttps://puppeteersandbox.com/dlu78dLm\r\n```\r\nconst puppeteer = require('puppeteer');\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\nawait page.goto('https://output.jsbin.com/sabewolufu', {timeout: 10000, waitUntil: 'networkidle0'});\r\nawait browser.close();\r\n```\r\nhttps://jsbin.com/sabewolufu/edit?html\r\n```\r\n<iframe src=\"https://output.jsbin.com/yetibupefe\"></iframe>\r\n<script type=\"text/javascript\">\r\ndocument.querySelector('iframe').addEventListener('load', function (event) {\r\n    event.target.contentWindow.postMessage('hello', '*');\r\n});\r\n</script>\r\n```\r\nhttps://jsbin.com/yetibupefe/edit?html\r\n```\r\n<script>\r\nwindow.addEventListener('message', function () {\r\n    new Image().src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAHCAYAAAD5wDa1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNDNFMzM5REEyMkUxMUUzOEE3NEI3Q0U1QUIzMTc4NiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNDNFMzM5RUEyMkUxMUUzOEE3NEI3Q0U1QUIzMTc4NiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM0M0UzMzlCQTIyRTExRTM4QTc0QjdDRTVBQjMxNzg2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjM0M0UzMzlDQTIyRTExRTM4QTc0QjdDRTVBQjMxNzg2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jzOsUQAAANhJREFUeNqsks0KhCAUhW/Sz6pFSc1AD9HL+OBFbdsVOKWLajH9EE7GFBEjOMxcUNHD8dxPBCEE/DKyLGMqraoqcd4j0ChpUmlBEGCFRBzH2dbj5JycJAn90CEpy1J2SK4apVSM4yiKonhePYwxMU2TaJrm8BpykpWmKQ3D8FbX9SOO4/tOhDEG0zRhGAZo2xaiKDLyPGeSyPM8sCxr868+WC/mvu9j13XBtm1ACME8z7AsC/R9r0fGOf+arOu6jUwS7l6tT/B+xo+aDFRo5BykHfav3/gSYAAtIdQ1IT0puAAAAABJRU5ErkJggg==';\r\n});\r\n</script>\r\n```\r\n\r\n**The same approach, but without data urls:**\r\n\r\nhttps://puppeteersandbox.com/r5UxuqHc\r\n```\r\nconst puppeteer = require('puppeteer');\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\nawait page.goto('https://output.jsbin.com/noredoqimu', {timeout: 10000, waitUntil: 'networkidle0'});\r\nawait browser.close();\r\n```\r\nhttps://jsbin.com/noredoqimu/edit?html\r\n```\r\n<iframe src=\"https://output.jsbin.com/tupohasoje\"></iframe>\r\n<script type=\"text/javascript\">\r\ndocument.querySelector('iframe').addEventListener('load', function (event) {\r\n    event.target.contentWindow.postMessage('hello', '*');\r\n});\r\n</script>\r\n```\r\nhttps://jsbin.com/tupohasoje/edit?html\r\n```\r\n<script>\r\nwindow.addEventListener('message', function () {\r\n    new Image().src = 'https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_120x44dp.png';\r\n});\r\n</script>\r\n```\r\n\r\n**What is the expected result?**\r\nShould be no error\r\n\r\n**What happens instead?**\r\nNavigation Timeout Exceeded: 10000ms exceeded\r\n"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.1.1\r\n* Platform / OS version: macOS Sierra 10.12.6\r\n* URLs (if applicable): https://dpaphoto.com/\r\n* Node.js version: 9.6.1\r\n* Note: This issue does not happen when `await puppeteer.launch({ headless: false });`\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```\r\nconst puppeteer = require('puppeteer');\r\n \r\nfunction iterateManipulatedObject () {\r\n for (const key in obj = {}) {\r\n    obj[key] = 'unexpected-key-added';\r\n  }\r\n\r\n  return obj;\r\n}\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage();\r\n  await page.goto('https://dpaphoto.com/');\r\n  const result = await page.evaluate(iterateManipulatedObject);\r\n  console.log(result);\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n```{}```\r\n\r\n**What happens instead?**\r\n```\r\n{ '__\\u0001symbol:__\\u0001symbol:react.element0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol@@0.06742652620663936':\r\n   { '@@__\\u0001symbol:__\\u0001symbol:react.element0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.portal0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.fragment0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.strict_mode0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.provider0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.context0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.async_mode0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.forward_ref0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.call0.06742652620663936': true,\r\n     '@@__\\u0001symbol:__\\u0001symbol:react.return0.06742652620663936': true,\r\n     '@@__\\u0001symbol:iterator0.067426526206639361': true,\r\n     '@@__\\u0001symbol:Symbol._hidden0.067426526206639363': true,\r\n     '@@__\\u0001symbol:Symbol.hasInstance0.067426526206639365': true,\r\n     '@@__\\u0001symbol:Symbol.isConcatSpreadable0.067426526206639366': true,\r\n     '@@__\\u0001symbol:Symbol.match0.067426526206639367': true,\r\n     '@@__\\u0001symbol:Symbol.replace0.067426526206639368': true,\r\n     '@@__\\u0001symbol:Symbol.search0.067426526206639369': true,\r\n     '@@__\\u0001symbol:Symbol.species0.0674265262066393610': true,\r\n     '@@__\\u0001symbol:Symbol.split0.0674265262066393611': true,\r\n     '@@__\\u0001symbol:Symbol.unscopables0.0674265262066393612': true,\r\n     '@@__\\u0001symbol:Symbol.toPrimitive0.067426526206639364': true,\r\n     '@@__\\u0001symbol:toStringTag0.067426526206639362': true,\r\n     '@@__\\u0001symbol:0.0674265262066393613': true,\r\n     '@@__\\u0001symbol:Symbol.asyncIterator0.0674265262066393614': true,\r\n     '@@__\\u0001symbol:Symbol.observable0.0674265262066393615': true,\r\n     '@@__\\u0001symbol:0.0674265262066393616': true },\r\n  '__\\u0001symbol:__\\u0001symbol:react.portal0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:__\\u0001symbol:react.fragment0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:__\\u0001symbol:react.strict_mode0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:__\\u0001symbol:react.provider0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:__\\u0001symbol:react.context0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:__\\u0001symbol:react.async_mode0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:__\\u0001symbol:react.forward_ref0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:__\\u0001symbol:react.call0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:__\\u0001symbol:react.return0.06742652620663936': 'unexpected-key-added',\r\n  '__\\u0001symbol:iterator0.067426526206639361': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol._hidden0.067426526206639363': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.hasInstance0.067426526206639365': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.isConcatSpreadable0.067426526206639366': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.match0.067426526206639367': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.replace0.067426526206639368': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.search0.067426526206639369': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.species0.0674265262066393610': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.split0.0674265262066393611': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.unscopables0.0674265262066393612': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.toPrimitive0.067426526206639364': 'unexpected-key-added',\r\n  '__\\u0001symbol:toStringTag0.067426526206639362': 'unexpected-key-added',\r\n  '__\\u0001symbol:0.0674265262066393613': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.asyncIterator0.0674265262066393614': 'unexpected-key-added',\r\n  '__\\u0001symbol:Symbol.observable0.0674265262066393615': 'unexpected-key-added',\r\n  '__\\u0001symbol:0.0674265262066393616': 'unexpected-key-added' }\r\n```"},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.4.0\r\n* Platform / OS version: macOS\r\n* URLs (if applicable): -\r\n* Node.js version: v8.9.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nI know that I could use `page.waitForSelector` instead of following the snippet, but this snippet helps me right now to show the problem.\r\n\r\n``` typescript\r\nconst querySelector = () => {\r\n    return `document.querySelector('${selector}') !== null`;\r\n};\r\nconst result = await this.page.waitForFunction(querySelector(), {\r\n    polling: 50,\r\n    timeout: 0,\r\n});\r\n```\r\n\r\n\r\n**What is the expected result?**\r\nI would expect that the following function would wait till the element with the given selector is present and then resolves.\r\n\r\n\r\n**What happens instead?**\r\nThe method `waitForPredicatePageFunction` in the `WaitTask` class does not respect timeout of 0, which should disable the timeout.\r\nSo the function resolves immediately without running even once the predicate function.\r\n\r\nSee [here](https://github.com/GoogleChrome/puppeteer/blob/3b03ff65c7b369debfcaa67a8673fba105a2d20d/lib/FrameManager.js#L914)\r\n\r\nThe referenced line needs to be changed from\r\n``` javascript\r\nsetTimeout(() => timedOut = true, timeout);\r\n\r\n```\r\nto\r\n``` javascript\r\nif (timeout) {\r\n    setTimeout(() => timedOut = true, timeout);\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.4\r\n* Platform / OS version: centos 7\r\n* URLs (if applicable): https://www.jd.ru\r\n* Node.js version: 8.11\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1.page.on('response',response =>{console.log(response.headers())});\r\n2. focus on the resource \"https://static.criteo.net/js/ld/ld.js\"\r\n3. see the Cache-Control key\r\n\r\n**What is the expected result?**\r\nI think puppeteer should print this key like \"cache-control\":\"max-age=86400;public\" or \"cache-control\":\"max-age=86400\",\"cache-control\":\"public\"\r\n\r\n**What happens instead?**\r\nActually it displayed \"cache-control\":\"max-age=86400public\"\r\nI don't think this is a friendly display because it becomes hard for developer to parse max-age value with number and text not separated.\r\n"},{"labels":["bug",null,null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.3.0\r\n* Platform / OS version: Linux / CentOS 7.4.1708\r\n* Node.js version: 8.11.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. Run the script  (userDataDir is expected to be empty)\r\n```javascript\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch({\r\n    userDataDir: '/tmp/user-data-dir',\r\n    headless: true,\r\n    args: ['--no-sandbox'],\r\n  });\r\n\r\n  const page = await browser.newPage();\r\n  const response = await page.goto('https://example.com/');\r\n  console.log(response.fromCache());\r\n\r\n  await browser.close();\r\n})();\r\n```\r\nConsole:\r\n```\r\nfalse\r\n```\r\n2. Run the script for the second time\r\n\r\n**What is the expected result?**\r\n```\r\ntrue\r\n```\r\n\r\n**What happens instead?**\r\n```\r\nfalse\r\n```\r\n\r\nPuppeteer works as expected in headfull mode, though.\r\n\r\n"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Environment:**\r\n\r\n* Puppeteer version: 1.3.0\r\n* Platform / OS version: macOS 10.13.1\r\n* Node.js version: 8.9.4\r\n\r\n**Steps**\r\n\r\nBelow is the code producing this problem:\r\n\r\n```javascript\r\ntry {\r\n  ...\r\n  await page.waitForNavigation({waitUntil: 'networkidle2'})\r\n  ...\r\n} catch (err) {\r\n  // Throw an error.\r\n  throwError(err, page, browser, res)\r\n}\r\n\r\nthrowError = (async (err, page, browser, res) => {\r\n    // Log the error.\r\n    console.log(err)\r\n\r\n    // Close the browser.\r\n    await page.close()\r\n    await browser.close()\r\n\r\n    // Return an error response message.\r\n    res.json({code: 'ERROR', message: 'An unexpected error has occurred.'})\r\n})\r\n```\r\n\r\nWhen a request times out, I get the following error:\r\n\r\n```\r\nError: Navigation Timeout Exceeded: 30000ms exceeded\r\n    at Promise.then (node_modules/puppeteer/lib/NavigatorWatcher.js:73:21)\r\n    at <anonymous>\r\n(node:72563) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Protocol error (Runtime.callFunctionOn): Target closed.\r\n(node:72563) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nThe page and browser should get closed without throwing an exception/error.\r\n\r\n**What happens instead?**\r\n\r\n`Error: Protocol error (Runtime.callFunctionOn): Target closed.` is displayed instead of the page and browser getting closed gracefully. Timeout Exceeded error is understandable and is correct.\r\n\r\nI want to understand why `Error: Protocol error (Runtime.callFunctionOn): Target closed.` is being thrown and how we can avoid it?"},{"labels":["bug",null,null],"text":"I've run into an issue with page.screenshot() that occurs whenever an alert() dialog on the page happens after page ready.  The page.screenshot() hangs forever and if you end-task the node process, you get \r\n\r\n```\r\n UnhandledPromiseRejectionWarning: Error: Protocol error (Page.captureScreenshot): Target closed.\r\n    at Promise (/var/www/html/puppeteer-bug/node_modules/puppeteer/lib/Connection.js:200:56)\r\n    at new Promise (<anonymous>)\r\n    at CDPSession.send (/var/www/html/puppeteer-bug/node_modules/puppeteer/lib/Connection.js:199:12)\r\n    at Page._screenshotTask (/var/www/html/puppeteer-bug/node_modules/puppeteer/lib/Page.js:738:39)\r\n    at <anonymous>\r\n    at process._tickCallback (internal/process/next_tick.js:188:7)\r\n```\r\n\r\nThis is running puppeteer 1.3.0 under Ubuntu with Node 5.6.0 and the Chromium version that ships with Puppeteer.  Also replicated using full Chrome 65.\r\n\r\nBasic Node app:\r\n\r\n```\r\n'use strict';\r\nconst puppeteer = require('puppeteer');\r\n\r\nasync function go(){\r\n    const browser = await puppeteer.launch();\r\n    console.log('opened browser');\r\n    const page = await browser.newPage();\r\n    console.log('created page');\r\n    await page.goto('http://testing/puppeteer/', { timeout: 30000 });\r\n    console.log('loaded page');\r\n    await page.screenshot({\r\n        path: './test.jpg'\r\n    });\r\n    console.log('took screenshot');\r\n    await browser.close();\r\n    console.log('closed browser');\r\n}\r\n\r\ngo();\r\n```\r\n\r\nThe html it's loading is:\r\n\r\n```\r\n<div style=\"position: absolute; background-color: #99dd99; top: 10px; left: 40px; width: 300px; height: 250px; padding: 5px 15px; border: 1px solid #444;\">Stuff</div>\r\n<script src=\"https://code.jquery.com/jquery-3.3.1.min.js\" integrity=\"sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=\" crossorigin=\"anonymous\"></script>\r\n<script>\r\n\t$(document).ready(function(){\r\n\t\talert('test');\r\n\t});\r\n</script>\r\n```\r\n\r\nIf you comment out the alert, everything works.  With the alert in place, you get a console log for 'loaded page' and then everything hangs indefinitely.\r\n\r\nA workaround is to use Promise.race:\r\n\r\n```\r\n    await Promise.race([\r\n        page.screenshot({\r\n            path: '/test.jpg'\r\n        }),\r\n        new Promise((resolve, reject) => setTimeout(function(){ reject('Screenshot timeout');}, 3000))\r\n    ]);\r\n```\r\n\r\nThe screenshot still doesn't complete, but at least it doesn't hang the app."},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Environment:**\r\n* Puppeteer version: 1.3.0\r\n* Platform / OS version: Ubuntu 14.04\r\n* Node.js version: 7.6.0\r\n\r\n**Code:**\r\n```\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\nawait page.goto('https://github.com/GoogleChrome/puppeteer', {waitUntil: 'networkidle2'});\r\nawait page.addStyleTag({\r\n    content: '@page:first {margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px;}'\r\n});\r\nawait page.pdf({\r\n    path: 'test.pdf',\r\n    format: 'A4',\r\n    displayHeaderFooter: true,\r\n    headerTemplate: '<div style=\"font-size:16px;width:100%;text-align:center;\">HEADER</div>',\r\n    footerTemplate: '<div style=\"font-size:16px;width:100%;text-align:center;\">FOOTER</div>',\r\n    margin: {top: '50px', right: '10px', bottom: '50px', left: '10px', }}\r\n);\r\nawait browser.close();\r\n```\r\n\r\n**Expected result:**\r\nThe first page should have no margins (and therefore hide the header and footer), while all following pages should have the specified margin and display the header and footer.\r\n\r\n**Actual result:**\r\nThe header is properly displayed on all pages except the first one. The footer, however, is only displayed on the last page. It seems that the margin bottom isn't applied properly."},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\nSimilar/same as: #1391\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.3.0\r\n* Platform / OS version: Mac\r\n* URLs (if applicable): https://www.microsoft.com/en-gb/store/d/xbox-one-s-1tb-console-playerunknowns-battlegrounds-bundle/908z9jn5cnh2/gz4w?cid=msft_web_collection\r\n* Node.js version: 9.11.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```js\r\nconst browser = await puppeteer.launch();\r\n\r\nconst page = await browser.newPage();\r\n\r\nfor (var i = 0; i < 15; i++) {\r\n  const r = await page.goto('https://www.microsoft.com/en-gb/store/d/xbox-one-s-1tb-console-playerunknowns-battlegrounds-bundle/908z9jn5cnh2/gz4w?cid=msft_web_collection', { waitUntil: 'domcontentloaded' });\r\n\r\n  console.log(r.ok());\r\n}\r\n\r\nawait browser.close();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\n`true` outputted 15 times\r\n\r\n**What happens instead?**\r\n\r\nSometimes `true` 15 times, sometimes `TypeError: Cannot read property 'ok' of null`\r\n\r\nIt works as expected on 1.2.0, but fails on 1.3.0"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version:1.3.0\r\n* Platform / OS version:Windows 7\r\n* URLs (if applicable):https://www.youtube.com/watch?v=DUo7YwlU7_g\r\n* Node.js version:v8.9.4\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nI writed a simple code to show the problem:\r\nI want to catch the request and response whose URL contain \"googlevideo.com/videoplayback?\".\r\n``` javascript\r\nvar puppeteer =require('puppeteer')\r\nvar counter ={\r\n    req:0,\r\n    res:0\r\n};\r\n\r\n\r\n(async function () {\r\n    var browser = await puppeteer.launch({\r\n        headless:false,\r\n        devtools:true,\r\n    })\r\n    var page = await browser.newPage();\r\n\r\n    //listen on \"request\"\r\n    page.on(\"request\",async function (req){\r\n        if(req.url().match(\"googlevideo.com/videoplayback?\")) {\r\n            counter.req ++\r\n            console.log(\"req:\",counter.req,\"res\",counter.res);\r\n        }\r\n    })\r\n    //listenon \"response\"\r\n    page.on(\"response\",async function (res){\r\n        if(res.url().match(\"googlevideo.com/videoplayback?\")) {\r\n            counter.res ++\r\n            console.log(\"req:\",counter.req,\"res\",counter.res ,\"length\", (await res.text()).length);\r\n        }\r\n    })\r\n\r\n    await page.goto(\"https://www.youtube.com/watch?v=DUo7YwlU7_g\")\r\n    //await browser.close()\r\n})()\r\n\r\n\r\n//expectd result\r\nreq: 1 res 0 \r\nreq: 1 res 1 length  1540422\r\nreq: 2 res 1\r\nreq: 2 res 2 length  1495922\r\n......\r\n...more \r\n\r\n//actully \r\nreq: 1 res 0\r\nreq: 2 res 0\r\nreq: 2 res 2 length 63218\r\nreq: 2 res 1 length 104393\r\n...\r\n...\r\nreq: 17 res 24 length 706695\r\nreq: 19 res 27 length 299581     // res is more than req , and length is smaller than expected.\r\n\r\n```\r\n\r\n\r\nI guess that the response may have maximum size , so if the response data is bigger than the maximum ,  the response will be divided into multiple parts and each parts will emit the `response` event.\r\n\r\nHowever , I don't find where the maximum defined . Maybe defined by upstream.\r\n\r\nOr the problem is caused by any other reason ?\r\n\r\n----------------------------------------------------------------------\r\n**Thanks for reading**\r\n"},{"labels":["bug",null,null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.3.0\r\n* Platform / OS version: MacOS \r\n* URLs (if applicable):\r\n* Node.js version: 8.6.0\r\n\r\nI'm trying to write some acceptance testing for an PWA (service workers, web components, etc...) and My spec is failing about 1 in 5 times. \r\n```js\r\nawait page.goto('localhost:5000/settings?disable-sw-cache', {\r\n  waitUntil: 'networkidle2'\r\n});\r\n\r\n// doesn't seem to help w/ stopping flakiness\r\nawait page.waitFor(2000); \r\n\r\npage.click(\"[data-puppeteer='reload-configuration-link']\");\r\nawait page.waitForSelector('.mdc-snackbar.mdc-snackbar--active');\r\n\r\nconst message = await page.evaluate(\r\n  selector => document.querySelector(selector).textContent,\r\n  '.mdc-snackbar.mdc-snackbar--active'\r\n);\r\n\r\nexpect(message).to.contain('Successfully reloaded device configuration');\r\n```\r\n\r\nThe problem is that when `page.click` is fired, 1  in 5 times the wrong element is clicked. I debugged Puppeter and found a mismatch between the browser's `[x, y]` click coordinates and puppeteer's `[x, y]` click coordinates. For the record, Puppeteer is logging the correct coordinates. \r\n\r\n<img width=\"914\" alt=\"screen shot 2018-04-27 at 3 44 45 pm\" src=\"https://user-images.githubusercontent.com/9306/39384684-50a15376-4a33-11e8-94b2-8b0266d99b1d.png\">\r\n\r\nAny insights into why this is happen? I'm stumped. "},{"labels":["bug",null,null],"text":"(Reported [here](https://puppeteer.slack.com/archives/C8XEP1718/p1524815460000457) on our slack channel)\r\n\r\nSince we terminate browser with `kill -9` in an attempt to exit as fast as possible, `browser.close()` causes puppeteer `child_process` to exit with non-zero code.\r\n\r\nThis has unfortunate consequences on AWS Lambda.\r\nQuoting @alixaxel:\r\n\r\n> On Lambda, it creates core dumps which if the function is kept warm, will eventually prevent it from starting due to no disk space (only 500MB on `/tmp`).\r\n\r\nWe should:\r\n- enhance protocol's [`Browser.close()`](https://vanilla.aslushnikov.com/#Browser.close) to (optionally) ignore beforeunload handlers\r\n- use `browser.close()` exclusively instead of `kill -9`."},{"labels":["bug",null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version:1.2\r\n* Platform / OS version: mac 10.13.4\r\n* URLs (if applicable):\r\n* Node.js version: 8.11\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nif I set headless to false,  when I use createOffer of webrtc. It works right with H264 in SDP. but when I set headless to true. there is no H264 in SDP anymore. \r\n\r\n\r\n\r\n**What is the expected result?**\r\n\r\n\r\n**What happens instead?**\r\n\r\n"},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.3.0\r\n* Platform / OS version: Mac OSX\r\n* Node.js version: v7.10.1 / v9.8.0\r\n* URLs (if applicable):\r\n  * https://remarkjs.com/\r\n  * http://lab.hakim.se/reveal-js\r\n  * https://leaverou.github.io/csss/\r\n  * http://artificer.jboss.org/slides/general/opensource-getting-involved.html\r\n  * http://joshbode.github.io/remark/ansi.html\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage();\r\n  response = await page.goto('https://remarkjs.com/');\r\n\r\n  console.log('response:', response)\r\n\r\n  await browser.close();\r\n})();\r\n```\r\n\r\nFor the URLs listed above.\r\n\r\n**What is the expected result?**\r\n\r\n`response` should not be null.\r\n\r\n**What happens instead?**\r\n\r\n`response` is null. Note that it works with Puppeteer version 1.2.0."},{"labels":["bug",null],"text":"More of a question than an issue, I'm trying to debug why sometimes await of a page or frame .evaluate() just hangs. I have to end up killing the process.\r\n\r\nWhen puppeteer runs evaluate() does it wait for an event to finish before executing the code?"},{"labels":["bug",null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.2\r\n* Platform / OS version: Mac 10.13.2\r\n* URLs (if applicable):\r\n* Node.js version: 8.11.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\nI need to release some resources when page.close called.  Code below called when I close the tab manually.  But in puppet, after I invoke page.close(). It seems not get called at all.\r\n\r\n```\r\nwindow.onbeforeunload = function() {\r\n  $log.debug('MainController onbeforeunload');\r\n  rtc.disconnect();\r\n};\r\n```\r\n\r\n**What is the expected result?**\r\n\r\n\r\n**What happens instead?**\r\n\r\n"},{"labels":["bug",null,null],"text":"I'm currently encountering some potential rounding issues with the PDF page size where I have to use an additional few 10ths of a millimetre on the width and height for the pages, the `@page`s declaration in my CSS, and also the CSS height of my `section`s to render (mostly) correctly.\r\n\r\nEven after adding the extra mm to cover the issue, the width then increases by about 1-2mm on either side of the page, only when Puppeteer is used to generate the PDF, but not when printed as PDF directly from my local Chrome (65.0.3325.181).\r\n\r\nThe removal of the additional mm breaks the layout in both local Chrome and puppeteer rendered PDFs.\r\n\r\nPossibly similar issue to #666.\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.2.0\r\n* Platform / OS version: MacOS 10.13.3\r\n* URLs (if applicable): https://gist.github.com/Jarrydcrawford/9b64fc289e58d990aa4a8990331538e4\r\n* Node.js version: 8.10.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\nconst fs = require('fs');\r\n\r\nconst DELTA = 0.27; // closest additional mm to not break layout\r\n\r\n(async () => {\r\n  let browser;\r\n  try {\r\n    browser = await puppeteer.launch({\r\n      headless: true,\r\n      args: [\r\n        '--no-sandbox',\r\n        '--disable-setuid-sandbox',\r\n        '--disable-gpu',\r\n        '--hide-scrollbars',\r\n        '--disable-web-security',\r\n      ],\r\n    });\r\n    const page = await browser.newPage();\r\n    await page.goto(\r\n      `data:text/html,${fs.readFileSync('index.html').toString('utf8')}`,\r\n    );\r\n    await page.pdf({\r\n      path: './index.pdf',\r\n      displayHeaderFooter: false,\r\n      printBackground: true,\r\n      pageRanges: '1-2',\r\n      height: 139 + DELTA + 3 + 3 + 'mm', // Additional page margins of 3mm\r\n      width: 550 + DELTA + 3 + 3 + 'mm', // Additional page margins of 3mm\r\n      margin: {\r\n        top: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        left: 0,\r\n      },\r\n    });\r\n    await browser.close();\r\n  } catch (err) {\r\n    if (browser) {\r\n      await browser.close();\r\n    }\r\n    throw err;\r\n  }\r\n})();\r\n```\r\n\r\n1. `node index.js`.\r\n2. Open PDF.\r\n3. Open HTML file directly in Chrome browser.\r\n4. Print as PDF.\r\n5. Compare (may have to zoom in to see).\r\n\r\n**What is the expected result?**\r\n\r\nPDF should not have any margin/whitespace on the page edges.\r\n\r\n**What happens instead?**\r\n\r\nThere is a horizontal page gap on either side of each page of about 1mm.\r\nShould not need to use any additional mm adjustment - raw sizes should render as expected.\r\n"},{"labels":["bug",null,null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.2.0\r\n* Platform / OS version: Windows 10\r\n* Node.js version: 8.10.0\r\n* Jest: 5.6.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```\r\n    for (const slug of slugs) {\r\n      const buster = (new Date()).getTime();\r\n      const url = `${global.BASE_URL}/patterns/${slug}/${slug}.rendered.html?buster=${buster}`;\r\n\r\n      // test.concurrent\r\n      test(slug, async() => {\r\n        let browser;\r\n        let page;\r\n\r\n        try {\r\n          browser = await puppeteer.launch({ headless: false });\r\n          page = await browser.newPage();\r\n          await page.setViewport(viewport);\r\n\r\n          const response = await page.goto(url);\r\n\r\n          expect(response).not.toBeNull();\r\n\r\n          await page.waitFor(150);\r\n\r\n          if (!response.ok()) {\r\n            throw new Error(`Unable to browse to url, status: ${response.status()}. ${url}`);\r\n          }\r\n\r\n          const elm = await page.$('body > *:not(script):not(style):not(link):not(meta)');\r\n\r\n          expect(elm).not.toBeNull();\r\n\r\n          if (elm) {\r\n            const snapshotId = viewport.name + '--' + slug.replace('99-visual-regression-', '');\r\n\r\n            const screenshot = await elm.screenshot({\r\n              path: `${__dirname}/__image_snapshots__/__current__/${snapshotId}.png`\r\n            });\r\n\r\n            expect(screenshot).not.toBeNull();\r\n\r\n            const config = Object.assign({}, defaultSnapshotConfig, { customSnapshotIdentifier: snapshotId });\r\n\r\n            await expect(screenshot).toMatchImageSnapshot(config);\r\n          }\r\n        } finally {\r\n          if (page) {\r\n            await page.close();\r\n          }\r\n          if (browser) {\r\n            await browser.close();\r\n          }\r\n        }\r\n      });\r\n\r\n      break;\r\n    }\r\n\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nelm.screenshot() should return a screenshot via a promise.\r\n\r\n**What happens instead?**\r\n\r\nThe code stalls and eventually jest times out. Switching off headless mode reveals the browser window turns grey. Switching to the home tab and the back to the correct tab then allows the browser to continue.\r\n\r\n[Video-Wed-Mar-28-2018-15-11-01.zip](https://github.com/GoogleChrome/puppeteer/files/1856323/Video-Wed-Mar-28-2018-15-11-01.zip)\r\n\r\n\r\n"},{"labels":["bug",null],"text":"**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.2.0\r\n* Platform / OS version: CentOS 7.4.1708\r\n* URLs (if applicable): N/A\r\n* Node.js version: v8.10.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n    const puppeteer = require('puppeteer');\r\n\r\n    const run = async () => {\r\n      const browser = await puppeteer.launch();\r\n\r\n      // close any open pages\r\n      let pages = await browser.pages();\r\n      await Promise.all(pages.map(async page => await page.close()));\r\n\r\n      // handle a page being closed\r\n      browser.on('targetdestroyed', async target => {\r\n        const openPages = await browser.pages();\r\n        console.log('Open pages:', openPages.length);\r\n        if (openPages.length == 0) {\r\n          console.log('Closing empty browser');\r\n          await browser.close();\r\n          console.log('Browser closed');\r\n        }\r\n      });\r\n\r\n      pages = await browser.pages();\r\n      for (let i = 0; i < 5; i++) {\r\n        await browser.newPage();\r\n      }\r\n\r\n      pages = await browser.pages();\r\n      pages.forEach((page) => page.close());\r\n    };\r\n\r\n    run();\r\n\r\n**What is the expected result?**\r\n\r\n    Count: 0\r\n    Open pages: 4\r\n    Open pages: 3\r\n    Open pages: 2\r\n    Open pages: 1\r\n    Open pages: 0\r\n    Closing empty browser\r\n    Browser closed\r\n\r\n**What happens instead?**\r\n\r\n    Open pages: 4\r\n    Open pages: 3\r\n    Open pages: 2\r\n    Open pages: 1\r\n    Open pages: 0\r\n    Closing empty browser\r\n    (node:29074) UnhandledPromiseRejectionWarning: Error: Protocol error (Target.closeTarget): Target closed.\r\n        at Promise (node_modules/puppeteer/lib/Connection.js:86:56)\r\n        at new Promise (<anonymous>)\r\n        at Connection.send (node_modules/puppeteer/lib/Connection.js:85:12)\r\n        at Page.close (node_modules/puppeteer/lib/Page.js:802:36)\r\n        at pages.forEach (test.js:27:32)\r\n        at Array.forEach (<anonymous>)\r\n        at run (test.js:27:9)\r\n        at <anonymous>\r\n        at process._tickCallback (internal/process/next_tick.js:188:7)\r\n    (node:29074) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). (rejection id: 1)\r\n    (node:29074) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n    Browser closed\r\n\r\nThis does not happen **every** run but it happens every so often. It's entirely possible I'm doing something _bad_ here!"},{"labels":["bug",null],"text":"Hi!\r\nI try `npm run coverage`, but got Exception.\r\nTell me, please, where does `rm()` function come from?\r\n\r\n**Tell us about your environment:**\r\n* Puppeteer version: 1.2.0-post\r\n* Platform / OS version: MINGW64_NT-10.0\r\n* URLs (if applicable):\r\n* Node.js version: v8.10.0\r\n\r\n**What steps will reproduce the problem?**\r\n```\r\nvgorbachev@vgorbachev-l MINGW64 ~/project/fork/puppeteer (master)\r\n$ npm run coverage\r\n\r\n> puppeteer@1.2.0-post coverage C:\\Users\\vgorbachev\\project\\fork\\puppeteer\r\n> cross-env COVERAGE=true npm run unit\r\n\r\n\r\n> puppeteer@1.2.0-post unit C:\\Users\\vgorbachev\\project\\fork\\puppeteer\r\n> node test/test.js\r\n\r\nC:\\Users\\vgorbachev\\project\\fork\\puppeteer\\test\\test.js:68\r\n  rm(OUTPUT_DIR);\r\n  ^\r\n\r\nReferenceError: rm is not defined\r\n    at Object.<anonymous> (C:\\Users\\vgorbachev\\project\\fork\\puppeteer\\test\\test.js:68:3)\r\n    at Module._compile (module.js:652:30)\r\n    at Object.Module._extensions..js (module.js:663:10)\r\n    at Module.load (module.js:565:32)\r\n    at tryModuleLoad (module.js:505:12)\r\n    at Function.Module._load (module.js:497:3)\r\n    at Function.Module.runMain (module.js:693:10)\r\n    at startup (bootstrap_node.js:188:16)\r\n    at bootstrap_node.js:609:3\r\nnpm ERR! code ELIFECYCLE\r\nnpm ERR! errno 1\r\nnpm ERR! puppeteer@1.2.0-post unit: `node test/test.js`\r\nnpm ERR! Exit status 1\r\nnpm ERR!\r\nnpm ERR! Failed at the puppeteer@1.2.0-post unit script.\r\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     C:\\Users\\vgorbachev\\AppData\\Roaming\\npm-cache\\_logs\\2018-03-20T14_12_26_552Z-debug.log\r\nnpm ERR! code ELIFECYCLE\r\nnpm ERR! errno 1\r\nnpm ERR! puppeteer@1.2.0-post coverage: `cross-env COVERAGE=true npm run unit`\r\nnpm ERR! Exit status 1\r\nnpm ERR!\r\nnpm ERR! Failed at the puppeteer@1.2.0-post coverage script.\r\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     C:\\Users\\vgorbachev\\AppData\\Roaming\\npm-cache\\_logs\\2018-03-20T14_12_26_619Z-debug.log\r\n```\r\n"},{"labels":["bug",null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: Not installed\r\n* Platform / OS version: win10x64\r\n* URLs (if applicable):\r\n* Node.js version: 8.10.0\r\n\r\n**What steps will reproduce the problem?**\r\nI ran `npm install --save-dev puppeteer` and get a error message as follows:\r\n\r\n```\r\nERROR: Failed to download Chromium r536395! Set \"PUPPETEER_SKIP_CHROMIUM_DOWNLOAD\" env variable to skip download.\r\n{ Error: self signed certificate in certificate chain\r\n    at TLSSocket.<anonymous> (_tls_wrap.js:1105:38)\r\n    at emitNone (events.js:106:13)\r\n    at TLSSocket.emit (events.js:208:7)\r\n    at TLSSocket._finishInit (_tls_wrap.js:639:8)\r\n    at TLSWrap.ssl.onhandshakedone (_tls_wrap.js:469:38) code: 'SELF_SIGNED_CERT_IN_CHAIN' }\r\nnpm WARN teamtreehouse@1.0.0 No repository field.\r\n\r\nnpm ERR! code ELIFECYCLE\r\nnpm ERR! errno 1\r\nnpm ERR! puppeteer@1.1.1 install: `node install.js`\r\nnpm ERR! Exit status 1\r\nnpm ERR!\r\nnpm ERR! Failed at the puppeteer@1.1.1 install script.\r\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\r\n```\r\n\r\n**What is the expected result?**\r\nPuppeteer gets installed\r\n\r\n**What happens instead?**\r\nIt doesn't get installed and the error message appears\r\n"},{"labels":["bug",null],"text":"Puppeteer version: 1.1.1\r\nPlatform / OS version: Win10\r\nNode.js version: 9.4.0\r\nChromium Version: r536395\r\n\r\nSome of web pages have infinite loop or hard scripts and crash google chrome.\r\n\r\nFor example:\r\n\r\n```js\r\nvar puppeteer = require('puppeteer');\r\n(async () => {\r\n    const browser = await puppeteer.launch({\r\n        headless: false,\r\n        userDataDir: \"profile\",\r\n        ignoreHTTPSErrors: true,\r\n        dumpio: true,\r\n        args: ['--no-sandbox', '--disable-setuid-sandbox', '--disable-gpu']\r\n    });\r\n    const page = await browser.newPage();\r\n    await page.setCacheEnabled(false);\r\n    await page.goto('http://syb.artvin.edu.tr/iletisim-354', {\r\n            waitUntil: ['networkidle0', 'load', 'domcontentloaded'],\r\n            timeout: 10000\r\n        })\r\n        .then(async () => {\r\n            //something\r\n        })\r\n        .catch(async (error) => {\r\n            console.log(error);\r\n            await browser.close();\r\n        });\r\n    await browser.close();\r\n})();\r\n```\r\n\r\nAbove code returns \r\n\r\n> \"Error: Navigation Timeout Exceeded: 10000ms exceeded\"\r\n\r\nHow can i catch chrome \"Page Unresponsive (Kill page / wait)\" error before Navigation Timeout error ?\r\nOn headless mode, there is no problem.\r\nBut when you set headless:false, \"Page Unresponsive\" problem prevents browser close at the end of the script."},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version:  v1.0.0\r\n* Platform / OS version: OS X 10.3.3\r\n* URLs (if applicable):\r\n* Node.js version: v8.8.1\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n`index.html`\r\n```html\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\r\n  <title>Document</title>\r\n  <style>\r\n    .modal {\r\n      width: 320px;\r\n      height: 240px;\r\n      background-color: bisque;\r\n      opacity: 0.5;\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n    }\r\n  </style>\r\n</head>\r\n\r\n<body>\r\n  <div class=\"modal\"></div>\r\n  <button onclick=\"alert('hello!');\">click me</button>\r\n</body>\r\n\r\n</html>\r\n```\r\n\r\n`test.js`\r\n```javascript\r\nconst puppeteer = require('puppeteer');\r\npuppeteer.launch({\r\n  executablePath: '/Applications/Chromium.app/Contents/MacOS/Chromium',\r\n  headless: false\r\n}).then(async b => {\r\n  const p = await b.newPage();\r\n  await p.goto('http://127.0.0.1:8000');\r\n  const btn = await p.$('button');\r\n  await btn.click();\r\n  console.log('clicked.');\r\n  await new Promise(resolve => {\r\n    setTimeout(() => resolve(), 5000);\r\n  });\r\n  await b.close();\r\n});\r\n```\r\n\r\n**What is the expected result?**\r\nClick button will raises error since there's a modal layer in the front of button element, it is not clickable, just like Selenium does.\r\n\r\n**What happens instead?**\r\nNo error raised, the program print \"clicked\" and exited.\r\n"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.1.0\r\n* Platform / OS version: macOS 10.13.3\r\n* URLs (if applicable):\r\n* Node.js version: v9.5.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nRun:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  try {\r\n    const page = await browser.newPage();\r\n    page.on('request', r => console.log(\r\n      r.url(),\r\n      r.headers()['x-devtools-emulate-network-conditions-client-id']\r\n    ));\r\n    await page.goto('http://foo.bar/');\r\n    // await page.goto('http://example.com/');\r\n  } catch (err) {\r\n    console.log(err);\r\n  } finally {\r\n    await browser.close();\r\n  }\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nIt prints\r\n```\r\nhttp://foo.bar/ undefined\r\n```\r\n\r\n**What happens instead?**\r\n\r\nIt prints\r\n\r\n```\r\nhttp://foo.bar/ 65A2864E19BC77D82EBC4B7F03E04F4F\r\n```\r\n\r\nDoing this with a url that resolves works as expected:\r\n\r\n```\r\nhttp://example.com/ undefined\r\n```"},{"labels":[null,"bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.1.0\r\n* Platform / OS version: Ubuntu 16.04\r\n* Node.js version: 6.13.0\r\n\r\n**What steps will reproduce the problem?**\r\nRunning this code:\r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\npuppeteer.launch({\r\n  dumpio: true\r\n}).then(function (browser) {\r\n  // irrelevant code here\r\n});\r\n```\r\n\r\n**What is the expected result?**\r\nThis should not cause an error.\r\n\r\n**What happens instead?**\r\nThere is a thrown error:\r\n```\r\n(node: 23455) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 2): TypeError: input.on is not a function\r\n```\r\nAnd the program exits.\r\n\r\n**More notes**\r\nVersion 1.0.0 seems not to have this issue."},{"labels":["bug"],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.0.0\r\n* Platform / OS version: Mac OS 10.13.3\r\n* URLs (if applicable): \r\n* Node.js version: 9.5.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\nI'm aware that this is nonsense code 🙂 , this is just to replicate the unpredictable behavior of `.evaluate`. Following up on #2020.\r\n\r\n1. execute\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  try {\r\n    const page = await browser.newPage();\r\n    await page.goto('https://www.google.com/');\r\n\r\n    const result = await page.evaluate(function () {\r\n      location.reload();\r\n      return new Promise(resolve => {\r\n        setTimeout(() => resolve({}), 0);\r\n      });\r\n    });\r\n\r\n    console.log('result', result);\r\n  } catch (err) {\r\n    console.log('error', err.message);\r\n  } finally {\r\n    await browser.close();\r\n  }\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nit prints\r\n```\r\nerror <Some error here>\r\n```\r\nor \r\n```\r\nresult {}\r\n```\r\n\r\n**What happens instead?**\r\n\r\nit prints\r\n```\r\nresult undefined\r\n```\r\n\r\nWhich seems like it introduces a third state to the result of `.evaluate`. Strangely enough, when you change the object by a string or number it does print the value.\r\n\r\n```js\r\nconst result = await page.evaluate(function () {\r\n  location.reload();\r\n  return new Promise(resolve => {\r\n    setTimeout(() => resolve(1), 0);\r\n  });\r\n});\r\n// result 1\r\n```\r\n\r\nIncreasing the timeout on the promise results in an error 👍 \r\n\r\n```js\r\nconst result = await page.evaluate(function () {\r\n  location.reload();\r\n  return new Promise(resolve => {\r\n    setTimeout(() => resolve({}), 1000);\r\n  });\r\n});\r\n// error Protocol error (Runtime.callFunctionOn): Execution context was destroyed. undefined\r\n```\r\n\r\nUnless you return a primitive\r\n\r\n```js\r\nconst result = await page.evaluate(function () {\r\n  location.reload();\r\n  return new Promise(resolve => {\r\n    setTimeout(() => resolve(1), 1000);\r\n  });\r\n});\r\n// result 1\r\n```\r\n\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 1.0.0\r\n* Platform / OS version: ArchLinux (up to date)\r\n* URLs (if applicable): https://pste.eu/p/awIC.html\r\n* Node.js version: 9.4.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nTry to load a HTTPS URL including an `iframe` with a HTTP `src` (normally blocked with a message like: `Mixed Content: The page at '...' was loaded over HTTPS, but requested an insecure resource '...'. This request has been blocked; the content must be served over HTTPS.`)\r\n\r\nCheck this example:\r\n```js\r\n\"use strict\";\r\nconst puppeteer = require(\"puppeteer\");\r\nconst url = \"https://pste.eu/p/awIC.html\";\r\n\r\n(async () => {\r\n    const browser = await puppeteer.launch({\r\n        args: [ \"--no-sandbox\", \"--disable-gpu\" ]\r\n    });\r\n    const page = await browser.newPage();\r\n    await page.goto(url);\r\n    await browser.close();\r\n})();\r\n```\r\n<details>\r\n  <summary>Content of https://pste.eu/p/awIC.html</summary>\r\n\r\n```html\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title></title>\r\n    <meta charset=\"utf-8\" />\r\n</head>\r\n<body>\r\n    <iframe src=\"http://github.com/\"></iframe>\r\n</body>\r\n</html>\r\n```\r\n\r\n</details>\r\n\r\n<br />\r\n\r\n**What is the expected result?**\r\n\r\nThe page loads. `page.goto(...)` returns a resolved promise.\r\n\r\n**What happens instead?**\r\n\r\nThe page never loads. `page.goto(...)` returns with a rejected promise after a 30 seconds timeout (`Error: Navigation Timeout Exceeded: 30000ms exceeded`).\r\n\r\n### Notes\r\n\r\nAs far as I understand, this is because the `iframe` never triggers the `load` event, and the `NavigatorWatcher` iterates over all iframes to check if a `load` event occured before resolving the `navigationPromise`. This issue may need some devtools protocol additions to be fixed."},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n* Puppeteer version: puppeteer@1.0.0 and puppeteer@1.0.0-next.1516669982697\r\n* Platform / OS version: debian\r\n* URLs (if applicable): https://httpstat.us/204\r\n* Node.js version: 8.9.4\r\n\r\n**What steps will reproduce the problem?**\r\n\r\ntest204.js:\r\n\r\n```javascript\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const url = process.argv[2];\r\n  console.log(\"url:\", url);\r\n  const args = [\r\n    \"--disable-gpu\",\r\n    \"--disable-setuid-sandbox\",\r\n    \"--force-device-scale-factor\",\r\n    \"--ignore-certificate-errors\",\r\n    \"--no-sandbox\",\r\n  ];\r\n  const browser = await puppeteer.launch({args});\r\n  const page = await browser.newPage();\r\n  const res = await page.goto(url);\r\n  console.log(res);\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n1. nodejs test204.js https://httpstat.us/204\r\n2. wait\r\n3. cry\r\n\r\n**What is the expected result?**\r\n\r\n```\r\n$ nodejs test204.js https://httpstat.us/204\r\nurl: https://httpstat.us/204\r\nLONG LOG WITH RESPONSE FROM GOTO\r\n```\r\n\r\n**What happens instead?**\r\n\r\n```\r\n$ nodejs test204.js https://httpstat.us/204\r\nurl: https://httpstat.us/204\r\n(node:22606) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Navigation Timeout Exceeded: 30000ms exceeded\r\n(node:22606) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n^C⏎         \r\n```"},{"labels":["bug",null],"text":"Puppeteer 1.0.0\r\nCloud9 Workspace\r\nNode Version 7.10.1\r\n\r\nI've been running some tests using multiple Puppeteer instances in a [generic-pool](https://github.com/coopernurse/node-pool) and trying to operate at and beyond the limits of my Cloud9 workspace in order to provoke errors and write some good error handling. If I restrict the pool size to 2, everything runs very smoothly. If I set it at 5, for example, I start getting a few errors. This is the Puppeteer get page and error handling code:\r\n\r\n```\r\nasync function getPage(targetURL, pageWidth, pageHeight, useragent) {\r\n    \r\n    //set the user agent\r\n    const userAgent = useragent;\r\n    //grab an instance of the Chrome headless browser\r\n    const browser = await global.chromepool.acquire();\r\n    debug(`GLOBAL CHROMEPOOL count after borrowing instance: ${global.chromepool.borrowed} for: ${targetURL}`);\r\n    //create a new page / tab\r\n    const page = await browser.newPage().catch(err => errHandler(\"newPage\", err, targetURL, browser) );  \r\n    //set the viewport to equal the size of the user's viewport so that resources are equivalent\r\n    await page.setViewport({width: pageWidth, height: pageHeight}).catch(err => errHandler(\"setViewport\", err, targetURL, browser) );  \r\n    //set the user agent in the browser\r\n    await page.setUserAgent(userAgent).catch(err => errHandler(\"setUserAgent\", err, targetURL, browser) );  \r\n    //call the get content promise and attach a global handler for errors at any point\r\n    var content = await returnContent(targetURL, page, browser).catch(err => { throw `${err}`; });\r\n    return content;\r\n    \r\n}\r\n\r\nfunction errHandler(caller, error, targetURL, browser) {\r\n    \r\n    if (global.chromepool.isBorrowedResource(browser) == true) {\r\n        global.chromepool.release(browser).then( () => { \r\n            debug(`GLOBAL CHROMEPOOL count after releasing instance: ${global.chromepool.borrowed}, on GENERAL ERROR: ${error.message.toUpperCase()}, in command: ${caller}, for: ${targetURL}`);\r\n            throw `${error}`;\r\n        });\r\n    } else { throw `${error}`; }\r\n    \r\n}\r\n\r\nfunction returnContent(targetURL, page, browser) {\r\n    \r\n    var returnedContent = null;\r\n    return new Promise( (resolve, reject) => {\r\n        \r\n        page.on('error', (err) => {\r\n            if (global.chromepool.isBorrowedResource(browser) == true) {\r\n                global.chromepool.release(browser).then( () => { \r\n                    debug(`GLOBAL CHROMEPOOL count after releasing instance: ${global.chromepool.borrowed}, on PAGE ERROR: ${err.message.toUpperCase()}, for: ${targetURL}`);\r\n                    reject(err);\r\n                });\r\n            } else { reject(err); }\r\n        });\r\n        \r\n        page.goto(targetURL, {timeout: 25000, waitUntil: [\"domcontentloaded\", \"load\"]})\r\n            .then( () => page.content() )\r\n            .then(content => { returnedContent = content })\r\n            .then( () => page.close() )\r\n            .then( () => global.chromepool.release(browser) )\r\n            .then( () => debug(`GLOBAL CHROMEPOOL count after releasing instance: ${global.chromepool.borrowed}, for: ${targetURL}`) )\r\n            .then( () => { resolve({targetURL: targetURL, content: returnedContent}); })\r\n            .catch(err => {\r\n                if (global.chromepool.isBorrowedResource(browser) == true) {\r\n                    global.chromepool.release(browser).then( () => { \r\n                        debug(`GLOBAL CHROMEPOOL count after releasing instance: ${global.chromepool.borrowed}, on CONTENT ERROR: ${err.message.toUpperCase()}, for: ${targetURL}`);\r\n                        reject(err); \r\n                    });\r\n                } else { reject(err); }\r\n            });\r\n    });\r\n        \r\n}\r\n```\r\n\r\nBy and large this error handling works well. This is indicated by the occasional page crash message, like this\r\n\r\n> CHROME-HANDLER GLOBAL CHROMEPOOL count after releasing instance: 4, on PAGE ERROR: PAGE CRASHED!, for: https://www.bbc.co.uk/ +0ms\r\n\r\nand the occasional timeout message like this: \r\n\r\n> CHROME-HANDLER GLOBAL CHROMEPOOL count after releasing instance: 4, on CONTENT ERROR: NAVIGATION TIMEOUT EXCEEDED: 25000MS EXCEEDED, for: http://edition.cnn.com/ +0ms\r\n\r\nHowever, when the system gets overloaded, one of the things that can go wrong is that the instance of Puppeteer cannot deliver a new page when it is asked for one. So I get this message logged as I would expect:\r\n\r\n>  CHROME-HANDLER GLOBAL CHROMEPOOL count after releasing instance: 3, on GENERAL ERROR: NOT OPENED, in command: newPage, for: http://www.euronews.com/ +0ms\r\n\r\nBut I also get these messages, which I would not expect\r\n\r\n> (node:26561) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 3): Error: not opened\r\n\r\n> (node:26561) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n\r\nI realise that I can use a `process.on('unhandledRejection')` handler to handle this rejection, but I thought it was worth reporting. Probably just a catch statement needed somewhere in `browser.newPage()`.\r\n\r\n"},{"labels":["bug"],"text":"Hi i try to play video:\r\nconst videoElem = await page.$('#video');  (<video/>)\r\nawait videoElem.click();\r\n\r\nbut error cought:\r\nError: DOMException: play() can only be initiated by a user gesture.\r\n\r\nalso i try videoElem.play() and have the same err."},{"labels":["bug",null],"text":"I'm using puppeteer.connect to connect to a bunch of Chrome instances across the network. Everything works perfectly, as long as I can keep the instances busy all the time. However, if I have a long initialization phase (think tens of minutes) between connecting to the Chrome instances and issuing commands to them, the connection breaks down.\r\n\r\nAFAIK, the WebSockets spec includes a ping mechanism and requires both sides to respond, so most WebSockets stacks have a built-in code for responding. If Chrome has this (let me know if you'd like me to check), it'd be nice if puppeteer's connection would issue keepalive pings at a configurable interval. The configurable aspect can also allow folks to keep pings disabled.\r\n\r\nIs this something you'd consider implementing or accepting contributions for?\r\n"},{"labels":["bug"],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\nInstallation fails due to UNABLE_TO_GET_ISSUER_CERT_LOCALLY.  I am behind a corporate proxy that does SSL inspection (with our own certificate authority), so I am not unused to this type of error.  However, I have configured npm correctly:\r\n```\r\nPS C:\\Users\\ltheisen\\git\\facility-report-viewer-ui> npm config get cafile\r\nC:\\cygwin64\\etc\\pki\\ca-trust\\extracted\\pem\\tls-ca-bundle.pem\r\n```\r\nAlong with the proper proxy settings:\r\n```\r\nPS C:\\Users\\ltheisen\\git\\facility-report-viewer-ui> gci env: | findstr proxy\r\nhttp_proxy                     http://gatekeeper-w.mitre.org:80\r\nhttps_proxy                    http://gatekeeper-w.mitre.org:80\r\nno_proxy                       .mitre.org,.portal.local,localhost,mm206678-pc,mm206678-pc.mitre.org,127.0.0.1\r\n```\r\nAnd it works for normal installs.  It seems like your `install.js` respects the `https_proxy` environment variable, but ignores the cafile setting.  I'm not really surprised as it is an npm config and your code is built to work with npm/yarn/..., but I need a way to provide your installer with my CA file.\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.13.0\r\n* Platform / OS version: Windows 10 Enterprise\r\n* URLs (if applicable):\r\n* Node.js version: v9.3.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1. `npm install --save-dev puppeteer`\r\n\r\n**What is the expected result?**\r\nPuppeteer gets installed.\r\n\r\n**What happens instead?**\r\n```\r\nPS C:\\Users\\ltheisen\\git\\facility-report-viewer-ui> npm install puppeteer --save-dev\r\n\r\n> puppeteer@0.13.0 install C:\\Users\\ltheisen\\git\\facility-report-viewer-ui\\node_modules\\puppeteer\r\n> node install.js\r\n\r\nERROR: Failed to download Chromium r515411! Set \"PUPPETEER_SKIP_CHROMIUM_DOWNLOAD\" env variable to skip download.\r\n{ Error: unable to get local issuer certificate\r\n    at TLSSocket.onConnectSecure (_tls_wrap.js:1042:34)\r\n    at TLSSocket.emit (events.js:159:13)\r\n    at TLSSocket._finishInit (_tls_wrap.js:639:8) code: 'UNABLE_TO_GET_ISSUER_CERT_LOCALLY' }\r\nnpm ERR! code ELIFECYCLE\r\nnpm ERR! errno 1\r\nnpm ERR! puppeteer@0.13.0 install: `node install.js`\r\nnpm ERR! Exit status 1\r\nnpm ERR!\r\nnpm ERR! Failed at the puppeteer@0.13.0 install script.\r\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\r\n```\r\n"},{"labels":["bug",null,null],"text":"* Puppeteer version: master\r\n* Platform / OS version: Ubuntu 16.04.3\r\n* Node.js version: v8.6.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. Run _setup script_\r\n2. Run _main script_\r\n2. Open dev tools network tab via `chrome://inspect` before startup timeout expires (5 sec)\r\n3. See that intercepted compressed request `http://fancybear.gov.us/jquery-3.2.1.min.js` yields gibberish\r\n\r\n_setup script_ -->\r\n```\r\nwget https://cdn.theatlantic.com/assets/media/img/mt/2016/04/RTX1GZCO/lead_960.jpg\r\ncurl -H 'Accept-Encoding: gzip' https://code.jquery.com/jquery-3.2.1.min.js > jquery-3.2.1.min.js.gz\r\n```\r\n_main script_ -->\r\n\r\n```js\r\nconst Puppeteer = require('puppeteer');\r\nconst CHROME_WS = '<your-chrome-ws-endpoint>';\r\nconst DEBUG_PAGE_URL = 'http://fancybear.gov.us/';\r\nconst DEBUG_HTML = `\r\n<!doctype html>\r\n<html>\r\n<head>\r\n<title></title>\r\n</head>\r\n<body>\r\n  <!-- unintercepted unencoded binary (OK) -->\r\n  <img src=\"https://cdn.theatlantic.com/assets/media/img/mt/2016/04/RTX1GZCO/lead_960.jpg\" width=\"150\">\r\n  <!-- intercepted unencoded binary (OK) -->\r\n  <img src=\"http://fancybear.gov.us/lead_960.jpg\" width=\"150\">\r\n  <!-- unintercepted encoded binary (OK) -->\r\n  <script\r\n  src=\"https://code.jquery.com/jquery-3.2.1.min.js\"\r\n  integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\"\r\n  crossorigin=\"anonymous\"></script>\r\n  <!-- intercepted encoded binary (FAIL) -->\r\n  <script src=\"http://fancybear.gov.us/jquery-3.2.1.min.js\"\r\n  integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\"\r\n  crossorigin=\"anonymous\"></script>\r\n</body>\r\n</html>\r\n`;\r\n\r\nconst Fs = require('fs');\r\nconst jqueryGzippedBuffer = Fs.readFileSync('./jquery-3.2.1.min.js.gz');\r\nconst imageBuffer = Fs.readFileSync('./lead_960.jpg');\r\n\r\nfunction interceptionListener(interceptedRequest) {\r\n  switch (interceptedRequest.url()) {\r\n    case DEBUG_PAGE_URL:\r\n      interceptedRequest.respond({\r\n        status: 200,\r\n        contentType: 'text/html',\r\n        body: DEBUG_HTML,\r\n      });\r\n      break;\r\n    case `${DEBUG_PAGE_URL}lead_960.jpg`:\r\n      interceptedRequest.respond({\r\n        status: 200,\r\n        headers: {\r\n          'content-type': 'image/jpeg',\r\n        },\r\n        body: imageBuffer,\r\n      });\r\n      break;\r\n    case `${DEBUG_PAGE_URL}jquery-3.2.1.min.js`:\r\n      interceptedRequest.respond({\r\n        status: 200,\r\n        headers: {\r\n          'content-type': 'application/javascript; charset=utf-8',\r\n          'content-encoding': 'gzip',\r\n          'access-control-allow-origin': '*',\r\n        },\r\n        body: jqueryGzippedBuffer,\r\n      });\r\n      break;\r\n    default:\r\n      interceptedRequest.continue();\r\n  }\r\n}\r\n\r\n(async function main() {\r\n  const browserWSEndpoint = await getBrowserWSEndpoint();\r\n  const browser = await Puppeteer.connect({\r\n    browserWSEndpoint: CHROME_WS,\r\n    ignoreHTTPSErrors: true,\r\n  });\r\n  const page = await browser.newPage();\r\n  page.on('request', interceptionListener);\r\n  try {\r\n    await page.waitFor(5000);\r\n    await page.setRequestInterception(true);\r\n    await page.goto(DEBUG_PAGE_URL, {\r\n      waitUntil: ['load', 'networkidle0'],\r\n      timeout: 30000,\r\n    });\r\n  } finally {\r\n    // page.removeListener('request', interceptionListener);\r\n    // await page.close();\r\n  }\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nCompressed responses should be properly decompressed by the browser. The intercept mechanism should allow the user to spoof any server response and pass it on to the browser so that it would be rendered identically to an original response.\r\n\r\n**What happens instead?**\r\n\r\nCompressed responses are not decompressed. If this is by design, then this puts unnecessary burden of low-level HTTP compression handling when spoofing compressed results.\r\n\r\n---\r\n\r\nPS: Double checked the script's integrity just in case, all green:\r\n\r\n```\r\ncat jquery-3.2.1.min.js.gz | gzip -d | openssl dgst -sha256 -binary | openssl base64 -A\r\n=> hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\r\n```\r\n\r\n---\r\n\r\nPPS: My use case, as you might wonder, is that I need to proxy real world page requests via dynamically determined proxy server. Intercepting all requests via `page.on('request')` and performing requests manually mostly works, but so far this issue seems to be the show-stopper."},{"labels":["bug",null,null],"text":"I'm trying to switch to `puppeteer` to test Chrome extension, and facing an issue that drastically increases time needed for tests to run - from 1s to 6s.\r\nI've nailed exact culprit. [On extension install](https://developer.chrome.com/extensions/management#event-onInstalled) I'm showing notification with a flag `requireInteraction` set to `true`.\r\n>Indicates that the notification should remain visible on screen until the user activates or dismisses the notification. This defaults to false.\r\nWith that flag `browser.close()` holds for 5 seconds longer than without it (the flag).\r\n\r\nI've created repo-example: https://github.com/skyiea/puppeteer-issue-example\r\nHere is the test itself:\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\nconst runTest = async (extPath) => {\r\n    const browser = await puppeteer.launch({\r\n        headless: false,\r\n        args: [\r\n            `--disable-extensions-except=${extPath}`,\r\n            `--load-extension=${extPath}`,\r\n        ],\r\n    });\r\n\r\n    const page = await browser.newPage();\r\n    await page.goto('http://example.com');\r\n\r\n    const start = Date.now();\r\n    await browser.close();\r\n\r\n    return Date.now() - start;\r\n};\r\n\r\n(async () => {\r\n    console.log('When requireInteraction === false, browser closes in:', await runTest('./ext-interaction-not-required'));\r\n    console.log('When requireInteraction === true, browser closes in:', await runTest('./ext-interaction-required'));\r\n})();\r\n```\r\n\r\nResults:\r\n```\r\n> node test.js\r\n\r\nWhen requireInteraction === false, browser closes in: 53\r\nWhen requireInteraction === true, browser closes in: 5058\r\n```\r\n\r\nI would assume that when `browser.close` is called, no matter whether notification _requires interaction_ - it should be forcefully closed."},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.13\r\n* Platform / OS version: any\r\n* URLs (if applicable): https://try-puppeteer.appspot.com/\r\n\r\n**What steps will reproduce the problem?**\r\n```\r\nconst browser = await puppeteer.launch();\r\n\r\nconst page = await browser.newPage();\r\nawait page.setRequestInterception(true);\r\npage.on('response', (response) => {\r\n  console.log('RESPONSE RECEIVED');\r\n  console.log(response.status + ' ' + response.url);\r\n});\r\npage.on('request', (request) => {\r\n console.log('REQUEST RECEIVED');\r\n  console.log(request.url);\r\n\r\n  request.continue({headers: {'test-header': 'dummy-value'}});\r\n});\r\n\r\nawait page.goto('http://www.mocky.io/v2/5a427066300000821d709e0f');\r\n//await page.goto('https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending');\r\n\r\nawait page.screenshot({path: 'screenshot.png', fullPage: true});\r\n\r\nawait browser.close();\r\n```\r\nI've included the following minimal puppeteer code and 2 sample urls. https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending which is a basic page that returns the HTTP headers sent in the request.\r\nAnd http://www.mocky.io/v2/5a427066300000821d709e0f which returns a 302 to the url specified above.\r\n\r\n**What is the expected result?**\r\nPuppeteer should send my custom header in both cases.\r\n\r\n**What happens instead?**\r\nPuppeteer doesn't send the custom header in the request that follows the 301/302. Even though the onRequest event is fired for both the 301 request and the followup request."},{"labels":["bug",null,null],"text":"So I'm having a weird problem with certain websites that I am trying to screenshoot. Essentially the page is shot and then replicated a number of times down in the png to make a really long screenshot that contains all these replications. Its like somebody copy pasted the page a couple of times onto the bottom of the original.\r\n\r\nI have not been able to figure out which sites cause it, but the example below is an example- I can supply more if needed.\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.13.0\r\n* Platform / OS version: Ubuntu 17.04\r\n* URLs (if applicable): https://bonobos.com/shop/tops\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nSample code with fullPage=True, i.e:\r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage();\r\n  await page.goto('https://bonobos.com/shop/tops');\r\n  await page.screenshot({path: 'example.png', fullPage: true});\r\n\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\nA pull page screenshot- not just the visible part\r\n\r\n**What happens instead?**\r\nA very long image that contains multiple copies of the full page screenshot.\r\n![example](https://user-images.githubusercontent.com/2863673/33840312-6e5752d4-de8c-11e7-8be1-ea655c18e664.png)\r\nDon't think the example will be visible, but worth a shot."},{"labels":["bug",null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.13.0\r\n* Platform / OS version: OSX 10.13.1\r\n* Node versions: tested with v8.6.0, v8.9.0 & v9.2.0\r\n* URLs (if applicable): N/A\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nThe code below isolates a problem discovered while using Puppeteer to generate PDF reports. While Puppeteer has been fantastic so far, I have come across a problem with pages containing a large number of images.\r\n\r\nindex.html: \r\n```\r\n<!doctype html>\r\n<html lang=\"en\">\r\n  <head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\r\n    <title>Test App</title>\r\n  </head>\r\n  <body>\r\n    <div id=\"root\"></div>\r\n  </body>\r\n</html>\r\n```\r\n\r\npdfImages.js: \r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\nconst IMAGE_URIS = [\r\n  // A list of 1949 image URIs as strings\r\n  // The images used range in size between 1KB to 1.7MB with an average size of 200KB.\r\n];\r\n\r\nconst PDF_OPTIONS = {path: `${__dirname}/output.pdf`, format: 'A4', printBackground: true, landscape: false, margin: {top: '10mm', left: '10mm', right: '10mm', bottom: '15mm'}};\r\nconst IMAGE_LOADING_TIMEOUT = 60 * 1000 * 5;\r\n\r\nfunction addImagesToPage(imageUriList) {\r\n  const root = document.getElementById('root');\r\n  imageUriList.forEach((imageUri) => {\r\n    const div = document.createElement('div');\r\n    const img = new Image();\r\n    img.src = imageUri;\r\n    img.style = 'max-width: 20vw; max-height: 20vh;';\r\n    div.appendChild(img);\r\n    root.appendChild(div);\r\n  });\r\n}\r\n\r\nfunction waitForAllImagesToCompleteLoading() {\r\n  const allImagesInDocument = Array.from(document.getElementsByTagName('img'));\r\n  return allImagesInDocument\r\n      .map((img) => img.complete)\r\n      .every((completeStatus) => completeStatus);\r\n}\r\n\r\nlet browser;\r\npuppeteer.launch({headless: true})\r\n  .then((newBrowser) => {\r\n    browser = newBrowser;\r\n    return browser.newPage();\r\n  })\r\n  .then((page) => {\r\n    return page.goto(`file://${__dirname}/index.html`)\r\n    .then(() => page.evaluate(addImagesToPage, IMAGE_URIS))\r\n    .then(() => page.waitForFunction(waitForAllImagesToCompleteLoading, {timeout: IMAGE_LOADING_TIMEOUT}))\r\n    .then(() => page.pdf(PDF_OPTIONS))\r\n    .then(() => page.close());\r\n  })\r\n  .then(() => browser.close());\r\n```\r\n\r\nI run this using:\r\n`env DEBUG=\"puppeteer:*\" node --max-old-space-size=16384 pdfImages.js`\r\n\r\n**What is the expected result?**\r\nRunning this code should generate a PDF.\r\n\r\nPlease note that running this with 1100 images and with --max-old-space-size=8174, the code runs without a problem.\r\n\r\n**What happens instead?**\r\nRunning the code with the command above causes the code to hang on the PDF generation stage. Please see [HungPdfPrint.log](https://github.com/GoogleChrome/puppeteer/files/1527613/HungPdfPrint.log) for the logs produced when this happens.\r\n\r\nThe code consistently hangs in the following combinations:\r\n- When --max-old-space-size=8174 (8GB) or 16348 (16GB) and,\r\n- When the number of images is 1200, 1500 or 1949.\r\n\r\nThe code crashes when the --max-old-space-size flag is removed with an out of heap memory error. See this log: [OutOfMemoryCrash.log](https://github.com/GoogleChrome/puppeteer/files/1527858/OutOfMemoryCrash.log)\r\n\r\nAgain, when the number of images is 1100 and --max-old-space-size=8174 the code runs without a problem"},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.13.0\r\n* Platform / OS version: macOS / 10.12.6\r\n* URLs (if applicable):\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n`console.log( await page.evaluate('var x = {a: undefined}; x') );`\r\n\r\n**What is the expected result?**\r\n`{}`\r\n\r\n**What happens instead?**\r\n`{a:null}`\r\n\r\nCurrent workaround is to `JSON.stringify` result before returning it from the browser context.\r\n\r\nReturning `null` instead of `undefined` was breaking [html-sketchapp](https://github.com/brainly/html-sketchapp/issues/29). \r\n"},{"labels":["bug",null],"text":"Hi again,\r\nAs usual, thanks a lot for maintaining puppeteer - it's super useful. 👍 \r\n\r\nSeems to me that there was a regression in `0.13` 🐛  when using the combination of:\r\n- `file:///` protocol\r\n- `setRequestInterception: true`\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: `0.13.0`\r\n* Platform / OS version: `MacOS High Sierra`, same on `windows`\r\n* URLs (if applicable):\r\nAny url over the `file` protocol seems to have this problem.\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n(async() => {\r\nconst browser = await puppeteer.launch({\r\n      // waitUntil: 'networkidle2', // see if this performs better than default for timeouts\r\n      ignoreHTTPSErrors: true,\r\n      args: ['--disable-setuid-sandbox', '--no-sandbox']\r\n    })\r\nconst page = await browser.newPage()\r\n\r\n// CRITICAL: _only_ with setRequestInterception = true do we get this problem:\r\n// the real html is escaped and embedded in a template like below.\r\n// <html><head></head><body><pre style=\"word-wrap: break-word; white-space: pre-wrap;\">\r\n// <REAL CONTENT HERE>\r\n// </pre></body></html>\r\nawait page.setRequestInterception(true)\r\npage.on('request', interceptedRequest => {\r\n  console.log(interceptedRequest.url)\r\n  interceptedRequest.continue()\r\n})\r\n\r\n// ANY local html file will do\r\nawait page.goto('file:///Users/pocketjoso/penthouse/test/static-server/yeoman.html')\r\n\r\nconst content = await page.content()\r\nconsole.log('content: ' + content)\r\n\r\nbrowser.close();\r\n})();\r\n\r\n```\r\n**What is the expected result?**\r\nThe html is parsed in the same way regardless of file/http protocol, and regardless of whether `setRequestInterception` is true or false. \r\n\r\n**What happens instead?**\r\n```\r\ncontent: <html><head></head><body><pre style=\"word-wrap: break-word; white-space: pre-wrap;\">&lt;!doctype html&gt;\r\n&lt;html class=\"no-js\"&gt;\r\n    &lt;head&gt;\r\n        &lt;meta charset=\"utf-8\"&gt;\r\n        &lt;title&gt;critical css test&lt;/title&gt;\r\n        &lt;meta name=\"description\" content=\"\"&gt;\r\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\r\n        &lt;!-- Place favicon.ico and apple-touch-icon.png in the root directory --&gt;\r\n... etc\r\n```\r\nOr in a picture (the browser renders the markup as text, rather than as html):\r\n![bjor6laez-after](https://user-images.githubusercontent.com/7192832/33457425-be84ce3e-d622-11e7-8d43-41c96a3ac35f.jpg)\r\n\r\n\r\n"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.13.0\r\n* Platform / OS version: Arch Linux 4.13.12-1-ARCH\r\n* URLs (if applicable): n/a\r\n\r\n**What steps will reproduce the problem?**\r\nI'd like to abort a PDF render, but puppetteer doesn't abort immediately after closing the page and browser instances used in rendering the PDF. Here's the snippet of code that I'm using for testing:\r\n```javascript\r\nconst puppeteer = require('puppeteer');  // version 0.13.0\r\n\r\nconst puppeteerOptions = {\r\n    timeout: 5000,\r\n    args: [ '--no-sandbox', '--disable-setuid-sandbox']\r\n};\r\nconst pdfOptions = {\r\n    scale: 1,\r\n    displayHeaderFooter: false,\r\n    printBackground: false,\r\n    landscape: false,\r\n    pageRanges: '',\r\n    format: 'Letter',\r\n    margin: {\r\n        top: '0.5in',\r\n        right: '0.5in',\r\n        bottom: '0.75in',\r\n        left: '0.5in'\r\n    }\r\n};\r\nconst url = 'https://en.wikipedia.org/api/rest_v1/page/html/Hendrick_Motorsports';\r\n\r\nlet browser;\r\nlet page;\r\n\r\nlet cleanup = () => {\r\n    if (page) {\r\n        console.log('closing the page');\r\n        page.close().then(() => {\r\n            if (browser) {\r\n                console.log('closing the browser');\r\n                browser.close();\r\n                browser = null;\r\n            }\r\n            page = null;\r\n        });\r\n    }\r\n};\r\n\r\npuppeteer.launch(puppeteerOptions)\r\n    .then((browser_) => {\r\n        browser = browser_;\r\n        console.log('_1. opening a new page');\r\n        return browser.newPage();\r\n    })\r\n    .then((page_) => {\r\n        page = page_;\r\n        console.log('_2. visiting the url');\r\n        return page.goto(url, {\r\n            timeout: 5000,\r\n            waitUntil: 'networkidle2'\r\n        });\r\n    })\r\n    .then(() => {\r\n        console.log('_3. creating a pdf');\r\n        return page.pdf(pdfOptions);\r\n    })\r\n    .catch((error) => {\r\n        console.log('_4. error', error);\r\n        cleanup();\r\n        throw error;\r\n    })\r\n    .then((pdf) => {\r\n        console.log('_5. returning pdf', pdf);\r\n        cleanup();\r\n        return pdf;\r\n    });\r\n\r\n// close the page and browser so that we can abort the request\r\n// to create a PDF\r\nsetTimeout(cleanup, 500);\r\n```\r\n\r\n**What is the expected result?**\r\nI should see the following text in the console. Italicized text is my comment.\r\n_1. opening a new page\r\n_2. visiting the url\r\nclosing the page\r\nclosing the browser\r\n_4. _Some kind of an error about the closed page or browser instance should be thrown immediately without waiting for timeout. It's true that I'm aborting the process in `page.goto` step, but aborting in any other step after creating a puppeteer instance results in the same issue: the chromium process doesn't stop immediately, rather it does what it's doing and then finish when it's done._\r\n\r\n**What happens instead?**\r\n_1. opening a new page\r\n_2. visiting the url\r\nclosing the page\r\nclosing the browser\r\n_(about 5 second wait happens here)_\r\n_4. error Error: Navigation Timeout Exceeded: 5000ms exceeded\r\n    at Promise.then (/home/bmansurov/workspace/mediawiki-services/chromium-render/node_modules/puppeteer/lib/NavigatorWatcher.js:69:21)\r\n    at <anonymous>\r\n(node:22758) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Navigation Timeout Exceeded: 5000ms exceeded\r\n(node:22758) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n"},{"labels":["bug",null],"text":"The script below breaks when trying to click a login button if setRequestInterception is set to true. Otherwise it works.\r\n\r\nIn the javascript console I can see that their endpoint is returning 500.\r\n\r\n![500 dev console](https://i.imgur.com/kb1twb6l.png)\r\n\r\n````\r\nconst puppeteer = require('puppeteer');\r\n\r\nargs = [];\r\nargs.push('--no-sandbox');\r\nargs.push('--disable-setuid-sandbox');\r\n\r\n(async () => {\r\n  browser = await puppeteer.launch({\r\n    headless: false,\r\n    args,\r\n  });\r\n\r\n  page = await browser.newPage();\r\n\r\n  page.setUserAgent('Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.62 Safari/537.36');\r\n  page.setViewport({ width: 1000, height: 600 });\r\n\r\n  await page.setRequestInterception(true);\r\n  page.on('request', (request) => {\r\n    request.continue();\r\n    return;\r\n  });\r\n\r\n\r\n  await page.goto('about:blank', { waitUntil: 'load' });\r\n\r\n  await page.goto('https://www.komplett.se/cart', { waitUntil: 'load' });\r\n\r\n  await page.click('#login-button');\r\n\r\n})();\r\n````\r\n\r\nThank you!"},{"labels":["bug"],"text":"* Puppeteer version: 1.0.0-rc\r\n* Platform / OS version: Windows 10, X64\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n* `npm init`\r\n* `npm i github:GoogleChrome/puppeteer#2becd156d0b25ad3fe4f7b91101b32aead70bd96`\r\n* run this code:\r\n\r\n```\r\nconst Puppeteer = require('puppeteer')\r\n\r\nconst puppeteer = Puppeteer.launch({\r\n    args: [`--remote-debugging-port=9220`, '--no-sandbox', '--disable-setuid-sandbox'],\r\n    headless: false\r\n})\r\n\r\nasync function test() {\r\n    const browser = await puppeteer\r\n    const page = await browser.newPage()\r\n    await page.goto('http://google.com')\r\n    await page.close()\r\n    pages = await browser.pages()\r\n\r\n    console.log(pages.map(page => page.url()))\r\n}\r\n\r\ntest()\r\n```\r\n\r\n* Prints out:\r\n\r\n```\r\n[ 'chrome://welcome-win10/?text=faster',\r\n  'https://www.google.dk/?gws_rd=cr,ssl&dcr=0&ei=wIIeWvnUFoOv6ASBj7igAg' ]\r\n```\r\n\r\n* Should print out:\r\n\r\n```\r\n[ 'chrome://welcome-win10/?text=faster']\r\n```\r\n\r\nEDIT:\r\n\r\nIt helps to wrap the `pages` call in timeout with 10ms function:\r\n\r\n```\r\nsetTimeout(async () => {\r\n    const pages3 = (await browser.pages()).map(t => t.url())\r\n    console.log(pages3)\r\n}, 10)\r\n```"},{"labels":["bug",null,null],"text":"Even though the navigation timeouts, `tracing.stop()` gets stuck until the page has finished loading.\r\n\r\ntest.js\r\n```\r\nconst puppeteer = require(\"puppeteer\");\r\n\r\n(async () => {\r\n    const browser = await puppeteer.launch();\r\n\r\n    const page = await browser.newPage();\r\n\r\n    let start_time = Date.now();\r\n\r\n    console.log(Date.now() - start_time, \"Starting tracing\");\r\n    await page.tracing.start({\"path\": \"test.json\"});\r\n\r\n    try {\r\n        console.log(Date.now() - start_time, \"Starting navigation\");\r\n        await page.goto(\"http://localhost:8080/sleep/10\", {\r\n            \"waitUntil\": [\"domcontentloaded\", \"networkidle0\"],\r\n            \"timeout\": 1000\r\n        });\r\n    } catch (error) {\r\n        console.log(Date.now() - start_time, \"Error:\", error.message);\r\n    }\r\n\r\n    console.log(Date.now() - start_time, \"Stopping tracing\");\r\n    await page.tracing.stop();\r\n\r\n    console.log(Date.now() - start_time, \"Closing\");\r\n    await page.close();\r\n    await browser.close();\r\n})();\r\n```\r\n\r\nOutput\r\n```\r\n% node test.js\r\n0 'Starting tracing'\r\n3 'Starting navigation'\r\n1006 'Error:' 'Navigation Timeout Exceeded: 1000ms exceeded'\r\n1006 'Stopping tracing'\r\n10050 'Closing'\r\n```\r\nTested on the current tip of master."},{"labels":["bug"],"text":"When using the tracing facilities from `Page.tracing`, the user agent reported in the trace is incorrect. I checked the logs of the webserver and the user agent used for the request is correct. So only the trace is not good.\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 3b60ad1c39133ed45f72058353f6b6bb26e6b627\r\n* Platform / OS version: debian strectch\r\n* URLs (if applicable): http://halva.khady.info but any url will work\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. save the file bellow as trace.js\r\n2. launch `nodejs trace.js http://halva.khady.info`\r\n3. check the last line of the output, it is not the user agent defined in the code\r\n\r\ntrace.js:\r\n\r\n```javascript\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\nconst URL = process.argv[2];\r\n\r\n(async () => {\r\n  console.log(\"processing url\", URL);\r\n  process.on(\"uncaughtException\", (e) => {\r\n    console.error(\"Unhandled exeption:\", e);\r\n    process.exit(1);\r\n  });\r\n  process.on(\"unhandledRejection\", (reason, p) => {\r\n    console.error(\"Unhandled Rejection at: Promise\", p, \"reason:\", reason);\r\n    process.exit(2);\r\n  });\r\n  const args = [\r\n    \"--disable-setuid-sandbox\",\r\n    \"--no-sandbox\",\r\n  ];\r\n  const options = {\r\n    args,\r\n    headless: true,\r\n  };\r\n  const browser = await puppeteer.launch(options);\r\n  const page = await browser.newPage();\r\n  await page.setUserAgent(\"demo_ua\");\r\n  await page.tracing.start({path: \"trace.json\"});\r\n  const res = await page.goto(URL, { timeout: 30000, waitUntil: \"load\" });\r\n  await page.tracing.stop();\r\n  await page.close();\r\n  await browser.close();\r\n  const j = require(\"./trace.json\");\r\n  console.log(j[\"metadata\"][\"user-agent\"]);\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\n```\r\n$ nodejs trace.js http://halva.khady.info\r\nprocessing url http://halva.khady.info\r\ndemo_ua\r\n```\r\n\r\n**What happens instead?**\r\n\r\n```\r\n$ nodejs trace.js http://halva.khady.info\r\nprocessing url http://halva.khady.info\r\nMozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/64.0.3264.0 Safari/537.36\r\n```"},{"labels":["bug",null,null],"text":"I get issue to compute the speed index using `speedline` module.\r\nThe size of the screenshots into the tracing file are not all the same.\r\nThe strange thing is that the issue occurs around 66% times, running 3 times the same code, the issue occurs twice.\r\n\r\n### Steps to reproduce\r\n\r\n* Puppeteer version: puppeteer@0.13.0\r\n* Platform / OS version:\r\nLinux debian 3.16.0-4-amd64 #1 SMP Debian 3.16.43-2+deb8u5 (2017-09-19) x86_64 GNU/Linux\r\n\r\n```\r\nconst puppeteer = require('puppeteer');\r\nconst devices = require('puppeteer/DeviceDescriptors');\r\nconst speedline = require('speedline');\r\n\r\nasync function run() {\r\n    const iPhone = devices['iPhone 6'];\r\n    const browser = await puppeteer.launch({args: ['--no-sandbox', '--disable-setuid-sandbox']});\r\n    const filename = 'trace.json';\r\n\r\n    const page = await browser.newPage();\r\n    await page.emulate(iPhone);\r\n    try {\r\n        await page.tracing.start({path: filename, screenshots: true});\r\n        await page.goto('https://www.amazon.fr');\r\n        await page.tracing.stop();\r\n        const results = await speedline(filename);\r\n        console.log('Speed Index value:', results.speedIndex);\r\n    } catch (e) {\r\n        console.error(e);\r\n    }\r\n    browser.close();\r\n}\r\n\r\nrun();\r\n```\r\n\r\n**What is the expected result?**\r\nImage should all be 375x667 according to the `DeviceDescriptors.js`file\r\n```\r\n{\r\n    'name': 'iPhone 6',\r\n    'userAgent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1',\r\n    'viewport': {\r\n      'width': 375,\r\n      'height': 667,\r\n      'deviceScaleFactor': 2,\r\n      'isMobile': true,\r\n      'hasTouch': true,\r\n      'isLandscape': false\r\n    }\r\n  },\r\n\r\n```\r\n\r\n**What happens instead?**\r\nThe two first pictures size are  376x667, triggering an exception `Images have different sizes!` into ImageSSIM\r\n\r\n"},{"labels":["bug"],"text":"v1.0.0-rc  page.waitForNavigation()\r\n\r\nsetting timeout:0 should disable timeout according to the docs (meaning it never times out), but it seems to just actually set it to 0 seconds, and then promise reverts to null immediately everytime.\r\n"},{"labels":["bug"],"text":"https://github.com/GoogleChrome/puppeteer/blob/0467c346b1a23608001dd66d9fe49f147600baa6/lib/NetworkManager.js#L441\r\n\r\n```\r\nYou have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:\r\n TypeError: Cannot read property 'url' of undefined\r\n     at new Response (/var/www/node_modules/puppeteer/lib/NetworkManager.js:441:24)\r\n     at NetworkManager._handleRequestRedirect (/var/www/node_modules/puppeteer/lib/NetworkManager.js:174:22)\r\n     at NetworkManager._onRequestWillBeSent (/var/www/node_modules/puppeteer/lib/NetworkManager.js:221:12)\r\n     at emitOne (events.js:116:13)\r\n     at Session.emit (events.js:211:7)\r\n     at Session._onMessage (/var/www/node_modules/puppeteer/lib/Connection.js:210:12)\r\n     at Connection._onMessage (/var/www/node_modules/puppeteer/lib/Connection.js:105:19)\r\n     at <anonymous>\r\n```\r\n\r\nNot sure where this is even coming from -- everything that I see has a catch, and my code is even working fine even when this error comes up.\r\n\r\nSome malformed response being mishandled?"},{"labels":["bug",null],"text":"The promise returned by [response.buffer()](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#responsebuffer)  consistently rejects for certain resources. This makes it impossible to collect information about certain resources that can only be obtained from the buffer, such as the length of the resource.\r\n\r\nThe problem seems to particularly affect video/media files. (Perhaps because partial requests are involved?)\r\n\r\nTo reproduce:\r\n\r\n```js\r\n'use strict';\r\n\r\nconst URL = 'https://www.quirksmode.org/html5/tests/video.html';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\n\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\nawait page.on('response', response => {\r\n  const url = response.url;\r\n  if (!url.startsWith('data:') && response.ok) {\r\n    response.buffer().then(\r\n        b => {\r\n          console.log(`${response.status} ${url} ${b.length} bytes`);\r\n        },\r\n        e => {\r\n          console.error(`${response.status} ${url} failed: ${e}`);\r\n        }\r\n    );\r\n  }\r\n});\r\n\r\nawait page.goto(URL, { waitUntil: 'networkidle0' });\r\n\r\n})();\r\n```\r\n\r\nActual:\r\n\r\n```\r\n200 https://www.quirksmode.org/html5/tests/video.html 2905 bytes\r\n200 https://www.quirksmode.org/quirksmode.css 16360 bytes\r\n200 https://www.quirksmode.org/quirksmode.js 22540 bytes\r\n200 https://www.quirksmode.org/pix/footer_bg.gif 312 bytes\r\n206 https://www.quirksmode.org/html5/videos/big_buck_bunny.webm failed: Error: Protocol error (Network.getResponseBody): No data found for resource with given identifier undefined\r\n206 https://www.quirksmode.org/html5/videos/big_buck_bunny.ogv failed: Error: Protocol error (Network.getResponseBody): No data found for resource with given identifier undefined\r\n206 https://www.quirksmode.org/html5/videos/big_buck_bunny.webm 24804 bytes\r\n206 https://www.quirksmode.org/html5/videos/big_buck_bunny.ogv 66642 bytes\r\n```\r\n\r\nExpected:\r\n\r\nAs above, but without the \"Error: Protocol error (Network.getResponseBody): No data found for resource with given identifier undefined\" messages.\r\n\r\nThe \"broken\" resources seem to be associated with 206 responses."},{"labels":["bug",null],"text":"* Puppeteer version: v0.13.0-alpha with https://github.com/GoogleChrome/puppeteer/pull/1259\r\n* Platform / OS version: Windows 7 x64\r\n* URLs (if applicable): https://example.org/\r\n\r\nI am not sure if I use indexedDB completely properly, please, correct me if needed.\r\n\r\n<details>\r\n<summary>Code example:</summary>\r\n\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async function main() {\r\n  try {\r\n    let browser = await puppeteer.launch({\r\n      headless: false,\r\n      userDataDir: 'test-profile-dir',\r\n    });\r\n    let page = await browser.newPage();\r\n    await page.goto('https://example.org/');\r\n    await page.evaluate(setIDB, 'headfulIDB', 'foo');\r\n    await page.close();\r\n    await browser.close();\r\n\r\n    browser = await puppeteer.launch({\r\n      headless: true,\r\n      userDataDir: 'test-profile-dir',\r\n    });\r\n    page = await browser.newPage();\r\n    await page.goto('https://example.org/');\r\n    await page.evaluate(setIDB, 'headlessIDB', 'bar');\r\n    await page.close();\r\n    await browser.close();\r\n\r\n    browser = await puppeteer.launch({\r\n      headless: false,\r\n      userDataDir: 'test-profile-dir',\r\n    });\r\n    page = await browser.newPage();\r\n    await page.goto('https://example.org/');\r\n    console.log('Headful mode.');\r\n    console.log('Headful IDB: ', await page.evaluate(getIDB, 'headfulIDB'));\r\n    console.log('Headless IDB: ', await page.evaluate(getIDB, 'headlessIDB'));\r\n    await page.close();\r\n    await browser.close();\r\n\r\n    browser = await puppeteer.launch({\r\n      headless: true,\r\n      userDataDir: 'test-profile-dir',\r\n    });\r\n    page = await browser.newPage();\r\n    await page.goto('https://example.org/');\r\n    console.log('Headless mode.');\r\n    console.log('Headful IDB: ', await page.evaluate(getIDB, 'headfulIDB'));\r\n    console.log('Headless IDB: ', await page.evaluate(getIDB, 'headlessIDB'));\r\n    await page.close();\r\n    await browser.close();\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n})();\r\n\r\n\r\nfunction setIDB(key, value) {\r\n  return new Promise((resolve, reject) => {\r\n    const openRequest = indexedDB.open('testIDB', 1);\r\n\r\n    openRequest.onerror = (err) => { reject(err.target.error); };\r\n    openRequest.onupgradeneeded = (event) => { event.target.result.createObjectStore('test'); };\r\n\r\n    openRequest.onsuccess = (event) => {\r\n      const db = event.target.result;\r\n\r\n      db.onerror = (err) => { db.close(); reject(err.target.error); };\r\n\r\n      db.transaction('test', 'readwrite')\r\n        .objectStore('test')\r\n        .put(value, key)\r\n        .onsuccess = () => { db.close(); resolve(); };\r\n    };\r\n  });\r\n}\r\n\r\nfunction getIDB(key) {\r\n  return new Promise((resolve, reject) => {\r\n    const openRequest = indexedDB.open('testIDB', 1);\r\n\r\n    openRequest.onerror = (err) => { reject(err.target.error); };\r\n    openRequest.onupgradeneeded = (event) => { event.target.result.createObjectStore('test'); };\r\n\r\n    openRequest.onsuccess = (event) => {\r\n      const db = event.target.result;\r\n\r\n      db.onerror = (err) => { db.close(); reject(err.target.error); };\r\n\r\n      db.transaction('test', 'readonly')\r\n        .objectStore('test')\r\n        .get(key)\r\n        .onsuccess = (eventGet) => {\r\n          const { result } = eventGet.target;\r\n          db.close();\r\n          resolve(result);\r\n        };\r\n    };\r\n  });\r\n}\r\n```\r\n</details><br>\r\n\r\n<details>\r\n<summary>Output:</summary>\r\n\r\n```console\r\nHeadful mode.\r\nHeadful IDB:  foo\r\nHeadless IDB:  undefined\r\nHeadless mode.\r\nHeadful IDB:  undefined\r\nHeadless IDB:  bar\r\n```\r\n</details><br>"},{"labels":["bug",null],"text":"1. Open headful chrome with a custom userDataDir\r\n2. Write some localStorage:\r\n```js\r\nlocalStorage.key = 'hello';\r\n```\r\n3. Close headful chrome\r\n4. run headless with the same userDataDir\r\n5. try reading localStorage in headless chrome:\r\n```js\r\nawait page.evaluate(() => localStorage.key);\r\n```\r\nExpected: \"hello\" to be returned in (5)\r\nActual: empty object is returned\r\n\r\nThis is similar to #921 and might be due to missing encryption for local storage in headless chrome."},{"labels":["bug",null],"text":"I've been having issues trying to hover an svg element using `elementHandle.hover()`, now using `page.evaluate(element => element.getBoundingClientRect(), elementHandle)` works so I'm not sure why it throws an error for `.hover()`.\r\n\r\nHere's a minimal example that causes it:\r\n\r\n[puppeteer-svg-hover-test.zip](https://github.com/GoogleChrome/puppeteer/files/1436011/puppeteer-svg-hover-test.zip)"},{"labels":[null,"bug"],"text":"Hello,\r\n\r\nI have a case where puppeeter click don't seems to work on website in headless mode with pupeeteer 0.12, here is the case: \r\n \r\n```javascript\r\npuppeteer.launch({`\r\n    args: [\r\n        '--no-sandbox',\r\n        '--disable-setuid-sandbox',\r\n        '--remote-debugging-port=9222',\r\n        '--disable-gpu'\r\n    ]\r\n}).then(async browser => {\r\n\r\n    const page = await browser.newPage();\r\n    await page.setViewport({width: 1920, height: 1080});\r\n\r\n    await page.goto('https://www.parapharmacie.leclerc/visage/soins-du-visage/anti-age/weleda-creme-de-nuit-raffermissante-a-la-grenade-bio-30ml', {waitUntil: 'networkidle'});\r\n    await page.click('#product_addtocart_form > div.product-col-right > div.add-to-cart-wrapper > div > div.add-to-cart > div.add-to-cart-buttons > button');\r\n    setTimeout(async () => {\r\n        await page.goto('https://www.parapharmacie.leclerc/checkout/cart/', {waitUntil: ['networkidle', 'load', 'domcontentloaded']}).then(async () => {\r\n            await page.click('#domicile_radio');\r\n            await page.click('body > div.wrapper > div.page > div.main-container.col1-layout > div > div.col-main > div:nth-child(6) > button.button2.btn-continue.btn-commande').then(() => {\r\n                console.log('Click on button OK')\r\n            });\r\n            await page.waitForNavigation({\r\n                waitUntil: ['networkidle', 'load', 'domcontentloaded']\r\n            }).then(async () => {\r\n                console.log(await page.url());\r\n                await browser.close();\r\n            }).catch(async err => {\r\n                await page.setViewport({width: 0, height: 0});\r\n                await page.screenshot({\r\n                    path: './capture.fullscreen.png',\r\n                    type: 'png',\r\n                    fullPage: true\r\n                });\r\n                console.log('Current URL : '+await page.url());\r\n                console.log(err);\r\n                await browser.close();\r\n            });\r\n        });\r\n\r\n    }, 2000);\r\n\r\n}).catch(err => {\r\n    console.log((err.stack));\r\n});\r\n```\r\n\r\nThe code is try to do :\r\n- adding a product to cart\r\n- going in cart\r\n- selecting a delivery mode\r\n- clicking on next step button\r\n\r\n**The expected behavior is to land on this URL : https://www.parapharmacie.leclerc/checkout/onepage/\r\nBut this never occur.**\r\nBut if I connect myself to the headless remote devtool and I click on the button, it's works well. So I don't understand why click is not properly triggered.\r\n\r\nHere is the ouput produced with DEBUG=\"puppeteer:mouse\" \r\n```\r\npuppeteer:mouse mouse.click(1294.5, 613.5, ) +0ms\r\n  puppeteer:mouse mouse.move(1294.5, 613.5) +2ms\r\n  puppeteer:mouse mouse.down({}) +1ms\r\n  puppeteer:mouse mouse.up({}) +1ms\r\n  puppeteer:mouse mouse.click(556.5, 540.5, ) +7s\r\n  puppeteer:mouse mouse.move(556.5, 540.5) +0ms\r\n  puppeteer:mouse mouse.down({}) +1ms\r\n  puppeteer:mouse mouse.up({}) +1ms\r\n  puppeteer:mouse mouse.click(1348, 881.5, ) +60ms\r\n  puppeteer:mouse mouse.move(1348, 881.5) +0ms\r\n  puppeteer:mouse mouse.down({}) +2ms\r\n  puppeteer:mouse mouse.up({}) +1ms\r\nClick on button OK\r\nCurrent URL : https://www.parapharmacie.leclerc/checkout/cart/\r\nError: Navigation Timeout Exceeded: 30000ms exceeded\r\n    at NavigatorWatcher.waitForNavigation (/usr/src/app/node_modules/puppeteer/lib/NavigatorWatcher.js:76:20)\r\n    at <anonymous>\r\n```"},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\nPuppeteer version: 0.12.0\r\nPlatform / OS version: macOS El Capitan\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nIf loading external script fails (wrong url, internet is down ...), if you call:\r\n\r\nawait page.addScriptTag({url: \"someurl\"});\r\n\r\nnothing will happen and execution of a code will be stuck on this line.\r\n\r\n**What is the expected result?**\r\n\r\nPromise should be rejected because of an error.\r\n\r\n**What happens instead?**\r\n\r\nPromise is not rejected because in FrameManager.js \"onerror\" callback is not registered."},{"labels":[null,"bug"],"text":"### Steps to reproduce\r\n\r\n* Puppeteer version: `v0.12.0`\r\n* Platform / OS version: Linux Ubuntu or try-puppeteer.appspot.com\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. run: \r\n``` javascript\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\n\r\npage.on('framenavigated',frameTo =>{\r\n  console.log(`framenavigated to ${frameTo.url()}`);\r\n  page.evaluate(()=>{\r\n    // doing anything here\r\n  });\r\n})\r\n\r\nawait page.goto('https://example.com');\r\nawait page.screenshot({path: 'screenshot.png'});\r\nawait browser.close();\r\n```\r\n\r\n**What is the expected result?**\r\nNo error in console\r\n\r\n**What happens instead?**\r\nthrow this error: \r\n```log\r\nError: Protocol error (Runtime.callFunctionOn): Cannot find context with specified id undefined\r\n```\r\n"},{"labels":["bug",null],"text":"Just create a simple project with Puppeteer and try to access a page that uses Service Workers, having request interception enabled (you don't need to do anything); for instance:\r\n\r\n```js\r\n    const puppeteer = require('puppeteer');\r\n\r\n    const URL = 'https://googlechrome.github.io/samples/service-worker/basic/';\r\n\r\n    // enables request interception but allow everything\r\n    async function mockPage(page) {\r\n        await page.setRequestInterceptionEnabled(true);\r\n        await page.on('request', req => req.continue());\r\n    }\r\n\r\n    async function main() {\r\n        const browser = await puppeteer.launch({ headless: false, devtools: true });\r\n        const page = await browser.newPage();\r\n        await mockPage(page);\r\n\r\n        await page.goto(URL);\r\n    }\r\n\r\n    main().then(data => console.log(data)).catch(err => console.error(err));\r\n```\r\n\r\nCheck the console to see that the ServiceWorker has failed with the following error:\r\n\r\n> Uncaught (in promise) DOMException: Failed to register a ServiceWorker: No URL is associated with the caller's document.\r\n\r\nI assume it has something to do with ServiceWorkers also being able to intercept requests. Since ServiceWorkers are very restrictive and require HTTPS request, I thought maybe some certificate error was happening with the Request Interception, so I tryed to add a few options to launch:\r\n\r\n * `ignoreHTTPSErrors: false`\r\n * `args: ['--ignore-certificate-errors', '--unsafely-treat-insecure-origin-as-secure=' + URL]`\r\n\r\nBut to no avail.\r\n\r\nI'm using the latest Puppeteer stable version, `0.12.0`, and also on the `master` branch, on Linux.\r\n\r\n"},{"labels":[null,"bug"],"text":"- Platform/OS: macOS High Sierra\r\n- Puppeteer version: Puppeteer version: ab9b34cd5dad54e170be916016a4e9b4097231ed (from master branch as of Oct 24), 0.12.0 has same problem\r\n\r\nTake this url http://diy-cellars.space/woodworking-plans-glider/?DIYCellar=301248662559422964\r\n and the following code snippet for example.\r\n```\r\n\r\nasync function dumpFrameTree(page, frame, indent) {\r\n    console.log(indent + frame.url());\r\n    const result = await frame.evaluate(() => {\r\n        let retVal = '';\r\n        if (document.doctype) {\r\n            retVal = new XMLSerializer().serializeToString(document.doctype);\r\n        }\r\n        if (document.documentElement) {\r\n            retVal += document.documentElement.outerHTML;\r\n        }\r\n        return retVal;\r\n    });\r\n    console.log(indent + \"  \" + result.slice(0, 20));\r\n    for (let child of frame.childFrames()) {\r\n        await dumpFrameTree(page, child, indent + '  ');\r\n    }\r\n}\r\n\r\nawait page.goto(url, {waitUntil: 'networkidle0', timeout: 60000});\r\nawait dumpFrameTree(page, page.mainFrame(), '');\r\n```\r\n\r\nThe above code will print:\r\n```\r\nhttp://diy-cellars.space/woodworking-plans-glider/?DIYCellar=301248662559422964\r\n  <html><head></head><\r\n  http://diy-cellars.space/pin.php?ProcessId=301248662559422964\r\n    <html><head><script \r\n  \r\nTypeError: Cannot read property 'evaluate' of null\r\n```\r\n\r\nIf sleep for 5 seconds between `page.goto` and `dumpFrameTree`, we can get the expected result:\r\n```\r\nhttp://diy-cellars.space/woodworking-plans-glider/?DIYCellar=301248662559422964\r\n  <html><head></head><\r\n  http://diy-cellars.space/pin.php?ProcessId=301248662559422964\r\n    <html><head><script \r\n  http://www.tedswoodworking.com/new/main/\r\n    <!DOCTYPE html><html\r\n    https://player.vimeo.com/video/71084479\r\n      <!DOCTYPE html><html\r\n    https://player.vimeo.com/video/71084478\r\n      <!DOCTYPE html><html\r\n```\r\n\r\nThe waitForNavigation function that page.goto delegates to only listen to main frame event instead of all frames. If goto listens to all the frame event (or that there's a workaround), this will be addressed.\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.13.0-alpha\r\n* Platform / OS version: OS EI 10.11\r\n* URLs (if applicable):\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nWell. I try to test the method of `goBack` and `goForward`.But it appears something unexpected, just like the code as follow:\r\n\r\n```javascript\r\nconst puppeteer = require('puppeteer')\r\n\r\n;(async () => {\r\n  const browser = await puppeteer.launch({\r\n    headless: false\r\n  })\r\n  const page = await browser.newPage()\r\n  await page.goto('https://www.baidu.com')\r\n  await new Promise(resolve => setTimeout(resolve, 2000))\r\n  await page.type('.s_ipt', '测试', {\r\n    delay: 500\r\n  })\r\n  await page.click('#su')\r\n  await new Promise(resolve => setTimeout(resolve, 2000))\r\n  await page.goBack()\r\n \r\n  console.log('back')\r\n\r\n  await new Promise(resolve => setTimeout(resolve, 2000))\r\n  await page.goForward()\r\n\r\n  console.log('forward')\r\n\r\n  await browser.close()\r\n})()\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nThe expected result is the script has run , the terminal will print 'back' after the page go back and print 'forward' after the go forward, and the browser was closed in the end.\r\n\r\n**What happens instead?**\r\n\r\nBut in the terminal, there is no 'back' or 'forward',and the stdout appear the message that \r\n\r\n> (node:39404) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Navigation Timeout Exceeded: 30000ms exceeded\r\n(node:39404) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n\r\nand the browser wasn't closed. And the terminal and puppeteer didn't exit.\r\n\r\n\r\n\r\n---- \r\n\r\n### Update:\r\n\r\n```javascript\r\nasync waitForNavigation() {\r\n    this._requestIds = new Set();\r\n\r\n    this._eventListeners = [];\r\n\r\n    const navigationPromises = [];\r\n    if (this._timeout) {\r\n      const watchdog = new Promise(fulfill => this._maximumTimer = setTimeout(fulfill, this._timeout))\r\n          .then(() => 'Navigation Timeout Exceeded: ' + this._timeout + 'ms exceeded');\r\n      navigationPromises.push(watchdog);\r\n    }\r\n\r\n    if (!this._ignoreHTTPSErrors) {\r\n      const certificateError = new Promise(fulfill => {\r\n        this._eventListeners.push(helper.addEventListener(this._client, 'Security.certificateError', fulfill));\r\n      }).then(error => 'SSL Certificate error: ' + error.errorType);\r\n      navigationPromises.push(certificateError);\r\n    }\r\n\r\n    if (this._waitUntil === 'load') {\r\n      const loadEventFired = new Promise(fulfill => {\r\n        this._eventListeners.push(helper.addEventListener(this._client, 'Page.loadEventFired', fulfill));\r\n      }).then(() => null);\r\n      navigationPromises.push(loadEventFired);\r\n    } else {\r\n      this._eventListeners.push(...[\r\n        helper.addEventListener(this._client, 'Network.requestWillBeSent', this._onLoadingStarted.bind(this)),\r\n        helper.addEventListener(this._client, 'Network.loadingFinished', this._onLoadingCompleted.bind(this)),\r\n        helper.addEventListener(this._client, 'Network.loadingFailed', this._onLoadingCompleted.bind(this)),\r\n        helper.addEventListener(this._client, 'Network.webSocketCreated', this._onLoadingStarted.bind(this)),\r\n        helper.addEventListener(this._client, 'Network.webSocketClosed', this._onLoadingCompleted.bind(this)),\r\n      ]);\r\n      const networkIdle = new Promise(fulfill => this._networkIdleCallback = fulfill).then(() => null);\r\n      navigationPromises.push(networkIdle);\r\n    }\r\n\r\n    const error = await Promise.race(navigationPromises);\r\n    this._cleanup();\r\n    return error ? new Error(error) : null;\r\n  }\r\n```\r\n\r\nIn the `NavigatorWatcher.js`.There are three promises in the navigationPromises of my test code.And the the first watchdog always execute after the timeout option. And the other two promise will never be resolved.So the error always `Navigation Timeout Exceeded: (timeout)ms exceeded'` and the error will be thrown out."},{"labels":[null,"bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: ab9b34cd5dad54e170be916016a4e9b4097231ed\r\n* Platform / OS version: debian stretch, nodejs 8.8\r\n* URLs (if applicable): https://halva.khady.info\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nJust launch this code to see the problem:\r\n\r\n```javascript\r\n// https.js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\nconst URL = \"https://halva.khady.info/\";\r\n\r\n(async() => {\r\n  const args = [\r\n    \"--disable-setuid-sandbox\",\r\n    \"--no-sandbox\",\r\n  ];\r\n  const options = {\r\n    args,\r\n    headless: true,\r\n    ignoreHTTPSErrors: true,\r\n  };\r\n  const browser = await puppeteer.launch(options);\r\n  const page = await browser.newPage();\r\n  await page.setRequestInterception(true);\r\n  page.on(\"request\", (request) => {\r\n    if (request.resourceType === \"Image\") {\r\n      request.abort();\r\n    } else {\r\n      request.continue();\r\n    }\r\n  });\r\n  await page.goto(URL, { timeout: 8000, waitUntil: \"load\" });\r\n  const html = await page.content();\r\n  console.log(html);\r\n  await page.close();\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nWith the request interception disabled:\r\n\r\n```\r\n  // await page.setRequestInterception(true);\r\n  // page.on(\"request\", (request) => {\r\n  //   if (request.resourceType === \"Image\") {\r\n  //     request.abort();\r\n  //   } else {\r\n  //     request.continue();\r\n  //   }\r\n  // });\r\n```\r\n\r\n```\r\n$ nodejs misc/https_headless.js \r\n<html><head><title>potkw</title></head>\r\n<body>\r\nKhady Khady roule roule\r\n\r\n</body></html>\r\n```\r\n\r\n**What happens instead?**\r\n\r\n```\r\n$ nodejs misc/https_headless.js \r\n(node:23556) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Navigation Timeout Exceeded: 8000ms exceeded\r\n(node:23556) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n^C\r\n```"},{"labels":[null,"bug"],"text":"**Environment:**\r\n\r\n* Puppeteer version: 0.12.0 / 0.13.0-alpha\r\n* Platform / OS version: Ubuntu 17.04\r\n* URLs: [Test in PR](https://github.com/GoogleChrome/puppeteer/pull/1125) / `https://www.htmlbin.net/login`\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```javascript\r\nconst puppeteer = require('puppeteer');\r\nlet browser = null;\r\n\r\n(async () => {\r\n  browser = await puppeteer.launch({\r\n    headless: true,\r\n  });\r\n\r\n  const page = await browser.newPage();\r\n  await page.goto('https://www.htmlbin.net/login');\r\n  await page.click('.checkbox input');\r\n  await page.screenshot({path: 'headless_true.png'});\r\n  await browser.close();\r\n\r\n  browser = await puppeteer.launch({\r\n    headless: false,\r\n  })\r\n\r\n  const page = await browser.newPage();\r\n  await page.goto('https://www.htmlbin.net/login');\r\n  await page.click('.checkbox input');\r\n  await page.screenshot({path: 'headless_false.png'});\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nBoth screenshots should show the checkbox in the checked state.\r\n\r\n**What happens instead?**\r\n\r\nCheckbox is only shown in checked state when browser is launched with `headless: true`.\r\n\r\nNo mouse/click events are triggered for `headless: false` either, I've added more information in #1125."},{"labels":["bug",null,null],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.12\r\n* Platform / OS version: Windows 10\r\n* URLs (if applicable): http://scooterlabs.com/echo\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n```js\r\nvar pup = require('puppeteer');\r\n\r\nfunction test(){\r\n  window.test = 1;\r\n}\r\n\r\n(async() =>{\r\n  var b = await pup.launch({\r\n    headless: true,\r\n    args: [\r\n      '--no-sandbox',\r\n      '--disable-web-security'\r\n    ]\r\n  });\r\n  var p = await b.newPage();\r\n  await p.evaluateOnNewDocument(test);\r\n  await p.goto('http://scooterlabs.com/echo');\r\n\r\n  var foo = await p.evaluate(()=>{\r\n    var el = document.createElement('iframe');\r\n    el.setAttribute('sandbox', 'allow-same-origin');\r\n    document.body.appendChild(el);\r\n    return el.contentWindow.test;\r\n  })\r\n\r\n  var bar = await p.evaluate(()=>{\r\n    var el = document.createElement('iframe');\r\n    document.body.appendChild(el);\r\n    return el.contentWindow.test;\r\n  })\r\n\r\n  console.log('foo', foo);\r\n  console.log('bar ', bar );\r\n  await b.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n`foo` should be `1` instead of `undefined`\r\n\r\n**What happens instead?**\r\n`foo` should be `1` instead of `undefined`\r\n"},{"labels":["bug",null],"text":"Two-folded issue. Some Emojis aren't typed correctly (others seem to work, randomly). And newlines are also ignored (so is `keyboard.press('Enter')`). The solution for newline treatment is to split the text by \"\\n\" and then do line by line, with a `page.type(\"#target\", String.fromCharCode(13));` at the end of it.\r\n\r\n### Steps to reproduce\r\n\r\n* Puppeteer version: 0.13.0-alpha\r\n* Platform / OS version: OSX, also Debian 9\r\n\r\nAn empty HTML file, only has the following inside (it also doesn't work with the `<meta charset='utf-8'>` tag added, no difference):\r\n\r\n`<textarea id=\"theTarget\"></textarea>`\r\n\r\nThe code that causes the problem:\r\n\r\n`var sample = Buffer.from(\"8J+RuSBUb2t5byBzdHJlZXQKSmFwYW4g8J+Hr/Cfh7Ug\", 'base64').toString('utf8');\r\nawait page.type(\"#theTarget\", sample);`\r\n\r\nEven without the Buffer and decoding, if you just use the following, it won't work:\r\n`await page.type(\"#theTarget\", \"👹 Tokyo street\");`\r\n\r\n**What is the expected result?**\r\n\r\n👹 Tokyo street\r\nJapan 🇯🇵\r\n\r\n**What happens instead?**\r\n\r\n Tokyo streetJapan "},{"labels":["bug"],"text":"**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.12.0\r\n* Platform / OS version: Linux / CentOS 7 x86_64\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nPlease see [this script](https://github.com/GoogleChrome/puppeteer/files/1398167/data-uri-redirect-timeout.js.gz). Alternatively simply visit a page that contains a JavaScript redirect to a data URI, e.g. `window.location.href = 'data:...'` in a script tag.\r\n\r\n**What is the expected result?**\r\n\r\n`page.goto` should finish without error, even if the redirect is not followed.\r\n\r\n**What happens instead?**\r\n\r\n`page.goto` times out and throws an error.\r\n\r\nPossibly related to https://groups.google.com/a/chromium.org/forum/#!topic/blink-dev/GbVcuwg_QjM - support for redirecting to data URIs in the top frame with Javascript has been removed from Chrome. I'm not sure why this causes `page.goto` to time out, though."},{"labels":[null,"bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version:\r\nnewest\r\n* Platform / OS version:\r\nwindows 10\r\n* URLs (if applicable):\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n_Please include code that reproduces the issue._\r\n```js\r\nconst puppeteer = require('puppeteer');\r\nconst devices = require('puppeteer/DeviceDescriptors');\r\nconst iPhone = devices['iPhone 5'];\r\n\r\n\r\npuppeteer.launch({headless: false}).then(async browser => {\r\n  const page = await browser.newPage();\r\n  await page.goto('https://google.com');\r\n  const inputElement = await page.$('input[type=submit]');\r\n  await inputElement.click();\r\n  \r\n  // ...\r\n});\r\n\r\n\r\n```\r\n\r\nclick not fire.\r\n\r\n![222](https://user-images.githubusercontent.com/11001914/31765929-acd756ac-b4f8-11e7-80f0-0cba61bafc18.png)\r\n\r\n\r\n**What is the expected result?**\r\n\r\n\r\n**What happens instead?**\r\n\r\n"},{"labels":[null,"bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.12\r\n* Platform / OS version: Fedora 26\r\n* URLs (if applicable): https://facebook.com/login\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```js\r\n  const browser = await puppeteer.launch({\r\n    headless: false,\r\n    args: ['--disable-notifications'],\r\n  });\r\n  const page = await browser.newPage();\r\n\r\n  // The page needs to be at least ~1450px wide so the chat tab doesn't overlap\r\n  // with the posts area that this script needs to click into.\r\n  await page.setViewport({width: 1600, height: 900});\r\n  console.log('Chrome ready');\r\n\r\n  const account = { email: 'foo@bar.com', password: 'pwd' };\r\n\r\n  await page.goto('https://www.facebook.com/login');\r\n\r\n  const emailField = await page.$('input[name=email]');\r\n  await emailField.click({ delay: 100 });\r\n  await emailField.type(account.email, { delay: 100 });\r\n  await emailField.dispose();\r\n\r\n  const passwordField = await page.$('input[name=pass]');\r\n  await passwordField.click({ delay: 100 });\r\n  await passwordField.type(account.password, { delay: 100 });\r\n  await passwordField.dispose();\r\n\r\n  const loginButton = await page.$('button[name=login]');\r\n  await loginButton.focus();\r\n  await loginButton.click({ delay: 100 });\r\n  await loginButton.dispose();\r\n\r\n  await page.waitForNavigation({\r\n      waitUntil: 'networkidle', networkIdleTimeout: 4000 });\r\n```\r\n\r\n**What is the expected result?**\r\nThe click goes through and a login is attempted.\r\n\r\n**What happens instead?**\r\nThe click does not go through.\r\n\r\nI have a hunch that the underlying problem is https://crbug.com/692197.\r\n\r\nMy workaround (based on mixing code from 0.11 and 0.12):\r\n\r\n```js\r\n  const elementHandle = await page.$('body');\r\n  elementHandle.constructor.prototype.boundingBox = async function() {\r\n    const box = await this.executionContext().evaluate(element => {\r\n      const rect = element.getBoundingClientRect();\r\n      const x = Math.max(rect.left, 0);\r\n      const width = Math.min(rect.right, window.innerWidth) - x;\r\n      const y = Math.max(rect.top, 0);\r\n      const height = Math.min(rect.bottom, window.innerHeight) - y;\r\n      return { x: x, width: width, y: y, height: height };\r\n    }, this);\r\n    return box;\r\n  };\r\n  elementHandle.dispose();\r\n```\r\n\r\nIs there any chance you could offer switchable implementations of `ElementHandle.boundingBox` until the `DOM.getBoxModel` issues are straightened out?\r\n\r\nMany thanks for puppeteer! :heart: "},{"labels":["bug",null],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.12.0-alpha and 0.11.0\r\n* Platform / OS version: CentOS 7.4, Ubuntu 17.04, OS X 10.12.6\r\n* URLs (if applicable): https://xocsp.ccp.xcal.tv/comcastSP/protected/auth?tenant=a2t_uuid&continue=https://streaminder.xcal.tv/sessions/create_sso&partner-id=comcast\r\n\r\n**What steps will reproduce the problem?**\r\nThe error is reproducible with https://try-puppeteer.appspot.com/\r\n\r\n```js\r\nvar url = \"https://xocsp.ccp.xcal.tv/comcastSP/protected/auth?tenant=a2t_uuid&continue=https://streaminder.xcal.tv/sessions/create_sso&partner-id=comcast\";\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch({\r\n\targs: ['--no-sandbox', '--disable-setuid-sandbox'],\r\n  });\r\n  const page = await browser.newPage();\r\n  await page.goto(url);\r\n  await page.screenshot({path: 'example.png'});\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\nRedirect to SSO ADFS login page\r\n\r\n**What happens instead?**\r\n`Failed to navigate: https://xocsp.ccp.xcal.tv/comcastSP/protected/auth?tenant=a2t_uuid&continue=https://streaminder.xcal.tv/sessions/create_sso&partner-id=comcast`\r\n"},{"labels":["bug",null],"text":"\r\n\r\n**Tell us about your environment:**\r\n* Windows10\r\n* puppeteer 0.11.0\r\n\r\n**Problem?**\r\n\r\nFullpage screenshots of single page websites will not be displayed correctly.\r\nI tried to clip areas,  scrolling through the page and **waitForNavigation**. \r\n\r\nSimiliar problems with navalia, chromeless and phantomjs.\r\n\r\nIs there anything else i can do?\r\n\r\n**Steps reproduce**\r\n\r\n`const puppeteer = require('puppeteer');\r\nvar url = \"http://thehenhouse.com.au/\";   // page url\r\nvar name = \"the\"\r\nvar resWidth = 1366;                // width of screenshot\r\nvar resHeight = 1000; \r\n\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage()\r\n  await page.goto(url, {waitUntil: 'load'});\r\n  // await page.waitForNavigation({waitUntil: 'networkidle'});\r\n  await page.setViewport({width: resWidth, height: resHeight});\r\n  await page.emulateMedia('screen');\r\n  await page.screenshot({path: name + '-' + resWidth + '.jpeg', type: 'jpeg', fullPage: true});\r\n  console.log(\"screenshot done\");\r\n  \r\n  await browser.close();\r\n})();`\r\n\r\n\r\n![the-1366](https://user-images.githubusercontent.com/32541809/31228659-82be459e-a9de-11e7-8713-a50e9cb3c375.jpeg)\r\n\r\n\r\n\r\n\r\n"},{"labels":["bug"],"text":"### Steps to reproduce\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: v0.11.0, v0.12.0\r\n* Platform / OS version: \r\n* URLs (if applicable): https://www.upwork.com/ab/account-security/login\r\n\r\nChrome version tested: 59, 62, 63\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nCreate a script that will go to upwork, and login. \r\nMaybe first time it'll load properly, it'll fail to load on second try.\r\n\r\n_Please include code that reproduces the issue._\r\n\r\n1. Works fine on Chromeless\r\n```js\r\nconst chromeless = new Chromeless({ remote: true })\r\nconst screenshot = await chromeless\r\n  .goto('https://www.upwork.com/ab/account-security/login')\r\n  .type(\"*********\", \"#login_username\")\r\n  .type(\"*********\",\"#login_password\")\r\n  .click(\"#layout > div.container > div > form > div.form-group.hidden-xs.m-0-bottom > button\")\r\n  .wait(20000)\r\n  .screenshot()\r\nconsole.log(screenshot)\r\nawait chromeless.end()\r\n```\r\n\r\n2. Does not work at in puppeteer\r\n```js\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\n\r\ntry{\r\nawait page.goto('https://www.upwork.com/ab/account-security/login');\r\nawait page.click(\"#login_username\")\r\nawait page.type(\"*********\")\r\nawait page.click(\"#login_password\")\r\nawait page.type(\"*********\")\r\nawait page.click(\"#layout > div.container > div > form > div.form-group.hidden-xs.m-0-bottom > button\")\r\nawait page.waitFor(2000) \r\nawait page.screenshot({path: 'screenshot.png'});\r\n\r\n}catch(e){\r\n  console.log(e);\r\n  await page.screenshot({path: 'screenshot.png'});\r\n}\r\nawait browser.close();\r\n```\r\n\r\n**What is the expected result?**\r\nDisclaimer: The account used was a dummy account.\r\n\r\nThe page will be logged in nicely.\r\n![image](https://user-images.githubusercontent.com/8284972/31058199-9ea9ab7e-a711-11e7-95a4-84c2bb6b0b9a.png)\r\n![image](https://user-images.githubusercontent.com/8284972/31058229-0a90f8b0-a712-11e7-9be3-0927b278153b.png)\r\n\r\n**What happens instead?**\r\nThe page does not load properly, let alone login.\r\n![image](https://user-images.githubusercontent.com/8284972/31058201-a408c92e-a711-11e7-9a16-9829a25ecf97.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8284972/31058228-008982ba-a712-11e7-890b-d41d5769433e.png)\r\n\r\nAdditional Info:\r\n- Did you try it in local?\r\nYes. Same result.\r\n\r\n- Did you try to use proxies?\r\nYes. Same result.\r\n\r\n- Does it happen if you go to that page normally with your browser?\r\nNo. The page loads normally.\r\n\r\n- Why compare to chromeless?\r\nThat is using chromium and passing the problem pretty easy, while puppeteer is not. Notice how recaptcha is screaming about upgrading browser on puppeteer."},{"labels":[null,"bug"],"text":"* Puppeteer version: v0.12.0-alpha\r\n* Platform / OS version: Windows 7 x64\r\n* URLs (if applicable): any that needs authorization\r\n\r\n1. Create a test script and an empty folder `test-profile-dir`:\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async function main() {\r\n  try {\r\n    const browser = await puppeteer.launch({\r\n      headless: false,\r\n      userDataDir: 'test-profile-dir',\r\n    });\r\n    const page = await browser.newPage();\r\n\r\n    await page.goto('https://twitter.com/');\r\n\r\n    console.log(await page.evaluate(() => document.title));\r\n    console.log(await page.evaluate(() => document.cookie));\r\n\r\n    // await browser.close();\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n})();\r\n```\r\nYou will see something like this:\r\n```console\r\nTwitter. It's what's happening.\r\n\r\npersonalization_id=...; guest_id=...; ct0=...\r\n```\r\nSign in into Twitter and close the browser.\r\n\r\n2. Run the same script second time (`await browser.close();` can be uncommented). You will see something like this:\r\n```console\r\nTwitter\r\n\r\npersonalization_id=...; guest_id=...; ct0=...; ads_prefs=...; remember_checked_on=...;\r\ntwid=...; tip_nightmode=...; _ga=...; _gid=...; dnt=...; lang=...\r\n```\r\n3. Run the same script, but with `headless: true,` The output is the same as before authorization:\r\n```console\r\nTwitter. It's what's happening.\r\n\r\npersonalization_id=...; guest_id=...; ct0=...\r\n```\r\n\r\nI have tried various sites, all of them seem to lose authorization in headless mode.\r\n\r\nSome more notes:\r\n\r\n* `response.request().headers` does not contain cookies in both `headless: false` and `headless: true` modes.\r\n\r\n* `console.log(await page.cookies('https://twitter.com/'));` contains many cookies in the `headless: false` mode. In the `headless: true` mode it gives an empty array `[]`."},{"labels":["bug"],"text":"* Puppeteer version: v0.12.0-alpha\r\n* Platform / OS version: Windows 7 x64\r\n\r\nCreate a test script and an empty folder `test-profile-dir`:\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async function main() {\r\n  try {\r\n    const browser = await puppeteer.launch({\r\n      headless: true,\r\n      userDataDir: 'test-profile-dir',\r\n    });\r\n    await browser.close();\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n})();\r\n```\r\nBrowser and script (node) hang (do not exit). After `Ctrl+C`, the script (node) exits, but some Chromium processes remain.\r\n\r\nIt seems [`taskkill /pid`](https://github.com/GoogleChrome/puppeteer/pull/876) does not close headless process without `/f` flag (`WM_CLOSE` message is not effective without the window?) — but with `/f` flag the process [does not exit gracefully](https://github.com/GoogleChrome/puppeteer/issues/839). Stalemate("},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.11\r\n* Platform / OS version: Windows 7, Windows 10\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. Install puppeteer from npm\r\n2. Go to the chromium installation directory: node_modules/puppeteer/.local-chromium/win32-499413/chrome-win32\r\n3. Launch chrome.exe\r\n4. Enter some url in the browser address area\r\n\r\n**What is the expected result?**\r\nThe web page of that url should open.\r\n\r\n**What happens instead?**\r\nThe content area of the chromium browser remains empty. Same website opens fine in IE:\r\n![rootcause_step_7](https://user-images.githubusercontent.com/72431/30969454-1ada48f6-a46b-11e7-9e2c-d18c7d2be258.jpg)\r\n"},{"labels":["bug"],"text":"When I try to access this url, I get an assertion error. If I remove or change the user agent, the problem seems to disappear. Maybe the website has a different behavior for this UA, but it shouldn't crash puppeteer.\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 9b0a06216e5b364aecaef6931d7844a91bebe46e\r\n* Platform / OS version: debian stretch\r\n* URLs (if applicable): https://tucsonfoodie.com/2016/07/18/truland-burgers-greens-a-choice-greens-graze-premium-burger-combined-concept-now-open/\r\n\r\n**What steps will reproduce the problem?**\r\n\r\njust run this code:\r\n\r\n```\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\nconst USERAGENT = \"Mozilla/5.0 (compatible;)\";\r\n\r\n(async() => {\r\n  process.on(\"uncaughtException\", (e) => {\r\n    console.error(\"Unhandled exeption:\", e);\r\n    cont = false;\r\n  });\r\n  process.on(\"unhandledRejection\", (reason, p) => {\r\n    console.error(\"Unhandled Rejection at: Promise\", p, \"reason:\", reason);\r\n    // application specific logging, throwing an error, or other logic here\r\n    cont = false;\r\n  });\r\n  const args = [\r\n    \"--disable-gpu\",\r\n    \"--disable-setuid-sandbox\",\r\n    \"--force-device-scale-factor\",\r\n    \"--ignore-certificate-errors\",\r\n    \"--no-sandbox\",\r\n  ];\r\n  const options = {\r\n    args,\r\n    headless: true,\r\n    ignoreHTTPSErrors: true,\r\n  };\r\n  const browser = await puppeteer.launch(options);\r\n  let cont = true;\r\n  let n = 0\r\n  while (cont) {\r\n    console.log(n);\r\n    n++\r\n    try {\r\n      const page = await browser.newPage();\r\n      page.setUserAgent(USERAGENT);\r\n      await page.setRequestInterceptionEnabled(true);\r\n      page.on(\"request\", (request) => {\r\n        if (request.resourceType === \"Image\") {\r\n          request.abort();\r\n        } else {\r\n          request.continue();\r\n        }\r\n      });\r\n      await page.goto('https://tucsonfoodie.com/2016/07/18/truland-burgers-greens-a-choice-greens-graze-premium-burger-combined-concept-now-open/');\r\n      await page.screenshot({ path: 'example.png' });\r\n      await page.close();\r\n    } catch (error) {\r\n      console.error(\"exception\", error);\r\n    }\r\n  }\r\n  await browser.close();\r\n})();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nThe program should run forever\r\n\r\n**What happens instead?**\r\n\r\n```\r\nUnhandled Rejection at: Promise Promise {\r\n  <rejected> { AssertionError [ERR_ASSERTION]: INTERNAL ERROR: failed to find request for interception redirect.\r\n    at Console.assert (console.js:171:23)\r\n    at NetworkManager._onRequestIntercepted (/home/team/prod/bin/test_server/node_modules/puppeteer/lib/NetworkManager.js:134:15)\r\n    at emitOne (events.js:115:13)\r\n    at Session.emit (events.js:210:7)\r\n    at Session._onMessage (/home/team/prod/bin/test_server/node_modules/puppeteer/lib/Connection.js:199:12)\r\n    at Connection._onMessage (/home/team/prod/bin/test_server/node_modules/puppeteer/lib/Connection.js:98:19)\r\n    at emitOne (events.js:115:13)\r\n    at WebSocket.emit (events.js:210:7)\r\n    at Receiver._receiver.onmessage (/home/team/prod/bin/test_server/node_modules/ws/lib/WebSocket.js:143:47)\r\n    at Receiver.dataMessage (/home/team/prod/bin/test_server/node_modules/ws/lib/Receiver.js:389:14)\r\n  generatedMessage: false,\r\n  name: 'AssertionError [ERR_ASSERTION]',\r\n  code: 'ERR_ASSERTION',\r\n  actual: false,\r\n  expected: true,\r\n  operator: '==' } } reason: AssertionError [ERR_ASSERTION]: INTERNAL ERROR: failed to find request for interception redirect.\r\n    at Console.assert (console.js:171:23)\r\n    at NetworkManager._onRequestIntercepted (/home/team/prod/bin/test_server/node_modules/puppeteer/lib/NetworkManager.js:134:15)\r\n    at emitOne (events.js:115:13)\r\n    at Session.emit (events.js:210:7)\r\n    at Session._onMessage (/home/team/prod/bin/test_server/node_modules/puppeteer/lib/Connection.js:199:12)\r\n    at Connection._onMessage (/home/team/prod/bin/test_server/node_modules/puppeteer/lib/Connection.js:98:19)\r\n    at emitOne (events.js:115:13)\r\n    at WebSocket.emit (events.js:210:7)\r\n    at Receiver._receiver.onmessage (/home/team/prod/bin/test_server/node_modules/ws/lib/WebSocket.js:143:47)\r\n    at Receiver.dataMessage (/home/team/prod/bin/test_server/node_modules/ws/lib/Receiver.js:389:14)\r\n```\r\n"},{"labels":[null,"bug"],"text":"1. Recentrly, [plznavigate](https://groups.google.com/a/chromium.org/forum/#!topic/chromium-dev/sOs05JfmPFw) was enabled on Chromium Trunk. \r\n2. plznavigate changed protocol behavior in a few subtle ways that we relied upon in pptr\r\n3. plznavigate causes a protocol bug that blocks our adoption\r\n    - [crbug.com/767683](https://bugs.chromium.org/p/chromium/issues/detail?id=767683)\r\n \r\n\r\nFor the reference: a wip of pptr migration over to plznvigate: [aslushnikov/puppeteer:plznavigate](https://github.com/aslushnikov/puppeteer/tree/plznavigate)\r\n\r\nThe plan is to roll with `--disable-browser-side-navigation` flag passed over to launcher and\r\nremove it as soon as the upstream is fixed."},{"labels":["bug"],"text":"* Puppeteer version: \"puppeteer\": \"^0.10.2\"\r\n* Platform / OS version: win 10, 64b\r\n\r\nexpected: request to home https://www.example.net/ and https://www.example.com/'\r\n\r\nactual:\r\nREQUEST TO : https://www.example.net/\r\nGET 200 https://www.example.net/\r\nREQUEST TO : https://www.example.net/favicon.ico\r\n(node:4640) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Protocol error (Network.continueInterceptedRequest): Invalid InterceptionId. undefined\r\n(node:4640) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\nREQUEST TO : https://www.example.com/favicon.ico\r\nGET 404 https://www.example.com/favicon.ico\r\n\r\nIn log, there is not request to REQUEST TO : https://www.example.com/ only on https://www.example.com/favicon.ico\r\n\r\nSee code:\r\n\r\n```\r\nconst puppeteer = require('puppeteer')\r\nconst path = require('path')\r\n\r\nconst URL = 'https://www.extrategy.net/en/values'\r\n\r\nconst run = async (browser) => {\r\n\tconst page = await browser.newPage()\r\n\tpage.setRequestInterceptionEnabled(true) \r\n\t\r\n\tpage.on('request', request => {\r\n\t\tconsole.log(\"REQUEST TO : \" + request.url);\r\n\t\trequest.continue(); // pass it through.\r\n\t});\r\n\r\n\tpage.on('response', response => {\r\n\t\tconst req = response.request(); \r\n\t\tconsole.log(req.method, response.status, req.url);\r\n\t});\r\n\t\t\r\n\tawait page.goto('https://www.example.net/') \r\n\tawait page.goto('https://www.example.com/') \r\n\r\n}\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch({headless: false})\r\n  await run(browser)\r\n  //return browser.close()\r\n})()\r\n```"},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.10.2 and 0.11.0-alpha\r\n* Platform / OS version: Mac OSX\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nI'm creating a Verizon integration to fetch my data. When using `page.setRequestInterceptionEnabled(true)`, after submitting my credentials, Verizon complains with this:\r\n\r\n![example](https://user-images.githubusercontent.com/1205866/30658586-0b6b7bbe-9df0-11e7-96fa-7063dc80cb90.png)\r\n\r\nIf I remove the `page.setRequestInterceptionEnabled(true)` code, everything works dandy. Here's a script to reproduce, obviously fill in your Verizon credentials, if you don't use Verizon, darn it.\r\n\r\n```js\r\nconst puppeteer = require('puppeteer')\r\n\r\nconst run = async () => {\r\n  const browser = await puppeteer.launch({\r\n    headless: false\r\n  })\r\n  const page = await browser.newPage()\r\n\r\n  // Comment this out to have the Verizon dashboard page load dandy\r\n  await page.setRequestInterceptionEnabled(true)\r\n  page.on('request', interceptedRequest => {\r\n    // I'd like to add some custom code here to keep track of requests,\r\n    // but for now, just continue every request\r\n    interceptedRequest.continue()\r\n  })\r\n  // End problem section\r\n\r\n  await page.goto('https://login.verizonwireless.com/amserver/UI/Login')\r\n  await page.focus('#IDToken1')\r\n  await page.type('YOUR_USERNAME', { delay: 20 })\r\n  await page.click('#login-submit')\r\n  await page.waitFor('#loginForm,.o-emergency-notice,#challengequestion')\r\n  await page.waitFor(1000)\r\n  const mfa = await page.$('#challengequestion')\r\n\r\n  if (mfa) {\r\n    await page.focus('#IDToken1')\r\n    await page.type('YOUR_MFA_ANSWER', { delay: 20 })\r\n    await page.click('#challengequestion button.o-red-button[type=\"submit\"]')\r\n    await page.waitFor('.o-emergency-notice,.o-icon-sign-out,#IDToken2')\r\n  }\r\n\r\n  await page.focus('#IDToken2')\r\n  await page.type('YOUR_PASSWORD', { delay: 20 })\r\n  await page.click('#loginForm button[class=\"o-red-button\"]')\r\n  await page.waitFor(\r\n    '.o-emergency-notice,.o-icon-sign-out,#challengequestion,#modifyprofile,#main-header,#IDToken6,.fios-welcome',\r\n    { timeout: 30000 }\r\n  )\r\n\r\n  await page.waitFor(2000)\r\n  await page.screenshot({ path: 'example.png' })\r\n  await browser.close()\r\n}\r\n\r\nrun()\r\n  .then(() => process.exit())\r\n  .catch(() => process.exit())\r\n```\r\n\r\nInclude this script in a folder where `puppeteer` is installed, and then run `node scriptname.js`.\r\n\r\n**What is the expected result?**\r\n\r\nI expect Verizon to let me into my data without complaining, even if I'm keeping track of my requests.\r\n\r\n**What happens instead?**\r\n\r\nVerizon states `You may be experiencing an issue with your browser`.\r\n"},{"labels":["bug"],"text":"### Steps to reproduce\r\n* Puppeteer version: v0.11.0-alpha\r\n* Platform / OS version: Windows 7 x64\r\n\r\nThis code works quickly and properly:\r\n```js\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\nconst timeout = 60000;\r\n\r\n(async function main() {\r\n  try {\r\n    const browser = await puppeteer.launch({ headless: false });\r\n    const page = await browser.newPage();\r\n    await page.goto('http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf', { timeout });\r\n    await page.goto('http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf', { timeout });\r\n    await page.goto('https://nodejs.org/static/documents/trademark-policy.pdf', { timeout });\r\n\r\n    await browser.close();\r\n  } catch (err) {\r\n    console.error(err);\r\n  }\r\n})();\r\n```\r\n\r\nHowever, with `{ headless: true }` it causes this error:\r\n```console\r\nError: Navigation Timeout Exceeded: 60000ms exceeded\r\n    at NavigatorWatcher.waitForNavigation (puppeteer\\lib\\NavigatorWatcher.js:73:20)\r\n    at <anonymous>\r\n```\r\n\r\nIf PDF documents are not supported in the headless mode, maybe this should be documented.\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For general technical questions or \"how to\" guidance, please search StackOverflow for questions tagged \"puppeteer\" or create a new post.\r\n\r\nhttps://stackoverflow.com/questions/tagged/puppeteer\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n\r\nFor issues, feature requests, or setup troubles with Puppeteer, file an issue right here!\r\n-->\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.10.2\r\n* Platform / OS version: Mac/ Sierra - 10.12.6\r\n* URLs (if applicable): \r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. Use page.setContent( ) to write an iFrame into the browser\r\ne.g.\r\n```\r\nawait page.setContent(\r\n      '<iframe id=\"map\" src=\"https://www.google.com/maps/embed/v1/place?q=TEST&zoom=12&key=\" height=\"1200px\" width=\"1200px\"></iframe>');\r\n```\r\n2. Call page.waitForSelector\r\n```\r\nawait page.waitForSelector('.place-name', {timeout: 500});\r\n```\r\n\r\n**What is the expected result?**\r\nExpect the waitForSelector to either return or throw a timeout\r\n\r\n**What happens instead?**\r\n\r\nwaitForSelector call indefinitely blocks -- this only occurs when using the \".\" for a class selector -- seems to be okay when using \"#\"\r\n\r\n\r\n\r\n"},{"labels":[null,"bug"],"text":"Repro: \r\n\r\n```js\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\n\r\npage.on('framenavigated', async frame => {\r\n  console.log(await frame.title());\r\n  browser.close();  \r\n});\r\n\r\nawait page.goto('https://example.com');\r\n```\r\n\r\nProduces:\r\n\r\n```\r\nError: Protocol error (Runtime.evaluate): Cannot find context with specified id undefined\r\n```"},{"labels":["bug"],"text":"<!--\r\nSTEP 1: Are you in the right place?\r\n\r\n- For issues or feature requests related to the DevTools Protocol (https://chromedevtools.github.io/devtools-protocol/), file an issue there:\r\n\r\nhttps://github.com/ChromeDevTools/devtools-protocol/issues/new.\r\n\r\n- Problem in Headless Chrome? File an issue against Chromium's issue tracker:\r\n\r\nhttps://bugs.chromium.org/p/chromium/issues/entry?components=Internals%3EHeadless&blocking=705916\r\n-->\r\n\r\nI'm attempting to use chrome as a video renderer. It takes a screenshot of the page at a specific resolution (e.g. 1280x544) and then requests the next frame.\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.10.2\r\n* Platform / OS version: Debian Jessie via docker image node:8.4\r\n* Hosted on container engine\r\n* Cluster is running n1-highcpu-16 nodes\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nRapidly take screenshots.\r\n\r\n```\r\nconst run = async () => {\r\n    let running = true\r\n    setTimeout(() => running = false, 10000)\r\n    let frameNum = 0\r\n    while(running){\r\n        await page.screenshot({\r\n            path: frameNum + '.png',\r\n            fullPage: true\r\n        })\r\n        frameNum ++\r\n    }\r\n}\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nScreenshots should be the exact size specified by clip, or the exact size of the window if using `fullPage`.\r\n\r\n**What happens instead?**\r\n\r\nImages are the wrong size. The width becomes 800px, or the height becomes 600px (sometimes both), which I'm guessing is somehow related to the default window size of 800x600.\r\n\r\n--------------\r\n\r\nI've also filed a ticket at the devtools-protocol. https://github.com/ChromeDevTools/devtools-protocol/issues/57\r\n\r\nI'm working on a more thorough code example. It will include a dockerfile.\r\n"},{"labels":["bug",null,null],"text":"\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.10.2\r\n* Platform / OS version: Mac OS 10.11.3\r\n* URLs (if applicable): \r\n\r\n**What steps will reproduce the problem?**\r\n\r\n1. Make a web server response the JSON data contains some unicode string\r\n2. The Server will send the JSON data to client with wrong Content-Type which is ``text/plain`` in the example\r\n3. The  ``puppeteer`` request the server and received the data, but the data in  puppeteer's Response.buffer() is broken(not equal to the original data)\r\n\r\nHere's the example scrpit to reproduce the issue:\r\n\r\n```javascript\r\nconst http = require('http');\r\nconst puppeteer = require('puppeteer');\r\n\r\nconst ORIGINAL_DATA = Buffer.from(JSON.stringify({'msg': '测试'}));\r\n\r\n\r\nfunction serve() {\r\n    http.createServer(function (req, res) {\r\n        // The correct header should be 'application/json; charset=utf-8'\r\n        // but I change it to 'text/plain' to  REPRODUCE THE BUG\r\n        res.setHeader('Content-Type', 'text/plain');\r\n        res.writeHead(200);\r\n        res.end(ORIGINAL_DATA);\r\n    }).listen(8001);\r\n\r\n}\r\n\r\nasync function responseSuccess(res) {\r\n    let dataReceived = await res.buffer();\r\n    console.log('Received:\\n', dataReceived);\r\n    console.log('Original:\\n', ORIGINAL_DATA);\r\n    console.log('\\n')\r\n}\r\n\r\nasync function doRequest() {\r\n    const browser = await puppeteer.launch({headless: false});\r\n    const page = await browser.newPage();\r\n    page.on('response', responseSuccess);\r\n    let res = await page.goto('http://localhost:8001');\r\n}\r\n\r\n\r\nserve();\r\ndoRequest();\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nHere's the output from console.log in the example script \r\n\r\n```\r\nReceived:\r\n <Buffer 7b 22 6d 73 67 22 3a 22 e6 b5 8b e8 af 95 22 7d>\r\nOriginal:\r\n <Buffer 7b 22 6d 73 67 22 3a 22 e6 b5 8b e8 af 95 22 7d>\r\n```\r\n\r\n**What happens instead?**\r\n\r\n```\r\nReceived:\r\n <Buffer 7b 22 6d 73 67 22 3a 22 c3 a6 c2 b5 e2 80 b9 c3 a8 c2 af e2 80 a2 22 7d>\r\nOriginal:\r\n <Buffer 7b 22 6d 73 67 22 3a 22 e6 b5 8b e8 af 95 22 7d>\r\n```\r\n"},{"labels":[null,"bug"],"text":"The following script doesn't select text:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n(async () => {\r\n  // Launch headful so that we see what's going on\r\n  const browser = await puppeteer.launch({headless: false});\r\n  const page = await browser.newPage();\r\n  // Add textarea\r\n  await page.setContent('<textarea>hello</textarea>');\r\n  await page.focus('textarea');\r\n  // Try to select all text in textarea\r\n  await page.keyboard.down('Meta');\r\n  await page.keyboard.press('a');\r\n  await page.keyboard.up('Meta');\r\n  // By now, text should be selected in the text area.\r\n  // It doesn't on Mac.\r\n})();\r\n```\r\n\r\nFirst reported in #761.\r\n"},{"labels":["bug"],"text":"Hi!\r\n\r\nI'm trying to load a URL: https://kyfw.12306.cn/otn/login/init , but the loading is always interrupted due to a hanging OPTIONS request. This only happens when request interception is enabled.\r\n\r\nI'm using \"puppeteer\": \"^0.10.2\"\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\nconst browser = await puppeteer.launch({\r\n    slowMo: 250, // slow down by 250ms\r\n    headless: false,\r\n    ignoreHTTPSErrors: true,\r\n    dumpio: true,\r\n});\r\nconst page = await browser.newPage();\r\nawait page.setRequestInterceptionEnabled(true);\r\npage.on('request', request => {\r\n    request.continue(request);\r\n});\r\n\r\n\r\nawait page.goto('https://kyfw.12306.cn/otn/login/init');\r\nbrowser.close();\r\n})();\r\n```\r\nAnd this is the console output for the hanging request. No more requests are performed/intercepted afterwards:\r\n\r\n```\r\n[97788:45059:0912/180943.664278:ERROR:service_manager.cc(156)] Connection InterfaceProviderSpec prevented service: content_utility from binding interface: content::mojom::FieldTrialRecorder exposed by: content_browser\r\n(node:97787) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Navigation Timeout Exceeded: 30000ms exceeded\r\n(node:97787) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n```\r\n\r\nThanks!"},{"labels":[null,"bug",null],"text":"### What I am doing\r\n\r\nA number of serial screenshots were taken in order to make a gif animation. Please see the gif in the expected section.\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.10.2\r\n* Platform / OS version: MacOS 10.11.6\r\n* URLs (if applicable): https://github.com/chfw/echarts-scrappeteer\r\n\r\n**What steps will reproduce the problem?**\r\n\r\n```\r\ngit clone https://github.com/chfw/echarts-scrappeteer.git\r\ncd echarts-scrappeteer\r\ngit checkout wrong-behavior\r\nnpm install\r\nnode src/main.js http://gallery.echartsjs.com/editor.html?c=xrkJtnKJq- -w 2000 -f gif -r 1050,100,1540,1500 -o gf3 -i 300 -c 10 -v 1300,800,2\r\n```\r\n\r\nMost significant parameters in my case is:\r\n```\r\n-v, --viewPort <width,height,scaleFactor>  force puppeteer to set viewport. for echarts gallery site only\r\n-r, --clipRectangle <x,y,width,height>     record rectangle when making gif animation\r\n```\r\n\r\n**What is the expected result?**\r\n\r\nA sharp version of the following gif:\r\n\r\n![myanimated](https://user-images.githubusercontent.com/4280312/30299776-32797ede-9749-11e7-9c53-421fff8e9c81.gif)\r\n\r\nhere is the command to produce above gif 👍 but the image is blurred:\r\n`node src/main.js http://gallery.echartsjs.com/editor.html?c=xrkJtnKJq- -w 2000 -f gif -r 525,50,770,750 -o gf3 -i 300 -c 10 -v 1300,800,1`\r\n\r\n**What happens instead?**\r\n\r\n`node src/main.js http://gallery.echartsjs.com/editor.html?c=xrkJtnKJq- -w 2000 -f gif -r 1050,100,1540,1500 -o gf3 -i 300 -c 10 -v 1300,800,2` produces\r\n\r\n![myanimated](https://user-images.githubusercontent.com/4280312/30299649-82dcf582-9748-11e7-9f50-6e5c614d5ba6.gif)\r\n\r\nI also tried `node src/main.js http://gallery.echartsjs.com/editor.html?c=xrkJtnKJq- -w 2000 -f gif -r 525,50,770,750 -o gf3 -i 300 -c 10 -v 1300,800,2` and got the following:\r\n\r\n![myanimated](https://user-images.githubusercontent.com/4280312/30300132-edcb47fc-974a-11e7-9976-30825bc7aead.gif)\r\n\r\n\r\n**Here is the screenshot process**\r\n\r\n![out](https://user-images.githubusercontent.com/4280312/30299864-a745ff12-9749-11e7-9bc1-bdb6c6db2dd5.gif)"},{"labels":["bug"],"text":"### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.10.2\r\n* Platform / OS version: mac 10.12.6\r\n\r\n**What steps will reproduce the problem?**\r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\npuppeteer.launch({ headless: false }).then(async function(browser) {\r\n\r\n\tconst newPage = await browser.newPage();\r\n\r\n\t// newPage.goto('http://google.com', { timeout: 1 })\r\n\t// \t.catch(function(err) {});\r\n\r\n\t// newPage.goto('http://google.com', { timeout: 1 })\r\n\t// \t.then(function() {}, function(err) {});\r\n\r\n\ttry {\r\n\t\tawait newPage.goto('http://google.com', { timeout: 1 });\r\n\t} catch (e) {}\r\n});\r\n```\r\n\r\n**What is the expected result?**\r\nTo be able to silence the error.\r\n\r\n**What happens instead?**\r\nThe error isn't caught.\r\n```\r\n(node:33288) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Navigation Timeout Exceeded: 1ms exceeded\r\n(node:33288) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n(node:33288) PromiseRejectionHandledWarning: Promise rejection was handled asynchronously (rejection id: 1)\r\n```\r\n\r\nListening to `unhandledRejection` on the process returns this:\r\n```\r\nPromise {\r\n  <rejected> Error: Navigation Timeout Exceeded: 1ms exceeded\r\n    at NavigatorWatcher.waitForNavigation (./node_modules/puppeteer/lib/NavigatorWatcher.js:74:13)\r\n    at <anonymous> }\r\n```\r\n"},{"labels":["bug",null],"text":"Some background - I'm building a service which converts SVGs into PNGs.\r\nUp until now I've been spawning [Electron](https://github.com/electron/electron) workers (with Xvfb). The actual rendering worked great, but communicating with the Electron workers was a hassle and the fact that it isn't truly headless is resource consuming.\r\n\r\nNeedless to say that puppeteer + headless Chromium seems very ideal for my use case. \r\nThe coding needed for implementing the same logic with puppeteer was very small and very clear.\r\nThe problem is that large screenshots (~5000x5000 pixels) which previously took 5 seconds, now take 30 seconds, and in more complex SVGs, can even get above 1 minute. Additionally - the actual screenshot image looks great.\r\n\r\n**NOTE**: in Mac OSX, using `headless: false` flag, I get reasonable times. Unfortunately that's not the case in both Mac (with `headless: true`), Linux (with both `headless: true` with `Xvfb` and `headless: false`).\r\n\r\n\r\n### Steps to reproduce\r\n\r\n**Tell us about your environment:**\r\n\r\n* Puppeteer version: 0.10.2\r\n* Platform / OS version: Ubuntu Linux \r\n* URLs (if applicable): https://github.com/mikeys/puppeteer-slow-svg-example\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nA very simple example code can be found at the following repository which was created to showcase this issue:\r\nhttps://github.com/mikeys/puppeteer-slow-svg-example\r\n\r\n1. Create a simple (single shaped) SVG document with an image pattern ([example](https://raw.githubusercontent.com/mikeys/puppeteer-slow-svg-example/master/pattern.svg))\r\n2. Embed the SVG as part of an HTML document. Make sure to use large width/height (5000/5000) values for the embedded element ([example](https://raw.githubusercontent.com/mikeys/puppeteer-slow-svg-example/master/pattern.html))\r\n3. Use the following code to take the desired screenshot (excerpt from [here](https://raw.githubusercontent.com/mikeys/puppeteer-slow-svg-example/master/index.js)):\r\n```node\r\nconst browser = await puppeteer.launch({ headless: true });\r\nconst page = await browser.newPage();\r\nconst url = `file://${__dirname}/pattern.html`\r\nawait page.goto(url);\r\nawait page.screenshot({path: 'example.png', clip: { width: 5000, height: 5000, x: 0, y: 0 }});\r\n```\r\n\r\n**What is the expected result?**\r\nScreenshot finishes in reasonable time (~5 seconds).\r\n\r\n\r\n**What happens instead?**\r\nScreenshot takes a very long time (> 30 seconds).\r\n\r\n"},{"labels":["bug"],"text":"`request.resourceType` doesn't always match the resourceType shown in devtools:\r\n\r\n<img width=\"1029\" alt=\"screen shot 2017-09-09 at 11 12 41 am\" src=\"https://user-images.githubusercontent.com/238208/30242685-d8a7df18-954f-11e7-919f-48e023b4bfd0.png\">\r\n\r\n<img width=\"525\" alt=\"screen shot 2017-09-09 at 11 12 44 am\" src=\"https://user-images.githubusercontent.com/238208/30242684-d8a790f8-954f-11e7-8075-201aef30c131.png\">\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n(async() => {\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\n\r\nconst responses = [];\r\npage.on('response', resp => {\r\n  responses.push(resp);\r\n});\r\n\r\npage.on('load', resp => {\r\n  responses.map(async (r, i) => {\r\n    const request = await r.request();\r\n    console.log(request.url, request.resourceType);\r\n  });\r\n});\r\n\r\nawait page.goto('https://news.ycombinator.com/', {waitUntil: 'networkidle'});\r\nbrowser.close();\r\n})();\r\n```\r\n"},{"labels":[null,"bug"],"text":"\r\n\r\n### Steps to reproduce\r\n* Puppeteer version: 0.10.2\r\n* Platform / OS version: Mac OS Sierra, Node v8.4.0\r\n\r\n**What steps will reproduce the problem?**\r\n\r\nWhen calling `page.screenshot()` with a clip rectangle, odd-sized pixel widths and heights are rounded to even sizes. For example, a .png image created using the rectangle `{x: 0, y: 0, width: 305, height: 121}` is 306x122 pixels."},{"labels":["bug",null,null],"text":"Using `fullPage: true` option with [Page.screenshot](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#pagescreenshotoptions) seems to be messing `vw` and `vh` CSS units, even though page size is set with [Page.setViewport](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#pagesetviewportviewport)."},{"labels":["bug"],"text":"### Env\r\nPuppeteer: 0.10.2\r\nNode: v7.10.1\r\nOS: macOS\r\n\r\n### Problem\r\nI want to avoid this error: `Protocol error (Network.continueInterceptedRequest): Target closed.`\r\n\r\n```js\r\n// only the relevant code\r\nfunction handleInterceptedRequests (interceptedRequest) {\r\n  // if this function is called _after_ page.close (and this happens),\r\n  // continue below will throw, and in a way that cannot be caught here with a try/catch\r\n  interceptedRequest.continue()\r\n}\r\n\r\nawait page.setRequestInterceptionEnabled(true)\r\npage.on('request', handleInterceptedRequests)\r\n\r\n// page.close might be called BEFORE goto resolves.\r\n// I am aware there is a timeout you can pass to the goto method;\r\n// it does not solve my use case\r\nsetTimeout(page.close, someTimeoutValue)\r\n\r\nawait page.goto(someUrl)\r\n```\r\n\r\n### Suggestions\r\nsome ideas:\r\n* Either make sure no events are sent to `request` listeners  after page.close (easiest for the consumer)\r\nor\r\n* make it possible to manually remove the listener\r\n`page.removeListener('request', handleInterceptedRequests)` did not work - should it?\r\nor\r\n* make it possible to catch errors thrown by interceptedRequest abort/continue after page.close\r\n```js\r\ntry {\r\n  interceptedRequest.continue()\r\n} catch (e) {\r\n // does not happen currently.\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"It looks like exposeFunction is only running in the mainframe until a reload happens."},{"labels":["bug",null],"text":"Using Puppeteer 0.10.2\r\n\r\nThe request interception API doesn't allow me to override (or indeed view) all the HTTP headers sent with a request. It does not appear to be possible to set the `Referer` header at all, and it is only possible to set the `Cookie` header if the browser is not already sending an actual value.\r\n\r\nSee this example script:\r\n```javascript\r\nconst puppeteer = require('puppeteer');\r\n\r\nasync function main() {\r\n    const browser = await puppeteer.launch({args: ['--no-sandbox']});\r\n\r\n    let page = await browser.newPage();\r\n\r\n    await page.setRequestInterceptionEnabled(true);\r\n    page.on('request', req => {\r\n        let headers = req.headers;\r\n        headers['referer'] = 'http://www.example.com/';\r\n        headers['cookie'] = 'somekey=somevalue';\r\n        req.continue({\r\n            headers: headers\r\n        });\r\n    });\r\n\r\n    await page.goto('http://localhost/checkheaders');\r\n    browser.close();\r\n}\r\n\r\nmain();\r\n```\r\n\r\nThe `Referer` header is not sent by the browser. The `Cookie` header is correctly sent only if there is not already a cookie being sent normally by the browser (i.e. navigating to another page on the same domain which sets a cookie will cause that cookie to take precedence over any cookie header set in the request interception). This bug also seems to have the same affect when trying to use page.setExtraHTTPHeaders(), although the name suggests this is intentional.\r\n\r\nThis is unfortunately a step-back from PhantomJS, where `page.customHeaders` could be used to override headers at will."},{"labels":[null,"bug"],"text":"I am clicking an element inside an iframe which should give me a different frame/view, that is move into the view represented by that element. If i click the element manually,the url does not change. So, I guess only the frame is changed. The element is being clicked properly since there are no errors for that. However nothing happens when it is clicked and returns error when I do `page.waitForNavigation()`.\r\nHere is the debug log listening for mouse and keyboard clicks.\r\n![puppteer](https://user-images.githubusercontent.com/20766601/30063784-5cc0e0d2-926d-11e7-8a8f-b2e478602127.png)\r\nAlso made sure proper element is clicked referring to #618. Here is portion of code that handles clicking the element inside iframe : \r\n```javascript\r\nvar frames = await page.frames();\r\nvar myframe = frames.find(f => f.name() === 'mygurukuliframe_submenu'); \r\nconst attselector = '#imgid_12';\r\nconst attel = await myframe.$(attselector);\r\nconst outerHTML = await attel.evaluate(e => e.parentNode.outerHTML);\r\nconsole.log('the outerhtml: ', outerHTML);\r\nawait attel.click({button:'middle'});\r\nawait page.waitForNavigation();\r\nawait page.screenshot({path : 'example.png'});\r\nbrowser.close();\r\n```\r\n\r\nPlease mention if any further info is needed and help if it can be resolved."},{"labels":["bug",null],"text":"It looks like the tap method is flaky, or at least the test for it is.\r\n\r\nhttps://travis-ci.org/GoogleChrome/puppeteer/jobs/271528560"},{"labels":["bug",null,null],"text":"Hi,\r\n\r\nWhen creating PDFs from a responsive web page, lets say the page has a css rule to show a narrower version below `1024` pixels screen width and we supply `width: \"1024px\"` to `pdf` function. The rule should not apply on this case however it does and the layout changes in generated pdf. \r\n\r\nOnly when the width parameter is **4/3** of the actual width of viewport, then the pdf has exact same layout of given viewport width. This seems to be something related to an inches / points confusion somewhere (96 pixels per inch, 72 pixels per point. 96/72 = 4/3)\r\n\r\nSo, when I provide `1365px` as pdf width I get the exact representation of the page at `1024px` viewport width. Anything below `1365px`, page acts like the viewport is below `1024px` and applies the appropriate responsive css rules.\r\n\r\nI'm not sure if this is an upstream bug or something else though. Margins are set to 0 btw. \r\n\r\nAny ideas?"},{"labels":["bug"],"text":"https://github.com/GoogleChrome/puppeteer/pull/565 fixed most cases I found with pages never reporting the load event in puppeteer, but I have here found another url that breaks in the same way - only after calling `setRequestInterceptionEnabled(true)`.\r\n\r\n## Environment\r\n\r\nPuppeteer: 0.11.0\r\nNode: 7.10.1.\r\nOS: macOS Sierra\r\n\r\n## Reduced test case (updated)\r\n### Js disabled + request interception => never loads\r\nThis is the real problem that relates to this issue. Originally when I posted I missed the critical detail that JS needs to be disabled for the load to never happen:\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n(async() => {\r\nconst browser = await puppeteer.launch({\r\n      ignoreHTTPSErrors: true,\r\n      args: ['--disable-setuid-sandbox', '--no-sandbox']\r\n    })\r\nconst page = await browser.newPage()\r\n\r\nawait page.setJavaScriptEnabled(false)\r\nawait page.setRequestInterceptionEnabled(true)\r\npage.on('request', intercepted => intercepted.continue())\r\n\r\nawait page.goto('https://apartmentsdoralfl.com/')\r\nconsole.log('page load DONE') // never happens\r\nbrowser.close();\r\n})();\r\n```\r\n\r\n**NOTE that the url I'm using in this test case it not the one I had when I originally raised the issue - the original url now works (and along with it about 80% of the problematic url's I had) - but the one listed here does not.\r\n\r\n---\r\nThanks for all the hard work on puppeteer, it's shaping up for me to be able to launch a [new major version of Penthouse](https://github.com/pocketjoso/penthouse/pull/174) with it replacing phantomjs. 👍 "},{"labels":["bug"],"text":"I create an browser instance and a page object.\r\nI use goto to perform the first navigation. It is working fine and returns a Response Object\r\n\r\nI use goto to perform a second navigation returns a null object. \r\n\r\n`const nav_response = await page.goto(url, this.navigationOptions);`\r\n`const status = nav_response.status;`\r\n\r\nCannot read property 'status' of null.\r\n\r\nWhat is weird is that chrome browser navigation is perfectly fine."},{"labels":["bug"],"text":"When I tried to implement the \"naive\" image blocking like the one shown in the [API reference page](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#pagesetrequestinterceptionenabledvalue) by enabling request interception, at one particular webpage I always encounter this error:\r\n\r\n`\r\n(node:73712) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Protocol error (Network.continueInterceptedRequest): Invalid InterceptionId. undefined\r\n`\r\n\r\nAfter some digging I figured out that the error always happen when the Puppeteer intercepting request to one particular URL. And when I open that webpage on non-headless Chrome to debug the all requests being made, it turns out the request which cause the error has \"canceled\" status.\r\n\r\n![screen shot 2017-08-31 at 7](https://user-images.githubusercontent.com/463775/29901383-e481c05e-8e21-11e7-8a7f-e40ccc83858c.png)\r\n\r\nWhat I suspect is when I called `interceptedRequest.continue()`, the underlying Chromium process already \"lost\" the interception, which cause it to return [this error](https://chromium.googlesource.com/chromium/src.git/+/refs/heads/lkcr/content/browser/devtools/devtools_url_request_interceptor.cc#121).\r\n\r\nI tried to ignore that URL and don't call `abort` or `continue`, but it caused the whole page to \"hang\"."},{"labels":["bug"],"text":"`page.click(selector)` does not click an element in a frame of the page.\r\n\r\n```\r\nUnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): AssertionError [ERR_ASSERTION]: No node found for selector: SELECTOR\r\n```\r\n\r\nHow is it possible to click the element? Getting the frame that contains the element and doing `frame.click(selector)` does not work.\r\n\r\n```\r\nUnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): TypeError: frame.click is not a function\r\n```"},{"labels":["bug"],"text":"I've come across an unexpected error when launching Puppeteer with `headless: false` and `slowMo: 250`.\r\n\r\nI'm running on Windows 10 with Node 8.4.0 installed.\r\n\r\nThis is the error:\r\n\r\n`(node:10800) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Erk.continueInterceptedRequest): Target closed.\r\n(node:10800) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the that are not handled will terminate the Node.js process with a non-zero exit code.\r\n(node:10800) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 2): AN]: false == true`\r\n\r\nAnd here is the part of the code causing this trouble:\r\n\r\n```\r\n'use strict';\r\n\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\n\r\n  const browser = await puppeteer.launch(\r\n    {\r\n      headless: false,\r\n      slowMo: 250\r\n    }\r\n  );\r\nconst page = await browser.newPage();\r\nawait page.setRequestInterceptionEnabled(true);\r\n  page.on('request', request => {\r\n    if (request.url) {\r\n        var networkRequests = request.url;\r\n        var raRequest = JSON.stringify(networkRequests);\r\n        console.log(raRequest);\r\n        console.log(typeof raRequest);\r\n    } else {\r\n        request.abort();\r\n    }\r\n    request.continue();\r\n  });\r\nawait page.goto('https://example.com');\r\n\r\n\r\nbrowser.close();\r\n\r\n})();\r\n```\r\n\r\nHope it helps.\r\n\r\nP.S: If something is wrong with that code, please do let me know!"},{"labels":["bug"],"text":"I am using puppeteer inside Docker as 'html to pdf' converter API.\r\nEven calling [`browser.close()`](https://github.com/tecnospeed/pastor/blob/b4e18af4149b1c6c7156d151fb96d8c8b8181133/lib/browser.js#L24)  (which browser is the instance from [`puppeteer.launch()`](https://github.com/tecnospeed/pastor/blob/b4e18af4149b1c6c7156d151fb96d8c8b8181133/lib/browser.js#L36)) I have `chrome` processes as zombie inside my instance:\r\n```\r\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\r\n    1 pastor    20   0  922068  26900  11404 S   0.0  0.7   0:00.66 node\r\n   10 pastor    20   0   11740   1896   1512 S   0.0  0.1   0:00.04 bash\r\n   33 pastor    20   0   51892   2008   1428 R   0.0  0.1   0:00.05 top\r\n   40 pastor    20   0       0      0      0 Z   0.0  0.0   0:00.01 chrome\r\n   62 pastor    20   0       0      0      0 Z   0.0  0.0   0:00.02 chrome\r\n   69 pastor    20   0       0      0      0 Z   0.0  0.0   0:00.74 chrome\r\n```\r\nI tried to call `page.close()` too but nothing changed."},{"labels":["bug"],"text":"When navigating to a PDF in headless mode the Response is Null. What Im trying to do is download the loaded pdf page and save it locally. Bellow is my code.. Thanks.\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\nconst browser = await puppeteer.launch({headless:true});\r\nconst page = await browser.newPage();\r\nconst response = await page.goto('http://www.africau.edu/images/default/sample.pdf', {waitUntil: 'networkidle'});\r\nconsole.log(response);\r\nbrowser.close();\r\n})();\r\n```"},{"labels":["bug",null],"text":"The following script fails with baidu.com:\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage();\r\n  await page.goto('https://baidu.com');\r\n  await page.waitForSelector('div');\r\n  browser.close();\r\n})();\r\n```\r\n\r\nThe reason is that Baidu nullifies MutationObserver that is required for `waitForSelector`.\r\n"},{"labels":["bug"],"text":"```\r\n(node:9027) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Evaluation failed: TypeError: MutationObserver is not a constructor\r\n    at pollMutation (<anonymous>:22:22)\r\n    at waitForPredicatePageFunction (<anonymous>:8:11)\r\n    at <anonymous>:70:3\r\n(node:9027) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n\r\n```"},{"labels":["bug"],"text":"This is the full error message:\r\n`MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 exit listeners added. Use emitter.setMaxListeners() to increase limit`\r\n\r\nI run Node v8.1.2 with tip-of-tree Puppeteer\r\n\r\nThe code is written with `Promise.all`, but even if I run `work()` sequentially the same error appears.\r\n\r\n```\r\nconst puppeteer = require('puppeteer')\r\nconst R = require('rambda')\r\n\r\nconst resolution = {\r\n  x : 1920,\r\n  y : 1080,\r\n}\r\n\r\nconst args = [\r\n  '--disable-gpu',\r\n  `--window-size=${ resolution.x },${ resolution.y }`,\r\n  '--no-sandbox',\r\n]\r\n\r\nconst work = async () => {\r\n  const browser = await puppeteer.launch({\r\n    headless     : true,\r\n    handleSIGINT : false,\r\n    args         : args,\r\n  })\r\n  const page = await browser.newPage()\r\n\r\n  const url = 'https://ilearnsmarter.com/learning-meme'\r\n\r\n  await page.setViewport({\r\n    width  : resolution.x,\r\n    height : resolution.y,\r\n  })\r\n\r\n  await page.goto(url, { waitUntil : 'networkidle' })\r\n  await browser.close()\r\n}\r\n\r\nconst fn = async () => {\r\n  const promised = R.range(0, 12).map(() => work())\r\n  await Promise.all(promised)\r\n\r\n  console.log('DONE')\r\n}\r\n\r\nfn()\r\n```"},{"labels":["bug"],"text":"Node 8.4.0, puppeteer 0.10.0, Chromium from Puppeteer, MacOS 10.12.\r\n\r\nConsider the script below:\r\n````\r\nconst puppeteer = require('puppeteer');\r\n\r\nargs = [];\r\nargs.push('--no-sandbox');\r\nargs.push('--disable-setuid-sandbox');\r\n\r\nconst takeSnapshot = async (page) => {\r\n  await page.screenshot({ path: '/tmp/test.png' });\r\n};\r\n\r\n(async () => {\r\n  browser = await puppeteer.launch({\r\n    headless: (typeof headlessMode != 'undefined' ? headlessMode : true),\r\n    args,\r\n  });\r\n\r\n  page = await browser.newPage();\r\n\r\n  await page.setRequestInterceptionEnabled(true);\r\n  page.on('request', (request) => {\r\n    request.continue();\r\n    return;\r\n  });\r\n\r\n\r\n  page.setUserAgent('Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201');\r\n\r\n\r\n  await page.goto('about:blank', { waitUntil: 'load' });\r\n  console.log('1')\r\n\r\n  await page.goto('http://www.barneys.com', { waitUntil: 'load' });\r\n  console.log('2')\r\n\r\n  await takeSnapshot(page);\r\n})();\r\n````\r\nRunning this crashes Chromium with below stack trace on MacOS. Commenting out the User-Agent lines gets everything working again. Which is weird.\r\n\r\n\r\n````\r\nProcess:               Chromium [18722]\r\nPath:                  /Users/USER/*/Chromium.app/Contents/MacOS/Chromium\r\nIdentifier:            org.chromium.Chromium\r\nVersion:               62.0.3193.0 (3193.0)\r\nCode Type:             X86-64 (Native)\r\nParent Process:        node [18721]\r\nResponsible:           Terminal [584]\r\nUser ID:               501\r\n\r\nDate/Time:             2017-08-28 16:44:31.542 -0700\r\nOS Version:            Mac OS X 10.12.6 (16G29)\r\nReport Version:        12\r\nAnonymous UUID:        9F0C72D7-5359-523C-BDD1-F79307DDC95C\r\n\r\nSleep/Wake UUID:       016FBAEB-0874-4755-8A2C-524F9EE09E64\r\n\r\nTime Awake Since Boot: 500000 seconds\r\nTime Since Wake:       20000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        19  Chrome_IOThread\r\n\r\nException Type:        EXC_BAD_ACCESS (SIGSEGV)\r\nException Codes:       KERN_INVALID_ADDRESS at 0x0000000000000008\r\n\r\nVM Regions Near 0x8:\r\n--> \r\n    __TEXT                 000000010f896000-000000010f897000 [    4K] r-x/rwx SM=COW  /Users/USER/*/Chromium.app/Contents/MacOS/Chromium\r\n\r\nThread 0:: CrBrowserMain  Dispatch queue: com.apple.main-thread\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   com.apple.CoreFoundation      \t0x00007fff8a5ba434 __CFRunLoopServiceMachPort + 212\r\n3   com.apple.CoreFoundation      \t0x00007fff8a5b98c1 __CFRunLoopRun + 1361\r\n4   com.apple.CoreFoundation      \t0x00007fff8a5b9114 CFRunLoopRunSpecific + 420\r\n5   com.apple.HIToolbox           \t0x00007fff89b19ebc RunCurrentEventLoopInMode + 240\r\n6   com.apple.HIToolbox           \t0x00007fff89b19cf1 ReceiveNextEventCommon + 432\r\n7   com.apple.HIToolbox           \t0x00007fff89b19b26 _BlockUntilNextEventMatchingListInModeWithFilter + 71\r\n8   com.apple.AppKit              \t0x00007fff880b2a54 _DPSNextEvent + 1120\r\n9   com.apple.AppKit              \t0x00007fff8882e7ee -[NSApplication(NSEvent) _nextEventMatchingEventMask:untilDate:inMode:dequeue:] + 2796\r\n10  com.apple.AppKit              \t0x00007fff883090b6 -[NSApplication _doModalLoop:peek:] + 497\r\n11  com.apple.AppKit              \t0x00007fff884e9374 __35-[NSApplication runModalForWindow:]_block_invoke + 64\r\n12  com.apple.AppKit              \t0x00007fff88306b98 -[NSApplication runModalForWindow:] + 137\r\n13  com.apple.AppKit              \t0x00007fff884d923d __19-[NSAlert runModal]_block_invoke + 158\r\n14  com.apple.AppKit              \t0x00007fff8837f11c -[NSAlert runModal] + 125\r\n15  com.apple.AppKit              \t0x00007fff883acaac __55-[NSPersistentUIRestorer promptToIgnorePersistentState]_block_invoke + 1022\r\n16  com.apple.AppKit              \t0x00007fff883ac671 -[NSApplication _suppressFinishLaunchingFromEventHandlersWhilePerformingBlock:] + 28\r\n17  com.apple.AppKit              \t0x00007fff883ac612 -[NSPersistentUIRestorer promptToIgnorePersistentState] + 237\r\n18  com.apple.AppKit              \t0x00007fff880b79d7 -[NSApplication _reopenWindowsAsNecessaryIncludingRestorableState:completionHandler:] + 181\r\n19  com.apple.AppKit              \t0x00007fff880b780c -[NSApplication(NSAppleEventHandling) _handleAEOpenEvent:] + 539\r\n20  com.apple.AppKit              \t0x00007fff880b746b -[NSApplication(NSAppleEventHandling) _handleCoreEvent:withReplyEvent:] + 661\r\n21  com.apple.Foundation          \t0x00007fff8bffbafd -[NSAppleEventManager dispatchRawAppleEvent:withRawReply:handlerRefCon:] + 290\r\n22  com.apple.Foundation          \t0x00007fff8bffb977 _NSAppleEventManagerGenericHandler + 102\r\n23  com.apple.AE                  \t0x00007fff8b3fff26 aeDispatchAppleEvent(AEDesc const*, AEDesc*, unsigned int, unsigned char*) + 544\r\n24  com.apple.AE                  \t0x00007fff8b3ffc9d dispatchEventAndSendReply(AEDesc const*, AEDesc*) + 39\r\n25  com.apple.AE                  \t0x00007fff8b3ffba9 aeProcessAppleEvent + 312\r\n26  com.apple.HIToolbox           \t0x00007fff89b2addf AEProcessAppleEvent + 55\r\n27  com.apple.AppKit              \t0x00007fff880b2d1d _DPSNextEvent + 1833\r\n28  com.apple.AppKit              \t0x00007fff8882e7ee -[NSApplication(NSEvent) _nextEventMatchingEventMask:untilDate:inMode:dequeue:] + 2796\r\n29  com.apple.AppKit              \t0x00007fff880a73db -[NSApplication run] + 926\r\n30  org.chromium.Chromium.framework\t0x000000011141c53e 0x10f8fc000 + 28443966\r\n31  org.chromium.Chromium.framework\t0x000000011141aeac 0x10f8fc000 + 28438188\r\n32  org.chromium.Chromium.framework\t0x000000011143e783 0x10f8fc000 + 28583811\r\n33  org.chromium.Chromium.framework\t0x000000010ff271c1 0x10f8fc000 + 6468033\r\n34  org.chromium.Chromium.framework\t0x000000010ff26fe0 0x10f8fc000 + 6467552\r\n35  org.chromium.Chromium.framework\t0x000000010ff29642 0x10f8fc000 + 6477378\r\n36  org.chromium.Chromium.framework\t0x0000000115649bb0 0x10f8fc000 + 97835952\r\n37  org.chromium.Chromium.framework\t0x0000000110fad6db 0x10f8fc000 + 23795419\r\n38  org.chromium.Chromium.framework\t0x0000000110fadf2e 0x10f8fc000 + 23797550\r\n39  org.chromium.Chromium.framework\t0x00000001127d0f54 0x10f8fc000 + 49106772\r\n40  org.chromium.Chromium.framework\t0x0000000110fad434 0x10f8fc000 + 23794740\r\n41  org.chromium.Chromium.framework\t0x0000000115650d06 0x10f8fc000 + 97864966\r\n42  org.chromium.Chromium.framework\t0x0000000115650d7f 0x10f8fc000 + 97865087\r\n43  org.chromium.Chromium.framework\t0x0000000115643e90 0x10f8fc000 + 97812112\r\n44  org.chromium.Chromium.framework\t0x000000010f8ff781 ChromeMain + 161\r\n45  org.chromium.Chromium         \t0x000000010f896de4 main + 404\r\n46  libdyld.dylib                 \t0x00007fff9fd67235 start + 1\r\n\r\nThread 1:\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe9644e __workq_kernreturn + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff80621 _pthread_wqthread + 1426\r\n2   libsystem_pthread.dylib       \t0x00007fff9ff8007d start_wqthread + 13\r\n\r\nThread 2:\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe9644e __workq_kernreturn + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff8048e _pthread_wqthread + 1023\r\n2   libsystem_pthread.dylib       \t0x00007fff9ff8007d start_wqthread + 13\r\n\r\nThread 3:\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe9644e __workq_kernreturn + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff80621 _pthread_wqthread + 1426\r\n2   libsystem_pthread.dylib       \t0x00007fff9ff8007d start_wqthread + 13\r\n\r\nThread 4:\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000113c145de 0x10f8fc000 + 70354398\r\n3   org.chromium.Chromium.framework\t0x0000000113c14884 0x10f8fc000 + 70355076\r\n4   org.chromium.Chromium.framework\t0x0000000113c104c8 0x10f8fc000 + 70337736\r\n5   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n6   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 5:: NetworkConfigWatcher\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   com.apple.CoreFoundation      \t0x00007fff8a5ba434 __CFRunLoopServiceMachPort + 212\r\n3   com.apple.CoreFoundation      \t0x00007fff8a5b98c1 __CFRunLoopRun + 1361\r\n4   com.apple.CoreFoundation      \t0x00007fff8a5b9114 CFRunLoopRunSpecific + 420\r\n5   com.apple.Foundation          \t0x00007fff8bfcc252 -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 277\r\n6   org.chromium.Chromium.framework\t0x000000011141c35e 0x10f8fc000 + 28443486\r\n7   org.chromium.Chromium.framework\t0x000000011141aeac 0x10f8fc000 + 28438188\r\n8   org.chromium.Chromium.framework\t0x000000011143e783 0x10f8fc000 + 28583811\r\n9   org.chromium.Chromium.framework\t0x000000011146e9ab 0x10f8fc000 + 28780971\r\n10  org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n11  libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n12  libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n13  libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 6:: DnsConfigService\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe96d96 kevent + 10\r\n1   org.chromium.Chromium.framework\t0x00000001114a9809 0x10f8fc000 + 29022217\r\n2   org.chromium.Chromium.framework\t0x00000001114a721d 0x10f8fc000 + 29012509\r\n3   org.chromium.Chromium.framework\t0x000000011141acf0 0x10f8fc000 + 28437744\r\n4   org.chromium.Chromium.framework\t0x000000011143e783 0x10f8fc000 + 28583811\r\n5   org.chromium.Chromium.framework\t0x000000011146e9ab 0x10f8fc000 + 28780971\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 7:: WorkerPool/29443\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe95bf2 __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff81833 _pthread_cond_wait + 769\r\n2   org.chromium.Chromium.framework\t0x00000001114515fb 0x10f8fc000 + 28661243\r\n3   org.chromium.Chromium.framework\t0x0000000111470d20 0x10f8fc000 + 28790048\r\n4   org.chromium.Chromium.framework\t0x0000000111471148 0x10f8fc000 + 28791112\r\n5   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n6   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 8:: WorkerPool/29699\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe95bf2 __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff81833 _pthread_cond_wait + 769\r\n2   org.chromium.Chromium.framework\t0x00000001114515fb 0x10f8fc000 + 28661243\r\n3   org.chromium.Chromium.framework\t0x0000000111470d20 0x10f8fc000 + 28790048\r\n4   org.chromium.Chromium.framework\t0x0000000111471148 0x10f8fc000 + 28791112\r\n5   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n6   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 9:: TaskSchedulerServiceThread\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe96d96 kevent + 10\r\n1   org.chromium.Chromium.framework\t0x00000001114a9809 0x10f8fc000 + 29022217\r\n2   org.chromium.Chromium.framework\t0x00000001114a721d 0x10f8fc000 + 29012509\r\n3   org.chromium.Chromium.framework\t0x000000011141acd2 0x10f8fc000 + 28437714\r\n4   org.chromium.Chromium.framework\t0x000000011143e783 0x10f8fc000 + 28583811\r\n5   org.chromium.Chromium.framework\t0x000000011146e9ab 0x10f8fc000 + 28780971\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 10:: TaskSchedulerBackgroundWorker\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111452121 0x10f8fc000 + 28664097\r\n4   org.chromium.Chromium.framework\t0x0000000111458d98 0x10f8fc000 + 28691864\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 11:: TaskSchedulerBackgroundBlockingWorker\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111452121 0x10f8fc000 + 28664097\r\n4   org.chromium.Chromium.framework\t0x0000000111458d98 0x10f8fc000 + 28691864\r\n5   org.chromium.Chromium.framework\t0x000000011145933d 0x10f8fc000 + 28693309\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 12:: TaskSchedulerForegroundWorker\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111452121 0x10f8fc000 + 28664097\r\n4   org.chromium.Chromium.framework\t0x0000000111458d98 0x10f8fc000 + 28691864\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 13:: TaskSchedulerForegroundBlockingWorker\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111452121 0x10f8fc000 + 28664097\r\n4   org.chromium.Chromium.framework\t0x0000000111458d98 0x10f8fc000 + 28691864\r\n5   org.chromium.Chromium.framework\t0x000000011145933d 0x10f8fc000 + 28693309\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 14:: TaskSchedulerSingleThreadForegroundBlocking0\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111451f7f 0x10f8fc000 + 28663679\r\n4   org.chromium.Chromium.framework\t0x0000000111458d8a 0x10f8fc000 + 28691850\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 15:: TaskSchedulerSingleThreadForegroundBlocking1\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111451f7f 0x10f8fc000 + 28663679\r\n4   org.chromium.Chromium.framework\t0x0000000111458d8a 0x10f8fc000 + 28691850\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 16:: TaskSchedulerSingleThreadForegroundBlocking2\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111451f7f 0x10f8fc000 + 28663679\r\n4   org.chromium.Chromium.framework\t0x0000000111458d8a 0x10f8fc000 + 28691850\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 17:: TaskSchedulerSingleThreadForegroundBlocking3\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111451f7f 0x10f8fc000 + 28663679\r\n4   org.chromium.Chromium.framework\t0x0000000111458d8a 0x10f8fc000 + 28691850\r\n5   org.chromium.Chromium.framework\t0x000000011145933d 0x10f8fc000 + 28693309\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 18:: TaskSchedulerSingleThreadForegroundBlocking4\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111451f7f 0x10f8fc000 + 28663679\r\n4   org.chromium.Chromium.framework\t0x0000000111458d8a 0x10f8fc000 + 28691850\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 19 Crashed:: Chrome_IOThread\r\n0   org.chromium.Chromium.framework\t0x000000010ffa17fa 0x10f8fc000 + 6969338\r\n1   org.chromium.Chromium.framework\t0x000000010ff8348e 0x10f8fc000 + 6845582\r\n2   org.chromium.Chromium.framework\t0x0000000111de1b0c 0x10f8fc000 + 38689548\r\n3   org.chromium.Chromium.framework\t0x0000000111de15da 0x10f8fc000 + 38688218\r\n4   org.chromium.Chromium.framework\t0x000000011012825a 0x10f8fc000 + 8569434\r\n5   org.chromium.Chromium.framework\t0x00000001101263de 0x10f8fc000 + 8561630\r\n6   org.chromium.Chromium.framework\t0x0000000110122624 0x10f8fc000 + 8545828\r\n7   org.chromium.Chromium.framework\t0x000000011011fd80 0x10f8fc000 + 8535424\r\n8   org.chromium.Chromium.framework\t0x000000011011f406 0x10f8fc000 + 8532998\r\n9   org.chromium.Chromium.framework\t0x000000011011cc9a 0x10f8fc000 + 8522906\r\n10  org.chromium.Chromium.framework\t0x000000011011c57f 0x10f8fc000 + 8521087\r\n11  org.chromium.Chromium.framework\t0x000000011011bbef 0x10f8fc000 + 8518639\r\n12  org.chromium.Chromium.framework\t0x000000011011ba29 0x10f8fc000 + 8518185\r\n13  org.chromium.Chromium.framework\t0x000000011011b406 0x10f8fc000 + 8516614\r\n14  org.chromium.Chromium.framework\t0x000000010fe2f24e 0x10f8fc000 + 5452366\r\n15  org.chromium.Chromium.framework\t0x0000000111f63cdd 0x10f8fc000 + 40271069\r\n16  org.chromium.Chromium.framework\t0x0000000111f547d3 0x10f8fc000 + 40208339\r\n17  org.chromium.Chromium.framework\t0x0000000111f54922 0x10f8fc000 + 40208674\r\n18  org.chromium.Chromium.framework\t0x0000000111f51d5e 0x10f8fc000 + 40197470\r\n19  org.chromium.Chromium.framework\t0x0000000111f58248 0x10f8fc000 + 40223304\r\n20  org.chromium.Chromium.framework\t0x0000000111f64c92 0x10f8fc000 + 40275090\r\n21  org.chromium.Chromium.framework\t0x0000000111f5a9e6 0x10f8fc000 + 40233446\r\n22  org.chromium.Chromium.framework\t0x0000000111f3ff93 0x10f8fc000 + 40124307\r\n23  org.chromium.Chromium.framework\t0x0000000111f40611 0x10f8fc000 + 40125969\r\n24  org.chromium.Chromium.framework\t0x000000010fca7145 0x10f8fc000 + 3846469\r\n25  org.chromium.Chromium.framework\t0x0000000111f4e1b7 0x10f8fc000 + 40182199\r\n26  org.chromium.Chromium.framework\t0x00000001113f1a12 0x10f8fc000 + 28269074\r\n27  org.chromium.Chromium.framework\t0x0000000111418d1b 0x10f8fc000 + 28429595\r\n28  org.chromium.Chromium.framework\t0x00000001114193cb 0x10f8fc000 + 28431307\r\n29  org.chromium.Chromium.framework\t0x000000011141ad25 0x10f8fc000 + 28437797\r\n30  org.chromium.Chromium.framework\t0x000000011143e783 0x10f8fc000 + 28583811\r\n31  org.chromium.Chromium.framework\t0x000000010ff32e68 0x10f8fc000 + 6516328\r\n32  org.chromium.Chromium.framework\t0x000000010ff32ff6 0x10f8fc000 + 6516726\r\n33  org.chromium.Chromium.framework\t0x000000011146e9ab 0x10f8fc000 + 28780971\r\n34  org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n35  libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n36  libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n37  libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 20:: TaskSchedulerSingleThreadSharedBackgroundBlocking5\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111451f7f 0x10f8fc000 + 28663679\r\n4   org.chromium.Chromium.framework\t0x0000000111458d8a 0x10f8fc000 + 28691850\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 21:: CompositorTileWorker1/40707\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe95bf2 __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff817fa _pthread_cond_wait + 712\r\n2   org.chromium.Chromium.framework\t0x0000000111ff91c8 0x10f8fc000 + 40882632\r\n3   org.chromium.Chromium.framework\t0x000000011146ddfd 0x10f8fc000 + 28777981\r\n4   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n5   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n6   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 22:: AudioThread\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   com.apple.CoreFoundation      \t0x00007fff8a5ba434 __CFRunLoopServiceMachPort + 212\r\n3   com.apple.CoreFoundation      \t0x00007fff8a5b98c1 __CFRunLoopRun + 1361\r\n4   com.apple.CoreFoundation      \t0x00007fff8a5b9114 CFRunLoopRunSpecific + 420\r\n5   org.chromium.Chromium.framework\t0x000000011141c04f 0x10f8fc000 + 28442703\r\n6   org.chromium.Chromium.framework\t0x000000011141aeac 0x10f8fc000 + 28438188\r\n7   org.chromium.Chromium.framework\t0x000000011143e783 0x10f8fc000 + 28583811\r\n8   org.chromium.Chromium.framework\t0x000000011146e9ab 0x10f8fc000 + 28780971\r\n9   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n10  libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n11  libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n12  libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 23:: Chrome_DevToolsHandlerThread\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe96d96 kevent + 10\r\n1   org.chromium.Chromium.framework\t0x00000001114a9809 0x10f8fc000 + 29022217\r\n2   org.chromium.Chromium.framework\t0x00000001114a721d 0x10f8fc000 + 29012509\r\n3   org.chromium.Chromium.framework\t0x000000011141acf0 0x10f8fc000 + 28437744\r\n4   org.chromium.Chromium.framework\t0x000000011143e783 0x10f8fc000 + 28583811\r\n5   org.chromium.Chromium.framework\t0x000000011146e9ab 0x10f8fc000 + 28780971\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 24:: TaskSchedulerForegroundBlockingWorker\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111452121 0x10f8fc000 + 28664097\r\n4   org.chromium.Chromium.framework\t0x0000000111458d98 0x10f8fc000 + 28691864\r\n5   org.chromium.Chromium.framework\t0x000000011145933d 0x10f8fc000 + 28693309\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 25:: TaskSchedulerBackgroundBlockingWorker\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111452121 0x10f8fc000 + 28664097\r\n4   org.chromium.Chromium.framework\t0x0000000111458d98 0x10f8fc000 + 28691864\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 26:: NetworkConfigWatcher\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   com.apple.CoreFoundation      \t0x00007fff8a5ba434 __CFRunLoopServiceMachPort + 212\r\n3   com.apple.CoreFoundation      \t0x00007fff8a5b98c1 __CFRunLoopRun + 1361\r\n4   com.apple.CoreFoundation      \t0x00007fff8a5b9114 CFRunLoopRunSpecific + 420\r\n5   com.apple.Foundation          \t0x00007fff8bfcc252 -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 277\r\n6   org.chromium.Chromium.framework\t0x000000011141c35e 0x10f8fc000 + 28443486\r\n7   org.chromium.Chromium.framework\t0x000000011141aeac 0x10f8fc000 + 28438188\r\n8   org.chromium.Chromium.framework\t0x000000011143e783 0x10f8fc000 + 28583811\r\n9   org.chromium.Chromium.framework\t0x000000011146e9ab 0x10f8fc000 + 28780971\r\n10  org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n11  libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n12  libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n13  libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 27:\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe9644e __workq_kernreturn + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff80621 _pthread_wqthread + 1426\r\n2   libsystem_pthread.dylib       \t0x00007fff9ff8007d start_wqthread + 13\r\n\r\nThread 28:\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe9644e __workq_kernreturn + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff80621 _pthread_wqthread + 1426\r\n2   libsystem_pthread.dylib       \t0x00007fff9ff8007d start_wqthread + 13\r\n\r\nThread 29:\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe9644e __workq_kernreturn + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff80621 _pthread_wqthread + 1426\r\n2   libsystem_pthread.dylib       \t0x00007fff9ff8007d start_wqthread + 13\r\n\r\nThread 30:\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe9644e __workq_kernreturn + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff80621 _pthread_wqthread + 1426\r\n2   libsystem_pthread.dylib       \t0x00007fff9ff8007d start_wqthread + 13\r\n\r\nThread 31:: TaskSchedulerForegroundBlockingWorker\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111452121 0x10f8fc000 + 28664097\r\n4   org.chromium.Chromium.framework\t0x0000000111458d98 0x10f8fc000 + 28691864\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 32:: WorkerPool/65327\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe95bf2 __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff81833 _pthread_cond_wait + 769\r\n2   org.chromium.Chromium.framework\t0x00000001114515fb 0x10f8fc000 + 28661243\r\n3   org.chromium.Chromium.framework\t0x0000000111470d20 0x10f8fc000 + 28790048\r\n4   org.chromium.Chromium.framework\t0x0000000111471148 0x10f8fc000 + 28791112\r\n5   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n6   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 33:: WorkerPool/69655\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe95bf2 __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff81833 _pthread_cond_wait + 769\r\n2   org.chromium.Chromium.framework\t0x00000001114515fb 0x10f8fc000 + 28661243\r\n3   org.chromium.Chromium.framework\t0x0000000111470d20 0x10f8fc000 + 28790048\r\n4   org.chromium.Chromium.framework\t0x0000000111471148 0x10f8fc000 + 28791112\r\n5   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n6   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 34:: WorkerPool/70147\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe95bf2 __psynch_cvwait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff9ff81833 _pthread_cond_wait + 769\r\n2   org.chromium.Chromium.framework\t0x00000001114515fb 0x10f8fc000 + 28661243\r\n3   org.chromium.Chromium.framework\t0x0000000111470d20 0x10f8fc000 + 28790048\r\n4   org.chromium.Chromium.framework\t0x0000000111471148 0x10f8fc000 + 28791112\r\n5   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n6   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 35:: TaskSchedulerSingleThreadSharedForegroundBlocking6\r\n0   libsystem_kernel.dylib        \t0x00007fff9fe8e34a mach_msg_trap + 10\r\n1   libsystem_kernel.dylib        \t0x00007fff9fe8d797 mach_msg + 55\r\n2   org.chromium.Chromium.framework\t0x0000000111452045 0x10f8fc000 + 28663877\r\n3   org.chromium.Chromium.framework\t0x0000000111451f7f 0x10f8fc000 + 28663679\r\n4   org.chromium.Chromium.framework\t0x0000000111458d8a 0x10f8fc000 + 28691850\r\n5   org.chromium.Chromium.framework\t0x00000001114591da 0x10f8fc000 + 28692954\r\n6   org.chromium.Chromium.framework\t0x0000000111468bd7 0x10f8fc000 + 28756951\r\n7   libsystem_pthread.dylib       \t0x00007fff9ff8093b _pthread_body + 180\r\n8   libsystem_pthread.dylib       \t0x00007fff9ff80887 _pthread_start + 286\r\n9   libsystem_pthread.dylib       \t0x00007fff9ff8008d thread_start + 13\r\n\r\nThread 19 crashed with X86 Thread State (64-bit):\r\n  rax: 0x0000000000000000  rbx: 0x00007ff15a15b160  rcx: 0x0000000000000000  rdx: 0x0000000000000000\r\n  rdi: 0x00007ff15a15b140  rsi: 0x00000001158616f0  rbp: 0x0000700012408ac0  rsp: 0x0000700012408a40\r\n   r8: 0x0000000000000005   r9: 0x0000000000000000  r10: 0x0000000000000001  r11: 0x0000000000000006\r\n  r12: 0x00007ff15a15c290  r13: 0x0000700012408b00  r14: 0x00007ff15a15c298  r15: 0x00007ff15a15ed90\r\n  rip: 0x000000010ffa17fa  rfl: 0x0000000000010246  cr2: 0x0000000000000008\r\n  \r\nLogical CPU:     6\r\nError Code:      0x00000004\r\nTrap Number:     14\r\n\r\n\r\nBinary Images:\r\n       0x10f896000 -        0x10f896fff +org.chromium.Chromium (62.0.3193.0 - 3193.0) <7673D8E4-2EEF-30E6-8F7A-11FF2E17EF07> /Users/USER/*/Chromium.app/Contents/MacOS/Chromium\r\n       0x10f8fc000 -        0x116378f4f +org.chromium.Chromium.framework (62.0.3193.0 - 3193.0) <480CF3C7-DFEF-3E83-85B9-54500A194529> /Users/USER/*/Chromium.app/Contents/Versions/62.0.3193.0/Chromium Framework.framework/Versions/A/Chromium Framework\r\n       0x116af5000 -        0x116b33ff7  com.apple.audio.midi.CoreMIDI (1.10 - 88) <5E2D1F53-B466-312E-AEA7-117B68C9A7F0> /System/Library/Frameworks/CoreMIDI.framework/Versions/A/CoreMIDI\r\n       0x116b5b000 -        0x116b74ffb  libexpat.1.dylib (15) <F48F1B7B-BEB4-32EE-8C5D-0370096F3864> /usr/lib/libexpat.1.dylib\r\n       0x11b4f0000 -        0x11b507ffb  libCGInterfaces.dylib (331.5) <17109679-A284-3C72-AA60-DBA815D3062B> /System/Library/Frameworks/Accelerate.framework/Frameworks/vImage.framework/Versions/A/Libraries/libCGInterfaces.dylib\r\n       0x11b9ea000 -        0x11ba27dc7  dyld (433.5) <322C06B7-8878-311D-888C-C8FD2CA96FF3> /usr/lib/dyld\r\n       0x123ded000 -        0x123e17fff  GLRendererFloat (14.0.16) <6B57F70A-EFAC-3DB2-B9BA-E55D05D44DB5> /System/Library/Frameworks/OpenGL.framework/Resources/GLRendererFloat.bundle/GLRendererFloat\r\n       0x128f29000 -        0x1290cffff  GLEngine (14.0.16) <08F2E804-13D2-3E80-9322-1A23A84A55F3> /System/Library/Frameworks/OpenGL.framework/Resources/GLEngine.bundle/GLEngine\r\n       0x12910e000 -        0x129669ff7  com.apple.driver.AppleIntelHD5000GraphicsGLDriver (10.25.17 - 10.2.5) <37814D97-7FB0-3378-BF1E-375CE00043ED> /System/Library/Extensions/AppleIntelHD5000GraphicsGLDriver.bundle/Contents/MacOS/AppleIntelHD5000GraphicsGLDriver\r\n       0x12987c000 -        0x1298f4ff7  com.apple.driver.AppleIntelHD5000GraphicsMTLDriver (10.25.17 - 10.2.5) <256C1732-C04F-3952-9630-9AE95BDCB245> /System/Library/Extensions/AppleIntelHD5000GraphicsMTLDriver.bundle/Contents/MacOS/AppleIntelHD5000GraphicsMTLDriver\r\n    0x7fff851e3000 -     0x7fff85528ff7  com.apple.RawCamera.bundle (7.04 - 914) <86A67D11-9791-3CE6-9FF5-3387C0AB925B> /System/Library/CoreServices/RawCamera.bundle/Contents/MacOS/RawCamera\r\n    0x7fff86d5f000 -     0x7fff86f20fff  com.apple.avfoundation (2.0 - 1187.36) <2F390EAD-07BB-3788-9E73-13104C2E04CD> /System/Library/Frameworks/AVFoundation.framework/Versions/A/AVFoundation\r\n    0x7fff86f21000 -     0x7fff86fc3ff7  com.apple.audio.AVFAudio (1.0 - ???) <7997D588-B542-3EBB-B822-D719C1114BB4> /System/Library/Frameworks/AVFoundation.framework/Versions/A/Frameworks/AVFAudio.framework/Versions/A/AVFAudio\r\n    0x7fff8708e000 -     0x7fff8708efff  com.apple.Accelerate (1.11 - Accelerate 1.11) <916E360F-323C-3AE1-AB3D-D1F3B284AEE9> /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate\r\n    0x7fff870a7000 -     0x7fff875c0feb  com.apple.vImage (8.1 - ???) <B58A7937-BEE2-38FE-87F4-5D5F40D31DC9> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage\r\n    0x7fff875c1000 -     0x7fff87732ff3  libBLAS.dylib (1185.50.4) <4087FFE0-627E-3623-96B4-F0A9A1991E09> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib\r\n    0x7fff87733000 -     0x7fff87747ffb  libBNNS.dylib (15) <254698C7-7D36-3FFF-864E-ADEEEE543076> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBNNS.dylib\r\n    0x7fff87748000 -     0x7fff87b3efef  libLAPACK.dylib (1185.50.4) <C35FFB2F-A0E6-3903-8A3C-113A74BCBCA2> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib\r\n    0x7fff87b3f000 -     0x7fff87b55fff  libLinearAlgebra.dylib (1185.50.4) <345CAACF-7263-36EF-B69B-793EA8B390AF> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLinearAlgebra.dylib\r\n    0x7fff87b56000 -     0x7fff87b5cfff  libQuadrature.dylib (3) <EF56C8E6-DE22-3C69-B543-A8648F335FDD> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libQuadrature.dylib\r\n    0x7fff87b5d000 -     0x7fff87b71ff7  libSparseBLAS.dylib (1185.50.4) <67BA432E-FB59-3C78-A8BE-ED4274CBC359> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libSparseBLAS.dylib\r\n    0x7fff87b72000 -     0x7fff87cf9fe7  libvDSP.dylib (600.60.1) <4155F45B-41CD-3782-AE8F-7AE740FD83C3> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib\r\n    0x7fff87cfa000 -     0x7fff87dacfff  libvMisc.dylib (600.60.1) <E18365D7-DCC4-3304-A8D1-395E656D7B99> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib\r\n    0x7fff87dad000 -     0x7fff87dadfff  com.apple.Accelerate.vecLib (3.11 - vecLib 3.11) <7C5733E7-0568-3E7D-AF61-160F19FED544> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib\r\n    0x7fff87dae000 -     0x7fff87debffb  com.apple.Accounts (113 - 113) <8550BD08-7D05-3AC4-A0CC-B67ECB2DE950> /System/Library/Frameworks/Accounts.framework/Versions/A/Accounts\r\n    0x7fff87dec000 -     0x7fff8806bff7  com.apple.AddressBook.framework (10.0 - 1756.20) <E512B69B-8DBE-3085-95BE-750B8EFC97FD> /System/Library/Frameworks/AddressBook.framework/Versions/A/AddressBook\r\n    0x7fff8806c000 -     0x7fff88e45ff3  com.apple.AppKit (6.9 - 1504.83.101) <AE51ACB3-D501-3F91-B369-3D3711F24D0A> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit\r\n    0x7fff88e57000 -     0x7fff88e57fff  com.apple.ApplicationServices (48 - 48) <DA687F9A-7B2D-342B-8796-16E45344F853> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices\r\n    0x7fff88e58000 -     0x7fff88ec6ff7  com.apple.ApplicationServices.ATS (377 - 422.2) <A31D17BE-F747-39FB-9A84-5F2F8891204C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS\r\n    0x7fff88f60000 -     0x7fff8908fff7  libFontParser.dylib (194.12) <73C3946D-EF92-3AC1-89C3-0E75B2A85325> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontParser.dylib\r\n    0x7fff89090000 -     0x7fff890dafff  libFontRegistry.dylib (196.4) <EA96AE47-3369-3DEA-BB82-98348ADBD85B> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib\r\n    0x7fff89137000 -     0x7fff8916afff  libTrueTypeScaler.dylib (194.12) <8944A23A-EE36-3657-9B4F-933231C8FDEC> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libTrueTypeScaler.dylib\r\n    0x7fff891d7000 -     0x7fff89281ff7  com.apple.ColorSync (4.12.0 - 502.2) <ACA4001E-A0E3-33F6-9CD6-EEC2AA15E322> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync\r\n    0x7fff89282000 -     0x7fff892d3fff  com.apple.HIServices (1.22 - 593) <045870A9-1D92-3FEF-8722-671E99A35E71> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices\r\n    0x7fff892d4000 -     0x7fff892e3ff3  com.apple.LangAnalysis (1.7.0 - 1.7.0) <2CBE7F61-2056-3F96-99A1-0D527796AFA6> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis\r\n    0x7fff892e4000 -     0x7fff89331fff  com.apple.print.framework.PrintCore (12 - 491) <5027FD58-F0EE-33E4-8577-934CA06CD2AF> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore\r\n    0x7fff89332000 -     0x7fff8936dfff  com.apple.QD (3.12 - 313) <B339C41D-8CDF-3342-8414-F9717DCCADD4> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD\r\n    0x7fff8936e000 -     0x7fff89379fff  com.apple.speech.synthesis.framework (6.6.2 - 6.6.2) <7853EFF4-62B9-394E-B7B8-41A645656820> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis\r\n    0x7fff8937a000 -     0x7fff89586ff7  com.apple.audio.toolbox.AudioToolbox (1.14 - 1.14) <01518CAB-7DAD-3F09-83F8-B9FE0ABE998F> /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox\r\n    0x7fff89587000 -     0x7fff89587fff  com.apple.audio.units.AudioUnit (1.14 - 1.14) <B92868F8-2F15-32C0-A5BE-4ABA546B8BE1> /System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit\r\n    0x7fff896f0000 -     0x7fff89acafff  com.apple.CFNetwork (811.5.4 - 811.5.4) <46B1227B-F38C-3F8E-B0B5-5D9861ABF36B> /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork\r\n    0x7fff89ae4000 -     0x7fff89ae4fff  com.apple.Carbon (154 - 157) <69F403C7-F0CB-34E6-89B0-235CF4978C17> /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon\r\n    0x7fff89ae5000 -     0x7fff89ae8fff  com.apple.CommonPanels (1.2.6 - 98) <BF04BB22-D54C-309E-9F5C-897D969CAF70> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels\r\n    0x7fff89ae9000 -     0x7fff89df2fff  com.apple.HIToolbox (2.1.1 - 857.8) <5367366E-747E-32CF-8E76-93CD8E7424C7> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox\r\n    0x7fff89df3000 -     0x7fff89df6ff7  com.apple.help (1.3.5 - 49) <B1A930E3-5907-3677-BACD-858EF68B172D> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help\r\n    0x7fff89df7000 -     0x7fff89dfcfff  com.apple.ImageCapture (9.0 - 9.0) <341252B4-E082-361A-B756-6A330259C741> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture\r\n    0x7fff89dfd000 -     0x7fff89e94ff3  com.apple.ink.framework (10.9 - 219) <1BD40B45-FD33-3177-A935-565EE5FC79D7> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink\r\n    0x7fff89e95000 -     0x7fff89eaffff  com.apple.openscripting (1.7 - 172) <31CFBB35-24BD-3E12-9B6B-1FA842FB605B> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting\r\n    0x7fff89eb0000 -     0x7fff89eb1ff3  com.apple.print.framework.Print (12 - 267) <E2F82F1F-DC27-3EF0-9F75-B354F701450A> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print\r\n    0x7fff89eb2000 -     0x7fff89eb4ff7  com.apple.securityhi (9.0 - 55006) <DBD65629-535D-3669-8218-7F074D61638C> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI\r\n    0x7fff89eb5000 -     0x7fff89ebbff7  com.apple.speech.recognition.framework (6.0.1 - 6.0.1) <082895DC-3AC7-3DEF-ADCA-5B018C19C9D3> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition\r\n    0x7fff89ebc000 -     0x7fff89f9bffb  com.apple.cloudkit.CloudKit (651.14 - 651.14) <9F901E45-23E3-3F45-B66F-1BAB3AFC4462> /System/Library/Frameworks/CloudKit.framework/Versions/A/CloudKit\r\n    0x7fff89f9c000 -     0x7fff89f9cfff  com.apple.Cocoa (6.11 - 22) <85EDFBE1-75F0-369E-8CA8-C6A639B98FA6> /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa\r\n    0x7fff8a0e6000 -     0x7fff8a173fff  com.apple.audio.CoreAudio (4.3.0 - 4.3.0) <78767F88-91D4-31CE-AAC6-1F9407F479BB> /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio\r\n    0x7fff8a174000 -     0x7fff8a187fff  com.apple.CoreBluetooth (1.0 - 1) <BCB78777-76F0-3CC1-8443-9E61AEF7EF63> /System/Library/Frameworks/CoreBluetooth.framework/Versions/A/CoreBluetooth\r\n    0x7fff8a188000 -     0x7fff8a483fff  com.apple.CoreData (120 - 754.2) <4C9CAB2C-60D4-3694-A0A0-5B04B14BD14E> /System/Library/Frameworks/CoreData.framework/Versions/A/CoreData\r\n    0x7fff8a484000 -     0x7fff8a531ff7  com.apple.CoreDisplay (1.0 - 1) <53D1EAFE-23A4-398D-BF52-E4299E670DB6> /System/Library/Frameworks/CoreDisplay.framework/Versions/A/CoreDisplay\r\n    0x7fff8a532000 -     0x7fff8a9cbff7  com.apple.CoreFoundation (6.9 - 1349.8) <09ED473E-5DE8-307F-B55C-16F6419236D5> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation\r\n    0x7fff8a9cc000 -     0x7fff8b04efff  com.apple.CoreGraphics (2.0 - 1070.22) <FAB476BB-B5CD-3936-8AFC-41229DBDF0E8> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics\r\n    0x7fff8b04f000 -     0x7fff8b292ffb  com.apple.CoreImage (12.4.0 - 451.4.9) <BE4303C9-C9D9-361D-AC94-DBE40EB6700E> /System/Library/Frameworks/CoreImage.framework/Versions/A/CoreImage\r\n    0x7fff8b293000 -     0x7fff8b2f8ff7  com.apple.corelocation (2101.0.63) <C4C6BE27-85E2-34D5-AEDC-EBB5A7CB78D1> /System/Library/Frameworks/CoreLocation.framework/Versions/A/CoreLocation\r\n    0x7fff8b2f9000 -     0x7fff8b3aafff  com.apple.CoreMedia (1.0 - 1907.59.1.6) <570690D8-A956-3629-9E46-4F8BDDB8A82C> /System/Library/Frameworks/CoreMedia.framework/Versions/A/CoreMedia\r\n    0x7fff8b3ab000 -     0x7fff8b3f6ff7  com.apple.CoreMediaIO (805.0 - 4932) <03F2B863-BF99-36DF-9A14-1DB534A289F3> /System/Library/Frameworks/CoreMediaIO.framework/Versions/A/CoreMediaIO\r\n    0x7fff8b3f7000 -     0x7fff8b3f7fff  com.apple.CoreServices (775.19 - 775.19) <7255917D-EFBB-3BE2-A8FD-DAD631BC0949> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices\r\n    0x7fff8b3f8000 -     0x7fff8b449fff  com.apple.AE (712.5 - 712.5) <61F2AE2C-E04E-3FDF-9E88-201325136C83> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE\r\n    0x7fff8b44a000 -     0x7fff8b725ff7  com.apple.CoreServices.CarbonCore (1159.6 - 1159.6) <08AC074C-965B-3EDF-8E45-0707C8DE9EAD> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore\r\n    0x7fff8b726000 -     0x7fff8b759fff  com.apple.DictionaryServices (1.2 - 274) <D23866E2-F7C8-3984-A9D4-96552CCDE573> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices\r\n    0x7fff8b75a000 -     0x7fff8b762ff3  com.apple.CoreServices.FSEvents (1230.50.1 - 1230.50.1) <2AD1B0E5-7214-37C4-8D11-A27C9CAC0F74> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/FSEvents.framework/Versions/A/FSEvents\r\n    0x7fff8b763000 -     0x7fff8b8cfff7  com.apple.LaunchServices (775.19 - 775.19) <B75A0C49-E376-358C-81EE-6EFB0F605801> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices\r\n    0x7fff8b8d0000 -     0x7fff8b980ffb  com.apple.Metadata (10.7.0 - 1075.40) <B2FFCC10-5A9E-396B-B495-3D6C867669EE> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata\r\n    0x7fff8b981000 -     0x7fff8b9e0fff  com.apple.CoreServices.OSServices (775.19 - 775.19) <4140569A-1848-3765-A52B-BB61C35CF88F> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices\r\n    0x7fff8b9e1000 -     0x7fff8ba51fff  com.apple.SearchKit (1.4.0 - 1.4.0) <7A6DDA2B-03F1-3137-BA9E-1CC211973E26> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit\r\n    0x7fff8ba52000 -     0x7fff8ba97ff7  com.apple.coreservices.SharedFileList (38 - 38) <DA096678-93AB-3291-BDE2-482F1D544589> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SharedFileList.framework/Versions/A/SharedFileList\r\n    0x7fff8bb20000 -     0x7fff8bc6dffb  com.apple.CoreText (352.0 - 544.15) <BF0EE575-BB7E-3BF9-9029-232B4ADC24E4> /System/Library/Frameworks/CoreText.framework/Versions/A/CoreText\r\n    0x7fff8bc6e000 -     0x7fff8bca3ff3  com.apple.CoreVideo (1.8 - 235.3) <AC11D5FB-C77B-34F5-B942-F698E84C229F> /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo\r\n    0x7fff8bca4000 -     0x7fff8bd15ffb  com.apple.framework.CoreWLAN (11.0 - 1200.31) <E47C0568-E37B-3052-9E77-F0F371DCDE7F> /System/Library/Frameworks/CoreWLAN.framework/Versions/A/CoreWLAN\r\n    0x7fff8bd48000 -     0x7fff8bd53ff3  com.apple.DirectoryService.Framework (10.12 - 194) <45BEA292-4550-3082-8CE7-5D6CE7E0052A> /System/Library/Frameworks/DirectoryService.framework/Versions/A/DirectoryService\r\n    0x7fff8be13000 -     0x7fff8be18fff  com.apple.DiskArbitration (2.7 - 2.7) <70F56042-EF04-3BAF-9E04-90F423FB2BCC> /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration\r\n    0x7fff8bfaa000 -     0x7fff8c350fff  com.apple.Foundation (6.9 - 1349.91) <A37CB4EC-0730-3DD6-9358-60491BF40EF2> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation\r\n    0x7fff8c37c000 -     0x7fff8c3adff7  com.apple.GSS (4.0 - 2.0) <6FADED0B-0425-3567-A75A-040C5A4638EB> /System/Library/Frameworks/GSS.framework/Versions/A/GSS\r\n    0x7fff8c3ae000 -     0x7fff8c3c6ff7  com.apple.GameController (1.0 - 1) <DAC8C83B-7EC8-3A88-A725-E13DD905BF4F> /System/Library/Frameworks/GameController.framework/Versions/A/GameController\r\n    0x7fff8c46d000 -     0x7fff8c510fff  com.apple.Bluetooth (5.0.5 - 5.0.5f1) <913B97A6-9E18-3F15-992D-D522AA22EDE9> /System/Library/Frameworks/IOBluetooth.framework/Versions/A/IOBluetooth\r\n    0x7fff8c511000 -     0x7fff8c5a7ff7  com.apple.framework.IOKit (2.0.2 - 1324.60.3) <7CE4C98B-107C-3AAA-B49A-F2ACFCBBF526> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit\r\n    0x7fff8c5a8000 -     0x7fff8c5aeffb  com.apple.IOSurface (159.9 - 159.9) <08F1A246-1367-32EC-B3CE-724379409729> /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface\r\n    0x7fff8c5af000 -     0x7fff8c600ff7  com.apple.ImageCaptureCore (7.0 - 7.0) <A640CA2F-8093-34AB-947C-26679ECB8A6D> /System/Library/Frameworks/ImageCaptureCore.framework/Versions/A/ImageCaptureCore\r\n    0x7fff8c601000 -     0x7fff8c761fef  com.apple.ImageIO.framework (3.3.0 - 1599.12) <E54ADBF0-6001-3DEB-AEB0-3F857A781E06> /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO\r\n    0x7fff8c762000 -     0x7fff8c766fff  libGIF.dylib (1599.12) <A0836C44-9566-32A3-ACCF-82A5BAF2E521> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib\r\n    0x7fff8c767000 -     0x7fff8c857ff7  libJP2.dylib (1599.12) <0DB4F152-B36D-365C-97B1-34F1C114982B> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib\r\n    0x7fff8c858000 -     0x7fff8c87bffb  libJPEG.dylib (1599.12) <2F66BA16-D569-35AD-A4BB-7A1909F1BF11> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib\r\n    0x7fff8c87c000 -     0x7fff8c8a3ff7  libPng.dylib (1599.12) <A068239E-7DB3-33AD-BEA9-499D8DEF771B> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib\r\n    0x7fff8c8a4000 -     0x7fff8c8a6ff3  libRadiance.dylib (1599.12) <D26D6FC9-1175-38AB-ACAA-0CA073FD3978> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib\r\n    0x7fff8c8a7000 -     0x7fff8c8f5ffb  libTIFF.dylib (1599.12) <5D161E6A-D279-37A0-9F5F-A71A4C13BB09> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib\r\n    0x7fff8ca53000 -     0x7fff8d65dfff  com.apple.JavaScriptCore (12603 - 12603.3.8) <9557271A-1838-38DD-93E3-D8A9ECDE3B6B> /System/Library/Frameworks/JavaScriptCore.framework/Versions/A/JavaScriptCore\r\n    0x7fff8d65e000 -     0x7fff8d677ff7  com.apple.Kerberos (3.0 - 1) <B9D242EB-E325-3A21-9812-C77CBBFB0D51> /System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos\r\n    0x7fff8d678000 -     0x7fff8d6aefff  com.apple.LDAPFramework (2.4.28 - 194.5) <492ACA22-373E-3DD9-BAEB-9EF6AA962FD5> /System/Library/Frameworks/LDAP.framework/Versions/A/LDAP\r\n    0x7fff8d901000 -     0x7fff8d907fff  com.apple.MediaAccessibility (1.0 - 97.1.1) <0BD82735-6644-37CE-B13D-8E7CC59A1752> /System/Library/Frameworks/MediaAccessibility.framework/Versions/A/MediaAccessibility\r\n    0x7fff8d91d000 -     0x7fff8de56ff7  com.apple.MediaToolbox (1.0 - 1907.59.1.6) <FA068C6F-0506-35C3-A637-C4AFF82411DB> /System/Library/Frameworks/MediaToolbox.framework/Versions/A/MediaToolbox\r\n    0x7fff8de57000 -     0x7fff8deb2fff  com.apple.Metal (87.18 - 87.18) <E3618B54-C728-34CA-9E8A-9BD33A295D31> /System/Library/Frameworks/Metal.framework/Versions/A/Metal\r\n    0x7fff8e79b000 -     0x7fff8e7a3fff  com.apple.NetFS (6.0 - 4.0) <14A24D00-5673-330A-959D-87F72040DEFF> /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS\r\n    0x7fff8e97a000 -     0x7fff8e982ff7  libcldcpuengine.dylib (2.8.5) <81563526-886E-37E4-BF85-4A6D75F93C65> /System/Library/Frameworks/OpenCL.framework/Versions/A/Libraries/libcldcpuengine.dylib\r\n    0x7fff8e983000 -     0x7fff8e9d1ff3  com.apple.opencl (2.8.6 - 2.8.6) <E78463D3-73B6-3002-BD71-9CC1D6722968> /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL\r\n    0x7fff8e9d2000 -     0x7fff8e9ebffb  com.apple.CFOpenDirectory (10.12 - 194) <A64E9A01-3F6E-36EA-9C10-88C564A68C9D> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory\r\n    0x7fff8e9ec000 -     0x7fff8e9f7ff7  com.apple.OpenDirectory (10.12 - 194) <4298FFD0-B1A7-3064-AF5B-708B3FA38671> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory\r\n    0x7fff8e9f8000 -     0x7fff8e9fafff  libCVMSPluginSupport.dylib (14.0.16) <9E12EB67-6630-39A0-AB93-77405F5EC2A7> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCVMSPluginSupport.dylib\r\n    0x7fff8e9fb000 -     0x7fff8e9feff7  libCoreFSCache.dylib (156.3) <687C4CC3-6537-344B-8BE1-5234C8CB2864> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreFSCache.dylib\r\n    0x7fff8e9ff000 -     0x7fff8ea03fff  libCoreVMClient.dylib (156.3) <E7AEFCBE-B6BF-3C7C-9A4E-E78CB04DB794> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib\r\n    0x7fff8ea04000 -     0x7fff8ea0dff7  libGFXShared.dylib (14.0.16) <D10C7A01-8A11-3A42-A9FA-C411AE453B27> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib\r\n    0x7fff8ea0e000 -     0x7fff8ea19fff  libGL.dylib (14.0.16) <0801F3B9-A525-32BB-9BC0-478947CE21D9> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib\r\n    0x7fff8ea1a000 -     0x7fff8ea56ff7  libGLImage.dylib (14.0.16) <FE39C57B-056C-3CBF-B653-A8F2005631C1> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib\r\n    0x7fff8ea57000 -     0x7fff8ebcdff3  libGLProgrammability.dylib (14.0.16) <A95F26AD-D496-3581-A310-5131F61CFB4A> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLProgrammability.dylib\r\n    0x7fff8ebce000 -     0x7fff8ec0fff7  libGLU.dylib (14.0.16) <B285EAD6-B3AA-3753-BB85-75864BD6E76C> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib\r\n    0x7fff8f577000 -     0x7fff8f585fff  com.apple.opengl (14.0.16 - 14.0.16) <167C9883-A79E-3B7F-AFED-8CD6683B291D> /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL\r\n    0x7fff8f622000 -     0x7fff8f769fff  com.apple.QTKit (7.7.3 - 2978.7) <49F88771-52FE-3989-AAB7-10A7494C4419> /System/Library/Frameworks/QTKit.framework/Versions/A/QTKit\r\n    0x7fff8f76a000 -     0x7fff8f9d4ff7  com.apple.imageKit (3.0 - 1023) <9C547565-CBAA-3ACB-A3F6-1366A0DCDCB4> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/ImageKit.framework/Versions/A/ImageKit\r\n    0x7fff8f9d5000 -     0x7fff8fa9cfff  com.apple.PDFKit (1.0 - 1) <BE82F14C-B20C-3771-B16C-F0723F6552AD> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/PDFKit.framework/Versions/A/PDFKit\r\n    0x7fff8fa9d000 -     0x7fff8ffc3ff7  com.apple.QuartzComposer (5.1 - 356) <C66293F6-EF05-3B36-8524-081CEB9FADD7> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuartzComposer.framework/Versions/A/QuartzComposer\r\n    0x7fff8ffc4000 -     0x7fff8ffe7ffb  com.apple.quartzfilters (1.10.0 - 1.10.0) <365342ED-7A1A-3C75-AE60-90764E96034C> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuartzFilters.framework/Versions/A/QuartzFilters\r\n    0x7fff8ffe8000 -     0x7fff900d5fff  com.apple.QuickLookUIFramework (5.0 - 720.7) <3136C23E-399E-3296-928A-B18EC9FC423C> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuickLookUI.framework/Versions/A/QuickLookUI\r\n    0x7fff900d6000 -     0x7fff900d6fff  com.apple.quartzframework (1.5 - 21) <09455972-8A33-3D61-B193-BA7E7CF984CA> /System/Library/Frameworks/Quartz.framework/Versions/A/Quartz\r\n    0x7fff900d7000 -     0x7fff902d7fff  com.apple.QuartzCore (1.11 - 453.39.4) <A45AFBC4-87D4-3533-A0AC-1D6629C77984> /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore\r\n    0x7fff902d8000 -     0x7fff9032dfff  com.apple.QuickLookFramework (5.0 - 720.7) <3BD7BA2F-924C-3EFF-B26E-3F930E62E6B4> /System/Library/Frameworks/QuickLook.framework/Versions/A/QuickLook\r\n    0x7fff9032e000 -     0x7fff90343fff  com.apple.SafariServices.framework (12603 - 12603.3.8) <966BF0C8-B94B-3BDF-AFE1-0F99DAAE6D99> /System/Library/Frameworks/SafariServices.framework/Versions/A/SafariServices\r\n    0x7fff9083e000 -     0x7fff90b40ff7  com.apple.security (7.0 - 57740.60.18) <005E8C96-40B6-35E3-B58B-888A5F5957C2> /System/Library/Frameworks/Security.framework/Versions/A/Security\r\n    0x7fff90b41000 -     0x7fff90bb6fff  com.apple.securityfoundation (6.0 - 55132.50.7) <15C53957-A9DE-31AE-A192-949244F47CD7> /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation\r\n    0x7fff90bb7000 -     0x7fff90be0fff  com.apple.securityinterface (10.0 - 55079.50.4) <C9B0E11A-362B-3C0D-8B2E-B06510BCE20A> /System/Library/Frameworks/SecurityInterface.framework/Versions/A/SecurityInterface\r\n    0x7fff90be1000 -     0x7fff90be4ff3  com.apple.xpc.ServiceManagement (1.0 - 1) <BE0F9708-0B55-3E78-A15E-C287B8ED13BA> /System/Library/Frameworks/ServiceManagement.framework/Versions/A/ServiceManagement\r\n    0x7fff90f6b000 -     0x7fff90fdaff7  com.apple.SystemConfiguration (1.14 - 1.14) <3FFD3930-B307-3E31-9FA6-12221EB0F969> /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration\r\n    0x7fff90fdb000 -     0x7fff91389fff  com.apple.VideoToolbox (1.0 - 1907.59.1.6) <EB2577A4-DCDF-3FD1-B5FA-42A55653A74D> /System/Library/Frameworks/VideoToolbox.framework/Versions/A/VideoToolbox\r\n    0x7fff93831000 -     0x7fff9384cff3  com.apple.AppContainer (4.0 - 307.50.21) <C2E6BA3D-81FF-39C3-B4BF-DBB9A17DE078> /System/Library/PrivateFrameworks/AppContainer.framework/Versions/A/AppContainer\r\n    0x7fff9384d000 -     0x7fff9385aff3  com.apple.AppSandbox (4.0 - 307.50.21) <BF9FA426-8C11-358B-9E1F-A3901E3F2B14> /System/Library/PrivateFrameworks/AppSandbox.framework/Versions/A/AppSandbox\r\n    0x7fff9385b000 -     0x7fff9387dffb  com.apple.framework.Apple80211 (12.0 - 1200.47) <C3033EEE-771A-3664-BBDD-BE1F6D075FC7> /System/Library/PrivateFrameworks/Apple80211.framework/Versions/A/Apple80211\r\n    0x7fff9387e000 -     0x7fff9388dfeb  com.apple.AppleFSCompression (88.50.3 - 1.0) <478E8BFF-8BA2-375E-BE02-BA27F115C15A> /System/Library/PrivateFrameworks/AppleFSCompression.framework/Versions/A/AppleFSCompression\r\n    0x7fff9397b000 -     0x7fff93a0697f  com.apple.AppleJPEG (1.0 - 1) <B9E9570D-04A4-34E4-B756-D200043B25B8> /System/Library/PrivateFrameworks/AppleJPEG.framework/Versions/A/AppleJPEG\r\n    0x7fff93a1a000 -     0x7fff93a35fff  com.apple.aps.framework (4.0 - 4.0) <6CA07CDF-1E35-34E9-95BF-BD565FF42BAD> /System/Library/PrivateFrameworks/ApplePushService.framework/Versions/A/ApplePushService\r\n    0x7fff93a36000 -     0x7fff93a3effb  com.apple.AppleSRP (5.0 - 1) <6AAE93B6-9816-35B2-9C59-D5C3218065AF> /System/Library/PrivateFrameworks/AppleSRP.framework/Versions/A/AppleSRP\r\n    0x7fff93a3f000 -     0x7fff93a42ff3  com.apple.AppleSystemInfo (3.1.5 - 3.1.5) <42A1731A-A576-307A-B07C-9F8F64696CB7> /System/Library/PrivateFrameworks/AppleSystemInfo.framework/Versions/A/AppleSystemInfo\r\n    0x7fff93a43000 -     0x7fff93a95fff  com.apple.AppleVAFramework (5.0.36 - 5.0.36) <7352078D-C230-397C-81A5-57A48CF218C0> /System/Library/PrivateFrameworks/AppleVA.framework/Versions/A/AppleVA\r\n    0x7fff93a9f000 -     0x7fff93aa6ff7  com.apple.AssetCacheServices (48.3 - 48.3) <C59F7295-36D8-3109-A910-C83D884CC92C> /System/Library/PrivateFrameworks/AssetCacheServices.framework/Versions/A/AssetCacheServices\r\n    0x7fff93e39000 -     0x7fff93eb7ff7  com.apple.backup.framework (1.8.5 - 1.8.5) <CC679891-E8F5-3166-8EB6-AEA06954A52D> /System/Library/PrivateFrameworks/Backup.framework/Versions/A/Backup\r\n    0x7fff94553000 -     0x7fff9457afff  com.apple.CalendarAgentLink (8.0 - 250) <E50E29F6-2BAB-3B8B-BBEA-7DC0B8B077AD> /System/Library/PrivateFrameworks/CalendarAgentLink.framework/Versions/A/CalendarAgentLink\r\n    0x7fff94b42000 -     0x7fff94b69ff3  com.apple.ChunkingLibrary (173 - 173) <FC2165F9-FC93-39C0-8323-C2F43A5E00A3> /System/Library/PrivateFrameworks/ChunkingLibrary.framework/Versions/A/ChunkingLibrary\r\n    0x7fff94b6a000 -     0x7fff94bf6ff7  com.apple.CloudDocs (1.0 - 486.29) <392B87EC-0317-313F-8FE2-F571831C7F35> /System/Library/PrivateFrameworks/CloudDocs.framework/Versions/A/CloudDocs\r\n    0x7fff9548e000 -     0x7fff95497ffb  com.apple.CommonAuth (4.0 - 2.0) <216950CB-269F-3476-BA17-D6363AC49FBC> /System/Library/PrivateFrameworks/CommonAuth.framework/Versions/A/CommonAuth\r\n    0x7fff9555e000 -     0x7fff955afff7  com.apple.AddressBook.ContactsFoundation (8.0 - 2250.11) <1324A70E-A093-3DB9-A802-07B8F4A499B5> /System/Library/PrivateFrameworks/ContactsFoundation.framework/Versions/A/ContactsFoundation\r\n    0x7fff955b0000 -     0x7fff955d2fff  com.apple.contacts.ContactsPersistence (1.0 - 2250.11) <7CDEB852-B3B7-328F-9537-DFB3A58B882C> /System/Library/PrivateFrameworks/ContactsPersistence.framework/Versions/A/ContactsPersistence\r\n    0x7fff9561c000 -     0x7fff959fbff7  com.apple.CoreAUC (226.0.0 - 226.0.0) <FBF6C5BC-5937-3957-B6BA-E101DF9B0DF6> /System/Library/PrivateFrameworks/CoreAUC.framework/Versions/A/CoreAUC\r\n    0x7fff959fc000 -     0x7fff95a2cfff  com.apple.CoreAVCHD (5.9.0 - 5900.4.1) <3F6857D1-AE7C-3593-B064-930F5BB7269E> /System/Library/PrivateFrameworks/CoreAVCHD.framework/Versions/A/CoreAVCHD\r\n    0x7fff95ac7000 -     0x7fff95acfffb  com.apple.frameworks.CoreDaemon (1.3 - 1.3) <2AB86FAF-37B3-3323-9EF0-CA591B6E357C> /System/Library/PrivateFrameworks/CoreDaemon.framework/Versions/B/CoreDaemon\r\n    0x7fff95be0000 -     0x7fff95bf0fff  com.apple.CoreEmoji (1.0 - 40.3.3) <E9A28301-2D79-3A97-A046-028258A6ABE5> /System/Library/PrivateFrameworks/CoreEmoji.framework/Versions/A/CoreEmoji\r\n    0x7fff95cb5000 -     0x7fff95ccbff3  com.apple.CoreMediaAuthoring (2.2 - 956) <AEBFF55F-BF1E-3CA5-AA9C-1CE22218A665> /System/Library/PrivateFrameworks/CoreMediaAuthoring.framework/Versions/A/CoreMediaAuthoring\r\n    0x7fff95cd2000 -     0x7fff95d62ffb  com.apple.CorePDF (4.0 - 4) <7F50E4A6-940C-33F5-BE4E-7E01AFE98A8F> /System/Library/PrivateFrameworks/CorePDF.framework/Versions/A/CorePDF\r\n    0x7fff95f2b000 -     0x7fff95f5bff3  com.apple.CoreServicesInternal (276.2 - 276.2) <05EB7D45-DD4C-3A0F-AC63-A0C2A68E6481> /System/Library/PrivateFrameworks/CoreServicesInternal.framework/Versions/A/CoreServicesInternal\r\n    0x7fff961ec000 -     0x7fff9627bff7  com.apple.CoreSymbolication (62046) <7839CD8E-011D-3567-88DE-3D472C661136> /System/Library/PrivateFrameworks/CoreSymbolication.framework/Versions/A/CoreSymbolication\r\n    0x7fff9627c000 -     0x7fff963bbfe7  com.apple.coreui (2.1 - 431.3) <2E8FEC10-FC5B-3782-92DA-A85C24B7BF7C> /System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI\r\n    0x7fff963bc000 -     0x7fff9648cff3  com.apple.CoreUtils (5.1 - 510.31) <E68BB8ED-8874-36EC-A7C5-1017C0E727CB> /System/Library/PrivateFrameworks/CoreUtils.framework/Versions/A/CoreUtils\r\n    0x7fff964dc000 -     0x7fff96541ff3  com.apple.framework.CoreWiFi (12.0 - 1200.31) <DF0972EF-F817-3FD3-8C00-2D57B8738D8C> /System/Library/PrivateFrameworks/CoreWiFi.framework/Versions/A/CoreWiFi\r\n    0x7fff96542000 -     0x7fff96550ff7  com.apple.CrashReporterSupport (10.12 - 827) <802A9B81-E349-348B-90AB-10E40B654250> /System/Library/PrivateFrameworks/CrashReporterSupport.framework/Versions/A/CrashReporterSupport\r\n    0x7fff965c2000 -     0x7fff965ccffb  com.apple.framework.DFRFoundation (1.0 - 104.25) <7CFF896C-EF22-3941-BB3D-F3615CE4C908> /System/Library/PrivateFrameworks/DFRFoundation.framework/Versions/A/DFRFoundation\r\n    0x7fff965cd000 -     0x7fff965d1ff3  com.apple.DSExternalDisplay (3.1 - 380) <4B5E3FF0-E8C3-38CC-BF72-418C928956AB> /System/Library/PrivateFrameworks/DSExternalDisplay.framework/Versions/A/DSExternalDisplay\r\n    0x7fff96607000 -     0x7fff9667cffb  com.apple.datadetectorscore (7.0 - 539.1) <74595F6C-8283-3C73-9F56-C6FA957F8B94> /System/Library/PrivateFrameworks/DataDetectorsCore.framework/Versions/A/DataDetectorsCore\r\n    0x7fff966b8000 -     0x7fff966f7fff  com.apple.DebugSymbols (137 - 137) <58A70B66-2628-3CFE-B103-2200D95FC5F7> /System/Library/PrivateFrameworks/DebugSymbols.framework/Versions/A/DebugSymbols\r\n    0x7fff966f8000 -     0x7fff96809fff  com.apple.desktopservices (1.11.5 - 1.11.5) <46A9D4F3-1EF8-373C-98A4-AD48D285E484> /System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv\r\n    0x7fff9694c000 -     0x7fff96957fff  com.apple.DisplayServicesFW (3.1 - 380) <0BDF6C17-5E5F-33F8-8E99-C7350C6F9667> /System/Library/PrivateFrameworks/DisplayServices.framework/Versions/A/DisplayServices\r\n    0x7fff96af1000 -     0x7fff96f22ff7  com.apple.vision.FaceCore (3.3.2 - 3.3.2) <9391D5A3-738C-3136-9D07-518CB43DBADA> /System/Library/PrivateFrameworks/FaceCore.framework/Versions/A/FaceCore\r\n    0x7fff98279000 -     0x7fff98279fff  libmetal_timestamp.dylib (600.0.49.9) <E5EED927-1671-3390-BCBB-D76201D63C73> /System/Library/PrivateFrameworks/GPUCompiler.framework/libmetal_timestamp.dylib\r\n    0x7fff98286000 -     0x7fff98291ff3  libGPUSupportMercury.dylib (14.0.16) <7EE3DA75-2F9D-3C6D-AECD-F73EA47BE81B> /System/Library/PrivateFrameworks/GPUSupport.framework/Versions/A/Libraries/libGPUSupportMercury.dylib\r\n    0x7fff9854a000 -     0x7fff98566fff  com.apple.GenerationalStorage (2.0 - 267.1) <3DE1C580-D089-362D-8582-8DE68A3C5F13> /System/Library/PrivateFrameworks/GenerationalStorage.framework/Versions/A/GenerationalStorage\r\n    0x7fff9857f000 -     0x7fff98c31fff  com.apple.GeoServices (1.0 - 1228.24.9.30.34) <96BF97F6-8FF2-3FC4-A8C1-498CB7B0D9A0> /System/Library/PrivateFrameworks/GeoServices.framework/Versions/A/GeoServices\r\n    0x7fff98c77000 -     0x7fff98cedff3  com.apple.Heimdal (4.0 - 2.0) <8F9C9041-66D5-36C9-8A4C-1658035C311D> /System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal\r\n    0x7fff99308000 -     0x7fff9930fffb  com.apple.IOAccelerator (311.14 - 311.14) <278124AF-02DC-3785-9FA9-14EDB8E5FD56> /System/Library/PrivateFrameworks/IOAccelerator.framework/Versions/A/IOAccelerator\r\n    0x7fff99311000 -     0x7fff99325ff7  com.apple.IOPresentment (1.0 - 29.10) <30DF04EE-10E2-353F-845F-A97B87DF3207> /System/Library/PrivateFrameworks/IOPresentment.framework/Versions/A/IOPresentment\r\n    0x7fff99326000 -     0x7fff99348fff  com.apple.IconServices (74.4 - 74.4) <218DDD05-35F4-3833-B98D-471ED0EBC031> /System/Library/PrivateFrameworks/IconServices.framework/Versions/A/IconServices\r\n    0x7fff993e4000 -     0x7fff993f4ff3  com.apple.IntlPreferences (2.0 - 216) <77C9C2E7-EF9F-34BB-A5E3-B8BEA4226B5F> /System/Library/PrivateFrameworks/IntlPreferences.framework/Versions/A/IntlPreferences\r\n    0x7fff9942f000 -     0x7fff995e6fff  com.apple.LanguageModeling (1.0 - 123.2.5) <A8CA965F-0399-310D-91C3-B93DDDE9A442> /System/Library/PrivateFrameworks/LanguageModeling.framework/Versions/A/LanguageModeling\r\n    0x7fff996e2000 -     0x7fff997a4ff3  com.apple.MMCS (1.3 - 385.4) <D3D76CE0-DE05-373E-B757-9E4B4920565D> /System/Library/PrivateFrameworks/MMCS.framework/Versions/A/MMCS\r\n    0x7fff99c56000 -     0x7fff99c59fff  com.apple.Mangrove (1.0 - 1) <98814966-FD65-302B-B47E-00928DC34E5C> /System/Library/PrivateFrameworks/Mangrove.framework/Versions/A/Mangrove\r\n    0x7fff99f07000 -     0x7fff99f80ff7  com.apple.MetalPerformanceShaders.MetalPerformanceShaders (1.0 - 1) <C323FC94-FFA5-3EE6-B2AC-7E61EA92F304> /System/Library/PrivateFrameworks/MetalPerformanceShaders.framework/Versions/A/MetalPerformanceShaders\r\n    0x7fff9a10a000 -     0x7fff9a118fff  com.apple.MobileKeyBag (2.0 - 1.0) <D0983DB7-EF9D-3E19-A084-21319ECE5846> /System/Library/PrivateFrameworks/MobileKeyBag.framework/Versions/A/MobileKeyBag\r\n    0x7fff9a129000 -     0x7fff9a151ff7  com.apple.MultitouchSupport.framework (368.16 - 368.16) <9E602B4A-22CD-3CF3-B284-78D5123C9AE8> /System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport\r\n    0x7fff9a203000 -     0x7fff9a20efff  com.apple.NetAuth (6.2 - 6.2) <97F487D6-8089-31A8-B68C-6C1EAC6ED1B5> /System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth\r\n    0x7fff9a65b000 -     0x7fff9a65dfff  com.apple.OAuth (25 - 25) <D6E5F36D-71B8-3E12-9601-CE2A1D6ED60B> /System/Library/PrivateFrameworks/OAuth.framework/Versions/A/OAuth\r\n    0x7fff9aae6000 -     0x7fff9ab27ff3  com.apple.PerformanceAnalysis (1.148.3 - 148.3) <4E468BC7-F863-3674-909D-417231EB8C28> /System/Library/PrivateFrameworks/PerformanceAnalysis.framework/Versions/A/PerformanceAnalysis\r\n    0x7fff9ab6a000 -     0x7fff9ab71ff3  com.apple.phonenumbers (1.1.1 - 105) <B8EFDDD3-BA26-39B8-9EA0-3649184BF527> /System/Library/PrivateFrameworks/PhoneNumbers.framework/Versions/A/PhoneNumbers\r\n    0x7fff9b1d4000 -     0x7fff9b20effb  com.apple.ProtectedCloudStorage (1.0 - 1) <8B32A7EC-D371-38E3-A286-F1BE1307F1E1> /System/Library/PrivateFrameworks/ProtectedCloudStorage.framework/Versions/A/ProtectedCloudStorage\r\n    0x7fff9b20f000 -     0x7fff9b229fff  com.apple.ProtocolBuffer (1 - 249.1) <A1F1B0F3-078F-378F-A9A9-0DEEA70E816A> /System/Library/PrivateFrameworks/ProtocolBuffer.framework/Versions/A/ProtocolBuffer\r\n    0x7fff9b22a000 -     0x7fff9b239ff7  com.apple.QuickLookThumbnailing (1.0 - 1) <173EE873-1700-3FCA-9782-C060FBB5BCAD> /System/Library/PrivateFrameworks/QuickLookThumbnailing.framework/Versions/A/QuickLookThumbnailing\r\n    0x7fff9b242000 -     0x7fff9b265ff3  com.apple.RemoteViewServices (2.0 - 124) <6B967FDA-6591-302C-BA0A-76C4856E584E> /System/Library/PrivateFrameworks/RemoteViewServices.framework/Versions/A/RemoteViewServices\r\n    0x7fff9bf2f000 -     0x7fff9bf32fff  com.apple.SecCodeWrapper (4.0 - 307.50.21) <F8E957B2-D3F0-3B73-B38C-AE8868F00939> /System/Library/PrivateFrameworks/SecCodeWrapper.framework/Versions/A/SecCodeWrapper\r\n    0x7fff9bfc1000 -     0x7fff9c04efff  com.apple.Sharing (696.2.67 - 696.2.67) <F681EE28-153F-3216-97A6-6F5E4148AB2E> /System/Library/PrivateFrameworks/Sharing.framework/Versions/A/Sharing\r\n    0x7fff9c06f000 -     0x7fff9c2d5feb  com.apple.SkyLight (1.600.0 - 170.3) <38AC05EF-3A9E-3E3E-9849-04E0223DF7B9> /System/Library/PrivateFrameworks/SkyLight.framework/Versions/A/SkyLight\r\n    0x7fff9c4b4000 -     0x7fff9c4c0ff7  com.apple.SpeechRecognitionCore (3.3.2 - 3.3.2) <684BD1EA-8268-331C-A5A9-080EB375C658> /System/Library/PrivateFrameworks/SpeechRecognitionCore.framework/Versions/A/SpeechRecognitionCore\r\n    0x7fff9cbac000 -     0x7fff9cc20fdf  com.apple.Symbolication (62048.1) <1A30ED19-7532-3F46-9DD3-9879A973D0CF> /System/Library/PrivateFrameworks/Symbolication.framework/Versions/A/Symbolication\r\n    0x7fff9d05f000 -     0x7fff9d065ff7  com.apple.TCC (1.0 - 1) <911B534B-4AC7-34E4-935E-E42ECD008CBC> /System/Library/PrivateFrameworks/TCC.framework/Versions/A/TCC\r\n    0x7fff9d0f1000 -     0x7fff9d1b7ff7  com.apple.TextureIO (2.8 - 2.8) <3D61E533-4156-3B21-B7ED-CB823E680DFC> /System/Library/PrivateFrameworks/TextureIO.framework/Versions/A/TextureIO\r\n    0x7fff9d200000 -     0x7fff9d215ff3  com.apple.ToneKit (1.0 - 1) <B709293D-0A79-398A-8AA9-50F6340C227C> /System/Library/PrivateFrameworks/ToneKit.framework/Versions/A/ToneKit\r\n    0x7fff9d216000 -     0x7fff9d224ffb  com.apple.ToneLibrary (1.0 - 1) <F2ED5DFC-5F11-3012-BCD7-17753413141F> /System/Library/PrivateFrameworks/ToneLibrary.framework/Versions/A/ToneLibrary\r\n    0x7fff9d22b000 -     0x7fff9d22cfff  com.apple.TrustEvaluationAgent (2.0 - 28.50.1) <EBE65DD5-1732-3747-8C6C-7BECEBF089A4> /System/Library/PrivateFrameworks/TrustEvaluationAgent.framework/Versions/A/TrustEvaluationAgent\r\n    0x7fff9d22d000 -     0x7fff9d3bdff3  com.apple.UIFoundation (1.0 - 490.7) <2A3063FE-1790-3510-8A0E-AEC581D42B7E> /System/Library/PrivateFrameworks/UIFoundation.framework/Versions/A/UIFoundation\r\n    0x7fff9de8c000 -     0x7fff9df4cfff  com.apple.ViewBridge (283 - 283) <25A635B3-C87C-3D3A-ADF3-539713FA1048> /System/Library/PrivateFrameworks/ViewBridge.framework/Versions/A/ViewBridge\r\n    0x7fff9e397000 -     0x7fff9e39dfff  com.apple.XPCService (2.0 - 1) <4B28B225-2105-33F4-9ED0-F04288FF4FB1> /System/Library/PrivateFrameworks/XPCService.framework/Versions/A/XPCService\r\n    0x7fff9e46e000 -     0x7fff9e470ffb  com.apple.loginsupport (1.0 - 1) <F3140B97-12C3-35A7-9D3D-43DA2D13C113> /System/Library/PrivateFrameworks/login.framework/Versions/A/Frameworks/loginsupport.framework/Versions/A/loginsupport\r\n    0x7fff9e49c000 -     0x7fff9e4c3ff7  com.apple.contacts.vCard (1.0 - 2250.11) <DD615DAF-AF34-3AB4-9CB4-DA0A882D59A5> /System/Library/PrivateFrameworks/vCard.framework/Versions/A/vCard\r\n    0x7fff9e4c5000 -     0x7fff9e4e0ff7  libCRFSuite.dylib (34) <F78B7F5F-0B4F-35C6-AA2F-84EE9CB22137> /usr/lib/libCRFSuite.dylib\r\n    0x7fff9e4e1000 -     0x7fff9e4ecfff  libChineseTokenizer.dylib (21) <0886E908-A825-36AF-B94B-2361FD8BC2A1> /usr/lib/libChineseTokenizer.dylib\r\n    0x7fff9e57e000 -     0x7fff9e57fff3  libDiagnosticMessagesClient.dylib (102) <84A04D24-0E60-3810-A8C0-90A65E2DF61A> /usr/lib/libDiagnosticMessagesClient.dylib\r\n    0x7fff9e580000 -     0x7fff9e793fff  libFosl_dynamic.dylib (16.39) <E22A4243-D148-3C74-BA15-2D906A3D1F9E> /usr/lib/libFosl_dynamic.dylib\r\n    0x7fff9e7af000 -     0x7fff9e7b6fff  libMatch.1.dylib (27) <70D4BD2A-9383-37F2-B0D6-9B592D236601> /usr/lib/libMatch.1.dylib\r\n    0x7fff9e7b7000 -     0x7fff9e7b7fff  libOpenScriptingUtil.dylib (172) <90743888-C1E8-34E3-924E-1A754B2B63B9> /usr/lib/libOpenScriptingUtil.dylib\r\n    0x7fff9e7b8000 -     0x7fff9e7bcffb  libScreenReader.dylib (477.40.6) <CBE6420C-EF60-3ACD-A0B6-7CBE936BA3B8> /usr/lib/libScreenReader.dylib\r\n    0x7fff9e7bd000 -     0x7fff9e7beffb  libSystem.B.dylib (1238.60.2) <F18AC1E7-C6F1-34B1-8069-BE571B3231D4> /usr/lib/libSystem.B.dylib\r\n    0x7fff9e82a000 -     0x7fff9e855ff3  libarchive.2.dylib (41.70.1) <A3FA7D6E-3D68-3524-8B48-EB2ECA44B13B> /usr/lib/libarchive.2.dylib\r\n    0x7fff9e856000 -     0x7fff9e8d2fc7  libate.dylib (1.12.13) <D0767875-D02E-3377-84D8-5F174C27BEA9> /usr/lib/libate.dylib\r\n    0x7fff9e8d6000 -     0x7fff9e8d6ff3  libauto.dylib (187) <34388D0B-C539-3C1B-9408-2BC152162E43> /usr/lib/libauto.dylib\r\n    0x7fff9e8d7000 -     0x7fff9e8e7ff3  libbsm.0.dylib (34) <20084796-B04D-3B35-A003-EA11459557A9> /usr/lib/libbsm.0.dylib\r\n    0x7fff9e8e8000 -     0x7fff9e8f6ff7  libbz2.1.0.dylib (38) <ADFA329A-DCE7-356D-8F09-A3168DFC6610> /usr/lib/libbz2.1.0.dylib\r\n    0x7fff9e8f7000 -     0x7fff9e94dff7  libc++.1.dylib (307.5) <0B43BB5D-E6EB-3464-8DE9-B41AC8ED9D1C> /usr/lib/libc++.1.dylib\r\n    0x7fff9e94e000 -     0x7fff9e977ff7  libc++abi.dylib (307.4) <BC271AD3-831B-362A-9DA7-E8C51F285FE4> /usr/lib/libc++abi.dylib\r\n    0x7fff9e978000 -     0x7fff9e988ffb  libcmph.dylib (6) <2B5D405E-2D0B-3320-ABD6-622934C86ABE> /usr/lib/libcmph.dylib\r\n    0x7fff9e989000 -     0x7fff9e99ffcf  libcompression.dylib (39) <F2726F95-F54E-3B21-BCB5-F7151DEFDC2F> /usr/lib/libcompression.dylib\r\n    0x7fff9e9a0000 -     0x7fff9e9a0ff7  libcoretls.dylib (121.50.4) <64B1001E-10F6-3542-A3B2-C4B49F51817F> /usr/lib/libcoretls.dylib\r\n    0x7fff9e9a1000 -     0x7fff9e9a2ff3  libcoretls_cfhelpers.dylib (121.50.4) <1A10303E-5EB0-3C7C-9165-021FCDFD934D> /usr/lib/libcoretls_cfhelpers.dylib\r\n    0x7fff9ea5c000 -     0x7fff9eb41ff7  libcrypto.0.9.8.dylib (64.50.6) <D34E16A7-990A-37A9-933A-DFAA46554EAA> /usr/lib/libcrypto.0.9.8.dylib\r\n    0x7fff9ecdf000 -     0x7fff9ed32ff7  libcups.2.dylib (450) <9950BFCB-7882-33C9-9ECF-CE66773C5657> /usr/lib/libcups.2.dylib\r\n    0x7fff9ed86000 -     0x7fff9ed8dff3  libdscsym.dylib (148.3) <EF99B991-18D9-3A73-BE88-4DC55F036DEF> /usr/lib/libdscsym.dylib\r\n    0x7fff9edaf000 -     0x7fff9edaffff  libenergytrace.dylib (15) <A1B040A2-7977-3097-9ADF-34FF181EB970> /usr/lib/libenergytrace.dylib\r\n    0x7fff9edbf000 -     0x7fff9edc4ff7  libheimdal-asn1.dylib (498.50.8) <A40E3196-235E-34CE-AD9A-8D1AFC5DE004> /usr/lib/libheimdal-asn1.dylib\r\n    0x7fff9edc5000 -     0x7fff9eeb7ff7  libiconv.2.dylib (50) <42125B35-81D7-3FC4-9475-A26DBE10884D> /usr/lib/libiconv.2.dylib\r\n    0x7fff9eeb8000 -     0x7fff9f0ddffb  libicucore.A.dylib (57166.0.1) <CCD2ED24-3071-383B-925D-8D763BB12A6F> /usr/lib/libicucore.A.dylib\r\n    0x7fff9f0e3000 -     0x7fff9f0e4fff  liblangid.dylib (126) <2085E7A7-9A34-3735-87F4-F174EF8EABF0> /usr/lib/liblangid.dylib\r\n    0x7fff9f0e5000 -     0x7fff9f0feffb  liblzma.5.dylib (10) <44BD0279-99DD-36B5-8A6E-C11432E2098D> /usr/lib/liblzma.5.dylib\r\n    0x7fff9f0ff000 -     0x7fff9f115ff7  libmarisa.dylib (5) <9030D214-5D0F-30CB-AC03-902C63909362> /usr/lib/libmarisa.dylib\r\n    0x7fff9f116000 -     0x7fff9f3beff7  libmecabra.dylib (744.8) <D429FCC9-42A4-38B3-8784-44024BC859EF> /usr/lib/libmecabra.dylib\r\n    0x7fff9f3f1000 -     0x7fff9f46bff3  libnetwork.dylib (856.60.1) <191E99F5-4723-3180-8013-02AF2F9AE4B8> /usr/lib/libnetwork.dylib\r\n    0x7fff9f46c000 -     0x7fff9f83e047  libobjc.A.dylib (709.1) <70614861-0340-32E2-85ED-FE65759CDFFA> /usr/lib/libobjc.A.dylib\r\n    0x7fff9f841000 -     0x7fff9f845fff  libpam.2.dylib (21.30.1) <71EB0D88-DE84-3C8D-A2C5-58AA282BC5BC> /usr/lib/libpam.2.dylib\r\n    0x7fff9f846000 -     0x7fff9f877fff  libpcap.A.dylib (67.60.1) <F6BC6ED6-AEE4-3520-B248-0C342636E2B0> /usr/lib/libpcap.A.dylib\r\n    0x7fff9f894000 -     0x7fff9f8b0ffb  libresolv.9.dylib (64) <A244AE4C-00B0-396C-98FF-97FE4DB3DA30> /usr/lib/libresolv.9.dylib\r\n    0x7fff9f8b1000 -     0x7fff9f8eafff  libsandbox.1.dylib (592.70.1) <9C428C49-9D9A-3F9F-9573-BF5202D1F933> /usr/lib/libsandbox.1.dylib\r\n    0x7fff9f8eb000 -     0x7fff9f8fdffb  libsasl2.2.dylib (209) <32107C59-22C6-3049-B86E-9C2F85FF549B> /usr/lib/libsasl2.2.dylib\r\n    0x7fff9f8fe000 -     0x7fff9f8ffff3  libspindump.dylib (231.3) <C7CEEB64-06F4-3ACA-AAC1-30ECA909501A> /usr/lib/libspindump.dylib\r\n    0x7fff9f900000 -     0x7fff9fa4eff7  libsqlite3.dylib (254.8) <1ECF7DF7-7A07-3B4B-A63B-F4EFF6BC7ACF> /usr/lib/libsqlite3.dylib\r\n    0x7fff9fb43000 -     0x7fff9fb50fff  libxar.1.dylib (357) <69547C64-E811-326F-BBED-490C6361BDCB> /usr/lib/libxar.1.dylib\r\n    0x7fff9fb51000 -     0x7fff9fc40fff  libxml2.2.dylib (30.17) <D4C3E467-37C6-34DE-8A1B-E7BFC29985E9> /usr/lib/libxml2.2.dylib\r\n    0x7fff9fc41000 -     0x7fff9fc6afff  libxslt.1.dylib (15.9) <00735AD5-B62D-3E83-86AC-5533E4E2B102> /usr/lib/libxslt.1.dylib\r\n    0x7fff9fc6b000 -     0x7fff9fc7cff3  libz.1.dylib (67) <46E3FFA2-4328-327A-8D34-A03E20BFFB8E> /usr/lib/libz.1.dylib\r\n    0x7fff9fc8b000 -     0x7fff9fc8fff7  libcache.dylib (79) <093A4DAB-8385-3D47-A350-E20CB7CCF7BF> /usr/lib/system/libcache.dylib\r\n    0x7fff9fc90000 -     0x7fff9fc9afff  libcommonCrypto.dylib (60092.50.5) <8A64D1B0-C70E-385C-92F0-E669079FDA90> /usr/lib/system/libcommonCrypto.dylib\r\n    0x7fff9fc9b000 -     0x7fff9fca2fff  libcompiler_rt.dylib (62) <55D47421-772A-32AB-B529-1A46C2F43B4D> /usr/lib/system/libcompiler_rt.dylib\r\n    0x7fff9fca3000 -     0x7fff9fcabfff  libcopyfile.dylib (138) <819BEA3C-DF11-3E3D-A1A1-5A51C5BF1961> /usr/lib/system/libcopyfile.dylib\r\n    0x7fff9fcac000 -     0x7fff9fd2ffdf  libcorecrypto.dylib (442.50.19) <65D7165E-2E71-335D-A2D6-33F78E2DF0C1> /usr/lib/system/libcorecrypto.dylib\r\n    0x7fff9fd30000 -     0x7fff9fd61fff  libdispatch.dylib (703.50.37) <6582BAD6-ED27-3B30-B620-90B1C5A4AE3C> /usr/lib/system/libdispatch.dylib\r\n    0x7fff9fd62000 -     0x7fff9fd67ffb  libdyld.dylib (433.5) <9B2AC56D-107C-3541-A127-9094A751F2C9> /usr/lib/system/libdyld.dylib\r\n    0x7fff9fd68000 -     0x7fff9fd68ffb  libkeymgr.dylib (28) <7AA011A9-DC21-3488-BF73-3B5B14D1FDD6> /usr/lib/system/libkeymgr.dylib\r\n    0x7fff9fd69000 -     0x7fff9fd75fff  libkxld.dylib (3789.70.16) <BD02EF3F-6E09-3A64-AB21-553D5B1D2859> /usr/lib/system/libkxld.dylib\r\n    0x7fff9fd76000 -     0x7fff9fd76fff  liblaunch.dylib (972.70.1) <B856ABD2-896E-3DE0-B2C8-146A6AF8E2A7> /usr/lib/system/liblaunch.dylib\r\n    0x7fff9fd77000 -     0x7fff9fd7cff3  libmacho.dylib (898) <17D5D855-F6C3-3B04-B680-E9BF02EF8AED> /usr/lib/system/libmacho.dylib\r\n    0x7fff9fd7d000 -     0x7fff9fd7fff3  libquarantine.dylib (85.50.1) <12448CC2-378E-35F3-BE33-9DC395A5B970> /usr/lib/system/libquarantine.dylib\r\n    0x7fff9fd80000 -     0x7fff9fd81ffb  libremovefile.dylib (45) <38D4CB9C-10CD-30D3-8B7B-A515EC75FE85> /usr/lib/system/libremovefile.dylib\r\n    0x7fff9fd82000 -     0x7fff9fd9aff7  libsystem_asl.dylib (349.50.5) <096E4228-3B7C-30A6-8B13-EC909A64499A> /usr/lib/system/libsystem_asl.dylib\r\n    0x7fff9fd9b000 -     0x7fff9fd9bff7  libsystem_blocks.dylib (67) <10DC5404-73AB-35B3-A277-A8AFECB476EB> /usr/lib/system/libsystem_blocks.dylib\r\n    0x7fff9fd9c000 -     0x7fff9fe29fef  libsystem_c.dylib (1158.50.2) <E5AE5244-7D0C-36AC-8BB6-C7AE7EA52A4B> /usr/lib/system/libsystem_c.dylib\r\n    0x7fff9fe2a000 -     0x7fff9fe2dffb  libsystem_configuration.dylib (888.60.2) <BECC01A2-CA8D-31E6-BCDF-D452965FA976> /usr/lib/system/libsystem_configuration.dylib\r\n    0x7fff9fe2e000 -     0x7fff9fe31fff  libsystem_coreservices.dylib (41.4) <7D26DE79-B424-3450-85E1-F7FAB32714AB> /usr/lib/system/libsystem_coreservices.dylib\r\n    0x7fff9fe32000 -     0x7fff9fe4afff  libsystem_coretls.dylib (121.50.4) <EC6FCF07-DCFB-3A03-9CC9-6DD3709974C6> /usr/lib/system/libsystem_coretls.dylib\r\n    0x7fff9fe4b000 -     0x7fff9fe51fff  libsystem_dnssd.dylib (765.50.9) <CC960215-0B1B-3822-A13A-3DDE96FA796F> /usr/lib/system/libsystem_dnssd.dylib\r\n    0x7fff9fe52000 -     0x7fff9fe7bff7  libsystem_info.dylib (503.50.4) <611DB84C-BF70-3F92-8702-B9F28A900920> /usr/lib/system/libsystem_info.dylib\r\n    0x7fff9fe7c000 -     0x7fff9fe9eff7  libsystem_kernel.dylib (3789.70.16) <34B1F16C-BC9C-3C5F-9045-0CAE91CB5914> /usr/lib/system/libsystem_kernel.dylib\r\n    0x7fff9fe9f000 -     0x7fff9fee6fe7  libsystem_m.dylib (3121.6) <86D499B5-BBDC-3D3B-8A4E-97AE8E6672A4> /usr/lib/system/libsystem_m.dylib\r\n    0x7fff9fee7000 -     0x7fff9ff05ff7  libsystem_malloc.dylib (116.50.8) <A3D15F17-99A6-3367-8C7E-4280E8619C95> /usr/lib/system/libsystem_malloc.dylib\r\n    0x7fff9ff06000 -     0x7fff9ff5fffb  libsystem_network.dylib (856.60.1) <369D0221-56CA-3C3E-9EDE-94B41CAE77B7> /usr/lib/system/libsystem_network.dylib\r\n    0x7fff9ff60000 -     0x7fff9ff69ff3  libsystem_networkextension.dylib (563.60.2) <B021F2B3-8A75-3633-ABB0-FC012B8E9B0C> /usr/lib/system/libsystem_networkextension.dylib\r\n    0x7fff9ff6a000 -     0x7fff9ff73ff3  libsystem_notify.dylib (165.20.1) <B8160190-A069-3B3A-BDF6-2AA408221FAE> /usr/lib/system/libsystem_notify.dylib\r\n    0x7fff9ff74000 -     0x7fff9ff7cfe7  libsystem_platform.dylib (126.50.8) <897462FD-B318-321B-A554-E61982630F7E> /usr/lib/system/libsystem_platform.dylib\r\n    0x7fff9ff7d000 -     0x7fff9ff87ff7  libsystem_pthread.dylib (218.60.3) <B8FB5E20-3295-39E2-B5EB-B464D1D4B104> /usr/lib/system/libsystem_pthread.dylib\r\n    0x7fff9ff88000 -     0x7fff9ff8bff7  libsystem_sandbox.dylib (592.70.1) <4B92EC49-ACD0-36AE-B07A-A2B8152EAF9D> /usr/lib/system/libsystem_sandbox.dylib\r\n    0x7fff9ff8c000 -     0x7fff9ff8dff3  libsystem_secinit.dylib (24.50.4) <F78B847B-3565-3E4B-98A6-F7AD40392E2D> /usr/lib/system/libsystem_secinit.dylib\r\n    0x7fff9ff8e000 -     0x7fff9ff95ffb  libsystem_symptoms.dylib (532.50.47) <3390E07C-C1CE-348F-ADBD-2C5440B45EAA> /usr/lib/system/libsystem_symptoms.dylib\r\n    0x7fff9ff96000 -     0x7fff9ffa9ff7  libsystem_trace.dylib (518.70.1) <AC63A7FE-50D9-3A30-96E6-F6B7FF16E465> /usr/lib/system/libsystem_trace.dylib\r\n    0x7fff9ffaa000 -     0x7fff9ffafffb  libunwind.dylib (35.3) <3D50D8A8-C460-334D-A519-2DA841102C6B> /usr/lib/system/libunwind.dylib\r\n    0x7fff9ffb0000 -     0x7fff9ffd9ff7  libxpc.dylib (972.70.1) <BF896DF0-D8E9-31A8-A4B3-01120BFEEE52> /usr/lib/system/libxpc.dylib\r\n\r\nExternal Modification Summary:\r\n  Calls made by other processes targeting this process:\r\n    task_for_pid: 0\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n  Calls made by this process:\r\n    task_for_pid: 0\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n  Calls made by all processes on this machine:\r\n    task_for_pid: 406619\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n\r\nVM Region Summary:\r\nReadOnly portion of Libraries: Total=417.5M resident=0K(0%) swapped_out_or_unallocated=417.5M(100%)\r\nWritable regions: Total=554.0M written=0K(0%) resident=0K(0%) swapped_out=0K(0%) unallocated=554.0M(100%)\r\n \r\n                                VIRTUAL   REGION \r\nREGION TYPE                        SIZE    COUNT (non-coalesced) \r\n===========                     =======  ======= \r\nAccelerate framework               256K        3 \r\nActivity Tracing                   256K        2 \r\nCG backing stores                 2272K        4 \r\nCG image                            28K        4 \r\nCoreAnimation                       52K        7 \r\nCoreUI image data                 1412K       12 \r\nCoreUI image file                  184K        5 \r\nDispatch continuations            16.0M        2 \r\nFoundation                           4K        2 \r\nIOKit                             1708K       15 \r\nImage IO                            76K        2 \r\nKernel Alloc Once                    8K        2 \r\nMALLOC                           131.6M       37 \r\nMALLOC guard page                   48K       10 \r\nMach message (reserved)              4K        2         reserved VM address space (unallocated)\r\nMemory Tag 242                      12K        2 \r\nMemory Tag 251                      24K        2 \r\nSTACK GUARD                       56.1M       37 \r\nStack                            193.3M       75 \r\nVM_ALLOCATE                         44K        7 \r\n__DATA                            36.8M      282 \r\n__GLSLBUILTINS                    2588K        2 \r\n__IMAGE                            528K        2 \r\n__LINKEDIT                       117.3M       12 \r\n__TEXT                           300.2M      281 \r\n__UNICODE                          556K        2 \r\nmapped file                       73.3M       23 \r\nshared memory                    206.9M       28 \r\n===========                     =======  ======= \r\nTOTAL                              1.1G      836 \r\nTOTAL, minus reserved VM space     1.1G      836 \r\n````"},{"labels":["bug"],"text":"I manage to find this very specific bug while building [Puppetron](https://github.com/cheeaun/puppetron) and couldn't figure out where the bug is.\r\n\r\nHere's a testcase script:\r\n\r\n``` js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage();\r\n  await page.setRequestInterceptionEnabled(true);\r\n  page.on('request', (request) => {\r\n    console.log(`Intercepting: ${request.method} ${request.url}`);\r\n    request.continue();\r\n  });\r\n  await page.goto('http://apple.com/');\r\n  await page.screenshot({path: 'test.png'});\r\n  browser.close();\r\n})();\r\n```\r\n\r\nLog output:\r\n\r\n```\r\n$ node test.js\r\nIntercepting: GET http://apple.com/\r\nIntercepting: GET http://www.apple.com/\r\nIntercepting: GET https://www.apple.com/\r\nIntercepting: GET https://www.apple.com/ac/globalnav/3/en_US/styles/ac-globalnav.built.css\r\nIntercepting: GET https://www.apple.com/ac/localnav/3.0/styles/ac-localnav.built.css\r\nIntercepting: GET https://www.apple.com/ac/globalfooter/3/en_US/styles/ac-globalfooter.built.css\r\nIntercepting: GET https://www.apple.com/ac/localeswitcher/1/styles/localeswitcher.built.css\r\nIntercepting: GET https://images.apple.com/v/home/dj/built/styles/main.built.css\r\nIntercepting: GET https://images.apple.com/v/home/dj/built/scripts/head.built.js\r\nIntercepting: GET https://www.apple.com/ac/globalnav/3/en_US/scripts/ac-globalnav.built.js\r\nIntercepting: GET https://www.apple.com/metrics/ac-analytics/2.1/scripts/ac-analytics.js\r\nIntercepting: GET https://www.apple.com/metrics/ac-analytics/2.1/scripts/auto-init.js\r\nIntercepting: GET https://www.apple.com/ac/globalfooter/3/en_US/scripts/ac-globalfooter.built.js\r\nIntercepting: GET https://www.apple.com/ac/localeswitcher/1/scripts/localeswitcher.built.js\r\nIntercepting: GET https://images.apple.com/v/home/dj/built/scripts/main.built.js\r\n(node:31041) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): Error: Navigation Timeout Exceeded: 30000ms exceeded\r\n(node:31041) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\n```\r\n\r\nNotes:\r\n\r\n- So far I only know `apple.com` is affected.\r\n- This only happens when `setRequestInterceptionEnabled` is set to `true`.\r\n- I've tried running this with `headless: false` and even pass in `--auto-open-devtools-for-tabs` args to inspect stuff but couldn't figure out what's happening\r\n- I've also tried running with `DEBUG=*` and couldn't find anything weird. I suspected that it might be similar to #539 but there were no `OPTIONS` call.\r\n\r\nThanks!"},{"labels":["bug"],"text":"Hi!\r\n\r\nI'm trying to load an Angular page that requests data via XHR, but the loading is always interrupted due to a hanging `OPTIONS` request. This only happens when request interception is enabled, even though the handler always continues the requests, e.g. `page.on('request', request => request.continue())`.\r\n\r\nYou can see the example URL below (not mine): http://www.mybkr.com/shop/#/productdetail/303/SPIKED_JET_500_ML\r\n\r\n```js\r\nconst page = await browser.newPage();\r\n\r\npage.on('request', request => {\r\n  console.log(`Intercepting: ${request.method} ${request.url}`);\r\n  request.continue();\r\n});\r\n\r\npage.on('response', response => console.log(`Response: ${response.method} ${response.url}`));\r\n\r\nawait page.setRequestInterceptionEnabled(true);\r\nawait page.goto('http://www.mybkr.com/shop/#/productdetail/303/SPIKED_JET_500_ML', { waitUntil: 'networkidle' });\r\nawait page.close();\r\n```\r\n\r\nAnd this is the console output for the hanging request. No more requests are performed/intercepted afterwards:\r\n\r\n```text\r\nIntercepting: OPTIONS https://www.mybkr.com/mybkr-ws/services/generic/getAllObjectByQueryId?queryId=get_google_tracking_listing\r\npuppeteer:request request.continue()\r\npuppeteer:session SEND ► {\"id\":37,\"method\":\"Network.continueInterceptedRequest\",\"params\":{\"interceptionId\":\"id-25\"}}\r\npuppeteer:protocol SEND ► {\"id\":39,\"method\":\"Target.sendMessageToTarget\",\"params\":{\"sessionId\":\"81d4caf4-0446-4f7a-b121-2d3b7b334763:1\",\"message\":\"{\\\"id\\\":37,\\\"method\\\":\\\"Network.continueInterceptedRequest\\\",\\\"params\\\":{\\\"interceptionId\\\":\\\"id-25\\\"}}\"}}\r\npuppeteer:protocol ◀ RECV {\"id\":39,\"result\":{}}\r\npuppeteer:protocol ◀ RECV {\"method\":\"Target.receivedMessageFromTarget\",\"params\":{\"sessionId\":\"81d4caf4-0446-4f7a-b121-2d3b7b334763:1\",\"message\":\"{\\\"id\\\":37,\\\"result\\\":{}}\",\"targetId\":\"81d4caf4-0446-4f7a-b121-2d3b7b334763\"}}\r\npuppeteer:session ◀ RECV {\"id\":37,\"result\":{}}\r\npuppeteer:protocol ◀ RECV {\"method\":\"Target.receivedMessageFromTarget\",\"params\":{\"sessionId\":\"81d4caf4-0446-4f7a-b121-2d3b7b334763:1\",\"message\":\"{\\\"method\\\":\\\"Network.requestIntercepted\\\",\\\"params\\\":{\\\"interceptionId\\\":\\\"id-26\\\",\\\"request\\\":{\\\"url\\\":\\\"https://www.mybkr.com/mybkr-ws/services/generic/getAllObjectByQueryId?queryId=get_google_tracking_listing\\\",\\\"method\\\":\\\"GET\\\",\\\"headers\\\":{\\\"Accept\\\":\\\"application/json, text/javascript, */*; q=0.01\\\",\\\"Origin\\\":\\\"http://www.mybkr.com\\\",\\\"X-DevTools-Emulate-Network-Conditions-Client-Id\\\":\\\"81d4caf4-0446-4f7a-b121-2d3b7b334763\\\",\\\"User-Agent\\\":\\\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3193.0 Safari/537.36\\\",\\\"Content-Type\\\":\\\"application/json; charset=utf-8\\\"},\\\"initialPriority\\\":\\\"VeryHigh\\\",\\\"referrerPolicy\\\":\\\"no-referrer-when-downgrade\\\"},\\\"resourceType\\\":\\\"XHR\\\",\\\"isNavigationRequest\\\":false}}\",\"targetId\":\"81d4caf4-0446-4f7a-b121-2d3b7b334763\"}}\r\npuppeteer:session ◀ RECV {\"method\":\"Network.requestIntercepted\",\"params\":{\"interceptionId\":\"id-26\",\"request\":{\"url\":\"https://www.mybkr.com/mybkr-ws/services/generic/getAllObjectByQueryId?queryId=get_google_tracking_listing\",\"method\":\"GET\",\"headers\":{\"Accept\":\"application/json, text/javascript, */*; q=0.01\",\"Origin\":\"http://www.mybkr.com\",\"X-DevTools-Emulate-Network-Conditions-Client-Id\":\"81d4caf4-0446-4f7a-b121-2d3b7b334763\",\"User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3193.0 Safari/537.36\",\"Content-Type\":\"application/json; charset=utf-8\"},\"initialPriority\":\"VeryHigh\",\"referrerPolicy\":\"no-referrer-when-downgrade\"},\"resourceType\":\"XHR\",\"isNavigationRequest\":false}}\r\nError: Navigation Timeout Exceeded: 30000ms exceeded\r\n    at NavigatorWatcher.waitForNavigation (/Users/rodrigo/Git/Headless/node_modules/puppeteer/lib/NavigatorWatcher.js:74:13)\r\n    at <anonymous>\r\n```\r\n\r\nThanks!"},{"labels":["bug"],"text":"The package uses `Object.entries` which is not implemented in nodejs 6.x (tested with 6.11.1)."},{"labels":["bug"],"text":"\r\nLaunching with args:\r\n```js\r\n\tconst browser = await puppeteer.launch({\r\n\t  headless: false,\r\n\t  args: ['--user-data-dir=/pathtoprofile/'],\r\n\t});\r\n```\r\nWill override some files and removes all extensions from the chrome profile + alerts for \"settings corrupted\" at chrome://settings screen.\r\n"},{"labels":["bug"],"text":"The following example reloads the `example.com` a few times.\r\nFor some reason, all the responses have status 200. If there was a caching, the responses would have status 304. \r\n\r\n```js\r\nconst puppeteer = require('.');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch({headless: false});\r\n  const page = await browser.newPage();\r\n  await page.goto('https://example.com/');\r\n\r\n  page.on('response', r => console.log(r.status + ' ' + r.url));\r\n  await page.reload();\r\n  await page.reload();\r\n  await page.reload();\r\n  browser.close();\r\n})();\r\n```\r\n\r\nThis was initially reported in #446."},{"labels":["bug"],"text":"I'm experiencing tab crashes while writing some automated screenshot scripts using Puppeteer.\r\n\r\nI've attached three different crash dumps in hopes that it will be useful to the team in the future.\r\n\r\nThe page which is crashing has a lot of canvas drawn [Highcharts](https://www.highcharts.com/) with a high volume of data being plotted.\r\n\r\nThe page in question loads just fine in Google Chrome Version 61.0.3163.49 (Official Build) beta (64-bit)\r\n\r\n\r\n[Chromium Crash Dumps.zip](https://github.com/GoogleChrome/puppeteer/files/1243243/Chromium.Crash.Dumps.zip)\r\n"},{"labels":[null,"bug",null],"text":"when I try to take a screenshot of a simple website, but in a large resolution the bottom part of the website doesn't look like it's being drawn.\r\nYou can see an example of a 6000x6000px website here: ![output](https://user-images.githubusercontent.com/243098/29582903-b1056b62-877e-11e7-8885-aeb56cf240f2.png)\r\n\r\nI've tried loading contents from disk, from a remote server, using the setContent function, going slowMo, waiting on events, focusing on different elements, disable-gpu, headless true and false (one time it succeeded properly with headless:false) etc, still with the same result (which gets worse the higher the resolution_\r\n\r\n```js\r\n        const browser = await puppeteer.launch({slowMo: 500, headless: false, args: ['--disable-gpu', '--cast-initial-screen-width=6000', '--cast-initial-screen-height=6000']});\r\n\tconst page = await browser.newPage();\r\n\tawait page.setViewport({width: 6000, height: 6000})\r\n\t//await page.goto('file:///index_test.html', {waitUntil: 'networkidle'});\r\n\tawait page.goto('http:///localhost:8000/index_test.html', {waitUntil: 'load'});\r\n  //await page.setContent(template)\r\n\t//await buffer = page.screenshot({path: 'example.jpg', type: 'jpeg', quality: 100, fullPage: true});\r\n\tconst buffer = await page.screenshot({type: 'png'});\r\n\tconsole.log('length:', buffer.length);\r\n\tawait fs.writeFile('output.png', buffer);\r\n\r\n\tbrowser.close();\r\n```"},{"labels":["bug"],"text":"The following code is giving me issues: (Explanation below)\r\n\r\n```js\r\n// My tests contain about 30 pages I want to test in parallel\r\nconst aBunchOfUrls = [\r\n  {\r\n    desc: 'Name of test #1',\r\n    url: SOME_URL,\r\n  },\r\n  {\r\n    desc: 'Name of test #2',\r\n    url: ANOTHER_URL,\r\n  },\r\n  // ... snip ...\r\n];\r\n\r\nconst browserPromise = puppeteer.launch();\r\n\r\n// These test pass! And rather quickly. Slowest link is the backend server.\r\n// They're running concurrently, generating a new page within the same browser instance\r\ndescribe('Generate about 20 parallel page tests', () => {\r\n  aBunchOfUrls.forEach((testObj, idx) => {\r\n    it.concurrent(testObj.desc, async () => {\r\n      const browser = await browserPromise;\r\n      const page = await browser.newPage();\r\n\r\n      await page.goto(testObj.url, { waitUntil: 'networkidle' });\r\n      await page.waitForSelector('#content');\r\n\r\n      // assert things..\r\n    });\r\n  });\r\n});\r\n\r\n// This test will cause `waitForSelector` to time out, but, as the logging shows, the classnames are\r\n// present in the document at the time of timeout\r\ndescribe('Another test that times out =(', () => {\r\n  it('Shouldnt time out', async () => {\r\n    const browser = await browserPromise;\r\n    const page = await browser.newPage();\r\n\r\n    await page.goto(\r\n      ROOT_URL,\r\n      { waitUntil: 'networkidle' },\r\n    );\r\n\r\n    await page.waitForSelector('#content');\r\n\r\n    try {\r\n      const classNameBefore = await page.evaluate(() => {\r\n        return document.getElementById('global-loading-spinner').className;\r\n      });\r\n      console.log(`${classNameBefore}`); // Logs: \"global-loading-spinner\"\r\n\r\n      await page.waitForSelector('.hidden', { timeout: 10000 });\r\n    } catch (e) {\r\n      const classNameAfter = await page.evaluate(() => {\r\n        return document.getElementById('global-loading-spinner').className;\r\n      });\r\n\r\n      // The log statement below contains the classname we were waiting for!\r\n      console.log(`${classNameAfter}`); // Logs: \"global-loading-spinner hidden\"\r\n      throw e;\r\n    }\r\n\r\n    // Assert things..\r\n  });\r\n});\r\n```\r\n\r\nThe second test only times out (sporadically) after hammering the browser with concurrent page tests. Every time it times out, the `evaluate`/`log` combo shows the classname we're waiting for is present in the document.\r\n\r\nBefore I go and try to set up a replication app or anything, I wanted to see if there was any ideas on why this was happening.\r\n\r\nThanks much! I'll try to replicate in a sandbox if it helps."},{"labels":["bug"],"text":"On a windows machine, I am occasionally receiving an exception during the file cleanup process in Launcher.js on line 87 for version 0.9.0. This is causing the temp files to remain in their directories.\r\n\r\n`Error: EPERM: operation not permitted, unlink 'PROJECT_DIRECTORY\\node_modules\\puppeteer\\.dev_profile10\\CrashpadMetrics-active.pma'\r\n    at Object.fs.unlinkSync (fs.js:1066:18)\r\n    at fixWinEPERMSync (PROJECT_DIRECTORY\\node_modules\\rimraf\\rimraf.js:210:13)\r\n    at rimrafSync (PROJECT_DIRECTORY\\node_modules\\rimraf\\rimraf.js:310:28)\r\n    at PROJECT_DIRECTORY\\node_modules\\rimraf\\rimraf.js:341:5\r\n    at Array.forEach (native)\r\n    at rmkidsSync (PROJECT_DIRECTORY\\node_modules\\rimraf\\rimraf.js:340:26)\r\n    at rmdirSync (PROJECT_DIRECTORY\\node_modules\\rimraf\\rimraf.js:333:7)\r\n    at fixWinEPERMSync (PROJECT_DIRECTORY\\node_modules\\rimraf\\rimraf.js:208:5)\r\n    at rimrafSync (PROJECT_DIRECTORY\\node_modules\\rimraf\\rimraf.js:310:28)\r\n    at ChildProcess.__dirname.launch.chromeProcess.on (PROJECT_DIRECTORY\\node_modules\\puppeteer\\lib\\Launcher.js:87:7)`\r\n\r\nI was able to resolve this problem locally by changing line 17 to\r\n`const removeRecursive = require('rimraf');`\r\n\r\nand changing line 87 to \r\n`removeRecursive(userDataDir, (err) => {\r\n        if (err) { throw new Error(err); }\r\n      });`"},{"labels":["bug"],"text":"When set page size in css using `@page` like\r\n```\r\n  @page {\r\n    size: 50mm 50mm;\r\n  }\r\n```\r\n page.pdf still output default A4 size pdf"},{"labels":["bug"],"text":"I need to drag something on the screen. I was trying like this:\r\n```\r\n  const mouse = page.mouse\r\n  await mouse.move(x,y)\r\n  await mouse.down()\r\n  await mouse.move(x+400, y)\r\n  await mouse.up()\r\n```\r\nThe `down` and `up` work (if I move the mouse between the `down` and `up` events manually the map is being dragged) but the call to `move` between the `down` and `up` seems to get ignored. \r\n\r\nOr what am I missing?\r\n\r\nHere is a testcase where the images `1.png` and `2.png` should not look the same:\r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async () => {\r\n  const browser = await puppeteer.launch({\r\n    headless: true,\r\n  })\r\n\r\n  const page = await browser.newPage()\r\n  await page.setUserAgent('Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36')\r\n  await page.setViewport({width: 1200, height: 800, deviceScaleFactor: 1});\r\n\r\n  await page.goto('https://www.google.de/maps/@52.4889552,13.4707445,1555m/data=!3m1!1e3')\r\n  await page.waitForNavigation({waitUntil: 'networkidle'})\r\n\r\n  await page.screenshot({path: '1.png', fullPage: true})\r\n\r\n  const innerWidth = await page.evaluate(_ => {return window.innerWidth})\r\n  const innerHeight = await page.evaluate(_ => {return window.innerHeight})\r\n\r\n  const mouse = page.mouse\r\n  await mouse.move(innerWidth/2, innerHeight/2)\r\n  await mouse.down()\r\n  await mouse.move(innerWidth/2+200, innerHeight/2)\r\n  await mouse.up()\r\n  await page.waitForNavigation({waitUntil: 'networkidle'})\r\n\r\n  await page.screenshot({path: '2.png', fullPage: true})\r\n\r\n  browser.close()\r\n})()\r\n```"},{"labels":["bug"],"text":"Wndows 7 x64\r\nNode.js 8.4.0\r\npuppeteer 0.9.0\r\n\r\nThe examples for [`page.waitForSelector(selector[, options])`](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#pagewaitforselectorselector-options) and [`frame.waitForSelector(selector[, options])`](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#framewaitforselectorselector-options) fail.\r\n\r\nWithout `catch` of the `Promise`, they do not log any intended output, but emit Node.js warning:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\npuppeteer.launch().then(async browser => {\r\n  let page = await browser.newPage();\r\n  let currentURL;\r\n  page\r\n    .waitForSelector('img')\r\n    .then(() => console.log('First URL with image: ' + currentURL));\r\n  for (currentURL of ['https://example.com', 'https://google.com', 'https://bbc.com'])\r\n    await page.goto(currentURL);\r\n  browser.close();\r\n});\r\n```\r\n```console\r\n(node:5080) UnhandledPromiseRejectionWarning:\r\nUnhandled promise rejection (rejection id: 1):\r\nError: Protocol error (Runtime.evaluate): Cannot find context with specified id undefined\r\n(node:5080) [DEP0018] DeprecationWarning:\r\nUnhandled promise rejections are deprecated.\r\nIn the future, promise rejections that are not handled will terminate the Node.js process\r\nwith a non-zero exit code.\r\n```\r\nAlso very often they throw the same way as in the https://github.com/GoogleChrome/puppeteer/issues/298 after that.\r\n\r\nWith this `catch` they throw:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\npuppeteer.launch().then(async browser => {\r\n  let page = await browser.newPage();\r\n  let currentURL;\r\n  page\r\n    .waitForSelector('img')\r\n    .then(() => console.log('First URL with image: ' + currentURL))\r\n    .catch(err => { console.error(currentURL, err); });\r\n  for (currentURL of ['https://example.com', 'https://google.com', 'https://bbc.com'])\r\n    await page.goto(currentURL);\r\n  browser.close();\r\n});\r\n```\r\n```console\r\nhttps://google.com Error: Protocol error (Runtime.evaluate): Cannot find context with specified id undefined\r\n    at Session._onMessage (node_modules\\puppeteer\\lib\\Connection.js:197:25)\r\n    at Connection._onMessage (node_modules\\puppeteer\\lib\\Connection.js:98:19)\r\n    at emitOne (events.js:115:13)\r\n    at WebSocket.emit (events.js:210:7)\r\n    at Receiver._receiver.onmessage (node_modules\\ws\\lib\\WebSocket.js:143:47)\r\n    at Receiver.dataMessage (node_modules\\ws\\lib\\Receiver.js:389:14)\r\n    at Receiver.getData (node_modules\\ws\\lib\\Receiver.js:330:12)\r\n    at Receiver.startLoop (node_modules\\ws\\lib\\Receiver.js:165:16)\r\n    at Receiver.add (node_modules\\ws\\lib\\Receiver.js:139:10)\r\n    at Socket._ultron.on (node_modules\\ws\\lib\\WebSocket.js:139:22)\r\n```\r\nAnd as well very often they throw the same way as in the https://github.com/GoogleChrome/puppeteer/issues/298 after that."},{"labels":[null,"bug"],"text":"This is more of a question than an issue (but might escalate to the latter!).\r\n\r\nReturning a `Date` from an `.evaluate` context:\r\n\r\n```js\r\nvar puppeteer = require('puppeteer')\r\n\r\npuppeteer.launch().then(async browser => {\r\n  let page = await browser.newPage();\r\n  const data = await page.evaluate(() => {\r\n    return new Date(2017, 0, 1)\r\n  })\r\n\r\n  // data = {}\r\n\r\n  browser.close();\r\n});\r\n```\r\n\r\nI did not expect an \"empty\" object, but rather the `Date` object itself, milliseconds since epoch or the ISO8601 string."},{"labels":[null,"bug"],"text":"`npm install -g puppeteer` returns the following error: `Download failed: EACCES: permission denied, mkdir '/usr/local/lib/node_modules/puppeteer/.local-chromium'`\r\n\r\n\r\nIs this expected? I am using it as a dependency of a project I would like to install globally and this is blocking that."},{"labels":["bug"],"text":"npm install puppeteer\r\n\r\nDownload failed: EACCES: permission denied, mkdir '/usr/local/lib/node_modules/puppeteer/.local-chromium'\r\n\r\nCentOS  6\r\n"},{"labels":[null,"bug"],"text":"Here is my code. \r\n```\r\nconst puppeteer = require('puppeteer');\r\n\r\n\r\n(async() => {\r\n\r\nconst browser = await puppeteer.launch({executablePath:'chrome.exe'});\r\nconst page = await browser.newPage();\r\nawait page.setViewport({width:1024,height:768});\r\nawait page.goto('https://www.google.com' ,{waitUntil: 'networkidle'});\r\nawait page.screenshot({path: 'jd.png',fullPage:true});\r\n\r\nbrowser.close();\r\n})();\r\n````\r\nThe path of \"chrome.exe\" has been added to system environment variables. When I run it use the command \"node test.js\", it gives no output and just blocked . What's the problem?"},{"labels":["bug"],"text":"I'm running puppeteer with the latest node.js on the latest macOS Sierra. I wrote a script that uses puppeteer to scrape a web page with a URL parameter passed into process.argv. When I attempt to running multiple processes in parallel, I get the following error:\r\n\r\n```\r\n/usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:312\r\n        throw er\r\n        ^\r\n\r\nError: ENOTEMPTY: directory not empty, rmdir '/usr/local/lib/node_modules/puppeteer/.dev_profile1/Local Storage/leveldb'\r\n    at Object.fs.rmdirSync (fs.js:852:18)\r\n    at rmkidsSync (/usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:355:25)\r\n    at rmdirSync (/usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:333:7)\r\n    at rimrafSync (/usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:303:9)\r\n    at /usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:341:5\r\n    at Array.forEach (<anonymous>)\r\n    at rmkidsSync (/usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:340:26)\r\n    at rmdirSync (/usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:333:7)\r\n    at rimrafSync (/usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:303:9)\r\n    at /usr/local/lib/node_modules/puppeteer/node_modules/rimraf/rimraf.js:341:5\r\n```\r\n\r\nI do not get this error message when running each process sequentially. It looks like it's trying to clean out a temp folder, but each parallel process is trying to clean the same folder at the same time."},{"labels":["bug",null],"text":"I'm using puppeteer (previously was using pure CDP) to take screenshots from all the endpoints of my application and some pages that contain legal info and EULA are really tall. Like really tall:\r\n\r\n![image](https://user-images.githubusercontent.com/685012/29429858-7f967c66-8368-11e7-82e9-ae412cd48c0e.png)\r\n\r\nAnd the resulting screenshots are only 16384px high. When debugging the headless instance with devTools the page seems to be fully rendered.\r\n\r\nHere's the minimal snippet:\r\n\r\n``` js\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\nawait page.goto(url, {\r\n\twaitUntil: 'load'\r\n});\r\nawait page.setViewport({\r\n\twidth: size, // 320, 768, 1024, 1280\r\n\theight: 600\r\n});\r\nconst screenshot = await page.screenshot({\r\n\tfullPage: true\r\n});\r\nbrowser.close();\r\nfs.writeFileSync('./results/screenshot.png', screenshot);\r\n```\r\n\r\nSome of the tall pages screenshots result in a completely white screenshot. If I set the viewport using the `page.evaluate` method, it seems to work, but the height limit of 16384px still holds true.\r\n\r\n``` js\r\nconst browser = await puppeteer.launch();\r\nconst page = await browser.newPage();\r\nawait page.goto(url, {\r\n\twaitUntil: 'load'\r\n});\r\nawait page.setViewport({\r\n\twidth: size, // 320, 768, 1024, 1280\r\n\theight: 600\r\n});\r\nawait page.setViewport({\r\n\twidth: size,\r\n\theight: await page.evaluate(() => document.body.clientHeight)\r\n});\r\nconst screenshot = await page.screenshot();\r\nbrowser.close();\r\nfs.writeFileSync('./results/screenshot.png', screenshot);\r\n```\r\n\r\nBut regardless of the technique used, the screenshots' height are all capped to 16384px."},{"labels":[null,"bug"],"text":"scripts:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n(async () => {\r\n  const browser = await puppeteer.launch();\r\n  const page = await browser.newPage();\r\n  page.on('console', console.log);\r\n  await page.goto('https://google.com');\r\n  await page.evaluate(async () => {\r\n    console.log('1. abc');\r\n    console.log('2. ', this);\r\n    console.log('3. ', this.document.title);\r\n    console.log('4. ', this.window);\r\n  });\r\n  browser.close();\r\n})();\r\n```\r\n\r\noutput:\r\n```bash\r\n➜  headless node index.js\r\n1. abc\r\n3.  Google\r\n2.  Window\r\n4.  Window\r\n```"},{"labels":["bug",null],"text":"Trying to run the following code:\r\n\r\n```\r\nvar puppeteer = require(\"puppeteer\");\r\n\r\npuppeteer.launch().then(async browser => {\r\n    let page = await browser.newPage();\r\n    await page.goto('https://google.com');\r\n    await page.screenshot({ path: 'screenshot.png' });\r\n    browser.close();\r\n});\r\n```\r\n\r\nI got an error:\r\n\r\n`Error: EPERM: operation not permitted, unlink 'C:\\Users\\tivac\\Desktop\\puppeteer-testing\\node_modules\\puppeteer\\.dev_profile1\\CrashpadMetrics-active.pma'`\r\n\r\nIn the course of debugging this set `DEBUG=*` to try and understand where things were failing, but after doing that it then worked fine. 😕 \r\n\r\nDoes the first-run experience not quite work right in non-`DEBUG` modes? I'm not sure, but that's what happened for me!\r\n\r\n- `puppeteer@0.9.0`\r\n- `npm@5.3.0`\r\n- `node@8.2.1`\r\n- Windows 10 Version 1607 (OS Build 14393.1593)"},{"labels":["bug"],"text":"This seems to be a buffering issue: the stderr of the child_process is empty on windows unless the chromium is closed."},{"labels":["bug"],"text":"Upstream bug: https://bugs.chromium.org/p/chromium/issues/detail?id=755738\r\n\r\nThis results in sporadic chromium crashes in headless mode. \r\nRepro: running `examples/block-images.js` script crashes page."},{"labels":["bug"],"text":"In case of a chrome tab crash, the puppeteer doesn't report anything meaningful to the user.\r\nE.g. if the crash happens during the `page.goto` call, then the call will hang until the timeout is hit."},{"labels":["bug"],"text":"Two issues here that happen only with request interception enabled:\r\n1. Navigation to dataURL fails\r\n2. DataURL requests are not reported via the `request` event at all\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\n  let browser = await puppeteer.launch();\r\n  let page = await browser.newPage();\r\n  await page.setRequestInterceptionEnabled(true);\r\n  page.on('request', request => {\r\n    console.log(`${request.method}: ${request.url}`);\r\n    request.continue()\r\n  });\r\n  await page.goto('data:text/html,<div>hello!</div>');\r\n  browser.close();\r\n})();\r\n```"},{"labels":["bug"],"text":"For example, navigation to a url with hash gets stuck:\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n\r\n(async() => {\r\n  let browser = await puppeteer.launch();\r\n  let page = await browser.newPage();\r\n  await page.setRequestInterceptionEnabled(true);\r\n  page.on('request', request => request.continue());\r\n  await page.goto('https://example.com#test');\r\n  browser.close();\r\n})();\r\n```"},{"labels":[null,"bug",null],"text":"Since the hash-only navigation doesn't cause any network requests and doesn't cause load event, \r\nthe following gets stuck:\r\n\r\n```js\r\nconst puppeteer = require('puppeteer');\r\n(async() => {\r\n  let browser = await puppeteer.launch();\r\n  let page = await browser.newPage();\r\n  await page.goto('https://example.com');\r\n  await page.goto('https://example.com#ohh'); // <== stuck here\r\n  browser.close();\r\n})();\r\n\r\n```"},{"labels":["bug"],"text":"The `page.mouse.click()` might cause navigation, which results in underlying `mouse._doubleRaf` hack to never complete.\r\n\r\nFor example, consider the following unit test:\r\n```js\r\nit('should click links which cause navigation', SX(async function() {\r\n  await page.setContent(`<a href=\"${EMPTY_PAGE}\">empty.html</a>`);\r\n  // This await should not hang.\r\n  await page.click('a');\r\n}))\r\n```\r\n\r\nThe core issue is that `Runtime.evaluate({awaitPromise: true})` does not throw when the parent execution context gets destroyed. Instead, it throws after indefinite amount of time, as the promise eventually gets collected.\r\n\r\n@ak239 promised to check if this is something fixable in v8."},{"labels":["bug"],"text":"```js\r\n      await page.setViewport({\r\n        'width': 375,\r\n        'height': 667,\r\n        'deviceScaleFactor': 2,\r\n        'isMobile': true,\r\n        'hasTouch': true,\r\n        'isLandscape': false\r\n      });\r\n      await page.mouse.move(100, 100);\r\n      await page.mouse.down();\r\n      page.mouse.move(100, 10);\r\n      await page.mouse.up();\r\n```"},{"labels":["bug"],"text":"Wrote a simple script for DevTools and was surprised that it passed but the screenshot was blank:\r\n\r\n```javascript\r\nbrowser.newPage().then(async page => {\r\n    await page.navigate('chrome-devtools://devtools/bundled/inspector.html');\r\n    const screenshot = await page.screenshot({path: 'devtools.png'});\r\n    browser.close();\r\n});\r\n```\r\n\r\nUpon enabling debug logs I noticed this:\r\n```\r\npuppeteer:protocol ◀ SEND {\"id\":11,\"method\":\"Page.navigate\",\"params\":{\"url\":\"chrome-devtools://devtools/bundled/inspector.html\"}} +1ms\r\n  puppeteer:protocol RECV ► {\"method\":\"Page.frameStartedLoading\",\"params\":{\"frameId\":\"22595.1\"}} +2ms\r\n  puppeteer:protocol RECV ► {\"method\":\"Network.requestWillBeSent\",\"params\":{\"requestId\":\"22595.1\",\"loaderId\":\"22595.3\",\"documentURL\":\"chrome-devtools://devtools/bundled/inspector.html\",\"request\":{\"url\":\"chrome-devtools://devtools/bundled/inspector.html\",\"method\":\"GET\",\"headers\":{\"Upgrade-Insecure-Requests\":\"1\",\"User-Agent\":\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/62.0.3166.0 Safari/537.36\"},\"mixedContentType\":\"none\",\"initialPriority\":\"VeryHigh\",\"referrerPolicy\":\"no-referrer-when-downgrade\"},\"timestamp\":184194.055647,\"wallTime\":1501105892.30526,\"initiator\":{\"type\":\"other\"},\"type\":\"Document\",\"frameId\":\"22595.1\"}} +0ms\r\n  puppeteer:protocol RECV ► {\"id\":11,\"result\":{\"frameId\":\"22595.1\"}} +1ms\r\n  puppeteer:protocol RECV ► {\"method\":\"Network.loadingFailed\",\"params\":{\"requestId\":\"22595.1\",\"timestamp\":184194.056488,\"type\":\"Document\",\"errorText\":\"net::ERR_INVALID_URL\",\"canceled\":false}} +0ms\r\n```\r\nIf the main page you navigate to has `net::ERR_INVALID_URL`, I would expect Puppeteer to throw an error or at least log something. Granted, this is a special case, but I can see other people having a typo in their URL and being surprised that Puppeteer doesn't say anything like `WARNING: main page failed to load`."},{"labels":["bug"],"text":"The following script hangs for me waiting for \"click\" to happen on the second link.\r\nHowever, if I make viewport width 1000 instead of 300, the script works just fine.\r\n\r\n```js\r\nconst {Browser} = require('puppeteer');\r\nconst browser = new Browser({headless: false});\r\n\r\nbrowser.newPage().then(async page => {\r\n  page.on('load', () => {\r\n    console.log('LOADED: ' + page.url());\r\n  });\r\n  // Make width 1000 instead of 300 and the scripts works just fine\r\n  await page.setViewport({width: 300, height: 300}); \r\n  await page.navigate('https://google.com');\r\n  await page.waitFor('input[name=q]');\r\n  await page.focus('input[name=q]');\r\n  await page.type('blin');\r\n  await page.press('Enter');\r\n  for (let i = 0; i < 10; ++i) {\r\n    let searchResult = `div.g:nth-child(${i + 1}) h3 a`;\r\n    await page.waitFor(searchResult, {visible: true});\r\n    page.click(searchResult);\r\n    await page.waitForNavigation();\r\n\r\n    await page.screenshot({path: `screenshot-${i + 1}.png`});\r\n    await page.goBack();\r\n  }\r\n  browser.close();\r\n});\r\n```\r\n\r\nRunning the script with `DEBUG=*page node scrape.js` shows what's going on.\r\n\r\nLooks like we're clicking outside of viewport and the click turns out to be a noop.\r\n\r\n@JoelEinbinder, wdyt?"},{"labels":["bug"],"text":"Unit tests on mac are timeouting by the end of the session, no matter which test is the last.\r\n\r\nThis seems to be caused by https://bugs.chromium.org/p/chromium/issues/detail?id=741689\r\n\r\nFor now, the workaround is to re-start the browser during unit-testing once in a while. We should be able to remove the workaround once the upstream issue is fixed.\r\n"},{"labels":["bug"],"text":"```js\r\nconst {Browser} = new require('.');\r\nconst browser = new Browser({headless: true});\r\n\r\nbrowser.newPage().then(async page => {\r\n  await page.evaluate(() => window);\r\n  browser.close();\r\n});\r\n```\r\n\r\nThis code throws an error:\r\n```\r\nObject reference chain is too long\r\n```\r\n\r\nwhich happens because window is non-serializable."},{"labels":["bug"],"text":"Consider the following example, which takes 10 screenshots, each of a different `50px`x`50px` square.\r\n\r\n```js\r\nbrowser.newPage().then(async page => {\r\n    await page.navigate('http://example.com');\r\n    var promises = [];\r\n    for (var i = 0; i < 10; ++i) {\r\n        promises.push(page.screenshot({\r\n            path: i + '.png',\r\n            clip: {x: 50 * i, y: 0, width: 50, height: 50},\r\n        });\r\n    }\r\n    await Promise.all(promises);\r\n    browser.close();\r\n});\r\n```\r\nUnfortunately, this doesn't work - calls to `page.screenshot` interfere with each other, failing to clip proper rect. "}]