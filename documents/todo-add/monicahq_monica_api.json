[{"labels":["api",null],"text":"API docs say it is `PUT /contacts/:id/career`\r\n\r\nhttps://www.monicahq.com/api/contacts#update-a-contact-career\r\n\r\nbut it is actually `PUT /contacts/:id/work`\r\n\r\nhttps://github.com/monicahq/monica/blob/47ef3d75a72267098f2e5463bba6dacaf707bc2b/tests/Api/Contact/ApiContactControllerTest.php#L1438\r\n\r\n\r\n\r\n\r\n\r\n"},{"labels":["api"],"text":"v 2.16 updated from master on 01/06/2020.\r\n\r\nExisting Gift records are not displayed.\r\n\r\nThe following error message is displayed when attempting to add a new 'gift' record.\r\n\r\nWhoops! Something went wrong.\r\nKey path \"file:///var/www/monica/storage/oauth-public.key\" does not exist or is not readable\r\n\r\n"},{"labels":["api"],"text":"**Describe the bug**\r\nI tried to use the API endpoint `/api/contacts/:id/contactfields` in parallel (since it's a bit slow...) and I got an error:\r\n\r\n```\r\n500 Internal Server Error\r\n\r\nSQLSTATE[40001]: Serialization failure: 1213 Deadlock found when trying to get lock; try restarting transaction (SQL: delete from `cache` where `key` = laravel_cachea67d557b4725645ae52533f2330b47c3e249d758)\r\n```\r\n\r\nWell, when I try again, it usually works, but it's annoying to handle that in a script. Could you please property handle serialization failures in Monica?\r\n\r\nI'm running a local Monica instance (version 2.14.0). So you can be calm that I'm not DOSing your servers :)\r\n"},{"labels":["api",null],"text":"I'd like to sync the Monica contacts through the JSON API, but I don't see a way to upload a new avatar to Monica.\r\n"},{"labels":["api"],"text":"Since #2251 it's not possible to create or update these information with an API call:\r\n| job | string | The job title of the contact. Max 255 characters. |\r\n| company | string | The company which employs the contact. Max 255 characters. |\r\n| food_preferencies | string | The food preferencies of the contact. Max 100000 characters. |\r\n| first_met_information | string | The information (ie where and how) the user has met the contact. Max 1000000 characters. |\r\n| first_met_date | string | The date you first met the contact. Format: 'YYYY-MM-DD'. |\r\n| first_met_date_is_age_based | boolean | Indicates whether the first_met_date is age based or not. |\r\n| first_met_date_is_year_unknown | boolean | Indicates whether we know the year or not. |\r\n| first_met_date_age | integer | The number of years between the first_met_date and the current year. |\r\n| first_met_through_contact_id | integer | The contact whose made the introduction to this person. |\r\n| avatar_url | string | The URL of an external image that would serve as the avatar of the contact. Max 400 characters. |\r\n"},{"labels":["api",null],"text":"Currently the API documentation is only available as a set of webpages that can be [here](https://www.monicahq.com/api). A user who would like to build a client of the API needs to browse 27 different pages and manually collect the information needed to build the client. Publishing Swagger document makes it easier for developers to integrate Monica into their apps and the other way around. It will also make it easy to generate the API client for the mobile app once it's decided to be rebuilt.\r\n\r\nP.S.: I tried a bit with [DarkaOnLine/L5-Swagger](https://github.com/DarkaOnLine/L5-Swagger) to see if I can do it for the project, but it doesn't seem to be a one-step thing. It's giving me errors. I'm not a PHP dev, so most of the errors are Greek to me and could take me longer to figure out."},{"labels":["api"],"text":"Getting reminders via. API has an error in date formatting. \r\nAPI endpoint responds as below,\r\n\r\n```json\r\n{\r\n    \"message\": \"Unexpected data found.\\nUnexpected data found.\\nUnexpected data found.\\nData missing\"\r\n}\r\n```\r\n\r\n##### Important\r\n- Initially, I thought, the error is in my hosted version but tested on https://app.monicahq.com and it occurs there too.\r\n\r\n##### Steps to reproduce\r\n- Create `PersoalAccessToken` from https://app.monicahq.com/settings/api (or make sure you are able to access the API with other methods)\r\n- I am using **PersonalAccessToken**\r\n- Visit `api/reminders` endpoint with your accessToken.\r\n- You should get above error(If you have at least 1 reminder in future) I have just 1 reminder.\r\n- Try to access other resources e.g. `api/contacts`, that works perfectly.\r\n- A stack trace is attached to this issue. \r\n\r\n**Which version are you using:**\r\n - Hosting version 2.12.1 (app.monicahq.com)\r\n - My server-hosted version 2.12.0\r\n\r\n**Additional context**\r\n[monica-api-stacktrace.log](https://github.com/monicahq/monica/files/3028901/monica-api-stacktrace.log)\r\n\r\n"},{"labels":["api"],"text":"Hi!\r\n\r\nI've been excited about importing contact to Monica [since 2017](https://github.com/monicahq/monica/issues/658).\r\n\r\nMy concern is that bugs with the API keep popping up that make importing not work, and with a monthly release cycle, I'm very hopeful that each fix will be \"the one\" instead of unlocking a bug farther down the line.\r\n\r\nAs an example, [I found this bug in November](https://github.com/monicahq/monica/issues/2119\r\n), it was fixed in December and released in late December. That allowed some progress on importing contacts with tags, which [ran into this bug](https://github.com/monicahq/monica/issues/1951) that was fixed in January and is pending release.\r\n\r\nI know you're a small, amazingly devoted dev team, and we're not at all entitled to speed. However, since this is an important workflow (not just to me, but to at least @degan6 and [Lukas](https://github.com/monicahq/monica/issues/932)), it might be great to have a test verifying that the full API import flow works as part of your test coverage.\r\n\r\nThanks for considering, and for all your hard work!"},{"labels":["api"],"text":"**Is your feature request related to a problem? Please describe.**\r\n\r\nit is really hard to get behind the api. when coding in a type-save language it is hard to convert a received json into a usable object.\r\n\r\nfor example: https://app.quicktype.io?share=kwYLvUf0kZlJklI9hfmQ\r\n\r\nit gives me only half the truth of what is optional/nullable\r\n\r\n**Describe the solution you'd like**\r\nIt would be great to have the json schemas available from the api documentation\r\n"},{"labels":["api",null],"text":"I've written an API importer for my tags from a previous CRM, and noticed a strange behavior when getting ready to run it on my data.\r\n\r\nIn the API docs for Tags, it says setTags should not affect existing tags, simply add new ones if needed.\r\n\r\n<img width=\"434\" alt=\"personal crm - monica api documentation 2018-11-29 20-29-03\" src=\"https://user-images.githubusercontent.com/1626189/49268655-9240a200-f415-11e8-8b17-3a3463adf83f.png\">\r\n\r\nHowever, when calling setTags from the API, I observed different behavior. Here's an example before:\r\n\r\n![image](https://user-images.githubusercontent.com/1626189/49268684-be5c2300-f415-11e8-826f-ac1e9ee567b3.png)\r\n\r\nand after\r\n\r\n<img width=\"353\" alt=\"after_settags\" src=\"https://user-images.githubusercontent.com/1626189/49268690-c4520400-f415-11e8-8e13-5e6e72742a54.png\">\r\n\r\nNote that the latter two tags have disappeared.\r\n\r\nAdditionally, [in the relevant controller](https://github.com/monicahq/monica/blob/1f65b18a3c47b962fbc5b31eca93031ffeb85821/app/Http/Controllers/Api/ApiContactTagController.php), a comment in line 28 explicitly refers to detaching existing tags.\r\n\r\nPlease let me know when you have a chance to correct this behavior, so that I can run my importer nondestructively. Thanks for making such a great tool - I'm excited to have my full data in there!"},{"labels":["api",null],"text":"I'm trying to create a contact via the API on the hosted version at app.monicahq.com, following the documentation here: https://www.monicahq.com/api/contacts\r\n\r\nAccording to the docs, I can send `\"gender\" : \"male\"` to _POST /contacts_ but the API expects a _gender_id_ instead. Since there's no API to retrieve available gender IDs I don't know any valid value for this, so I cannot create a contact through the API.\r\n\r\nAlso, the API expects _is_starred_, which is not documented.\r\n\r\nAlso, the error messages for missing _gender_id_ and _is_starred_ are in Arabic."},{"labels":["api"],"text":""},{"labels":["api",null],"text":"We should create const in ApiController to list error codes\r\n```\r\n                    return $this->setHTTPStatusCode(400)\r\n                              ->setErrorCode(39)\r\n                              ->respondWithError(config('api.error_codes.39'));\r\n```\r\n"},{"labels":["api",null],"text":"It would be great if we could add a way to select a contact field and search for a match in that field with any contact.\r\n\r\nI want to use the API as a contact look when someone calls my voip phone but i need a way to check if their phone number is in Monica through the API."},{"labels":["api",null],"text":"It would be awesome to add a way to get users of a tag through the API."},{"labels":["api",null],"text":"I cannot connect to the API when running Monica locally through Docker. All requests are being redirect to `/login` (see below). I installed the key files with `php artisan passport:install` and was also able to generate a personal access token through the web gui.\r\n\r\nAll is working fine with the app.monicahq.com hosted version. (I realize there is a cookie being set in the hosted version also for api calls, in contrast to the local one. But I think the cookie is unrelated to this issue, since I can also connect to the hosted version without sending the cookie back.)\r\n\r\nResponse:\r\n```\r\nHTTP/1.1 302 Found\r\nDate: Sun, 31 Dec 2017 18:28:35 GMT\r\nServer: Apache/2.4.27 (Unix)\r\nX-Powered-By: PHP/7.1.9\r\nCache-Control: no-cache, private\r\nLocation: http://monica.xyz.com/login\r\nContent-Length: 376\r\nConnection: close\r\nContent-Type: text/html; charset=UTF-8\r\n\r\n<!DOCTYPE html>\r\n<html>\r\n    <head>\r\n        <meta charset=\"UTF-8\" />\r\n        <meta http-equiv=\"refresh\" content=\"0;url=http://monica.xyz.com/login\" />\r\n\r\n        <title>Redirecting to http://monica.xyz.com/login</title>\r\n    </head>\r\n    <body>\r\n        Redirecting to <a href=\"http://monica.xyz.com/login\">http://monica.xyz.com/login</a>.\r\n    </body>\r\n</html>\r\n```\r\n\r\nRequest:\r\n```\r\ncurl \"http://monica.xyz.com/api/contacts\" \\\r\n     -H 'Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjU5ZTA3NjBlM2FiNGZlMjNhYThlMGU3Yjg3NjA4MDc5MmM3MjJkMWRkZGMxNTQ0MDVkMjE2ZTI4YTBlODk4ZTYxNzdmNWY4MjhiNTI4MDM0In0.eyJhdWQiOiIxIiwianRpIjoiNTllMDc2MGUzYWI0ZmUyM2FhOGUwZTdiODc2MDgwNzkyYzcyMmQxZGRkYzE1NDQwNWQyMTZlMjhhMGU4OThlNjE3N2Y1ZjgyOGI1MjgwMzQrLCJpYXQiOjE1MTQ3MzMwMDYsIm5iZiI6MTUxNDczMzAwNiwiZXhwIjoxNTQ2MjY5MDA2LCJzdWIiOiIxIiwic2NvcGVzIjpbXX0.NZK397HKORi1lTAGjS2oV6AjPqgE2mrTbb6xwhj38EAs0rXa-ZEYEQS3ptAEelNXXt6hf5ts7ZWnh5UqfoAsESqwHZzVddIksMzgXN1BgDdKQGmWGAfkhS_CKMYsBtyqkpH8vrkpK0iIlNXmQ9-vuMjKGlEW8ynXec2DNQQyIJF1W_jlx3bipamIIrJC1s2CKOVFfjvYjiIKklETaMUctO-F37OgM5UTyl_4wp1eDvwtdHVyXXUj0HrMQzm00NLt0b19YSg9rQJeElvokAcg1mdvCtOh6lO230cpe_WKJITZ0UbGyzkL-q6jhBDTWvXVVNTVaoEQg7Sw0CaxBJwEQL4NcxgZ0bChX01LD4WfcIduYtEzHE3M4m1KaJaDo3RJlDUaFoPneckS41MASCil_v1pYY1aCLQb6lWlfu_NdF72qaF17ajRiVAq2RmYExW1YrPbZ-F5ZeGfiteLA5HUZ2QCVSFXlemGDlx-0acBtLZBISXLrxlLA6eQV-3EPbtf45izpW8UZmS3NyOMfAO7uxue7IQSCd9nJ3oP3BpDM64uh-3Ld8BBRt038WiPe4kON3f7yy2VW-Lg_vDl3B0ew3AmyJ5qPeps2yKAwIGjuzZYOpFIJgDAZhjRqhMJ_osdR9SswQhCa_mN1qrZs8VNpPL39ktXEhf3_k_PBHpX7EQ'\r\n```"},{"labels":["api",null],"text":"We've recently added the pets management. We don't have an API for that yet."},{"labels":["api",null],"text":"In 1.4 we've added the journal entries table. But we have no API methods for it."},{"labels":["api",null],"text":"I was able to import 2,000+ contacts from my old system using the API, so am very happy with the API overall so far. The big stumbling block for me is a lack of an easy helper method to add a Tag to a Contact, even if I have the Tag.id already. Though I might be incorrect, right now it looks like I'd have to GET the Contact, add the exact right JSON for the Tag(s), and PUT it back.\r\n\r\nThanks for considering!"},{"labels":["api",null],"text":"This issue serves the purpose of tracking the progress of the API development. I haven't found anything on this yet other than it needs to be done for mobile apps, so I figured we could track or even discuss its implementation here. I'm eagerly looking forward to contributing to the iOS version of the mobile app, so this is an issue I will be watching very closely."}]