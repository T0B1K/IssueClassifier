[{"labels":["bug"],"text":"Steps to reproduce:\r\n1) remove permissions from Public for all statuses but published.\r\n<img width=\"675\" alt=\"Screen Shot 2020-08-25 at 10 14 03 PM\" src=\"https://user-images.githubusercontent.com/64104626/91218776-3dcd7200-e722-11ea-991b-b29d72f46417.png\">\r\n\r\n2) Do a filter request like this using Public permissions :\r\n`GET items/posts?meta=*&filter[excerpt][like]=vuedraggable&filter[post_category.name][like]=somethingthatwillfail&filter[post_category.name][logical]=or`\r\n\r\nThe bug has something to do with logical OR.  If you remove this last one, (which actually makes no sense), it starts to work correctly.\r\n\r\n3) Result include deleted & drafted posts, although Public should not have access to them:\r\n<img width=\"1440\" alt=\"Screen Shot 2020-08-25 at 11 17 14 PM\" src=\"https://user-images.githubusercontent.com/64104626/91223558-7de42300-e729-11ea-81e4-eaac0ca8afd8.png\">\r\n\r\n\r\n------\r\nVersion of Directus: 8.8.0\r\nOS: Ubuntu 18.04.4 LTS\r\nDB: mysql 5.7.31\r\n\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\n\r\nHello, and thank you for taking the time to notify the community of this issue. Please ensure you are on the latest version of Directus and be as detailed as possible so that we can resolve the problem efficiently, including...\r\n\r\n‚Ä¢¬†Version of Directus (must be the latest)\r\n‚Ä¢¬†Server, OS & Database Details\r\n‚Ä¢¬†Error Messages\r\n‚Ä¢¬†Steps to Reproduce\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\nüê∞\r\n\r\n-->\r\n\r\nI was trying to make another user. After reloading the page directus gave an error so I deleted the users in the DB by only keeping the Administrator user\r\n![image](https://user-images.githubusercontent.com/31823687/89742442-4e32eb00-da9a-11ea-9272-a6b4aff1250a.png)\r\n\r\nNow I can't login any more because he gives the error:\r\n`Call to a member function toArray() on null in /www/directus/src/helpers/all.php:398`\r\n\r\nAnyone can help me with this?"},{"labels":["bug"],"text":"‚Ä¢¬†Version of Directus: 8.8.0\r\n‚Ä¢¬†Server, OS & Database Details: Docker/Localhost, MacOS, Mysql 5.7\r\n‚Ä¢¬†Error Messages: Failed generating the SQL query. and error Code 9\r\n‚Ä¢¬†Steps to Reproduce\r\nFollow the instructions to create a translated article: https://docs.directus.io/guides/relationships.html#translations, then add an article. Initial creation works with all translations, but leaving one out initially and adding that later, fails. Also Updating already created translations seem to fail.\r\n\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n<img width=\"1256\" alt=\"Screenshot 2020-08-05 at 10 34 38\" src=\"https://user-images.githubusercontent.com/452171/89390683-5d671100-d707-11ea-88c9-cd96e3570e30.png\">\r\n\r\nHere you can see my Collections\r\n\r\n<img width=\"675\" alt=\"Screenshot 2020-08-05 at 10 35 47\" src=\"https://user-images.githubusercontent.com/452171/89390889-b5057c80-d707-11ea-9ea8-5d9ecc71e171.png\">\r\n<img width=\"651\" alt=\"Screenshot 2020-08-05 at 10 35 56\" src=\"https://user-images.githubusercontent.com/452171/89390914-c058a800-d707-11ea-8934-5e7813b96dd5.png\">\r\n<img width=\"693\" alt=\"Screenshot 2020-08-05 at 10 36 05\" src=\"https://user-images.githubusercontent.com/452171/89390921-c3539880-d707-11ea-9339-eadd35401bbf.png\">\r\n<img width=\"665\" alt=\"Screenshot 2020-08-05 at 10 36 20\" src=\"https://user-images.githubusercontent.com/452171/89390926-c51d5c00-d707-11ea-8c5d-385932ad3b05.png\">\r\n\r\n`172.19.0.1 - - [05/Aug/2020:08:39:25 +0000] \"GET /_/items/article_translations?filter[article][eq]=2 HTTP/1.1\" 200 849 \"http://localhost:8080/admin/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:78.0) Gecko/20100101 Firefox/78.0\"\r\n172.19.0.1 - - [05/Aug/2020:08:39:25 +0000] \"GET /_/activity?filter[collection][eq]=articles&filter[item][eq]=2&fields=id%2Caction%2Caction_on%2Ccomment%2Caction_by.id%2Caction_by.first_name%2Caction_by.last_name&sort=-action_on HTTP/1.1\" 200 583 \"http://localhost:8080/admin/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:78.0) Gecko/20100101 Firefox/78.0\"\r\n172.19.0.1 - - [05/Aug/2020:08:39:26 +0000] \"GET /server/ping HTTP/1.1\" 200 444 \"http://localhost:8080/admin/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:78.0) Gecko/20100101 Firefox/78.0\"\r\n172.19.0.1 - - [05/Aug/2020:08:39:35 +0000] \"GET /_/users/1?fields[0]=avatar.data.thumbnails&fields[1]=first_name&fields[2]=last_name&fields[3]=title&fields[4]=company&fields[5]=role.name HTTP/1.1\" 200 559 \"http://localhost:8080/admin/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:78.0) Gecko/20100101 Firefox/78.0\"\r\n[2020-08-05 08:39:36] api[_].ERROR: Directus\\Database\\Exception\\InvalidQueryException: Failed generating the SQL query. in /var/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php:840\r\nStack trace:\r\n#0 /var/directus/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\n#1 /var/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php(434): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\n#2 /var/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php(363): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\n#3 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(199): Directus\\Database\\TableGateway\\BaseTableGateway->addOrUpdateRecordByArray\r\n#4 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(706): Directus\\Database\\TableGateway\\RelationalTableGateway->manageRecordUpdate\r\n#5 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(522): Directus\\Database\\TableGateway\\RelationalTableGateway->addOrUpdateToManyRelationships\r\n#6 /var/directus/src/core/Directus/Services/ItemsService.php(364): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\n#7 /var/directus/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\n#8 [internal function]: Directus\\Api\\Routes\\Items->update\r\n#9 /var/directus/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#10 /var/directus/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#11 /var/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#12 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#13 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#14 [internal function]: Slim\\DeferredCallable->__invoke\r\n#15 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#16 /var/directus/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(124): Slim\\Route->Slim\\{closure}\r\n#17 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#18 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#19 [internal function]: Slim\\DeferredCallable->__invoke\r\n#20 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#21 /var/directus/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#22 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#23 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#24 [internal function]: Slim\\DeferredCallable->__invoke\r\n#25 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#26 /var/directus/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\n#27 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\n#28 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#29 [internal function]: Slim\\DeferredCallable->__invoke\r\n#30 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#31 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#32 /var/directus/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#33 /var/directus/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#34 /var/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#35 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#36 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#37 [internal function]: Slim\\DeferredCallable->__invoke\r\n#38 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#39 /var/directus/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#40 /var/directus/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#41 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#42 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#43 [internal function]: Slim\\DeferredCallable->__invoke\r\n#44 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#45 /var/directus/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#46 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#47 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#48 [internal function]: Slim\\DeferredCallable->__invoke\r\n#49 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#50 /var/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\n#51 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#52 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#53 [internal function]: Slim\\DeferredCallable->__invoke\r\n#54 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#55 /var/directus/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(63): Slim\\App->Slim\\{closure}\r\n#56 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#57 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#58 [internal function]: Slim\\DeferredCallable->__invoke\r\n#59 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#60 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#61 /var/directus/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#62 /var/directus/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#63 /var/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#64 /var/directus/public/index.php(5): Directus\\Application\\Application->run [] []`"},{"labels":["bug"],"text":"Accidentally it turned out, that as a low-privileged user I am able to elevate my own role to admin.\r\n\r\n- Directus 8.8.0\r\nInstalled with one-click installation on DigitalOcean droplet along with:\r\n- Ubuntu 18.04\r\n- Apache 2.4\r\n- MySQL 5.7\r\n- PHP 7.2\r\n\r\nSteps to reproduce:\r\n\r\n**1.** As an admin user, I create a new role (called \"Test\") with default permissions (as below)\r\n\r\n![directus_step_01](https://user-images.githubusercontent.com/24698318/88906887-42eced80-d258-11ea-87d5-cec7527ff3bd.PNG)\r\n\r\n**2.** I want active users of \"Test\" role to be able to modify their own user profiles in regards to first_name and last_name only:\r\n\r\n![directus_step_02](https://user-images.githubusercontent.com/24698318/88907202-a9720b80-d258-11ea-838a-aacd65918c62.PNG)\r\n\r\n![directus_step_03](https://user-images.githubusercontent.com/24698318/88907233-b0008300-d258-11ea-9fbf-e0b1fd80b8ba.PNG)\r\n\r\nOf course, \"Test\" users permissions in regards to updating user profiles are set to \"mine\". \r\n\r\nHowever, I also don't want \"Test\" users to be able to modify **any** of given roles and permissions, so I'm disabling their access to related collections: \r\n\r\n![directus_step_03 1](https://user-images.githubusercontent.com/24698318/88908255-ec80ae80-d259-11ea-9cc4-15ef7c6b4f82.PNG)\r\n\r\n**3.** As permissions for the new role are set, I'm creating new \"Test User\" with role set to \"Test\"\r\n\r\n![directus_step_04](https://user-images.githubusercontent.com/24698318/88907544-0b327580-d259-11ea-9e32-9a9b9df8485e.PNG)\r\n\r\n**4.** Now I'm signing myself in as a newly created user and I'm trying to edit my own user profile:\r\n\r\n![directus_step_05](https://user-images.githubusercontent.com/24698318/88907816-5fd5f080-d259-11ea-9c31-5c4fd243b571.PNG)\r\n\r\nFor now everything looks like expected. I don't have permissions to edit my own role. I only have access to First Name and Last Name Fields (and, for some reason, for Timezone as well):\r\n\r\n![directus_step_05](https://user-images.githubusercontent.com/24698318/88908452-281b7880-d25a-11ea-85fb-6327a79d3917.PNG)\r\n\r\n**5.** BUT, besides GUI, there is also a RESTful API, that I can use. So let's try to sign in through it (as a test user of course).\r\n\r\nI'm now sending a POST request for <host>/<project>/auth/authenticate with payload of email and password. In response get my token and user data: \r\n\r\n`\r\n{\r\n    \"data\": {\r\n        \"token\": \"<token>\",\r\n        \"user\": {\r\n            \"id\": \"4\",\r\n            \"status\": \"active\",\r\n            \"role\": \"4\",\r\n            \"first_name\": \"Test\",\r\n            \"last_name\": \"User\",\r\n            \"email\": \"test@test.com\",\r\n            \"timezone\": \"Europe/Warsaw\",\r\n            \"locale\": \"en-US\",\r\n            \"locale_options\": null,\r\n            \"avatar\": null,\r\n            \"company\": null,\r\n            \"title\": null,\r\n            \"external_id\": \"<externalId>\",\r\n            \"theme\": \"auto\",\r\n            \"2fa_secret\": null,\r\n            \"password_reset_token\": null\r\n        }\r\n    },\r\n    \"public\": true\r\n}\r\n`\r\n\r\nNote that my role is set to 4 which is and id for my \"Test\" role.\r\n\r\n**6.** Now let's take my token and try to elevate my role through API.\r\n\r\nI'm now sending a PATCH request for [host]/[project]/users/4 along with the following payload: \r\n\r\n`{\r\n    \"role\": 1\r\n}`\r\n\r\nWhere 1 corresponds to built-in \"Admin\" role. \r\n\r\nI'm attaching my token in querystring, so the complete request URL looks like this: \r\n\r\n[host]/[project]/users/4?access_token=[access token taken from previous request]\r\n\r\nLet's send this request to the server... * puff *  and now let's take a look at the response:\r\n\r\n `\r\n{\r\n    \"data\": {\r\n        \"id\": 4,\r\n        \"status\": \"active\",\r\n        \"role\": 1,\r\n        \"first_name\": \"Test\",\r\n        \"last_name\": \"User\",\r\n        \"email\": \"test@test.com\",\r\n        \"token\": \"<token>\",\r\n        \"timezone\": \"Europe/Warsaw\",\r\n        \"locale\": \"en-US\",\r\n        \"locale_options\": null,\r\n        \"avatar\": null,\r\n        \"company\": null,\r\n        \"title\": null,\r\n        \"email_notifications\": true,\r\n        \"last_access_on\": \"2020-07-30 09:38:44\",\r\n        \"last_page\": \"/zpruszkowa/users/4\",\r\n        \"external_id\": \"<externalId>\",\r\n        \"theme\": \"auto\",\r\n        \"2fa_secret\": null,\r\n        \"password_reset_token\": null\r\n    }\r\n}\r\n`\r\n\r\nAs we can see, my new role is 1 which means, that I just elevated my permissions to Admin.\r\n\r\n**7.** Now let's go back to the Directus GUI and...\r\n\r\n![directus_step_06](https://user-images.githubusercontent.com/24698318/88910106-3e2a3880-d25c-11ea-8202-40d29256a32e.PNG)\r\n\r\nTadamm! \r\n\r\nMy test user is now an admin.\r\n\r\nI'm pretty sure that this isn't supposed to work this way. I want my users to be able to change their own personal data (like e-mail address) but I am not sure if I want to grant them a privilige to change their own role to admin. \r\n\r\n\r\n\r\n\r\n\r\n"},{"labels":["bug"],"text":"Hello Directus Team, \r\n\r\nHowever, I noticed that when using the Revisions endpoint to obtain a revision of a collection (https://docs.directus.io/api/revisions.html#the-revision-object), it doesn't return all the fields that are in that collection, it doesn't return any o2m fields, m2o fields, \r\n\r\n\r\n and it also doesn't return \"directus_files\" fields.\r\n\r\nExample; I have a collection named home that is structured as see in the screenshot.\r\n\r\nWhen making the request through the API (Javascript SDK) \r\n\r\n`    return client.api\r\n      .get('/revisions', {\r\n        filter: {\r\n          collection: {\r\n            eq: `home`\r\n          }\r\n        },\r\n        fields: ['*.*.*.*.*']`\r\n\r\n\r\nThe response is as shown in the second screenshot\r\n\r\nI believe this is a bug but I'm not 100% sure, (could somehow be expected behavior)\r\n\r\n‚Ä¢¬†Version 8.7.2\r\n\r\n<img width=\"439\" alt=\"Screen Shot 2020-06-24 at 11 02 03 PM\" src=\"https://user-images.githubusercontent.com/54296502/85664179-cbcba480-b66e-11ea-8420-d5e35b16bdb6.png\">\r\n<img width=\"369\" alt=\"Screen Shot 2020-06-24 at 11 00 30 PM\" src=\"https://user-images.githubusercontent.com/54296502/85664189-cec69500-b66e-11ea-90fb-50dce46ab6ee.png\">"},{"labels":["bug"],"text":"We have a few decimal fields on various collections, which were initially at length `10,0`. We'd like these to be changed to `10,6` but this does not always work as Directus sometimes raises an error message:\r\n<img width=\"382\" alt=\"Screenshot 2020-04-21 at 11 46 57\" src=\"https://user-images.githubusercontent.com/15915453/79878429-b2e41000-83ed-11ea-80a9-d224f5109637.png\">\r\nChecking the logs we see the following error trace:\r\n```\r\n[2020-04-21 09:46:55] api[_].ERROR: Directus\\Exception\\SQLException: SQLSTATE[22003]: Numeric value out of range: 1264 Out of range value for column 'actuals_usd_period__ex_admin' at row 8 in /var/directus/src/endpoints/Fields.php:122\r\nStack trace:\r\n#0 [internal function]: Directus\\Api\\Routes\\Fields->update\r\ndirectus/app#1 /var/directus/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\ndirectus/app#2 /var/directus/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#3 /var/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#4 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#5 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#6 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#7 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#8 /var/directus/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(124): Slim\\Route->Slim\\{closure}\r\ndirectus/app#9 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#10 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#11 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#12 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#13 /var/directus/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#14 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#15 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#16 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#17 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#18 /var/directus/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\ndirectus/app#19 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\ndirectus/app#20 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#21 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#22 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#23 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#24 /var/directus/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\ndirectus/app#25 /var/directus/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\ndirectus/app#26 /var/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#27 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#28 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#29 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#30 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#31 /var/directus/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#32 /var/directus/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#33 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#34 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#35 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#36 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#37 /var/directus/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#38 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#39 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#40 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#41 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#42 /var/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\ndirectus/app#43 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#44 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#45 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#46 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#47 /var/directus/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(63): Slim\\App->Slim\\{closure}\r\ndirectus/app#48 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#49 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#50 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#51 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#52 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#53 /var/directus/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\ndirectus/app#54 /var/directus/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\ndirectus/app#55 /var/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#56 /var/directus/public/index.php(5): Directus\\Application\\Application->run [] []\r\n``` \r\nI notice the `Out of range value for column 'actuals_usd_period__ex_admin'` message and checked our database schema directly:\r\n<img width=\"419\" alt=\"Screenshot 2020-04-21 at 12 22 16\" src=\"https://user-images.githubusercontent.com/15915453/79878676-fd658c80-83ed-11ea-9308-b4682e1cb390.png\">\r\nAs you can see the field in question, `actuals_usd_period__ex_admin` is at `10,0` length.\r\n\r\nAny assistance or advice on how to get around this error would be appreciated!"},{"labels":["bug"],"text":"<!--\r\n\r\nHello, and thank you for taking the time to notify the community of this issue. Please ensure you are on the latest version of Directus and be as detailed as possible so that we can resolve the problem efficiently, including...\r\n\r\n‚Ä¢¬†Version of Directus (must be the latest)\r\n‚Ä¢¬†Server, OS & Database Details\r\n‚Ä¢¬†Error Messages\r\n‚Ä¢¬†Steps to Reproduce\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\nüê∞\r\n\r\n-->\r\n\r\nDirectus 8.7.2\r\nUbuntu 18.04\r\nMariaDB 10.4.13\r\n\r\nChanging the name of the field \"published\" to for example \"active\" in a collection, will clear the entire collection.\r\n\r\n![image](https://user-images.githubusercontent.com/1741593/84576829-d9a04080-adb7-11ea-86b4-e6008fd5e9d5.png)\r\n\r\nHowever the data is still in the database."},{"labels":["bug"],"text":"**Version of DIrectus / Server, OS & Database Details**\r\nUsed https://demo.directus.io to reproduce\r\n\r\n**Error messages**\r\nNA\r\n\r\n**Steps to Reproduce**\r\n1. Login as the admin user on https://demo.directus.io\r\n\r\n2. Add a new status value option on a collection with status field (e.g. readytopublish on Customers).\r\n<img width=\"638\" alt=\"new_status1\" src=\"https://user-images.githubusercontent.com/1730684/84653493-6c9ac100-af05-11ea-93b1-8405496514dc.png\">\r\n<img width=\"622\" alt=\"new_status\" src=\"https://user-images.githubusercontent.com/1730684/84652958-6821d880-af04-11ea-8837-533af362ca56.png\">\r\n\r\n3. Create an item in that collection (e.g. a Customer) with the new status value.\r\n<img width=\"722\" alt=\"item_with_new_status\" src=\"https://user-images.githubusercontent.com/1730684/84653040-8ee00f00-af04-11ea-8c0e-e77facd06bb9.png\">\r\n\r\n4. Create a new role which doesn't have permission to items with the newly created status. (This could be skipped and just use an existing role that is not an admin).\r\n<img width=\"725\" alt=\"without_status_role\" src=\"https://user-images.githubusercontent.com/1730684/84653149-cb136f80-af04-11ea-845b-030c4cbc0437.png\">\r\n\r\n5. Create a new user or update an existing user to use the new role.\r\n<img width=\"716\" alt=\"user_with_role\" src=\"https://user-images.githubusercontent.com/1730684/84653240-f5fdc380-af04-11ea-869f-eb27cab88221.png\">\r\n\r\n6. Logout and login with the user in step 5.\r\n\r\n7. Making the following API request using the user logged in as in step 6.\r\n`https://demo.directus.io/thumper/items/customers?status=readytopublish`\r\n\r\n**Expected Results**\r\nNo items are returned.\r\n\r\n**Actual Results**\r\nAll items without that status are returned.\r\n<img width=\"1036\" alt=\"example_response\" src=\"https://user-images.githubusercontent.com/1730684/84653423-4b39d500-af05-11ea-82ee-b25142179b46.png\">\r\n\r\n\r\n\r\n"},{"labels":["bug"],"text":"Hi,\r\nif I want to edit files title, files description etc. inside the files interface, I'll get an error and can't save the changes.\r\n\r\ndirectus v8.7.2\r\n\r\n![Bildschirmfoto 2020-06-12 um 09 03 17](https://user-images.githubusercontent.com/25492962/84474976-0fe0a180-ac8c-11ea-93c5-6a60a6b6745d.png)\r\n\r\n![Bildschirmfoto 2020-06-12 um 09 03 31](https://user-images.githubusercontent.com/25492962/84474997-166f1900-ac8c-11ea-9198-5a4d54bf6253.png)\r\n\r\n![Bildschirmfoto 2020-06-12 um 09 03 50](https://user-images.githubusercontent.com/25492962/84475032-24bd3500-ac8c-11ea-994a-2ba9d1d6a53b.png)\r\n"},{"labels":["bug"],"text":"<!--\r\n\r\nHello, and thank you for taking the time to notify the community of this issue. Please ensure you are on the latest version of Directus and be as detailed as possible so that we can resolve the problem efficiently, including...\r\n\r\n‚Ä¢¬†Version of Directus (must be the latest)\r\n‚Ä¢¬†Server, OS & Database Details\r\n‚Ä¢¬†Error Messages\r\n‚Ä¢¬†Steps to Reproduce\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\nüê∞\r\n\r\n-->\r\n\r\n\r\nI have no idea if this is the right repo for this issue. I have a static token, I put it in the user in the database as explained in the docs, then when attempting to use it as `Authorization: Bearer token`, it does not check if the token is case sensitive or not. To reproduce, just use any token you want, and change a capital A for a small a, the check will pass and consider the token is correct.\r\n\r\nDon't know if this is the right behavior, but I just wanted to point it out.\r\n\r\nLatest version, Ubuntu.\r\n\r\nThanks!"},{"labels":["bug"],"text":"Hello, after updating Directus I've figured out that it's impossible to update translations data anymore from the interface of parent collection - the following error received:\r\n![image](https://user-images.githubusercontent.com/13006578/84209031-12bc7600-aa83-11ea-91a0-f4101cc3da2a.png)\r\nHowever when translation data updated directly from the translations collection the updated passing without any problem.\r\nThe error log giving the following stack trace:\r\n#0 /mnt/c/Projects/Directus/directus-api/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\n#1 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(434): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\n#2 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(363): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\n#3 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(199): Directus\\Database\\TableGateway\\BaseTableGateway->addOrUpdateRecordByArray\r\n#4 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(706): Directus\\Database\\TableGateway\\RelationalTableGateway->manageRecordUpdate\r\n#5 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(522): Directus\\Database\\TableGateway\\RelationalTableGateway->addOrUpdateToManyRelationships\r\n#6 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Services/ItemsService.php(364): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\n#7 /mnt/c/Projects/Directus/directus-api/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\n#8 [internal function]: Directus\\Api\\Routes\\Items->update\r\n#9 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#10 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#11 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#12 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#13 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#14 [internal function]: Slim\\DeferredCallable->__invoke\r\n#15 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#16 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(124): Slim\\Route->Slim\\{closure}\r\n#17 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#18 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#19 [internal function]: Slim\\DeferredCallable->__invoke\r\n#20 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#21 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#22 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#23 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#24 [internal function]: Slim\\DeferredCallable->__invoke\r\n#25 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#26 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\n#27 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\n#28 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#29 [internal function]: Slim\\DeferredCallable->__invoke\r\n#30 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#31 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#32 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#33 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#34 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#35 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#36 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#37 [internal function]: Slim\\DeferredCallable->__invoke\r\n#38 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#39 /mnt/c/Projects/Directus/directus-api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#40 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#41 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#42 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#43 [internal function]: Slim\\DeferredCallable->__invoke\r\n#44 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#45 /mnt/c/Projects/Directus/directus-api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#46 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#47 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#48 [internal function]: Slim\\DeferredCallable->__invoke\r\n#49 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#50 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\n#51 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#52 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#53 [internal function]: Slim\\DeferredCallable->__invoke\r\n#54 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#55 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(63): Slim\\App->Slim\\{closure}\r\n#56 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#57 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#58 [internal function]: Slim\\DeferredCallable->__invoke\r\n#59 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#60 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#61 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#62 /mnt/c/Projects/Directus/directus-api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#63 /mnt/c/Projects/Directus/directus-api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#64 /mnt/c/Projects/Directus/directus-api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n\r\nThe issue happens on local machine with the API server under:\r\n Windows 10 WSL with Ubuntu 16.04 \r\nMysql 5.7.27\r\nNGINX 1.10.3\r\nPhp 7.3\r\nand also in another environment\r\nUbuntu 18.04.2 LTS\r\nMySQL 8.0.16\r\nNGINX 1.14.0\r\nPHP 7.3\r\n\r\nP.S. This error can be reproduced on demo site : https://demo.directus.io/"},{"labels":["bug",null],"text":"Lets say I have a JSON column, testing.\r\n\r\ntesting=[\"bla1/bla2\"]\r\n\r\nIf I call items with filter[testing][contains]=/bla2, it works and returns the item.\r\n\r\nHowever, if I call items with filter[testing][contains]=bla1/bla2, or \"bla1/\" or even \"1/b\", an empty array is returned."},{"labels":["bug"],"text":"I'm trying to get this to work in my own app, but I find it also fails on the directus demo...\r\n\r\n**Steps to reproduce:**\r\n\r\n- Access the demo via api with a post request to create a news item\r\nPOST: https://demo.directus.io/thumper/items/news (get auth token first)\r\n\r\nCreate a news item with the following body:\r\n```\r\n{\r\n  \"title\": \"Test News title 2\",\r\n  \"related_news\":[{\"related_id\": 2}]\r\n}\r\n```\r\n\r\nI chose news as it is the only table in the demo to have a M2M relationship with \"related_news\".\r\nI tried POST to create a new item and PATCH to update an existing item and I keep getting this 500 error back. (From inside the demo app, news relations can be created as expected...)\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"Internal Server Error\"\r\n    }\r\n}\r\n```\r\n\r\n\r\n"},{"labels":["bug"],"text":"Per https://docs.directus.io/api/items.html#the-item-object\r\n\r\nIf a collection includes an interface of type `Repeater`, attempting to filter the fields returned by an endpoint through the `fields` query param. fails (is ignored).\r\n\r\nExample:\r\n```php\r\n$posts = $itemsService->findAll('a_blog',\r\n  Array(\r\n    'sort' => '-created_on',\r\n    'status' => 'published',\r\n    'fields' => Array(\r\n      'id',\r\n      'content.markdown',\r\n      'content.media.id',\r\n      'content.media.private_hash',\r\n      'content.media.width',\r\n      'content.media.height',\r\n      'content.media.title',\r\n      'content.media.description',\r\n      'created_on',\r\n      'modified_on',\r\n      'slug',\r\n      'name',\r\n      'summary',\r\n      'tags'\r\n    )\r\n  )\r\n);\r\n```\r\n\r\nWhere the field `content` is of interface type `repeater` and `media` is of interface type `file`.\r\n\r\nDespite explicitly specifying desired fields, all are returned."},{"labels":["bug",null],"text":"Hello,\r\n\r\nI'm trying to run Directus on Azure, and I'm facing some problems with that.\r\nFor now, I already deployed 2 Azure WebApp, one with the API (Linux Azure WebApp w/ PHP) and another one with the APP (Linux Azure WebApp w/ Nodejs).\r\n\r\nThe `server/ping` is working for my API.\r\nMy app just freeze in loading screen and give timeout after some time - don't appear the setup installation or login page.\r\n\r\nBut, besides my app problem, I'm currently not able to create a project in my API connecting with my Azure MySQL Server.\r\n\r\nThere is some limitation here? I already tested my connection with the DB in MySQL Workbench, or inside the webapp container, and everything works there. But when I try to post `/server/projects` with my DB information I receive the error:\r\n\r\n`\r\n{\r\n    \"error\": {\r\n        \"code\": 19,\r\n        \"message\": \"Invalid database connection\",\r\n        \"class\": \"Directus\\\\Exception\\\\InvalidDatabaseConnectionException\",\r\n        \"file\": \"/home/site/wwwroot/src/core/Directus/Services/ProjectService.php\",\r\n        \"line\": 107\r\n    }\r\n}\r\n`\r\n\r\n![image](https://user-images.githubusercontent.com/42069752/82347955-2a5a8e80-99f0-11ea-9bdb-3c761daef651.png)\r\n\r\n![image](https://user-images.githubusercontent.com/42069752/82348209-73124780-99f0-11ea-8b0f-d7eb4f428820.png)\r\n(this is a connection to my Azure db inside the API app container - they use mariaDB client for that, everything seems okay here)\r\n\r\n![image](https://user-images.githubusercontent.com/42069752/82348860-4c084580-99f1-11ea-8caa-e72c4b986d01.png)\r\n(this is when I run my app locally and point my API_URL to my deployed API in Azure, seems to be the same problem like when I try with Postman)\r\n\r\nThanks in advance. üê∞\r\n"},{"labels":["bug"],"text":"I have v8.6.1 running.\r\nI have a list of courses that have dates. I want to query the list to get all the courses that have a date later than today.\r\n\r\nThis works fine with a normal get request:\r\nGET  .../items/courses?filter[date][gte]=now\r\n\r\nWhen I try the same with GrapgQL I get an error (Field \\\"date_gte\\\" is not defined by type CoursesFilter)\r\nMy query:\r\n\r\nquery{\r\n    courses (filter: { date_gte: now }) {\r\n      data {\r\n        id\r\n        date\r\n        time\r\n        title   \t\r\n      }\r\n    }\r\n}\r\n\r\nIf I run a query with: courses (filter: { id_gte: 3 })...it returns correct results, so I guess the issue is specific to date or the fact I'm using \"now\"  \r\n\r\nThanks in advance for any feedback.\r\n\r\n\r\n<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n- Make a GQL Query with a filter like:  (filter: { date_gte: now })\r\n\r\n## Expected Behavior\r\n\r\n- Query returns all items where the date is greater than now\r\n\r\n## Actual Behavior\r\n\r\nQuery returns error with message:\r\nField \\\"date_gte\\\" is not defined by type CoursesFilter; Did you mean date_all, date_has, time_gte, id_gte, or time_lte?"},{"labels":["bug"],"text":"‚Ä¢¬†Version of Directus: [officical demo](https://demo.directus.io/)@v8.7.0\r\n\r\nfor examples:\r\n```shell\r\nGET /thumper/items/customers?meta=filter_count,total_count&limit=5&fields=tags&filter[tags][in]=designer&filter[tags][logical]=and&filter[tags][in]=vip\r\n```\r\n\r\nreturn\r\n```json\r\n{\r\n  \"meta\": {\r\n    \"total_count\": 980,\r\n    \"filter_count\": 214\r\n  },\r\n  \"data\": [\r\n    {\r\n      \"tags\": [\r\n        \"vip\"\r\n      ]\r\n    },\r\n    {\r\n      \"tags\": [\r\n        \"vip\"\r\n      ]\r\n    },\r\n    {\r\n      \"tags\": [\r\n        \"vip\"\r\n      ]\r\n    },\r\n    {\r\n      \"tags\": [\r\n        \"vip\"\r\n      ]\r\n    },\r\n    {\r\n      \"tags\": [\r\n        \"vip\"\r\n      ]\r\n    }\r\n  ],\r\n  \"public\": true\r\n}\r\n```\r\n\r\nBut based on the data from the directus demo, the correct result should be:\r\n\r\n```json\r\n{\r\n  \"meta\": {\r\n    \"total_count\": 980,\r\n    \"filter_count\": 0\r\n  },\r\n  \"data\": [],\r\n  \"public\": true\r\n}\r\n```"},{"labels":["bug"],"text":"Replicates in https://demo.directus.io/ v8.7.0\r\n\r\n![image](https://user-images.githubusercontent.com/1665522/82280948-ad64f000-99c2-11ea-8190-2d22196c9307.png)\r\n\r\n![bug](https://user-images.githubusercontent.com/1665522/82280841-68d95480-99c2-11ea-823f-fa5e6a84fe80.gif)\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nrun `php bin/directus install:install -e \"xxx -p \"xxx\"`\r\non a configuration to a mysql database that has the SQL_MODE=ANSI_QUOTES enabled.\r\n\r\n## Expected Behavior\r\n\r\nInstallation should work.\r\n\r\n## Actual Behavior\r\n\r\nInstallation breaks, because the generated SQL commands use double quotes as strings, which are not allowed in ANSI_QUOTES sql mode.\r\n\r\n## Other Context & Screenshots\r\n\r\nContext:\r\nWe are using a managed MySQL instance on DigitalOcean, where we do not have superadmin privileges to change the SQL mode.\r\n\r\nWe added some debugging to the PHP scripts and found this query:\r\n\r\n```\r\nSELECT 1 FROM `directus_fields` WHERE `collection` = \"directus_users\" AND `field` = \"password_reset_token\";\r\n```\r\nThis results in a SQL error, when running this query manually, we see:\r\n`[42S22][1054] Unknown column 'directus_users' in 'where clause'`.\r\n\r\nTo fix this, the query needs to use single quotes for strings:\r\n```\r\nSELECT 1 FROM `directus_fields` WHERE `collection` = 'directus_users' AND `field` = 'password_reset_token';\r\n```\r\n\r\n## Technical Details\r\n\r\n- Database: MySQL 8.0.19\r\n- Directus Release Version: v8.6.2-apache\r\n- Install Method: Official Docker image `directus/directus:v8.6.2-apache`\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nWhen selecting an element whose primary key contains `/` characters Directus App displays the Sign In page and the error `Unauthorized Request`.\r\n## Steps to Reproduce\r\n\r\n1. Create a Collection `test` with just the primary key as a field, named ID by default-\r\n2. Update the `ID` field: select `String` as Field Type,`VARCHAR` as MySQL Datatype and switch off the `Hidden on Detail` option.\r\n3. Add an item to the `test` collection with the value of `ID` field set to `a/b`.\r\n4. Save the newly created item.\r\n5. In the `test` collection page click on the newly created item.\r\n\r\n## Expected Behavior\r\nThe item with `ID` set to `a/b` is shown.\r\n## Actual Behavior\r\nThe Sign in page is displayed and the error `Unauthorized request` appears, below `Something is wrong with this project` (see screenshot). \r\n## Other Context & Screenshots\r\nScreenshot:\r\n![error](https://user-images.githubusercontent.com/30753195/69436283-5f3ba080-0d41-11ea-9489-fc3849fc130d.PNG)\r\n\r\nI think the issue is related to how links for items are generated. In many sections of the Directus App source I see code similar to this:\r\n```\r\n `/${this.currentProjectKey}/collections/${this.collection}/${pk}`\r\n```\r\nA `/` character in a primary key is directly injected in the URL, thus tricking the router which will consider the generated URL as a bad route.\r\nI tried to replicate the issue in `190927A`: when clicking on the `a/b` item I received the error `Item not found` and on the top of the screen the breadcrumb was `Collections > Test > A > B` (confirming that the URL was not interpreted correctly).\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10\r\n- Web Server: Apache 2.4.38\r\n- PHP Version: 7.3.3\r\n- Database: MySQL 5.7.17\r\n- Directus Release Version: v8.0.0-rc.2\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\n\r\nHello, and thank you for taking the time to notify the community of this issue. Please ensure you are on the latest version of Directus and be as detailed as possible so that we can resolve the problem efficiently, including...\r\n\r\n‚Ä¢¬†Version of Directus (must be the latest)\r\n‚Ä¢¬†Server, OS & Database Details\r\n‚Ä¢¬†Error Messages\r\n‚Ä¢¬†Steps to Reproduce\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\nüê∞\r\n\r\n-->\r\nWhen you change API response limit to a number less than 11 (11 is the position where element to change API response limit is present) , then when the elements for settings are pulled from the API only certain number of elements are pulled.\r\nSteps to reproduce: Change API response to 5 , refresh the page. Once you refresh, the only way to change it is through the database.(directus_settings table)\r\nAlso, a major issue, when someone set it up to 5, the request query contains limit=undefined and offset=NaN\r\n\r\n![image](https://user-images.githubusercontent.com/45964517/82169546-69e58580-98df-11ea-8181-92092bc7668c.png)\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Setup S3 adapter to store assets with Cache-Control as shown in the docs\r\n2. Upload any assets\r\n3. Check the S3 metadata for the uploaded file\r\n\r\n## Expected Behavior\r\n\r\nNo Cache-Control header is set\r\n\r\n## Actual Behavior\r\n\r\nCache-Control header should be set as configured\r\n\r\n## Other Context & Screenshots\r\n\r\nThe correct option to set cache in flysystem-aws-s3 is CacheControl, as explained in [this comment](https://github.com/GrahamCampbell/Laravel-Flysystem/issues/49#issuecomment-117834870), but the Directus Schema doesn't allow that config.\r\n\r\nFixing is a matter of updating the Schema to accept CacheControl (and optionally other headers [as shown in flysystem-aws-s3 code](https://github.com/thephpleague/flysystem-aws-s3-v2/blob/master/src/AwsS3Adapter.php#L32)) and updating the docs to reflect this change.\r\n\r\nI've tested this fix and it does work as expected.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Directus Release Version: 8.5.4\r\n- Install Method: master"},{"labels":[null,"bug"],"text":"‚Ä¢¬†Version of Directus (must be the latest)\r\n\r\n> 8.6.2\r\n\r\n‚Ä¢¬†Server, OS & Database Details\r\n\r\n> CentOS, MySql 5.7\r\n\r\n‚Ä¢¬†Error Messages\r\n\r\n> Error 500\r\n\r\n‚Ä¢¬†Steps to Reproduce\r\n```\r\nRequest a thumbnail via GET request with this format:\r\nexample.com/<project-name>/assets/<private_hash>?w=130&h=115&f=crop&q=80\r\n```\r\n\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\n> No error messages in log files\r\n"},{"labels":["bug"],"text":"Underscore '_' in config keys makes impossible to set some config via env vars.\r\n\r\nFor example: `['cache']['response_ttl']` cannot be set using `DIRECTUS_CACHE_RESPONSE_TTL`.\r\n\r\n`Context::from_map($_ENV)` should be adjusted or no underscores have to be allowed in config keys."},{"labels":["bug"],"text":"## Description\r\nI am using Directus Cloud, not a locally installed instance of the application.\r\n\r\nI am in the US's central timezone, and it is currently 2:34pm. About an hour and a half ago I added 3 new items to a collection, around 1pm CDT.\r\n\r\nI have the `modified_on` field surfaced in the browse collection screen (I have made no changes to the defaults of this field except to show it on the browse page), and the dates displaying correspond to my local timezone, but the timezone display being used says GMT.\r\n\r\n<img width=\"373\" alt=\"Screen Shot 2020-05-14 at 1 38 48 PM\" src=\"https://user-images.githubusercontent.com/7051012/81976895-d1a18500-95ee-11ea-94aa-d2be3067dd4d.png\">\r\n\r\nThis made me think that it was actually displaying the times relative to my current timezone settings, so I changed that and the time display did not change. \r\n\r\nSo, ultimately, this leads me to one of two conclusions:\r\n- The times are not recorded in GMT when they should be, possibly because of infrastructure settings on the server instance\r\n- The times are not displaying the correct timezone regardless of the time being displayed"},{"labels":["bug"],"text":"The field information lingers around. When you delete a collection, it should also delete it's field configuration."},{"labels":["bug"],"text":"My server has certain restrictions on communicating with the outside world. Therefore, the call in line 667 of CoreServicesProvider.php is failing (triggered through the endpoint: /auth/authenticate):\r\n`\\Directus\\request_send_json('POST', 'https://telemetry.directus.io/count', $data);`\r\n\r\nThe failing sadly takes really long (multiple minutes). After figuring this out, I can simply fix this by turning telemetry off in the settings. But was wondering if there was a php check to figure out if calls like this are possible, before attempting to do the call, thereby, avoiding these timeouts?\r\n\r\nMaybe a note in the documentation on this would be nice, too.\r\n\r\n/server/info:\r\n`{\"data\":{\"directus\":\"8.6.2\",\"server\":{\"type\":\"Apache\\/2.4.29 (Ubuntu)\",\"rewrites\":true,\"os\":\"Linux\",\"os_version\":\"#86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020\"},\"php\":{\"version\":\"7.2.24-0ubuntu0.18.04.4\",\"max_upload_size\":8388608,\"extensions\":{\"pdo\":true,\"mysqli\":true,\"curl\":true,\"gd\":true,\"fileinfo\":true,\"mbstring\":true,\"json\":true}},\"permissions\":{\"public\":\"0777\",\"logs\":\"0777\",\"uploads\":\"0777\"}},\"public\":true}`"},{"labels":["bug"],"text":"‚úÖ  `news.*.*`:\r\nhttps://demo.directus.io/thumper/items/staff/1?access_token=admin&fields=id,news.*.*\r\n\r\n‚úÖ  `news.author.*`:\r\nhttps://demo.directus.io/thumper/items/staff/1?access_token=admin&fields=id,news.author.*\r\n\r\n‚ùå  `news.author.first_name`:\r\nhttps://demo.directus.io/thumper/items/staff/1?access_token=admin&fields=id,news.author.first_name"},{"labels":["bug"],"text":"<!--\r\n\r\nHello, and thank you for taking the time to notify the community of this issue. Please ensure you are on the latest version of Directus and be as detailed as possible so that we can resolve the problem efficiently, including...\r\n\r\n‚Ä¢¬†Version of Directus (must be the latest)\r\n‚Ä¢¬†Server, OS & Database Details\r\n‚Ä¢¬†Error Messages\r\n‚Ä¢¬†Steps to Reproduce\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\nüê∞\r\n\r\n-->\r\nHello, I tried to use Google SSO but it fails because of not enabled Legacy People API:\r\n\r\nError Message from logs:\r\n```\r\napi[xxxxxxx].ERROR: League\\OAuth2\\Client\\Provider\\Exception\\IdentityProviderException: Legacy People API has not been used in project xxxxxxxxxx before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/legacypeople.googleapis.com/overview?project=xxxxxxxx then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.  in /var/directus/vendor/league/oauth2-google/src/Provider/Google.php:120\r\n```\r\nThis way it looks like it is working, but when I am being redirected into the App from Google SSO page, Directus says: \r\n![image](https://user-images.githubusercontent.com/11354418/80894274-d9515780-8cd9-11ea-8f96-73a6dcc6d671.png)\r\n\r\nLink provided by that log leads to non-existent link (404 in console), so I assume Google disabled Legacy People API, which is still being used by the App.\r\n\r\nIdeal situation would be to change that API with new Google People API.\r\n\r\n(On current version, used on Digital Ocean in Docker Ubuntu 18.04)"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Try to login\r\n2. Look at the network console\r\n\r\n## Expected Behavior\r\nBackend is loaded.\r\n\r\n## Actual Behavior\r\n\"Server Error\" gets shown and the API call to: https://mydirectusinstallation.com/users/me?fields[0]=id&fields[1]=avatar.*&fields[2]=email&fields[3]=first_name&fields[4]=last_name&fields[5]=locale&fields[6]=role.*&fields[7]=last_page&fields[8]=theme\r\n\r\nOuputs an 401 error. The response is:\r\n`{\r\n  \"error\": {\r\n    \"code\": 3,\r\n    \"message\": \"Unauthorized request\",\r\n    \"class\": \"Directus\\\\Exception\\\\UnauthorizedException\",\r\n    \"file\": \"\\/var\\/www\\/vhosts\\/httpdocs\\/directus\\/src\\/core\\/Directus\\/Services\\/UsersService.php\",\r\n    \"line\": 152\r\n  }\r\n} <br/ >\r\n  <b> Notice </b>:  Trying to access array offset on value of type null in <b>/var/www/vhosts/ httpdocs/directus/src/core/Directus/Services/ItemsService.php </b> on line <b>557</b> <br/>\r\n`\r\n\r\n## Other Context & Screenshots\r\nI did not change anything. The error appeared over night as it seems.\r\nOther projects on the same install are still working perfectly. Only the one project seems broken.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Linux Server\r\n- OS: -\r\n- Web Server: -\r\n- PHP Version: 7.4.3\r\n- Database: -\r\n- Directus Release Version: v8.6.2\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"* Version of Directus v8.6.2\r\n\r\n* Server, OS & Database Details: Caddy server in docker with MySQL 8\r\n\r\n* Error Messages: \r\n\r\n1. don't use youtube API key:\r\n\r\n```shell\r\n{\"data\":{\"private_hash\":\"rh1k899g8y8c8wgs\",\"filesize\":0,\"tags\":[],\"filename_disk\":\"a97bf4c8-2207-458f-8026-bf558b83399e.jpg\",\"width\":560,\"checksum\":null,\"filename_download\":\"youtube_8gWWpwLN67c.jpg\",\"height\":340,\"metadata\":null,\"title\":\"YouTube - 8gWWpwLN67c\",\"duration\":null,\"type\":\"embed\\/youtube\",\"embed\":\"8gWWpwLN67c\",\"uploaded_by\":1,\"folder\":null,\"id\":15,\"uploaded_on\":\"2020-05-11T02:31:58+00:00\",\"description\":null,\"storage\":\"s3\",\"charset\":\"\",\"location\":null,\"data\":{\"full_url\":\"https:\\/\\/fengsi-io.sfo2.cdn.digitaloceanspaces.com\\/api\\/kingtower\\/originals\\/a97bf4c8-2207-458f-8026-bf558b83399e.jpg\",\"url\":\"https:\\/\\/fengsi-io.sfo2.cdn.digitaloceanspaces.com\\/api\\/kingtower\\/originals\\/a97bf4c8-2207-458f-8026-bf558b83399e.jpg\",\"thumbnails\":null,\"embed\":{\"html\":\"<iframe width=\\\"560\\\" height=\\\"340\\\" src=\\\"\\/\\/www.youtube.com\\/embed\\/8gWWpwLN67c\\\" frameborder=\\\"0\\\" allowfullscreen><\\/iframe>\",\"url\":\"https:\\/\\/www.youtube.com\\/watch?v=8gWWpwLN67c\"}}}}\r\nNotice: Undefined index: fileId in /var/directus/src/core/Directus/Filesystem/Files.php on line 399\r\n```\r\n\r\n2. use Youtube API Key:\r\n\r\n```shell\r\n{\"error\":{\"code\":null,\"message\":\"File not found at path: 81064240-5cfd-4315-a99b-eb66b6c05b10\",\"class\":\"League\\\\Flysystem\\\\FileNotFoundException\",\"file\":\"\\/var\\/directus\\/vendor\\/league\\/flysystem\\/src\\/Filesystem.php\",\"line\":389}}\r\n```\r\n\r\n* Steps to Reproduce\r\n\r\n1. don't use youtube API key:\r\n![bug](https://user-images.githubusercontent.com/1665522/81519185-f689c400-9372-11ea-89c9-5262e9f7f5c5.gif)\r\n\r\n2. use Youtube API Key:\r\n![bug](https://user-images.githubusercontent.com/1665522/81519410-b70fa780-9373-11ea-8c80-d24a2a0794d9.gif)\r\n"},{"labels":["bug"],"text":"<!--\r\n\r\nHello, and thank you for taking the time to notify the community of this issue. Please ensure you are on the latest version of Directus and be as detailed as possible so that we can resolve the problem efficiently, including...\r\n\r\n‚Ä¢¬†Version of Directus (must be the latest)\r\n‚Ä¢¬†Server, OS & Database Details\r\n‚Ä¢¬†Error Messages\r\n‚Ä¢¬†Steps to Reproduce\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\nüê∞\r\n\r\n-->\r\nAPI/App v8\r\nIt seems the metadata tags on a file can be so long that the api can't format the SQL query, which I believe limits it to 255 characters. Minor fix!\r\n"},{"labels":["bug"],"text":"‚Ä¢¬†Version of Directus: latest\r\n‚Ä¢¬†Server, OS & Database Details: Ubuntu 18.4 , mySQL\r\n\r\n## Issue\r\nI've created collection `article` and used `url` as primary key\r\nType of `url` is `varchar` with length 200 and now I am getting next issues:\r\n- Option unique cannot be select\r\n\tI understand that choosing PK is guarantee uniqality, but from UI view it would be better to switch on unique option\r\n- Value cannot be updated by UI\r\n\tAfter changing and saving this value is not changed. But I have option enabled that tell me \"you can edit it\" and editing is enabled \r\n- **Linking to revisions** (main issue)\r\n\tAfter choosing a custom attribute, with custom name and `varhcar` value system cannot link revisions to collection item. \r\n\tIt looks like just a rendering issue, because it can find activities, but doesn't render\r\n\r\n## Screenshots\r\n1. Opened Article item \r\n![1](https://i.imgur.com/y8l1e8t.png)\r\n2. Added commentary (pay attention last revisions are not showed)\r\n![](https://i.imgur.com/3fquA0j.png)\r\n3. Page refreshed \r\n![](https://i.imgur.com/PaxH4Jd.png)\r\n4. Revisions request (by client, rendering)\r\n![](https://i.imgur.com/gZYfDIJ.png)\r\n\r\nIf you need I can give you access to server / client to accelerate fixing :) \r\n\r\nP.S. The system is awesome! Everything is well documented, UI is friendly and I really enjoy it! Thank you for great project\r\n"},{"labels":["bug"],"text":"## Server, OS & Database Details\r\nUbuntu 18.4, DB is mysql\r\n\r\n## Error Messages\r\nWhen I am doing update to collection `client.updateItem('person', 'alexandr.m')` I got next error:\r\n\r\n\t\t{\r\n\t\t\t\"error\": {\r\n\t        \t\"code\": 3,\r\n\t        \t\"message\": \"Unauthorized request\"\r\n    \t\t}\r\n    \t}\r\n\r\n\r\nI have configured public access to allow update like' field in person collection\r\n![Update is enabled](https://i.imgur.com/vuKjYaX.png)\r\n![field can be updated](https://i.imgur.com/LJMYSkl.png)\r\n\r\n## Addictional info \r\nCollection Person fields\r\n![fields](https://i.imgur.com/4rEPHtl.png)"},{"labels":["bug"],"text":"<!--\r\n\r\nHello, and thank you for taking the time to notify the community of this issue. Please ensure you are on the latest version of Directus and be as detailed as possible so that we can resolve the problem efficiently, including...\r\n\r\n‚Ä¢¬†Version of Directus (must be the latest)\r\n‚Ä¢¬†Server, OS & Database Details\r\n‚Ä¢¬†Error Messages\r\n‚Ä¢¬†Steps to Reproduce\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\nüê∞\r\n\r\n-->\r\n‚Ä¢¬†Version of Directus (must be the latest)\r\n8.6.2\r\n‚Ä¢¬†Server, OS & Database Details\r\nCustom docker image with PHP and NGINX, DB = MySQL\r\n‚Ä¢¬†Error Messages\r\n\r\n`Statement could not be executed (42S22 - 1054 - Unknown column '<name of the m2m field>' in 'where clause')`\r\n\r\n‚Ä¢¬†Steps to Reproduce\r\n1. Create a m2m field in the collection and set required flag\r\n2. Save the field \r\n3. Edit the field again and try to save it (changes do't matter) \r\n\r\n‚Ä¢¬†Relevant Info, Screenshots, Schema & Logs\r\n\r\n![image](https://user-images.githubusercontent.com/35192116/80621451-96785100-8a47-11ea-8db6-3d31952a2922.png)\r\n"},{"labels":["bug"],"text":"Selecting an owner doesn't work upon creation, because it selects the current owner anyway.\r\n\r\nVideo showcase (2mn): \r\nhttps://youtu.be/6WONPlsmr1o\r\n\r\n![image](https://user-images.githubusercontent.com/3807458/80111070-b27b7e80-857f-11ea-87b3-784effe7212b.png)\r\n\r\n![image](https://user-images.githubusercontent.com/3807458/80111089-b8715f80-857f-11ea-9304-babbb49517e6.png)\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Try to add a new video url with the files field.\r\n2. Click on embed\r\n3. Paste link\r\n4. Click done\r\n5. Click on the save icon top right\r\n\r\n## Expected Behavior\r\n\r\nCorrectly save the video.\r\n\r\n## Actual Behavior\r\n\r\nError when saving with message: \"filename_disk: This value should not be blank. filename_download: This value should not be blank. uploaded_on: This value should not be blank.\"\r\n\r\n## Other Context & Screenshots\r\n\r\nThe video (link) was added to the directus_files when I checked the database directly but that's it.\r\nIf I try the \"select existing\" and search the youtube id then I can select the video that threw the error before and it works.\r\nhttps://imgur.com/a/N5YRFq0\r\n\r\nThe problem is only with embeded video. It works correctly when I try to add images or other files.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop Firefox whatsmybrowser.org/b/ZCKLR\r\n- OS: Windows 10.0.18363 Build 18363\r\n- PHP Version: 7.2.24-0ubuntu0.18.04.3\r\n- Database: MariaDB 10.4.12\r\n- Directus Release Version: 8.6.2\r\n- Install Method: ftp upload\r\n"},{"labels":["bug"],"text":"The GET fields do not return relationship information for the \"M2?\" Fields.\r\n\r\nIn the same way it is not possible to specify this information at creation (POST)."},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nUse an api client (curl, postman, etc) to call the endpoint  : /_/scim/v2/Users?filter=userName eq \"user@example.com\" with a valid Authorization header\r\n\r\nThe username above can be replaced with any other (existing or otherwise) username.\r\n\r\n## Expected Behavior\r\nThe api returns a list of scim users as per https://docs.directus.io/api/scim.html#list-scim-users\r\n\r\n## Actual Behavior\r\nThe api responds with,\r\n```\r\n{\r\n    \"schemas\": [\r\n        \"urn:ietf:params:scim:api:messages:2.0:Error\"\r\n    ],\r\n    \"status\": 500,\r\n    \"detail\": \"Internal Server Error\"\r\n}\r\n```\r\nand the server logs have the stacktrace,\r\n\r\n> [2020-04-20 09:37:13] api[_].ERROR: TypeError: Argument 2 passed to Directus\\Database\\TableGateway\\RelationalTableGateway::processFilter() must be of the type array, string given in /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php:1800\r\n> Stack trace:\r\n> #0 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->processFilter\r\n> directus/directus#1 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(831): call_user_func_array\r\n> directus/directus#2 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1144): Directus\\Database\\TableGateway\\RelationalTableGateway->applyParamsToTableEntriesSelect\r\n> directus/directus#3 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1054): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n> directus/directus#4 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1012): Directus\\Database\\TableGateway\\RelationalTableGateway->createMetadataPagination\r\n> directus/directus#5 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(936): Directus\\Database\\TableGateway\\RelationalTableGateway->createEntriesMetadata\r\n> directus/directus#6 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(918): Directus\\Database\\TableGateway\\RelationalTableGateway->createMetadata\r\n> directus/directus#7 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1289): Directus\\Database\\TableGateway\\RelationalTableGateway->wrapData\r\n> directus/directus#8 /var/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(856): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n> directus/directus#9 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n> directus/directus#10 /var/directus/src/core/Directus/Services/AbstractService.php(347): call_user_func_array\r\n> directus/directus#11 /var/directus/src/core/Directus/Services/AbstractService.php(289): Directus\\Services\\AbstractService->getDataAndSetResponseCacheTags\r\n> directus/directus#12 /var/directus/src/core/Directus/Services/UsersService.php(194): Directus\\Services\\AbstractService->getItemsAndSetResponseCacheTags\r\n> directus/directus#13 /var/directus/src/core/Directus/Services/ScimService.php(170): Directus\\Services\\UsersService->findAll\r\n> directus/directus#14 /var/directus/src/endpoints/ScimTwo.php(172): Directus\\Services\\ScimService->findAllUsers\r\n> directus/directus#15 [internal function]: Directus\\Api\\Routes\\ScimTwo->listUsers\r\n> directus/directus#16 /var/directus/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n> directus/directus#17 /var/directus/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n> directus/directus#18 /var/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n> directus/directus#19 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n> directus/directus#20 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#21 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#22 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#23 /var/directus/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(124): Slim\\Route->Slim\\{closure}\r\n> directus/directus#24 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n> directus/directus#25 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#26 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#27 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#28 /var/directus/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n> directus/directus#29 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n> directus/directus#30 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#31 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#32 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#33 /var/directus/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\n> directus/directus#34 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\n> directus/directus#35 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#36 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#37 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#38 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n> directus/directus#39 /var/directus/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n> directus/directus#40 /var/directus/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n> directus/directus#41 /var/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n> directus/directus#42 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n> directus/directus#43 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#44 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#45 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#46 /var/directus/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n> directus/directus#47 /var/directus/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n> directus/directus#48 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n> directus/directus#49 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#50 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#51 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#52 /var/directus/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n> directus/directus#53 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n> directus/directus#54 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#55 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#56 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#57 /var/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\n> directus/directus#58 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n> directus/directus#59 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#60 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#61 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#62 /var/directus/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(63): Slim\\App->Slim\\{closure}\r\n> directus/directus#63 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n> directus/directus#64 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n> directus/directus#65 [internal function]: Slim\\DeferredCallable->__invoke\r\n> directus/directus#66 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n> directus/directus#67 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n> directus/directus#68 /var/directus/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n> directus/directus#69 /var/directus/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n> directus/directus#70 /var/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n> directus/directus#71 /var/directus/public/index.php(5): Directus\\Application\\Application->run [] []\r\n> 10.0.1.21 - - [20/Apr/2020:09:37:12 +0000] \"GET /_/scim/v2/Users?filter=userName%20eq%20%22user@example.com%22 HTTP/1.1\" 500 342 \"-\" \"PostmanRuntime/7.24.1\"\r\n\r\n## Technical Details\r\n\r\n- PHP Version: PHP 7.3.15 (cli) (built: Feb 26 2020 12:39:53) ( NTS )\r\n- Database: MySQL 5.7.29\r\n- Directus Release Version: directus/directus:v8-apache\r\n- Install Method: Docker\r\n"},{"labels":["bug"],"text":"When call : \r\nGET /fields/ _collection_ / _field_\r\nGET /fields/ _collection_\r\nGET /collections/ _collection_\r\nGET /collections/\r\n\r\nfields of type \"TEXT\" (LIKE TEXTAREA) have length value, instend 'null'\r\n\r\n```json\r\n{\r\n  \"data\": {\r\n    \"collection\": \"media\",\r\n    \"field\": \"url\",\r\n    \"datatype\": \"TEXT\",\r\n    \"unique\": false,\r\n    \"primary_key\": false,\r\n    \"auto_increment\": false,\r\n    \"default_value\": null,\r\n    \"note\": null,\r\n    \"signed\": true,\r\n    \"id\": 184,\r\n    \"type\": \"string\",\r\n    \"sort\": null,\r\n    \"interface\": \"textarea\",\r\n    \"hidden_detail\": false,\r\n    \"hidden_browse\": false,\r\n    \"required\": true,\r\n    \"options\": {\r\n      \"rows\": \"2\",\r\n      \"serif\": false\r\n    },\r\n    \"locked\": false,\r\n    \"translation\": [\r\n      {\r\n        \"locale\": \"fr-FR\",\r\n        \"translation\": \"Url\"\r\n      }\r\n    ],\r\n    \"readonly\": false,\r\n    \"width\": \"full\",\r\n    \"validation\": \"\",\r\n    \"group\": null,\r\n    \"length\": \"65535\"\r\n  }\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to the \"User Directory\"\r\n2. Create a user (for example johnsmith@gmail.com)\r\n3. Delete user johnsmith@gmail.com created in the step above (By doing this user will be soft-deleted)\r\n4. Try to update email \"johnsmith@gmail.com\" to another user\r\n\r\n## Expected Behavior\r\nThe app should display email unique validation error message\r\n\r\n## Actual Behavior\r\nAPI returns error below:\r\n{\"error\":{\"code\":9,\"message\":\"Failed generating the SQL query.\",\"query\":\"UPDATE `directus_users` SET `email` = 'johnsmith@gmail.com', `id` = '210' WHERE `id` = '210'\"}}\r\n\r\n## Other Context & Screenshots\r\n![Capture](https://user-images.githubusercontent.com/12895021/79732111-dab17600-8310-11ea-82ed-1c9b33219b2d.PNG)\r\n![Capture2](https://user-images.githubusercontent.com/12895021/79732177-f3ba2700-8310-11ea-81dc-99330bc16f3f.PNG)\r\n\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10\r\n- Web Server: Apache 2.4\r\n- PHP Version: 7.2.0\r\n- Database: MySQL 8.0.12\r\n- Directus Release Version: v8.6.2\r\n- Install Method: cloned master branch"},{"labels":["bug"],"text":"When fetching `/users` with the following query:\r\n\r\n<img width=\"215\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9141017/79604921-f91f3380-80bc-11ea-9d42-6bc9654dbb80.png\">\r\n\r\nIt returns the `role` as a nested object with just the ID: \r\n\r\n<img width=\"183\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9141017/79604992-1f44d380-80bd-11ea-9dd3-32d249e2b691.png\">\r\n\r\n\r\nwhile \r\n\r\n<img width=\"183\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9141017/79604952-0c320380-80bd-11ea-9f7d-21984daad10f.png\">\r\n\r\nFetches it correctly; `role: id`:\r\n\r\n<img width=\"357\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9141017/79605011-2b309580-80bd-11ea-9083-ff6dec214843.png\">\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to a collection with a file item\r\n2. Click on the link item on the file upload \r\n3. Put in an youtube link or link to a video\r\n4. See error\r\n\r\n## Expected Behavior\r\n\r\n In a collection with a file element available, click on a link icon to put in a link for a youtube video. I put in https://www.youtube.com/watch?v=j4TkFD-mvNE and it should download the video with a thumbnail.\r\n\r\n## Actual Behavior\r\n\r\nThe upload throws an error because it cannot download the thumbnail. \r\nThe first error is that thrown on the page:\r\n`Trouble processing request. Try again after refreshing the page.`\r\nOn the console this error is thrown:\r\n`error.js:9 Error: Network error\r\n    at new t (API.js:39)\r\n    at API.js:259`\r\n\r\n## Other Context & Screenshots\r\n\r\n![image (2)](https://user-images.githubusercontent.com/59620753/79181204-bb6e9200-7dc0-11ea-94f3-6c26d9a833c3.png)\r\n\r\n\r\n## Technical Details\r\n- Device: Desktop\r\n- Directus Release Version: v8.6.2\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug",null,null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nCurrently it is not possible to add a User with the email address of a previously deleted User.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to Users\r\n2. Add a User with an email \"testuser@demo.com\"\r\n3. Delete the user again\r\n4. Add another User with the email \"testuser@demo.com\"\r\n\r\n## Expected Behavior\r\nAs per Users Dokumentation Users are only soft-deleted and it should be possible to create a new User with the same email address, that will take over the history of the previously existing user.\r\n\r\n## Actual Behavior\r\nAn error is displayed: Duplicate key \"testuser@demo.com\" for collection \"directus_users\"\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: OSX\r\n- Web Server: Apache\r\n- PHP Version: 7.3\r\n- Database: MySQL 5.7\r\n- Directus Release Version: v8.6.2\r\n- Install Method: docker\r\n"},{"labels":["bug"],"text":"When running new installation after entering DB credentials I get error:\r\n\r\n\"Permission denied: Superadmin Only\"\r\n\r\nInstaller does not continue. Running on Apache2, PHP 7.2 and Ubuntu 18."},{"labels":["bug"],"text":"Ref: https://github.com/directus/app/issues/2335\r\n\r\n* Version of Directus: v8.6.2\r\n* Steps to reproduce: ![bug](https://user-images.githubusercontent.com/1665522/78913939-56632580-7abc-11ea-865d-9111e78966a1.gif)"},{"labels":["bug"],"text":"First of all the public role of my instance doesn't have access to view deleted items, just published. That works, just not when using complex filters (in this case with a logical or).\r\nRelation fields also don't work in this case. It should be returning the thumbnail and in some cases the category, but with those logical or it isn't doing that\r\n\r\nDemo: https://directus.pas.cr/pas-app/items/sermons?fields=*,thumbnail.data.*,speaker.name,*,speaker.id&sort=-created_on&filter[description][like]=Alejandro%20castro&filter[title][like]=alejandro%20castro&filter[speaker.name][like]=alejandro%20castro&filter[description][logical]=or&filter[title][logical]=or&filter[speaker.name][logical]=or&status=published\r\n\r\n![image](https://user-images.githubusercontent.com/3890044/79028077-ff0c9600-7b4b-11ea-92cf-762619dd4191.png)\r\n![image](https://user-images.githubusercontent.com/3890044/79028098-10ee3900-7b4c-11ea-9c81-576bc157bca2.png)\r\n\r\n\r\n"},{"labels":["bug"],"text":"# Bug Report\r\nI have a role with limited permissions. The user should have permissions to create an item in status draft. From there he should be able to update to any status but \"disallowed\".\r\n\r\n![Screenshot_2020-04-10 Settings User Permissions](https://user-images.githubusercontent.com/33333299/78983349-5a2a9280-7b24-11ea-9fc7-9ff0f7b35825.png)\r\n\r\n## on creation: status options\r\n![Screenshot_2020-04-10 Settings User Permissions(2)](https://user-images.githubusercontent.com/33333299/78983749-171cef00-7b25-11ea-92b4-40f6b596c984.png)\r\n\r\n## draft: status options\r\n![Screenshot_2020-04-10 Settings User Permissions(1)](https://user-images.githubusercontent.com/33333299/78983357-5dbe1980-7b24-11ea-8d69-bf9427dd778a.png)\r\n\r\nIf I try to update an item and change the status to \"disallowed\" through the dashboard it works as expected and is its not possible.\r\n![Screenshot_2020-04-10 Editing Item Testitem](https://user-images.githubusercontent.com/33333299/78983942-80046700-7b25-11ea-98ad-1cddcb6e5352.png)\r\n\r\n## Expected Behavior\r\nItem can not be updated to status \"disallowed\" through the dashboard or the API\r\n## Actual Behavior\r\nItem can be updated to status \"disallowed\" through the API\r\n\r\n## Technical Details\r\n\r\n- Web Server: [Apache 2.4]\r\n- PHP Version: [7.3.0]\r\n- Database: [mariadb 10.4.12-bionic]\r\n- Directus Release Version: [8.6.0 Suite]\r\n- Install Method: [cloned `master` branch]\r\n"},{"labels":["bug"],"text":"Hi there!\r\n\r\nThanks for creating this great suite!\r\n\r\nIs it possible to replace `2fa_*` names by `twofa_*` to [meet the GraphQL specification](http://spec.graphql.org/draft/#sec-Names)?\r\n\r\n![Screenshot 2020-04-05 at 19 36 23](https://user-images.githubusercontent.com/61412138/78741837-b2ae3400-795a-11ea-8037-56b96f58212a.png)\r\n\r\nWe are facing the next blocking issue:\r\n‚Ä¢¬†Version of Directus: 8\r\n‚Ä¢¬†Error message (if any):\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_eq\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_neq\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_contains\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_ncontains\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_rlike\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_nrlike\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_empty\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_nempty\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_null\" does not.\r\n> Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_nnull\" does not.\r\n> Interface field Directus_Node.id expected but Directus_DirectusUser does not provide it.\r\n\r\n‚Ä¢¬†Steps to reproduce: import the data including `2fa_secret_*` names [starting by number.](https://stackoverflow.com/a/51139342)\r\n‚Ä¢¬†PHP version N/A\r\n‚Ä¢¬†MySQL version N/A\r\n‚Ä¢¬†Webserver + version N/A\r\n\r\nThanks!\r\n\r\n"},{"labels":["bug"],"text":"If a request to the API contains a _json object_ with integer keys containing all numbers from 0 to a certain number greater than 0 (e.g. `{0: \"Zero\", 1: \"One\", 2: \"Two\"}`) then the API converts the _json object_ to a _json array_. This causes issues inside the App since it does not expect an array as response.\r\n\r\nI found the issue while using the App to create a \"Radio Buttons\" field. Creating such a field with ascending integer keys starting with 0 causes the App to not be able to show the current selected option in the edit dialog of an item inside a collection.\r\nI only tested the `fields` endpoint by creating said field, but the issue is likely present in other endpoints.\r\n\r\nThe issue might be caused by the php function `json_decode(..., true)` converting a _json object_ to a php array and the php function `json_encode()` converting any php array that contains ascending integer keys starting with 0 to a _json array_.\r\n\r\nA possible (and potentially easier) fix for this issue would be to adjust the App to handle this edge case.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection\r\n2. Create a \"Radio Buttons\" field inside the collection\r\n3. In the \"Options\" tab of the field edit dialog create a choice with key _0_ and value _Zero_\r\n4. In the \"Options\" tab of the field edit dialog create a choice with key _1_ and value _One_\r\n5. Create a new item inside the collection and select one of the radio buttons and save the item\r\n6. When selecting the created item again, the previously selected radio button is not selected and the javascript console of the frontend shows an error\r\n7. Inspecting the traffic between App and API one can see that the request to the `fields` endpoint contains a request payload with an object inside `options.choices` and a response payload with a corresponding array inside `data.options.choices`\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10.1909\r\n- Docker Image: directus/directus:v8.6.2-apache\r\n- Database: MySQL 5.7.29\r\n- Directus Release Version: v8.6.2\r\n- Install Method: docker-compose"},{"labels":["bug"],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n‚Ä¢¬†PHP version\r\n‚Ä¢¬†MySQL version\r\n‚Ä¢¬†Webserver + version\r\n\r\nThanks!\r\n\r\n-->\r\n\r\n* Version of Directus: v8.6.2 - Installed via Docker v8.6.2-apache\r\n\r\nThis is a minor bug but causes frustration in statically typed languages (I'm writing in Go). The `data` payload in the response from the `/revisions` method does not keep its data type, it looks like it's converted entirely into a (In Go) `map[string]string` or array of string to string. The `delta` object seems to retain the correct data types, however.\r\n\r\nExample:\r\n`GET /_/items/mycollection/1/revisions`\r\n\r\n```\r\n{\r\n  \"data\": [\r\n    {\r\n      \"item\": \"1\", <-- should be an integer\r\n      \"data\": {\r\n        \"id\": \"1\", <-- should be an integer\r\n        ...\r\n      },\r\n      \"delta\": {\r\n        \"id\": 1, <-- this is correct!\r\n         ...\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Set up a deployment using the official directus docker image.\r\n2. Connect a MySQL 8 database.\r\n3. Configure everything using env vars.\r\n4. Enter the container and run `./bin/directus install:config`.\r\n5. Run `./bin/directus install:database`\r\n5. Get error message: `SQLSTATE[42S22]: Column not found: 1054 Unknown column 'directus_fields' in 'where clause'`\r\n\r\n## Expected Behavior\r\n\r\nI expected the last command to scaffold the database structure. \r\n\r\n## Actual Behavior\r\n\r\nIt only created `directus_field` and `directus_migrations` and threw an error: \r\n\r\n`SQLSTATE[42S22]: Column not found: 1054 Unknown column 'directus_fields' in 'where clause'`\r\n\r\n## Other Context & Screenshots\r\n\r\nI'm running the directus image inside a kubernetes cluster and connected to a MySQL 8 database with a dedicated user.\r\n\r\nThe app show this message: \r\n\r\n<img width=\"405\" alt=\"grafik\" src=\"https://user-images.githubusercontent.com/1533846/78062979-c0c6e800-738f-11ea-85e8-278642663081.png\">\r\n\r\n## Technical Details\r\n\r\n- Database: MySQL 8.0.18\r\n- Directus Image: \r\n  - directus/directus@sha256:f1a1ce199042d2fc7ab7ebc2dc8ab59056585592ba85df34a8d6d1716c3e09df (directus/directus:v8.6-apache)"},{"labels":["bug"],"text":"After setting up **config/_.php** with the relevant auth settings, the api does not seem to recognize them. Seems like I'm missing something basic.\r\n\r\n**Version of Directus**\r\nDocker version directus/directus:v8-apache\r\n\r\n**Error message (if any)**\r\nNone\r\n\r\n**Steps to reproduce**\r\nSetup Directus as normal with the auth section in **config/_.php**\r\n```\r\n...\r\n    'auth' => [\r\n        'secret_key' => '<key>',\r\n        'public_key' => '<key>',\r\n        'social_providers' => [\r\n            'okta' => [\r\n                'client_id' => '<id>',\r\n                'client_secret' => '<secret>',\r\n                'base_url' => '<base url>'\r\n            ],\r\n            'github' => [\r\n                'client_id' => '<id>',\r\n                'client_secret' => '<secret>'\r\n            ]\r\n        ],\r\n    ],\r\n...\r\n```\r\n\r\n**PHP version**\r\nPHP 7.3.15 (cli) (built: Feb 26 2020 12:39:53) ( NTS )\r\n\r\n**MySQL version**\r\n5.7.29\r\n\r\n**Expected Behaviour**\r\n**GET /_/auth/sso** should return \r\n{\r\n  \"data\": [\"okta\",\"github\"],\r\n  \"public\": true\r\n}\r\nand the sso (okta, github) login option should be visible on the login page\r\n\r\n**Actual Behaviour**\r\n**GET /_/auth/sso** returns\r\n{\r\n  \"data\": [],\r\n  \"public\": true\r\n}\r\nand no sso login option is visible on the login page\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n1. I don't know what caused it.\r\nI've restored a working backup from last week (server files)\r\nAnd I've also checked the last 50 rows for each table on the DB.\r\nIt didn't fix the issue\r\n\r\n## Actual Behavior\r\n1. Login works fine (not problem checking the password).\r\n2. Then I get the following error page:\r\n![image](https://user-images.githubusercontent.com/9072422/77974888-cf00ff80-72ce-11ea-9ac2-c809cad46a83.png)\r\n\r\n## Other Context & Screenshots\r\n\r\n* No related error logs are generated.\r\n\r\n* I've tried 4 different logins. Only 1 have a avatar (.directus_users.avatar) value. Others are null\r\n\r\n* I have a completely pure-JS separate page which gets the data from the same Directus installation via API and displays it  - they return the same error 500.\r\n\r\n* The same page from above checks if a user is logged in (using .../api/users/me) and if not redirects to the login page. It does redirect back to log in page.\r\n\r\n* .../server/ping returns pong\r\n\r\n* git version is updated\r\n\r\n\r\n## Technical Details\r\n![image](https://user-images.githubusercontent.com/9072422/77211003-6198e600-6afa-11ea-9831-0b95b5e71486.png)\r\n"},{"labels":["bug"],"text":"Hello, \r\nIt looks like using the logical filter \"or\" does not work on tags as array. Only default \"and\" works. For example: \r\n`&filter[tags][contains]=viande&filter[tags][logical]=or&filter[tags][contains]=soupe`\r\nDoes not provide the right result.\r\n\r\nHope I haven't miss-understood the docs.\r\nRegards,\r\nThanks for your work and keep safe."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nWhen trying to install Directus cms without using enviroment variables ( DIRECTUS_USE_ENV=0)  after trying to install:config it breaks. \r\n\r\n## Steps to Reproduce\r\nCreate and run into the container with the following command:\r\n`docker container run -it --name dcontainer -name--entrypoint bash -p 8080:80 -e DIRECTUS_USE_ENV=0 -e DIRECTUS_AUTH_PUBLICKEY=dummypubkey -e DIRECTUS_AUTH_SECRETKEY=dummyseckey -e DIRECTUS_AUTH_PRIVATEKEY=dummyprivate directus/directus:v8.6.2-apache`\r\n\r\nWhen into the container, on path: /var/directus the following command is ran \r\n`./bin/directus install:config -n '' -u ''`  to create the config file. \r\n\r\nThis error is trown:\r\n\r\n> Fatal error: Uncaught Error: Call to a member function getContainer() on null in /var/directus/src/helpers/app.php:113\r\n\r\n\r\n## Expected Behavior\r\nCreate config file to be modified with mysql variables \r\n\r\n## Actual Behavior\r\nFatal error: Uncaught Error: Call to a member function getContainer() on null in /var/directus/src/helpers/app.php:113 \r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/60117764/77743121-32dcad00-6fdd-11ea-9075-f73708a442c4.png)\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- Directus Version: v8.6.2\r\n- Install Method: Docker \r\n- OS: Windows Hyper-V"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n(This is what I did)\r\n1. While using directus with Docker I attempted to configure Google Auth using environment variables\r\n2. Received errors saying the calls are using the `legacypeople api` and cannot be used (deprecated Google+)\r\n3. Remove Google Auth environment variables\r\n4. Now attempt to log in using normal user / pass\r\n\r\n## Expected Behavior\r\n\r\nAfter successful response, be redirected to the app.\r\n\r\n## Actual Behavior\r\n\r\nReceive error \"Couldn't Reach API\", not redirected, HTTP call appears to succeed.\r\n\r\n## Other Context & Screenshots\r\n\r\nI'm using Directus within Docker, it was working just fine and I tried to enable Google Authentication using envrionment variables. When that didn't appear to work (sounds like due to using the deprecated Google+ APIs?) I attempted to disable it. Now all login attempts \"succeed\" on the HTTP side but the App shows \"Couldn't Reach API\". \r\n\r\n![Screen Shot 2020-03-23 at 8 09 37 PM](https://user-images.githubusercontent.com/2372558/77384450-a3b46880-6d42-11ea-80e2-46fa83dc598c.png)\r\n\r\nI don't see any relevant logs, it looks like the calls are succeeding. I've nuked the active sessions in the database, flushed redis, even blew away the Docker container, killed my own cookies and also tried from Incognito. \r\n\r\nAfter doing a login attempt and receiving the error message I can browse `_/users/me` with no issues to see the json dump of my user.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Laptop\r\n- OS: MacOS 10.15.4\r\n- Web Server: Apache 2.4.38\r\n- PHP Version: 7.3.15\r\n- Database: MySQL 5.7\r\n- Directus Release Version: 8.6.2\r\n  - App Version: Not sure\r\n  - API Version: Not sure\r\n- Install Method: Docker via directus/directus:v8.6-apache\r\n"},{"labels":["bug"],"text":"I wanted to update the default directus ID field. But it automatically changes the signed and auto_increment-field. I used the directus platform for this, but also tried it manually via postman.\r\n\r\nBy default:\r\nauto_increment is true\r\nsigned is false\r\n\r\nFields I wanted to change:\r\nhidden_detail to false\r\nhidden_browse to false\r\n\r\nRequest Payload on PATCH\r\n`{\r\n    \"id\": null,\r\n    \"sort\": 1,\r\n    \"field\": \"id\",\r\n    \"type\": \"integer\",\r\n    \"datatype\": \"INT\",\r\n    \"interface\": \"primary-key\",\r\n    \"default_value\": null,\r\n    \"options\": {},\r\n    \"readonly\": 0,\r\n    \"required\": true,\r\n    \"unique\": false,\r\n    \"note\": \"\",\r\n    \"hidden_detail\": false,\r\n    \"hidden_browse\": false,\r\n    \"primary_key\": true,\r\n    \"validation\": null,\r\n    \"width\": \"full\",\r\n    \"translation\": {},\r\n    \"signed\": false\r\n}\r\n`\r\n\r\nResponse Payload:\r\n`\r\n{\"data\":{\"collection\":\"testcollection1\",\"field\":\"id\",\"datatype\":\"INT\",\"unique\":false,\"primary_key\":true,\"auto_increment\":false,\"default_value\":null,\"note\":\"\",\"signed\":true,\"id\":277,\"type\":\"integer\",\"sort\":1,\"interface\":\"primary-key\",\"hidden_detail\":false,\"hidden_browse\":false,\"required\":true,\"options\":[],\"locked\":false,\"translation\":[],\"readonly\":false,\"width\":\"full\",\"validation\":null,\"group\":null,\"length\":\"10\"}}\r\n`\r\n\r\nNow:\r\nauto_increment is set to false and\r\nsigned is set to true\r\n\r\nI tried to manually patch it back to auto_increment true and signed false, but it doesn't seem to work."},{"labels":["bug",null],"text":"Hi there,\r\ncan anybody help me how to access \"settings\" JSON?\r\nI try to access\r\n:project/settings\r\n\r\nI've grated all permissions to admin user but it is still not accessible.\r\n\r\n\r\nThanks in advance."},{"labels":["bug"],"text":"### Steps to reproduce \r\n\r\n1) Have a collections with a Date field \r\n2) filter a date lower than 2020-03-29\r\n3) filter a date greater than 2020-03-21\r\n\r\nExpected behaviour : The result is a between the two dates.\r\n\r\nActual behaviour: The api just take the first filter, not the second one. \r\n![image](https://user-images.githubusercontent.com/22716876/77286185-54b1f900-6c98-11ea-86b3-6004cd1b2ee6.png)\r\n\r\n### Why this is a problem a problem ?\r\nBecause the directus app don't have a between in the filters. And the filtering between dates is very requested by the companies\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nRunning the [CLI install:config command](https://docs.directus.io/guides/cli.html#help) results in an error on fresh installs of directus.\r\n\r\nCommand:\r\n```shell\r\n# php bin/directus install:config -h <db_host> -n <db_name> -u <db_user> -p <db_pass> -e <directus_email> -s <db_unix_socket>\r\nphp bin/directus install:config -h localhost -n testdb -u testuser -a admintoken\r\n```\r\n\r\nError:\r\n```html\r\nPHP Fatal error:  Uncaught Error: Call to a member function getContainer() on null in C:\\xampp\\htdocs\\directus\\src\\helpers\\app.php:113\r\nStack trace:\r\n#0 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Config\\SuperAdminToken.php(43): Directus\\get_app_base_path()\r\ndirectus/directus#1 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Console\\Modules\\InstallModule.php(147): Directus\\Config\\SuperAdminToken::path()\r\ndirectus/directus#2 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Console\\Modules\\ModuleBase.php(61): Directus\\Console\\Modules\\InstallModule->cmdConfig(Array, Array)\r\ndirectus/directus#3 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Console\\Cli.php(88): Directus\\Console\\Modules\\ModuleBase->runCommand('config', Array, Array)\r\ndirectus/directus#4 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Console\\Cli.php(64): Directus\\Console\\Cli->cmd()\r\ndirectus/directus#5 C:\\xampp\\htdocs\\directus\\bin\\directus(10): Directus\\Console\\Cli->run()\r\ndirectus/directus#6 {main}\r\n  thrown in C:\\xampp\\htdocs\\directus\\src\\helpers\\app.php on line 113\r\n\r\nFatal error: Uncaught Error: Call to a member function getContainer() on null in C:\\xampp\\htdocs\\directus\\src\\helpers\\app.php:113\r\nStack trace:\r\n#0 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Config\\SuperAdminToken.php(43): Directus\\get_app_base_path()\r\ndirectus/directus#1 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Console\\Modules\\InstallModule.php(147): Directus\\Config\\SuperAdminToken::path()\r\ndirectus/directus#2 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Console\\Modules\\ModuleBase.php(61): Directus\\Console\\Modules\\InstallModule->cmdConfig(Array, Array)\r\ndirectus/directus#3 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Console\\Cli.php(88): Directus\\Console\\Modules\\ModuleBase->runCommand('config', Array, Array)\r\ndirectus/directus#4 C:\\xampp\\htdocs\\directus\\src\\core\\Directus\\Console\\Cli.php(64): Directus\\Console\\Cli->cmd()\r\ndirectus/directus#5 C:\\xampp\\htdocs\\directus\\bin\\directus(10): Directus\\Console\\Cli->run()\r\ndirectus/directus#6 {main}\r\n  thrown in C:\\xampp\\htdocs\\directus\\src\\helpers\\app.php on line 113\r\n```\r\n\r\n## Steps to Reproduce\r\n\r\n```shell\r\ngit clone https://github.com/directus/directus.git ./directus\r\ncd directus\r\nphp bin/directus install:config -h localhost -n testdb -u testuser -a admintoken\r\n```\r\n\r\n## Expected Behavior\r\n\r\nDirectus should create the configuration files as detailed in the docs.\r\n\r\n## Actual Behavior\r\n\r\nDirectus throws an error.\r\n\r\n## Other Context & Screenshots\r\n\r\nThe issue [can be patched](https://github.com/Christopher-Drifter/directus/commit/f9bc1e5ff602bf00d37c536965f68ca45ad21b26#diff-5be1b1c96a9f0cbb384addcc8a0afcd9) by updating the \"get_app_base_path\" function in ```src/helpers/app.php```, but there are probably unintended consequences to this method.\r\n\r\n```php\r\nif (!function_exists('get_app_base_path')) {\r\n    /**\r\n     * Returns the application base path.\r\n     *\r\n     * @return string\r\n     */\r\n    function get_app_base_path()\r\n    {\r\n        $instance = Application::getInstance();\r\n        \r\n        if($instance === null) {\r\n            return realpath(__DIR__  . \"../../../\");    \r\n        }\r\n        \r\n        $container = Application::getInstance()->getContainer();\r\n\r\n        return $container->get('path_base');\r\n    }\r\n}\r\n```\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\nProbably not relevant for this issue.\r\n"},{"labels":["bug"],"text":"(config 'env' should NOT be set to 'production' in order to display PHP errors)\r\n\r\nCreate a collection \"my_collection\" with no items\r\nCall \"items/my_collection\" by the API with GET parameters \"offset=0&meta=filter_count\"\r\n\r\nThen a PHP Warning appear in result, which is not yet valid JSON : \r\n\r\n> Warning:  Division by zero in [...]/Directus/Database/TableGateway/RelationalTableGateway.php on line 1063\r\n\r\nThe line 1063 is :\r\n`$page = $page > $pages ? $pages : ($page && $offset >= 0 ? (floor($offset / $limit) + 1) : $page);`\r\nso with $page=1, $pages=1, $offset=0, and  $limit=0, the division $offset / $limit is executed, and the warning is thrown.\r\n\r\nNote that there is no problem if the collection is not empty."},{"labels":["bug"],"text":"Hello,\r\n\r\nI'm using directus via docker-compose, so far I used 8.5.something and recently pulled the image to update v8.6.\r\n\r\nI don't use env vars and I run multiple projects on the same instance.\r\n\r\nSince 8.6 when I want to create a new project it asks for my Super Admin password, which I enter, then I follow the steps (project info, DB), and when I click on install, it says \"Cannot find super admin token variable.\"\r\n\r\n<img width=\"343\" alt=\"Capture d‚ÄôeÃÅcran 2020-03-05 aÃÄ 02 58 41\" src=\"https://user-images.githubusercontent.com/117162/75940778-3bced880-5e8e-11ea-84fd-ace7d1b6a06f.png\">\r\n\r\nI've quickly explored the code and noticed that there's been a change recently in `src/core/Directus/Config/SuperAdminToken.php`. there: https://github.com/directus/directus/blob/9780f20d0c97251cdfddeee1bfc1d4048a8e94ff/src/core/Directus/Config/SuperAdminToken.php#L43\r\n\r\nI haven't looked around in depth, but I saw that the `SuperAdminToken::path()` is used like that since v8.6: `$this->getBasePath().SuperAdminToken::path();` so I assume there's one call of getBasePath() missing somewhere because when I want to create a new project it's looking for /config/__api.json full path and can't find it.\r\n"},{"labels":["bug"],"text":"1. Just invoking GraphQL endpoint throws `undefined method getRelation`. Most likely due to this: https://github.com/directus/api/pull/1598/files#r387401777\r\n\r\n```\r\n[2020-03-04 01:13:47] api[infrastructure].ERROR: Error: Call to undefined method Directus\\GraphQL\\FieldsConfig::getRelation() in /var/directus/src/core/Directus/GraphQL/FieldsConfig.php:80\r\nStack trace:\r\n#0 /var/directus/src/core/Directus/GraphQL/Type/FieldsType.php(18): Directus\\GraphQL\\FieldsConfig->getFields\r\n#1 /var/directus/vendor/webonyx/graphql-php/src/Type/Definition/FieldDefinition.php(90): Directus\\GraphQL\\Type\\FieldsType->Directus\\GraphQL\\Type\\{closure}\r\n#2 /var/directus/vendor/webonyx/graphql-php/src/Type/Definition/ObjectType.php(151): GraphQL\\Type\\Definition\\FieldDefinition::defineFieldMap\r\n#3 /var/directus/vendor/webonyx/graphql-php/src/Utils/TypeInfo.php(180): GraphQL\\Type\\Definition\\ObjectType->getFields\r\n#4 /var/directus/vendor/webonyx/graphql-php/src/Utils/TypeInfo.php(142): GraphQL\\Utils\\TypeInfo::extractTypes\r\n#5 /var/directus/vendor/webonyx/graphql-php/src/Utils/TypeInfo.php(200): GraphQL\\Utils\\TypeInfo::extractTypes\r\n```\r\n\r\n2. Any GraphQL query (after fixing above and endpoint loads) throws `mandatory field <string>_has was not provided`, because the optional `_has` and `_all` filters were marked as non-nullable. #1784 "},{"labels":["bug"],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n\r\nThanks!\r\n\r\n-->\r\nVersion of Directus: 8.5.5\r\n\r\nProblem:\r\n- I've created previously a Many-to-many relationship which was working fine.\r\n\r\nHere are the tables:\r\n![image](https://user-images.githubusercontent.com/32687653/75548569-e5950c00-5a2d-11ea-9d19-e60438387b5a.png)\r\n\r\nSuddenly it stopped working. I can use the many-to-many relationship by adding a new item to the table. But selecting an existing one is not possible:\r\n\r\n![image](https://user-images.githubusercontent.com/32687653/75548733-44f31c00-5a2e-11ea-8334-1d883856936d.png)\r\n\r\nFollowing the stack trace of the error:\r\n```\r\n[2020-02-28 13:28:16] api[site].ERROR: Directus\\Validator\\Exception\\InvalidRequestException: name: This value should not be blank. in /var/www/html/site.com/admin/src/core/Directus/Services/AbstractService.php:186\r\nStack trace:\r\n#0 /var/www/html/site.com/admin/src/core/Directus/Services/AbstractService.php(120): Directus\\Services\\AbstractService->throwErrorIfAny\r\ndirectus/app#1 /var/www/html/site.com/admin/src/core/Directus/Services/AbstractService.php(398): Directus\\Services\\AbstractService->validate\r\ndirectus/app#2 /var/www/html/site.com/admin/src/core/Directus/Services/ItemsService.php(237): Directus\\Services\\AbstractService->validatePayload\r\ndirectus/app#3 /var/www/html/site.com/admin/src/core/Directus/Services/ItemsService.php(349): Directus\\Services\\ItemsService->validateManyToManyCollection\r\ndirectus/app#4 /var/www/html/site.com/admin/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#5 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#6 /var/www/html/site.com/admin/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\ndirectus/app#7 /var/www/html/site.com/admin/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#8 /var/www/html/site.com/admin/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#9 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#10 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#11 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#12 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#13 /var/www/html/site.com/admin/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(124): Slim\\Route->Slim\\{closure}\r\ndirectus/app#14 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#15 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#16 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#17 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#18 /var/www/html/site.com/admin/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#19 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#20 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#21 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#22 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#23 /var/www/html/site.com/admin/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\ndirectus/app#24 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\ndirectus/app#25 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#26 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#27 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#28 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#29 /var/www/html/site.com/admin/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\ndirectus/app#30 /var/www/html/site.com/admin/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\ndirectus/app#31 /var/www/html/site.com/admin/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#32 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#33 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#34 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#35 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#36 /var/www/html/site.com/admin/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#37 /var/www/html/site.com/admin/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#38 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#39 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#40 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#41 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#42 /var/www/html/site.com/admin/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#43 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#44 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#45 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#46 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#47 /var/www/html/site.com/admin/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\ndirectus/app#48 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#49 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#50 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#51 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#52 /var/www/html/site.com/admin/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\ndirectus/app#53 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#54 /var/www/html/site.com/admin/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/app#55 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#56 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#57 /var/www/html/site.com/admin/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#58 /var/www/html/site.com/admin/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\ndirectus/app#59 /var/www/html/site.com/admin/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\ndirectus/app#60 /var/www/html/site.com/admin/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#61 /var/www/html/site.com/admin/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n## Steps to Reproduce\r\n\r\n1. Open an item in any collection\r\n2. Press \"save as copy\"\r\n\r\n## Expected Behaviour\r\nCopy is created and saved....\r\n\r\n## Actual Behaviour\r\nIn around 50% of cases I get a following error:\r\nDuplicate key \"#\" for collection \"collection name\"\r\n\r\nIt seems to be happenning for \"older\" (smaller index) items. Some items never work, some always work. Even inside the same collection some do and some don't.\r\n\r\n## Technical Details\r\nDirectus 8.5.5 (the database was previously managed usign Directus 7)\r\nPHP 7.3.8\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n500 Server error when API accessed over subdomain\r\n\r\n\r\n## Steps to Reproduce\r\nMake subdomain that points to \"directus/public\"\r\n\r\n## Expected Behavior\r\nAPI works fine when accessing it.\r\n\r\n## Actual Behavior\r\nServer error 500 when accessing it.\r\n\r\nOutput in logfile:\r\n`#0 /home/klasseyc/public_html/magazine/content/vendor/slim/slim/Slim/App.php(518): Directus\\{closure}\r\ndirectus/directus#1 /home/klasseyc/public_html/magazine/content/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->__invoke\r\ndirectus/directus#2 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/directus#3 /home/klasseyc/public_html/magazine/content/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#4 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#5 /home/klasseyc/public_html/magazine/content/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#6 /home/klasseyc/public_html/magazine/content/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/directus#7 /home/klasseyc/public_html/magazine/content/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\ndirectus/directus#8 /home/klasseyc/public_html/magazine/content/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\ndirectus/directus#9 /home/klasseyc/public_html/magazine/content/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/directus#10 /home/klasseyc/public_html/magazine/content/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2020-02-24 18:57:47] api[favicon.ico].ERROR: Directus\\Exception\\U`\r\n\r\n## Other Context & Screenshots\r\nDirectus is inside a public_html folder. Subdomain points to directus/public.\r\nThe admin app loads fine and shows the error \"Something is wrong with this project\".\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop, iPhone6, etc]\r\n- OS: Linux 3.10.0-962.3.2.lve1.5.26.9.el7.x86_64\r\n- Web Server: Apache 2.4.37\r\n- PHP Version: 7.4\r\n- Database: MySQL 8.0.12\r\n- Directus Release Version: v8.0.0-rc.2\r\n  - App Version: 8.5.5\r\n  - API Version: 8.0.0-rc.2\r\n- Install Method: FTP\r\n"},{"labels":["bug"],"text":"Currently, the API returns an error  when entering a decimal (i.e: '1.21') into a numeric field, that's set to DECIMAL using DECIMAL as mysql datatype: \r\n\r\n![image](https://user-images.githubusercontent.com/1093680/75044481-ff7c9f00-54c1-11ea-95d6-4742e23e959a.png)\r\n\r\nThis is how I created the field:\r\n![image](https://user-images.githubusercontent.com/1093680/75044420-e378fd80-54c1-11ea-820e-f1e8f39dbfe2.png)\r\n\r\nI was able to reproduce this on the docker image **directus/directus:v8.2.0-apache** as well as in the demo account (https://demo.directus.io).\r\n"},{"labels":["bug"],"text":"\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus - 8.5.5\r\n‚Ä¢¬†Error message (if any) - File not found at path: \r\n‚Ä¢¬†Steps to reproduce\r\nupload video files to files endpoint :project/files\r\nand it will response with this error {\"error\":{\"code\":null,\"message\":\"File not found at path: 161db893-0661-437d-9f42-9887c6010a99\"}}\r\n‚Ä¢¬†PHP version 7.4\r\n‚Ä¢¬†MySQL version 5.7.29\r\n‚Ä¢¬†Webserver + version apache 2.4.14\r\n\r\nThanks!\r\n\r\n"},{"labels":["bug"],"text":"I have setup a todo collection with an owner field that has interface type User.\r\nSee: \r\n![image](https://user-images.githubusercontent.com/12628251/74801132-56ecf600-529b-11ea-8678-8b259177d769.png)\r\n\r\nWhenever I create a new item and set the owner field, directus ignores my input and sets owner as the current user. I'm able to update the item and overwrite the owner later.\r\n\r\nExpected behavior: Directus would set the owner field as my current user only if I don't pass an owner in the payload for create.\r\n\r\nActual behavior: Directus discards the owner property and uses the authenticated user.\r\n\r\nVersion of Directus 8.5.4"},{"labels":["bug"],"text":"Hi there,\r\nI have seen several post about login issues, I hope this post to be useful because for me this issue is still not completely resolved.\r\n\r\n## Steps to Reproduce\r\n- with Firefox on production environment when client and server are in two distinct machines.\r\n- when I logout from the directus App, the cookie 'directus-<project>-session' is not deleted.\r\n\r\n## Expected Behavior\r\nI can sign in again.\r\n\r\n## Actual Behavior\r\nI can't sign in (Couldn't Reach API error) again, I have to manually delete this cookie.\r\n\r\n## Screenshots\r\n![cookie](https://user-images.githubusercontent.com/1088155/74417627-5097ed80-4e47-11ea-91a7-b2d2bfac2791.png)\r\n\r\n## Idea\r\nI think, it seems to be a problem of time synchronization between client and server. \r\nWhen the client logout, Directus delete the user session from Database and send to the client a new expiration time to the cookie (`DateTimeUtils::now()` : so that it can be deleted)\r\nbut as there is a short time difference between client and server, the session cookie is kept in the client browser and then maintained by pings.\r\nIf we then try to login, the client sends the token from the expired cookie and the connection fails because the user session no longer exists in the database.\r\n\r\non [src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php](https://github.com/directus/api/blob/76b8511cef5884407648046ae36da7708c662186/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php#L88) Line 88\r\nif i try to change the expiration date, instead of now I subtract one day, I solve my problem.\r\n```php\r\n$accessToken = decrypt_static_token($authorizationTokenObject['token']);\r\n$userSession = $userSessionService->find(['token' => $accessToken]);\r\n$cookie = new Cookies();\r\n$expiryAt = $userSession ? $expiry->format(\\DateTime::COOKIE) : DateTimeUtils::now()->subDays(1)->toString();\r\n$cookie->set(\r\n    get_project_session_cookie_name($request),\r\n    [\r\n        'value' => $authorizationTokenObject['token'],\r\n        'expires' => $expiryAt,\r\n        'path' => '/',\r\n        'httponly' => true\r\n    ]\r\n);\r\n```\r\n\r\n## Technical Details\r\n- Browser : Firefox 73\r\n- Directus Version : 8.5.5\r\n"},{"labels":["bug"],"text":"* Directus Version: 8.5.4\r\n\r\nWhen write access to the field is forbidden by a field-based permission in the item's current status, changes made via the API can still be saved, as long as the status is not modified in the same update.\r\n\r\nThe API does not seem to check the item's current status if the `PATCH` request payload does not contain a status change."},{"labels":["bug"],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n\r\nThanks!\r\n\r\n-->\r\n\r\nHey!\r\n\r\nI'm having issues making multiple changes to the interface options when using the WYSIWYG interface. It seems like I can only save a change to the options once. Any subsequent changes result in an error and don't stick.\r\n\r\nTo reproduce:\r\n\r\n1. Navigate to [the demo](https://demo.directus.io) and log in.\r\n2. Navigate to Settings -> collections -> news\r\n3. Click the ```body``` field and toggle a toolbar option.\r\n4. Save\r\n5. Repeat step 3 & 4\r\n6. An error occurs\r\n"},{"labels":["bug",null,null,null],"text":"A bare-bones Directus 8 project's GraphQL output looks fine in a viewer like iGraphQL, but throws all sorts of errors during compilation when importing the data into Gatsby via the `gatsby-source-graphql` plugin, as shown here:  \r\n\r\n`Error: Interface field Directus_Node.id expected but Directus_DirectusActivity does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusFileThumbnailItem does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_Metadata does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusCollection does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusCollectionItem does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusFieldItem does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusCollectionPreset does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusField does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusFile does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusFolder does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusPermission does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusRelation does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusRevision does not provide it. ` \r\n`Interface field Directus_Node.id expected but Directus_DirectusRole does not provide it.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusSetting does not provide it.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_eq\" does not.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_neq\" does not.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_contains\" does not.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_ncontains\" does not.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_rlike\" does not.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_nrlike\" does not. ` \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_empty\" does not.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_nempty\" does not.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_null\" does not.`  \r\n`Names must match /^[_a-zA-Z][_a-zA-Z0-9]*$/ but \"2fa_secret_nnull\" does not.`  \r\n`Interface field Directus_Node.id expected but Directus_DirectusUser does not provide it.`  \r\n\r\nFor reference, in the gatsby plugin config I'm using a typeName of `Directus` and a fieldName of `directus`.\r\n\r\nHonestly, I don't know if this is a Directus issue or a Gatsby issue, although the GraphQL spec says that names shouldn't start with a number, hence all the `2fa` errors above. I suspect that Gatsby requires a particular edge - node hierarchy that the GraphQL spec doesn't require and Directus doesn't provide, but that's just a guess.\r\n\r\n"},{"labels":["bug"],"text":"Sending `{ signed: false }` in a PATCH to /fields doesn't set the signed state to false for a numeric value and returns `{ signed: true }`."},{"labels":["bug"],"text":"I have trouble installing Directus on a server with nginx. Because I am not running via Apache I have to create the initial config files and this is failing.\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. `git clone git clone https://github.com/directus/directus.git`\r\n2. `php bin/directus install:config -h localhost -n database -u root -p password`\r\n3. See error\r\n\r\n## Expected Behavior\r\n\r\nUnder previous versions (version 7?) step 2 would be successful and allow me to proceed with seeding the database\r\n\r\n## Actual Behavior\r\n\r\nScript errors out with:\r\n\r\n```\r\nPHP Fatal error:  Uncaught Error: Call to a member function getContainer() on null in /Users/user/Sites/directus/src/helpers/app.php:113\r\nStack trace:\r\n#0 /Users/user/Sites/directus/src/core/Directus/Config/SuperAdminToken.php(43): Directus\\get_app_base_path()\r\n```\r\n\r\n## Technical Details\r\n\r\n- Device: Macbook Pro\r\n- OS: MacOS 10.15.3\r\n- Web Server: nginx\r\n- PHP Version: 7.3.7\r\n- Database: MySQL 8.0.12\r\n- Directus Release Version: v.8.5.4\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"When I uncheck \"Hidden on browse\" for the ID field, I can't create Items in this collection from the API nor the UI (app).\r\n\r\nI get a 422 error from the API and this is what I find in directus logs :\r\n`ERROR: Directus\\Validator\\Exception\\InvalidRequestException: id: This value should not be blank. in /var/www/directus/src/core/Directus/Services/AbstractService.php:186`\r\n\r\n‚Ä¢¬†Version of Directus : 8.5.3\r\n\r\nThanks!\r\n\r\nEdit:\r\nI still get the same error when I check it again. I had to delete the collection and create another one where \"Hidden on browse\" is checked to make it work."},{"labels":["bug"],"text":"I can't filter with Owner (user created) because it shows error Graphql.\r\nI consulted GraphQL schema, but it doesn't appear created_by or owner.\r\nCollection \"Event\" has owner field.\r\n\r\n‚Ä¢ Version of Directus\r\n8.4.0 (DigitalOcean)\r\n\r\n‚Ä¢ PHP version\r\n7.2.24-0ubuntu0.18.04.2\r\n\r\n‚Ä¢ MySQL version\r\nServer version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)\r\n\r\n‚Ä¢ Webserver + version\r\nserver Apache/2.4.29 (Ubuntu)\r\n\r\n‚Ä¢ Error message (if any)\r\n\r\n**Graphql Query:**\r\n```\r\nquery Event{\r\n  Event(filter: { created_by_eq: 1 })  {\r\n    data {\r\n      name\r\n    } \r\n  }\r\n}\r\n\r\n```\r\n\r\n**Output Graphql:**\r\n```\r\n{\r\n  \"errors\": [\r\n    {\r\n      \"message\": \"Field \\\"created_by_eq\\\" is not defined by type EventFilter; Did you mean created_on_eq, created_on_neq, created_on_lt, created_on_gt, or created_on_in?\",\r\n      \"extensions\": {\r\n        \"category\": \"graphql\"\r\n      },\r\n      \"locations\": [\r\n        {\r\n          \"line\": 2,\r\n          \"column\": 21\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n### **I tried the \"owner\" field**\r\n\r\n**Graphql Query:**\r\n```\r\nquery Event{\r\n  Event(filter: { owner_eq: 1 })  {\r\n    data {\r\n      name\r\n    } \r\n  }\r\n}\r\n\r\n```\r\n\r\n**Output Graphql:**\r\n```\r\n{\r\n  \"errors\": [\r\n    {\r\n      \"message\": \"Field \\\"owner_eq\\\" is not defined by type EventFilter; Did you mean name_eq or ean_eq?\",\r\n      \"extensions\": {\r\n        \"category\": \"graphql\"\r\n      },\r\n      \"locations\": [\r\n        {\r\n          \"line\": 2,\r\n          \"column\": 21\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n"},{"labels":["bug"],"text":"‚Ä¢¬†Version of Directus: v8.5.4\r\n‚Ä¢¬†Error message (if any)\r\n```shell\r\napi_1             | [2020-02-08 12:27:18] api[xxxxxx].ERROR: Directus\\Exception\\SQLException: Statement could not be executed (42000 - 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(16777215) Null' at line 1) in /var/www/html/src/endpoints/Fields.php:122\r\napi_1             | Stack trace:\r\napi_1             | #0 [internal function]: Directus\\Api\\Routes\\Fields->update\r\napi_1             | #1 /var/www/html/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\napi_1             | #2 /var/www/html/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\napi_1             | #3 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\napi_1             | #4 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\napi_1             | #5 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #6 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #7 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #8 /var/www/html/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(124): Slim\\Route->Slim\\{closure}\r\napi_1             | #9 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\napi_1             | #10 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #11 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #12 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #13 /var/www/html/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\napi_1             | #14 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\napi_1             | #15 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #16 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #17 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #18 /var/www/html/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\napi_1             | #19 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\napi_1             | #20 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #21 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #22 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #23 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\napi_1             | #24 /var/www/html/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\napi_1             | #25 /var/www/html/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\napi_1             | #26 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\napi_1             | #27 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\napi_1             | #28 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #29 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #30 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #31 /var/www/html/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\napi_1             | #32 /var/www/html/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\napi_1             | #33 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\napi_1             | #34 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #35 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #36 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #37 /var/www/html/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\napi_1             | #38 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\napi_1             | #39 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #40 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #41 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #42 /var/www/html/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\napi_1             | #43 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\napi_1             | #44 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #45 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #46 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #47 /var/www/html/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\napi_1             | #48 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\napi_1             | #49 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\napi_1             | #50 [internal function]: Slim\\DeferredCallable->__invoke\r\napi_1             | #51 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\napi_1             | #52 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\napi_1             | #53 /var/www/html/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\napi_1             | #54 /var/www/html/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\napi_1             | #55 /var/www/html/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\napi_1             | #56 /var/www/html/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n‚Ä¢¬†Steps to reproduce\r\nThis is a reproduce in Directu Demo site.\r\n![bug](https://user-images.githubusercontent.com/1665522/74085310-d831d500-4ab2-11ea-859c-8df650043a8c.gif)\r\n\r\n‚Ä¢¬†PHP version: 7.4.2\r\n‚Ä¢¬†MySQL version: both v5.7.28 and v8.0.18\r\n‚Ä¢¬†Webserver + version: Caddy v1.0.4\r\n\r\nMaybe is the same problem of https://github.com/directus/api/issues/1722"},{"labels":["bug"],"text":"‚Ä¢¬†Version of Directus\r\n8.4.0 (DigitalOcean)\r\n\r\n‚Ä¢¬†PHP version\r\n7.2.24-0ubuntu0.18.04.2\r\n\r\n‚Ä¢¬†MySQL version\r\nServer version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)\r\n\r\n‚Ä¢¬†Webserver + version\r\nserver Apache/2.4.29 (Ubuntu)\r\n\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n\r\nI have a problem authenticating for Request login access API, \r\n_(http://{{ baseUrl  }}/{{ projectUrl  }}/auth/authenticate)_ but it‚Äôs not email or password. Third party token access like facebook or google token but from API (not from UI dashboard). Try to do it by creating webhook, but I don‚Äôt know what is not good method."},{"labels":["bug"],"text":"I'm wondering why I'll get no POST or GET data via webhooks when updating an entry. So I tested different directus versions.\r\n\r\nIn v8.2.0 I'll get the data, since v8.3.0 no data will be submitted over HTTP request."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1.  Create a collection\r\n2. Create a repeater interface field\r\n3. Inside the repeater, create one dropdown field with 4 keys, and 3 text input fields\r\n4. Save the field\r\n5. Go to the collection, create one register and fill the repeater with one field\r\n6. Try to update the repeater field, either by changing the input icon, or changing the placeholders, or doing whatever\r\n\r\n## Expected Behavior\r\n\r\nThe field updates without problems\r\n\r\n## Actual Behavior\r\n\r\nThe field does not updated, an error appears\r\n\r\n## Other Context & Screenshots\r\n\r\n![image](https://user-images.githubusercontent.com/14786440/73965326-3e342600-4914-11ea-85b5-5679a9ae3473.png)\r\n\r\nRequest payload generated by the APP:\r\n\r\n`{\"id\":3461,\"sort\":8,\"field\":\"kids_and_babies_sizes\",\"type\":\"json\",\"datatype\":\"MEDIUMTEXT\",\"interface\":\"repeater\",\"default_value\":null,\"options\":{\"placeholder\":\"New Item...\",\"createItemText\":\"Create Item\",\"limit\":null,\"structure\":\"array\",\"template\":\"{{category}} - {{code}}\",\"fields\":[{\"field\":\"category\",\"width\":\"half\",\"interface\":\"dropdown\",\"type\":\"string\",\"options\":{\"choices\":{\"Babies\":\"babies\",\"Kids\":\"kids\",\"Other sizes\":\"other\"},\"icon\":\"accessibility_new\"}},{\"field\":\"code\",\"width\":\"half\",\"interface\":\"text-input\",\"type\":\"string\",\"options\":{\"iconLeft\":\"format_size\"}},{\"field\":\"weight\",\"width\":\"half\",\"interface\":\"text-input\",\"type\":\"string\",\"options\":[]},{\"field\":\"height\",\"width\":\"half\",\"interface\":\"text-input\",\"type\":\"string\",\"options\":[]}]},\"readonly\":false,\"required\":false,\"unique\":false,\"note\":\"\",\"hidden_detail\":false,\"hidden_browse\":false,\"primary_key\":false,\"validation\":null,\"width\":\"full\",\"translation\":{}}`\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop, iPhone6, etc]\r\n- OS: [eg: MacOS 10.13.6, Windows 10.1803]\r\n- Web Server: [eg: Apache 2.4.37]\r\n- PHP Version: [eg: 7.2.0]\r\n- Database: [eg: MySQL 8.0.12]\r\n- Directus Release Version: [eg: v8.0.0-rc.1]\r\n  - App Version: [eg: 7.11.0] (include if Directus Release Version <=`190927A`)\r\n  - API Version: [eg: 2.6.0] (include if Directus Release Version <=`190927A`)\r\n- Install Method: [eg: cloned `master` branch]\r\n"},{"labels":["bug",null],"text":"‚Ä¢¬†Version of Directus: 8.4.0\r\n‚Ä¢¬†Error message (if any):\r\n\"Trouble processing request\"\r\nIn console: Request to get items return a 500 \r\n‚Ä¢¬†Steps to reproduce:\r\n\r\nSetup a Collection\r\n- Add M2O field \"Parent\" linked to the same collection\r\n- Add O2M field \"Children\" linked to Parent\r\n\r\nEverything works fine until you have few elements, but if you try to edit an item with many children (in my case more than 300) the app cannot load the interface (cf. screenshot).\r\n\r\nExtra details:\r\n- I tried to change the default limit (more than the children)\r\n- After tests, the bug appear also with two different collections\r\n- Everything works fine in API\r\n\r\n![Capture d‚ÄôeÃÅcran 2020-02-05 aÃÄ 17 22 03](https://user-images.githubusercontent.com/9443918/73861397-3fdeea80-483d-11ea-8acc-63f6a3aef579.png)\r\n"},{"labels":["bug"],"text":"v8.5.4\r\n\r\nAltering \r\n![image](https://user-images.githubusercontent.com/44196248/73950248-e1c50c80-48fb-11ea-9043-569fe008bc72.png)\r\n\r\nTo active state and save results in (this is from two different fields where the \"truncated\" file is the current filename)\r\n\r\n![image](https://user-images.githubusercontent.com/44196248/73950235-dbcf2b80-48fb-11ea-89ed-b9530a58fd8a.png)\r\n\r\nAnd the result is that the fields required state is unaltered."},{"labels":["bug"],"text":"Hello,\r\n\r\nFollowing of https://github.com/directus/directus/issues/2563, tested in latest 8.5.3.\r\n\r\nThe new filename_downloaded / filename_disk is causing some trouble as the filename is modified by directus and we do not have the choice to use the original filename to retrieve it through directus API.\r\n\r\nSo to be precise, we have two things :\r\n\r\n- The filename-disk replace the `_` by `-` in the filename when importing a file.\r\n- The filename-download is not used when choosing to use the File Name (Readable) for the links. (still using the filename-disk), No options to do that."},{"labels":["bug"],"text":"Hi there,\r\n\r\nI recently had problems uploading audio files (v8.4.0). The upload worked but the JSON response coming from the server was corrupt due to PHP warnings.\r\n\r\n`<b>Notice</b>: Trying to get property 'format' of non-object in <b>/www/htdocs/dev/src/core/Directus/Filesystem/Files.php</b> on line <b>337</b><br /> <br /> <b>Notice</b>: Trying to get property 'duration' of non-object in <b>/www/htdocs/dev/src/core/Directus/Filesystem/Files.php</b> on line <b>337</b><br />`\r\n\r\nI found out that ffmpeg / ffprobe is used to retrieve the format and the duration of the audios I uploaded, but on my shared hosting none of those is installed.\r\nI wonder if it'd be possible to insert some conditions in PHP checking that ffprobe returns valid results instead of just assuming it like so:\r\n\r\n`if( is_object($media) && $media->format && $media->format->duration){\r\n                $duration = $media->format->duration;\r\n }`\r\n\r\nCheers"},{"labels":["bug"],"text":"1. Version of Directus: 8.5.3\r\n2. Steps to reproduce:\r\n![bug](https://user-images.githubusercontent.com/1665522/73845766-4762bb80-485e-11ea-8c42-380701e16431.gif)\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nI followed the steps from here https://docs.directus.io/guides/upgrading.html#manually-upgrading-ftp-installs and also from the release notes about migrating from 7->8. However, when I try to access the login page, I get \"Request failed with status code 500\" message. From logs, I see the following\r\n\r\n[2019-12-30 16:56:37] api[paper-reviewer].ERROR: Directus\\Exception\\UnauthorizedException: Unauthorized request in ...../src/helpers/app.php:286\r\n\r\nI first installed the Directus through softaculous, since I am on a shared host. I did the upgrade through FTP and I don't have access on ssh.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Install 7.0.20\r\n2. Do a manual upgrade through FTP to 8.3\r\n3. Try to open the login page\r\n\r\n## Expected Behavior\r\n\r\nLet me put my credentials. Show login form\r\n\r\n## Actual Behavior\r\n\r\nLogin form is not there and I have the above error message\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to the file library in the directus online demo (or your own installation)\r\n2. Click on 'add file'\r\n3. Switch to \"embed\"\r\n4. Paste a youtube link into the field\r\n5. Click 'save' to queue the link\r\n6. see request with code 422 in the network panel\r\n\r\n    {\"error\":{\"code\":4,\"message\":\"An empty file is not allowed.\"}}\r\n¬†\r\n--\r\n\r\n## Expected Behavior\r\nYoutube Video will be saved in the file library\r\n\r\n## Actual Behavior\r\nCode 422 thrown in the network panel, error toast in UI\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Mac OS / Firefox, Chrome\r\n- Web Server: https://demo.directus.io/\r\n- PHP Version: https://demo.directus.io/\r\n- Database: https://demo.directus.io/\r\n- Directus Release Version: v8.4.0\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nIf I add any other auth provider than one of the core extensions (facebook, google, etc.) the array at the following line of code is returned empty:\r\n\r\nhttps://github.com/directus/directus/blob/c894e6730a20172c578457f54ad00516fdb583c9/src/core/Directus/Application/CoreServicesProvider.php#L752\r\n\r\nSo I can't register any custom auth provider.\r\n\r\nCould it be that the config schema is the source of the problem? I can just guess at the moment that everything that is not part of the scheme gets removed from the config at runtime.\r\n\r\nhttps://github.com/directus/directus/blob/c894e6730a20172c578457f54ad00516fdb583c9/src/core/Directus/Config/Schema/Schema.php#L120"},{"labels":["bug"],"text":"I have the following constellation:\r\n\r\n\"Articles\" Collection with fields `title`, `content`, `public_excerpt`.\r\nUnder roles and permission I have set public access for the article collection (published) but restricted the fileds to `title` and `public_excerpt`. (So only an authenticated user could access the `content`field.)\r\n\r\nWhen I query the articles endpoint, everything works as expected. But when I add `?fields=content`\r\n I get access to the field I shouldn't.\r\n\r\n‚Ä¢¬†Version of Directus: 8.4.0\r\n‚Ä¢¬†PHP version: 7.3.8\r\n‚Ä¢¬†MySQL version: 5.7.26\r\n‚Ä¢¬†Webserver + version: Apache 2.2.34"},{"labels":["bug"],"text":"https://github.com/directus/api/pull/1609 added the messages key which is great. It should only be returned if there are any messages though, right now `messages` returns an empty array"},{"labels":["bug"],"text":"I've installed a new version of Directus using 8.4.0\r\n\r\nWhen creating a new (first) collection I get `Trouble processing request. Try again after refreshing the page.`. In the network tab this appears as a 403 Forbidden error.\r\n\r\nIf I remove `status` from the default fields then it will submit correctly and create the collection.\r\n\r\nCreating this field on the collection page also gives a 403 error. I get 403 on Text fields as well"},{"labels":["bug"],"text":"Following the directions at https://github.com/directus/directus/releases/tag/v8.0.0\r\n\r\nI successfully upgraded directus to 8 from 7. However, only one of my two projects works. The other immediately gives me a generic error message when I select it from the login menu.\r\n\r\n<img width=\"376\" alt=\"Screen Shot 2020-01-28 at 5 49 06 PM\" src=\"https://user-images.githubusercontent.com/320494/73321173-7cd02f00-41f6-11ea-82ff-7f4f339b1a20.png\">\r\n\r\nThe XHR response is just\r\n\r\n`error: {code: null, message: \"Internal Server Error\"}`\r\n\r\nAnd nothing is logged into directus/logs/error.*.log so I'm not sure where to go from here."},{"labels":["bug"],"text":"I had a Directus 7 instance where the value of the auto_sign_out setting was set to `null`, which was a working value.\r\n\r\nAfter migrating to Directus 8, the login began to fail with the following error:\r\n```\r\napi[_].ERROR: Exception: DateTimeImmutable::__construct(): Failed to parse time string (now + minutes) at position 4 (+): Unexpected character in /var/directus/src/endpoints/Auth.php:120\r\nStack trace:\r\n#0 /var/directus/src/endpoints/Auth.php(120): DateTimeImmutable->__construct\r\n#1 /var/directus/src/endpoints/Auth.php(73): Directus\\Api\\Routes\\Auth->storeCookieSession\r\n#2 [internal function]: Directus\\Api\\Routes\\Auth->authenticate\r\n#3 /var/directus/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#4 /var/directus/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#5 /var/directus/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->__invoke\r\n#6 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#7 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#8 [internal function]: Slim\\DeferredCallable->__invoke\r\n#9 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#10 /var/directus/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\n#11 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\n#12 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#13 [internal function]: Slim\\DeferredCallable->__invoke\r\n#14 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#15 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#16 /var/directus/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#17 /var/directus/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#18 /var/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#19 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#20 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#21 [internal function]: Slim\\DeferredCallable->__invoke\r\n#22 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#23 /var/directus/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#24 /var/directus/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#25 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#26 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#27 [internal function]: Slim\\DeferredCallable->__invoke\r\n#28 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#29 /var/directus/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#30 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#31 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#32 [internal function]: Slim\\DeferredCallable->__invoke\r\n#33 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#34 /var/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\n#35 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#36 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#37 [internal function]: Slim\\DeferredCallable->__invoke\r\n#38 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#39 /var/directus/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\n#40 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#41 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#42 [internal function]: Slim\\DeferredCallable->__invoke\r\n#43 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#44 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#45 /var/directus/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#46 /var/directus/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#47 /var/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n```\r\n\r\nI needed to manually access database and set a value for auto_sign_out (i.e. 10080, like in a fresh install) to make it working."},{"labels":["bug"],"text":"On a fresh setup of Directus 8.4.0, with Redis as cache backend, the login to the app fails after setting a project logo.\r\n\r\n**Steps to reproduce**\r\n- Create this docker-compose file\r\n```yaml\r\n---\r\nversion: \"3\"\r\n\r\nservices:\r\n  redis:\r\n    image: redis\r\n\r\n  db:\r\n    image: \"mysql:5.7\"\r\n    environment:\r\n      MYSQL_DATABASE: directus\r\n      MYSQL_USER: directus\r\n      MYSQL_PASSWORD: directus\r\n      MYSQL_RANDOM_ROOT_PASSWORD: \"yes\"\r\n\r\n  directus:\r\n    image: directus/directus:v8-apache\r\n    ports:\r\n      - \"8080:80\"\r\n    environment:\r\n      DIRECTUS_AUTH_PUBLICKEY:      \"123456\"\r\n      DIRECTUS_AUTH_SECRETKEY:      \"654321\"\r\n      DIRECTUS_CACHE_ENABLED:       \"true\"\r\n      DIRECTUS_CACHE_POOL_ADAPTER:  redis\r\n      DIRECTUS_CACHE_POOL_HOST:     redis\r\n      DIRECTUS_CACHE_POOL_PORT:     \"6379\"\r\n      DIRECTUS_DATABASE_HOST:       db\r\n      DIRECTUS_DATABASE_NAME:       directus\r\n      DIRECTUS_DATABASE_USERNAME:   directus\r\n      DIRECTUS_DATABASE_PASSWORD:   directus\r\n      DIRECTUS_INSTALL_EMAIL:       test@test.it     \r\n      DIRECTUS_INSTALL_PASSWORD:    supersecret\r\n    links:\r\n      - db:db\r\n```\r\n- Start the project:\r\n```sh\r\ndocker-compose up -d\r\n```\r\n- Install Directus:\r\n```sh\r\ndocker-compose run directus install\r\n```\r\n- Navigate to http://localhost:8080 and login with user _test@test.it_ and password _supersecret_ (the login will succeed)\r\n- Go to _Settings_ -> _Global settings_ and upload an image as _Project logo_. Save the settings.\r\n- Log out and try to log in again. The login will fail with a generic `Couldn't Reach API`.\r\n\r\nAt this point, if I flush the Redis cache with `docker-compose exec redis redis-cli flushall` the login will work for one time. Then, if I log out and in again, it won't work until I flush the cache again.\r\n\r\nThis doesn't happen if I disable the cache."},{"labels":["bug"],"text":"This bug happens only when \"env\" is set to \"staging\" or \"development\" in configuration file (because \"production\" value silences the error).\r\n\r\nHere is how to reproduce it :\r\n\r\nCreate a collection \"test_a\" and two items of it.\r\nCreate a collection \"test_b\" with a \"test_a\" field in a M2O relation with \"test_a\" collection.\r\nCreate one item of test_b, the try to update its \"test_a\" field with a PATCH request.\r\nThen the JSON returned by the API cannot be parsed because of a PHP warning inserted:\r\n`warning:  array_filter() expects parameter 1 to be array, string given in [...]/src/core/Directus/Services/ItemsService.php on line 177`\r\n\r\n(Tested with Directus 8.4.0)"},{"labels":["bug"],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n‚Ä¢¬†PHP version\r\n‚Ä¢¬†MySQL version\r\n‚Ä¢¬†Webserver + version\r\n\r\nThanks!\r\n\r\n-->\r\nHi there,\r\nI got the following in response to a _PATCH_ request: \r\n### Request:\r\n**method**: PATCH\r\n**url**: {{host}}/{{project}}/items/registry/3\r\n**payload**: {\"national_id\": \"UPDATED\"}\r\n### Response:\r\n`{\r\n    \"error\": {\r\n        \"code\": 203,\r\n        \"message\": \"registry  1\",\r\n        \"class\": \"Directus\\\\Database\\\\Exception\\\\ItemNotFoundException\",\r\n        \"file\": \"/home/afinazzi/clash/directus/src/core/Directus/Services/ItemsService.php\",\r\n        \"line\": 137\r\n    }\r\n}<br />\r\n<b>Notice</b>:  Undefined variable: id in <b>/home/afinazzi/clash/directus/src/core/Directus/Services/ItemsService.php</b> on line <b>137</b><br />`\r\n\r\nI modified line 137 just for debugging purpose (actually trying to solve another issue) and it's looking like:\r\n`                throw new ItemNotFoundException($collection.' '.$id.' '.$acl);`\r\n\r\nIt turned out to be an **unauthorized request** instead (everything's ok with a valid token).\r\n\r\n### Expected behaviour:\r\nI was expecting an _Unauthorized_ error.\r\n\r\nThanks!"},{"labels":["bug"],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n\r\nThanks!\r\n\r\n-->\r\n\r\nVersion - v8.4.0\r\nError Message - id: This value should not be blank.\r\n\r\nSteps\r\n\r\n- Created new collection - turn on the Sort toggle, Modified On and Modified By\r\n- Edit the Default primary key column 'id' by selecting it\r\n- Go to schema Tab, Turn off 'Hidden on Browse'\r\n- Click on 'Next'\r\n- Click on 'Save'\r\n- Go to the newly created collection to add new Row\r\n- Click  on '+' at top right\r\n- You will see only status with default 'Draft' selected - Leave it as is\r\n- Click on 'Tick' button at top right.\r\n- Displays Error Message 'id: This value should not be blank.'\r\n\r\nMy expectation is that the id column should be displayed on the list, but during add/edit, should not display. During add it should auto generate the id."},{"labels":["bug"],"text":"# Bug Report\r\n\r\nWhen trying to upgrade from V7.0.18 to the latest version (according the instructions on https://docs.directus.io/guides/upgrading.html & the migration notes as described[ here](https://github.com/directus/directus/releases/tag/v8.0.0l)) I'm getting the following error when opening the login page:\r\n\r\nSQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'template\\\":[{\\\"title\\\":\\\"$t:collections\\\",\\\"include\\\":\\\"collections\\\"},{\\\"title\\' at line 1\r\n\r\nfull stack trace: \r\n\r\n`[2020-01-22 21:15:52] api[mafest].ERROR: PDOException: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'template\\\":[{\\\"title\\\":\\\"$t:collections\\\",\\\"include\\\":\\\"collections\\\"},{\\\"title\\' at line 1 in 'path to directus directory'/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php:134\r\nStack trace:\r\n#0 'path to directus directory'/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php(134): PDO->exec\r\ndirectus/directus#1 'path to directus directory'/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/AdapterWrapper.php(171): Phinx\\Db\\Adapter\\PdoAdapter->execute\r\ndirectus/directus#2 'path to directus directory'/vendor/robmorgan/phinx/src/Phinx/Migration/AbstractMigration.php(221): Phinx\\Db\\Adapter\\AdapterWrapper->execute\r\ndirectus/directus#3 'path to directus directory'/migrations/upgrades/20190318173400_add_nav_override.php(24): Phinx\\Migration\\AbstractMigration->execute\r\ndirectus/directus#4 'path to directus directory'/vendor/robmorgan/phinx/src/Phinx/Migration/Manager/Environment.php(127): AddNavOverride->up\r\ndirectus/directus#5 'path to directus directory'/vendor/robmorgan/phinx/src/Phinx/Migration/Manager.php(375): Phinx\\Migration\\Manager\\Environment->executeMigration\r\ndirectus/directus#6 'path to directus directory'/vendor/robmorgan/phinx/src/Phinx/Migration/Manager.php(351): Phinx\\Migration\\Manager->executeMigration\r\ndirectus/directus#7 'path to directus directory'/src/core/Directus/Util/Installation/InstallerUtils.php(244): Phinx\\Migration\\Manager->migrate\r\ndirectus/directus#8 'path to directus directory'/src/core/Directus/Util/Installation/InstallerUtils.php(231): Directus\\Util\\Installation\\InstallerUtils::runMigrationAndSeeder\r\ndirectus/directus#9 'path to directus directory'/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(13): Directus\\Util\\Installation\\InstallerUtils::updateTables\r\ndirectus/directus#10 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\ndirectus/directus#11 'path to directus directory'/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#12 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#13 'path to directus directory'/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#14 'path to directus directory'/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/directus#15 'path to directus directory'/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\ndirectus/directus#16 'path to directus directory'/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\ndirectus/directus#17 'path to directus directory'/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/directus#18 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/directus#19 'path to directus directory'/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#20 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#21 'path to directus directory'/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#22 'path to directus directory'/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/directus#23 'path to directus directory'/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/directus#24 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/directus#25 'path to directus directory'/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#26 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#27 'path to directus directory'/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#28 'path to directus directory'/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/directus#29 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/directus#30 'path to directus directory'/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#31 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#32 'path to directus directory'/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#33 'path to directus directory'/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\ndirectus/directus#34 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/directus#35 'path to directus directory'/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#37 'path to directus directory'/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#38 'path to directus directory'/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\ndirectus/directus#39 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/directus#40 'path to directus directory'/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#41 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#42 'path to directus directory'/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#43 'path to directus directory'/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/directus#44 'path to directus directory'/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\ndirectus/directus#45 'path to directus directory'/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\ndirectus/directus#46 'path to directus directory'/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/directus#47 'path to directus directory'/public/index.php(5): Directus\\Application\\Application->run [] []`\r\n\r\nI have no issues when performing a new installation from the latest version. \r\n\r\nMy guess is that the autom. db schema upgrade fails. I'm getting the same error when trying to upgrade the db via CLI (with the command bin/directus db:upgrade -N project-name). \r\n\r\nAny suggestions ?\r\n\r\n## Technical Details\r\n\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: 7.2.16\r\n- Database: mysql  Ver 14.14 Distrib 5.7.28, for Linux (x86_64)\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"Values returned in `/settings` should be typecast the same as other fields in the system.\r\n\r\nFor example, the boolean value for `telemetry` is returned as `\"1\"` instead of `true`:\r\n\r\n```json\r\n {\r\n    \"id\": 22,\r\n    \"key\": \"telemetry\",\r\n    \"value\": \"1\"\r\n}\r\n```\r\n\r\n---\r\n\r\n@bjgajjar The app used to contain all sorts of hacks and checks to work around these API inconsistencies, but now is the time to tighten all this stuff up üôÇ "},{"labels":["bug"],"text":"As mentioned in the title,\r\n\r\nWhenever you create a new item in a collection, it creates the item and then an activity (create) in the database. The hook item.create.[collection] works fine, but the one for item.create.directus_activity does not.\r\n\r\nHowever, it works if you update an existing collection item.\r\n\r\nVersion 8.0.0-rc.2"},{"labels":["bug"],"text":"I have an error in one of my m2m relations. I have a courses and a lessons collection with a relational table. The lessons have a string input \"name\", which i want to display in the app, so i selected \"name\" as \"visible column\":\r\n![image](https://user-images.githubusercontent.com/47600858/72886554-4aac6200-3d0a-11ea-9661-9c2d4cd6e742.png)\r\n\r\nThe I try to select an existing lesson in the app but I get an empty modal and no lessons to select. In the console I get an error 500 for the API call:\r\nhttps://myapiurl.com/lessons?limit=200&offset=0&meta=*&fields[0]=name.*&fields[1]=id&sort=name\r\n\r\nI found out that the problem is the .* after the name field. If I remove this, I get a valid result.\r\nWhy is this .* used here? Is this a bug or do I have to change something?\r\n"},{"labels":["bug"],"text":"If I post `default_value: \"1\"` from the app, the API returns `default_value: null`. \r\n\r\nCould it be that the API doesn't cast the provided values to the datatype of the field (anymore) before setting the default value @bjgajjar? This used to work before.\r\n\r\nThe default value input in the app is a text-input, so all values will be provided as a string."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\nBased on https://docs.directus.io/guides/cli.html#install-module\r\n\r\n1. Go to CLI\r\n2. Run `bin/directus install:config -n <database-name> -u <database-user> -p <database-pwd> -N <projectname> -a <superadmin-token>`\r\n\r\n## Expected Behavior\r\nA config file is created `config/<projectname>.php`\r\n\r\n## Actual Behavior\r\nThe config file is named after the Super Admin Token : `config/<superadmin-token>.php` and everything in the config file use the token instead of projectname too.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Directus 8.4.0\r\n"},{"labels":["bug"],"text":"How to reproduce:.\r\nThe example below shows the request to both `Many To Many` and `File` fields to see the difference in response.\r\n\r\n1. Create `Many To Many` collection `C2 Files M2M` with `Text input` `cust_url`.\r\n2. Create `C2 URL` collection with fields:\r\n - `file_rel` of type `File`,\r\n - `file_m2m` of type `Many To Many` and connect it to the created in (1) `C2 Files M2M` using an auto created junction table,\r\n3. Request detailed fields from both `file_rel` and `file_m2m`. The request is\r\n`items/c2_url?fields=file_rel.data.full_url,file_m2m.c2_files_m2m_id.cust_url`.\r\nThe response is:\r\n{'data': [{'file_m2m': [{'c2_files_m2m_id': {'cust_url': 'http://cust_url'}}],\r\n           'file_rel': {'data': {'embed': None,\r\n                                 'full_url': 'http://127.0.0.1:8100/uploads/test_prj/originals/12da88ce-41c6-473c-af9d-714e2702efa9.jpg',\r\n                                 'thumbnails': [{'dimension': '64x64',\r\n                                                 'height': 64,\r\n                                                 'relative_url': '/test_prj/assets/qvl55kb665cg480o?key=directus-small-crop',\r\n                                                 'url': 'http://127.0.0.1:8100/test_prj/assets/qvl55kb665cg480o?key=directus-small-crop',\r\n                                                 'width': 64},\r\n                                                {'dimension': '64x64',\r\n                                                 'height': 64,\r\n                                                 'relative_url': '/test_prj/assets/qvl55kb665cg480o?key=directus-small-contain',\r\n                                                 'url': 'http://127.0.0.1:8100/test_prj/assets/qvl55kb665cg480o?key=directus-small-contain',\r\n                                                 'width': 64},\r\n                                                {'dimension': '300x300',\r\n                                                 'height': 300,\r\n                                                 'relative_url': '/test_prj/assets/qvl55kb665cg480o?key=directus-medium-crop',\r\n                                                 'url': 'http://127.0.0.1:8100/test_prj/assets/qvl55kb665cg480o?key=directus-medium-crop',\r\n                                                 'width': 300},\r\n                                                {'dimension': '300x300',\r\n                                                 'height': 300,\r\n                                                 'relative_url': '/test_prj/assets/qvl55kb665cg480o?key=directus-medium-contain',\r\n                                                 'url': 'http://127.0.0.1:8100/test_prj/assets/qvl55kb665cg480o?key=directus-medium-contain',\r\n                                                 'width': 300},\r\n                                                {'dimension': '800x600',\r\n                                                 'height': 600,\r\n                                                 'relative_url': '/test_prj/assets/qvl55kb665cg480o?key=directus-large-crop',\r\n                                                 'url': 'http://127.0.0.1:8100/test_prj/assets/qvl55kb665cg480o?key=directus-large-crop',\r\n                                                 'width': 800},\r\n                                                {'dimension': '800x600',\r\n                                                 'height': 600,\r\n                                                 'relative_url': '/test_prj/assets/qvl55kb665cg480o?key=directus-large-contain',\r\n                                                 'url': 'http://127.0.0.1:8100/test_prj/assets/qvl55kb665cg480o?key=directus-large-contain',\r\n                                                 'width': 800}],\r\n                                 'url': '/uploads/test_prj/originals/12da88ce-41c6-473c-af9d-714e2702efa9.jpg'}}}]}\r\n\r\nThe response returns only the requested field for `file_m2m` and all available fields for `file_res` even only one field was requested.\r\n\r\nThe response is the same for the variations of `file_rel.data`:\r\n`items/c2_url?fields=file_rel.data,file_m2m.c2_files_m2m_id.cust_url`,\r\n`items/c2_url?fields=file_rel.data.full_url,file_m2m.c2_files_m2m_id.cust_url`,\r\n`items/c2_url?fields=file_rel.data.thumbnails.url,file_m2m.c2_files_m2m_id.cust_url`.\r\nMoreover, the request for non-existent field `file_rel.data.no_such_field`\r\n'items/c2_url?fields=file_rel.data.no_such_field,file_m2m.c2_files_m2m_id.cust_url'  returns the same result.\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n1. Create a new collection\r\n2. Add a text or status field\r\n3. Set a default value\r\n4. Save the field\r\n5. Open the field again: the default value is gone\r\n\r\n## Expected Behavior\r\n\r\nThe default value is stored in the table's schema.\r\n\r\n## Actual Behavior\r\n\r\nThe default value is not stored in the table's schema.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop / Firefox 72.0.1\r\n- OS: macOS Catalina 10.15.2\r\n- Web Server: nginx 1.14\r\n- PHP Version: 7.3\r\n- Database: tested on MariaDB 10.2, 10.3 and MySQL 8.0.15\r\n- Directus Release Version: 8.4.0\r\n- Install Method: clone, checkout of v8.4.0 tag\r\n\r\nGoing back to 8.3.1 solves the issue."},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n1. Activate cache (redis for example)\r\n2. Login for the first time\r\n3. When the token expire you'll be redirected to login page again\r\n4. Try to login (with or without 2FA) and you get an error \"Couldn't Reach API\" but if you see the response from api the json is ok\r\n\r\n## Expected Behavior\r\nWe should not cache /auth/authenticate routes\r\n\r\n## Actual Behavior\r\nCouldn't Reach API in front-end\r\n\r\n- Device: DigitalOcean Server\r\n- OS: Ubuntu Server 18.04\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: 7.4\r\n- Database: MySQL 8.0.18\r\n- Directus Release Version:8.4.0\r\n  - App Version: 8.4.0\r\n  - API Version: 8.4.0\r\n- Install Method: cloned `master` branch"},{"labels":["bug"],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n‚Ä¢¬†PHP version\r\n‚Ä¢¬†MySQL version\r\n‚Ä¢¬†Webserver + version\r\n\r\nThanks!\r\n\r\n-->\r\n#### What\r\nThere seems to be an error in the Thumbnailer Code.\r\n\r\n---\r\n\r\n#### File\r\n~/Directus/suite/src/core/Directus/Filesystem/Thumbnailer.php\r\n\r\n---\r\n\r\n#### Code Snippet\r\n```\r\npublic function validateThumbnailWhitelist($params)\r\n{\r\n    $userWhitelist = json_decode(ArrayUtils::get($this->getConfig(), 'asset_whitelist'), true);\r\n\r\n    $thumbnailWhitelistEnabled = empty($userWhitelist) === false;\r\n\r\n    if($thumbnailWhitelistEnabled)\r\n    {\r\n        $userWhitelist = json_decode($userWhitelist,true);\r\n        $result = false;\r\n        foreach($userWhitelist as $key=>$value)\r\n        {\r\n            if(\r\n              $value['width'] == $params['width'] &&\r\n              $value['height'] == $params['height'] &&\r\n              $value['fit'] == $params['fit'] &&\r\n              $value['quality'] == $params['quality']\r\n            )\r\n            {\r\n              $result = true;\r\n            }\r\n        }\r\n        if(!$result){\r\n            throw new Exception();\r\n        }\r\n    }\r\n\r\n}\r\n```\r\n\r\n---\r\n\r\n#### Invalid Code\r\n```\r\n$userWhitelist = json_decode($userWhitelist,true);\r\n``` \r\nThe userWhitelist is already decoded from JSON String to Array by the code \r\n```\r\n$userWhitelist = json_decode(ArrayUtils::get($this->getConfig(), 'asset_whitelist'), true);\r\n```\r\n\r\n---\r\n\r\n#### Error Thrown\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"Unknown Error\",\r\n        \"class\": \"Exception\",\r\n        \"file\": \"~/Directus/suite/src/core/Directus/Filesystem/Thumbnailer.php\",\r\n        \"line\": 345\r\n    }\r\n}\r\n```\r\n\r\n---\r\n\r\n#### Tentative Fix\r\n\r\n```\r\n$userWhitelist = json_decode($userWhitelist,true);\r\n```\r\nwas changed to:\r\n```\r\nif (is_string($userWhitelist)) $userWhitelist = json_decode($userWhitelist,true);\r\n```"},{"labels":["bug"],"text":"When trying to sort by \"random\" I am getting a 500 error. Not sure if this is a URL encoding issue, or what.\r\n\r\n```\r\nexample.com/_/items/projects?sort=?\r\nexample.com/_/items/projects?sort=%3F\r\n```"},{"labels":["bug"],"text":"In directus_role table the field collection_listing has a wrong field type. VARCHAR(255) is too small for a serialized json store in the db so a TEXT field is better.\r\nWhen populating the collection list, after selecting some collections and saving, it returns an error and this is the reason."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nI can't upgrade from Directus 7 to Directus 8 because data type TYPE_USER_CREATED has been removed in [v8.4.0 commit](https://github.com/directus/directus/commit/c894e6730a20172c578457f54ad00516fdb583c9) and it's needed by 20191123053252_update_directus_files_field migration.\r\n\r\n\r\n## Steps to Reproduce\r\n\r\n- Upgrade from v7 to v8.4 (for example, by running directus/directus:v8-apache docker container)\r\n\r\n- Go to login page\r\n\r\n\r\n## Expected Behavior\r\n\r\nUser could be logged in\r\n\r\n## Actual Behavior\r\n\r\nInternal Server Error is shown\r\n\r\n## Other Context & Screenshots\r\n\r\nError stack trace:\r\n\r\n`[2020-01-17 00:14:45] api[_].ERROR: Error: Undefined class constant 'TYPE_USER_CREATED' in /var/directus/migrations/upgrades/20191123053252_update_directus_files_field.php:119\r\nStack trace:\r\n#0 /var/directus/vendor/robmorgan/phinx/src/Phinx/Migration/Manager/Environment.php(124): UpdateDirectusFilesField->change\r\ndirectus/directus#1 /var/directus/vendor/robmorgan/phinx/src/Phinx/Migration/Manager.php(375): Phinx\\Migration\\Manager\\Environment->executeMigration\r\ndirectus/directus#2 /var/directus/vendor/robmorgan/phinx/src/Phinx/Migration/Manager.php(351): Phinx\\Migration\\Manager->executeMigration\r\ndirectus/directus#3 /var/directus/src/core/Directus/Util/Installation/InstallerUtils.php(244): Phinx\\Migration\\Manager->migrate\r\ndirectus/directus#4 /var/directus/src/core/Directus/Util/Installation/InstallerUtils.php(231): Directus\\Util\\Installation\\InstallerUtils::runMigrationAndSeeder\r\ndirectus/directus#5 /var/directus/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(13): Directus\\Util\\Installation\\InstallerUtils::updateTables\r\ndirectus/directus#6 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\ndirectus/directus#7 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#8 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#9 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#10 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/directus#11 /var/directus/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\ndirectus/directus#12 /var/directus/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\ndirectus/directus#13 /var/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/directus#14 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/directus#15 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#16 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#17 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#18 /var/directus/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/directus#19 /var/directus/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/directus#20 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/directus#21 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#22 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#23 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#24 /var/directus/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/directus#25 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/directus#26 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#27 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#28 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#29 /var/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\ndirectus/directus#30 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/directus#31 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#32 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#33 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#34 /var/directus/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\ndirectus/directus#35 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/directus#36 /var/directus/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#37 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#38 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#39 /var/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/directus#40 /var/directus/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\ndirectus/directus#41 /var/directus/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\ndirectus/directus#42 /var/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/directus#43 /var/directus/public/index.php(5): Directus\\Application\\Application->run [] []\r\n`\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS 10.14.6\r\n- Database: [eg: MySQL 8.0.12]\r\n- Directus Release Version: v8.4.0\r\n- Install Method: docker\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n1. Go to a collection\r\n2. Click on a field that is flagged \"required\"\r\n3. Remove the required and save\r\n4. See error\r\n\r\n## Expected Behavior\r\nThe field should save and change from required to not required\r\n\r\n## Actual Behavior\r\nError 500\r\n`Statement could not be executed (42000 - 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(16777215) Not Null' at line 1)`\r\n\r\n- Device: DigitalOcean Server\r\n- OS: Ubuntu Server 18.04\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: 7.4\r\n- Database: MySQL 8.0.18\r\n- Directus Release Version:8.4.0\r\n  - App Version: 8.4.0\r\n  - API Version: 8.4.0\r\n- Install Method: cloned `master` branch"},{"labels":["bug",null],"text":"‚Ä¢ Version of Directus\r\n8.4.0\r\n\r\n‚Ä¢ PHP version\r\n7.2.24\r\n\r\n‚Ä¢ MySQL version\r\nmysqld Ver 5.7.28\r\n\r\n‚Ä¢ Webserver + version\r\napache 2.4.29\r\n\r\nI researched the changes \"created_by\" to \"owner\" in the #1567 discussion, but I was a little confused because I updated directus 8.2.0 to 8.4.0 this works and [Maunal Upgrade Directus Schema](https://docs.directus.io/guides/cli.html#database-module). shows no have problems Directus Dashboard but the fields not correctly update the field \"created_by\" to \"owner\". Screenshot A: \r\n\r\n![msedge_xcl5Ro1kmG](https://user-images.githubusercontent.com/19521054/72561920-3edb1e80-3878-11ea-836d-97aeae59e652.png)\r\n\r\nI checked other collections \"tables\" I found have different format than A:\r\n\r\n![msedge_Q0Ms2GOOI7](https://user-images.githubusercontent.com/19521054/72561942-4e5a6780-3878-11ea-9f68-040d7ff5b27f.png)\r\n \r\n\r\nThen I had to manually add a new field \"owner\" which is different from A and B on screenshot C:\r\n\r\n![msedge_lnKduZbcMl](https://user-images.githubusercontent.com/19521054/72561960-574b3900-3878-11ea-9946-674be7745611.png)\r\n\r\nI'm a little confused because the documentation [Core Interfaces User Created](https://docs.directus.io/guides/interfaces.html#user-created) is correct? \r\n\r\nI tried out a new collection to add new field it comes out error add, but I refreshed the page shows added new field:\r\n\r\n![kPn137OtaU](https://user-images.githubusercontent.com/19521054/72556797-65478c80-386d-11ea-8023-cc430336faf4.gif)\r\n"},{"labels":["bug"],"text":"In the 8.4 Release the Constant\r\n\r\n_\\Directus\\Database\\Schema\\DataTypes::TYPE_USER_CREATED_\r\n\r\ngot replaced by\r\n\r\n_\\Directus\\Database\\Schema\\DataTypes::TYPE_OWNER_\r\n\r\nThe following files still use the old Constant:\r\n 20191123053252_update_directus_files_field.php https://github.com/directus/api/blob/master/migrations/upgrades/20191123053252_update_directus_files_field.php\r\n\r\n20191202164209_reset_directus_fields.php\r\nhttps://github.com/directus/api/blob/master/migrations/upgrades/20191202164209_reset_directus_fields.php\r\n\r\nThis causes the migrations to break."},{"labels":["bug"],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n‚Ä¢¬†PHP version\r\n‚Ä¢¬†MySQL version\r\n‚Ä¢¬†Webserver + version\r\n\r\nThanks!\r\n\r\n-->\r\n- Version of Directus: Upgrading from V7.4 to 8.4 \r\n- Error message: Undefined class constant 'TYPE_USER_CREATED'\r\n- Steps to reproduce: Upgrade using the git method\r\n- PHP 7.4\r\n- Mysql Version 5.7.28\r\n- Nginx 1.16.1\r\n\r\n\r\nWhen upgrading directus from V7 I encounter `Undefined class constant 'TYPE_USER_CREATED'`  on [migrations/upgrades/20191123053252_update_directus_files_field.php](https://github.com/directus/api/blob/76413ea8f5b3bf7e90f84a76858ab18c7fc0db67/migrations/upgrades/20191123053252_update_directus_files_field.php#L119) and [migrations/upgrades/20191202164209_reset_directus_fields.php](https://github.com/directus/api/blob/76413ea8f5b3bf7e90f84a76858ab18c7fc0db67/migrations/upgrades/20191202164209_reset_directus_fields.php#L621) as I can tell by blaming the repo is a change made on 17390ecc3e800fe781b65f8faab5ccbf7fda0a9a I will make a PR fixing this in hopes of getting this fixed so everyone can upgrade safely from older releases.\r\n"},{"labels":["bug"],"text":"‚Ä¢¬†Version of Directus \r\n8.4.0\r\n\r\n‚Ä¢¬†Error message (if any) \r\n \"500 Internal Server Error\".\r\n\r\n‚Ä¢¬†PHP version\r\n7.2.24\r\n\r\n‚Ä¢¬†MySQL version\r\nmysqld  Ver 5.7.28\r\n\r\n‚Ä¢¬†Webserver + version\r\napache 2.4.29\r\n\r\n\r\n‚Ä¢¬†Steps to reproduce:\r\n\r\nI consulted SCIM in API documentation to do with Create SCIM User, I did a SCIM based request test in Doc, but it shows a \"500 Internal Server Error\".\r\n![image](https://user-images.githubusercontent.com/19521054/72384138-ce52c700-36ea-11ea-9b78-d4ee95175816.png)\r\n\r\nPS: I updated minutes ago directus 8.2.0 -> 8.4.0 using git (DigitalOcean)."},{"labels":["bug"],"text":"`Access to XMLHttpRequest at https://api.abcd.com/api/items/article?sort=-modified from origin 'http://localhost:3000' has been blocked by CORS policy: The 'Access-Control-Allow-Origin' header has a value 'https://www.abcd.com' that is not equal to the supplied origin.`\r\n\r\n`localhost:3000` and `www.abcd.com` use the same API(https://api.abcd.com/api/)\r\n\r\nWhen I use js-sdk to get data through `localhost: 3000`, it's work, but when I use `www.abcd.com` to get data, it reports an error.\r\nThen I cleared my redis cache, `www.abcd.com` worked, but `localhost: 3000` gave an error again.\r\n\r\n#### The conclusions reached are as follows:\r\n\r\nWhen I have multiple different domain names reading api data at the same time, such as `a.com`, `b.com`, `c.com`, I use `a.com` to read the data, but `b.com` and `c.com` both An error is reported because their `Access-Control-Allow-Origin header value` becomes `a.com`. I use `b.com` to read the api data, and then clear the redis cache, then `b.com` will work normally. But the `Access-Control-Allow-Origin header value` of other domain names will become `b.com`.\r\n\r\nI don't know how to describe it clearly in English, hope understand what I mean.\r\n\r\nI currently switch back to the old version and it works (8.3.1)\r\n\r\n\r\n\r\n\r\nOS: CentOS Linux 7.6.1810 (Core)„ÄÄ\r\nWeb Server: Nginx 1.17\r\nPHP Version: 7.3\r\nInstall Method: Latest version"},{"labels":["bug"],"text":"user creation through SCIM fails, because of the validator:\r\n\r\npassword: This value should not be blank.\r\ntimezone: This value should not be blank.\r\nlocale: This value should not be blank.\r\nroles: This value should not be blank.\r\n\r\naccording to documentation these values are not needed. \r\nhttps://docs.directus.io/api/reference.html#create-scim-user\r\n\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\nUpgrade to V8, via FTP, V7 was working fine.\r\nClear session cookies\r\nEnter email and password\r\n\r\n## Expected Behavior\r\nAccess to admin dashboard\r\n\r\n## Actual Behavior\r\nError screen : \r\n`Server Error`\r\n`Something is wrong with this project‚Äôs server or database.`\r\n\r\n_Note_: If I don't remove cookies and clear cache I have a similar issue as the one described here : \r\nhttps://github.com/directus/directus/issues/2510\r\n\r\n## Other Context & Screenshots\r\n**Error sceen**\r\n![image](https://user-images.githubusercontent.com/46789893/72263451-2c16de80-3619-11ea-8f2f-bc12474f4beb.png)\r\n\r\n\r\n**API calls**\r\n![image](https://user-images.githubusercontent.com/46789893/72263424-215c4980-3619-11ea-86f4-d9b24cb3961c.png)\r\n\r\n`public/_/auth/authenticate`\r\n is returning : \r\n`{\"data\":{\"user\":{\"id\":\"1\", ... }},\"public\":true}`\r\n\r\n`public/_/users/me?fields[0]=id&fields[1]=avatar.*&fields[2]=email&fields[3]=first_name&fields[4]=last_name&fields[5]=locale&fields[6]=role.*&fields[7]=last_page&fields[8]=theme` \r\nis returning : \r\n`{\"data\":{\"id\":1,\", ... },\"theme\":\"auto\"}}`\r\n\r\n`/public/layouts`\r\n is returning : \r\n`{\"error\":{\"code\":108,\"message\":\"User not authenticated\"}}`\r\n\r\n`/public/collections` and `public/_/relations?limit=-1` \r\nare returning : \r\n`{\"error\":{\"code\":3,\"message\":\"Unauthorized request\"}}`\r\n\r\n`public/_/users/me?fields=*.*` \r\nis returning : \r\n`{\"error\":{\"code\":203,\"message\":\"Item not found\"}}`\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Firefox and chrome desktop\r\n- OS: windows 7\r\n- Web Server: Apache\r\n- PHP Version: 7.3\r\n- Database: \r\n- Directus Release Version: v8.3.1\r\n- Install Method: FTP upload\r\n\r\n\r\nThank you for your help."},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nI can't seem to pin down anything super reproducable, but sometimes requesting a directus files field returns only the id. It seems like there's sometimes another field that causes the data to quit returning.\r\n\r\n## Steps to Reproduce\r\nVisit https://cms.energyadvisors.com/_/items/team_member/1?fields=avatar.*.*.*,id and notice the avatar data shows up.\r\n\r\nNow visit https://cms.energyadvisors.com/_/items/team_member/1?fields=id,avatar.*.*.*,name and notice suddenly the avatar information suddenly doesn't return.\r\n\r\n\r\n It only seems to happen when I request the field `name`, requesting any other field is fine. Ex: https://cms.energyadvisors.com/_/items/team_member/1?fields=title,email,location,status,sort,experiences,phone_number,team,office,created_by,created_on,avatar.*.*.*,id\r\n\r\n## Expected Behavior\r\n\r\ndirectus files fields appear in api response when requested.\r\n\r\n## Actual Behavior\r\n\r\ndirectus files fields are missing in api response when requested.\r\n\r\n## Other Context & Screenshots\r\nSchema for \"name\" field is defaults for everything the \"text input\" field has. \r\nVARCHAR(200)\r\n\r\n## Technical Details\r\nUsing Latest Directus v8-apache docker container."},{"labels":["bug",null],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n\r\nThanks!\r\n\r\n-->\r\nNoticed that one cannot add a lot of custom collection listings as the size of the field in directus_roles->collection_listing is 255 (VARCHAR)...\r\n\r\nA temporary fix was done by manually updating the size in the DB to 500.\r\n\r\nOn a side note, would it be possible to edit the name displayed of the collections in the menu column?"},{"labels":["bug"],"text":"Hey there!\r\nFirst, thank you! Very nice work!\r\n\r\nSecond, should it be possible to access (public) endpoints within a \"wildcard\" project name?\r\nLike, I can currently access my API within the following URLs\r\n\r\n- GET http://localhost:8080/_/items/category\r\n- GET http://localhost:8080/____________/items/category\r\n- GET http://localhost:8080/whatEverIWant/items/category\r\n- GET http://localhost:8080/NotEvenISawThatComing/items/category\r\n\r\nWould it be possible to rename the whole thing to something like we can set up ourself? \r\nMaybe there is something and I don't know, so please let me know! Or at least to limit it to _ as it is mentioned in the documentation?\r\n\r\nThank you very much!\r\n\r\nBest\r\nSino"},{"labels":["bug"],"text":"Directus v8.3.1\r\nWhen deleting a file via API or APP, the file is removed from database but not from the disk. "},{"labels":["bug"],"text":"It looks like it's trying to create a file (?)\r\n\r\n```json\r\n{\r\n  \"error\": {\r\n    \"code\": 4,\r\n    \"message\": \"action: This value should not be blank. action_on: This value should not be blank. ip: This value should not be blank. item: This value should not be blank. field: This value should not be blank. filename_disk: This value should not be blank. filename_download: This value should not be blank. uploaded_on: This value should not be blank. data: This value should not be blank. version: This value should not be blank. collection_many: This value should not be blank. field_many: This value should not be blank. activity: This value should not be blank. key: This value should not be blank.\"\r\n  }\r\n}\r\n```"},{"labels":["bug",null],"text":"Interesting quirk. `offset` works, but `limit` doesn't. Offset is kinda useless without limit."},{"labels":["bug"],"text":"When fetching `/users/me` without a user, the API should return a 401 to indicate that you're not logged in, instead of a 404 for user not found."},{"labels":["bug"],"text":"After upgrade to 8.3.1, I always get couldn't reach api during login, directus didn't have any error message in the log, but I still can use api access the data of collections.\r\nAnd I also try remove all existing config, browse directus 8 admin page, I get some introduction to create an new project, I follow the step to create project by an new database, the new project can login and work fine. but it is not possible to re-input the data into this new project. \r\n\r\n"},{"labels":["bug"],"text":"### Version Info\r\nDirectus version: v8.3.1\r\nPHP version:7.2.24-0ubuntu0.18.04.1\r\nMySQL version: 5.7.28-0ubuntu0.18.04.4\r\nWeb server: Apache\r\nOS name and version: Ubuntu 18.04\r\n\r\n### Expected Behavior\r\nUser CLI changes desired user password as described [here](https://docs.directus.io/guides/cli.html#user-module)\r\n\r\n### Actual Behavior\r\n```\r\nPHP Fatal error:  Uncaught TypeError: Argument 2 passed to Directus\\Application\\Application::__construct() must be of the type array, integer given, called in /var/www/directus/src/core/Directus/Util/Installation/InstallerUtils.php on line 107 and defined in /var/www/directus/src/core/Directus/Application/Application.php:53\r\nStack trace:\r\n#0 /var/www/directus/src/core/Directus/Util/Installation/InstallerUtils.php(107): Directus\\Application\\Application->__construct('/var/www/direct...', 1)\r\ndirectus/directus#1 /var/www/directus/src/core/Directus/Console/Common/User.php(26): Directus\\Util\\Installation\\InstallerUtils::createApp('/var/www/direct...', NULL)\r\ndirectus/directus#2 /var/www/directus/src/core/Directus/Console/Modules/UserModule.php(65): Directus\\Console\\Common\\User->__construct('/var/www/direct...')\r\ndirectus/directus#3 /var/www/directus/src/core/Directus/Console/Modules/ModuleBase.php(61): Directus\\Console\\Modules\\UserModule->cmdPassword(Array, Array)\r\ndirectus/directus#4 /var/www/directus/src/core/Directus/Console/Cli.php(88): Directus\\Console\\Modules\\ModuleBase->runCommand('password', Arra in /var/www/directus/src/core/Directus/Application/Application.php on line 53\r\n```\r\n\r\n### Steps to Reproduce\r\n(some may be extraneous)\r\n1. Installation from source on Ubuntu host.\r\n2. Create user. Log in, log out.\r\n3. Execute workaround as described in directus/directus#1259 (regression?)\r\n4. `cd /var/www/directus && php bin/directus user:password -e theuser -p thepassword`"},{"labels":["bug"],"text":"When I enable cache by this in project setting file:\r\n\r\n```php\r\n    'cache' => [\r\n        'enabled' => true,\r\n        'response_ttl' => 300,\r\n        'pool' => [\r\n            'adapter' => 'filesystem',\r\n            'path' => './cache/',\r\n        ],\r\n    ],\r\n```\r\n\r\nAnd try to login with admin app, then I got a `Couldn't Reach API` error at APP, and api with this:\r\n\r\n```shell\r\n[ERROR 0 /index.php] PHP message: PHP Notice:  Trying to access array offset on value of type int in /var/www/html/src/core/Directus/Database/TableGateway/BaseTableGateway.php on line 855\r\n```\r\n\r\nI have tried `filesystem` and `apcu` adapter, and both have this problem.\r\n\r\n## Technical Details\r\n* Device: Desktop\r\n* OS: Windows 10 with Docker Desktop\r\n* Web Server: Caddy 1.8\r\n* PHP Version: 7.4\r\n* Database: MySQL 8\r\n* Install Method: cloned v8.3.1 tagged branch, manual build and install\r\n"},{"labels":["bug"],"text":"Hi,\r\n\r\nI think there is a problem with mirrored slug fields at the moment.\r\n\r\nMy Directus Version is **8.3.1** and I use the API directly. I have a collection with a slug field that should be mirrored from a \"title\" field. If the item is created/edited through APP it works, but with API creation of a new item, the slug gets not created.\r\n\r\nAfter some debugging, I narrowed it down to logic that collects the slug fields.\r\nIt's in the file `CoreServiceProvider.php`:\r\n`if (!$field || !DataTypes::isSlugType($field->getType()))`\r\n\r\nAfter checking database, the type of the slug field is \"string\" with interface \"slug\". I don't know whats the correct fix here:\r\n* Change type to \"slug\" -> could have unwanted side effects\r\n* Change the if condition to `$field->getInterface()` (which worked for me locally)\r\n\r\n\r\n"},{"labels":["bug"],"text":"Hi,\r\n\r\nI looked around for some time now, but I didn't find any related issue and didn't really find anything during debugging the API.\r\n\r\nI have a collection named \"Page\" which has fields for \"Created By\" and \"Status\".\r\nIn addition I have a role named \"User\" which is assigned by a hook to all new users.\r\n\r\nThe collection permissions for this role based on status are (second column is read permission):\r\n![image](https://user-images.githubusercontent.com/2518889/71305453-d150e500-23d4-11ea-9a0c-fe6c78dc35f4.png)\r\nSo user with this role should see all published pages but only drafts created by this user.\r\nOn creation I limited the status to \"Published\" and \"Draft\" as well. But I don't think, this is related to my current problem.\r\n\r\n**What I expect:**\r\nIf I get all items for this collection after logging in to API with a user that has the role \"User\", I expect to get all \"Published\" pages and only drafts that are created by logged in user (because of \"Mine\" limitation for drafts in permission configuration).\r\n\r\n**What I get:**\r\nCurrently I get all \"Published\" and all \"Drafts\" created by any user no matter which role or user created the draft.\r\n\r\nDirectus Version: **8.3.1**\r\n\r\nIs it even possible, to combine \"Mine\" and \"All\" and use different status values?\r\n\r\nThanks."},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nI migrated over from Directus 7 (following the steps from [this migration guide](https://github.com/directus/directus/releases/tag/v8.0.0)). However, when logging in the app immediately leads to a server error screen.\r\n\r\n## Steps to Reproduce\r\n1. Previously existing Directus 7 distro, working\r\n2. truncate migrations table\r\n3. clone Directus 8 repo (originally hadn't cloned for Directus 7)\r\n4. copy & make required changes to config, copy over files, etc\r\n5. Attempt to login\r\n\r\n## Expected Behaviour\r\nAt this point, I should be able to log back into the system, with directus migrating the database for the new database structure required\r\n\r\n## Actual Behaviour\r\nServer error screen, with error reported to console.\r\n`VM1197:1 GET http://localhost/directus_8/public/{{project}}/users/me?fields[0]=id&fields[1]=avatar.*&fields[2]=email&fields[3]=first_name&fields[4]=last_name&fields[5]=locale&fields[6]=role.*&fields[7]=last_page&fields[8]=theme 404 (Not Found)`\r\n\r\nI checked the logs and I'm given this error:\r\n`[2019-12-19 14:55:16] api[cpl-group].ERROR: Directus\\Database\\Exception\\ItemNotFoundException: Item not found in C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Services\\ItemsService.php:138\r\nStack trace:\r\n#0 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Services\\UsersService.php(144): Directus\\Services\\ItemsService->findByIds\r\ndirectus/directus#1 C:\\xampp\\htdocs\\directus_8\\src\\endpoints\\Users.php(92): Directus\\Services\\UsersService->findByIds\r\ndirectus/directus#2 [internal function]: Directus\\Api\\Routes\\Users->read\r\ndirectus/directus#3 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\Handlers\\Strategies\\RequestResponse.php(40): call_user_func\r\ndirectus/directus#4 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/directus#5 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/directus#6 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/directus#7 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#8 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#9 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#10 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware.php(124): Slim\\Route->Slim\\{closure}\r\ndirectus/directus#11 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/directus#12 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#13 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#14 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#15 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/directus#16 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/directus#17 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#19 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#20 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\ndirectus/directus#21 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\ndirectus/directus#22 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#24 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#25 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/directus#26 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\Route.php(268): Slim\\Route->callMiddlewareStack\r\ndirectus/directus#27 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\App.php(503): Slim\\Route->run\r\ndirectus/directus#28 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/directus#29 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/directus#30 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#31 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#32 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#33 C:\\xampp\\htdocs\\directus_8\\vendor\\directus\\proxy-detection\\src\\ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/directus#34 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Http\\Middleware\\ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/directus#35 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/directus#36 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#37 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#38 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#39 C:\\xampp\\htdocs\\directus_8\\vendor\\akrabat\\ip-address-middleware\\src\\IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/directus#40 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/directus#41 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#43 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#44 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Http\\Middleware\\CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\ndirectus/directus#45 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/directus#46 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#48 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#49 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\ndirectus/directus#50 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/directus#51 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\ndirectus/directus#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/directus#53 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/directus#54 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/directus#55 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\App.php(392): Slim\\App->callMiddlewareStack\r\ndirectus/directus#56 C:\\xampp\\htdocs\\directus_8\\vendor\\slim\\slim\\Slim\\App.php(297): Slim\\App->process\r\ndirectus/directus#57 C:\\xampp\\htdocs\\directus_8\\src\\core\\Directus\\Application\\Application.php(161): Slim\\App->run\r\ndirectus/directus#58 C:\\xampp\\htdocs\\directus_8\\public\\index.php(5): Directus\\Application\\Application->run [] []`\r\n\r\nFrom the looks of it, /users/me doesn't exist as a path, but Directus is trying to run this path.\r\nMy guess from the stack trace is users/me is being seen as a call for user with id \"me\" rather than a custom endpoint of the user info for the user currently logged in?\r\n\r\n## Other Context & Screenshots\r\nThis is the server error screen I receieve:\r\n![image](https://user-images.githubusercontent.com/39706150/71179408-055ac780-2268-11ea-9ed7-ec73c8df7a20.png)\r\n\r\n## Technical Details\r\nXAMPP Server:\r\nPHP Version 7.3.6\r\nApache Version 2.4.39\r\nDatabase: MySQL 10.3.16-MariaDB\r\nDirectus: Latest Version (cloned today)"},{"labels":["bug"],"text":"<!--\r\n\r\nHi there!\r\n\r\nThanks for taking the time to notify the community of an issue or sharing your thoughts for a new feature.\r\n\r\nPlease be as detailed as possible so others know exactly what you're talking about.\r\n\r\nFor bugs, please include:\r\n‚Ä¢¬†Version of Directus\r\n‚Ä¢¬†Error message (if any)\r\n‚Ä¢¬†Steps to reproduce\r\n‚Ä¢¬†PHP version\r\n‚Ä¢¬†MySQL version\r\n‚Ä¢¬†Webserver + version\r\n\r\nThanks!\r\n\r\n-->\r\n\r\nIf you upload a file with a comma in the name the request to the assets thumbnail will return a:\r\n\r\nERR_RESPONSE_HEADERS_MULTIPLE_CONTENT_DISPOSITION\r\n\r\nThis stackoverflow article suggest adding a content disposition to the response header and putting quotes around the file name:\r\n\r\n`Response.AddHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + filename + \"\\\"\");`\r\n\r\nhttps://stackoverflow.com/questions/13578428/duplicate-headers-received-from-server\r\n\r\nBTW, thanks for simplifying the issue submitting process to be less formal. \r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to project configuration file\r\n2. Set cors options like this\r\n\r\n    'cors' => [\r\n        'enabled' => true,\r\n        'origin' => array (\r\n  0 => 'https://www.domain.com',\r\n1 => 'https://domain.com',\r\n),\r\n....\r\n3. Save\r\n\r\n## Expected Behavior\r\n\r\nOnly requests from specific domains listed are allowed\r\n\r\n## Actual Behavior\r\n\r\nall requests from every domain is allowed, even localhost\r\n\r\n## Technical Details\r\n\r\n- Device: Laptop\r\n- OS: Windows\r\n- Web Server: Apache 2.4.29\r\n- PHP Version: 7.2.0\r\n- Database: MySQL 5.7.28\r\n- Directus Release Version: v8.0.0-rc.2\r\n- Install Method: FTP ZIP\r\n"},{"labels":["bug"],"text":"After upgrading to v.8.3.0 using git pull, I started having database connection issues. My database connection details are correct, I installed mysql-client in the api container and I can connect the database. \r\nphp directus db:upgrade\r\nThere was a problem connecting to the database:\r\n\r\n```SQLSTATE[HY000] [1049] Unknown database 'emdmonapi'```\r\n\r\n**'emdmonapi is NOT THE DATABASE NAME BUT THE PROJECT NAME**\r\n\r\nIt is incorrectly using project name instead of the database name. The configuration file is correct in /var/www/public/api/config/ api.frontgenapi.php. I can connect to the database using the same credentials.\r\n\r\nThanks in advance for any hint.\r\n\r\n<details><summary>Click to Show Error Log</summary>\r\n<p>\r\n\r\n```\r\napi[frontgenapi].ERROR: Directus\\Database\\Exception\\ItemNotFoundException: Item not found in /var/www/public/api/src/core/Directus/Services/ItemsService.php:138\r\nStack trace:\r\n#0 /var/www/public/api/src/core/Directus/Services/UsersService.php(143): Directus\\Services\\ItemsService->findByIds\r\n#1 /var/www/public/api/src/endpoints/Users.php(92): Directus\\Services\\UsersService->findByIds\r\n#2 [internal function]: Directus\\Api\\Routes\\Users->read\r\n#3 /var/www/public/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#4 /var/www/public/api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#5 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#6 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#7 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#8 [internal function]: Slim\\DeferredCallable->__invoke\r\n#9 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#10 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#11 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#12 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#13 [internal function]: Slim\\DeferredCallable->__invoke\r\n#14 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#15 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#16 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#17 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#18 [internal function]: Slim\\DeferredCallable->__invoke\r\n#19 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#21 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#22 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#23 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#24 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#25 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#26 [internal function]: Slim\\DeferredCallable->__invoke\r\n#27 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#28 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#29 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#30 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#31 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#32 [internal function]: Slim\\DeferredCallable->__invoke\r\n#33 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#34 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#35 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#36 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#37 [internal function]: Slim\\DeferredCallable->__invoke\r\n#38 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#39 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#40 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#41 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#42 [internal function]: Slim\\DeferredCallable->__invoke\r\n#43 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#44 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#45 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#46 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#47 [internal function]: Slim\\DeferredCallable->__invoke\r\n#48 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#50 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#51 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#52 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#53 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Permissions\\Exception\\ForbiddenCollectionReadException: Reading items from \"directus_users\" collection was denied in /var/www/public/api/src/core/Directus/Permissions/Acl.php:988\r\nStack trace:\r\n#0 /var/www/public/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1169): Directus\\Permissions\\Acl->enforceReadOnce\r\n#1 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1138): Directus\\Database\\TableGateway\\BaseTableGateway->enforceReadPermission\r\n#2 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1260): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#3 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(856): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#4 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#5 /var/www/public/api/src/core/Directus/Services/AbstractService.php(339): call_user_func_array\r\n#6 /var/www/public/api/src/core/Directus/Services/AbstractService.php(283): Directus\\Services\\AbstractService->getDataAndSetResponseCacheTags\r\n#7 /var/www/public/api/src/core/Directus/Services/UsersService.php(185): Directus\\Services\\AbstractService->getItemsAndSetResponseCacheTags\r\n#8 /var/www/public/api/src/endpoints/Users.php(53): Directus\\Services\\UsersService->findAll\r\n#9 [internal function]: Directus\\Api\\Routes\\Users->all\r\n#10 /var/www/public/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#12 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#13 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#14 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#15 [internal function]: Slim\\DeferredCallable->__invoke\r\n#16 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#17 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#18 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#19 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#20 [internal function]: Slim\\DeferredCallable->__invoke\r\n#21 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#22 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#23 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#24 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#25 [internal function]: Slim\\DeferredCallable->__invoke\r\n#26 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#27 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#28 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#29 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#30 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#31 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#32 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#33 [internal function]: Slim\\DeferredCallable->__invoke\r\n#34 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#35 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#36 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#37 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#38 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#39 [internal function]: Slim\\DeferredCallable->__invoke\r\n#40 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#41 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#42 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#43 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#44 [internal function]: Slim\\DeferredCallable->__invoke\r\n#45 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#46 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#47 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#48 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#49 [internal function]: Slim\\DeferredCallable->__invoke\r\n#50 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#51 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#52 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#53 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#54 [internal function]: Slim\\DeferredCallable->__invoke\r\n#55 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#56 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#57 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#58 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#59 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#60 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Permissions\\Exception\\ForbiddenCollectionReadException: Reading items from \"directus_collection_presets\" collection was denied in /var/www/public/api/src/core/Directus/Permissions/Acl.php:988\r\nStack trace:\r\n#0 /var/www/public/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1169): Directus\\Permissions\\Acl->enforceReadOnce\r\n#1 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1138): Directus\\Database\\TableGateway\\BaseTableGateway->enforceReadPermission\r\n#2 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1260): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#3 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(856): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#4 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#5 /var/www/public/api/src/core/Directus/Services/AbstractService.php(339): call_user_func_array\r\n#6 /var/www/public/api/src/core/Directus/Services/AbstractService.php(283): Directus\\Services\\AbstractService->getDataAndSetResponseCacheTags\r\n#7 /var/www/public/api/src/core/Directus/Services/ItemsService.php(81): Directus\\Services\\AbstractService->getItemsAndSetResponseCacheTags\r\n#8 /var/www/public/api/src/core/Directus/Services/CollectionPresetsService.php(33): Directus\\Services\\ItemsService->findAll\r\n#9 /var/www/public/api/src/endpoints/CollectionPresets.php(36): Directus\\Services\\CollectionPresetsService->findAll\r\n#10 [internal function]: Directus\\Api\\Routes\\CollectionPresets->all\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#12 /var/www/public/api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#13 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#14 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#15 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#16 [internal function]: Slim\\DeferredCallable->__invoke\r\n#17 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#18 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#19 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#21 [internal function]: Slim\\DeferredCallable->__invoke\r\n#22 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#23 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#24 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#25 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#26 [internal function]: Slim\\DeferredCallable->__invoke\r\n#27 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#28 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#29 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#30 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#31 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#32 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#33 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#34 [internal function]: Slim\\DeferredCallable->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#36 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#37 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#38 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#39 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#40 [internal function]: Slim\\DeferredCallable->__invoke\r\n#41 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#42 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#43 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#44 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#45 [internal function]: Slim\\DeferredCallable->__invoke\r\n#46 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#47 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#48 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#50 [internal function]: Slim\\DeferredCallable->__invoke\r\n#51 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#52 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#53 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#54 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#55 [internal function]: Slim\\DeferredCallable->__invoke\r\n#56 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#57 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#58 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#59 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#60 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#61 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Permissions\\Exception\\ForbiddenCollectionReadException: Reading items from \"directus_settings\" collection was denied in /var/www/public/api/src/core/Directus/Permissions/Acl.php:988\r\nStack trace:\r\n#0 /var/www/public/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1169): Directus\\Permissions\\Acl->enforceReadOnce\r\n#1 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1138): Directus\\Database\\TableGateway\\BaseTableGateway->enforceReadPermission\r\n#2 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1260): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#3 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(856): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#4 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#5 /var/www/public/api/src/core/Directus/Services/AbstractService.php(339): call_user_func_array\r\n#6 /var/www/public/api/src/core/Directus/Services/AbstractService.php(283): Directus\\Services\\AbstractService->getDataAndSetResponseCacheTags\r\n#7 /var/www/public/api/src/core/Directus/Services/ItemsService.php(81): Directus\\Services\\AbstractService->getItemsAndSetResponseCacheTags\r\n#8 /var/www/public/api/src/core/Directus/Services/SettingsService.php(55): Directus\\Services\\ItemsService->findAll\r\n#9 /var/www/public/api/src/endpoints/Settings.php(70): Directus\\Services\\SettingsService->findAll\r\n#10 [internal function]: Directus\\Api\\Routes\\Settings->all\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#12 /var/www/public/api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#13 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#14 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#15 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#16 [internal function]: Slim\\DeferredCallable->__invoke\r\n#17 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#18 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#19 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#21 [internal function]: Slim\\DeferredCallable->__invoke\r\n#22 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#23 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#24 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#25 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#26 [internal function]: Slim\\DeferredCallable->__invoke\r\n#27 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#28 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#29 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#30 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#31 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#32 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#33 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#34 [internal function]: Slim\\DeferredCallable->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#36 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#37 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#38 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#39 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#40 [internal function]: Slim\\DeferredCallable->__invoke\r\n#41 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#42 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#43 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#44 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#45 [internal function]: Slim\\DeferredCallable->__invoke\r\n#46 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#47 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#48 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#50 [internal function]: Slim\\DeferredCallable->__invoke\r\n#51 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#52 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#53 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#54 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#55 [internal function]: Slim\\DeferredCallable->__invoke\r\n#56 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#57 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#58 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#59 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#60 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#61 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Permissions\\Exception\\ForbiddenCollectionReadException: Reading items from \"directus_collections\" collection was denied in /var/www/public/api/src/core/Directus/Permissions/Acl.php:988\r\nStack trace:\r\n#0 /var/www/public/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1169): Directus\\Permissions\\Acl->enforceReadOnce\r\n#1 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1138): Directus\\Database\\TableGateway\\BaseTableGateway->enforceReadPermission\r\n#2 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1260): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#3 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(856): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#4 /var/www/public/api/src/core/Directus/Services/TablesService.php(68): Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#5 /var/www/public/api/src/endpoints/Collections.php(58): Directus\\Services\\TablesService->findAll\r\n#6 [internal function]: Directus\\Api\\Routes\\Collections->all\r\n#7 /var/www/public/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#8 /var/www/public/api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#9 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#10 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#12 [internal function]: Slim\\DeferredCallable->__invoke\r\n#13 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#14 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#15 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#16 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#17 [internal function]: Slim\\DeferredCallable->__invoke\r\n#18 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#19 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#20 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#21 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#22 [internal function]: Slim\\DeferredCallable->__invoke\r\n#23 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#24 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#25 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#26 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#27 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#28 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#29 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#30 [internal function]: Slim\\DeferredCallable->__invoke\r\n#31 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#32 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#33 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#34 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#36 [internal function]: Slim\\DeferredCallable->__invoke\r\n#37 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#38 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#39 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#40 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#41 [internal function]: Slim\\DeferredCallable->__invoke\r\n#42 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#43 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#44 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#45 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#48 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#49 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#50 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#51 [internal function]: Slim\\DeferredCallable->__invoke\r\n#52 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#53 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#54 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#55 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#56 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#57 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Permissions\\Exception\\ForbiddenCollectionReadException: Reading items from \"directus_collection_presets\" collection was denied in /var/www/public/api/src/core/Directus/Permissions/Acl.php:988\r\nStack trace:\r\n#0 /var/www/public/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1169): Directus\\Permissions\\Acl->enforceReadOnce\r\n#1 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1138): Directus\\Database\\TableGateway\\BaseTableGateway->enforceReadPermission\r\n#2 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1260): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#3 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(856): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#4 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#5 /var/www/public/api/src/core/Directus/Services/AbstractService.php(339): call_user_func_array\r\n#6 /var/www/public/api/src/core/Directus/Services/AbstractService.php(283): Directus\\Services\\AbstractService->getDataAndSetResponseCacheTags\r\n#7 /var/www/public/api/src/core/Directus/Services/ItemsService.php(81): Directus\\Services\\AbstractService->getItemsAndSetResponseCacheTags\r\n#8 /var/www/public/api/src/core/Directus/Services/CollectionPresetsService.php(33): Directus\\Services\\ItemsService->findAll\r\n#9 /var/www/public/api/src/endpoints/CollectionPresets.php(36): Directus\\Services\\CollectionPresetsService->findAll\r\n#10 [internal function]: Directus\\Api\\Routes\\CollectionPresets->all\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#12 /var/www/public/api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#13 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#14 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#15 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#16 [internal function]: Slim\\DeferredCallable->__invoke\r\n#17 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#18 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#19 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#21 [internal function]: Slim\\DeferredCallable->__invoke\r\n#22 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#23 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#24 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#25 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#26 [internal function]: Slim\\DeferredCallable->__invoke\r\n#27 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#28 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#29 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#30 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#31 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#32 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#33 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#34 [internal function]: Slim\\DeferredCallable->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#36 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#37 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#38 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#39 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#40 [internal function]: Slim\\DeferredCallable->__invoke\r\n#41 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#42 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#43 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#44 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#45 [internal function]: Slim\\DeferredCallable->__invoke\r\n#46 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#47 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#48 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#50 [internal function]: Slim\\DeferredCallable->__invoke\r\n#51 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#52 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#53 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#54 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#55 [internal function]: Slim\\DeferredCallable->__invoke\r\n#56 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#57 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#58 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#59 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#60 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#61 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Database\\Exception\\ItemNotFoundException: Item not found in /var/www/public/api/src/core/Directus/Services/ItemsService.php:138\r\nStack trace:\r\n#0 /var/www/public/api/src/core/Directus/Services/UsersService.php(143): Directus\\Services\\ItemsService->findByIds\r\n#1 /var/www/public/api/src/endpoints/Users.php(92): Directus\\Services\\UsersService->findByIds\r\n#2 [internal function]: Directus\\Api\\Routes\\Users->read\r\n#3 /var/www/public/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#4 /var/www/public/api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#5 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#6 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#7 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#8 [internal function]: Slim\\DeferredCallable->__invoke\r\n#9 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#10 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#11 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#12 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#13 [internal function]: Slim\\DeferredCallable->__invoke\r\n#14 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#15 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#16 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#17 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#18 [internal function]: Slim\\DeferredCallable->__invoke\r\n#19 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#21 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#22 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#23 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#24 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#25 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#26 [internal function]: Slim\\DeferredCallable->__invoke\r\n#27 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#28 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#29 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#30 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#31 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#32 [internal function]: Slim\\DeferredCallable->__invoke\r\n#33 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#34 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#35 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#36 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#37 [internal function]: Slim\\DeferredCallable->__invoke\r\n#38 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#39 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#40 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#41 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#42 [internal function]: Slim\\DeferredCallable->__invoke\r\n#43 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#44 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#45 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#46 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#47 [internal function]: Slim\\DeferredCallable->__invoke\r\n#48 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#50 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#51 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#52 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#53 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Permissions\\Exception\\ForbiddenCollectionReadException: Reading items from \"directus_relations\" collection was denied in /var/www/public/api/src/core/Directus/Permissions/Acl.php:988\r\nStack trace:\r\n#0 /var/www/public/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1169): Directus\\Permissions\\Acl->enforceReadOnce\r\n#1 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1138): Directus\\Database\\TableGateway\\BaseTableGateway->enforceReadPermission\r\n#2 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1260): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#3 /var/www/public/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(856): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#4 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#5 /var/www/public/api/src/core/Directus/Services/AbstractService.php(339): call_user_func_array\r\n#6 /var/www/public/api/src/core/Directus/Services/AbstractService.php(283): Directus\\Services\\AbstractService->getDataAndSetResponseCacheTags\r\n#7 /var/www/public/api/src/core/Directus/Services/ItemsService.php(81): Directus\\Services\\AbstractService->getItemsAndSetResponseCacheTags\r\n#8 /var/www/public/api/src/core/Directus/Services/RelationsService.php(76): Directus\\Services\\ItemsService->findAll\r\n#9 /var/www/public/api/src/endpoints/Relations.php(33): Directus\\Services\\RelationsService->findAll\r\n#10 [internal function]: Directus\\Api\\Routes\\Relations->all\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#12 /var/www/public/api/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#13 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#14 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#15 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#16 [internal function]: Slim\\DeferredCallable->__invoke\r\n#17 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#18 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#19 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#21 [internal function]: Slim\\DeferredCallable->__invoke\r\n#22 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#23 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#24 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#25 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#26 [internal function]: Slim\\DeferredCallable->__invoke\r\n#27 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#28 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#29 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#30 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#31 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#32 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#33 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#34 [internal function]: Slim\\DeferredCallable->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#36 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#37 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#38 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#39 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#40 [internal function]: Slim\\DeferredCallable->__invoke\r\n#41 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#42 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#43 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#44 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#45 [internal function]: Slim\\DeferredCallable->__invoke\r\n#46 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#47 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#48 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#50 [internal function]: Slim\\DeferredCallable->__invoke\r\n#51 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#52 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#53 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#54 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#55 [internal function]: Slim\\DeferredCallable->__invoke\r\n#56 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#57 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#58 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#59 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#60 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#61 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Authentication\\Exception\\UserNotAuthenticatedException: User not authenticated in /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticatedMiddleware.php:21\r\nStack trace:\r\n#0 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticatedMiddleware->__invoke\r\n#1 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#2 [internal function]: Slim\\DeferredCallable->__invoke\r\n#3 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#4 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#5 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#6 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#7 [internal function]: Slim\\DeferredCallable->__invoke\r\n#8 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#9 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationIgnoreOriginMiddleware.php(19): Slim\\Route->Slim\\{closure}\r\n#10 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationIgnoreOriginMiddleware->__invoke\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#12 [internal function]: Slim\\DeferredCallable->__invoke\r\n#13 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#14 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#15 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#16 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#17 [internal function]: Slim\\DeferredCallable->__invoke\r\n#18 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#19 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#21 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#22 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#23 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#24 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#25 [internal function]: Slim\\DeferredCallable->__invoke\r\n#26 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#27 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#28 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#29 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#30 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#31 [internal function]: Slim\\DeferredCallable->__invoke\r\n#32 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#33 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#34 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#36 [internal function]: Slim\\DeferredCallable->__invoke\r\n#37 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#38 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#39 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#40 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#41 [internal function]: Slim\\DeferredCallable->__invoke\r\n#42 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#43 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#44 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#45 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#48 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#50 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#51 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#52 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Authentication\\Exception\\UserNotAuthenticatedException: User not authenticated in /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticatedMiddleware.php:21\r\nStack trace:\r\n#0 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticatedMiddleware->__invoke\r\n#1 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#2 [internal function]: Slim\\DeferredCallable->__invoke\r\n#3 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#4 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#5 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#6 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#7 [internal function]: Slim\\DeferredCallable->__invoke\r\n#8 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#9 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationIgnoreOriginMiddleware.php(19): Slim\\Route->Slim\\{closure}\r\n#10 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationIgnoreOriginMiddleware->__invoke\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#12 [internal function]: Slim\\DeferredCallable->__invoke\r\n#13 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#14 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#15 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#16 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#17 [internal function]: Slim\\DeferredCallable->__invoke\r\n#18 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#19 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#21 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#22 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#23 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#24 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#25 [internal function]: Slim\\DeferredCallable->__invoke\r\n#26 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#27 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#28 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#29 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#30 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#31 [internal function]: Slim\\DeferredCallable->__invoke\r\n#32 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#33 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#34 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#36 [internal function]: Slim\\DeferredCallable->__invoke\r\n#37 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#38 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#39 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#40 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#41 [internal function]: Slim\\DeferredCallable->__invoke\r\n#42 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#43 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#44 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#45 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#48 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#50 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#51 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#52 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Authentication\\Exception\\UserNotAuthenticatedException: User not authenticated in /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticatedMiddleware.php:21\r\nStack trace:\r\n#0 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticatedMiddleware->__invoke\r\n#1 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#2 [internal function]: Slim\\DeferredCallable->__invoke\r\n#3 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#4 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#5 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#6 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#7 [internal function]: Slim\\DeferredCallable->__invoke\r\n#8 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#9 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationIgnoreOriginMiddleware.php(19): Slim\\Route->Slim\\{closure}\r\n#10 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationIgnoreOriginMiddleware->__invoke\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#12 [internal function]: Slim\\DeferredCallable->__invoke\r\n#13 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#14 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#15 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#16 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#17 [internal function]: Slim\\DeferredCallable->__invoke\r\n#18 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#19 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#21 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#22 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#23 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#24 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#25 [internal function]: Slim\\DeferredCallable->__invoke\r\n#26 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#27 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#28 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#29 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#30 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#31 [internal function]: Slim\\DeferredCallable->__invoke\r\n#32 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#33 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#34 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#36 [internal function]: Slim\\DeferredCallable->__invoke\r\n#37 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#38 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#39 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#40 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#41 [internal function]: Slim\\DeferredCallable->__invoke\r\n#42 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#43 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#44 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#45 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#48 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#50 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#51 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#52 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-12-15 13:56:11] api[frontgenapi].ERROR: Directus\\Authentication\\Exception\\UserNotAuthenticatedException: User not authenticated in /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticatedMiddleware.php:21\r\nStack trace:\r\n#0 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticatedMiddleware->__invoke\r\n#1 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#2 [internal function]: Slim\\DeferredCallable->__invoke\r\n#3 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#4 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#5 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#6 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#7 [internal function]: Slim\\DeferredCallable->__invoke\r\n#8 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#9 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AuthenticationIgnoreOriginMiddleware.php(19): Slim\\Route->Slim\\{closure}\r\n#10 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationIgnoreOriginMiddleware->__invoke\r\n#11 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#12 [internal function]: Slim\\DeferredCallable->__invoke\r\n#13 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#14 /var/www/public/api/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#15 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#16 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#17 [internal function]: Slim\\DeferredCallable->__invoke\r\n#18 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#19 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#20 /var/www/public/api/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#21 /var/www/public/api/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#22 /var/www/public/api/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#23 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#24 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#25 [internal function]: Slim\\DeferredCallable->__invoke\r\n#26 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#27 /var/www/public/api/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#28 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#29 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#30 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#31 [internal function]: Slim\\DeferredCallable->__invoke\r\n#32 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#33 /var/www/public/api/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#34 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#35 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#36 [internal function]: Slim\\DeferredCallable->__invoke\r\n#37 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#38 /var/www/public/api/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#39 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#40 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#41 [internal function]: Slim\\DeferredCallable->__invoke\r\n#42 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#43 /var/www/public/api/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#44 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#45 /var/www/public/api/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#48 /var/www/public/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#49 /var/www/public/api/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#50 /var/www/public/api/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#51 /var/www/public/api/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#52 /var/www/public/api/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n\r\n</p>\r\n</details>"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. setting adapter as below:\r\n```php\r\n'storage' => [\r\n    'adapter' => 's3',\r\n\r\n    'root' => '/api/demo/originals',\r\n    'thumb_root' => '/api/demo/thumbnails',\r\n    'root_url' => 'https://assets.xxx.io',\r\n\r\n    'proxy_downloads' => 'false',\r\n\r\n    'key' => getenv('S3_KEY'),\r\n    'secret' => getenv('S3_SECRET'),\r\n    'region' => getenv('S3_REGION'),\r\n    'bucket' => getenv('S3_BUCKET'),\r\n    'endpoint' => getenv('S3_ENDPOINT'),\r\n    'version' => 'latest',\r\n    'options' => [\r\n        'ACL' => 'public-read',\r\n        'Cache-Control' => 'max-age=604800'\r\n    ],\r\n],\r\n```\r\n2. go to `api.xxx.com/admin` to upload a file, upload success, and thumbnail generate successful.\r\n3. Click file in `File Library` and go to file detail page,  the url is `http://api.xxx.io/downloads/demo/7044be19-6416-4f8c-8cf1-6e110e1c6fde.jpg`  and image request failed with erroe:\r\n```json\r\n{\"error\":{\"code\":3,\"message\":\"Unauthorized request\",\"class\":\"Directus\\\\Exception\\\\UnauthorizedException\",\"file\":\"\\/var\\/www\\/src\\/helpers\\/app.php\",\"line\":286}}\r\n```\r\n\r\n## Expected Behavior\r\nReturn a url with `root_url` so that we can used for CDN, and don't have a `Unauthorized request` error.\r\n\r\n## Actual Behavior\r\noriginal url and thumbnail url is not use this `root_url`, and request a file from original url will meet `Unauthorized request` error.\r\n\r\n## Other Context & Screenshots\r\n\r\n![image](https://user-images.githubusercontent.com/1665522/70811101-e8ee0380-1dff-11ea-92dd-022234c5e597.png)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10 with Docker Desktop\r\n- Web Server: Caddy 1.8\r\n- PHP Version: 7.4\r\n- Database: MySQL 8\r\n- Install Method: cloned v8.2.0 tagged branch, manual build and install\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nWhen I create a Many to Many field and use the same name as the collection name the page returns: \"internal server error\".\r\n\r\nThis is what I see in my error log:\r\n- ERROR: TypeError: Argument 3 passed to Directus\\Services\\AbstractService::validatePayload() must be of the type array, null given\r\n\r\nI solved it by renaming the field name to something different than the collection name.\r\n\r\n\r\n## Steps to Reproduce\r\n\r\nIn my case, the collection name was: \"requirements\".\r\n\r\nI created two fields (user and many to many field) and named it \"user\" and \"requirements\" respectively.\r\n\r\nAdding new items with filling the user field and without filling the many2many field --> succeed.\r\nAdding new items with filling both the user and many2many fileld --> failed and returned \"internal server error\".\r\n\r\nThen I renamed the field name of my many2many to \"given_requirements\", and it worked again.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: fedora 5.3.11-200.fc30.x86_64 \r\n- Web Server: Nginx\r\n- PHP Version: PHP 7.3.11\r\n- Database: 8.0.18\r\n- Directus Release Version: v8.0.0-rc.2\r\n- Install Method: cloned master branch\r\n"},{"labels":["bug"],"text":"Change https://github.com/directus/api/pull/1539 fixed it for relative URLs, but broke the full url support\r\n\r\n"},{"labels":["bug"],"text":"In bigger (enterprise) Directus installations, it's common to have multiple instances of Directus connected to the same database, with a load balancer in front to send people to the different instances based on usage. The Directus application relies on Cookies for its authentication, which means that the load balancer has to use session stickiness to make sure the API is able to read the cookie correctly. \r\n\r\nLets say you have:\r\n\r\n* 1 Database\r\n* You have 3 instances of Directus connected to this database\r\n* 1 Load balancer\r\n\r\nEnabling session stickiness on the load balancer level will make every request go to the same instance, negating the usefulness of having a load balanced setup in the first place. For normal CRUD operations, this isn't the end of the world, but it does become a problem for files. Generating / retrieving thumbnails is currently very heavy (see https://github.com/directus/api/issues/1542), which can result in load problems normally taken care of by the load balanced setup.\r\n\r\nThe user sessions are currently stored in the database, but for some reason the API is not able to work without the same `PHP_SESSID` also being present. This requires you to enable session stickiness, which in turn causes the problem mentioned above.\r\n\r\n@bjgajjar Seeing we have the `directus-{project}-session` cookie which is managed through the database, is there anything we can do to drop the reliance on `PHP_SESSID` so it doesn't matter to what server you connect?"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Add `hooks` setting in project php config file.\r\n```php\r\n'hooks' => [\r\n    'actions' => [\r\n        'item.create.messages' => function ($data) {\r\n            $container = Application::getInstance()->getContainer();\r\n            $mailService = new MailService($container);\r\n            $mailService->send([\r\n                'type' => 'html',\r\n                'subject' => \"subject\",\r\n                'body' => 'new message created'',\r\n                'data' => [],\r\n                'to' => [\r\n                    [ 'name' => 'Gavin Luo', 'email' => 'gavin.luo@fengsi.io' ]\r\n                ],\r\n            ]);\r\n        },\r\n    ],\r\n],\r\n```\r\n2. Create message item from public post request, and error \r\n```json\r\n{\r\n  \"error\": {\r\n    \"code\": null,\r\n    \"message\": \"Address in mailbox given [] does not comply with RFC 2822, 3.6.2.\",\r\n    \"class\": \"Swift_RfcComplianceException\",\r\n    \"file\": \"\\/var\\/www\\/vendor\\/swiftmailer\\/swiftmailer\\/lib\\/classes\\/Swift\\/Mime\\/Headers\\/MailboxHeader.php\",\r\n    \"line\": 345\r\n  }\r\n}\r\n```\r\n3. Login to Admin APP, and create a new message item, email sending hook worked.\r\n\r\n## Expected Behavior\r\n\r\nAlso send email when on public api request to create message item.\r\n\r\n## Actual Behavior\r\n\r\n`Address in mailbox given [] does not comply with RFC 2822, 3.6.2.` error\r\n\r\n## Other Context & Screenshots\r\n\r\nPublic role create permission has been setted and the message item can create normally, just email sending now working.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10 with Docker Desktop\r\n- Web Server: Caddy 1.8\r\n- PHP Version: 7.4\r\n- Database: MySQL 8\r\n- Install Method: cloned `v8.2.0` tagged branch, manual build and install\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nPw reset token can be used to change pw multiple times without expiring.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to admin login\r\n2. Click on 'Forgot password'\r\n3. Click pw reset url of the email received\r\n4. Enter new password and submit\r\n5. Reload page\r\n6. Enter another password and submit\r\n\r\n## Expected Behavior\r\n\r\nError message saying pw reset token is expired\r\n\r\n## Actual Behavior\r\n\r\nPw gets changed again\r\n\r\n## Other Context & Screenshots\r\n\r\nThere's a TODO comment in line 478 of api/src/core/Directus/Authentication/Provider.php ‚Äì so it's not implemented correctly yet?\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop, iPhone 8\r\n- OS: MacOs 10.15.2, iOS 13.2\r\n- Web Server: Apache\r\n- PHP Version: 7.3\r\n- Database: MySQL 8.x\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"Even though the \"Project Logo\" is not required, you can't remove it (set it to NULL) after adding an image. You get the error: `value: This value should not be blank.`"},{"labels":["bug",null],"text":"I set file max size to 100MB, but the upload interface (not sure the name) below show 64MB, maybe it is setting by the php `upload_max_filesize setting`? So should we alert a error when the size value is greater than php setting? it's make sense.\r\n\r\n![image](https://user-images.githubusercontent.com/1665522/69726821-43c70000-115c-11ea-8b21-6b24457827af.png)\r\n\r\n![image](https://user-images.githubusercontent.com/1665522/69727024-a6200080-115c-11ea-918d-2b114eda327e.png)\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nThe following HTML added to the end of response:\r\n![image](https://user-images.githubusercontent.com/13006578/70633831-2b94bd80-1bff-11ea-95f6-a59e55d9eaff.png)\r\n\r\n## Steps to Reproduce\r\n1, Create custom collection with, for example, id and name fields\r\n2. Add some data\r\n3, Make a grapql query:\r\n\r\n```\r\nquery {\r\n  custom_collection {\r\n    data {\r\n        id\r\n        name\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n## Expected Behavior\r\nOnly JSON result returned\r\n\r\n## Actual Behavior\r\nIn addition to JSON result there is also an exception HTML added to the end of response\r\n\r\n## Other Context & Screenshots\r\nThe problem is in the following method - createMetadataPagination of RelationalTableGateway class.\r\nLine #1060:\r\n$meta_param=explode(',',$params['meta']);\r\nShould be replaced with the following code:\r\n$meta_param=explode(',', ArrayUtils::get($params,'meta', ''));\r\n\r\nBecause it seems like that 'meta' parameter is not always defined.\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10\r\n- Web Server: NGINX\r\n- PHP Version: 7.3.3\r\n- Database: MySQL 8.0.12\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to collection with a 'File' field\r\n2. Click on the Embed Button \r\n3. Paste a URL to a Image\r\n4. Endpoint POST /_/files is returning 422 Error\r\n\r\n## Expected Behavior\r\nFile upload from a embed url should work without error\r\n\r\n## Actual Behavior\r\nStatus 422\r\n{\"error\":{\"code\":4,\"message\":\"filename_download: This value should not be blank.\"}}\r\n\r\n## Technical Details\r\n\r\n- Directus 8.2\r\n- Install Method: Docker\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nPOST /[project]/users\r\nbody \r\n```\r\n{\r\n    \"email\": \"email@foxmail.com\",\r\n    \"password\": \"aaa123\",\r\n    \"role\": \"5\",\r\n    \"status\": \"active\",\r\n    \"first_name\": \"sun\",\r\n    \"last_name\": \"shine\"\r\n}\r\n```\r\nThe value \"5\" of \"role\" is not a available role id in \"directus_roles\".\r\n## Expected Behavior\r\nIt should return a error.\r\n## Actual Behavior\r\nIt return a  success.\r\n## Other Context & Screenshots\r\nI cannot see this new user data on the Directus Users page.It's in the table.\r\n----\r\nThis API always notice me that \"role/first_name/last_name\" should not be blank when I just submit email and password.\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: [Desktop]\r\n- OS: [Windows 10.1803]\r\n- Web Server: [Apache 2.4.37]\r\n- PHP Version: [7.3.0]\r\n- Database: [eg: MySQL 8.0.12]\r\n- Directus Release Version: [v8.2.0]\r\n  - App Version: [eg: 7.11.0] (include if Directus Release Version <=`190927A`)\r\n  - API Version: [eg: 2.6.0] (include if Directus Release Version <=`190927A`)\r\n- Install Method: [eg: cloned `master` branch]\r\n"},{"labels":["bug",null],"text":"Currently, the API reads file into memory on upload _and_ `/assets/` download, which makes it impossible to upload files that are bigger than ~100MB* and makes opening existing thumbnails slow.\r\n\r\nWe should use Streams to read / write / serve files, instead of reading them into memory whenever we can.\r\n\r\nhttps://flysystem.thephpleague.com/docs/usage/filesystem-api/\r\nhttps://odan.github.io/2018/03/09/emitting-chunked-stream-responses-with-slim.html\r\n\r\n\\* Depending on your server's memory and max php limits"},{"labels":["bug"],"text":"- OS: linux\r\n- Web Server: nginx\r\n- PHP Version: PHP 7.1.33\r\n- Database: 8.0.11\r\n- Install Method: tar.gz\r\n\r\n\r\nThe program did not report an error log„ÄÇ\r\n\r\n![88888888850](https://user-images.githubusercontent.com/5702303/70489125-bd37f880-1b35-11ea-8f0e-7f5b596b69e0.png)\r\n"},{"labels":["bug"],"text":"Hi there - I upgraded my Directus 7 to 8.1.0 and when I run the upgrade script, I have an error:\r\n\r\n```\r\n/var/www/html $ php bin/directus db:upgrade\r\nConfig file for \"\" does not exist at: \"/var/www/html\"\r\n/var/www/html $ php bin/directus db:install\r\n```\r\n\r\nWithout the db:upgrade I receive from the api \r\n\r\nPOST /_/auth/authenticate HTTP/1.1\r\nContent-Type: application/json;charset=utf-8\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"Statement could not be executed (42S22 - 1054 - Unknown column 'ur.role' in 'field list')\"\r\n    }\r\n}\r\n```\r\n\r\ninside my config folder there is only one file:\r\n\r\n```\r\n/var/www/html/config $ ls -la\r\ntotal 20\r\ndrwxrwxr-x    1 nobody   nobody        4096 Dec  9 14:50 .\r\ndrwxr-xr-x    1 nobody   nobody        4096 Dec  9 14:26 ..\r\n-rw-r--r--    1 nobody   nobody        6784 Dec  9 14:49 _.php\r\n```"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nWhen uploading images on version v8.1.0 i got broken thumbnail image. I checked network and i got message that \"directus-medium-crop\" key is missing.\r\n\r\nI checked same this in v8.0.2 and worked without any problem.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'File Library'\r\n2. Upload new image\r\n3. Image is broken\r\n\r\n## Expected Behavior\r\n\r\nThere should be thumbnail visible.\r\n\r\n## Actual Behavior\r\n\r\nThumbnail image is broken. \r\n\r\n## Technical Details\r\n\r\n- Device: [ Desktop]\r\n- OS: [Ubuntu]\r\n- Web Server: [nginx]\r\n- PHP Version: [ 7.2.25 ]\r\n- Database: [MySQL 10.3.20-MariaDB ]\r\n- Directus Release Version: [v8.1.0]\r\n- Install Method: [ cloned `master` branch]\r\n"},{"labels":["bug"],"text":"Uploaded the backup DB of v8rc2 and pulled the updated v8.0.1.\r\nGot the above error when tried to login app so private_hash and filename_download are still empty in DB.\r\n![image](https://user-images.githubusercontent.com/3495993/70248008-36b89b00-1772-11ea-8051-97b0a089370a.png)\r\n"},{"labels":["bug"],"text":"`GET /files/folders` does not return a list of folders, error\r\n\r\n```json\r\n{\r\n  \"code\": 203,\r\n  \"message\": \"Item with id \\\"folders\\\" not found\"\r\n}\r\n```\r\n\r\nis returned\r\n\r\n`GET /files/folders/1` still works and returns single folder with ID 1 as expected"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nAs the documentation specifies, the invitation system supported by Directus sends an email:\r\n\r\n> It creates a user with an invited status, and then sends an email to the user with instructions on how to activate their account.\r\n\r\nBut then when we click on the link provided in the email, we only get to a raw JSON exposing the user properties.\r\n\r\n## Steps to Reproduce\r\n\r\nSend an invitation to an email and click the provided link.\r\n\r\n## Expected Behavior\r\n\r\nIs it intended to only land on this raw JSON?\r\n\r\nI would have thought that once the token has been successfully recognised and the user is indeed invited, they could eventually define their password and then login. Exactly like the password reset process, but for a first initialisation.\r\n\r\n## Actual Behavior\r\n\r\nWhen we click the link sent in the invitation, we get to a basic JSON page like this one:\r\n\r\n```json\r\n{\r\n  \"data\": {\r\n    \"id\": 61,\r\n    \"status\": \"invited\",\r\n    \"first_name\": \"John\",\r\n    \"last_name\": \"Doe\",\r\n    \"email\": \"invited@email.com\",\r\n    \"timezone\": \"Europe/Zurich\",\r\n    \"locale\": \"fr-FR\",\r\n    \"locale_options\": null,\r\n    \"avatar\": null,\r\n    \"external_id\": \"f7310b79-888c-4cfc-a0e3-9b42a08e14b6\",\r\n    \"title\": null,\r\n    \"company\": null,\r\n    \"2fa_secret\": null,\r\n    \"role\": 5,\r\n    \"theme\": null\r\n  },\r\n  \"public\": true\r\n}\r\n```\r\n\r\n## Technical Details\r\n\r\n- Directus version 8.0.0\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nWhen using the **TableGatewayFactory** on a read-only collection, when **ACL** is set to **false** (no updates are going to be performed) an exception is triggered.\r\n\r\nOnly when read and update permissions are set does it work using `ACL = $acl`.\r\n\r\n## Steps to Reproduce\r\n\r\n1. See Code and Response below.\r\n\r\n## Expected Behavior\r\n\r\nIn an Endpoint, using **TableGatewayFactory**, one should be able to fetch items when permissions are set to read all. A token with read access should be able to read collections without ACL (breaking change from previous versions).\r\n\r\n## Actual Behavior\r\n\r\nAn exception is thrown when ACL is set to false.\r\n\r\n## Other Context & Screenshots\r\n\r\nSample Code:\r\n```\r\nuse Directus\\Application\\Application;\r\nuse Directus\\Database\\TableGatewayFactory;\r\n\r\n$container = Application::getInstance()->getContainer();\r\n$dbConnection = $container->get('database');\r\n$acl = $container->get('acl');\r\n\r\n$tableGateway = TableGatewayFactory::create('<collection>', [\r\n    'connection' => $dbConnection,\r\n    'acl' => false\r\n]);\r\n```\r\n\r\nSample Error Response:\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"Call to a member function getStatusesOnReadFieldBlacklist() on null\",\r\n        \"class\": \"Error\",\r\n        \"file\": \"~/Sites/Directus/suite/src/core/Directus/Database/TableGateway/RelationalTableGateway.php\",\r\n        \"line\": 1803\r\n    }\r\n}\r\n```\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Mac Desktop\r\n- OS: MacOS 10.14.6\r\n- Web Server: Apache - MAMP 5.5\r\n- PHP Version: 7.2.21 - MAMP 5.5\r\n- Database: MySQL 5.7.26 - MAMP 5.5\r\n- Directus Release Version: 8.0.0-rc.2\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"After you create a `Text Input` interface, set its type to `VarChar` and specify a Length; the input in the panel does not accept the text with that specified length. I think it accepts max 10 chars less."},{"labels":["bug"],"text":"Existing default project. Made the migration changes in /config/api.php but I get the following error when I try to enter file library:\r\n```\r\nitems.vue:260 Error: Invalid field \"filename\" in \"directus_files\"\r\n    at new O (directus-sdk.min.js:1)\r\n    at directus-sdk.min.js:1\r\n(anonymous) @ items.vue:260\r\n```\r\nCan you please explain what has been changed?\r\nAny change that has to be made in the database?"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n- Hooks create file send INT field to files id (correct)\r\n- Hook update file sends string with number (not correct)\r\n\r\nThis is inconsistent and causes errors (if you work in combinations with other systems)\r\n\r\n## Steps to Reproduce\r\n\r\n1. Send Create hook\r\n2. Send Update Hook\r\n\r\n## Expected Behaviour\r\n\r\nFile id should be always INT\r\n\r\n## Actual Behaviour\r\n\r\nFile id is string on update\r\n\r\n## Other Context & Screenshots\r\n\r\nCreate: \r\n\r\n```\r\n{\r\n  \"id\": 45,\r\n  ...\r\n}\r\n```\r\n\r\nUpdate:\r\n\r\n```\r\n{\r\n  \"id\": \"45\",\r\n  ...\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"When you start managing an existing column through Directus, the API will generate the value for the `directus_fields.type` field based on the datatype of the column (f.e. `INT(11)` => `integer`). However, this fails for a lot of datatypes.\r\n\r\nFor example, when starting to manage a `BIGINT` datatype column, the API throws a 500:\r\n\r\n```json\r\n{\r\n  \"error\": {\r\n    \"code\": 9,\r\n    \"message\": \"Failed generating the SQL query. Statement could not be executed (23000 - 1048 - Column 'type' cannot be null)\",\r\n    \"query\": \"INSERT INTO `directus_fields` (`collection`, `field`, `type`, `interface`, `required`, `sort`, `note`, `hidden_detail`, `hidden_browse`, `options`) VALUES ('test', 'id', NULL, 'numeric', '', NULL, NULL, '0', '0', NULL)\",\r\n    \"class\": \"Directus\\\\Database\\\\Exception\\\\InvalidQueryException\",\r\n    \"file\": \"/var/www/html/src/core/Directus/Database/TableGateway/BaseTableGateway.php\",\r\n    \"line\": 784\r\n  }\r\n}\r\n```"},{"labels":["bug"],"text":"# Bug report\r\n\r\nWith a collection having a field of the **File** type, if, while updating an item from the collection, we want to **delete** (and not to deselect) the file from the File interface, it also deletes the item!\r\n\r\n## Behaviour expected\r\n\r\nWhen we just want to delete a file attached to any collection item, it shouldn't remove the item, but just the targeted file.\r\n\r\n## Reproduction\r\n\r\nYou can reproduce the bug in the demo app. I have created a  collection named [File Attached](https://demo.directus.io/admin/#/thumper/collections/file_attached) for this purpose.\r\n\r\n## Observations\r\n\r\nActually, as it happened to me several times, I noticed that whenever this happens, the deleted item is still present but broken in the database. The bug is that **the value of the file field isn't updated**. So the item still points to a file that doesn't exist anymore, and that's the reason why we can't find it in the collection anymore. By updating the corresponding field in the database to the *NULL* value, we can have our item back. It clearly denotes a bug in the file deletion process which, after having deleted the file, doesn't update the corresponding item. And hopefully, it has a simple fix.\r\n\r\n---\r\nDirectus version: 8.0.x\r\n(I hadn't experienced this bug in 7.x)"},{"labels":["bug"],"text":"Hello!!\r\nWhen i try deleting file field from App collection, the app show an error and entire collection disappear from collection list.\r\nIt still in DDBB but not displaying on collection list, if i put manually in DDBB file filed to null its appear again\r\n\r\n### Step to reproduce:\r\n- Create new collection with image file field\r\n- Fill all data and save it.\r\n- Access to edit that collection item and try deleting image field and save item.\r\n- Error throw and when go back to collection list the items isnt appear.\r\n\r\n### Expected Behavior:\r\nBack to collection items list with all items.\r\n\r\n### Actual Behavior:\r\nPrevious edited item is missing\r\n\r\nDirectus Release Version: 8.0.0-rc.2\r\n\r\nThanks a lot!!"},{"labels":["bug"],"text":"If you use `O2M Files interface` you cannot update the item. You should deselect files and reselect them.\r\n\r\n[Link to the video - since the gif becomes 170MB](https://drive.google.com/file/d/1s3Bv-7ruGB2IK3VRqv_ANGtf385Lt04W/view?usp=sharing)\r\n\r\n![Screen Shot 2019-11-27 at 16 16 17](https://user-images.githubusercontent.com/5767654/69726630-f9c92480-1131-11ea-84cd-be3d301533e2.png)\r\n\r\n\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nBug found in Directus 8.0.0 RC2, when re-ordering the fields in a collection, where some of the fields are non-managed?\r\n\r\nThe API response is:\r\n```\r\n{\r\n  \"error\": {\r\n    \"code\": 9,\r\n    \"message\": \"Failed generating the SQL query.\",\r\n    \"query\": \"INSERT INTO directus_fields (collection, field, type, interface, required, sort, note, hidden_detail, hidden_browse, options) VALUES ('jobs', 'id', NULL, NULL, '', '2', NULL, '0', '0', NULL)\"\r\n  }\r\n}\r\n```\r\n\r\n## Expected Behavior\r\n\r\nThat the re-order works.\r\n\r\n## Actual Behavior\r\n\r\nIt fails because the INSERT fails.\r\n"},{"labels":["bug",null,null,null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nI agree that it's can be a pretty exceptional case, but its probably need to be reviewed. I have Directus v8.0.0rc2 installed locally on my machine within WLS (Ubuntu 16.04) under NGINX and PHP 7.3. MySQL 5.7 running within the same box. Everything worked fine till today, when Windows installed the latest updates and did reboot. After that I wasn't able to make login anymore to Directus - was getting an error. I've investigated the issue a bit and it seems like when DIrectus was trying to create a new session it was creating a session token and trying to find this token in directus_user_sessions table. I guess in case if record with such token was not found Directus supposed to create a new one. The thing is that the SQL statement that was called for checking if there is already an active session with such token in DB was failed, because generated token had utf8mb4_general_ci encoding for some reason and directus_user_sessions table had utf8_general_ci charset. I think that this Windows update (https://support.microsoft.com/en-us/help/4523205/windows-10-update-kb4523205) was changing some default system settings related to charsets and so Directus using them for creating session token, instead of using DB settings. I hope the problem is only WLS related, but who knows, may be all Windows setups are affected.  I will try to provide with more information, including screenshots, during a week.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Install windows update kb4523205 \r\n2. Restart the machine\r\n3. Open the App and try to login with any user\r\n4. See error\r\n\r\n## Expected Behavior\r\nUser still should be able to login after installing update\r\n## Actual Behavior\r\nUser cannot login to the app after installing update\r\n\r\n## Other Context & Screenshots\r\nWill provide later\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10.0.17763 WLS (Ubunto 16.04)\r\n- Web Server: NGINX\r\n- PHP Version: 7.3.0\r\n- Database:  MySQL 5.7\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\n\r\nHey there!\r\n\r\n\r\nThanks for taking the time to notify the community of an issue with the Directus app.\r\n\r\nPlease be as detailed as you possibly be can about the problem at hand. Being able to reproduce the issue quickly (or at all) ensures that the issue can be fixed as quickly as possible.\r\n\r\nSome useful details to include: your version of Directus, stack/server info, screenshots, logs, or even database dumps.\r\n\r\nAlso, for security issues, please email support@directus.io directly.\r\n\r\n\r\nKeep being awesome!\r\n\r\n‚ú®üê∞‚ú®\r\n\r\n-->\r\n\r\nWhen editing an image through the file view interface and saving the thumbnail is not updated in the list view. \r\n\r\n# Steps to reproduce\r\n\r\n1. Upload a file through the File Library.\r\n1. Click on the image to edit it and crop the image. \r\n1. Go back to the File library and you will see that the old thumbnail is still showing.\r\n\r\nI think the problem is that the thumbnail needs to be deleted when the image is edited so that a new thumbnail is generated. \r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nMake any modifying request (POST, DELETE, PATCH) to the files endpoint with the `activity_skip=1` query parameter.\r\n\r\n## Expected Behavior\r\n\r\nNo record on the `directus_activity` nor `directus_revisions` about the request.\r\n\r\n## Actual Behavior\r\n\r\nThe activity is logged like if there was no `activity_skip` parameter\r\n\r\n## Other Context & Screenshots\r\n\r\nThe reason to skip activity on some operations is because I synchronize my data on another service with directus in order to access said data from my site and as a backup mechanism in case said service goes dark. This synchronization is automated and runs every few hours making those tables way to big to handle.\r\n\r\n## Technical Details\r\n\r\n- Device: Digital Ocean droplet\r\n- OS: Ubuntu 18.04 LTS\r\n- Web Server: nignx 1.14\r\n- PHP Version: 7.2.24\r\n- Database: MySQL 5.7.28-0ubuntu0.18.04.4\r\n- Install Method: Cloned release branch\r\n"},{"labels":["bug"],"text":"Hook for field update doesnt work. I check other hooks like item creation o item update and works fine but with fields i cant made work.\r\n\r\n### Step to reproduce:\r\n- Create new folder public/extensions/custom/hook/test\r\n- Create new file under previus folder: hooks.php\r\n- Add new hook 'field.update.[collection-name]'\r\n- Put error_log or dump \r\n- Update collection field from app collection\r\n\r\n### Expected Behavior:\r\nError log or dump is visible on log file and hook features are launched\r\n\r\n### Actual Behavior:\r\nNothing happens.\r\n\r\nDirectus Release Version: 8.0.0-rc.2\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nThere seems to be an issue with the cache. Currently, the API cannot differentiate between external API calls which should be cached and API calls from /admin which may not need to be cached especially while actively updating collections. Sometimes when a user is not authenticated and a cache of a core collection is created, e.g. `directus_settings`, it prevents the user from signing back in throwing an error - `Cannot read property 'api' of undefined`.\r\nTurning off cache in the config or purging the cache seems to fix the error.\r\n\r\n## Steps to Reproduce\r\n\r\nIt is hard to produce steps to recreate!\r\nSeems this error happened when signed in the app, while an external API request was made that created a new cache, and when refreshing the page, got the error.\r\nIt also happened when navigating to the login page on a new tab after a cache has been made.\r\nIt only happens when `directus_*` collections have been updated.\r\n\r\n## Expected Behavior\r\n\r\nOnly cache external API requests.\r\nThe admin app should always load from the DB to reflect actual DB data.\r\nIt would be nice if there were a query parameter to force fetching from the DB even if a cache exists (useful for refresh functionality).\r\n\r\n## Actual Behavior\r\n\r\nRequests from the Admin app are being cached and sometimes can break if an update has been made but not reflected in the cache. \r\n\r\n## Technical Details\r\n\r\n- Device: Mac Desktop\r\n- OS: MacOS 10.14.6\r\n- Web Server: Apache - MAMP 5.5\r\n- PHP Version: 7.2.21 - MAMP 5.5\r\n- Database: MySQL 5.7.26 - MAMP 5.5\r\n- Directus Release Version: 8.0.0-rc.2\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nWhen working on a kubernetes environment, the host name correspond to the pod name\r\n\r\n1. Login into the App \r\n2. Trigger a new deployment\r\n3. Hit F5 et try to login again\r\n\r\n## Expected Behavior\r\n1. Login again and ok!\r\n\r\n## Actual Behavior\r\n1. When you try to log in, you've the message : API could not be reached\r\n2. PHP log file has some : \r\nFailed generating the SQL query. :SELECT `directus_user_sessions`.* FROM `directus_user_sessions` WHERE `token` = 'ÔøΩ#ÔøΩQZÔøΩW+ÔøΩÔøΩÔøΩ1ÔøΩYÔøΩÔøΩ^CÔøΩ*ÔøΩWÔøΩ' LIMIT 1 [] []\r\n\r\nIt seems that the app doesn't remove the directus-_-session cookie when it no more valid.\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nCreating users from API returns \"401: Unauthorized Request\".\r\n\r\nFirst, I need to say that updating an existing user works - of course with including token. So there is no \"wrong url\" or something else.\r\n\r\n## Steps to Reproduce\r\n\r\nI give required permission on the role **public** to create users:\r\n\r\n![Screen Shot 2019-11-23 at 17 21 15](https://user-images.githubusercontent.com/5767654/69480135-ae530580-0e15-11ea-9b7f-08b54108de16.png)\r\n\r\nhere is my code (Angular):\r\n``` typescript\r\n  public async createUser(firstName: string, lastName: string, email: string, password: string): Promise<any> {\r\n    const data = { first_name: firstName, last_name: lastName, email: email, password: password, status: \"active\", roles: [3], timezone: \"Europe/Vienna\", locale: \"tr-TR\" }\r\n    const json = JSON.stringify(data);\r\n    const headers = new HttpHeaders({\r\n      \"Content-Type\": \"application/json\",\r\n    });\r\n    return this.http.post('https://api.myapp.com/project-id/users', json, { headers });\r\n  }\r\n```\r\n\r\nError from browser console: \r\n```\r\n[Log] creating user failed (main.js, line 947)\r\nHttpErrorResponse\r\n\r\nerror: {error: {code: 3, message: \"Unauthorized request\"}}\r\n\r\nheaders: HttpHeaders {normalizedNames: Map, lazyUpdate: null, lazyInit: function}\r\n\r\nmessage: \"Http failure response for https://cms.uflymarket.com/ufly-market/users: 401 OK\"\r\n\r\nname: \"HttpErrorResponse\"\r\n\r\nok: false\r\n\r\nstatus: 401\r\n\r\nstatusText: \"OK\"\r\n\r\nurl: \"https://cms.uflymarket.com/ufly-market/users\"\r\n\r\nHttpErrorResponse Prototype\r\n```\r\n\r\nError from log file:\r\n\r\n```\r\n[2019-11-23 09:05:14] api[ufly-market].ERROR: Directus\\Exception\\UnauthorizedException: Unauthorized request in /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Permissions/Acl.php:991\r\nStack trace:\r\n#0 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1178): Directus\\Permissions\\Acl->enforceReadOnce\r\n#1 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1161): Directus\\Database\\TableGateway\\BaseTableGateway->enforceReadPermission\r\n#2 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1283): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#3 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(879): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#4 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Services/ItemsService.php(561): Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#5 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Services/ItemsService.php(47): Directus\\Services\\ItemsService->isManyToManyField\r\n#6 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Services/UsersService.php(58): Directus\\Services\\ItemsService->createItem\r\n#7 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/endpoints/Users.php(75): Directus\\Services\\UsersService->create\r\n#8 [internal function]: Directus\\Api\\Routes\\Users->create\r\n#9 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#10 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#11 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#12 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#13 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#14 [internal function]: Slim\\DeferredCallable->__invoke\r\n#15 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#16 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#17 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#18 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#19 [internal function]: Slim\\DeferredCallable->__invoke\r\n#20 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#21 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#22 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#23 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#24 [internal function]: Slim\\DeferredCallable->__invoke\r\n#25 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#26 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#27 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#28 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#29 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#30 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#31 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#32 [internal function]: Slim\\DeferredCallable->__invoke\r\n#33 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#34 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#35 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#36 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#37 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#38 [internal function]: Slim\\DeferredCallable->__invoke\r\n#39 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#40 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#41 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#42 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#43 [internal function]: Slim\\DeferredCallable->__invoke\r\n#44 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#45 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\App->Slim\\{closure}\r\n#46 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\n#47 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#48 [internal function]: Slim\\DeferredCallable->__invoke\r\n#49 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#50 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\n#51 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#52 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#53 [internal function]: Slim\\DeferredCallable->__invoke\r\n#54 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#55 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\n#56 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#57 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#58 [internal function]: Slim\\DeferredCallable->__invoke\r\n#59 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#60 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#61 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#62 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#63 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#64 /var/www/vhosts/uflymarket.com/cms.uflymarket.com/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n\r\nAlso according to the docs, only _email_ and _password_ should be enough to create a user. But API says it requires _status_, _timezone_, _roles_. If I do not include them in payload, it complains about that."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nInconsistency between db schema and directus with NOT NULL/required fields.\r\n\r\na. `NOT NULL` fields not labeled as required in GUI;\r\n\r\nb. required fields are not set as `NOT NULL` in the actual schema.\r\n\r\n## Steps to Reproduce\r\n\r\n#### a. `NOT NULL` fields not labeled as required in GUI\r\n\r\n1. In the db used by your Directus installation, create a new table executing the query :\r\n    ```\r\n    CREATE TABLE test(\r\n        id INT PRIMARY KEY AUTO_INCREMENT,\r\n        n INT NOT NULL\r\n        );```\r\n2. Access your directus admin panel and log in\r\n3. Select the new table to be managed as a collection in directus\r\n4. Go to the new collectiion page, select add Item\r\n5. See error: the field `n` is not labeled as required (no asterisk near the field name). However it's not possible to insert a new item with `n` field left blank: the warning message `n: This value should not be blank.` is shown and the operation fails (since the `NOT NULL` constraint fails).\r\n\r\n#### b. required fields are not set as `NOT NULL` in the actual schema.\r\n\r\n1. In Directus admin panel create a new collection `test2`.\r\n2. Create a new field for the collection (type and interface are irrelevant), name it `n` and switch on the `Required` option.\r\n3. Access the database via the mysql cli and execute the query `SHOW CREATE TABLE test2` on the Directus database.\r\n4. See error: the table definition does not contain the `NOT NULL` constraint for the required field.\r\n\r\n## Expected Behavior\r\n\r\n#### a. `NOT NULL` fields not labeled as required in GUI\r\nThe field `n` should be labeled as required (asterisk near the field name), and it shouldn't be possible to insert a new item with `n` field left blank.\r\n\r\n#### b. required fields are not set as `NOT NULL` in the actual schema.\r\n\r\nThe following `CREATE TABLE` statement should be returned:\r\n```\r\n CREATE TABLE `test2` (\r\n    `id` int(15) unsigned NOT NULL AUTO_INCREMENT,\r\n    `n` int(11) NOT NULL DEFAULT NULL,\r\n    PRIMARY KEY (`id`)\r\n) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4\r\n\r\n```\r\n\r\n## Actual Behavior\r\n\r\n#### a. `NOT NULL` fields not labeled as required in GUI\r\nThe field `n` is not labeled as required (no asterisk near the field name), however it's not possible to insert a new item with `n` field left blank.\r\n\r\n#### b. required fields are not set as `NOT NULL` in the actual schema.\r\n\r\nThe following `CREATE TABLE` statement is returned:\r\n```\r\n CREATE TABLE `test2` (\r\n    `id` int(15) unsigned NOT NULL AUTO_INCREMENT,\r\n    `n` int(11) DEFAULT NULL,\r\n    PRIMARY KEY (`id`)\r\n) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4\r\n\r\n```\r\nHere, the `NOT NULL` constraint is not expressed in the table definition.\r\n\r\n## Other Context & Screenshots\r\nI think this is related to how directus manages required fields internally. I noticed that the information whether a field is required or not is stored in `directus_fields`, and not in the collection table, where it should be expressed as a `NOT NULL` constraint. This bug brings inconsistency since the actual relation schema differs from the schema presented to directus user.\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10\r\n- Web Server: Apache 2.4.38\r\n- PHP Version: 7.3.3\r\n- Database: MySQL 5.7.17\r\n- Directus Release Version: v8.0.0-rc.2\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug",null,null],"text":"# Feature Request - Where it came from?\r\n\r\nSomehow new tokens take some time to become available.\r\nMy mobile app logs the user in via `auth/authenticate` endpoint. Token is returned successfully. Then app tries to get the user data via `users/me` right after the token response. But API says `item not found` with status code 404. Then I re-called getting user after the failing attempt  and it works.\r\n\r\n## What problem does this feature solve?\r\n\r\nReturning user data with the token is the most basic and swifty way. But I do not know if you have security concerns on this."},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Install directus-api and app with 8.0.0-rc2 tag\r\n2. Use docker or use DIRECTUS_USE_ENV=1\r\n3. run install script with ./bin/directus install:database and ./bin/install:install\r\n4. Go to http://xxx/admin\r\n\r\n## Expected Behavior\r\nLogin form should display\r\n## Actual Behavior\r\n![S√©lection_162](https://user-images.githubusercontent.com/1788150/69439556-82694e80-0d47-11ea-9850-f556bef6b899.png)\r\n\r\n## Other Context & Screenshots\r\n![S√©lection_163](https://user-images.githubusercontent.com/1788150/69439587-92812e00-0d47-11ea-8c58-79c0e17e705b.png)\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n`[2019-11-22 16:19:07] api[api].ERROR: Directus\\Database\\Exception\\ItemNotFoundException: Item not found in /opt/app-root/src/src/core/Directus/Services/ItemsService.php:138\r\nStack trace:\r\n#0 /opt/app-root/src/src/core/Directus/Services/UsersService.php(145): Directus\\Services\\ItemsService->findByIds\r\n#1 /opt/app-root/src/src/endpoints/Users.php(92): Directus\\Services\\UsersService->findByIds\r\n#2 [internal function]: Directus\\Api\\Routes\\Users->read\r\n#3 /opt/app-root/src/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#4 /opt/app-root/src/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#5 /opt/app-root/src/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#6 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#7 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#8 [internal function]: Slim\\DeferredCallable->__invoke\r\n#9 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#10 /opt/app-root/src/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(124): Slim\\Route->Slim\\{closure}\r\n#11 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#12 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#13 [internal function]: Slim\\DeferredCallable->__invoke\r\n#14 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#15 /opt/app-root/src/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#16 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#17 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#18 [internal function]: Slim\\DeferredCallable->__invoke\r\n#19 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#20 /opt/app-root/src/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\Route->Slim\\{closure}\r\n#21 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\n#22 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#23 [internal function]: Slim\\DeferredCallable->__invoke\r\n#24 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#25 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#26 /opt/app-root/src/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#27 /opt/app-root/src/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#28 /opt/app-root/src/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#29 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#30 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#31 [internal function]: Slim\\DeferredCallable->__invoke\r\n#32 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#33 /opt/app-root/src/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#34 /opt/app-root/src/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#35 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#36 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#37 [internal function]: Slim\\DeferredCallable->__invoke\r\n#38 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#39 /opt/app-root/src/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#40 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#41 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#42 [internal function]: Slim\\DeferredCallable->__invoke\r\n#43 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#44 /opt/app-root/src/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\n#45 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#46 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#47 [internal function]: Slim\\DeferredCallable->__invoke\r\n#48 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#49 /opt/app-root/src/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\n#50 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#51 /opt/app-root/src/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#52 [internal function]: Slim\\DeferredCallable->__invoke\r\n#53 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#54 /opt/app-root/src/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#55 /opt/app-root/src/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#56 /opt/app-root/src/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#57 /opt/app-root/src/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#58 /opt/app-root/src/public/index.php(5): Directus\\Application\\Application->run [] []\r\n10.128.0.1 - - [22/Nov/2019:15:19:07 +0000] \"GET /api/users/me?fields=*.* HTTP/1.1\" 404 203 \"-\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36\"`\r\n## Technical Details\r\n\r\n- Web Server: Apache 2.4\r\n- PHP Version: 7.1\r\n- Database: Mysql 5.7\r\n- Install Method:cloned 8.0.0-rc2 tag\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nTitle says all.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection\r\n2. Inside \"roles & permissions\" give reading permission to \"Public\" user\r\n3. Try to send a \"GET\" request to the relevant URL. ex: `mywebpage.com/_/items/magazines` \r\n4. See the error\r\n\r\n## Other Context & Screenshots\r\n\r\n1. The image shows I have given the reading permissions\r\n![Screen Shot 2019-11-21 at 20 48 20](https://user-images.githubusercontent.com/5767654/69362888-6eb6dd00-0ca0-11ea-88e7-cf92962f6f73.png)\r\n\r\n\r\n2. This image shows where I'm sending the get request and what is the respose\r\n![Screen Shot 2019-11-21 at 20 50 18](https://user-images.githubusercontent.com/5767654/69362946-8e4e0580-0ca0-11ea-9b09-eb5ee9bd251d.png)\r\n\r\n## Technical Details\r\n\r\n- Server: centOS 7 \r\n- PHP Version:  7.3"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nUsing the Directus Suite the mail sender uses 'frontend' as address and subsequently fails on its own test. \r\n\r\n## Expected Behavior\r\n\r\nMail is sent through my own Mailserver.\r\n\r\n## Actual Behavior\r\n\r\nAPI returns:\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"Address in mailbox given [frontend] does not comply with RFC 2822, 3.6.2.\",\r\n        \"class\": \"Swift_RfcComplianceException\",\r\n        \"file\": \"/var/www/internal/directus/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Mime/Headers/MailboxHeader.php\",\r\n        \"line\": 345\r\n    }\r\n}\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\napi.php\r\n```\r\n'mail' => [ \r\n        'default' => [\r\n            'transport' => 'smtp',\r\n            'from' => 'noreply@ateon.ch',\r\n            'host' => 'mail.ateon.ch',\r\n            'port' => 587,\r\n            'username' => 'noreply@ateon.ch',\r\n            'password' => 'xxxx',\r\n            'encryption' => 'starttls'\r\n        ],\r\n    ],\r\n```\r\n\r\n## Technical Details\r\n\r\n- OS: Ubuntu 16.04.6 LTS\r\n- Web Server: nginx/1.14.2\r\n- PHP Version: 7.8.3\r\n- Install Method: cloned master branch\r\n- DIrectus Version: tags/190927A\r\n"},{"labels":["bug"],"text":"![image](https://user-images.githubusercontent.com/9141017/69161975-f0004b00-0ab9-11ea-9a95-baa902d2219d.png)\r\n\r\nThis should've been\r\n\r\n```php\r\n[\r\n  'social_providers' => [\r\n    'okta' => [],\r\n    // etc\r\n  ]\r\n]\r\n```"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nDownload Directus v8.0.0-rc.1 (git clone, or zip, doesnt matter) and configure the installation with the browser (navigate to /admin)\r\n\r\n## Expected Behavior\r\n\r\nAfter the installation is complete navigating to /admin should open the login form\r\n\r\n## Actual Behavior\r\n\r\nIt opens the first step of the installation again and I cant get to the login form. Also in the console i get the error: GET http://cms.mydomain.loc/server/projects 503 (Service Unavailable)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Ubuntu 19\r\n- Web Server: Nginx 1.15.9-0ubuntu1.1\r\n- PHP Version: 7.2.0\r\n- Database: MySQL 5.7.28-0ubuntu0.19.04.2\r\n- Install Method: cloned `master` branch\r\n\r\n## Solution to the bug\r\n\r\nThe problem seems to be that the installer creates a `diretus/config/_.php` and a `diretus/config/__api.json` file. Renaming those files to `diretus/config/api.php` and `diretus/config/api_api.json` solves the problem, and I can login just fine.\r\n\r\nI've tried the same installation steps with Directus v7.0.19 and the installer creates the `diretus/config/api.php` config file, named correctly, so it seems a bug with version 8 rc."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n- create 3 collections:\r\n  1. **actors** -> numeric field **movie_id**, text field actors **name**\r\n  2. **movie** -> numeric field **movielist_id**, text field movie's **name**, **one2many** to **actors**\r\n  3. **movielist** -> **one2many** to **movie**\r\n- add 2 movies and some actors to each movie, save all, and click the hook in the top-right corner\r\n- open entry again for changes\r\n- now - let's say you're mistaken - delete one actor from the first movie\r\n- open seceond movie, click **select existing** and add the previous deleted actor to the second movie\r\n- save and click the hook in the top-right corner -> sql error is shown\r\n\r\n## Expected Behavior\r\n- changes should be saved\r\n\r\n## Actual Behavior\r\n- besides the error you are stuck in that state, only deleting of some elements helps\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\nbtw.: this is shown in the console, for some reasons the update of the directus_users fails:\r\n```\r\ncode: 9\r\nmessage: \"Failed generating the SQL query.\"\r\nquery: \"INSERT INTO `directus_users` (`last_access_on`, `last_page`, `external_id`) VALUES ('2019-11-19 09:58:38', '/collections/movielist/1', '8979c4b3-9a48-4328-bdd1-fce0534617e2')\"\r\n__proto__: Object\r\n```\r\n\r\n## Technical Details\r\n\r\n- Device: desktop\r\n- OS: Mac OS 10.13.6\r\n- Web Server: Apache, Mamp\r\n- PHP Version: 7.3.8\r\n- Database: 5.7.26\r\n- Install Method: both, cloned master branch and docker container\r\n"},{"labels":["bug"],"text":"Right now, the API config is managed in PHP files. This makes it hard to manage the config from external sources, as we have to write the config into PHP format. \r\n\r\nBy moving to JSON, it's easier to read from and write to the config file from the API and other sources.\r\n\r\n---\r\n\r\nThere is one thing that needs to be supported before we can make this change: Scoped Extensions.\r\n\r\nRight now, the config file is the only way you can create hooks that are scoped to a single project. \r\n\r\n---\r\n\r\nWhen moving to the new config format, we should also get rid of names with underscores in them, like `root_url` in `storage`. This needs to be done to make mapping from environment variables in instances like Docker easier. Currently, we can't infer the config option from the environment name, for example:\r\n\r\n\r\n`DIRECTUS_DATABASE_HOST`\r\n\r\ncan automatically map to\r\n\r\n```\r\n[\r\n  'database' => [\r\n    'host' => X\r\n  ]\r\n]\r\n```\r\n\r\n, yet `DIRECTUS_STORAGE_ROOT_URL` can not be inferred as \r\n\r\n```\r\n[\r\n  'storage' => [\r\n    'root_url' => X\r\n  ]\r\n]\r\n```\r\n\r\nbecause of the underscore in the name"},{"labels":["bug"],"text":"When you try resetting the password of an inactive user, the api returns that something went wrong while sending the email. This is incorrect, as the problem here is the fact that the user is inactive."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Deploy 8.0.0-RC1 tag version\r\n2. Go to http://localhost/_\r\n3. See error\r\n{\"error\":{\"code\":null,\"message\":\"SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'directus_settings-project_foreground' for key 'idx_collection_field'\",\"class\":\"PDOException\",\"file\":\"\\/opt\\/app-root\\/src\\/vendor\\/robmorgan\\/phinx\\/src\\/Phinx\\/Db\\/Adapter\\/PdoAdapter.php\",\"line\":134}}\r\n\r\n## Expected Behavior\r\nShould work\r\n## Actual Behavior\r\nError\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: All\r\n- OS: Centos 7\r\n- Web Server: Apache 2.4\r\n- PHP Version: 7.1.30\r\n- Database: Mysql 5.7\r\n- Install Method: Docker\r\n"},{"labels":["bug"],"text":"For security issues, please email support@directus.io directly.\r\n<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\nfollow steps at https://docs.directus.io/extensions/storage-adapters.html#core-adapters\r\n1. composer require league/flysystem-aws-s3-v3\r\n2. set config/api.php\r\n`'storage' => [\r\n        'adapter' => 's3',\r\n        'key' => '<AWSAccessKeyId>',\r\n        'secret' => '<AWSSecretKey>',\r\n        'bucket' => 'odbdirectus',\r\n        'version' => 'latest',\r\n        'region' => 'eu-west-2',\r\n        'options' => [\r\n          'ACL' => 'public-read',\r\n          'Cache-Control' => 'max-age=604800'\r\n        ],\r\n        'endpoint' => 'https://apigateway.eu-west-2.amazonaws.com',\r\n        'root' => '/',\r\n        'thumb_root' => '/thumbnails',\r\n        'root_url' => 'https://s3-eu-west-2.amazonaws.com/odbdirectus',\r\n    ],`\r\n3. try to upload a file in file library\r\n\r\n## Expected Behavior\r\nFile uploads, can see it in File Library\r\n## Actual Behavior\r\n4. Initial green, turns red with a pop up message saying \"No permission to write: <filename> \r\n\r\n## Technical Details\r\n\r\n- Device: Macbook\r\n- OS: MacOS 10.14.6, \r\n- Web Server: nginx\r\n- PHP Version: 7.2.0\r\n- Database: MySQL 5.7.27\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"If you save an item (eg: on the demo), the activity is saying `4 hours ago`... which is incorrect. This has been an issue in the past, it needs to be resolved completely this time.\r\n\r\n![Screen Shot 2019-10-24 at 3 59 45 PM](https://user-images.githubusercontent.com/522079/67520734-6e163100-f677-11e9-9805-d4e497f6a4f6.png)\r\n"},{"labels":["bug"],"text":"When patching the `/files/:id` endpoint with new `data` in base64, I expected the old image to be replaced with the new data. Instead, the API saved them as new files:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/68789145-dde26080-0612-11ea-8f68-9182122ae23c.png)\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a new collection with translated field  e.g. `label`\r\n2. Mark the said translated field as `required`\r\n3. Create a new record in the collection without a value for the *required translated field*\r\n4. See that the new record is saved without an error\r\n\r\n## Expected Behavior\r\n\r\nValidation error required the field\r\n\r\n## Actual Behavior\r\n\r\nSaved the record with empty required field\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n![translation_required_field_not_enforced_480](https://user-images.githubusercontent.com/1925271/68726158-bd1b0a80-0614-11ea-8658-f146a93dfd73.gif)\r\n\r\n## Technical Details\r\nReproduced on directus.app\r\n"},{"labels":["bug"],"text":"Just created a sample hook in api.php file, under actions. The hook does a post request when a item is added to collection named vanity_urls. The vanity_urls collection has two fields. source and destination.\r\n\r\n> 'hooks' => [\r\n>         'actions' => [\r\n> 'item.create.vanity_urls' => function ($collectionName, $data) {\r\n>                 $ch = curl_init();\r\n>                 curl_setopt($ch, CURLOPT_URL, 'https://api.fastly.com/service/servid/dictionary/dictid/item');\r\n>                 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n>                 curl_setopt($ch, CURLOPT_POST, 1);\r\n>                 curl_setopt($ch, CURLOPT_POSTFIELDS, \"item_key=/\" . $data['source'] . \"&item_value=\" . $data['destination']);\r\n>                 $headers = array();\r\n>                 $headers[] = 'Fastly-Key: keyashasjhas';\r\n>                 $headers[] = 'Content-Type: application/x-www-form-urlencoded';\r\n>                 curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);\r\n>                 $result = curl_exec($ch);\r\n>                 if (curl_errno($ch)) {\r\n>                     echo 'Error:' . curl_error($ch);\r\n>                 }\r\n>                 curl_close($ch);\r\n>             },\r\n>    ],\r\n>    'filters' => [],\r\n> ],\r\n\r\nThis hook is not sending the request after I create an item inside the collection. We tried to log details from inside the hook, but nothing is being logged at all, so this code is never being triggered. Any thing wrong with the hook itself? I tested the php curl command outside of hook and it works fine.\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a user role with \"add\" and \"view\" permissions for `directus_files` table\r\n2. Create a user and choose this new role\r\n3. Log in as this user\r\n4. Go to File Library\r\n5. Create a file (upload)\r\n\r\n## Expected Behavior\r\n\r\nFile should be uploaded and created successfully.\r\n\r\n## Actual Behavior\r\n\r\nAn error is shown:\r\n\r\n> You are not allowed to upload, edit or delete files\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\nHere is an error log :\r\n\r\n```\r\n[2019-11-12 10:02:28] api[_].ERROR: Directus\\Exception\\ForbiddenException: You are not allowed to upload, edit or delete files in C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\CoreServicesProvider.php:706\r\nStack trace:\r\n#0 [internal function]: Directus\\Application\\CoreServicesProvider->Directus\\Application\\{closure}\r\n#1 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Hook\\Emitter.php(291): call_user_func_array\r\n#2 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Hook\\Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\n#3 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Filesystem\\Files.php(295): Directus\\Hook\\Emitter->run\r\n#4 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\CoreServicesProvider.php(332): Directus\\Filesystem\\Files->saveData\r\n#5 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\CoreServicesProvider.php(376): Directus\\Application\\CoreServicesProvider->Directus\\Application\\{closure}\r\n#6 [internal function]: Directus\\Application\\CoreServicesProvider->Directus\\Application\\{closure}\r\n#7 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Hook\\Emitter.php(291): call_user_func_array\r\n#8 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Hook\\Emitter.php(151): Directus\\Hook\\Emitter->executeListeners\r\n#9 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Database\\TableGateway\\BaseTableGateway.php(1594): Directus\\Hook\\Emitter->apply\r\n#10 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Database\\TableGateway\\BaseTableGateway.php(787): Directus\\Database\\TableGateway\\BaseTableGateway->applyHook\r\n#11 C:\\wamp64\\www\\gamax-api\\vendor\\zendframework\\zend-db\\src\\TableGateway\\AbstractTableGateway.php(264): Directus\\Database\\TableGateway\\BaseTableGateway->executeInsert\r\n#12 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Database\\TableGateway\\BaseTableGateway.php(390): Zend\\Db\\TableGateway\\AbstractTableGateway->insert\r\n#13 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Database\\TableGateway\\RelationalTableGateway.php(412): Directus\\Database\\TableGateway\\BaseTableGateway->addRecordByArray\r\n#14 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Services\\FilesServices.php(59): Directus\\Database\\TableGateway\\RelationalTableGateway->createRecord\r\n#15 C:\\wamp64\\www\\gamax-api\\src\\endpoints\\Files.php(84): Directus\\Services\\FilesServices->create\r\n#16 [internal function]: Directus\\Api\\Routes\\Files->create\r\n#17 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\Handlers\\Strategies\\RequestResponse.php(40): call_user_func\r\n#18 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#19 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#20 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#21 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\n#22 [internal function]: Slim\\DeferredCallable->__invoke\r\n#23 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#24 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#25 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#26 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\n#27 [internal function]: Slim\\DeferredCallable->__invoke\r\n#28 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#29 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#30 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#31 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\n#32 [internal function]: Slim\\DeferredCallable->__invoke\r\n#33 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#34 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#35 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\Route.php(268): Slim\\Route->callMiddlewareStack\r\n#36 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\App.php(503): Slim\\Route->run\r\n#37 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#38 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#39 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\n#40 [internal function]: Slim\\DeferredCallable->__invoke\r\n#41 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#42 C:\\wamp64\\www\\gamax-api\\vendor\\directus\\proxy-detection\\src\\ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#43 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\Http\\Middleware\\ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#44 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#45 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#48 C:\\wamp64\\www\\gamax-api\\vendor\\akrabat\\ip-address-middleware\\src\\IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#49 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#50 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\n#51 [internal function]: Slim\\DeferredCallable->__invoke\r\n#52 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#53 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\Http\\Middleware\\CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#54 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#55 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\n#56 [internal function]: Slim\\DeferredCallable->__invoke\r\n#57 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#58 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\n#59 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#60 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(57): call_user_func_array\r\n#61 [internal function]: Slim\\DeferredCallable->__invoke\r\n#62 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#63 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#64 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\App.php(392): Slim\\App->callMiddlewareStack\r\n#65 C:\\wamp64\\www\\gamax-api\\vendor\\slim\\slim\\Slim\\App.php(297): Slim\\App->process\r\n#66 C:\\wamp64\\www\\gamax-api\\src\\core\\Directus\\Application\\Application.php(161): Slim\\App->run\r\n#67 C:\\wamp64\\www\\gamax-api\\public\\index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n\r\nI actually fixed the issue by changing a single function call, on this file https://github.com/directus/api/blob/0491f6af049f0a18d670f034916f2ec39c2c034b/src/core/Directus/Application/CoreServicesProvider.php#L705. `canUpdate` should be `canCreate`.\r\n\r\nI considered making a PR for this but I don't know what side effect this change could have so here is an issue instead!\r\n\r\n## Technical Details\r\n\r\n- Device: Laptop\r\n- OS: latest Windows 10\r\n- Web Server: [eg: Apache 2.4.37]\r\n- PHP Version: 7.3.1\r\n- Database: MySQL 5.7.24\r\n- Install Method: cloned master branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nGraphQL query doesn't bring the content of the related table in M2M relationship.\r\n\r\n\r\n## Steps to Reproduce\r\n\r\ncreate a collection (call it \"bar\") with a text input field ('name') for the DB-relation\r\ncreate a collection (call it \"foo\") with a M2M relation to \"bar\", using \"bars\" as a relational field \r\ncreate an item in foo\r\ncreate an item in bar\r\nbind item from bar to item from foo\r\ncreate a query like that (using postman or graphql playground):\r\nquery foo {\r\n    foo {\r\n        data {\r\n                id\r\n                bars {\r\n                   name\r\n                }\r\n        }\r\n    }\r\n}\r\n\r\n## Expected Behavior\r\nQuery should bring array with related item for M2M field 'bars'\r\n\r\n## Actual Behavior\r\nQuery brings empty Array\r\n\r\n## Other Context & Screenshots\r\n\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Ubuntu 17.04\r\n- Web Server: NGINX\r\n- PHP Version: 7.3.7\r\n- Database: MySQL 8.0.12\r\n- Install Method: cloned `build` branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nHi, I am having some trouble with the response times saving translation interface.\r\nI have a collection with translation interface (13 translations) each with cca 15 fields and updating the collection takes really long time. I was able to locate the major slowdown in the call `$relationalCollectionData = $this->findByIds(...)` in two nested foreach loops in `validateAliasCollection(...)` function in `ItemsService.php`.  I didn't get much further from here, is there some way to optimize this? I also noticed that the APP sends to update array of all the translations and all their fields even though they didn't update (only one field in one translation updated for example)\r\n\r\n## Steps to Reproduce\r\n\r\nI am attaching whole directus DB dump of a MWE setup, login is: admin@admin.com / directus\r\nDB dump to download: http://bit.ly/2Cynbes\r\n\r\nLogin, go to Country collection, select Portugal, update one translated field (any) and press save. \r\n\r\n## Expected Behavior\r\n\r\nCollection to be saved in reasonable time\r\n\r\n## Actual Behavior\r\n\r\nSaving takes over a minute (can timeout on webserver if not configured for longer timeout)\r\n\r\n## Other Context & Screenshots\r\n\r\nDB Dump to download: http://bit.ly/2Cynbes\r\n\r\n## Technical Details\r\n\r\n- APP Version: 7.11.0\r\n- API Version: 2.6.0\r\n- Device: Desktop\r\n- OS: Windows 10.1803\r\n- Web Server: nginx 1.17.5\r\n- PHP Version: 7.3.10\r\n- Database: MySQL 5.7.22\r\n- Install Method: docker\r\n"},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Pull latest GIT code v2.6.0\r\n2. Click on \"Update Database\" in APP\r\n3. Afterwards I cannot access uploaded font and JS files from the /_/originals/ endpoint in my HTML pages/projects:\r\n\"No 'Access-Control-Allow-Origin' header is present on the requested resource.\"\r\n\r\n## Expected Behavior\r\nIn API 2.5.0, prior to update, uploaded files such as fonts and scripts could be linked from the /_/originals/ endpoint.\r\n\r\n## Actual Behavior\r\nLinking and accessing fonts and scripts from the /_/originals/ endpoint fails with:\r\n\"No 'Access-Control-Allow-Origin' header is present on the requested resource.\"\r\nKindly assist.\r\n\r\n## Technical Details\r\n\r\n- Device: CentOS 7 server\r\n- Web Server: Apache\r\n- PHP Version: 7.3\r\n- Database: MariaDB\r\n- Install Method: cloned from Github\r\n"},{"labels":["bug",null,null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nWhen having nested data with junction tables, too many hooks are fired. In my case I have an expensive sync operation (I use directus to manage some non-user content which is synced to another database upon editing (caches are cleared and data is re-fetched)). \r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a nested hierarchy of collections as described below\r\n2. Create some items \r\n3. Add an \"item.update\" hook\r\n4. Update one in the lower hierachy\r\n5. Watch the hooks being triggered in 4.\r\n\r\n## Expected vs actual Behavior\r\n\r\nThink of this data structure:\r\n\r\n```\r\nuniversity\r\n  - course\r\n    - course_teachers (Junction)\r\n      - teacher\r\n```\r\n\r\nWhen I update the teacher by adding a course to the list of taught courses the following hooks are called: \r\n\r\n```\r\nuniversity #update for just one university for the teacher ( thats ok)\r\n  - course  # update for all courses related to teacher (\"too much\", just the one added would logically change)\r\n    - course_teachers (Junction) # update for entry (thats ok)\r\n      - teacher -- update for #id AND all other teachers of that course (\"too much\", just the one edited changes effectively)\r\n```\r\n\r\nAdditionally, all fields for the given item are passed along which is weird because they're not updated themselves. \r\nThe problem in my case is that this causes a lot of calls to my middleware and saving one teacher when changing one of his courses causes 60 or 70 requests taking 10 seconds and more to save the item. \r\n\r\nThis arises the following questions: \r\n\r\n1. Is the described behavior intended?\r\n2. Is there a way to know what initially caused the change ? If hooks are isolated from each other there is probably none.\r\n3. Is there a place where all changes that happened can be viewed together so one could know in advance which hooks would be triggered?\r\n \r\n\r\n## Technical Details\r\n\r\n- Device: Macbook Pro\r\n- OS: Mac OSX 10.14.6\r\n- Web Server: Apache \r\n- PHP Version: 7.1\r\n- Database: MysQL 5.7\r\n- Install Method: git clone master\r\n"},{"labels":["bug"],"text":"API pagination doesn't work with GET Parameter `&page=` :\r\nExample Request:\r\n1. `http://localhost:8080/_/items/content?access_token=xxx&fields=*&page=1&limit=10`\r\n2. `http://localhost:8080/_/items/content?access_token=xxx&fields=*&page=2&limit=10` `http://localhost:8080/_/items/content?access_token=xxx&fields=*&page=3&limit=10`\r\n`...` -> delivers the same results as the first one\r\n\r\n‚ÑπÔ∏è  as workaround I have used GET Parameter `offset` this request delivers correct paginated results.\r\n\r\n`http://localhost:8080/_/items/content?access_token=xxx&fields=*&offset=0&limit=10`\r\n`http://localhost:8080/_/items/content?access_token=xxx&fields=*&offset=10&limit=10`\r\n`...`\r\n\r\nAPI Version: 2.6.0\r\nAPP Version: 7.11.0\r\n\r\n\r\n"},{"labels":["bug"],"text":"# Bug Report\r\nThis happens with APP 7.10.0 and API 2.6.0.\r\n\r\nWhen using logical operator \"OR\" with `filter` query parameters in a API request, the response include results satisfying only the first predicate thus ignoring the `OR` and the second part.\r\n\r\n# Steps to Reproduce\r\n1. Add a custom collection\r\n2. Create a collection element with property `content_max_age` set to *2020-10-15*\r\n2. Create a collection element with property `content_max_age` left blank (thus saved in DB as *null*)\r\n3. Make an API request as following:\r\n`{{ENDPOINT}}/_/items/banner_item?filter[content_max_age][eq]=2020-10-15&filter[content_max_age][logical]=or&filter[content_max_age][null]`\r\nor \r\n`{{ENDPOINT}}/_/items/banner_item?filter[content_max_age][eq]=2020-10-15&filter[content_max_age][logical]=or&filter[content_max_age][empty]`\r\n4. Check API response body\r\n\r\n## Expected Behaviour\r\nThe API response body should include:\r\n1. element created at step 1 (`content_max_age` set to *2020-10-15*)\r\n2. element created at step 2 (`content_max_age` left blank - *null* in database)\r\n\r\n## Actual Behaviour\r\nThe API response body includes only:\r\n1. element created at step 1 (`content_max_age` set to *2020-10-15*)\r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/56389118/68465308-83ac5e80-0212-11ea-8f13-2723e30c72de.png)\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/56389118/68464899-bace4000-0211-11ea-9f98-a4e9ad2f3a01.png)\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nActually i am not sure if this should be a feature request or a bug issue\r\n\r\n- create any collection containing a relation like **many to one**, here with domains\r\n- query your data - it works:\r\n\r\n```\r\nquery {\r\n    teaser {\r\n        data {\r\n            domain {\r\n                domain\r\n            }        \r\n        }\r\n    }\r\n}\r\n```\r\n\r\n- now add a filter to the query like:\r\n\r\n```\r\nquery {\r\n    teaser(filter: {\r\n        domain: {\r\n            domain_eq: \"mydomain\"\r\n        }\r\n    }) {\r\n        data {\r\n            domain {\r\n                domain\r\n            }        \r\n        }\r\n    }\r\n}\r\n```\r\n\r\n## Expected Behavior\r\n\r\nresponse should contain only filtered items\r\n\r\n## Actual Behavior\r\n\r\nunexpected response like:\r\n\r\n```\r\n{\r\n    \"errors\": [\r\n        {\r\n            \"message\": \"Field \\\"domain\\\" is not defined by type TeaserFilter.\",\r\n            \"extensions\": {\r\n                \"category\": \"graphql\"\r\n            },\r\n            \"locations\": [\r\n                {\r\n                    \"line\": 3,\r\n                    \"column\": 9\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\nIn a simple collection filtering works as expected. Here we just have to input fields for **country** and **term** and no relations:\r\n\r\n```\r\nquery {\r\n    terms(filter: {\r\n  \t\tcountry_eq: \"de\"\r\n    }) {\r\n    data {\r\n      country\r\n      term\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n## Technical Details\r\n\r\n- Device: desktop\r\n- OS: Mac OS 10.13.6\r\n- Web Server: Apache, Mamp\r\n- PHP Version: 7.3.8\r\n- Database: 5.7.26\r\n- Install Method: cloned master branch\r\n"},{"labels":["bug"],"text":"in `develop`\r\n\r\nIt's trying to use this function:\r\n\r\nhttps://github.com/directus/api/blob/483e065d00ed307f3f25d06ff1aa924633fe9fae/src/core/Directus/Util/DateTimeUtils.php#L110-L114\r\n\r\n`get_project_config()` requires the first parameter to be the key of a project.\r\n\r\nFull error:\r\n\r\n```\r\n[2019-11-06 15:40:28] api[api].ERROR: ArgumentCountError: Too few arguments to function Directus\\get_project_config(), 0 passed in /var/www/html/src/core/Directus/Util/DateTimeUtils.php on line 112 and at least 1 expected in /var/www/html/src/helpers/app.php:70\r\n```\r\n\r\n<details>\r\n  <summary>Stack trace</summary>\r\n  <pre>\r\n    Stack trace:\r\n#0 /var/www/html/src/core/Directus/Util/DateTimeUtils.php(112): Directus\\get_project_config\r\n#1 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(324): Directus\\Util\\DateTimeUtils::nowInTimezone\r\n#2 /var/www/html/src/core/Directus/Services/TablesService.php(876): Directus\\Database\\TableGateway\\RelationalTableGateway->manageRecordUpdate\r\n#3 /var/www/html/src/core/Directus/Services/TablesService.php(820): Directus\\Services\\TablesService->updateFieldInfo\r\n#4 /var/www/html/src/core/Directus/Services/TablesService.php(796): Directus\\Services\\TablesService->addOrUpdateFieldInfo\r\n#5 /var/www/html/src/core/Directus/Services/TablesService.php(384): Directus\\Services\\TablesService->addColumnsInfo\r\n#6 /var/www/html/src/endpoints/Collections.php(43): Directus\\Services\\TablesService->createTable\r\n#7 [internal function]: Directus\\Api\\Routes\\Collections->create\r\n#8 /var/www/html/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#9 /var/www/html/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#10 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#11 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#12 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#13 [internal function]: Slim\\DeferredCallable->__invoke\r\n#14 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#15 /var/www/html/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(121): Slim\\Route->Slim\\{closure}\r\n#16 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#17 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#18 [internal function]: Slim\\DeferredCallable->__invoke\r\n#19 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#20 /var/www/html/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#21 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#22 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#23 [internal function]: Slim\\DeferredCallable->__invoke\r\n#24 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#25 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#26 /var/www/html/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack\r\n#27 /var/www/html/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run\r\n#28 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#29 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#30 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#31 [internal function]: Slim\\DeferredCallable->__invoke\r\n#32 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#33 /var/www/html/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#34 /var/www/html/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#35 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#36 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#37 [internal function]: Slim\\DeferredCallable->__invoke\r\n#38 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#39 /var/www/html/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#40 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#41 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#42 [internal function]: Slim\\DeferredCallable->__invoke\r\n#43 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#44 /var/www/html/src/core/Directus/Application/Http/Middleware/DatabaseMigrationMiddleware.php(15): Slim\\App->Slim\\{closure}\r\n#45 [internal function]: Directus\\Application\\Http\\Middleware\\DatabaseMigrationMiddleware->__invoke\r\n#46 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#47 [internal function]: Slim\\DeferredCallable->__invoke\r\n#48 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#49 /var/www/html/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(71): Slim\\App->Slim\\{closure}\r\n#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#51 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#52 [internal function]: Slim\\DeferredCallable->__invoke\r\n#53 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#54 /var/www/html/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(62): Slim\\App->Slim\\{closure}\r\n#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#56 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array\r\n#57 [internal function]: Slim\\DeferredCallable->__invoke\r\n#58 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#59 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#60 /var/www/html/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack\r\n#61 /var/www/html/vendor/slim/slim/Slim/App.php(297): Slim\\App->process\r\n#62 /var/www/html/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#63 /var/www/html/public/index.php(5): Directus\\Application\\Application->run [] []\r\n    ```\r\n  </pre>\r\n</details>"},{"labels":["bug"],"text":"The API currently returns a 500 server error with\r\n\r\n```\r\ncode: 22\r\nmessage: \"Unknown project: _\"\r\n```\r\n\r\nSeeing that the /server/ping endpoint will only verify that the server is reachable, I think it should ignore the `X-Directus-Project` header completely.\r\n\r\n\r\n(PS: This should probably be a 404 instead of a 503 error too)"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n- create a collection (call it \"bar\") with a text input and a numeric input (call it \"foo_id\") for the DB-relation\r\n- create a collection (call it \"foo\") with a oneToMany (call it \"content\") relation to \"bar\", using \"foo_id\" to map the ids\r\n- create an item in foo\r\n- create a query like that (using postman or graphql playground):\r\n\r\n```\r\nquery foo {\r\n    foo {\r\n        data {\r\n            content {\r\n                text\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n- send to http://localhost:[....]/_/gql?access_token=[....] (running MAMP)\r\n\r\n## Expected Behavior\r\n\r\n```\r\na result like this:\r\n\r\n{\r\n    \"data\": {\r\n        \"foo\": {\r\n            \"data\": [\r\n                {\r\n                    \"content\": [\r\n                        {\r\n                            text: 'something'\r\n                        },\r\n                        {\r\n                            text: 'something else'\r\n                        }                        \r\n                    ]\r\n                }\r\n            ]\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n## Actual Behavior\r\n\r\noneToMany result is empty:\r\n\r\n```\r\n{\r\n    \"data\": {\r\n        \"foo\": {\r\n            \"data\": [\r\n                {\r\n                    \"content\": []\r\n                }\r\n            ]\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: desktop\r\n- OS: Mac OS 10.13.6\r\n- Web Server: Apache, Mamp\r\n- PHP Version: 7.3.8\r\n- Database: 5.7.26\r\n- Install Method: cloned master branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nThe environment variables `DIRECTUS_STORAGE_THUMB_ROOT`, `DIRECTUS_STORAGE_ROOT_URL`, ... don't work.\r\n\r\nAs far as I can tell, the problem seems to be a combination of the `explode` function\r\nin the `from_map` method of the `Context` class (`/Users/niklasmack/projects/directus/api/src/core/Directus/Config/Context.php:74`) \r\nand configuration in the `Schema` class (`/Users/niklasmack/projects/directus/api/src/core/Directus/Config/Schema/Schema.php`).\r\n\r\nThe env keys are split (exploded) at `_`, but there are config keys with an underscore (eg. `root_url`). "},{"labels":["bug",null],"text":"Hi all,\r\n\r\nI've a repeater in my collection \"informacoes_gerais\":\r\n\r\n![img1](https://user-images.githubusercontent.com/14015712/68311304-42e50600-00a9-11ea-8d83-3531bd4bd06e.png)\r\n\r\na) With a input file (icon) and a text field (link):\r\n![img2](https://user-images.githubusercontent.com/14015712/68311348-555f3f80-00a9-11ea-887b-33e5560ab764.png)\r\n\r\nb) The app is working well like in this example:\r\n![img3](https://user-images.githubusercontent.com/14015712/68311486-86d80b00-00a9-11ea-98f8-ba41992d3ce0.png)\r\n\r\nc) The problem is when i need to grab the collection via API, the \"redes_sociais\" repeater dont show the image object of the input file, just an id. There is an example of Directus API response:\r\n![img4](https://user-images.githubusercontent.com/14015712/68312151-85f3a900-00aa-11ea-8bf1-e1cf4292279b.png)\r\n\r\nIf tryed to call:\r\n`items/informacoes_gerais?fields=*.*`\r\n\r\nWith no success.\r\nCan anyone give me a hint?\r\n\r\nThank you"},{"labels":["bug"],"text":"# Bug Report\r\nWhen querying a collection the order of the query parameters are important. The order should not be relevant, because proto://url?a=1&b=2 should have equal results than proto://url?b=2&a=1\r\n\r\nQuerying `/<project>/items/<collection>/<id>?meta=*&lang=*&fields=*.*` is different than `/<project>/items/<collection>/<id>?fields=*.*&meta=*&lang=*`.\r\n\r\n## Steps to Reproduce\r\n\r\nCurl the API with translations with this calls:\r\n```\r\ncurl \\\r\n\t-H \"Authorization: Bearer <token>\" \\\r\n\t-H \"X-Directus-Project: _\" \\\r\n\thttp://localhost:8080/<project>/items/<collection>/<id>?meta=*&lang=*&fields=*.*\r\n```\r\n```\r\ncurl \\\r\n\t-H \"Authorization: Bearer <token>\" \\\r\n\t-H \"X-Directus-Project: _\" \\\r\n\thttp://localhost:8080/<project>/items/<collection>/<id>?fields=*.*&meta=*&lang=*\r\n```\r\n\r\n## Expected Behavior\r\nBoth calls sould have the same results.\r\n\r\n## Actual Behavior\r\nOne call has the translations, the other don't.\r\n\r\n## Technical Details\r\n\r\n- Device: API-Call\r\n- OS: MacOS 10.15.1\r\n- Web Server: nginx:alpine\r\n- PHP Version: php:7.2-fpm\r\n- Database: mariadb:10.4\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create collection with a text input, add some items\r\n2. Create an other collection with an many to one relation to the first collection\r\n2. Delete this collections\r\n3. Create first collection (same name) again and try to add item \r\n\r\n## Expected Behavior\r\nno issues expected, items should be added\r\n\r\n## Actual Behavior\r\na database error occurs\r\n\r\n## Other Context & Screenshots\r\nSeems that the relations are still stored in the table **directus_relations**, even after collections were deleted. Deleting this relations from the table solves the problem\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: desktop, chrome latest\r\n- OS: OSX 10.13.6\r\n- Web Server: Apache, MAMP 5\r\n- PHP Version: 7.3.8\r\n- Database: MySql 5.7.2.6\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Export Database as SQL file via phpmyadmin or some other tool like the CLI.\r\n2. Import the SQL file on a target host.\r\n\r\n\r\n## Expected Behavior\r\nNormal import of SQL file\r\n\r\n## Actual Behavior\r\nMySQL Error:\r\n`#1071 - Specified key was too long; max key length is 768 bytes`\r\n\r\nThe Script will not execute correctly for some reason after this. Probably a Pyramid of breakdowns even tough just one error is popping up.\r\n\r\n## Other Context & Screenshots\r\n\r\nThis error shows up at many places.\r\n- A Slug with a size of 200+ fails to be imported as/when it is handled as a foreign key.\r\n- Tables with multiple Keys where text is a key(VARCHAR), this will most probably be a error that pops up. \r\nExample:\r\n![Screenshot_20191030_042650](https://user-images.githubusercontent.com/6115966/67826642-8057fb00-facd-11e9-8de4-9c9c5e6c3a0a.png)\r\n![Screenshot_20191030_043822](https://user-images.githubusercontent.com/6115966/67827121-1fc9bd80-facf-11e9-8371-7ba231266fbf.png)\r\n\r\n**Quickfix 1:**\r\nThis can be fixed/ignored if you OWN the MySQL Host like this:\r\n- Open MySQL CLI\r\n- Enter these commands:\r\n```\r\nset global innodb_large_prefix=ON;\r\nSet global innodb_default_row_format=dynamic\r\n```\r\n**Quickfix 2:**\r\nIf you do not own the Host you can try to remove the collates from specific Queries; also DO NOT MIX COLLATES IN KEYS:\r\n![Screenshot_20191030_043127](https://user-images.githubusercontent.com/6115966/67826819-2572d380-face-11e9-9c00-1188ec31710e.png)\r\n\r\n## Important hints\r\n\r\n- This is probably not exactly fixable by Directus; this is most probably a problem of the export schematic of phpMyAdmin/other CLI tools.\r\n- This is probably solvable if a script would be added to export tables in Directus instead of phpMyAdmin. Which makes sure that the same collate is being used and slugs are not too long in bytesize. (Collate utf8 and utf4mb have different sizes as it seems and when crossed will make the key longer than it should be)\r\n  - If you make an export function maybe even use directus REST API calls for it? Maybe that idea is useful for setting up a lot of servers later on.\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: *]\r\n- OS: [eg: *]\r\n- Web Server: [eg: Apache 2.4.37]\r\n- PHP Version: [eg: 7.3.0]\r\n- Database: [eg: ~5.7] (not 8 as it seems to ignore this kind of error; source: Slack user)\r\n  - I am using a normal install of an MySQL Database\r\n- Install Method: [eg: *]\r\n"},{"labels":["bug"],"text":"When resetting your password, the API will return a 200 even when sending the email fails. Seeing that this whole flow relies on the email being sent, this can't happen. \r\n\r\nMy API is logging\r\n\r\n```\r\n[2019-10-29 15:47:03] api[_].ERROR: Swift_TransportException: Expected response code 220 but got code \"\", with message \"\" in /var/www/html/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/AbstractSmtpTransport.php:383\r\n```\r\n\r\nYet the API returns status `200` with `{\"public\":true}`"},{"labels":["bug"],"text":"When I login with a user that has no 2FA setup in a role that has 2FA enforced, the API doesn't return the 2FA required flag, making it impossible for the app to boot someone to the setup-2fa page.\r\n\r\n* Authentication goes through like normal \r\n* `/_/` doesn't return the 2fa required flag:\r\n\r\n```\r\n{\"data\":{\"api\":{\"project_color\":\"pink-500\",\"project_name\":\"Rijk's Local\",\"project_image\":null,\"project_icon\":null,\"project_logo\":\"\"}},\"public\":true}\r\n```"},{"labels":["bug"],"text":"Global endpoints `/interfaces`, `/server/ping`, etc are having some more problems regarding CORS still. Most notably: \r\n\r\n* Should return `Access-Control-Allow-Credentials: true` header in (preflight) requests\r\n* Should allow `X-Directus-Project` header in (preflight) requests"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to admin and trying to upload any file\r\n2. Getting the checksum: This value should not be blank\r\n\r\n## Expected Behavior\r\nfile uploaded\r\n## Actual Behavior\r\nno file uploaded \r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS\r\n- Web Server: Apache (bluehost hosting)\r\n- PHP Version: 7.3.10\r\n- Database: [eg: MySQL 8.0.12]\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"Error when adding a User via Role - Duplicate key for collection \"directus_user_roles\"\r\n\r\n## Steps to Reproduce\r\n\r\n- Add a new role\r\n- Add a new user via the newly created role\r\n- Watch the [screenrecording for more](https://drive.google.com/file/d/1ic6_p8rKrJDqbIg6RH_MSfhGwSosKM76/view?usp=sharing)\r\n\r\n## Technical Details\r\n\r\n- Using Directus Demo"},{"labels":["bug",null,null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nHello all,\r\nI am using the directus api to access some collection, this collection has a relations \"Many to one\"  with other collections. I am able to filter collection members thrue the all relationships with the some exceptions.\r\nError:{\"error\":{\"code\":215,\"message\":\"Unable to access \\\"code\\\" related data\"}}\r\nI already spent a lot of time looking the diferences between the relationships that works  and the relationships  that dont works, and the only difference that i find is that first does not have status and the other have.\r\n\r\nQuery that works:\r\nhttp://localhost:7000/_/items/labels?fields=*.*&filter[status][eq]=published&filter[languages.code][eq]=en&filter[channels.code][eq]=mvb\r\nQuery that does not works:\r\nhttp://localhost:7000/_/items/labels?fields=*.*&filter[status][eq]=published&filter[languages.code][eq]=en&filter[channels.code][eq]=mvb&filter[pages.code][eq]=unbilled\r\n\r\nAll the collections have permission in public role to \"all\"\r\nDirectus version: 7.0.18\r\n\r\nDid anyone have this problem?"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nHi, I am making [custom hooks](https://docs.directus.io/extensions/hooks.html). I want to modify the data on creation and update, and thus I would like to use the filters.\r\n\r\nMy starting point is just [the example code from the Directus documentation](https://docs.directus.io/extensions/hooks.html#creating-hooks), namely the following, notice the minor edit of the filter key to be generic, rather than being related to the particular `articles` collection.\r\n\r\n```php\r\n<?php\r\n\r\nreturn [\r\n  'filters' => [\r\n    'item.create' => function (\\Directus\\Hook\\Payload $payload) {\r\n      $payload->set('uuid', \\Directus\\generate_uuid4());\r\n\r\n      return $payload;\r\n    }\r\n  ]\r\n];\r\n```\r\n\r\nHowever the filters do not run.\r\n\r\nIf I have the same things as an action (and with `array` as input rather than a `Payload`), it runs just fine. I've tried `directus/public/extensions/custom/hooks/hooks.php`, `directus/public/extensions/custom/hooks/OurOwnProject/hooks.php` as well as the shipped example project called *products*.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create file `directus/public/extensions/custom/hooks/hooks.php` and copypaste example code from documentation-\r\n2. Create an item in any collection.\r\n3. Observe the value of `uuid` field of the created object.\r\n\r\n## Expected Behavior\r\n\r\nItem is created, and `uuid` field is set.\r\n\r\n## Actual Behavior\r\n\r\nItem gets created, `uuid` field is not set.\r\n\r\n## Other Context & Screenshots\r\n\r\nStepping away from the example code from the documentation and writing my own code using logging, if I have\r\n`directus/public/extensions/custom/hooks/OurOwnProject/hooks.php`\r\n\r\n```php\r\nuse \\Directus\\Application\\Application;\r\nuse \\Directus\\Hook\\Payload;\r\n\r\nreturn [\r\n    // FIXME: Filters are not triggering, sadly.\r\n    'filters' => [\r\n        'item.create.collection' => function (Payload $payload) {\r\n            $container = Application::getInstance()->getContainer();\r\n            $logger = $container->get('logger');\r\n            \r\n            $logger->debug('Payload in filter', $payload);\r\n\r\n            $payload->set('image_recognition_tag_id', 'kitties');\r\n\r\n            $logger->debug('Payload in filter after setting the tag UUID.', $payload);\r\n\r\n            return $payload;\r\n        }\r\n    ]\r\n];\r\n```\r\nNothing gets logged in `directus/logs/debug*.log`.\r\n\r\nFurther if I try to run something outrageous in the `item.create` filter, such as `this_function_does_not_exists();`, no errors are thrown.\r\n\r\nLike above, if I define this as an action rather than as a filter (and with `array` input rather than a `Payload`), it runs just fine and I'm seeing the expected log output etc.\r\n\r\nI conclude with confidence that the filter hooks are not running.\r\n\r\nThank you :)\r\n\r\n## Technical Details\r\n\r\n- Device: Computer machine\r\n- OS: Ubuntu 18.04 LTS\r\n- Web Server: Apache 2.4.29.\r\n- PHP Version: 7.2.19\r\n- Database: MySQL 5.7.27\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n- Fresh install of latest develop https://github.com/directus/api/commit/82e06ab90fa38869da141f578922b66b0f645669\r\n- Login\r\n- Logout\r\n\r\n## Expected Behavior\r\n\r\nThere should be no error\r\n\r\n## Actual Behavior\r\n\r\n`Couldn't Reach API`\r\n\r\n## Other Context & Screenshots\r\n\r\n[This is what happens in action](https://drive.google.com/file/d/1wPE2LCpIS9e59kft5aXSjK1vpoMj-Ar-/view?usp=sharing)\r\n\r\n[Here's the root cause](https://drive.google.com/file/d/1Zzw9lQ-mu92EDWGFSZKGbZoJrbb97YTf/view?usp=sharing). This will be fixed if the session cookie is purged after logout\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.2.23\r\n- Database: 10.2.26\r\n"},{"labels":["bug"],"text":"# Bug Report\r\nPagination does not work properly.\r\n\r\n## Steps to Reproduce\r\nSend request `https://domain.com/public/_/items/blogpost?fields=id&meta=*&limit=5&page=2`\r\n\r\n## Expected Behavior\r\nItems with indexes 6-10 get returned.\r\n\r\n## Actual Behavior\r\nItems with indexes 1-5 get returned even with `page` set to 2. `page` does not affect the output.\r\n\r\n## Other Context & Screenshots\r\nOutput:\r\n```\r\n{\r\n    \"meta\": {\r\n        \"collection\": \"blogpost\",\r\n        \"type\": \"collection\",\r\n        \"result_count\": 5,\r\n        \"total_count\": 11,\r\n        \"status_count\": {\r\n            \"published\": 11,\r\n            \"draft\": 0,\r\n            \"deleted\": 0\r\n        },\r\n        \"filter_count\": 11,\r\n        \"limit\": 5,\r\n        \"offset\": 5,\r\n        \"page\": 2,\r\n        \"page_count\": 3,\r\n        \"links\": {\r\n            \"self\": \"https://domain.com/public/public/_/items/blogpost\",\r\n            \"current\": \"https://domain.com/public/public/_/items/blogpost?fields=id&limit=5&meta=*&page=2\",\r\n            \"next\": \"https://domain.com/public/public/_/items/blogpost?fields=id&limit=5&meta=*&page=3&offset=10\",\r\n            \"previous\": \"https://domain.com/public/public/_/items/blogpost?fields=id&limit=5&meta=*&page=1&offset=0\",\r\n            \"first\": \"https://domain.com/public/public/_/items/blogpost?fields=id&limit=5&meta=*&page=1&offset=0\",\r\n            \"last\": \"https://domain.com/public/public/_/items/blogpost?fields=id&limit=5&meta=*&page=3&offset=10\"\r\n        }\r\n    },\r\n    \"data\": [\r\n        {\r\n            \"id\": 1\r\n        },\r\n        {\r\n            \"id\": 2\r\n        },\r\n        {\r\n            \"id\": 3\r\n        },\r\n        {\r\n            \"id\": 4\r\n        },\r\n        {\r\n            \"id\": 5\r\n        }\r\n    ],\r\n    \"public\": true\r\n}\r\n```\r\nThe meta-links are broken too due to the duplicated `/public` path in them.\r\n\r\n## Technical Details\r\n- Directus: 7.11.0\r\n- PHP Version: 7.3.10"},{"labels":["bug",null,null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nThis is all happening on my local machine\r\n\r\nThe bug i'm currently facing is i can't logout using the SDK. I get a 404 not found error when trying to hit the `http://something.com/_/auth/logout` endpoint. \r\n\r\nfile `/src/core/Directus/Services/AuthService.php` looks like its missing a logout method?\r\n` public function __invoke(Application $app)\r\n    {\r\n        $app->post('/authenticate', [$this, 'authenticate']);\r\n        $app->post('/password/request', [$this, 'forgotPassword']);\r\n        $app->get('/password/reset/{token}', [$this, 'resetPassword']);\r\n        $app->post('/refresh', [$this, 'refresh']);\r\n        $app->get('/sso', [$this, 'listSsoAuthServices']);\r\n        $app->post('/sso/access_token', [$this, 'ssoAccessToken']);\r\n        $app->get('/sso/{service}', [$this, 'ssoService']);\r\n        $app->post('/sso/{service}', [$this, 'ssoAuthenticate']);\r\n        $app->get('/sso/{service}/callback', [$this, 'ssoServiceCallback']);\r\n    }`\r\n\r\nno logout endpoint has been added.\r\n\r\nif thats not the case then how do you logout using the SDK as logout & reset methods both return a 404 not found error.\r\n\r\n## Steps to Reproduce\r\n\r\n## Expected Behavior\r\n\r\nlogged out successfully with a 200 response from the endpoint \r\n\r\n## Actual Behavior\r\n404 error from server\r\n\r\n## Other Context & Screenshots\r\n\r\n![Screenshot 2019-10-19 at 15 23 37](https://user-images.githubusercontent.com/19251469/67146581-873c6d80-f284-11e9-8605-4c946cdf1250.png)\r\n\r\n## Technical Details\r\n\r\n- Device: [MacbookPro 2015]\r\n- Web Server: [Apache 2.4.33]\r\n- PHP Version: [7.2.0]\r\n- Database: [MySQL 8.0.12]\r\n- Install Method: cloned `master` branch directus suite\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. create two project configs\r\n2. configure both with one oauth provider (can be the same but different callback urls - matching the project urls)\r\n3. login with the \"non default /_/\" project\r\n4. the ui calls the correct sso url e.g. `/<project>/auth/sso/google` but gets a redirect to the oauth provider with the wrong project callback `/_/auth/sso/google/callback` as redirect url\r\n\r\n## Expected Behavior\r\n\r\nlogin to the project selected before initiating the oauth flow\r\n\r\n## Actual Behavior\r\n\r\nalways logged in the default project independently what project is selected in the ui\r\n\r\n## Technical Details\r\n\r\n- Install Method: docker container for app and api in version 2.6.0\r\n"},{"labels":["bug",null,null],"text":"When using S3 storage adapter, I've noticed thumbnail URL's are at API, acting as a proxy to S3, like `/thumbnail/_/200/200/crop/good/xx.png` but full size image URL's are actual S3 URL's. \r\n\r\nIs this a misconfiguration on our side or is it intentionally like this (for performance etc)?\r\n\r\nThanks"},{"labels":["bug"],"text":"**Environment:** Docker/Kubernetes\r\n**Version:** v2-apache\r\n**Component:** API\r\n\r\nAfter uploading a file through the **BACKEND** the thumbnail appears as broke, the web browser console inspection gets an Error HTTP 404, Not Found.\r\nEg.\r\n`https://api.mydomain.dev/thumbnail/_/200/200/crop/good/9a7e82ce-ae0b-594c-a95c-f296ac8b7c0f.png\r\n`\r\n\r\nThe Original file displayed appears with the link URL:\r\n`https://api.mydomain.dev/uploads/_/originals/9a7e82ce-ae0b-594c-a95c-f296ac8b7c0f.png`"},{"labels":["bug"],"text":"**Environment:** Docker/Kubernetes\r\n**Version:** v2-apache\r\n**Component:** API\r\n\r\nAfter uploading a file through the **BACKEND** the thumbnail appears as broke.\r\nA directory inspection display files with 0 bytes.\r\n\r\n```\r\nadmin@api-cms-webmago:/var/www/public/uploads/_/thumbnails/200/200/crop/good# ls -la\r\ntotal 8\r\ndrwxr-xr-x 2 www-data www-data 4096 Oct  3 16:06 .\r\ndrwxr-xr-x 3 www-data www-data 4096 Oct  3 16:06 ..\r\n-rw-r--r-- 1 www-data www-data    0 Oct  3 16:06 9a7e82ce-ae0b-594c-a95c-f296ac8b7c0f-1.png\r\n-rw-r--r-- 1 www-data www-data    0 Oct  3 16:06 9a7e82ce-ae0b-594c-a95c-f296ac8b7c0f.png\r\n```"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1.  Run the API providing these additional 2 environment variables:\r\nKUBERNETES_PORT_443_TCP=\"doesnt matter\"\r\nKUBERNETES_PORT=\"doesnt matter\"\r\n2. Run the API\r\n3. Make a request to API\r\n4. See error\r\n\r\n## Expected Behavior\r\n\r\nAPI Call return : `{\"error\":{\"code\":3,\"message\":\"Unauthorized request\"}}`\r\nCommand run without errors\r\n\r\n## Actual Behavior\r\nAPI call returns error:\r\n```\r\n<b>Fatal error</b>:  Uncaught Error: Only variables can be passed by reference in /var/www/src/core/Directus/Config/Context.php:39\r\nStack trace:\r\n#0 /var/www/src/core/Directus/Config/Context.php(39): Directus\\Config\\Context::expand('tcp://raft-test...', Array, 'tcp://raft-test...')\r\n#1 /var/www/src/core/Directus/Config/Context.php(39): Directus\\Config\\Context::expand(Array, Array, 'tcp://raft-test...')\r\n#2 /var/www/src/core/Directus/Config/Context.php(71): Directus\\Config\\Context::expand(Array, Array, 'tcp://raft-test...')\r\n#3 /var/www/src/core/Directus/Config/Context.php(85): Directus\\Config\\Context::from_map(Array)\r\n#4 /var/www/src/web.php(30): Directus\\Config\\Context::from_env()\r\n#5 /var/www/public/index.php(3): require('/var/www/src/we...')\r\n#6 {main}\r\n  thrown in <b>/var/www/src/core/Directus/Config/Context.php</b> on line <b>39</b><br />\r\n\r\n```\r\n## Other Context & Screenshots\r\nLooks like this happens due to nested nature of exploded environment variables. \r\nAdding below lines to `Context::expand` method just before return statement fixes the issue.\r\n```\r\n\tif (!is_array($target[$segment])) {\r\n\t\t$target[$segment] = [];\r\n\t}\r\n\r\n```\r\n\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n- Install Method: running Docker image directus/api:v2.6.0-apache\r\n"},{"labels":["bug"],"text":"As per [the docs](https://docs.directus.io/api/reference.html#error-codes), there's a difference in errors for when you're not logged in (`0003 - Unauthorized (401)`) and when you're not allowed to read items (`0300 - Reading Items Denied (403)`).\r\n\r\nRight now, the API returns the 300 when you're not authenticated. \r\n\r\nOpening https://demo-api.directus.app/_/items/movies in the browser (with no access token or cookie) will return a `300` error. This should be error `3`"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nI could only reproduce this in our installations because of set error reporting is set differently on directus.app (probably 'app.env' production mode)\r\n\r\nWhen saving a collection with a  divider called e.g. separator4, the API returns warnings like:\r\n\r\n```\r\n<b>Notice</b>:  Undefined index: separator4 in <b>/var/www/html/src/core/Directus/Services/ItemsService.php</b> on line <b>176</b><br />\r\n```\r\n\r\nI am considering turning off the notices by patching web.php, to show all messages apart from NOTICE, but I found that sometimes NOTICE messages are useful and it also seems to be the recommended setting to include notice when looking at the php.ini production defaults : `Production Value: E_ALL & ~E_DEPRECATED & ~E_STRICT` \r\n\r\n\r\n## Steps to Reproduce\r\n1. Create a new collection and add a separator (or use https://github.com/markus-mnm/directus-demo-article-schema):\r\n2. Create a new item in the collection an save and reopen the new item \r\n3. Open the developer tools of your browser and go to the network tab\r\n4. Update the item and save\r\n5. In case error report is not turned off, you will see an api error message in the app\r\n5. Go to the network tab and find the PATCH or POST See error\r\n```\r\n<b>Notice</b>:  Undefined index: separator4 in <b>/var/www/html/src/core/Directus/Services/ItemsService.php</b> on line <b>176</b><br />\r\n```\r\n\r\n(the actual save was successful)\r\n\r\n## Expected Behavior\r\n\r\nThere is no api error and no notice message when saving items on collections with dividers\r\n\r\n## Actual Behavior\r\n\r\nThere is an api error when saving items on collections with dividers\r\n\r\n## Other Context & Screenshots\r\n\r\nOn on latest API  develop branch \r\n\r\nA pull request is following in a bit."},{"labels":[null,"bug",null],"text":"Hello everyone,\r\n\r\nI started using Directus (latest version from Github )suite on Wamp server (windows 10), and now I'm trying to check on Hooks functions in order to check later reset password option and to activate notifications.\r\n\r\nI followed the instructions on the documentation and did exactly as it says.\r\nThis Hook.php is created on the following path C:\\wamp64\\www\\directus\\public\\extensions\\custom\\hooks\\email\r\n\r\n![image](https://user-images.githubusercontent.com/10001883/65892234-513e5480-e37c-11e9-89a7-91acc4229a28.png)\r\n\r\n`<?php\r\nreturn [\r\n    'hooks' => [\r\n        'actions' => [\r\n        'collection.insert.users' => function ($collection, $data) {\r\n            mail(\"jimmy165q@gmail.com\", \"New user created\", \"ADDED user\", \" Added User\");\r\n            notify(\"jimmy165q@gmail.com\", \"New user created\", \"ADDED user\" );\r\n        },\r\n\t\t],\r\n        'filters' => [],\r\n    ]\r\n];\r\n`\r\nI used mail which is the library from Php to send emails, and works fine but looks like in this case it doesn't get to the hook because it doesn't do anything. Also tried with Notify but didn't do either, also trying each on them individually.\r\n\r\nSecond option i tried is to do everything on \"API.PHP\"\r\nwhere i set up also the mail configuration which is the following.\r\n\r\n![image](https://user-images.githubusercontent.com/10001883/65892336-78952180-e37c-11e9-895b-1fe8ff6fadfe.png)\r\n\r\n\r\n`    'mail' => [\r\n        'default' => [\r\n            'transport' => 'sendmail',\r\n             'sendmail' => '',\r\n             'host' => 'smtp.gmail.com',\r\n             'port' => '587',\r\n             'username' => 'directustest22@gmail.com',\r\n             'password' => 'xxxxxx',\r\n             'encryption' => 'ssl',\r\n            'from' => 'directustest22@gmail.com'\r\n        ],\r\n    ],\r\n`\r\nand also tried adding my hook on this file and it didn't work either.\r\n\r\nHere it upload a copy of the error logs as well.\r\n[error.2019-09-30.log](https://github.com/directus/app/files/3671925/error.2019-09-30.log)\r\n\r\nMaybe I'm missing some  instructions. Looking forward to hearing from you.\r\n\r\nRegards,\r\n\r\n\r\n<!--\r\n\r\nHey there!\r\n\r\n\r\nThanks for taking the time to notify the community of an issue with the Directus app.\r\n\r\nPlease be as detailed as you possibly be can about the problem at hand. Being able to reproduce the issue quickly (or at all) ensures that the issue can be fixed as quickly as possible.\r\n\r\nSome useful details to include: your version of Directus, stack/server info, screenshots, logs, or even database dumps.\r\n\r\nAlso, for security issues, please email support@directus.io directly.\r\n\r\n\r\nKeep being awesome!\r\n\r\n‚ú®üê∞‚ú®\r\n\r\n-->\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Docker Config from: https://github.com/directus/docker/tree/master/examples/simple\r\n2. Modify Proxy to Caddyserver and remove mysql exposed port. changed composed version to 1 because i'll use rancher 1x\r\n3. Mount /var/www -> git clone https://github.com/directus/directus.git . | composer install | set Database config\r\n4. Call API Endpont direkt or run the  php bin/directus install:install -e ... command\r\n5. See error\r\n\r\n## Expected Behavior\r\n\r\nAPI Call return : {\"error\":{\"code\":3,\"message\":\"Unauthorized request\"}}\r\nCommand run without errors\r\n\r\n## Actual Behavior\r\n\r\ndirekt API Call and php bin/directus install:install commands retruns\r\n\r\n```\r\nFatal error: Uncaught Error: Only variables can be passed by reference in /var/www/src/core/Directus/Config/Context.php:39 Stack trace: #0 /var/www/src/core/Directus/Config/Context.php(39): Directus\\Config\\Context::expand('tcp://mysql:330...', Array, 'tcp://mysql:330...') #1 /var/www/src/core/Directus/Config/Context.php(39): Directus\\Config\\Context::expand(Array, Array, 'tcp://mysql:330...') #2 /var/www/src/core/Directus/Config/Context.php(39): Directus\\Config\\Context::expand(Array, Array, 'tcp://mysql:330...') #3 /var/www/src/core/Directus/Config/Context.php(39): Directus\\Config\\Context::expand(Array, Array, 'tcp://mysql:330...') #4 /var/www/src/core/Directus/Config/Context.php(71): Directus\\Config\\Context::expand(Array, Array, 'tcp://mysql:330...') #5 /var/www/src/core/Directus/Config/Context.php(85): Directus\\Config\\Context::from_map(Array) #6 /var/www/src/web.php(30): Directus\\Config\\Context::from_env() #7 /var/www/public/index.php(3): require('/var/www/src/we...') #8 {main} thrown in /var/www/src/core/Directus/Config/Context.php on line 39\r\n```\r\nmysql config is correct\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Linux Debian\r\n- Web Server: Apache \r\n- PHP Version: 7.3.x\r\n- Database: MySQL 5.7\r\n- Install Method: cloned from master\r\n"},{"labels":["bug"],"text":"The datetime_created and datetime_updated interfaces are not behavior as expected.\r\n\r\nIt appears that when either interface is 'required' the user receives an error during record creation, saying the datetime_created (or datetime_updated) field can't be blank. If you turn off 'required' then the record saves, but the timestamps remain null.\r\n\r\nThis happens on both my local instance as well as the demo instance at https://directus.app.\r\n\r\nAlso I imagine that ideally, the user should not be able to decide whether these interfaces are required or not (since if the field exists the assumption is it should always be set)."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n1. Setup 2.5.0 API/7.10 app with the following authentication configuration to your project:\r\n        'secret_key' => 'SL4GRCccZfAIHpApiAD1MbLUWzQkROKX',\r\n        'public_key' => '78333833-86d7-4604-b3d7-da0806c95910'\r\n2. Create admin user admin@example.com with 'password' as a password.\r\n4. Login and ensure that everything ok.\r\n5. Upgrade your API to 2.6.0 and App to 7.11\r\nTry to login, you will see the server error screen\r\nIf you will roll back (just code) to 2.5/7.10 you will be able to login again.\r\n\r\n## Expected Behavior\r\nApplication should load normally\r\n\r\n## Actual Behavior\r\nApplication fails with authentication errors\r\n## Other Context & Screenshots\r\n\r\nHi, it seems like after upgrade to the latest API version some secret key/public key combinations stopped to work. I've 2 projects with 2 different set of keys - after upgrade one of them still working, another fails if I'm trying login to the App. If I'm rolling back to the previous version (I mean just code, no DB touch), things starting to work again. The problems seems in decode() method of Firebase\\JWT class - for some reason static::verify call returns false instead of true for API 2.6.0. Probably something wrong with hash_equals method...\r\n![image](https://user-images.githubusercontent.com/13006578/65646420-0cf03480-dfc9-11e9-9a43-d99ff0a4e13d.png)\r\n\r\nUPDATE 1:\r\nHere a parameters for the functions that are on the screenshot for 2.6.0:\r\nhash_hmac() function params\r\nalgorithm = SHA256\r\nmsg = eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MSwiZXhwIjoxNTY5NDU1MDE2LCJ0eXBlIjoiYXV0aCIsImtleSI6Ijc4MzMzODMzLTg2ZDctNDYwNC1iM2Q3LWRhMDgwNmM5NTkxMCIsInByb2plY3QiOiJjYXNpbm8ifQ\r\nkey = \"SL4GRCccZfAIHpApiAD1MbLUWzQkROKX\"\r\nhash_hmac() function result= \"ÔøΩÔøΩ\u0017ÔøΩd3ÔøΩCÔøΩHÔøΩÕöcBÔøΩÔøΩ√ñkÔøΩÔøΩÔøΩÔøΩÔøΩ8ÔøΩ\u0004\u0013QÔøΩ'\"\r\n\r\nhash_equals() function params\r\nhash = \"ÔøΩÔøΩ\u0017ÔøΩd3ÔøΩCÔøΩHÔøΩÕöcBÔøΩÔøΩ√ñkÔøΩÔøΩÔøΩÔøΩÔøΩ8ÔøΩ\u0004\u0013QÔøΩ'\"\r\nsignature = \"gkÔøΩ[.ÔøΩÔøΩ35YCÔøΩl]dTÔøΩ\u0018ÔøΩeÔøΩ\bbÔøΩjÔøΩ;^ÔøΩ\u0001ÔøΩ\"\r\n\r\nFor 2.5.0 parameters are following:\r\nhash_hmac() function params\r\nalgorithm = SHA256\r\nmsg = eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MSwiZXhwIjoxNTY5NDU1NDc3LCJ0eXBlIjoiYXV0aCIsImtleSI6Ijc4MzMzODMzLTg2ZDctNDYwNC1iM2Q3LWRhMDgwNmM5NTkxMCIsInByb2plY3QiOiJjYXNpbm8ifQ\r\nkey = \"SL4GRCccZfAIHpApiAD1MbLUWzQkROKX\"\r\nhash_hmac() function result = \"ÔøΩ»ÆvÔøΩrÔøΩ\u00191ÔøΩQ%ÔøΩÔøΩ~ÔøΩÔøΩ\u0005XXJÔøΩÔøΩÔøΩSÔøΩÔøΩ\f ÔøΩÔøΩR\"\r\n\r\nhash_equals() function params:\r\nsignature = \"ÔøΩ»ÆvÔøΩrÔøΩ\u00191ÔøΩQ%ÔøΩÔøΩ~ÔøΩÔøΩ\u0005XXJÔøΩÔøΩÔøΩSÔøΩÔøΩ\f ÔøΩÔøΩR\"\r\nhash = \"ÔøΩ»ÆvÔøΩrÔøΩ\u00191ÔøΩQ%ÔøΩÔøΩ~ÔøΩÔøΩ\u0005XXJÔøΩÔøΩÔøΩSÔøΩÔøΩ\f ÔøΩÔøΩR\"\r\n\r\nAs you can see values for hash and signature are different between different versions of API. I'm not sure that this is a reason of the problem, but may be it's worth to look into it...\r\n\r\n![image](https://user-images.githubusercontent.com/13006578/65646930-c4397b00-dfca-11e9-8122-f26d5e73b93c.png)\r\n\r\nUPDATE 2:\r\nIt seems like I've figured out what's the problem:\r\nThe only difference between old a new version of API in scope of authentication is within the following function:\r\n    v.2.6.0:\r\n    public function getSecretKey($project = '_')\r\n    {\r\n        if ($project) {\r\n            $config = get_project_config($project);\r\n            return $config->get('auth.secret_key');\r\n        }\r\n        return $this->secretKey;\r\n    }\r\n\r\n  v.2.5.0:\r\n    public function getSecretKey($project = NULL)\r\n    {\r\n        if ($project) {\r\n            $config = get_project_config($project);\r\n            return $config->get('auth.secret_key');\r\n        }\r\n        return $this->secretKey;\r\n    }\r\n\r\nThe problem is that getSecretKey was never called with parameter, though it should, and so in case if there are more than one projects, after this fix it will always use the secret key of the default one, instead of taking the appropriate one, and so signature/hash are incorrectly generated.\r\n\r\nSo you guys need to fix the call to that function and add a parameter there, I think there is only one place where it's used.  I think this is also a reason why the night build project doesn't work on your demo site now.\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS:  Windows 10.1803 with Ubuntu 16.04 LWS\r\n- Web Server: NGINX\r\n- PHP Version:  7.3.8\r\n- Database:  MySQL 5.7.27\r\n- Install Method: cloned `build` branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. git pull the API onto an Apache2 Server\r\n2. Follow manual/default installation Steps (making an api.php and boilerplating the DB)\r\n3. See error\r\n\r\n`Parse error: syntax error, unexpected 'ARRAY' (T_ARRAY) in /var/www/heimatvoll-api/api/src/core/Directus/Config/Schema/Schema.php on line 80`\r\n\r\nI tried it with a fresh boilerplate afterwards too but the error stays the same.\r\nI also first had manually edited the api.php, and got the error, i deleted it, and tried it via commands. Same result.\r\n\r\n## Expected Behavior\r\n\r\nSeeing something along these lines:\r\n`{\"error\":{\"code\":3,\"message\":\"Unauthorized request\"}}`\r\n\r\n## Actual Behavior\r\n\r\nSeeing this error when calling the API /\r\n`Parse error: syntax error, unexpected 'ARRAY' (T_ARRAY) in /var/www/heimatvoll-api/api/src/core/Directus/Config/Schema/Schema.php on line 80`\r\n\r\n## Other Context & Screenshots\r\n\r\n```\r\n        Machine ID: 0f271d0350d94e188a7571ecd598cf54\r\n           Boot ID: 81789752772840dba45e624f4da5a675\r\n    Virtualization: kvm\r\n  Operating System: Ubuntu 18.04.1 LTS\r\n            Kernel: Linux 4.15.0-43-generic\r\n      Architecture: x86-64\r\n```\r\n\r\n## Technical Details\r\n\r\n- OS: see above\r\n- Web Server: Apache 2.4\r\n- PHP Version: PHP 7.3.0-2+ubuntu18.04.1+deb.sury.org+1\r\n- Database: mysql  Ver 14.14 Distrib 5.7.24, for Linux (x86_64) using  EditLine wrapper\r\n- Install Method: git clone -b build https://github.com/directus/api.git\r\n"},{"labels":["bug"],"text":"[Screenrecording of what happened](https://drive.google.com/file/d/1EwKLBrO5_v64IQZkS-v1lXr92-4lnqA_/view?usp=sharing)\r\n\r\n## Steps to Reproduce\r\n\r\nArtist collection\r\n\r\n![image](https://user-images.githubusercontent.com/3615746/65572559-03e86e80-df9b-11e9-9064-f40b09f6531d.png)\r\n\r\nArtwork collection\r\n\r\n![image](https://user-images.githubusercontent.com/3615746/65572580-1662a800-df9b-11e9-84e4-a33c11e1947a.png)\r\n\r\n\r\nEvents collection\r\n\r\n![image](https://user-images.githubusercontent.com/3615746/65572603-267a8780-df9b-11e9-80ce-324838d1678a.png)\r\n\r\n## Technical Details\r\n\r\n- Using Directus Demo\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: develop branch commit 8a1187ff0b3559ab7281c4990d5329d47d8835dd\r\n- Directus App: App develop branch commit [2107f04d9984c6efa5577775bd12f869ed1270a4](https://github.com/directus/app/commit/2107f04d9984c6efa5577775bd12f869ed1270a4)"},{"labels":["bug"],"text":"[Screenrecording](https://drive.google.com/file/d/10hxKKvr1sg3A3RF3ErfAMQKK51FJfMal/view?usp=sharing)\r\n\r\n## Technical Details\r\n\r\n- Using Directus Demo\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: develop branch commit 8a1187ff0b3559ab7281c4990d5329d47d8835dd\r\n- Directus App: App develop branch commit [2107f04d9984c6efa5577775bd12f869ed1270a4](https://github.com/directus/app/commit/2107f04d9984c6efa5577775bd12f869ed1270a4)"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nI'm testing the database from Directus in **postman** with **graphql**.\r\n\r\n1. Create 2 Collections (, let's name them Test3 and Test4) with ID, name and SKU fields.\r\n2. Create a test_junction Collection, which is hidden, and two numeric fields (test3 & test4)\r\n3. Go to Test3 and create a M2M field with the test name 'tree'. Under the \"relation\" tab, declare Test4 as my related Collection and test_junction as my junction Collection. ID from Test3 goes into test3 and the ID from Test4 into test4.\r\n4. As visible columns add name and sku, allow create and allow select, save.\r\n5. Create in both Collections some test items/products (4), with unique names, SKUs for a obvious separation between the products.\r\n6. Go to the products from Test3 and add under the \"tree\" field some products from Test4.\r\n7. Go to Postman, get the token to be allowed to get data from the database/directus.\r\n8. Open a new tab and choose \"POST\" and type next it the https link from your directus +/_/gql\r\n9. Click the \"Authorization\" tab, choose Bearer Token as type and paste your token in.\r\n10. Click on the \"Body\" tab and insert the code and press send:\r\n\r\n````\r\nquery{\r\n  test3{\r\n      data{\r\n          name\r\n          sku\r\n          tree{\r\n              name\r\n              sku  \r\n          }\r\n      }\r\n  }\r\n}\r\n````\r\n<img width=\"1044\" alt=\"Screenshot 2019-09-24 at 10 50 03\" src=\"https://user-images.githubusercontent.com/51753093/65496991-c233c700-deb9-11e9-85f7-df3d671e09e7.png\">\r\n\r\n## Expected Behavior\r\n\r\nTo get the same result with a M2O relationship:\r\n````{\r\n    \"data\": {\r\n        \"test3\": {\r\n            \"data\": [\r\n                {\r\n                    \"name\": \"T-Shirt\",\r\n                    \"sku\": \"12\",\r\n                    \"tree\": {\r\n                           \"name\": \"T-Shirt T1\",\r\n                           \"sku\": \"1236\"\r\n                     }\r\n                }\r\n               ...\r\n            ]\r\n        }\r\n    }\r\n}\r\n````\r\n\r\n## Actual Behavior\r\n\r\nI get an empty Array even though on Directus I get displayed that the two products are linked trough the M2M relationship. I have the same problem with a O2M relation but not with a M2O, though it's the [\"same relationship\"](https://docs.directus.io/guides/relationships.html#many-to-one)\r\n\r\n````\r\n{\r\n    \"data\": {\r\n        \"test3\": {\r\n            \"data\": [\r\n                {\r\n                    \"name\": \"T-Shirt\",\r\n                    \"sku\": \"12\",\r\n                    \"tree\": []\r\n                }\r\n                ...\r\n            ]\r\n        }\r\n    }\r\n}\r\n````\r\n\r\n## Technical Details\r\n\r\n- Device: [MacBook Pro]\r\n- OS: [MacOS 10.14.6]\r\n- Web Server: [nginx/1.14.0 (Ubuntu)]\r\n- Database: [MySQL 5.7]\r\n- Install Method: [cloned `origin/master` branch]\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\nThis happens in latest develop branch and also in direcus demo\r\n\r\nCreate `page` and `labels` collections\r\nAdd Checkbox relational in page m2m with labels collection\r\n\r\nCheck [screenrecording ](https://drive.google.com/file/d/1r0pAk7jchF0bLmaWY7rQjdHoOKivgWwD/view?usp=sharing) for the additional steps to reproduce. Too complex to describe in text.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: develop branch commit 8a1187ff0b3559ab7281c4990d5329d47d8835dd\r\n- Directus App: App develop branch commit [2107f04d9984c6efa5577775bd12f869ed1270a4](https://github.com/directus/app/commit/2107f04d9984c6efa5577775bd12f869ed1270a4)\r\n"},{"labels":[null,"bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. In the App create 2 tables that you want to link with M2M relationship\r\n2. Add the M2M field to one of those tables by using  Many-to-Many interface. Use automatic generation of Junction Table.\r\n3. Under 'options' tab in Many-to-Many interface form toggle on 'Allow Select' trigger\r\n4. Save the field and ensure that Junction Table is created\r\n5. Create one item in collection without M2M field\r\n6. Now go to create item in collection with M2M field. When you will click on 'Select Existing' button related to this M2M field, you will see that popup window not showing any data in the list, though it should show the one that was entered in the previous step.\r\n\r\n## Expected Behavior\r\nThe popup window should list one item in the list\r\n## Actual Behavior\r\nNo items displayed in the list\r\n\r\n## Other Context & Screenshots\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\nHi guys, I'm trying to implement m2m relationship but for some reason selecting items (browse) is not working - empty list is shown. When I've checked the API call that suppose to bring a list of items for selection I see the following error. I'm using the latest build version of API and App\r\nUPDATE 1:\r\nAfter brief investigation I've found that at the moment when createMetadataPagination method is called the $_GET is empty. Probably it caused by request query string that in my case was:limit=200&offset=0&meta=%2A&fields%5B0%5D=name&fields%5B1%5D=id&sort=name. Can it be that 'meta' query string param escaped by mistake?\r\nUPDATE 2:\r\nI've made a fix in line 1025 of RelationalTableGateway.php - I've added validation for case if $params['meta'] is undefined, and at least list is shown right now, though search is not working. But I'm not sure that fix should be done on API side...\r\nSo this is a new code:\r\n$meta_param=explode(',',array_key_exists('meta', $params) ? $params['meta'] : \"\");\r\nInstead of this one:\r\n$meta_param=explode(',',$params['meta']); \r\n\r\n![image](https://user-images.githubusercontent.com/13006578/65457628-fd7eb900-de19-11e9-8fcb-e430a08f06c9.png)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS:  Windows 10.1803 & Ubuntu 16.04.1 WLS\r\n- Web Server: NGINX\r\n- PHP Version: 7.3.8\r\n- Database: MySQL 5.7.27\r\n- Install Method: cloned 'build' branch\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Configure Directus via environment variables (e.g. with official docker image, but not latest tag because its too old)\r\n2. Try to upload a file (e.g. via an file input field)\r\n\r\n## Expected Behavior\r\nUpload working\r\n\r\n## Actual Behavior\r\nreturning json:\r\n\r\n```json\r\n{\"error\":{\"code\":22,\"message\":\"Current configuration context only supports default project name (_)\"}}\r\n```\r\n\r\nCallstack shows:\r\n\r\n```\r\n#0  Directus\\get_project_config() called at [/var/www/src/core/Directus/Util/DateTimeUtils.php:112]\r\n#1  Directus\\Util\\DateTimeUtils::nowInTimezone() called at [/var/www/src/core/Directus/Database/TableGateway/RelationalTableGateway.php:2526]\r\n...\r\n```\r\n\r\n## Other Context & Screenshots\r\nThe issue seems to be a bad usage of `get_project_config` at https://github.com/directus/api/blob/1cf64403d53e3bf0b6db7ea98402ddae3a94da80/src/core/Directus/Util/DateTimeUtils.php#L112\r\n\r\nI am not sure how to fix this issue *correctly*, because I do not know of the usage of `get_project_config` of https://github.com/directus/api/blob/1cf64403d53e3bf0b6db7ea98402ddae3a94da80/src/core/Directus/Util/DateTimeUtils.php#L112 is intended or not. If it is not, the DateTimeUtils have to get its time zone from another source, if it is, we have to fix the check here https://github.com/directus/api/blob/master/src/helpers/app.php#L94 or fall back to the default namespace `_` by setting the default name to `_` here: https://github.com/directus/api/blob/master/src/helpers/app.php#L70\r\n\r\nWhat do you think? Whats the best solution here?\r\n\r\n## Technical Details\r\n- Install Method: Docker, latest apache version\r\n"},{"labels":["bug"],"text":"# üêû bug report\r\n\r\n\r\n\r\n### Description\r\nI am trying to do some conditional filtering using the and & or operators. Unfortunately after adding one of these operator causes directus to break other requirements / filters.  Below I will attach a code + result json.\r\n\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\n## The below code is parsing the correct data from directus with the correct category\r\n```ts\r\n  return client\r\n      .getItems('privileges', {\r\n        fields: ['*', 'image.filename', 'image.data.full_url', 'attachment.*', 'partner.*.*', 'location.*', 'category.*.*', 'type.icon.data.full_url'],\r\n        meta: ['total_count', 'result_count'],\r\n        sort: 'created_on',\r\n        filter: {\r\n          category: {\r\n            'logical': 'and',\r\n            'eq': category\r\n          },\r\n          available_from: {\r\n            'lte': 'now'\r\n          },\r\n          available_until: {\r\n            'gte': 'now'\r\n          }\r\n        },\r\n        limit,\r\n        offset,\r\n      }).then(response => {\r\n        dispatch(getPrivilegesSuccess(key, response))\r\n      }).catch(error => {\r\n        console.log(error);\r\n        dispatch(getPrivilegesFail(key, error))\r\n      });\r\n```\r\n\r\n## in contrary the below code response result from directus isn't correct anymore. It is parsing categories with different id's. (also with hardcoding the category id overhere) However the location.city and location.title filter do work as expected. The category filter does not unfortunately. \r\n\r\n```ts\r\n  return client\r\n      .getItems('privileges', {\r\n        fields: ['*', 'image.filename', 'image.data.full_url', 'attachment.*', 'partner.*.*', 'location.*', 'category.*.*', 'type.icon.data.full_url'],\r\n        meta: ['total_count', 'result_count'],\r\n        sort: 'created_on',\r\n        filter: {\r\n          'location.city': {\r\n            'contains': q\r\n          },\r\n          'location.title': {\r\n            'logical': 'or',\r\n            'contains': q\r\n          },\r\n          category: {\r\n            'logical': 'and',\r\n            'eq': category\r\n          },\r\n          available_from: {\r\n            'lte': 'now'\r\n          },\r\n          available_until: {\r\n            'gte': 'now'\r\n          }\r\n        },\r\n        limit,\r\n        offset,\r\n      }).then(response => {\r\n        dispatch(getPrivilegesSuccess(key, response))\r\n      }).catch(error => {\r\n        console.log(error);\r\n        dispatch(getPrivilegesFail(key, error))\r\n      });\r\n```\r\n## üî• Exception or Error\r\nNo exception or error, just wrong data being returned by directus api. (data with different category.id\r\n\r\n## üåç Your Environment\r\n\r\n\"@directus/sdk-js\": \"^5.3.0\",\r\n\r\n\r\nAny help is much appreciated. Already asked it in the slack group but they forwarded me to create an issue for it."},{"labels":["bug",null],"text":"Tested both on your demo api and on a dedicated vps freshly installed with the latest version (no docker). For a simple query (no joins, filters, etc.), the time is always >1s.\r\n\r\nIs this a known issue?\r\n\r\n![image](https://user-images.githubusercontent.com/10562635/65250394-ccd71080-daf5-11e9-8401-7e21be1c0867.png)\r\n"},{"labels":["bug"],"text":"Error message on the message popup when attempting to upload a file reads as \"_[file]_.png can't be uploaded. Your server is not configured to handle uploads of this size.\" with the upload dialog displaying \"Max. Size: 0 B.\" I read in a previous issue that this could be caused by the API failing to read the server information due to a blocked OPTIONS request, but network trace on browser yields no `OPTIONS` requests except against [telemetry.directus.io](https://telemetry.directus.io/).\r\n\r\nMy `cli/php.ini` and `apache2/php.ini` both read the default 2 MB upload limit, and attempting to override it by uncommenting the `.../directus/public/.htaccess` snippet does not yield any changes.\r\n\r\nI am using PHP 7.3 with the latest versions of MySQL and Apache2. I'm not necessarily sure what the root of the problem is, but could it be due to 7.3 handling server configurations differently?\r\n\r\nLet me know if I can provide more information or if there are any debug snippets I can run."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nThe motivation of this is to create a version column. This column will be used for concurrency control in EFCore. In other words, we can use this version column to check concurrency when loading content into Directus via in house code.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a table with a not null datetime column where the default value is current_timestamp: \r\n\r\n```sql\r\ncreate table `test_table` (\r\n  `id` int(15) unsigned not null auto_increment,\r\n  `name` varchar(200) default null,\r\n  `version` datetime(6) default current_timestamp(6) on update current_timestamp(6),\r\n  primary key (`id`)\r\n) ENGINE = InnoDB auto_increment = 3 default CHARSET = utf8mb4;\r\n```\r\n\r\n2. Navigate to collections, manage Test Table, manage all columns\r\n3. Click on ID Field\r\n  a. Change ID to Hidden on Detail = true, Hidden on Browse = true\r\n4. Click on Version Field\r\n  a. Change interface to DateTime Updated,  Hidden on Detail = true, Hidden on Browse = true\r\n  b. You may get an error here notifying the user to refresh the page and try again. This is potentially another bug and out of the scope of this report. I used the following sql:\r\n\r\n```sql\r\nupdate\r\n  directus_fields\r\nset\r\n  type = 'datetime_updated',\r\n  interface = 'datetime-updated',\r\n  options = '[]',\r\n  hidden_detail = 1,\r\n  hidden_browse = 1\r\nwhere\r\n  field = 'version';\r\n```\r\n\r\n5. Try to create a new record in Test Table.\r\n\r\n## Expected Behavior\r\n\r\nDirectus creates a record in `test_table` with `version` column filled in with the current DateTime\r\n\r\n## Actual Behavior\r\n\r\n* UI informs user version: This value is not a valid DateTime\r\n* Javscript logs:\r\n\r\n```json\r\n{\r\n  \"class\": \"Directus\\\\Validator\\\\Exception\\\\InvalidRequestException\",\r\n  \"code\": 4,\r\n  \"file\": \"/shared/httpd/cms/src/core/Directus/Services/AbstractService.php\",\r\n  \"line\": 186,\r\n  \"message\": \"version: This value is not a valid datetime.\"\r\n}\r\n```\r\n* Record is not created\r\n\r\n## Other Context & Screenshots\r\n\r\nSee: https://github.com/directus/api/issues/531 for a similar bug report\r\n\r\n## Technical Details\r\n\r\n- OS: Windows. Directus hosted in devilbox (docker container)\r\n- PHP Version:  7.2.0\r\n- Database: MariaDB\r\n- Install Method: cloned master, installed using scripts (manual install)\r\n\r\nEDIT: Adding mysql datetime precision to create table sql\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n- Create a collection with created_by and modified_by (just mark them on collection creation dialog)\r\n- Insert one row to that collection\r\n- Try removing the fields\r\n\r\n## Expected Behavior\r\n\r\nAble to delete and recreate created_by and updated_by fields from a collection\r\n\r\n## Actual Behavior\r\n\r\nThe delete is broken for some reason. It's not possible to delete those fields and it gets to a state that we're unable to even  create the field again later because it doesn't remove it from directus_fields table.\r\n\r\n## Other Context & Screenshots\r\n\r\nThere's 3 errors, first two are when I tried deleting created_by then updated_by, the last one was I trying to delete created_by again.\r\n\r\n![image](https://user-images.githubusercontent.com/412397/64844020-ffa47480-d5dc-11e9-8e29-b2dce496fbe6.png)\r\n\r\n## Technical Details\r\n\r\nReproducible in demo (directus.app)\r\n\r\n\r\nThere may be more issues related to those fields, for example: directus/app#2058\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n\r\n## Steps to Reproduce\r\n1. Update config api.php on key *mail*\r\n```\r\n'mail' => [\r\n    'default' => [\r\n    'transport' => 'smtp',\r\n     'host' => 'smtp.sendgrid.net',\r\n     'port' => '587',\r\n     'username' => 'xxxx',\r\n     'password' => 'xxxx',\r\n     'from' => 'xxxx',\r\n     'encryption' => 'tls',\r\n     'verify_peer' => false\r\n   ],\r\n]\r\n```\r\n2. Do API call to /mail with the params\r\n```\r\n{\r\n  \"to\": \"anu@gmail.com\",\r\n  \"subject\": \"New Password\",\r\n  \"body\": \"Hello <b>{{name}}</b>, this is your new password: {{password}}.\",\r\n  \"type\": \"html\",\r\n  \"data\": {\r\n    \"name\": \"John Doe\",\r\n    \"password\": \"secret\"\r\n  }\r\n}\r\n```\r\n\r\n## Expected Behavior\r\nEmail send with SMTP using sendgrid\r\n\r\n## Actual Behavior\r\nFailed to send email with smtp using sendgrid, following error:\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"Expected response code 250 but got code \\\"550\\\", with message \\\"550 Unauthenticated senders not allowed\\r\\n\\\"\",\r\n        \"class\": \"Swift_TransportException\",\r\n        \"file\": \"/var/www/directus/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/AbstractSmtpTransport.php\",\r\n        \"line\": 383\r\n    }\r\n}\r\n```\r\n\r\n## Technical Details\r\n- OS: Ubuntu 18.04\r\n- Web Server: Apache/2.4.29 (Ubuntu)\r\n- PHP Version: 7.2.19-0ubuntu0.18.04.2\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n* Fresh install from https://github.com/directus/api/commit/1cf64403d53e3bf0b6db7ea98402ddae3a94da80\r\n* Enable development mode\r\n* Create collection with wysiwyg-full field\r\n* Add item\r\n* Add image\r\n\r\n## Expected Behavior\r\n\r\nIt should successfully add image\r\n\r\n## Actual Behavior\r\n\r\nError: `Call to a member function isOneToMany() on null`\r\n\r\n```\r\n[2019-09-12 17:14:10] api[_].ERROR: Error: Call to a member function isOneToMany() on null in /webroot/src/core/Directus/Database/TableGateway/RelationalTableGateway.php:405\r\nStack trace:\r\n#0 /webroot/src/core/Directus/Services/FilesServices.php(59): Directus\\Database\\TableGateway\\RelationalTableGateway->createRecord\r\n#1 /webroot/src/endpoints/Files.php(84): Directus\\Services\\FilesServices->create\r\n#2 [internal function]: Directus\\Api\\Routes\\Files->create\r\n#3 /webroot/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func\r\n#4 /webroot/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#5 /webroot/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#6 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\n[Screenrecording](https://drive.google.com/file/d/1NQTlatm6dzYDp9-mNp3XL3WrnnspScrl/view?usp=sharing)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: https://github.com/directus/api/commit/1cf64403d53e3bf0b6db7ea98402ddae3a94da80\r\n- Directus App: 7.9.0\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Run API with `DIRECTUS_USE_ENV=1` and other env. variables as required for Docker\r\n2. Do any operation through APP (e.g. create collection)\r\n\r\n## Expected Behavior\r\nCollection gets created without issues.\r\n\r\n## Actual Behavior\r\nCollection gets created but an error is raised (possibly when adding this to audit log)\r\n\r\n## Other Context & Screenshots\r\n\r\nException: \r\n```\r\napi[_].ERROR: Directus\\Config\\Exception\\InvalidProjectException: Current configuration context only supports default project name (_) in /var/www/src/helpers/app.php:95\r\napi_1       | Stack trace:\r\napi_1       | #0 /var/www/src/core/Directus/Util/DateTimeUtils.php(112): Directus\\get_project_config                                                                                                                                                                                                                                              api_1       | directus/api#1 /var/www/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(2526): Directus\\Util\\DateTimeUtils::nowInTimezone\r\napi_1       | directus/api#2 /var/www/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(440): Directus\\Database\\TableGateway\\RelationalTableGateway->recordActivity\r\napi_1       | directus/api#3 /var/www/src/core/Directus/Services/ItemsService.php(54): Directus\\Database\\TableGateway\\RelationalTableGateway->createRecord                                                                                                                                                                                                    api_1       | directus/api#4 /var/www/src/endpoints/Items.php(69): Directus\\Services\\ItemsService->createItem                                                                                                                                                                                                                                                 api_1       | directus/api#5 [internal function]: Directus\\Api\\Routes\\Items->create                                                                                                                                                                                                                                                                           api_1       | directus/api#6 /var/www/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(40): call_user_func                                                                                                                                                                                                                                       api_1       | directus/api#7 /var/www/vendor/slim/slim/Slim/Route.php(281): Slim\\Handlers\\Strategies\\RequestResponse->__invoke                                                                                                                                                                                                                                api_1       | directus/api#8 /var/www/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke                                                                                                                                                                                                                 api_1       | directus/api#9 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke                                                                                                                                                                                                                                  api_1       | directus/api#10 /var/www/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array                                                                                                                                                                                                                                                   api_1       | directus/api#11 [internal function]: Slim\\DeferredCallable->__invoke                                                                                                                                                                                                                                                                            api_1       | directus/api#12 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func                                                                                                                                                                                                                                                     api_1       | directus/api#13 /var/www/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(120): Slim\\Route->Slim\\{closure}                                                                                                                                                                                                            api_1       | directus/api#14 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke                                                                                                                                                                                                                                    api_1       | directus/api#15 /var/www/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array                                                                                                                                                                                                                                                   api_1       | directus/api#16 [internal function]: Slim\\DeferredCallable->__invoke                                                                                                                                                                                                                                                                            api_1       | directus/api#17 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func                                                                                                                                                                                                                                                     api_1       | directus/api#18 /var/www/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}                                                                                                                                                                                                               api_1       | directus/api#19 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke                                                                                                                                                                                                                                      api_1       | directus/api#20 /var/www/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array                                                                                                                                                                                                                                                   api_1       | directus/api#21 [internal function]: Slim\\DeferredCallable->__invoke                                                                                                                                                                                                                                                                            api_1       | directus/api#22 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func                                                                                                                                                                                                                                                     api_1       | directus/api#23 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}                                                                                                                                                                                                                                        api_1       | directus/api#24 /var/www/vendor/slim/slim/Slim/Route.php(268): Slim\\Route->callMiddlewareStack                                                                                                                                                                                                                                                  api_1       | directus/api#25 /var/www/vendor/slim/slim/Slim/App.php(503): Slim\\Route->run                                                                                                                                                                                                                                                                    api_1       | directus/api#26 /var/www/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke                                                                                                                                                                                                                  api_1       | directus/api#27 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke                                                                                                                                                                                                                                 api_1       | directus/api#28 /var/www/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array                                                                                                                                                                                                                                                   api_1       | directus/api#29 [internal function]: Slim\\DeferredCallable->__invoke                                                                                                                                                                                                                                                                            api_1       | directus/api#30 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func                                                                                                                                                                                                                                                     api_1       | directus/api#31 /var/www/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}                                                                                                                                                                                                                         api_1       | directus/api#32 /var/www/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke                                                                                                                                                                                               api_1       | directus/api#33 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke                                                                                                                                                                                                                                             api_1       | directus/api#34 /var/www/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array                                                                                                                                                                                                                                                   api_1       | directus/api#35 [internal function]: Slim\\DeferredCallable->__invoke                                                                                                                                                                                                                                                                            api_1       | directus/api#36 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func                                                                                                                                                                                                                                                     api_1       | directus/api#37 /var/www/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}                                                                                                                                                                                                                                  api_1       | directus/api#38 [internal function]: RKA\\Middleware\\IpAddress->__invoke                                                                                                                                                                                                                                                                         api_1       | directus/api#39 /var/www/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array                                                                                                                                                                                                                                                   api_1       | directus/api#40 [internal function]: Slim\\DeferredCallable->__invoke                                                                                                                                                                                                                                                                            api_1       | directus/api#41 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func                                                                                                                                                                                                                                                     api_1       | directus/api#42 /var/www/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}                                                                                                                                                                                                                         api_1       | directus/api#43 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke                                                                                                                                                                                                                                              api_1       | directus/api#44 /var/www/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array                                                                                                                                                                                                                                                   api_1       | directus/api#45 [internal function]: Slim\\DeferredCallable->__invoke                                                                                                                                                                                                                                                                            api_1       | directus/api#46 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func                                                                                                                                                                                                                                                     api_1       | directus/api#47 /var/www/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}                                                                                                                                                                                                                api_1       | directus/api#48 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke                                                                                                                                                                                                                                     api_1       | directus/api#49 /var/www/vendor/slim/slim/Slim/DeferredCallable.php(57): call_user_func_array                                                                                                                                                                                                                                                   api_1       | directus/api#50 [internal function]: Slim\\DeferredCallable->__invoke                                                                                                                                                                                                                                                                            api_1       | directus/api#51 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func                                                                                                                                                                                                                                                     api_1       | directus/api#52 /var/www/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}                                                                                                                                                                                                                                          api_1       | directus/api#53 /var/www/vendor/slim/slim/Slim/App.php(392): Slim\\App->callMiddlewareStack                                                                                                                                                                                                                                                      api_1       | directus/api#54 /var/www/vendor/slim/slim/Slim/App.php(297): Slim\\App->process                                                                                                                                                                                                                                                                  api_1       | directus/api#55 /var/www/src/core/Directus/Application/Application.php(161): Slim\\App->run                                                                                                                                                                                                                                                      api_1       | directus/api#56 /var/www/public/index.php(5): Directus\\Application\\Application->run [] []                \r\n```\r\n\r\nApparently the issue is that when calling `app::get_project_config` with default arguments from `DateTimeUtils::nowInTimezone` it does not work, as it should be used with default project name `_`.\r\n\r\n## Technical Details\r\n\r\n- Device: Docker, Windows WSL2 ...\r\n- OS: [eg: MacOS 10.13.6, Windows 10.1803]\r\n- Web Server: Apache in Docker\r\n- PHP Version: [eg: 7.2.0]\r\n- Database: [eg: MySQL 8.0.12]\r\n- Install Method: reproduced in `master` and visible also in `develop`\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\nExperiencing weird behavior with thumbnails that don't accurately reflect the images in the system. For example if i replace images (delete and add them again) or use directus to crop or rotate them, the thumbnails don't update, its like the thumbnails are generated once on the very first upload of an image, and never get regenerated from that moment onwards.\r\n\r\nSuspecting caching might be at play, I set the Thumbnail Cache TTL in the admin global settings to '1' second, attempted visitting the thumbmails directly and hard refreshing in browser just in case, done wgets to be 100% sure there was no caching at play, and still no luck.\r\n\r\nSee video here https://www.youtube.com/watch?v=azqhPDH3Dj0\r\n\r\n## Expected Behavior\r\nThubmnails should reflect the cropped or deleted/reuploaded images as they actually exist in the system.\r\n\r\n## Actual Behavior\r\nThumbnails do NOT reflect the images as they exist in the system.\r\n\r\n## Other Context & Screenshots\r\nhttps://www.youtube.com/watch?v=azqhPDH3Dj0\r\n\r\n## Technical Details\r\nI've tested and observed this on two different server setups and a wide range of clients.\r\n- Ubuntu 18 with PHP 7.2\r\n- Ubuntu 14 with PHP 5.5.9\r\n- Wide range of clients (Chrome, IE, Firefox, Desktop, Mobile, Window, Linux)"},{"labels":["bug"],"text":"# Bug Report\r\nNot able to delete/update multiple users fro User Directory\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'User Directory'\r\n2. Try to delete/update multiple users\r\n3. API will throw 500 error\r\n\r\n## Expected Behavior\r\nIt should delete/update users.\r\n\r\n## Actual Behavior\r\nThrowing 500 Internal server error.\r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/19200178/64242225-c99f2a80-cf22-11e9-9179-610137fdf277.png)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 8.1\r\n- Web Server: Apache 2.4.33[WAMP]\r\n- PHP Version: 7.2.4\r\n- Database: MySQL 5.7.21\r\n- Install Method: Cloned master branch\r\n"},{"labels":["bug",null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n<!-- Only report bugs with the officially supported LAMP stack. Issues with alternate stacks are \"enhancements\". -->\r\n\r\n## Steps to Reproduce\r\n\r\nLogin Google Auth\r\n\r\n## Expected Behavior\r\nLogs In successfully\r\n## Actual Behavior\r\nStuck \"Signing In...\"\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/34060058/51744364-8250e180-2097-11e9-9478-fabdcc87439a.png)\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\nIf I switch to Directus App 7.0.11 it immediately works until I switch to another version from 7.0.12 - 7.0.15, it doesn't log in and I get this issue again.  \r\n\r\nI can login manually with same username.\r\n\r\nI cannot see anything added to API logs when this happens and I cannot find the docker APP logs to check them.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows and Ubuntu\r\n- Browser: [eg: Chrome 68.0.3440.106]\r\n- Directus App: 7.0.15 (docker)\r\n- Directus API: 2.0.15\r\n- Install Method: Git clone seperate API and APP with Clean fresh install of DB\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nin [Files.php#L326](https://github.com/directus/directus/blob/master/src/core/Directus/Filesystem/Files.php#L326) the height of the media is set to the width.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Upload a video\r\n2. Check its meta data\r\n3. Height property is equal to the width\r\n\r\n## Expected Behavior\r\nWidth and height should be set properly..\r\n\r\n## Actual Behavior\r\nHeight is always equal to the width of the file. Should be an easy fix, just replace $width with $height variable.\r\n\r\n## Technical Details\r\n\r\n- OS: Windows 10 (Version 10.0.17134 Build 17134)\r\n- Web Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.8 (XAMPP)\r\n - PHP Version: PHP Version 7.3.8\r\n - Database: MariaDB, 10.4.6\r\n - Install Method: git clone from the master branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Add a User interface to a collection and name it `publisher`\r\n2. Give user access permissions to the Public role\r\n3. Send a GET request to `_/items/aCollection/anID?fields=publisher.*.*`\r\n4. You will see the API is not getting into deeper on publisher field.\r\n\r\n## Expected Behavior\r\nGetting deep information of the user, selected as publisher\r\n## Actual Behavior\r\nNo matter you do, API does not go deeper into the publisher\r\n## Other Context & Screenshots\r\n**Problem can be reproduced on directus.app**\r\n\r\n## Technical Details\r\n- Device: [4 vCpu Intel Xeon E5 2.6GHz/3.3GHz | 120 GB NVME SSD | 8 GB ECC RAM | Plesk Onyx 17.8.11 ]\r\n- OS: [CentOS 7]\r\n- Web Server: [Apache 2.4.37]\r\n- PHP Version: [7.2.0]\r\n- Database: [MySQL 10.2.26]\r\n- Install Method: [cloned `master` branch | App: 7.6.1 API: 2.2.1]"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection\r\n2. Create an entry containing Chinese characters\r\n3. \"Failed generating the SQL query\"\r\n\r\n## Expected Behavior\r\n\r\nSuccessful creation of entry.\r\n\r\n## Actual Behavior\r\n\r\nError message shown.\r\n\r\n## Solution\r\n\r\nHave to run the following SQL queries before using the system, which should be set as default to save developers' time!\r\n\r\n```\r\nALTER DATABASE <directus-api-database> CHARACTER SET utf8 COLLATE utf8_bin;\r\nALTER TABLE <collection-1> CONVERT TO CHARACTER SET utf8 COLLATE utf8_bin;\r\nALTER TABLE <collection-2> CONVERT TO CHARACTER SET utf8 COLLATE utf8_bin;\r\nALTER TABLE <collection-3> CONVERT TO CHARACTER SET utf8 COLLATE utf8_bin;\r\n```\r\n\r\n## Suggestion\r\n\r\nAll collections created should have utf8 collation!"},{"labels":["bug"],"text":"I tried to put a RegEx Validation on a datatype Integer, and when I try to save I get the error message saying invalid regex, i've tried these:\r\n* `[0-9]{4}`\r\n* `[0-9]{4,4}`\r\n* `^[0-9]{4}$`\r\n\r\nThese are valid RegEx', so what's the case here? If RegEx is not supported for integers then the field should not be visible in the advanced options?"},{"labels":["bug",null,null,null],"text":"## Steps to Reproduce\r\n\r\n`artists` one-to-many with `artworks`\r\n\r\n* `artists` fields:\r\n    - o2m field, not required`\r\n    - status with publish, draft, soft delete\r\n* Add an artist item without the artworks\r\n* Update `artists` o2m field as required\r\n* Try to delete the artist created previously\r\n\r\n## Expected Behavior\r\n\r\n```\r\nError: artworks: This value should not be blank.\r\n```\r\n\r\n## Actual Behavior\r\n\r\nIt should delete the item successfully.\r\n\r\n## Other Context & Screenshots\r\n\r\n[Screenrecording](https://drive.google.com/file/d/1IH_p5X_caM8SwSn8H_gl4kzLDcPi6Klg/view?usp=sharing)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: v2.5.0+ develop branch: https://github.com/directus/api/commit/db22ae5f5db3bb7572532edf33bbd8e84d764641\r\n- Directus App: 7.10.0\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n* Enable caching\r\n* `artists` one-to-many with `artworks`\r\n* Add m2o field in artworks\r\n* Delete the m2o field\r\n\r\nAlso happens with o2m\r\n* Add o2m field in artists\r\n* Delete the o2m field\r\n\r\n## Expected Behavior\r\n\r\nThere should be no error\r\n\r\n## Actual Behavior\r\n\r\nInvalid key \"tag!entity_directus_fields_many-to-one\". Valid filenames must match [a-zA-Z0-9_\\.! ].\r\n\r\n## Other Context & Screenshots\r\n\r\n[screenrecording](https://drive.google.com/file/d/1wXIYAcZqg8ioiahtByj5_vOdDHvXOdm5/view?usp=sharing)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: v2.5.0 build\r\n- Directus App: 7.10.0\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n`events` one-to-many with `schedules`\r\n\r\n* Create events item with 2 schedules\r\n* Update the item, remove 1 schedule\r\n\r\n## Expected Behavior\r\n\r\nshould save without error\r\n\r\n## Actual Behavior\r\n\r\n```\r\nFilesystemCachePool error: Invalid key \"Valid filenames must match [a-zA-Z0-9_\\.! ]\"\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\n[screenrecording](https://drive.google.com/file/d/1a9pUGmwJ954Mz6knJDbi2KF1Wa11OoX1/view?usp=sharing)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: v2.5.0 build\r\n- Directus App: 7.10.0\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nThis happens with APP 7.10.0 and API 2.5.0 both on local as well as https://directus.app\r\n\r\nWhen a child collection has a divider, it prevents creating the new item because it tries to insert the divider as a column\r\n\r\n\r\n## Steps to Reproduce\r\n\r\nCreate a collection demo_articles and a collection demo_articles_sections (some fields removed for simplicity):\r\n\r\n```\r\ndemo_articles_sections\r\n      id\r\n      parent_id\r\n      text\r\n      separator\r\n\r\ndemo_articles\r\n     id\r\n     sections (O2M)\r\n   \r\n```\r\ncreating a new demo_articles item with a new demo_articles_sections item  results in:\r\n```\r\n{\"error\":{\"code\":9,\"message\":\"Failed generating the SQL query. Statement could not be executed (42S22 - 1054 - Unknown column 'separator2' in 'field list')\",\"query\":\"INSERT INTO `demo_articles_sections` (`label`, `display_order`, `photo`, `photo_credit`, `layout_details`, `created_by`, `created_on`, `modified_by`, `modified_on`, `separator2`, `parent_id`) VALUES ('section 4', '99', NULL, NULL, NULL, '15', '2019-08-28 15:11:41', '15', '2019-08-28 15:11:41', NULL, '1')\",\"class\":\"Directus\\\\Database\\\\Exception\\\\InvalidQueryException\",\"file\":\"\\/var\\/www\\/html\\/src\\/core\\/Directus\\/Database\\/TableGateway\\/BaseTableGateway.php\",\"line\":815}}<br />\r\n````\r\n\r\nOn https://directus.app/ the error is:\r\n\r\n    error: {code: 9, message: \"Failed generating the SQL query.\",‚Ä¶}\r\n    code: 9\r\n    message: \"Failed generating the SQL query.\"\r\n    query: \"INSERT INTO `demo_articles_sections` (`created_by`, `created_on`, `text`, \r\n       `separator1`, `parent_id`) VALUES ('1', '2019-08-28 18:22:19', 'test', NULL, '4')\"\r\n\r\n\r\n## Expected Behavior\r\n\r\nthe divider is ignored\r\n\r\n## Actual Behavior\r\n\r\nthe divider is being \"inserted\" and fails\r\n\r\n## Other Context & Screenshots\r\n\r\n\r\n## Technical Details\r\n\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nI'm following the exact process from https://docs.directus.io/getting-started/installation.html#setup\r\n\r\n0. I'm using a shared hosting...\r\n\r\n1. **Clone the repository:**  \r\ngit clone https://github.com/directus/directus.git  (v 7.9.0)\r\n(also tried the zip method, and the manual config, with the same issue)\r\n\r\n2. **Set the document root to the /public directory**:  \r\nA subdomain directus.myDomain.com is pointing to the /public folder.\r\n\r\n3. **Navigate your browser to the App at /admin**  \r\nThere, I'm indeed forwarded to /admin/#/login\r\n\r\n## Expected Behavior\r\n\r\nThe first screen of the guided setup is supposed to be displayed.\r\n\r\n## Actual Behavior\r\n\r\nThe login screen appears instead, with a loader under the signin button.\r\n\r\nAlso, consoles rises two errors:\r\n\r\n- Error 500 on `/_/auth/sso:1`\r\n- Uncaught (in promise) TypeError: Cannot read property 'code' of undefined at `login.vue:407`\r\n\r\n## Other Context & Screenshots\r\n\r\nI read through many related topics. Although I don't feel lonely anymore, I didn't find any fix there, as the latest topics were considering the issue fixed.\r\n\r\nOne of the potential solutions was to change the right permissions, but I was not so sure which folders to edit. I gave rights to the `config` folder, then the `public`, then the whole project...\r\n\r\nIndeed, I'm not so sure that my problem shares the same cause...\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: WIndows 10\r\n- Web Server: Apache Shared Hosting  \r\n`Mod Rewrite` is ok. However, I can't access AllowOverride here. Would it be related?\r\n\r\n- PHP Version: 7.3\r\n- Database: MySQL 5.7\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nI've been trying to change user password through CLI tool since I can't connect with an user created from the app (reported here #1199).\r\n\r\n## Steps to Reproduce\r\n\r\n1. Open your console\r\n2. Create a user with email `my-user@his-email.com` and password `abc123`. Set it active and add it a role (Admin or else)\r\n3. Start the CLI command `php bin/directus user:password -e my-user@his-email.com -p abc123`\r\n4. See the results (Error message)\r\n\r\n## Expected Behavior\r\n\r\n- We expect the password of the user with email `my-user@his-email.com` to get a new password (abc123)\r\n\r\n## Actual Behavior\r\n\r\nThe CLI command throw an error :\r\n```\r\nPHP Fatal error:  Uncaught ArgumentCountError: Too few arguments to function Directus\\Console\\Common\\User::__construct(), 1 passed in /var/www/html/src/core/Directus/Console/Modules/UserModule.php on line 65 and exactly 2 expected in /var/www/html/src/core/Directus/Console/Common/User.php:19\r\nStack trace:\r\n#0 /var/www/html/src/core/Directus/Console/Modules/UserModule.php(65): Directus\\Console\\Common\\User->__construct('/var/www/html')\r\n#1 /var/www/html/src/core/Directus/Console/Modules/ModuleBase.php(61): Directus\\Console\\Modules\\UserModule->cmdPassword(Array, Array)\r\n#2 /var/www/html/src/core/Directus/Console/Cli.php(88): Directus\\Console\\Modules\\ModuleBase->runCommand('password', Array, Array)\r\n#3 /var/www/html/src/core/Directus/Console/Cli.php(64): Directus\\Console\\Cli->cmd()\r\n#4 /var/www/html/bin/directus(10): Directus\\Console\\Cli->run()\r\n#5 {main}\r\n  thrown in /var/www/html/src/core/Directus/Console/Common/User.php on line 19\r\n```\r\n\r\nIt seems a basic PHP error (it seems only). \r\nQuoted files in the error:\r\n- https://github.com/directus/api/blob/develop/src/core/Directus/Console/Common/User.php\r\n- https://github.com/directus/api/blob/develop/src/core/Directus/Console/Modules/UserModule.php\r\n\r\n## Technical Details\r\n\r\n- Device: Docker\r\n- OS: Linux alpine\r\n- Web Server: x\r\n- PHP Version: 7.2.13\r\n- Database: MySQL x\r\n- Install Method: Get latest code cloned into my container\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a new collection (e.g. Nodes)\r\n2. Add a Many to One field, that relates to the same collection again (e.g. field parent that relates to a Node)\r\n3. Add a One to Many field (inverse of the field above, e.g. children)\r\n4. Create a node\r\n5. Type something in the searchbar (or do a get request with a given `q` parameter)\r\n\r\n## Expected Behavior\r\n\r\nApp: See a list of nodes that match the given search criteria.\r\nDirect API access:  Get a json encoded list of nodes.\r\n\r\n## Actual Behavior\r\n\r\nApp: See a \"Server Error\"\r\nDirect API access: 500 error with message \"Failed generating the SQL query.\" and query like this (the collection is named `a` in this case)\r\n```\r\nSELECT `a`.`id` AS `id`, `a`.`status` AS `status`, `a`.`created_by` AS `created_by`, `a`.`created_on` AS `created_on`, `a`.`parent` AS `parent` FROM `a` WHERE (`a`.`id` LIKE '%a%' OR `a`.`id` IN (SELECT `a`.`parent` AS `parent` FROM `a` RIGHT JOIN `a` ON `a`.`id` = `a`.`parent` WHERE `a`.`id` LIKE '%a%')) AND `a`.`status` IN ('published', 'draft') ORDER BY `a`.`id` IS NULL, `a`.`id` ASC, `a`.`id` ASC LIMIT 100 OFFSET 0\r\n```\r\nThe problematic part is ```SELECT `a`.`parent` AS `parent` FROM `a` RIGHT JOIN `a` ON `a`.`id` = `a`.`parent` WHERE `a`.`id` LIKE '%a%'```. The collection name is used twice.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\nDemo at directus.app and self hosted:\r\n\r\n- Device: vServer\r\n- OS: Debian 10.0\r\n- Web Server: Apache 2.4.38-3\r\n- PHP Version: 7.3.4-2\r\n- Zend Engine: v3.3.4\r\n- OPcache: v7.3.4-2\r\n- Database: MySQL 8.0.17\r\n- Install Method: cloned `build` branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nI'm new to configuring CMS' and I'm having an issue where I am unable to log in after installing Directus for the first time\r\n## Steps to Reproduce\r\ninstall Drectus using clone\r\nfollow Apache install steps\r\ngo through the first time install steps\r\ntry logging in \r\n1. Go to '...'\r\n2. Click on '....'\r\n3. Scroll down to '...'\r\n4. See error\r\n\r\n## Expected Behavior\r\nExpected to be brought to the admin page after logging.\r\n\r\n## Actual Behavior\r\nGetting \"Unknown server error. Try again later\" \r\n\r\n\r\n## Other Context & Screenshots\r\n\r\nIn the console I see:\r\ndirectus-sdk.umd.min.js:1 POST http://ec2-<IP>.compute-1.amazonaws.com/_/auth/authenticate 500 (Internal Server Error)\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop, iPhone6, etc]\r\n- OS: [eg: MacOS 10.13.6, Windows 10.1803]\r\nUbuntu 18.04\r\n- Web Server: [eg: Apache 2.4.37]\r\nApache/2.4.29 (Ubuntu)\r\n- PHP Version: [eg: 7.2.0]\r\nPHP 7.1\r\n- Database: [eg: MySQL 8.0.12]\r\n5.7.27-0ubuntu0.18.04.1\r\n- Install Method: [eg: cloned `master` branch]\r\ngit clone ...\r\n\r\nI've been reading through the issues and I've seen example where people have suggested  setting RewriteBase / in my .htaccess file but I'm not sure where to put it or the proper syntax. I also have mod_rewrite enabled\r\n\r\nAny help would be greatly appreciated."},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection with a primary key\r\n2. Create another collection\r\n3. In the first collection create a M2M relation (lets call  it `tables`) with automatic generated junction table. Choose `directus_collections` as related collection.\r\n4. Edit table 1, select a table in in field `tables` and save.\r\n\r\n## Expected Behavior\r\n\r\nShould be saved successfully.\r\n\r\n## Actual Behavior\r\n\r\nCannot generate the SQL query with the following error:\r\n```\r\n{\"error\":{\"code\":9,\"message\":\"Failed generating the SQL query.\",\"query\":\"UPDATE `directus_fields` SET `collection` = 'immoscout', `field` = 'id', `datatype` = 'INT', `unique` = '', `primary_key` = '1', `auto_increment` = '1', `default_value` = NULL, `note` = '', `signed` = '', `id` = '1978', `type` = 'integer', `sort` = '0', `interface` = 'primary-key', `hidden_detail` = '1', `hidden_browse` = '1', `required` = '1', `options` = NULL, `locked` = '0', `translation` = NULL, `readonly` = '', `width` = '4', `validation` = NULL, `group` = NULL, `length` = '10' WHERE `id` = '1978'\"}}\r\n```\r\n\r\n## Technical Details\r\n\r\nUsing the docker image `directus/api:latest` (from today) with a mysql mariadb.\r\n"},{"labels":["bug"],"text":"I have a site that is setup using the standard recommendation for translation (a separate table with a language/m2o field).  Let's use this as an example:\r\n\r\n- diseases\r\n- disease_translations\r\n\r\nI have the translations interface on the `diseases` collection.  Next steps to follow:\r\n\r\n- create a new user role\r\n- assign a user\r\n- sign in as that user\r\n- try to update the diseases collection translation and you will see this error: \"Updating item from \"directus_users\" collection was denied\"\r\n\r\nHowever, this is only in the `diseases` editor.  If I try and edit the `disease_translation` collection (same entry) it allows me to update it.  I tried the default user permissions with the install as well as the following configuration:\r\n\r\n![Screen Shot 2019-08-20 at 16 25 09](https://user-images.githubusercontent.com/150944/63351020-261d1a00-c367-11e9-8960-c585a57b1b30.jpg)\r\n\r\nIf I assign full permission to the user row the denial comes from `directus_user_roles` instead.\r\n\r\nThis seems to be related to #723 but shows up when using the translation interface.\r\n\r\n## Technical Details\r\n\r\n- OS: Ubuntu\r\n- Database: MySQL 8\r\n- Install Method: cloned master\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n* Enable filesystem caching as\r\n![image](https://user-images.githubusercontent.com/3615746/63340475-b6645a80-c379-11e9-8a07-3ddfbf48de3a.png)\r\n\r\n* Create a `cache` collection with `modified_on` field\r\n* Add an item\r\n* Update the item\r\n\r\n## Expected Behavior\r\n\r\nIt should be updated successfully\r\n\r\n## Actual Behavior\r\n\r\nError: `Invalid key \"tag!entity_cache_2019-08-20 07:03:40\". Valid filenames must match [a-zA-Z0-9_\\.! ].`\r\n\r\n![image](https://user-images.githubusercontent.com/3615746/63340603-0e02c600-c37a-11e9-8fe2-82722cf136ae.png)\r\n\r\n## Other Context & Screenshots\r\n\r\n[Screen recording](https://drive.google.com/file/d/19Qvg2TmwancOWyxMpbaGzehNoNfmB69N/view?usp=sharing)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: v2.4.0 build\r\n- Directus App: 7.9.0\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nI'm using Directus Suite and i want to create a new action hook to send email on after create / update item. But i keep bumping into this error can't send email (logs below). I'm using GMAIL smtp for mail configuration.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\npublic/extensions/custom/hook/Webhook/hooks.php\r\n\r\n```\r\n<?php\r\n\r\nreturn [\r\n    'actions' => [\r\n        'item.create.edm:after' => '\\Directus\\Custom\\Hooks\\Webhook\\Classes\\EdmSendEmail',\r\n        'item.update.edm:after' => '\\Directus\\Custom\\Hooks\\Webhook\\Classes\\EdmSendEmail'\r\n    ]\r\n];\r\n```\r\n\r\npublic/extensions/custom/hook/Webhook/Classes/EdmSendEmail.php\r\n\r\n```\r\n<?php\r\n\r\nnamespace Directus\\Custom\\Hooks\\Webhook\\Classes;\r\n\r\nuse Directus\\Hook\\HookInterface;\r\nuse Directus\\Hook\\Payload;\r\n\r\nclass EdmSendEmail\r\n{\r\n    public function __invoke(array $data)\r\n    {\r\n        $container = \\Directus\\Application\\Application::getInstance()->getContainer();\r\n\r\n        try {\r\n            $itemsService = new \\Directus\\Services\\ItemsService($container);\r\n            $edm = $itemsService->find('edm', $data['id'], [\r\n                'fields' => '*,template.*,signature.signature_id.*'\r\n            ]);\r\n            $data = $edm['data'];\r\n\r\n            $subject = $data['title'];\r\n            $body = $data['template']['template'];\r\n\r\n            $mailService = new \\Directus\\Services\\MailService($container);\r\n            $mailService->send([\r\n                'type' => 'html',\r\n                'subject' => $subject,\r\n                'body' => $body,\r\n                // 'data' => 'array',\r\n                // 'to' => explode(',', $data['email_tester'])\r\n                'to' => 'johndoe@email.com'\r\n            ]);\r\n        } catch (\\Exception $e) {\r\n            $logger = $container->get('logger');\r\n            $logger->error($e);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n```\r\n[2019-08-19 15:09:21] api[_].ERROR: Swift_TransportException: Connection could not be established with host localhost [Connection refused #61] in /Users/waimun/Documents/www/directus/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/StreamBuffer.php:277\r\nStack trace:\r\n#0 /Users/waimun/Documents/www/directus/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/StreamBuffer.php(62): Swift_Transport_StreamBuffer->_establishSocketConnection()\r\n#1 /Users/waimun/Documents/www/directus/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/AbstractSmtpTransport.php(113): Swift_Transport_StreamBuffer->initialize(Array)\r\n#2 /Users/waimun/Documents/www/directus/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Mailer.php(79): Swift_Transport_AbstractSmtpTransport->start()\r\n#3 /Users/waimun/Documents/www/directus/src/core/Directus/Mail/Mailer.php(76): Swift_Mailer->send(Object(Directus\\Mail\\Message))\r\n#4 /Users/waimun/Documents/www/directus/src/helpers/mail.php(62): Directus\\Mail\\Mailer->sendWithContent('<!DOCTYPE html ...', 'text/html', Object(Closure))\r\n#5 /Users/waimun/Documents/www/directus/src/helpers/mail.php(44): Directus\\send_mail_with_content('<!DOCTYPE html ...', 'text/html', Object(Closure))\r\n#6 /Users/waimun/Documents/www/directus/src/core/Directus/Services/MailService.php(42): Directus\\send_mail_with_layout('base.twig', 'Organisational ...', Array, 'text/html', Object(Closure))\r\n#7 /Users/waimun/Documents/www/directus/public/extensions/custom/hooks/Webhook/Classes/EdmSendEmail.php(31): Directus\\Services\\MailService->send(Array)\r\n#8 [internal function]: Directus\\Custom\\Hooks\\Webhook\\Classes\\EdmSendEmail->__invoke(Array)\r\n#9 /Users/waimun/Documents/www/directus/src/core/Directus/Hook/Emitter.php(291): call_user_func_array(Object(Directus\\Custom\\Hooks\\Webhook\\Classes\\EdmSendEmail), Array)\r\n#10 /Users/waimun/Documents/www/directus/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners(Array, Array, 0)\r\n#11 /Users/waimun/Documents/www/directus/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run('item.update.edm...', Array)\r\n#12 /Users/waimun/Documents/www/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute('item.update.edm...', Array)\r\n#13 /Users/waimun/Documents/www/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1623): Directus\\Database\\TableGateway\\BaseTableGateway->runHook('item.update.edm...', Array)\r\n#14 /Users/waimun/Documents/www/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks('edm', Array)\r\n#15 /Users/waimun/Documents/www/directus/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate(Object(Zend\\Db\\Sql\\Update))\r\n#16 /Users/waimun/Documents/www/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith(Object(Zend\\Db\\Sql\\Update))\r\n#17 /Users/waimun/Documents/www/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray(Array)\r\n#18 /Users/waimun/Documents/www/directus/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord('2', Array, Array)\r\n#19 /Users/waimun/Documents/www/directus/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update('edm', '2', Array, Array)\r\n#20 [internal function]: Directus\\Api\\Routes\\Items->update(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Array)\r\n#21 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func(Array, Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Array)\r\n#22 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke(Array, Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Array)\r\n#23 /Users/waimun/Documents/www/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#24 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Slim\\Route))\r\n#25 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\UserRateLimitMiddleware), Array)\r\n#26 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Slim\\Route))\r\n#27 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Slim\\Route))\r\n#28 /Users/waimun/Documents/www/directus/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#29 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#30 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware), Array)\r\n#31 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#32 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#33 /Users/waimun/Documents/www/directus/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#34 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#35 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware), Array)\r\n#36 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#37 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#38 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#39 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#40 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#41 /Users/waimun/Documents/www/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#42 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Directus\\Application\\Application))\r\n#43 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\IpRateLimitMiddleware), Array)\r\n#44 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Directus\\Application\\Application))\r\n#45 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Directus\\Application\\Application))\r\n#46 /Users/waimun/Documents/www/directus/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#47 /Users/waimun/Documents/www/directus/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#48 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#49 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\ProxyMiddleware), Array)\r\n#50 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#51 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#52 /Users/waimun/Documents/www/directus/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#53 [internal function]: RKA\\Middleware\\IpAddress->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#54 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(RKA\\Middleware\\IpAddress), Array)\r\n#55 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#56 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#57 /Users/waimun/Documents/www/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#58 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#59 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\CorsMiddleware), Array)\r\n#60 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#61 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#62 /Users/waimun/Documents/www/directus/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#63 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#64 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware), Array)\r\n#65 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#66 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure))\r\n#67 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#68 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#69 /Users/waimun/Documents/www/directus/vendor/slim/slim/Slim/App.php(313): Slim\\App->process(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response))\r\n#70 /Users/waimun/Documents/www/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run(false)\r\n#71 /Users/waimun/Documents/www/directus/public/index.php(5): Directus\\Application\\Application->run()\r\n#72 /Users/waimun/.composer/vendor/laravel/valet/server.php(158): require('/Users/waimun/D...')\r\n#73 {main} [] []\r\n```\r\n"},{"labels":["bug"],"text":"When we uploaded a video file (MP4) via the File Libary, the \"Duration\" property of the file isn't set. Neither can it be edited afterwards.  I'm logged in as an admin.\r\n\r\nThe only way to change the value appears to be editing the database record directly. Is it expected behavior? I can't seem to find much documentation about the duration property other than it is an integer.\r\n\r\n![image](https://user-images.githubusercontent.com/3039321/62893704-33a82380-bd19-11e9-9ebc-1ac981cbb979.png)\r\n\r\nThanks"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nThe settings which are not stored in the system and when tried to store it the first time then it is throwing internal server error. \r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'Global Settings'\r\n2. Try to store any value which is not stored in the system earlier.\r\n3. It throws the \"Internal Server error\"\r\n\r\n## Expected Behavior\r\nThe settings must be stored successfully.\r\n\r\n## Actual Behavior\r\nInternal error occurs\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 8.1\r\n- Web Server: Apache 2.4.33[WAMP]\r\n- PHP Version: 7.2.4\r\n- Database: MySQL 5.7.21\r\n- Install Method: Cloned master branch\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nUsing hooks within the API php file is no longer working.\r\n\r\n## Steps to Reproduce\r\n\r\n`'item.create.devices:before' => function (\\Directus\\Hook\\Payload $payload) {\r\n                    $payload->set('name','test');\r\n                    return $payload`\r\n\r\n1. Go to Devices collection.\r\n2. Click on + to add a new device item.\r\n3. Create the item with no value for the name field.\r\n4. Item is created successfully without error but the name is not set to 'test' it remains empty.\r\n\r\n## Expected Behavior\r\nhttps://docs.directus.io/extensions/hooks.html#creating-hooks\r\n\r\nitem.create hook should allow me to set the name to test by altering the payload.\r\n## Actual Behavior\r\nNo value is set for the name text field.\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10\r\n- Install Method: cloned master branch of directus\r\n- Version: Spouting Whale ‚Äî (190807A)\r\n"},{"labels":["bug"],"text":"I go to admin->users and put in a new clear text password an hit \"save\". The passwort is hashed and saved in the database. If i try to login with the new password i get the error \"invalid user credentials\"?\r\nAnother thing i want to know: how is the user password encrypted? I would like to set a custom user password over the api. I tried bcrypt but it doesn't match!?\r\nThanks for your help!"},{"labels":["bug"],"text":"# Bug Report\r\nAfter updating timezone in `api.php` of config; not able to store the time of that timezone in DB.\r\n## Steps to Reproduce\r\n\r\n1. Go to 'api.php' config\r\n2. Update the `timezone`\r\n3. Store any collection record\r\n4. Check the `created_on` field with Datetime Created interface.\r\n\r\n## Expected Behavior\r\nIt must store the time of the `timezone` which have been set in config file.\r\n\r\n## Actual Behavior\r\nIt is store in `UTC` timezone instead of the updated one.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS\r\n- Web Server: Apache \r\n- PHP Version: 7.2.14\r\n- Database: MySQL 5.7.25\r\n- Install Method: Cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\nAdd new `M2M` field with passing `primary-key`, throw error `Item Not Found`\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create Collection `Product` with string primary key\r\n2. Create Collection `Category` with string primary key\r\n3. Add `M2M` field in `Product` collection to map it with `Category` collection\r\n4. Try to add a new `Category` from `Product` create form\r\n5. It will throw an error that \"Item with id \"ABC\" not found\".\r\n\r\n## Expected Behavior\r\nThe new item must be stored with a given ID.\r\n\r\n## Actual Behavior\r\nIt's trying to fetch the item of ID from given payload which causes the error.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 8.1\r\n- Web Server: Apache 2.4.33[WAMP]\r\n- PHP Version: 7.2.4\r\n- Database: MySQL 5.7.21\r\n- Install Method: Cloned master branch"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nI'm not sure if it is a bug - I guess it is a configuration issue but I'm not sure. After creating a fresh directus setup, installing the database and creating an admin user using the cli I tried to login and get permission denied / unauthenticated errors on different directus versions.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Setup a new standalone directus api and app using docker-compose:\r\n```yml\r\ndirectus-api:\r\n  image: \"development/directus-api:2.4.0-development\" \r\n  build:\r\n    context: ./directus-api/\r\n    args:\r\n      DIRECTUS_API_VERSION: 2.4.0\r\n  environment:\r\n    APP_ENV: development\r\n    DATABASE_HOST: mysql\r\n    DATABASE_NAME: $MYSQL__DATABASE\r\n    DATABASE_USERNAME: $MYSQL__DATABASE_USERNAME\r\n    DATABASE_PASSWORD: $MYSQL__DATABASE_PASSWORD\r\n    APP_TIMEZONE: UTC\r\n\r\ndirectus-app:\r\n  image: \"development/directus-app:7.9.0-development\"\r\n  build:\r\n    context: ./directus-app/\r\n    args:\r\n      DIRECTUS_APP_VERSION: 7.9.0\r\n  environment:\r\n    API_ENDPOINT_TEST: \"Test; http://api.localhost/_/\"\r\n\r\nmysql:\r\n  image: mysql:5.7\r\n  environment:\r\n    MYSQL_DATABASE: $MYSQL__DATABASE\r\n    MYSQL_ROOT_PASSWORD: $MYSQL__DATABASE_ROOT_PASSWORD\r\n    MYSQL_USER: $MYSQL__DATABASE_USERNAME\r\n    MYSQL_PASSWORD: $MYSQL__DATABASE_PASSWORD\r\n  volumes:\r\n    - mysql-data:/var/lib/mysql\r\n```\r\n2. Install database and create user using the cli:\r\n```bash\r\n$ docker-compose exec directus-api ./bin/directus install:database\r\n$ docker-compose exec directus-api ./bin/directus install:install -e admin@test.de -p admin -t \"Test\"\r\n```\r\n3. Login with the newly created admin user, which works, but ...\r\n4. See error in browser console ‚Äì¬†no server logs are written:\r\n```\r\nFailed to load resource: the server responded with a status of 404 (Not Found)\r\napi.localhost/_/users/me?fields=last_page:1 Failed to load resource: the server responded with a status of 404 (Not Found)\r\nerror.js:9 Objectclass: \"Directus\\Database\\Exception\\ItemNotFoundException\"code: 203file: \"/var/www/html/src/core/Directus/Services/ItemsService.php\"line: 139message: \"Item not found\"__proto__: Object\r\nBu @ error.js:9\r\napi.localhost/layouts:1 Failed to load resource: the server responded with a status of 401 (Unauthorized)\r\nhydrate.js:52 Object\r\n(anonymous) @ hydrate.js:52\r\napi.localhost/_/users/me?fields%5B0%5D=id&fields%5B1%5D=avatar.%2A&fields%5B2%5D=email&fields%5B3%5D=first_name&fields%5B4%5D=last_name&fields%5B5%5D=locale&fields%5B6%5D=roles.%2A.%2A:1 Failed to load resource: the server responded with a status of 404 (Not Found)\r\napi.localhost/_/settings:1 Failed to load resource: the server responded with a status of 403 (Forbidden)\r\napi.localhost/interfaces:1 Failed to load resource: the server responded with a status of 401 (Unauthorized)\r\napi.localhost/_/collections:1 Failed to load resource: the server responded with a status of 403 (Forbidden)\r\napi.localhost/_/users?fields%5B0%5D=id&fields%5B1%5D=first_name&fields%5B2%5D=last_name&fields%5B3%5D=title&fields%5B4%5D=status&fields%5B5%5D=timezone&fields%5B6%5D=roles.%2A&fields%5B7%5D=avatar.%2A&fields%5B8%5D=company:1 Failed to load resource: the server responded with a status of 403 (Forbidden)\r\napi.localhost/pages:1 Failed to load resource: the server responded with a status of 401 (Unauthorized)\r\napi.localhost/:1 Failed to load resource: the server responded with a status of 401 (Unauthorized)\r\n/#/collections:1 Uncaught (in promise) Object\r\napi.localhost/_/relations?limit=-1:1 Failed to load resource: the server responded with a status of 403 (Forbidden)\r\napi.localhost/_/collection_presets?filter%5Btitle%5D%5Bnnull%5D=1&filter%5Buser%5D%5Bnull%5D=1:1 Failed to load resource: the server responded with a status of 403 (Forbidden)\r\napi.localhost/_/collection_presets?filter%5Btitle%5D%5Bnnull%5D=1&filter%5Buser%5D%5Beq%5D=1:1 Failed to load resource: the server responded with a status of 403 (Forbidden)\r\n```\r\n\r\n## Expected Behavior\r\nAs the authentication seems to work ‚Äì authentication header is set with Barer Token ‚Äì I expect the site to run. But I don't get why there are authentication issues. I checked if the admin users exists in the database: YES. I checked if the database user have proper permissions on the database: YES. I checked the file permissions: YES.\r\n\r\nBut I don't get why it does not start. It is not an issue with ap 2.4.0, I had it on 2.3.0 too. So maybe I did something wrong but I don't have a clue what is missing?\r\n\r\n## Actual Behavior\r\nGet a lot of authentication errors.\r\n\r\n## Other Context & Screenshots\r\nSee video:\r\nhttps://www.loom.com/share/4adb69ed2f6e417fa27d1a01649a17b1\r\n\r\n\r\n## Technical Details\r\n\r\n- Web Server: Apache\r\n- PHP Version: 7.3.6\r\n- Database: MySQL 5.7\r\n- Install Method: cloned master branch\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n* Fresh install of v2.4.0\r\n* Create a collection\r\n* Add a text field with unique enabled\r\n* Modify the text field to disable unique\r\n\r\n## Expected Behavior\r\n\r\nThe unique of field should be removed.\r\n\r\n## Actual Behavior\r\n\r\nThe field is still unique.\r\n\r\n## Other Context & Screenshots\r\n\r\n[Screen recording](https://drive.google.com/file/d/1vs5w7fXlYhwfXKUFa8HZv0DZU0cgcwQG/view?usp=sharing)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.2.26\r\n- Install Method: v2.4.0 build\r\n- Directus App: 7.9.0\r\n"},{"labels":["bug"],"text":"I'm trying out the mail function on a new project. I noticed that the mails are sent directly to the actual live email instead of the target host.\r\n\r\nHere is my config:\r\n`'transport' => 'smtp',\r\n            'host' => 'smtp.mailtrap.io',`\r\n\r\nI have the same configuration on a different project but it works just fine. The difference that I see is that the one with issue is **php7.3** the other is **php7.2**.\r\n\r\nOS: Ubuntu 16.04\r\nPHP: 7.3\r\nDirectus: 2.3.0"},{"labels":["bug"],"text":"##### I just updated the latest version.\r\napp: v7.9\r\napi: v2.4\r\n\r\n### When I clicked the save button, the interface reported an error.\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/62713132-ccdfed00-ba2e-11e9-85c8-53335cabc011.png)\r\n\r\nBut when I click the Save button in another collection, it works.\r\nI'm sure that all collections worked before I updated the new version, \r\nbecause I added new software before I updated the new version\r\n\r\n<details><summary>See Code</summary>\r\n<p>\r\n\r\n```\r\n[2019-08-08 22:37:24] api[_].ERROR: ArgumentCountError: Too few arguments to function Directus\\Config\\Context::{closure}(), 1 passed and exactly 2 expected in /www/wwwroot/server/config/api.php:153\r\nStack trace:\r\n#0 [internal function]: Directus\\Config\\Context::{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(291): call_user_func_array\r\ndirectus/app#2 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\ndirectus/app#3 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run\r\ndirectus/app#4 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute\r\ndirectus/app#5 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1622): Directus\\Database\\TableGateway\\BaseTableGateway->runHook\r\ndirectus/app#6 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks\r\ndirectus/app#7 /www/wwwroot/server/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\ndirectus/app#8 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\ndirectus/app#10 /www/wwwroot/server/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\ndirectus/app#11 /www/wwwroot/server/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#12 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#13 /www/wwwroot/server/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\ndirectus/app#14 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#15 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#16 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#17 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#19 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#20 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}\r\ndirectus/app#21 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#22 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#24 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#25 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#26 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#27 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#28 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#29 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#30 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#31 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\ndirectus/app#32 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\ndirectus/app#33 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#34 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#35 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#37 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#38 /www/wwwroot/server/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#39 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#40 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#41 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#43 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#44 /www/wwwroot/server/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#45 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#46 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#48 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#49 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\ndirectus/app#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#51 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#53 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#54 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\ndirectus/app#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#56 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#57 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#58 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#59 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#60 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#61 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#62 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#63 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:37:56] api[_].ERROR: ArgumentCountError: Too few arguments to function Directus\\Config\\Context::{closure}(), 1 passed and exactly 2 expected in /www/wwwroot/server/config/api.php:153\r\nStack trace:\r\n#0 [internal function]: Directus\\Config\\Context::{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(291): call_user_func_array\r\ndirectus/app#2 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\ndirectus/app#3 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run\r\ndirectus/app#4 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute\r\ndirectus/app#5 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1622): Directus\\Database\\TableGateway\\BaseTableGateway->runHook\r\ndirectus/app#6 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks\r\ndirectus/app#7 /www/wwwroot/server/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\ndirectus/app#8 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\ndirectus/app#10 /www/wwwroot/server/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\ndirectus/app#11 /www/wwwroot/server/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#12 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#13 /www/wwwroot/server/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\ndirectus/app#14 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#15 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#16 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#17 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#19 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#20 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}\r\ndirectus/app#21 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#22 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#24 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#25 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#26 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#27 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#28 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#29 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#30 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#31 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\ndirectus/app#32 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\ndirectus/app#33 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#34 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#35 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#37 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#38 /www/wwwroot/server/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#39 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#40 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#41 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#43 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#44 /www/wwwroot/server/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#45 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#46 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#48 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#49 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\ndirectus/app#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#51 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#53 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#54 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\ndirectus/app#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#56 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#57 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#58 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#59 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#60 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#61 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#62 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#63 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:39:03] api[_].ERROR: ArgumentCountError: Too few arguments to function Directus\\Config\\Context::{closure}(), 1 passed and exactly 2 expected in /www/wwwroot/server/config/api.php:153\r\nStack trace:\r\n#0 [internal function]: Directus\\Config\\Context::{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(291): call_user_func_array\r\ndirectus/app#2 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\ndirectus/app#3 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run\r\ndirectus/app#4 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute\r\ndirectus/app#5 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1622): Directus\\Database\\TableGateway\\BaseTableGateway->runHook\r\ndirectus/app#6 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks\r\ndirectus/app#7 /www/wwwroot/server/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\ndirectus/app#8 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\ndirectus/app#10 /www/wwwroot/server/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\ndirectus/app#11 /www/wwwroot/server/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#12 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#13 /www/wwwroot/server/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\ndirectus/app#14 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#15 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#16 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#17 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#19 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#20 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}\r\ndirectus/app#21 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#22 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#24 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#25 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#26 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#27 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#28 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#29 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#30 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#31 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\ndirectus/app#32 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\ndirectus/app#33 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#34 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#35 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#37 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#38 /www/wwwroot/server/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#39 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#40 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#41 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#43 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#44 /www/wwwroot/server/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#45 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#46 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#48 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#49 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\ndirectus/app#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#51 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#53 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#54 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\ndirectus/app#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#56 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#57 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#58 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#59 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#60 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#61 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#62 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#63 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:39:33] api[_].ERROR: ArgumentCountError: Too few arguments to function Directus\\Config\\Context::{closure}(), 1 passed and exactly 2 expected in /www/wwwroot/server/config/api.php:153\r\nStack trace:\r\n#0 [internal function]: Directus\\Config\\Context::{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(291): call_user_func_array\r\ndirectus/app#2 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\ndirectus/app#3 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run\r\ndirectus/app#4 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute\r\ndirectus/app#5 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1622): Directus\\Database\\TableGateway\\BaseTableGateway->runHook\r\ndirectus/app#6 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks\r\ndirectus/app#7 /www/wwwroot/server/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\ndirectus/app#8 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\ndirectus/app#10 /www/wwwroot/server/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\ndirectus/app#11 /www/wwwroot/server/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#12 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#13 /www/wwwroot/server/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\ndirectus/app#14 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#15 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#16 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#17 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#19 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#20 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}\r\ndirectus/app#21 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#22 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#24 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#25 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#26 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#27 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#28 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#29 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#30 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#31 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\ndirectus/app#32 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\ndirectus/app#33 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#34 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#35 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#37 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#38 /www/wwwroot/server/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#39 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#40 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#41 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#43 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#44 /www/wwwroot/server/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#45 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#46 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#48 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#49 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\ndirectus/app#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#51 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#53 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#54 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\ndirectus/app#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#56 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#57 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#58 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#59 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#60 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#61 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#62 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#63 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:39:47] api[_].ERROR: ArgumentCountError: Too few arguments to function Directus\\Config\\Context::{closure}(), 1 passed and exactly 2 expected in /www/wwwroot/server/config/api.php:153\r\nStack trace:\r\n#0 [internal function]: Directus\\Config\\Context::{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(291): call_user_func_array\r\ndirectus/app#2 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\ndirectus/app#3 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run\r\ndirectus/app#4 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute\r\ndirectus/app#5 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1622): Directus\\Database\\TableGateway\\BaseTableGateway->runHook\r\ndirectus/app#6 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks\r\ndirectus/app#7 /www/wwwroot/server/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\ndirectus/app#8 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\ndirectus/app#10 /www/wwwroot/server/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\ndirectus/app#11 /www/wwwroot/server/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#12 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#13 /www/wwwroot/server/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\ndirectus/app#14 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#15 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#16 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#17 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#19 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#20 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}\r\ndirectus/app#21 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#22 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#24 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#25 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#26 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#27 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#28 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#29 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#30 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#31 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\ndirectus/app#32 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\ndirectus/app#33 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#34 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#35 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#37 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#38 /www/wwwroot/server/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#39 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#40 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#41 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#43 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#44 /www/wwwroot/server/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#45 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#46 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#48 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#49 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\ndirectus/app#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#51 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#53 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#54 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\ndirectus/app#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#56 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#57 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#58 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#59 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#60 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#61 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#62 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#63 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:43:07] api[].ERROR: Directus\\Exception\\UnauthorizedException: Unauthorized request in /www/wwwroot/server/src/helpers/app.php:268\r\nStack trace:\r\n#0 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(530): Directus\\{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->__invoke\r\ndirectus/app#2 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#3 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#4 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#5 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#6 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#7 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#8 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#10 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:43:47] api[_].ERROR: ArgumentCountError: Too few arguments to function Directus\\Config\\Context::{closure}(), 1 passed and exactly 2 expected in /www/wwwroot/server/config/api.php:153\r\nStack trace:\r\n#0 [internal function]: Directus\\Config\\Context::{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(291): call_user_func_array\r\ndirectus/app#2 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\ndirectus/app#3 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run\r\ndirectus/app#4 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute\r\ndirectus/app#5 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1622): Directus\\Database\\TableGateway\\BaseTableGateway->runHook\r\ndirectus/app#6 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks\r\ndirectus/app#7 /www/wwwroot/server/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\ndirectus/app#8 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\ndirectus/app#10 /www/wwwroot/server/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\ndirectus/app#11 /www/wwwroot/server/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#12 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#13 /www/wwwroot/server/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\ndirectus/app#14 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#15 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#16 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#17 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#19 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#20 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}\r\ndirectus/app#21 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#22 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#24 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#25 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#26 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#27 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#28 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#29 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#30 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#31 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\ndirectus/app#32 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\ndirectus/app#33 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#34 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#35 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#37 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#38 /www/wwwroot/server/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#39 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#40 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#41 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#43 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#44 /www/wwwroot/server/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#45 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#46 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#48 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#49 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\ndirectus/app#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#51 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#53 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#54 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\ndirectus/app#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#56 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#57 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#58 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#59 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#60 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#61 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#62 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#63 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:43:55] api[_].ERROR: ArgumentCountError: Too few arguments to function Directus\\Config\\Context::{closure}(), 1 passed and exactly 2 expected in /www/wwwroot/server/config/api.php:153\r\nStack trace:\r\n#0 [internal function]: Directus\\Config\\Context::{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(291): call_user_func_array\r\ndirectus/app#2 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\ndirectus/app#3 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run\r\ndirectus/app#4 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute\r\ndirectus/app#5 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1622): Directus\\Database\\TableGateway\\BaseTableGateway->runHook\r\ndirectus/app#6 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks\r\ndirectus/app#7 /www/wwwroot/server/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\ndirectus/app#8 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\ndirectus/app#10 /www/wwwroot/server/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\ndirectus/app#11 /www/wwwroot/server/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#12 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#13 /www/wwwroot/server/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\ndirectus/app#14 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#15 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#16 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#17 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#19 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#20 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}\r\ndirectus/app#21 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#22 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#24 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#25 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#26 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#27 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#28 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#29 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#30 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#31 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\ndirectus/app#32 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\ndirectus/app#33 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#34 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#35 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#37 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#38 /www/wwwroot/server/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#39 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#40 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#41 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#43 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#44 /www/wwwroot/server/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#45 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#46 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#48 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#49 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\ndirectus/app#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#51 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#53 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#54 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\ndirectus/app#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#56 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#57 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#58 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#59 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#60 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#61 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#62 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#63 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:43:56] api[_].ERROR: ArgumentCountError: Too few arguments to function Directus\\Config\\Context::{closure}(), 1 passed and exactly 2 expected in /www/wwwroot/server/config/api.php:153\r\nStack trace:\r\n#0 [internal function]: Directus\\Config\\Context::{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(291): call_user_func_array\r\ndirectus/app#2 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(119): Directus\\Hook\\Emitter->executeListeners\r\ndirectus/app#3 /www/wwwroot/server/src/core/Directus/Hook/Emitter.php(130): Directus\\Hook\\Emitter->run\r\ndirectus/app#4 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1529): Directus\\Hook\\Emitter->execute\r\ndirectus/app#5 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1622): Directus\\Database\\TableGateway\\BaseTableGateway->runHook\r\ndirectus/app#6 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(878): Directus\\Database\\TableGateway\\BaseTableGateway->runAfterUpdateHooks\r\ndirectus/app#7 /www/wwwroot/server/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\ndirectus/app#8 /www/wwwroot/server/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\ndirectus/app#10 /www/wwwroot/server/src/core/Directus/Services/ItemsService.php(338): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\ndirectus/app#11 /www/wwwroot/server/src/endpoints/Items.php(121): Directus\\Services\\ItemsService->update\r\ndirectus/app#12 [internal function]: Directus\\Api\\Routes\\Items->update\r\ndirectus/app#13 /www/wwwroot/server/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\ndirectus/app#14 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\ndirectus/app#15 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\ndirectus/app#16 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#17 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#18 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#19 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#20 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(105): Slim\\Route->Slim\\{closure}\r\ndirectus/app#21 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\ndirectus/app#22 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#23 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#24 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#25 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\ndirectus/app#26 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\ndirectus/app#27 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#28 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#29 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#30 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\ndirectus/app#31 /www/wwwroot/server/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\ndirectus/app#32 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\ndirectus/app#33 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\ndirectus/app#34 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\ndirectus/app#35 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#36 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#37 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#38 /www/wwwroot/server/vendor/directus/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\ndirectus/app#39 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\ndirectus/app#40 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\ndirectus/app#41 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#42 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#43 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#44 /www/wwwroot/server/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\ndirectus/app#45 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\ndirectus/app#46 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#47 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#48 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#49 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\ndirectus/app#50 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#51 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#52 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#53 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#54 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(54): Slim\\App->Slim\\{closure}\r\ndirectus/app#55 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\ndirectus/app#56 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#57 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#58 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#59 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#60 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#61 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#62 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#63 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:44:57] api[].ERROR: Directus\\Exception\\UnauthorizedException: Unauthorized request in /www/wwwroot/server/src/helpers/app.php:268\r\nStack trace:\r\n#0 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(530): Directus\\{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->__invoke\r\ndirectus/app#2 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#3 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#4 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#5 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#6 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#7 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#8 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#10 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n[2019-08-08 22:44:57] api[].ERROR: Directus\\Exception\\UnauthorizedException: Unauthorized request in /www/wwwroot/server/src/helpers/app.php:268\r\nStack trace:\r\n#0 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(530): Directus\\{closure}\r\ndirectus/app#1 /www/wwwroot/server/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->__invoke\r\ndirectus/app#2 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\ndirectus/app#3 /www/wwwroot/server/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\ndirectus/app#4 [internal function]: Slim\\DeferredCallable->__invoke\r\ndirectus/app#5 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\ndirectus/app#6 /www/wwwroot/server/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\ndirectus/app#7 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\ndirectus/app#8 /www/wwwroot/server/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\ndirectus/app#9 /www/wwwroot/server/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\ndirectus/app#10 /www/wwwroot/server/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n\r\n</p>\r\n</details>"},{"labels":["bug"],"text":"## Bug Report\r\n\r\nWhen creating a M2M pointing to directus_users, a new entry in the related table cannot be stored due to a validation error on directus_users (password should not be blank).\r\n\r\nHowever, since I want to create a new entry in the related table (message in my case), no validation rule of directus_users should apply. Apart from that the password of admin@example.com is not null.\r\n\r\nHappens also on a clean checkout of latest version.\r\n\r\n<img width=\"1074\" alt=\"Annotation 2019-08-05 231640\" src=\"https://user-images.githubusercontent.com/10274479/62495977-d6234c80-b7d7-11e9-84a2-ef68037f373c.png\">\r\n\r\n`{code: 4, message: \"password: This value should not be blank.\", class: \"Directus\\Validator\\Exception\\InvalidRequestException\", file: \"/var/www/directus/src/core/Directus/Services/AbstractService.php\", line: 186}`\r\n\r\n### Steps to reproduce\r\n\r\n1. Create new table message\r\n2. Create new M2M relation to directus_users (auto generate junction table)\r\n3. Create a new message with at least one user selected and then save\r\n\r\n<img width=\"510\" alt=\"Annotation 2019-08-05 230401\" src=\"https://user-images.githubusercontent.com/10274479/62495986-dcb1c400-b7d7-11e9-8979-df23dcf1ec65.png\">\r\n\r\n## Technical Details\r\n\r\nDevice: [Virtual Server]\r\nOS: [Ubuntu 18.04]\r\nWeb Server: [Apache 2.4.29]\r\nPHP Version: [7.2.19]\r\nDatabase: [5.7.27]\r\nAPI Version: [2.3.1]\r\nAPP Version: [7.8.0]\r\n\r\nClient:\r\nDevice: [Desktop, Chrome 75.0.3770.142]\r\nOS: [Windows 10 1809]"},{"labels":["bug",null],"text":"The `/projects` endpoint allows you to configure a lot of the fields in the config file, except for the `settings->logger->path` variable. This combined with https://github.com/directus/api/issues/1178 results in the fact that newly created projects may or may not be able to write logs.\r\n\r\nhttps://github.com/directus/api/blob/f542f2f458825709dcb9e9ebe3ceb39e5af5350d/src/core/Directus/Util/Installation/InstallerUtils.php#L873-L939\r\n\r\nI've tagged it both a bug and a feature request, as the `/projects` endpoint is pretty useless if a newly created project can't work."},{"labels":["bug"],"text":"This default path:\r\n\r\nhttps://github.com/directus/api/blob/f542f2f458825709dcb9e9ebe3ceb39e5af5350d/src/core/Directus/Util/Installation/stubs/config.stub#L11\r\n\r\nwill result in `Caught exception: Invalid Configuration for logger \"path\" variable.` every time a log is written. I think the `/../` in the path might be invalid. \r\n\r\nFor the \"default\" project `_`, the log path is set to `'path' => __DIR__ . '/logs/app.log',` by default. This means that the logs are actually written _in_ the `config` folder, which is also not desirable...\r\n\r\nWe should change the default version to be `/logs/ <project_name >/`, and use `/logs/_/` as the path for the default project."},{"labels":["bug"],"text":"When uploading a file, the `filename` should follow the naming convention (eg: original, id, etc)... but the `title` should always save a cleaned up version of the uploaded file name (not the NEW filename).\r\n\r\nYou can see below that the `title` is being set tot the same string as the `filename`...\r\n![Screen Shot 2019-08-05 at 3 03 39 PM](https://user-images.githubusercontent.com/522079/62488533-7bb3cd00-b792-11e9-92ae-3c208ceecfc6.png)\r\n\r\nBut `title` should have been set to:\r\n\r\n`Clouds Floating Over Himalaya Mountains`\r\n\r\nFrom this original file name:\r\n`Clouds-floating-over-himalaya-mountains.gif`\r\n\r\nWe should use the standard Directus Title Formatter for this (same as used on Field/Collection names) after stripping the extension."},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n* Fresh install of v2.3.1\r\n* Create `members` collection with `name` text field\r\n* Create `projects` collection with `name` text field and `members` O2M relationship such that collection fields look like this:\r\n![image](https://user-images.githubusercontent.com/3615746/62382266-c7425d00-b57f-11e9-8092-e3e1e288b880.png)\r\n\r\n* And the members O2M relation properties look like this:\r\n![image](https://user-images.githubusercontent.com/3615746/62382678-a3cbe200-b580-11e9-9b96-17128e8fcac4.png)\r\n\r\n* Now create TWO `member` items via `project` creation form\r\n![image](https://user-images.githubusercontent.com/3615746/62382777-dd9ce880-b580-11e9-89c4-f5f08f4bc51f.png)\r\n\r\n* Save the `project` item\r\n* Check the saved `project` item and you will see only 1 `member` item.\r\n\r\n## Expected Behavior\r\n\r\nTWO members created should display\r\n\r\n## Actual Behavior\r\n\r\nOnly one member is displayed.\r\n\r\n## Other Context & Screenshots\r\n\r\nYou can contact me for the screenrecording\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.1.40\r\n- Install Method: v2.3.1 build\r\n- Directus App: 7.8.0\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n* Fresh install of v2.3.1\r\n* Create `status_test` collection without the `status` field\r\n* Create `status` field using the `status` field type and make it required.\r\n* Add an item.\r\n\r\nHere's [screen recording](https://drive.google.com/file/d/15ZbkDsAPmRN8yX7guHS_WnTsHdKTDN57/view?usp=sharing)\r\n\r\n## Expected Behavior\r\n\r\n* There should be an error saying that Status field is required.\r\n\r\n## Actual Behavior\r\n\r\n* It says Item saved. BUT it is not displayed in the list of items for that collection.\r\n\r\n## Other Context & Screenshots\r\n\r\nThe item is actually saved in the database but the `status` value in db is `raf`.\r\n\r\n![image](https://user-images.githubusercontent.com/3615746/62364205-80d70900-b553-11e9-9c76-67426bf44ad2.png)\r\n\r\nHere's the field structure:\r\n\r\n```json\r\n{\r\n  \"type\": \"status\",\r\n  \"datatype\": \"VARCHAR\",\r\n  \"length\": 20,\r\n  \"field\": \"status\",\r\n  \"interface\": \"status\",\r\n  \"default_value\": \"draft\",\r\n  \"width\": \"full\",\r\n  \"options\": {\r\n    \"status_mapping\": {\r\n      \"published\": {\r\n        \"name\": \"Published\",\r\n        \"value\": \"published\",\r\n        \"text_color\": \"white\",\r\n        \"background_color\": \"accent\",\r\n        \"browse_subdued\": false,\r\n        \"browse_badge\": true,\r\n        \"soft_delete\": false,\r\n        \"published\": true\r\n      },\r\n      \"draft\": {\r\n        \"name\": \"Draft\",\r\n        \"value\": \"draft\",\r\n        \"text_color\": \"white\",\r\n        \"background_color\": \"blue-grey-100\",\r\n        \"browse_subdued\": true,\r\n        \"browse_badge\": true,\r\n        \"soft_delete\": false,\r\n        \"published\": false\r\n      },\r\n      \"deleted\": {\r\n        \"name\": \"Deleted\",\r\n        \"value\": \"deleted\",\r\n        \"text_color\": \"white\",\r\n        \"background_color\": \"red\",\r\n        \"browse_subdued\": true,\r\n        \"browse_badge\": true,\r\n        \"soft_delete\": true,\r\n        \"published\": false\r\n      }\r\n    }\r\n  },\r\n  \"required\": true\r\n}\r\n```\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.1.40\r\n- Install Method: v2.3.1 build\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Clone the repository\r\n2. Go to your Directus url /admin\r\n3. Create new project\r\n4. Error in PHP : PHP Parse error:  syntax error, unexpected ';', expecting ']' in \\www\\directus\\config\\api.php on line 150\r\n\r\n## Expected Behavior\r\n\r\nDirectus should generate a proper secret key\r\n\r\n## Actual Behavior\r\n\r\nSecret key generated contains ' caracters inside\r\n\r\nexample : 'secret_key' => 'K${^>rs)aBkNs%K'SIo8ureBQ'Oa,fa3o9C',\r\n                                                                       ^               ^\r\n\r\nTHAT cause an syntax error.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device:  Desktop\r\n- OS:  Windows 10.1803\r\n- Web Server:  Apache 2.4.35\r\n- PHP Version: 7.3.3\r\n- Database:  MySQL 5.7.24\r\n- Install Method:  cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\nMake a graphql query like the following one\r\n```\r\nquery {\r\n  page_home(lang: \"es-es\") {\r\n    data {\r\n      header {\r\n        id,\r\n        name\r\n        logo_image {\r\n          id,\r\n          name\r\n        },\r\n          menu {\r\n          id,\r\n          name,\r\n          elements {\r\n            name\r\n          }\r\n        }\r\n      },\r\n      footer {\r\n        name,\r\n        columns {\r\n          id,\r\n          name\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n## Expected Behavior\r\nThe data is returned properly.\r\n\r\n## Actual Behavior\r\nReceive an error for every relationship that is marked as required (even though we don't request it). \r\n```\r\n{\r\n \"error\": {\r\n   \"code\": null,\r\n   \"message\": \"Expected {\\\"type\\\":\\\"[CBannerSlideItem]\\\",\\\"resolve\\\":{}} to be a GraphQL nullable type.\"\r\n }\r\n}\r\n```\r\nAfer removing the required, that part works properly.\r\nBut then, in the queried part that follows, the `elements` doesn't return any field and is not of the expected collection type (is of the type CTA that appears in the screenshot. You can discover so by which fields you request even though they are not returned). This also happens with other relationships.\r\n```\r\nmenu {\r\n id,\r\n name,\r\n slice,\r\n elements {\r\n   name\r\n}\r\n```\r\n\r\nResponse: \r\n```\r\n{\r\n  \"data\": {\r\n    \"page_home\": {\r\n      \"data\": [\r\n        {\r\n          \"header\": {\r\n            \"id\": \"1\",\r\n            \"name\": \"Standard header\",\r\n            \"logo_image\": {\r\n              \"id\": \"17\",\r\n              \"name\": \"logo tous\"\r\n            },\r\n            \"menu\": {\r\n              \"id\": \"1\",\r\n              \"name\": \"Main header menu\",\r\n              \"elements\": []\r\n            }\r\n          },\r\n          \"footer\": {\r\n            \"name\": \"Standard footer\",\r\n            \"columns\": []\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n![Screenshot of the field in question](https://user-images.githubusercontent.com/9975630/62196681-c2628b00-b37e-11e9-8a56-6051953a3151.png)\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows\r\n- Web Server: [eg: Apache 2.4.37]\r\n- PHP Version: [eg: 7.2.0]\r\n- Database: [eg: MySQL 8.0.12]\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"Steps to reproduce:\r\n1. Create Table with Files Field and use the auto-generate mehod for it.\r\n2. Try to add File(s)\r\nResult:\r\n![image](https://user-images.githubusercontent.com/6115966/62069728-38f57080-b239-11e9-9f23-9da6346e4fec.png)\r\n\r\n\"filename: This value should not be blank. uploaded_by: This value should not be blank. uploaded_on: This value should not be blank.\"\r\n\r\nSeems like the connected File Table is not receiving the correct Query.\r\nThe File(s) get uploaded though.\r\n\r\nDirectus v7.8.0\r\nPHP Zend Engine v3.3.7 with Zend OPcache v7.3.7-1+ubuntu18.04.1+deb.sury.org+1, Copyright (c)\r\nNginx Server\r\nOS: Ubuntu"},{"labels":[null,"bug",null],"text":"I have the following Setup:\r\nNginx Server\r\nwith 2 nearly identical configs. Where both have a maximum upload body set.\r\n(Nginx conf: https://pastebin.com/PpaDsrdR)\r\n\r\nThe Suite is directus.benjamin-krippner.de\r\nThe App is admin.benjamin-krippner.de\r\n\r\nI installed the Suite and made a second instance of the App only in another folder. (To test for the \"Server Problem\" bug)\r\n\r\nSo far everything works, except for the File size in File dialogs. It stays at Max 0 B in the dialog and uploading a file seems to fail.\r\n\r\n![image](https://user-images.githubusercontent.com/6115966/62067006-021c5c00-b233-11e9-9125-8ef0af6588e5.png)\r\n\r\nI tried fiddling around with CORS, but it doesn't seem like i can easily change this error, altrough i don't think this is the actual issue(This is the log on admin.benjamin-krippner.de where the max size is 0B):\r\n![image](https://user-images.githubusercontent.com/6115966/62067061-1f512a80-b233-11e9-8a52-d05339508fa8.png)\r\n\r\nThings i tried:\r\n- Setting permissions a second time.\r\n- Setting the Max File Size in the Admin Interface\r\n- Tried to change relative to absolute URLs in the config file of the App\r\n- Checking config files i could check\r\n- Checking the docs for anything related to file size. \r\n- Checking the issues (i found a docker related issue, which doesn't seem to fit into this issue)\r\n\r\nDirectus v7.8.0\r\nPHP Zend Engine v3.3.7 with Zend OPcache v7.3.7-1+ubuntu18.04.1+deb.sury.org+1, Copyright (c)\r\nNginx Server\r\nOS: Ubuntu"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Configure rudimentary tables where one has an M2M field with defaults.\r\n2. POST request to API i.e. /database/collection/items with payload `{ \"filename\": \"test.txt\", \"categories\": [407, 406] }`\r\n\r\nResponse:\r\n```\r\n{\r\n  \"error\": {\r\n    \"code\": null,\r\n    \"message\": \"Internal Server Error\"\r\n  }\r\n}\r\n```\r\n\r\n## Actual Behavior\r\n\r\nRequest returns \"Internal Server Error\"\r\n\r\n## Other Context & Screenshots\r\n\r\n- No errors recorded by nginx.\r\n- From the Directus log:\r\n\r\n```\r\n[2019-07-26 23:16:37] api[].ERROR: Directus\\Exception\\UnauthorizedException: Unauthorized request in /server/html/directus/src/helpers/app.php:270\r\nStack trace:\r\n#0 /server/html/directus/vendor/slim/slim/Slim/App.php(530): Directus\\{closure}\r\n#1 /server/html/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->__invoke\r\n#2 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#3 /server/html/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#4 [internal function]: Slim\\DeferredCallable->__invoke\r\n#5 /server/html/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#6 /server/html/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#7 /server/html/directus/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\n#8 /server/html/directus/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\n#9 /server/html/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#10 /server/html/directus/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n- **removing the M2M field from the payload results in a successful request**\r\n\r\n## Technical Details\r\n\r\n- Web Server: nginx 1.14.0\r\n- PHP Version: 7.2.17\r\n- Database: MySQL 8\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nSuccessfully uploaded Logo but image preview is broken.\r\n\r\n![image](https://user-images.githubusercontent.com/3615746/61996665-54da0480-b0c9-11e9-9cff-f47046cd07ae.png)\r\n\r\n## Steps to Reproduce\r\n\r\n* Fresh install of v2.3.0\r\n* Upload logo in settings\r\n\r\n## Expected Behavior\r\n\r\nAfter successful upload, it should display the preview of the uploaded image.\r\n\r\n## Actual Behavior\r\n\r\nSuccessfully uploaded but broken image preview. (this behavior also happens on normal image uploads in a collection)\r\n\r\n## Other Context & Screenshots\r\n\r\nInstall method\r\n\r\n- Download [api-build-v2.3.0.zip](https://github.com/directus/api/releases/download/v2.3.0/api-build-v2.3.0.zip)\r\n- Extract and do `git init` to initialize repo\r\n- Push it to remote (gitlab, github, etc).\r\n- Clone your repo to your web server\r\n- [Install directus properly](https://docs.directus.io/advanced/api/standalone.html#installation)\r\n- Once installed successfully, Do the steps to reproduce above\r\n\r\n*Cause*\r\n\r\nThe cause of the bug is that when cloned in the web server, the `public/uploads/_/originals/.htaccess` is missing as you can see in this [sample repo in gitlab](https://gitlab.com/JbalTero/directus-api-bug/tree/master/public), the uploads dir is missing.\r\n\r\nIt is easily fixed by manually uploading the .htaccess.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.1.40\r\n- Install Method: See above\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nUsing api v2.3.0, I did the uploading of `/_/files`. It went successfully but there's a php warning saying: `strpos() expects parameter 1 to be string, object given` when env is development. This does not happen if set to production.\r\n\r\n## Steps to Reproduce\r\n* Fresh install of v2.3.0\r\n* Set the `api.php` `env` to `development`\r\n* Upload a file [Using Base64 Content](https://docs.directus.io/api/reference.html#using-base64-content)\r\n\r\n## Expected Behavior\r\n\r\nThere should be no PHP warning\r\n\r\n## Actual Behavior\r\n\r\nResponse: \r\n```json\r\n{\r\n  \"data\": {\r\n    \"id\": 5,\r\n    \"storage\": \"local\",\r\n    \"filename\": \"5958a71a-bdc0-5d89-8150-5fd15e73f369-5.jpg\",\r\n    \"title\": \"5958a71a Bdc0 5d89 8150 5fd15e73f369 5\",\r\n    \"type\": \"image\\/jpeg\",\r\n    \"uploaded_by\": 1,\r\n    \"uploaded_on\": \"2019-07-27T14:33:30+00:00\",\r\n    \"charset\": \"binary\",\r\n    \"filesize\": 9625,\r\n    \"width\": 200,\r\n    \"height\": 200,\r\n    \"duration\": null,\r\n    \"embed\": null,\r\n    \"folder\": null,\r\n    \"description\": \"\",\r\n    \"location\": \"\",\r\n    \"tags\": [],\r\n    \"checksum\": \"bd6cc4d714c1bd46accf243f58e6f8ed\",\r\n    \"metadata\": null,\r\n    \"data\": {\r\n      \"full_url\": \"http:\\/\\/redacted\\/uploads\\/_\\/originals\\/5958a71a-bdc0-5d89-8150-5fd15e73f369-5.jpg\",\r\n      \"url\": \"\\/uploads\\/_\\/originals\\/5958a71a-bdc0-5d89-8150-5fd15e73f369-5.jpg\",\r\n      \"thumbnails\": [\r\n        {\r\n          \"url\": \"http:\\/\\/redacted\\/thumbnail\\/_\\/200\\/200\\/crop\\/good\\/5958a71a-bdc0-5d89-8150-5fd15e73f369-5.jpg\",\r\n          \"relative_url\": \"\\/thumbnail\\/_\\/200\\/200\\/crop\\/good\\/5958a71a-bdc0-5d89-8150-5fd15e73f369-5.jpg\",\r\n          \"dimension\": \"200x200\",\r\n          \"width\": 200,\r\n          \"height\": 200\r\n        }\r\n      ],\r\n      \"embed\": null\r\n    }\r\n  }\r\n}<br/><b>Warning</b>: strpos()expectsparameter1tobestring,\r\nobjectgivenin<b>/redacted/src/core/Directus/Filesystem/Files.php</b>online<b>693</b><br/><br/><b>Warning</b>: strpos()expectsparameter1tobestring,\r\nobjectgivenin<b>/redacted/src/core/Directus/Filesystem/Files.php</b>online<b>238</b><br/><br/><b>Warning</b>: base64_decode()expectsparameter1tobestring,\r\nobjectgivenin<b>/redacted/src/core/Directus/Filesystem/Files.php</b>online<b>243</b><br/><br/><b>Warning</b>: strlen()expectsparameter1tobestring,\r\nobjectgivenin<b>/redacted/src/core/Directus/Filesystem/Files.php</b>online<b>275</b><br/><br/><b>Warning</b>: strlen()expectsparameter1tobestring,\r\nobjectgivenin<b>/redacted/src/core/Directus/Filesystem/Files.php</b>online<b>277</b><br/>\r\n```\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Win 10  10.0.18362.145\r\n- Web Server: Apache/2.4.29\r\n- PHP Version: PHP 7.1.30\r\n- Database: 10.1.40\r\n- Install Method: Downloaded [build release](https://github.com/directus/api/releases/download/v2.3.0/api-build-v2.3.0.zip)\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. create a regular n:1 relation between two collections.\r\n2. use the items endpoint with filter to fetch from collection\r\n\r\n## Expected Behavior\r\nhttps://.../_/items/[collection1]?filter[collection2.id][eq]=3 -> returns for example 2 records from collection1\r\nhttps://../_items/[collection1]?filter[name][like]=test&filter[collection2.id][logical]=or&filter[collection2.id][eq]=3 -> also returns the two entries from collection1 \r\n\r\n## Actual Behavior\r\nhttps://.../_/items/[collection1]?filter[collection2.id][eq]=3 -> returns the 2 records from collection1 as expected\r\n\r\nhttps://../_items/[collection1]?filter[name][like]=test&filter[collection2.id][logical]=or&filter[collection2.id][eq]=3 -> does not return the 2 records\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- API: 2.3.0\r\n- APP: 7.7.0\r\n- Install Method: build branch\r\n"},{"labels":["bug",null],"text":"In Admin settings > Global settings > Field : Default Limit\r\nThe tool tip say: \r\n\r\n> \"How many minutes before an idle user is signed out.\"\r\n\r\nShould be replace by the right description.\r\n![Capture d‚ÄôeÃÅcran 2019-07-10 aÃÄ 15 21 05](https://user-images.githubusercontent.com/9443918/60972971-92980880-a327-11e9-80bd-b0878d197f20.png)\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nNot able to authenticate a user anymore.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a new user via the admin or the api.\r\n2. Try to log in with the same user.\r\n\r\n## Expected Behavior\r\n\r\nShould be able to create a user and then authenticate with the pw used to create the user.\r\n\r\n## Actual Behavior\r\n\r\nGET /_/auth/authenticate\r\nRESPONSE: {\"error\":{\"code\":100,\"message\":\"Invalid user credentials\"}}\r\n\r\n## Other Context & Screenshots\r\n\r\n1. I debugged it down to the password_verify method in the Authentication Provider class which fails to verify the password. Can confirm that the method receives the password and the password hash correctly. Which means that the issue is on the password creation side.\r\n\r\n2. I've researched this issue for many hours and the most common issue is related to PASSWORD_BCRYPT occasionally making a hash that is too long and gets truncated by the db. The db field `password` is varchar(255), so shouldn't be a problem, but wondering if maybe the code or query is truncating it (but I'm having a hard time debugging that part of the code).\r\n\r\n## Technical Details\r\n\r\n- Web Server: Apache 2.4.18\r\n- PHP Version: 7.1.27\r\n- Database: MySQL 5.7.26\r\n- Install Method: git cloned"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Clean install\r\n2. Goes through the admin setup without any problem\r\n3. The tables are created on the DB\r\n4. Redirects to the /admin/#/login\r\n5. show error message \"couldn't reach API\". Fields are disabled.\r\n6. Console shows the following error:\r\n![image](https://user-images.githubusercontent.com/9072422/61594950-028c7580-abe9-11e9-87fb-7603ae3e0829.png)\r\n\r\n## Expected Behavior\r\nThe login form should be enabled so I can log-in to the system.\r\n\r\n## Technical Details\r\n\r\n- Device: any\r\n- OS: Ubuntu 18.04\r\n- Web Server: 2.4.29\r\n- PHP Version: 7.2.19\r\n- Database: MySQL 14.14\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"Bug Report\r\n\r\nError while dragging or sorting\r\n\r\n## Steps to Reproduce\r\n\r\n1„ÄÅEnter a collection at will\r\n2„ÄÅSort or drag as shownÔºåSee it\r\n![image](https://user-images.githubusercontent.com/8030134/61380186-82f66200-a8db-11e9-872a-d059e6f741fd.png)\r\n\r\n\r\n## Expected Behavior\r\nFix it\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop]\r\n- OS: [Windows 10.1809]\r\n- Web Server: [Nginx:1.17.0]\r\n- PHP Version: [7.3.6]\r\n- Database: [5.7.26]\r\n- API Version: [2.2.2]\r\n- APP Version: [7.6.2]\r\n- API and App Install Method: [cloned `master` branch]"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to Admin setting, Set logo. \r\n2. Go to files and delete the logo file\r\n3. Refresh the App in the browser\r\n4. See the error shown in the screenshot\r\n\r\n## Actual Behavior\r\n`/settings` endpoint throwing `404 - file not found` for logo file. \r\n\r\n## Expected Behavior\r\nIf the logo file not found, `/setting` should return default logo or blank value\r\nThe app should not break, because the current user is in deadlock situation until they update `directus_settings.keys.logo` to blank directly in the DB.\r\n\r\n## Other Context & Screenshots\r\n\r\n![image](https://user-images.githubusercontent.com/1333346/61516417-93fdbb00-aa22-11e9-8ba0-6985ef30d79c.png)\r\n\r\n![image](https://user-images.githubusercontent.com/1333346/61516437-9e1fb980-aa22-11e9-91fc-ea35d481a41d.png)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: macOS 10.14.5\r\n- Web Server: Apache, MAMP Pro\r\n- PHP Version: 7.2.14\r\n- Database: MySQL 5.7.25\r\n- Install Method: cloned master branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. git clone `https://github.com/directus/api .` and setup scheme based on src/scheme.sql\r\n2. `composer install`\r\n3. Copi version of api.php and setup to s3 upload\r\n4. Upload image either from a created collection with file field or from File Library\r\n5. Check that image + thumbnails is uploaded on S3 to verify the setup\r\n\r\n## Expected Behavior\r\nImage and thumbnail is uploaded to Amazon S3 and directus use S3 source to display both the thumbnail and the full image. Furthermore it should not generate a local thumbnail.\r\n\r\n## Actual Behavior\r\nImage and thumbnail are uploaded to amazon S3 _(Which is correct)_  at path:\r\n**Original image:** https://`<bucket>`.s3.`<zone>`.amazonaws.com/directus/storage/uploads/`<generated_file_name>`.`<file_type>`\r\n**Thumbnail**: https://`<bucket>`.s3.`<zone>`.amazonaws.com/directus/storage/uploads/thumbnails/200/200/crop/good/`<original_file_name>`.`<file_type>`\r\n\r\nDirectus do also create a thumbnail locally (If possible) at path:\r\nhttps://<directus_app_url>/thumbnail/_/200/200/crop/good/<original_file_name>.<file_type>\r\nIf i am right this should not happen when storage is set to S3, and you now have the thumbnails two places.\r\n\r\nFurthermore it is the local thumbnail which is used to display the image, which gives a blank image on for example Google App Engine where local storage is not possible\r\n![image](https://user-images.githubusercontent.com/1073322/61488254-0ed5c000-a9a8-11e9-97dc-5865ea303677.png)\r\n\r\nWhen opening the file at path <directus_app_url>/files/<file_id> the full image is displayed correctly from the S3 source\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS + Google App Engine\r\n- Web Server: Apache 2.4.37\r\n- PHP Version:  7.2.0\r\n- Database:  MySQL 8.0.12\r\n- Install Method:  cloned `master` branch\r\n- Use the master branch for both the app and the api\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. git clone `https://github.com/directus/api .` and setup scheme based on src/scheme.sql\r\n2. `composer install`\r\n3. Copi version of api.php and setup to s3 upload\r\n4. Set app => env to anything else than production\r\n5. Create a collection called `test`\r\n6. Add a file field with default setup to the `test` collection\r\n7. Create new item in the `test` collection  by uploading a new file\r\n\r\n## Expected Behavior\r\nFile is uploaded and a preview is shown.\r\n\r\n## Actual Behavior\r\nThe file are are being uploaded correctly, and can be found under the file directory.\r\nBut are not added to the item you are about the create. Get the following error in the console\r\n![image](https://user-images.githubusercontent.com/1073322/61453588-cc3bc580-a95e-11e9-96d1-a52443ab4179.png)\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS 10.14.5\r\n- Web Server: Apache 2.4.37\r\n- PHP Version: 7.2.0\r\n- Database: MySQL 8.0.12\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\nMany to one  Cannot add new items\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection blog, add field title, content\r\n2. Create a collection blog_like and add a field `blogid` (many to one)\r\n3. Setting Public Permissions\r\n4. Call the interface to add like\r\n ```\r\nthis.$client.createItem(\"blog_like\",{blogid: 1}).then((res) => {\r\n   console.log(res)\r\n })\r\n```\r\n4.See error\r\n> Statement could not be executed (23000 - 1048 - Column 'action_by' cannot be null)\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/61401022-20fe2280-a904-11e9-908c-4f229a20b633.png)\r\n\r\n\r\n## Expected Behavior\r\nMany to one  Cannot add new entries\r\n\r\n## Actual Behavior\r\nIt used to work, but I don't know why it suddenly stopped working.\r\nMaybe because of the update of jsSDK, maybe the problem of api, maybe the problem of app. \r\nHope to be fix\r\n\r\n## Technical Details\r\n\r\n- Device: [Desktop]\r\n- OS: [Windows 10.1809]\r\n- Web Server: [Nginx:1.17.0]\r\n- PHP Version: [7.3.6]\r\n- Database: [5.7.26]\r\n- API Version: [2.3.0]\r\n- APP Version: [7.7]\r\n- Install Method: [cloned `master` branch]"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. `git clone https://github.com/directus/api .`\r\n2. `composer install`\r\n3. Copy the old version of the configuration file(api.php) to config/\r\n4. Create test item create hook, either as `item.create` or `item.create.TABLE_NAME`\r\n ````\r\n  'actions' => [\r\n    'item.create' => function (array $data) {\r\n      $client = new \\GuzzleHttp\\Client([\r\n        'base_uri' => 'https://example.com'\r\n      ]);\r\n\r\n      $data = [\r\n        'type' => 'post',\r\n        'data' => $data,\r\n      ];\r\n\r\n      $response = $client->request('POST', 'alert', [\r\n        'json' => $data\r\n      ]);\r\n    }\r\n  ]\r\n````\r\n\r\n## Expected Behavior\r\nThe endpoint should be called\r\n\r\n## Actual Behavior\r\nThe code is never executed and will therefore not call the endpoint.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS 10.14.5\r\n- Web Server: Apache 2.4.37\r\n- PHP Version: 7.2.0\r\n- Database: MySQL 8.0.12\r\n- Install Method:  cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1, LAMP ([Linux on WSL](https://medium.com/@ssharizal/how-to-install-lamp-stack-server-on-windows-subsystem-linux-wsl-windows-10-133419c22473))\r\n2. sudo apt-get update && sudo apt-get upgrade\r\n3. sudo apt-get install lamp-server^\r\n4. Update etc/apache2/apache2.conf:\r\n```\r\nServername localhost\r\nAcceptFilter http none\r\n```\r\n5. MySQL removed as I had it on a server already\r\n6. sudo apt-get install php-curl\r\n7. VirtualHost configuration:\r\n```\r\n*:80                   localhost (/etc/apache2/sites-enabled/000-default.conf:1)\r\n*:8080                 example.com (/etc/apache2/sites-enabled/000-default.conf:34)\r\n```\r\n8. git clone https://github.com/directus/directus.git\r\n9. sudo chown www-data -R /var/www/directus\r\n10. sudo chown www-data -R /var/www/directus/public/upload\r\n11. Boilerplate System Database from /src/schema.sql\r\n\r\n## Expected Behavior\r\nLoad http://localhost:8080/admin to get the configuration page\r\n\r\n## Actual Behavior\r\nIt goes to the login page instead. Error message on the console:\r\n![image](https://user-images.githubusercontent.com/9072422/61205886-187dd000-a6e9-11e9-996e-0dba39b66932.png)\r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/9072422/61205931-2e8b9080-a6e9-11e9-8753-777ec9db2b60.png)\r\n\r\n\r\n## Technical Details\r\nWindow 10 Enterprise 1903\r\nWSL Ubuntu 18.04.02\r\nApache 2.4.29\r\nPHP 7.2.19\r\nMySQL"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Make a O2M field `requires\r\n2. Leave the interface values blank or delete all items\r\n3. Try to save\r\n4. It saves\r\n\r\n## Expected Behavior\r\n\r\nIt should return an error that field XXXX: Is required like other fields do. \r\n\r\n## Actual Behavior\r\n\r\nIt saves without performing the check since there is technically data in the field's request.\r\n\r\nI know this is really complex since we need to do a check if any items will remain AFTER the request is processed. Yikes! Any ideas @directus/api-team ?"},{"labels":["bug"],"text":"# Bug Report\r\nS3 service does not work,Loss of `root_url` (config/api.php)\r\n\r\n## Steps to Reproduce\r\n\r\n1. `git clone https://github.com/directus/api .`\r\n2. `composer install`\r\n3. `composer require league/flysystem-aws-s3-v3`\r\n4. Copy the old version of the configuration file(api.php) to config/\r\n5. Setting log and public/upload 777 permissions\r\n6. See `/#/files/1`\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/60942435-2e6c4900-a315-11e9-8721-0b8aede4d420.png)\r\n\r\n\r\n\r\n## Expected Behavior\r\nS3 files can be displayed\r\n\r\n## Actual Behavior\r\nLoss of `root_url`\r\n\r\n## Technical Details\r\n\r\n- Device: [Desktop]\r\n- OS: [Windows 10.1809]\r\n- Web Server: [Nginx:1.17.0]\r\n- PHP Version: [7.3.6]\r\n- Database: [5.7.26]\r\n- API Version: [2.2.2]\r\n- APP Version: [7.6.2]\r\n- Install Method: [cloned `master` branch]"},{"labels":["bug"],"text":"When you request a public endpoint with an invalid token, the API will return an error. Seeing that this data is public to begin with, it shouldn't cause problems. The API should ignore the token for public endpoints.\r\n\r\nRef https://github.com/directus/app/issues/1821"},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Start a single API instance\r\n2. Create some collection\r\n3. Add static token to the database for the admin user\r\n4. Use GraphiQL\r\n\r\nSet the URL something like: `http://127.0.0.1:7000/_/gql?access_token=example` and make a query to previous create content, for example:\r\n```\r\n{\r\n  test(limit:10) { data { status } }\r\n}\r\n```\r\nPut `query` before doesn't change the result, the API server always return:\r\n```\r\n{\"error\":{\"code\":1,\"message\":\"Not Found\"}}\r\n```\r\n\r\n## Expected Behavior\r\n\r\nThe GraphQL query to succeed\r\n\r\n## Actual Behavior\r\n\r\nAlways return 404.\r\n\r\n## Technical Details\r\n\r\nGet site root: `/` return:\r\n```\r\n{\r\n    \"data\": {\r\n        \"api\": {\r\n            \"version\": \"2.0.18\"\r\n        },\r\n        \"server\": {\r\n            \"general\": {\r\n                \"php_api\": \"fpm-fcgi\",\r\n                \"php_version\": \"7.2.13\"\r\n            },\r\n            \"max_upload_size\": 2097152\r\n        }\r\n    }\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nThe thumbnailer component does not produce thumbnail for PDF files. (regression?)\r\n\r\n## Steps to Reproduce\r\n\r\n1. Upload a PDF file to Directus (here file.pdf)\r\n2. set the URL to http://<directusapi>http://<directus api domain>/thumbnail/_/200/200/crop/good/file.pdf \r\n4. The file is not found\r\n\r\n## Expected Behavior\r\n\r\nA thumbnail of a PDF is computed and viewable.\r\n\r\n## Actual Behavior\r\n\r\nAn 404 error is sent\r\n\r\n## Other Context & Screenshots\r\n\r\nPlease note that thumbnailer is working with PNG or JPEG files.\r\n\r\n## Technical Details\r\n\r\n- Device: Server\r\n- OS: Ubuntu 18.04.2 LTS\r\n- Web Server: nginx/1.14.0 (Ubuntu) with location configured for thumbnail\r\n- PHP Version: 7.2.19-0ubuntu0.18.04.1\r\n- Database: MySQL 5.7.26-0ubuntu0.18.04.1\r\n- Install Method: git clone of master branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'https://www.directus.app/#/settings/roles'\r\n![1-Editor_Permissions](https://user-images.githubusercontent.com/1925271/60518684-54965580-9d25-11e9-99e6-d5054f14e42d.png)\r\n\r\n2. Create a new role called 'Editor' with permissions to Create/Update/Comment on all collections\r\n<img width=\"1254\" alt=\"2-AdminOneUserRole\" src=\"https://user-images.githubusercontent.com/1925271/60518631-3892b400-9d25-11e9-8674-bd1e5ca4655c.png\">\r\n3. Ensure the new role has no *Delete* permissions on any collections\r\n4. Create a new user and assign him the newly created role of 'Editor'\r\n5. Login as the new user and attempt to delete a record from the collection 'Movies'\r\n<img alt=\"3-EditorUser-Delete-Button-Still-Visible\" src=\"https://user-images.githubusercontent.com/1925271/60518630-3892b400-9d25-11e9-8a28-cb8ff56fd7ca.png\"/>\r\n\r\n6. Observe that the record is deleted\r\n![4-item-deleted](https://user-images.githubusercontent.com/1925271/60518626-37fa1d80-9d25-11e9-8a6c-71d50bba0b6b.png)\r\n\r\n\r\n## Expected Behavior\r\nThe user should not be able to delete the record.\r\nIdeally, you should not be able to see the 'Delete' button if you don't have permission to see it\r\n## Actual Behavior\r\nYou are able to see the 'Delete' button and you are able to delete record.\r\n\r\n## Other Context & Screenshots\r\n\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\nFrom latest install on Directus.app\r\nApp Version 7.6.1\r\nApi Version: \r\n- Device: [eg: Desktop, iPhone6, etc]\r\n- OS: [eg: MacOS 10.13.6, Windows 10.1803]\r\n- Web Server: [eg: Apache 2.4.37]\r\n- PHP Version: [eg: 7.2.0]\r\n- Database: [eg: MySQL 8.0.12]\r\n- Install Method: [eg: cloned `master` branch]\r\n"},{"labels":["bug"],"text":"Some years ago Turkey stopped using Daylight saving and set it's Time Zone to UTC +3 for good. It should be corrected.\r\n\r\nPlus, where can I edit it in my own server?\r\n\r\nDirectus 7.6.1\r\nPHP 7.2.14"},{"labels":["bug"],"text":"# Feature Request\r\nDo not query to return the fields `limit ` `links` `offset` `page_count` `page`\r\nThere may be other reasons, but for me, I don't need them.\r\n![image](https://user-images.githubusercontent.com/8030134/60488475-a95db000-9cd4-11e9-91ff-06b703a0138d.png)\r\n\r\n## What problem does this feature solve?\r\nThese fields are of no value to me, and I can get them all through JS calculations.\r\n` limit ` , ` offset `: I define them myself, and I confirm that they are known and do not need to return.\r\n`links` `offset` `page_count` `page`:  I can get them through JS splicing calculation and other methods\r\n\r\n## How do you think this should be implemented?\r\nAfter passing filter_count, Do not query to return the fields `limit ` `links` `offset` `page_count` and `page`\r\n\r\n## Would you be willing to work on this?\r\n"},{"labels":["bug"],"text":"# Bug Report\r\nSometimes you can return filter_count, sometimes you can't.\r\n\r\n## Steps to Reproduce\r\n\r\n##### 1„ÄÅ\r\n``` javascript\r\nlet searchkey = \"\"\r\nlet categories = \"\"\r\n\r\nthis.client.getItems(\"blog\",{\r\n    meta:\"total_count,result_count,filter_count\",\r\n    sort: \"-created_on\",\r\n    filter:{\r\n        \"category.id\": {\r\n            in:  category \r\n         },\r\n         title:{\r\n             logical: \"or\",\r\n             contains: searchkey \r\n         },\r\n         description:{\r\n             logical: \"or\",\r\n             contains: searchkey \r\n         },\r\n     },\r\n     limit: 10,\r\n     fields: \"*.*\",\r\n     status: \"published\"\r\n})\r\n```\r\n\r\nAt this point, because searchkey and categories are empty, no filter is passed, and filter_count cannot be returned.\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/60485550-f68b5300-9ccf-11e9-8bcd-7b4fc1ebc585.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/60485177-9e078600-9cce-11e9-84b0-db32bb95d282.png)\r\n\r\n\r\n#####  2„ÄÅ\r\n\r\n``` javascript\r\nlet searchkey = \"\"\r\nlet categories = \"7,13,15,8,14,32\"\r\n\r\nthis.client.getItems(\"blog\",{\r\n    meta:\"total_count,result_count,filter_count\",\r\n    sort: \"-created_on\",\r\n    filter:{\r\n        \"category.id\": {\r\n            in:  category \r\n         },\r\n         title:{\r\n             logical: \"or\",\r\n             contains: searchkey \r\n         },\r\n         description:{\r\n             logical: \"or\",\r\n             contains: searchkey \r\n         },\r\n     },\r\n     limit: 10,\r\n     fields: \"*.*\",\r\n     status: \"published\"\r\n})\r\n```\r\n\r\nAt this point, because the search key is empty and the categories have a value, the filter [category. id] [in]: 7, 13, 15, 8, 14, 32 is passed, and the filter_count is returned correctly.\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/60485703-6e597d80-9cd0-11e9-9557-a6d9f670231d.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/60487820-d9a44f00-9cd2-11e9-809a-35aa906a3f9d.png)\r\n\r\n\r\n##### 3„ÄÅ\r\n\r\n``` javascript\r\nlet searchkey = \"\"\r\nlet categories = \"28,29,30\"\r\n\r\nthis.client.getItems(\"blog\",{\r\n    meta:\"total_count,result_count,filter_count\",\r\n    sort: \"-created_on\",\r\n    filter:{\r\n        \"category.id\": {\r\n            in:  category \r\n         },\r\n         title:{\r\n             logical: \"or\",\r\n             contains: searchkey \r\n         },\r\n         description:{\r\n             logical: \"or\",\r\n             contains: searchkey \r\n         },\r\n     },\r\n     limit: 10,\r\n     fields: \"*.*\",\r\n     status: \"published\"\r\n})\r\n```\r\nThe filter [category. id] [in]: 7, 13, 15, 8, 14, 32 is passed, and no data is returned after filtering, so filter_count cannot be returned at this time.\r\n![image](https://user-images.githubusercontent.com/8030134/60487582-84683d80-9cd2-11e9-9ecc-f9109246ecab.png)\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/60487779-be394400-9cd2-11e9-9e6f-039a12607b9f.png)\r\n\r\n\r\n## Expected Behavior\r\n\r\n## Actual Behavior\r\n\r\n## Other Context & Screenshots\r\n\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop]\r\n- OS: [Windows 10.1809]\r\n- Web Server: [Nginx:1.17.0]\r\n- PHP Version: [7.3.6]\r\n- Database: [5.7.26]\r\n- API Version: [2.2.1]\r\n- APP Version: [7.6.1]\r\n- Install Method: [cloned `master` branch]\r\n"},{"labels":["bug"],"text":"When updating an existing item through a relationship, like a one to many, the API requires all required fields to be set, even if they already have a value in the database.\r\n\r\nLets say I have a collection named `sections` that has a one to many to `cards`. When I update existing card with `id = 4` by sending the following payload\r\n\r\n```json\r\n{\r\n  \"cards\": [\r\n    {\r\n      \"id\": 4,\r\n      \"note\": \"Test\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nthe API will return\r\n\r\n```json\r\n{\r\n  \"error\": {\r\n    \"code\": 4,\r\n    \"message\": \"status: This value should not be blank.\"\r\n  }\r\n}\r\n```\r\n\r\neven though the field already has a status value in the DB, and it's not a newly created item.\r\n\r\n\r\nWhen updating the item through the `/items` endpoint directly, this problem doesn't occur.\r\n\r\nüëâ The API should treat updates to existing items in relational fields the same as regular updates."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nTranslations are of type String! in \r\n## Steps to Reproduce\r\n\r\n1. Create a collection\r\n2. Create related translation collection adn setup translations\r\n3. Try to retrieve data using graphql\r\n\r\n## Expected Behavior\r\nThe schema of the collection will have translations of type String!\r\n\r\n## Actual Behavior\r\nThe schema of the collection should have an array of TranslationsItem\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Docker container API: 2.2.1 and APP: 7.6.1\r\n"},{"labels":["bug",null],"text":"Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nhttp://106.75.81.217:9696/_/items/soft?meta=total_count%2Cresult_count%2Cfilter_count&sort=-created_on&offset=0&limit=30&filter%5Bcategory.id%5D%5Bin%5D=4%2C12%2C9%2C10%2C11&fields=id%2Cicon.filename.%2A%2Ccreated_on%2Cslug%2Cos_version%2Ctags%2Cversion%2Ctitle%2Ctitle_des%2Clanguage%2Csize%2Cisflag%2Ciscrack&status=published\r\n\r\n## Expected Behavior\r\nFilter_count can be returned as normal\r\n\r\n## Actual Behavior\r\n\r\nCannot return filter_count\r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/8030134/60356209-ff93d000-9a02-11e9-8f0c-4302d394f0c1.png)\r\n![image](https://user-images.githubusercontent.com/8030134/60356225-0c182880-9a03-11e9-8373-6428ed97edb6.png)\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop]\r\n- OS: [Windows 10.1809]\r\n- Web Server: [Nginx:1.17.0]\r\n- PHP Version: [7.3.6]\r\n- Database: [5.7.26]\r\n- API Version: [2.2.1]\r\n- APP Version: [7.6.1]\r\n- Install Method: [cloned `master` branch]\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nAdding a file via a link fails with `Undefined index`.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to app `File Library`, then add a new file via `embed`\r\n2. Add the link of the file (digital oceans spaces / aws s3)\r\n3. See error\r\n\r\n## Expected Behavior\r\nAdd the new file\r\n\r\n## Actual Behavior\r\nApi errors with:\r\n```md\r\nUndefined index: Prefix in /var/www/html/vendor/league/flysystem-aws-s3-v3/src/AwsS3Adapter.php on line 676\r\n```\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Directus API: 2.2.0\r\n- Directus App: 7.6.0\r\n- Web Server: nginx\r\n- PHP Version: 7.2.18\r\n- Database: MySQL 5.7\r\n- Install Method: custom docker \r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to`config/api.php` in directus app\r\n2. Uncomment the settings for memcached\r\n3. Try to load a page\r\n4. See error\r\n\r\n## Expected Behavior\r\n\r\nDirectus will use Memcached for caching.\r\n\r\n## Actual Behavior\r\n\r\nAPI dies.\r\n\r\n## Other Context & Screenshots\r\n\r\nThese are the settings in `config/api.php`:\r\n\r\n```\r\n        // 'pool' => [\r\n        //    'adapter'   => 'memcached',\r\n        //    'host'      => 'localhost',\r\n        //    'port'      => 11211\r\n        // ],\r\n```\r\n\r\nMemcached is running fine:\r\n\r\n```$ telnet localhost 11211\r\nTrying 127.0.0.1...\r\nConnected to localhost.\r\nEscape character is '^]'.\r\nstats\r\nSTAT pid 15949\r\n... truncated\r\n```\r\n\r\nThere doesn't seem to be anything in `logs/<date>.log`, or in `/var/log/apache/directus.local.error.log`.\r\n\r\n## Technical Details\r\n\r\n- PHP Version: 7.3\r\n- memcached 1.5.6\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"CORS headers are not being attached to thumbnails and images responses, e.g:\r\n```\r\n/uploads/_/originals/file-1.jpg\r\n/thumbnail/_/50/50/contain/poor/file-1.jpg\r\n```\r\nI'm using the :latest docker version of app and api. Is it possible to turn CORS for these responses? "},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nHi,\r\n\r\nI've just started using Directus, and I've noticed that certain video files do not get uploaded. There is a file created, but no body is written to it.\r\n\r\nI'm using the AWS S3 adapter. I've looked into it with XDebug, but I'm a bit puzzled to how it the file actually gets uploaded. I assume the bug is with the repeated base64_encode and decode done for file uploads. I haven't stepped deeper into it because I'm a bit run up to the CoreServicesProvider.\r\n\r\nIf you can point me to the design docs or something, where I can read up on why/what is the CoreServicesProvider, I'd might be able to debug and fix this myself.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Install S3 bundle and configure directus to work with s3\r\n2. Upload following file: https://s3-eu-west-1.amazonaws.com/bbm.customers.bazookas.be/bbm-beer-map/original/Pexels+Videos+1472013.mp4\r\n\r\n## Expected Behavior\r\nExact same file at https://s3-eu-west-1.amazonaws.com/bbm.customers.bazookas.be/bbm-beer-map/assets/Pexels+Videos+1472013.mp4\r\n## Actual Behavior\r\n\r\nEmpty file\r\n\r\n![Screenshot 2019-06-26 at 17 53 12](https://user-images.githubusercontent.com/1325321/60195421-55b61700-983b-11e9-8d83-ca7562fc5a48.png)\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop, iPhone6, etc]\r\n- OS: Debian, Docker\r\n- Web Server: NGINX\r\n- PHP Version: 7.2\r\n- Database: MariaDB:10\r\n- Install Method: cloned from master, created customer docker container\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nHTTP status code 500 is for internal server errors and should never be used for errors that are caught and handled by the API. Errors 109 (Invalid Request Token) and 110 (Expired Request Token) both throw a 500 error currently. These should be **401**."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nSaving a collection while adding more than one file throws error:\r\n```\r\n{\"error\":{\"code\":213,\"message\":\"Attempting to write an array as the value for field \\\"file2\\\" in \\\"testimages\\\"\",\"class\":\"Directus\\\\Database\\\\Exception\\\\SuppliedArrayAsColumnValue\",\"file\":\"\\/var\\/www\\/html\\/src\\/core\\/Directus\\/Database\\/TableGateway\\/BaseTableGateway.php\",\"line\":1785}}\r\n```\r\nI believe this is neither like directus/api#1015 nor  directus/app#1573 because I can save to the collection as long as I only add one file at a time and I can change a file without any issues.\r\n\r\nthis is like : https://github.com/directus/app/issues/1714#issuecomment-499149850\r\n\r\n## Steps to Reproduce\r\n\r\nOn APP 7.6 and API 2.2\r\n\r\n1. Create a new collection \"testimages\" with two optional file fields \"file1\", \"file2\"\r\n2. Add a new item with two files, save\r\n4. See error __Attempting to write an array as the value for field \"file2\" in \"testimages\"__\r\n\r\nIt works when saving testimages with only one file  and the second file in a second edit attempt\r\n\r\n## Expected Behavior\r\n\r\nWhen saving  a collection with two file fields, it saves correctly\r\n\r\n## Actual Behavior\r\n\r\nThe item is not saved.\r\n\r\n## Other Context & Screenshots\r\n\r\n[testimages-collection-schema.json.txt](https://github.com/directus/api/files/3327818/testimages-collection-schema.json.txt)\r\n[single-file-working-payload.patch.txt](https://github.com/directus/api/files/3327808/single-file-working-payload.patch.txt)\r\n[two-file-failing-payload.patch.txt](https://github.com/directus/api/files/3327809/two-file-failing-payload.patch.txt)\r\n[directus-api-info.txt](https://github.com/directus/api/files/3327811/directus-api-info.txt)\r\n\r\n\r\n\r\n## Technical Details\r\n\r\nDirectus API:  2.2.0\r\nDirectus APP: 7.6.0\r\nwith new DB schema\r\n\r\nalso see [directus-api-info.txt](https://github.com/directus/api/files/3327811/directus-api-info.txt)\r\n\r\n\r\n- Device: Desktop \r\n- OS: Linux\r\n- Web Server: nginx\r\n- PHP Version: 7.3.6\r\n- Database: Mysql 5.7??\r\n- Install Method: custom docker container based on release artefacts\r\n"},{"labels":["bug"],"text":"# Possible Bug Report\r\nI am trying to achieve full api data separation based on user accounts. That works well so far by setting access permissions to 'mine' for custom collections and non-admin users.\r\nNow I want users to see 'their' files only. Using the 'mine' permission on directus-files doesn't work as expected.\r\nHow can I achieve file access rights separation based on user accounts?\r\n\r\n## Steps to Reproduce\r\n0. Login as non-admin user and upload a file\r\n1. Go to SQL database\r\n2. set the appropriate user group permissions to 'mine' for directus-files \r\n3. APP does not show any files, server error for non-admin users\r\n4. JS SDK cannot retrieve files although **login user** and **uploaded_by** user are the same.\r\n\r\n## Expected Behavior\r\nUser should only see files uploaded by themselves\r\n\r\n## Actual Behavior\r\nUser does not see any files.\r\n\r\n## Technical Details\r\n- Device: vServer\r\n- OS: CentOs 7\r\n- Web Server: Apache+Nginx\r\n- PHP Version: 7.3\r\n- Database: MariaDB\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"(I'm not sure if this is a documentation change, a bug, or a feature request.)\r\n\r\nI am able to use $itemsService->findAll inside of a custom endpoint.\r\n\r\n```\r\nuse Directus\\Application\\Http\\Request;\r\nuse Directus\\Application\\Http\\Response;\r\nuse Directus\\Services\\ItemsService;\r\n\r\nreturn [\r\n    '' => [\r\n        'method' => 'GET',\r\n        'handler' => function (Request $request, Response $response) {\r\n            $itemsService = new ItemsService($this);\r\n            $params = $request->getQueryParams();\r\n            $test = $itemsService->findAll('test', $params);\r\n\r\n            return $response->withJson([\r\n                'data' => [\r\n                    $test\r\n                ]\r\n            ]);\r\n        }\r\n    ],\r\n];\r\n```\r\n\r\nWhen I try to use $itemsService->createItem inside of a custom endpoint, I always get: (have ensured that the permissions allow it)\r\n\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": 301,\r\n        \"message\": \"Creating item to \\\"test\\\" collection was denied\"\r\n    }\r\n}\r\n```"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Open collection\r\n2. Add file\r\n3. Save collection\r\n\r\n## Expected Behavior\r\nSuccess save.\r\n\r\n## Actual Behavior\r\nError: `The value submitted (Json / Array) for 'Logo' is longer than the field's supported length (10). Please submit a shorter value or ask an Admin to increase the length.`\r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/6615134/59615899-be91e680-90f9-11e9-97d6-c6773c8eb424.png)\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS 10.14.5\r\n- Web Server: Apache/2.4.29 (Ubuntu)\r\n- PHP Version: 7.2.19\r\n- Database: MySQL 5.7.26-0\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\nSeems to be a similar issue as\r\nhttps://github.com/directus/api/issues/705\r\npresent in version 7.5.0.\r\n\r\nI have a managed collection \"pages\" using custom primary key INT. The field is named \"page_id\" instead of \"id\". Deleting items from that collection fails.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to a collection (\"pages\" in my case)\r\n2. Select one item\r\n3. Click Delete\r\n4. See error\r\n\r\n## Expected Behavior\r\nThe item should be removed from the db and from the interface.\r\n\r\n## Actual Behavior\r\nAn error is displayed and no item is removed.\r\n\"Trouble processing request. Try again after refreshing the page.\"\r\n\r\nSame behavior when using JS SDK, error:\r\n\"Error deleting a record in pages with id 8\":\r\n\"id\" should be \"page_id\"...\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: vServer\r\n- OS: CentOS 7\r\n- Web Server: Apache\r\n- PHP Version: 7.3\r\n- Database: MariaDB\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nWhen I have a field set to json or array and post something to that collection, it will execute the post but add the following warning after the json response:\r\n\r\n```\r\n{\r\n... the expected json object of the collection\r\n}\r\n<br/ > ‚Üµ < b > Warning </b>:  strlen() expects parameter 1 to be string, array given in <b>/api/ src/core/Directus/Services/AbstractService.php </b> on line <b>500</b> <br / > ‚Üµ\r\n```\r\n\r\nI get the same error when using the app to update in some collections. The error reads:\r\n\r\n`API returned invalid JSON` \r\n\r\nwhen i inspect it it's because of the same error as above: first the JSON object, then the error message.\r\n\r\n## Steps to Reproduce\r\n\r\n1. set up a collection with an array field and/or json field (for interfaces tags or code)\r\n2. API post to collection\r\n3. see response\r\n\r\n## Expected Behavior\r\nJust correct json response\r\n\r\n## Actual Behavior\r\njson response plus added error message\r\n\r\n## Technical Details\r\n\r\nLatest build branch of the API\r\n\r\n- Device: Desktop\r\n- OS: MAC\r\n- Web Server: MAMP / Apache\r\n- PHP Version: 7.2.8\r\n- Database: [eg: MySQL 8.0.12]\r\n- Install Method: cloned api build\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nConsidering the following tables:\r\n\r\n````\r\n----------   --------------------   -------------\r\n| movies |   | movies_directors |   | directors |\r\n|--------|   |------------------|   |-----------|\r\n|        |   | id               |   |           |\r\n| id     | ‚Üê | movies_id        |   |           |\r\n|        |   | directors_id     | ‚Üí | id        |\r\n----------   --------------------   -------------\r\n````\r\n\r\nOn the movies table I have a M2M field names `directors` and related to the \r\n`directors` table.\r\n\r\nI'd like to fetch all movies having more than one director. \r\nFrom the documentation :\r\n\r\n> Using has will return items that has at least the minimum number given as \r\n> related items.\r\n\r\nHence I make the following request: `/items/movies?filter[directors][has]=1`.\r\n\r\n\r\n## Expected Behavior\r\n\r\nThe request should return all movies having more than one director.  \r\nThe generated query should be something like:\r\n\r\n````sql\r\nSELECT movies.id, title\r\nFROM movies \r\n    LEFT JOIN movies_directors ON movies.id = movies_directors.movies_id\r\nGROUP BY movies.id\r\nHAVING COUNT(movies_directors.id) > 1\r\n````\r\n\r\n## Actual Behavior\r\n\r\nI got results but not what I expected. As I didn't understand how they were \r\nfiltered, I checked the MySQL query log. Here is the generated query :\r\n\r\n````sql\r\nSELECT movies.id AS id, \r\n       movies.title AS title \r\nFROM movies \r\nWHERE movies.id IN (\r\n    SELECT movies_directors.movies_id AS movies_id \r\n    FROM movies \r\n        RIGHT JOIN movies_directors ON movies.id = movies_directors.movies_id \r\n    WHERE movies_directors.id LIKE 1 \r\n        OR movies_directors.movies_id LIKE 1 \r\n        OR movies_directors.directors_id LIKE 1\r\n) \r\nORDER BY movies.id IS NULL, \r\n         movies.id ASC, \r\n         movies.id ASC \r\nLIMIT 200 OFFSET 0\r\n````\r\n\r\n## Other Context & Screenshots\r\n\r\n### Simplified database dump (should be restorable on a running Directus instance)\r\n````sql\r\nINSERT INTO `directus_collections` (`collection`, `managed`, `hidden`, `single`, `icon`, `note`, `translation`)\r\nVALUES ('directors', 1, 0, 0, NULL, NULL, NULL),\r\n       ('movies', 1, 0, 0, NULL, NULL, NULL),\r\n       ('movies_directors', 1, 1, 0, NULL, 'Junction Collection', NULL);\r\nINSERT INTO `directus_fields` (`collection`, `field`, `type`, `interface`, `options`, `locked`, `validation`, `required`, `readonly`, `hidden_detail`, `hidden_browse`, `sort`, `width`, `group`, `note`, `translation`)\r\nVALUES ('movies', 'id', 'integer', 'primary-key', NULL, 0, NULL, 0, 0, 1, 1, 0, NULL, NULL, NULL, NULL),\r\n       ('movies', 'title', 'string', 'text-input', '{\\\"trim\\\":true,\\\"showCharacterCount\\\":true,\\\"formatValue\\\":false,\\\"width\\\":\\\"auto\\\"}', 0, NULL, 1, 0, 0, 0, NULL, 'full', NULL, NULL, NULL),\r\n       ('directors', 'id', 'integer', 'primary-key', NULL, 0, NULL, 0, 0, 1, 1, 0, NULL, NULL, NULL, NULL),\r\n       ('directors', 'name', 'string', 'text-input', '{\\\"trim\\\":true,\\\"showCharacterCount\\\":true,\\\"formatValue\\\":false,\\\"width\\\":\\\"auto\\\"}', 0, NULL, 1, 0, 0, 0, NULL, 'full', NULL, NULL, NULL),\r\n       ('movies', 'directors', 'o2m', 'many-to-many', '{\\\"fields\\\":\\\"name\\\",\\\"template\\\":\\\"{{ name }} - {{ director.name }} - {{ director.director_id.name }} - {{ director.director_id }}\\\",\\\"preferences\\\":{\\\"viewType\\\":\\\"tabular\\\",\\\"viewQuery\\\":{\\\"fields\\\":[\\\"name\\\"]}}}', 0, NULL, 0, 0, 0, 0, NULL, 'full', NULL, NULL, NULL),\r\n       ('movies_directors', 'id', 'integer', 'primary-key', NULL, 0, NULL, 0, 0, 0, 0, 0, NULL, NULL, NULL, NULL),\r\n       ('movies_directors', 'movies_id', 'integer', 'numeric', NULL, 0, NULL, 1, 0, 0, 0, 0, NULL, NULL, NULL, NULL),\r\n       ('movies_directors', 'directors_id', 'integer', 'numeric', NULL, 0, NULL, 1, 0, 0, 0, 0, NULL, NULL, NULL, NULL),\r\n       ('directors', 'movies', 'o2m', 'many-to-many', '{\\\"fields\\\":\\\"title\\\"}', 0, NULL, 1, 0, 0, 0, NULL, 'full', NULL, NULL, NULL);\r\nINSERT INTO `directus_relations` (`collection_many`, `field_many`, `collection_one`, `field_one`, `junction_field`)\r\nVALUES ('movies_directors', 'movies_id', 'movies', 'directors', 'directors_id'),\r\n       ('movies_directors', 'directors_id', 'directors', NULL, 'movies_id'),\r\n       ('movies_directors', 'directors_id', 'directors', 'movies', 'movies_id'),\r\n       ('movies_directors', 'movies_id', 'movies', NULL, 'directors_id');\r\n\r\n\r\nCREATE TABLE `directors` (\r\n  `id` int(15) unsigned NOT NULL AUTO_INCREMENT,\r\n  `name` varchar(200) DEFAULT NULL,\r\n  PRIMARY KEY (`id`)\r\n) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;\r\nINSERT INTO `directors` (`id`, `name`)\r\nVALUES (1, 'Francis Ford Coppola'),\r\n       (2, 'Woody Allen'),\r\n       (3, 'Martin Scorsese'),\r\n       (4, 'Joel Coen'),\r\n       (5, 'Ethan Coen');\r\n\r\nCREATE TABLE `movies` (\r\n  `id` int(15) unsigned NOT NULL AUTO_INCREMENT,\r\n  `title` varchar(200) DEFAULT NULL,\r\n  PRIMARY KEY (`id`)\r\n) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;\r\nINSERT INTO `movies` (`id`, `title`)\r\nVALUES (1, 'New York Stories'),\r\n       (2, 'The big Lebowski'),\r\n       (3, 'The departed'),\r\n       (4, 'Test');\r\n\r\nCREATE TABLE `movies_directors` (\r\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\r\n  `movies_id` int(10) unsigned DEFAULT NULL,\r\n  `directors_id` int(10) unsigned DEFAULT NULL,\r\n  PRIMARY KEY (`id`)\r\n) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;\r\nINSERT INTO `movies_directors` (`id`, `movies_id`, `directors_id`)\r\nVALUES (1, 1, 1),\r\n       (2, 1, 2),\r\n       (3, 1, 3),\r\n       (4, 2, 4),\r\n       (5, 2, 5),\r\n       (6, 3, 3);\r\n````\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS 10.14.5\r\n- Web Server: Apache 2.4.34\r\n- PHP Version: 7.1\r\n- Database: MariaDB 10.2.19\r\n- Install Method: cloned master branch (f28209b515b19b53b9a9a8a34a7ab2010210d4f9)\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n   ->  just reinstalled to be sure\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. I log in as admin (the initial first user)\r\n2. add any user to user directory (name, lastname, email, password) and klick save\r\n3. look into database:directus.directus_users -> password not hashed\r\n\r\n## Expected Behavior\r\npassword is hashed and I can log in with the user\r\n\r\n## Actual Behavior\r\npassword is not hashed in database and I cannot log in with that user\r\n\r\n## Other Context & Screenshots\r\n\r\nI am operating my site on Amazon EC2 with IIS and a mysql-database.\r\n\r\nI have different things in my site - so here is how I sort of 'interlace-configured' Directus:\r\n- Site points to C:\\inetpub\\wwwroot\r\n- directus-master is copied to C:\\inetpub\\wwwroot\\a\r\n- example, how the package works out as path: C:\\inetpub\\wwwroot\\a\\config\\api.php\r\n- the IIS-site has also configured a virtual folder c, which points to C:\\inetpub\\wwwroot\\a\\public\r\n- in the front end I use the URL https://MYDOMAIN/c/admin/\r\n\r\nMy web-config looks like this:\r\n```\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<configuration>\r\n  <system.webServer>\r\n    <handlers>\r\n        <remove name=\"WebDAV\" />\r\n        <remove name=\"PHP\" />\r\n        <add name=\"PHP\" path=\"*.php\" verb=\"GET, PUT, POST, DELETE, PATCH, HEAD\" modules=\"FastCgiModule\" scriptProcessor=\"C:\\Program Files (x86)\\php\\php-cgi.exe\" resourceType=\"Unspecified\" requireAccess=\"Script\" />\r\n    </handlers> \r\n\r\n    <rewrite>\r\n        <rules>\r\n            <clear />\r\n            <rule name=\"cImported Rule 1-1\" enabled=\"true\" stopProcessing=\"true\">\r\n                <match url=\"^c/assets\" />\r\n                <action type=\"None\" />\r\n            </rule>\r\n            <rule name=\"cImported Rule 2\" enabled=\"true\" stopProcessing=\"true\">\r\n                <match url=\"^c/extensions/([^/]+)\" />\r\n                <action type=\"None\" />\r\n            </rule>\r\n            <rule name=\"cImported Rule 3\" enabled=\"true\" stopProcessing=\"true\">\r\n                <match url=\"^c/extensions/([^/]+)/assets\" />\r\n                <action type=\"None\" />\r\n            </rule>\r\n            <rule name=\"cImported Rule 4\" enabled=\"true\" stopProcessing=\"true\">\r\n                <match url=\"^c/extensions/([^/]+)/main.js\" />\r\n                <action type=\"None\" />\r\n            </rule>\r\n            <rule name=\"cImported Rule 5\" enabled=\"true\" stopProcessing=\"true\">\r\n                <match url=\"^c/listviews/([^/]+)\" />\r\n                <action type=\"None\" />\r\n            </rule>\r\n            <rule name=\"cImported Rule 6\" enabled=\"true\" stopProcessing=\"true\">\r\n                <match url=\"^c/listviews/([^/]+)/assets\" />\r\n                <action type=\"None\" />\r\n            </rule>\r\n            <rule name=\"cImported Rule 7\" enabled=\"true\" stopProcessing=\"true\">\r\n                <match url=\"^c/listviews/([^/]+)/ListView.js\" />\r\n                <action type=\"None\" />\r\n            </rule>\r\n       \r\n            <rule name=\"crule 2V\" enabled=\"true\" stopProcessing=\"true\">\r\n              <match url=\"^c/api/extensions/([^/]+)\" />\r\n              <action type=\"Rewrite\" url=\"c/api/api.php?run_extension={R:1}&amp;%{QUERY_STRING}\" />\r\n            </rule>\r\n            <rule name=\"crule 3V\" enabled=\"true\" stopProcessing=\"true\">\r\n              <match url=\"^c/api\" />\r\n              <action type=\"Rewrite\" url=\"c/api/api.php?run_api_router=1&amp;%{QUERY_STRING}\" />\r\n            </rule>            \r\n\r\n            <rule name=\"cDynamicContent\" enabled=\"true\">\r\n              <match url=\"^c/(.*)\" ignoreCase=\"true\" />\r\n                <conditions>\r\n                  <add input=\"{REQUEST_FILENAME}\" matchType=\"IsFile\" negate=\"true\" />\r\n                  <add input=\"{REQUEST_FILENAME}\" matchType=\"IsDirectory\" ignoreCase=\"false\" negate=\"true\" />\r\n                </conditions>\r\n              <action type=\"Rewrite\" url=\"c/index.php\" />\r\n            </rule>\r\n        </rules>\r\n    </rewrite>\r\n    \r\n   <security>\r\n        <requestFiltering>\r\n            <verbs allowUnlisted=\"false\">\r\n                <add verb=\"GET\" allowed=\"true\" />\r\n                <add verb=\"POST\" allowed=\"true\" />\r\n                <add verb=\"DELETE\" allowed=\"true\" />\r\n                <add verb=\"PUT\" allowed=\"true\" />\r\n                <add verb=\"PATCH\" allowed=\"true\" />\r\n                <add verb=\"HEAD\" allowed=\"true\" />\r\n            </verbs>\r\n        </requestFiltering>\r\n    </security>\r\n\r\n  </system.webServer>\r\n    <location path=\"c\">\r\n    </location>\r\n      \r\n</configuration>\r\n```\r\n\r\n\r\nI can create users in general and create/delete/change collections, however the configuration was fully manual.\r\n\r\nIn the C:\\inetpub\\wwwroot\\a\\config\\api.php those strings are still on default, simply because I do not know how render those strings in a way, that they fit together:\r\n```\r\n 'auth' => [\r\n        'secret_key' => '<type-a-secret-authentication-key-string>',\r\n        'public_key' => '<type-a-public-authentication-key-string>',\r\n```\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Laptop\r\n- OS: Win 10 64Bit + Firefox 67.0.1 (64-Bit)\r\n- Web Server: IIS 10\r\n- PHP Version: php-7.3.6-nts-Win32-VC15-x86\r\n- Database: MySQL - 'SELECT @@version;' gives me 5.7.23-log\r\n- Install Method: cloned zip copy (today)"},{"labels":["bug",null],"text":"My filename was `Q82_Q83_1_+_1_=_2_Foto_Kruis_en_Mol.jpg` I'm suspecting that either the `+` or the `=` in the file name is causing issues. All other files seem to work fine\r\n\r\nNote: i haven't reproduced this in an isolated instance. "},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nIt is possible to create multiple translations with the same language and parent key.\r\nAny downstream system pulling and rendering the content cannot tell which of the duplicates is the correct translation.\r\nDuplicate content like that is effectively hidden from users since the parent collection would not display both entries for the same language\r\n\r\nE.g. we have a test collection setup of blog_language, blog and blog_translations (jsons attached)\r\n[example-blog-translation-setup.txt](https://github.com/directus/api/files/3275208/example-blog-translation-setup.txt)\r\n\r\nIn our case, the content editor mentioned that they entered blog content including a blog_translation for English, but when going back, it showed the translated content as blank and the content editor then entered and saved again.\r\nIn the Directus App, everything looked fine but our downstream system didn't know which content to pick.\r\nWhile I was not able to reproduce the exact cause, the duplicate entry can be reproduced when two users edit the same collection and add the same translated content.\r\n\r\nWe will work around this by adding a custom MySQL unique constraint, but it would be good to have this handled from within Directus if possible\r\n\r\n## Steps to Reproduce\r\n\r\n1. setup of blog_language, blog and blog_translations \r\n2. Create a new blog, without any translations\r\n3. Open the blog entry as two different users in two different browser and add English content with both of them\r\n4. Check blog_translations and find two entries\r\n\r\n## Expected Behavior\r\n\r\nDuplicated translated content for the same language is prevented.\r\n\r\n## Actual Behavior\r\n\r\nIt is currently possible to create duplicate translations for the same language.\r\nWhile the above described scenario is using multiple users, the actual problem occurred with a single user and a single browser, though I don't know how.,\r\n\r\n## Other Context & Screenshots\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS:  MacOS 10.13.6, Linux\r\n- Web Server: nginx\r\n- PHP Version: 7.2.0\r\n- Database:  MySQL 5.7\r\n- Install Method: custom docker image from release artifacts"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Click on any collection\r\n2. Click on 'Info' button\r\n3. Select  Table view\r\n4. Select any unchecked field\r\n4. See error\r\n\r\n## Expected Behavior\r\nNo error\r\n\r\n## Actual Behavior\r\nPopup error message with the following text: \r\nTrouble processing request. Try again after refreshing the page.\r\n\r\n## Other Context & Screenshots\r\nIn developer console collection_presets call contains the following html:\r\n![image](https://user-images.githubusercontent.com/13006578/59199878-ff6f8580-8b64-11e9-971a-b13b787e4bcf.png)\r\n \r\nI've made some debugging and so here is a place where it fails:\r\n![image](https://user-images.githubusercontent.com/13006578/59200373-0fd43000-8b66-11e9-9d01-d6a56bb55588.png)\r\n\r\n'tabular-extended' is my custom layout that I've created in order to implement some custom functionality, like export/import data and translations...\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10.1803 WSL\r\n- Web Server: NGINX\r\n- PHP Version: 7.3.4\r\n- Database:  MySQL 5.7.25\r\n- Install Method: cloned build branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce  \r\n\r\n1. Download the example docker-compose.yml provided by [directus/docker](https://github.com/directus/docker/blob/master/examples/thumbs-local/docker-compose.yml) repo.  \r\n2. run `docker-compose up`  \r\n3. create a new table with a field (text input)  \r\n4. attempt to create a record using some Arabic characters/words (e.g. ÿ£ÿ®ÿ¨ÿØ ŸáŸàÿ≤)  \r\n5. See error `Failed generating the SQL query.`\r\n\r\n## Expected Behavior\r\nRecord should be created. \r\n\r\n## Actual Behavior\r\nError received: `Failed generating the SQL query`  \r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\nError log\r\n```\r\napi[_].ERROR: Directus\\Database\\Exception\\InvalidQueryException: Failed generating the SQL query. in /var/www/html/src/core/Directus/Database/TableGateway/BaseTableGateway.php:812\r\nStack trace:\r\n#0 /var/www/html/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(264): Directus\\Database\\TableGateway\\BaseTableGateway->executeInsert\r\n#1 /var/www/html/src/core/Directus/Database/TableGateway/BaseTableGateway.php(390): Zend\\Db\\TableGateway\\AbstractTableGateway->insert\r\n#2 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(410): Directus\\Database\\TableGateway\\BaseTableGateway->addRecordByArray\r\n#3 /var/www/html/src/core/Directus/Services/ItemsService.php(29): Directus\\Database\\TableGateway\\RelationalTableGateway->createRecord\r\n#4 /var/www/html/src/endpoints/Items.php(69): Directus\\Services\\ItemsService->createItem\r\n#5 [internal function]: Directus\\Api\\Routes\\Items->create\r\n#6 /var/www/html/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\n#7 /var/www/html/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#8 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#9 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#10 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#11 [internal function]: Slim\\DeferredCallable->__invoke\r\n...\r\n```\r\n\r\n### Other contexts  \r\nError also produced using the following:\r\n- text input (string, varchar), text area (string, text), wysiwyg (string, text).  \r\n- using Japanese characters (Âπ≥‰ªÆÂêç).\r\n\r\nHowever, the problem did not occur when attempted on the demo environment: https://directus.app/\r\n\r\n## Technical Details\r\n\r\n- Device: Macbook Pro\r\n- OS: MacOS 10.13.2  \r\n- docker-compose: using the example provided by [directus/docker](https://github.com/directus/docker/blob/master/examples/thumbs-local/docker-compose.yml) repo.  \r\n- Install Method: copied `docker-compose.yml`, then ran `docker-compose up`\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nSome of the data in my app is in Arabic, so, I had to alter the collation of those field in mysql from latin1_swedish_ci to utf8mb4_unicode_ci. That works perfectly fine till I decided to change some of the fields to \"Required\" in Directus. As a result, Directus changed back the collation to the default latin1_swedish_ci which resulted in a permanent data corruption. \r\nLuckily, I have a 2 days old backup that help to limit the data loss.\r\n\r\n## Steps to Reproduce\r\n\r\n- Change any field in my sql from  latin1_swedish_ci to utf8mb4_unicode_ci\r\n- in Directus, make the field \"Required\"\r\n- Notice how the collation is changed back to latin1_swedish_ci.\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\nI have 3 tables: a `tool_models` table which has a foreign relation to `brands` (which has a `brand_name` field) and `manufacturers` (which has a `manufacturer_name` field).\r\n\r\nI am trying to query `tool_models` by `brand_name` and `manufacturer_name` via the API. Since the `q` query parameter only works for root fields, I'm trying to do what I need via filtering. Here is the API call I am attempting:\r\n\r\n```\r\n/_/items/tool_models\r\n  ?filter[manufacturer.manufacturer_name][logical]=or\r\n  &filter[manufacturer.manufacturer_name][like]=dewalt\r\n  &filter[brand.brand_name][logical]=or\r\n  &filter[brand.brand_name][like]=dewalt\r\n```\r\n\r\nThis does not appear to work ‚Äî no results were returned when I expected several. I turned on MySQL logging and can see that the query generated by this API call looks like this:\r\n\r\n```sql\r\nSELECT `tool_models`.`id` AS `id`,\r\n       `tool_models`.`brand` AS `brand`,\r\n       `tool_models`.`manufacturer` AS `manufacturer`\r\nFROM `tool_models`\r\nWHERE `tool_models`.`manufacturer` IN\r\n    (SELECT `manufacturers`.`id` AS `id`\r\n     FROM `manufacturers`\r\n     WHERE `manufacturers`.`manufacturer_name` LIKE '%dewalt%')\r\n  AND `tool_models`.`brand` IN\r\n    (SELECT `brands`.`id` AS `id`\r\n     FROM `brands`\r\n     WHERE `brands`.`brand_name` LIKE '%dewalt%')\r\nORDER BY `tool_models`.`id` IS NULL,\r\n                               `tool_models`.`id` ASC,\r\n                               `tool_models`.`id` ASC LIMIT 200\r\nOFFSET 0;\r\n```\r\n\r\nIt appears the query generator is ignoring the `logical=or` when relations are involved. If the `AND` between the two subqueries was an `OR` instead, everything would work properly.\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nSee above\r\n\r\n## Expected Behavior\r\n\r\nGenerated SQL should contain `OR` instead of `AND`\r\n\r\n## Actual Behavior\r\n\r\nGenerated SQL contains `AND` instead of `OR`\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS 10.14.2\r\n- Web Server: Apache 2.4.29\r\n- PHP Version: 7.2.17\r\n- Database: MySQL 5.7.26\r\n- Install Method:  cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'File Library' in the Admin app at [yourAPI]/admin\r\n2. Click on '+' to add a new file, and upload a file over 17MB.\r\n3. Admin app shows a green checkmark (successful upload)\r\n4. Go to your storage (s3 bucket or directus/public/uploads/{projectname}/originals) and examine the uploaded file.\r\n\r\n## Expected Behavior\r\nAny file that you uploaded should have been uploaded successfully without any change, regardless of the file size.\r\n## Actual Behavior\r\nIf upload file was over 17MB, the destination file exists and is named properly.  Size is 0 bytes.  Smaller files work normally.\r\n## Other Context & Screenshots\r\nIn other installations of Directus, the cutoff file size was variously 25MB or 20MB.  In this setup, the cutoff is 17MB.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Digital Ocean one-click LAMP server\r\n- OS: Ubuntu 18.04\r\n- Web Server: Apache 2.4.29\r\n- PHP Version: 7.2.17\r\n- Database: MySQL 5.7.26\r\n- Install Method: cloned `master` branch\r\n![large_file](https://user-images.githubusercontent.com/34310383/58982540-b30df980-87a2-11e9-9aed-e2c9999f0971.JPG)\r\n![large_vs_small_file](https://user-images.githubusercontent.com/34310383/58982541-b30df980-87a2-11e9-986d-5d2910a48542.JPG)\r\n\r\n\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nWhen working with items that contain a large dataset in a M2M or O2M relation the api (and app) will be very slow in loading the post (if loading at all). We utilize Directus to feed certain apps we develop. As example we use Directus to record users' push token information and to schedule push notifications in a O2M fashion by using a webhook to attach all targeted users to the notification. However whenever we need to alter the push notification after the webhook attached all the users the item on the api will occasionally timeout and report back with an API error.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create two collections (Users / notifications)\r\n2. Insert more than 5000 rows in the users collection\r\n3. Create a notification, have a webhook attach all users on create\r\n4. Try to open the post on the API\r\n\r\n## Expected Behavior\r\n\r\nThe post would open fairly fast\r\n\r\n## Actual Behavior\r\n\r\nItem might timeout and report an error.\r\n\r\n## Other Context & Screenshots\r\n\r\nWhen I tried refactoring it by omitting the ItemsService and using old fashion queries I was able to load the items very fast (less than a second), however this didn't work with the App. I feel like the issue might be related to the fact the ItemsService creates multidimensional object out of the rows.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- Web Server: Apache 2\r\n- PHP Version: 7.2.18\r\n- Database: MySQL 5.0.12\r\n- Install Method: Online: Suite, Local: Cloned master branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\nFailed to generate the SQL query in the online demo app, I don't know if this issue is related to demo only \r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'https://directus.app/#/collections/sales/91315'\r\nor any other items in the sales collection\r\n2. try increasing Sale Amount field past 10 $\r\n3. See error\r\n```javascript\r\n{code: 9, message: \"Failed generating the SQL query.\", query: \"UPDATE `sales` SET `sale_amount` = '10.23', `id` = '91315' WHERE `id` = '91315'\"}\r\n```\r\n"},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n- create a collection\r\n- create a new role (making things only readable to \"me\")\r\n![Screenshot 2019-05-31 at 10 34 36](https://user-images.githubusercontent.com/724844/58693062-3937d380-8390-11e9-948b-0278ce3692da.png)\r\n- create new entry as admin, and one as user with the new role\r\n\r\n## Expected Behavior\r\nwhen logged in as non-admin user, the search field should say \"1 item\"\r\n\r\n## Actual Behavior\r\nit shows \"2 items\" (also counting the item created by the admin user)\r\n![Screenshot 2019-05-31 at 10 33 49](https://user-images.githubusercontent.com/724844/58693199-8451e680-8390-11e9-9a32-15718078dcd4.png)\r\nnot sure if this is intented or not.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\ndocker: `directus/api:latest` + `directus/app:latest`"},{"labels":["bug"],"text":"In relation to #1757 and #2292, I'm trying to get ONLY **full_url** using **fields=featured_image.data.full_url** but it returns the entire **featured_image.data object**.\r\n\r\nIs this intentional? If so, is there a proper way to directly get the file data properties without return the entire file data?"},{"labels":["bug",null,null],"text":"# Feature Request\r\n\r\nAbout audited Directus version. \r\nIt has been cloned from suite repo.\r\nLatest commit https://github.com/directus/directus/commit/1d151a9034514e3f2ec1c80001e7c5fffdef2d4e\r\n\r\n## Description:\r\n\r\nInsufficient Anti-automation occurs when a web application permits an attacker to automate a process that was originally designed to be performed only in a manual fashion, i.e. by a human web user.\r\n\r\n## Business risk:\r\n\r\nOnce exploited, attackers can use an automatic tool or a simple script that performs a brute-force authentication attempts, and possible cause a legitimate user lock out.\r\n\r\n## Technical details:\r\n\r\nThe login mechanism of the application does not prevent a brute-force on login attempts and on change password function.\r\n\r\n## What problem does this feature solve?\r\nFixes security hole.\r\n\r\n## How do you think this should be implemented?\r\n* Implement an anti-automation mechanism such as CAPTCHA\r\nNote: do not use account locking, because of the ability to perform a DoS on user accounts.\r\n* Complementary instructions for protecting brute-forcing on users can be found in the following URL:\r\nhttp://projects.webappsec.org/w/page/13246938/Insufficient%20Anti-automation\r\nhttps://www.owasp.org/index.php/Blocking_Brute_Force_Attacks\r\n\r\n## Would you be willing to work on this?\r\nMaybe, with help/guidance from Directus team."},{"labels":["bug"],"text":"# Bug Report\r\n\r\nUser invitation feature doesn't work.\r\n\r\n## Steps to Reproduce\r\n\r\n```shell\r\nPOST http://api.directus.test/_/users/invite\r\n```\r\n```json\r\n{\r\n  \"email\": \"new_test@example.com\"\r\n}\r\n```\r\n\r\nReceived mail contains this activation url:\r\n\r\n```\r\nhttp://api.directus.test/_/auth/invitation/eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRlIjoiMjAxOS0wNS0yOSAxNzowOTowNiIsImV4cCI6IjIwMTktMDYtMjggMTc6MDk6MDYiLCJlbWFpbCI6Im5ld190ZXN0QGV4YW1wbGUuY29tIiwic2VuZGVyIjoxLCJ0eXBlIjoiaW52aXRhdGlvbiIsImtleSI6IjI0ZmVhMTQ4LWQ5YTYtNGY5My04NjQ0LTBlNjI2NDRkYTM1ZSIsInByb2plY3QiOiJfIn0.3PcwqPtXgnsoHLz0t4EVADkSNGN1-0YzBv7gsgLHn9E\r\n```\r\n\r\n## Expected Behavior\r\nFrom [API reference](https://docs.directus.io/api/reference.html#invite-user)\r\n> Invites one or more users to this project. It creates a user with an invited status, and then sends an email to the user with instructions on how to activate their account.\r\n> The API will generate and send a JWT token inside the email for this specific request.\r\n\r\n## Actual Behavior\r\n\r\n* Generates mail with invalid link(`/[project]/auth/invitation/{token}` instead of `/[project]/users/invite/{token}`)\r\n* Generates token with invalid payload\r\n* User cannot accept his invitation by generated link([Accept User Invitation](https://docs.directus.io/api/reference.html#accept-user-invitation) method supports only POST)\r\n* Does nothing if user with provided email already exists.\r\n* `Accept User Invitation` endpoint throws `ForbiddenException` with generated token.\r\n\r\n## Other Context & Screenshots\r\n\r\nI figured out how to fix token payload and translate invited user status to `active` in `enableUserWithInvitation` method. I'll submit PR soon.\r\n\r\n## Technical Details\r\n\r\n- Device: Macbook\r\n- OS: MacOS 10.14.5\r\n- Web Server: Apache/2.4.34 (Unix)\r\n- PHP Version: 7.2.10\r\n- Database: MySQL 5.7.23\r\n- Install Method: cloned `master`\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nI have a table `products` with a M2M field `related_products` which references the same table. Products can be draft or published. I'm trying to filter so the related_products are only populated with published products.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a table products with a status field and a M2M field `related_products` referencing the same table. autogenerate relations (make sure to fix same-name columns)\r\n2. Fill it with a few dummy products in draft and published state, and enter a few relations\r\n3. Query the api `items/products?filter[related_products.status][eq]=published&fields=*.*.*.*&status=published`\r\n4. See error\r\n\r\n```\r\n\"code\": 9,\r\n \"message\": \"Failed generating the SQL query. Statement could not be executed (42S22 - 1054 - Unknown column 'product.related_products' in 'field list')\",\r\n```\r\n\r\nThe created MSQL query seems to make sense though as far as I can tell:\r\n\r\n```\r\n(SELECT `products`.`related_products` AS `related_products` FROM `products` WHERE `products`.`related_products` IN (SELECT `products`.`id` AS `id` FROM `products` WHERE `products`.`status` = 'published'))\r\n```\r\n## Expected Behavior\r\n\r\napi response with related_products only populated with \"published\" products\r\n\r\n## Actual Behavior\r\n\r\nSQL error\r\n\r\n## Other Context & Screenshots\r\n\r\nI'm trying to recreate this on the demo installation but keep crashing the server I think ü§î \r\n"},{"labels":["bug",null,null,null],"text":"# Feature Request\r\n\r\nAbout audited Directus version. \r\nIt has been cloned from suite repo.\r\nLatest commit https://github.com/directus/directus/commit/1d151a9034514e3f2ec1c80001e7c5fffdef2d4e\r\n\r\n## Description:\r\n\r\nUnauthenticated attackers can bypass the application's authentication enforcement and directly access internal components, effectively circumventing the authentication credentials validation phase.\r\n\r\n## Business risk:\r\n\r\nAn attacker can get an access to the possible sensitive files.\r\n\r\n## Technical details:\r\n\r\nForceful Browsing attacks (direct access to internal components) can be used to exploit incomplete authentication enforcement in the server-side application. The forceful browsing technique enables attackers to access internal sensitive components, without undergoing the application authentication credentials validation phase.\r\n\r\nThrough the following link it is possible to get an access to application images that should be accessible after the authentication.\r\n\r\n`https://xxxxxxxx/uploads/_/originals/photo2_fullsize.jpg`\r\n\r\n![screenshot](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.6.jpg)\r\n\r\n## What problem does this feature solve?\r\nFixes security hole.\r\n\r\n## How do you think this should be implemented?\r\n* As a general rule, system components should not be accessible to unauthenticated users (excluding the authentication component, which is unique, as unauthenticated access to it is a functional requirement).\r\n* The authentication enforcement mechanism should be thoroughly and comprehensively implemented in the system. The authentication validation should be performed as the first validation in each access to the system. The accessing entity should be obligated to authenticate with the system as a pre-condition to use the system‚Äôs services. After a successful authentication process, the user server-side session storage should be \"populated\" with the permissions of authorized actions.\r\n* It is recommended to use authentication enforcement mechanisms that operate globally (effectively affecting all components), instead of implementing authentication validation within each separate component. Authentication validation implementation through applicative filters or infrastructure authentication declarations is highly recommended, since it is less likely to be prone to authentication flaws resulting from human error. Furthermore, these mechanisms are easier to manage and are usually well tested and widely used.\r\n\r\n## Would you be willing to work on this?\r\nMaybe, with help/guidance from Directus team."},{"labels":["bug",null,null,null],"text":"# Feature Request\r\n\r\nAbout audited Directus version. \r\nIt has been cloned from suite repo.\r\nLatest commit https://github.com/directus/directus/commit/1d151a9034514e3f2ec1c80001e7c5fffdef2d4e\r\n\r\n## Description:\r\n\r\nIn Internet systems, there is sometimes a file upload mechanism, which allowing the user to upload files to share information between entities that communicate through the application. Files upload mechanism often generate direct links to download the uploaded files from the system. These mechanisms sometimes choose a name of file and store the uploaded file according to the name the chosen on the web server. A mechanism that defines file names in a sequence numbers is an insecure mechanism because it allows guessing of uploaded files more easily, thus allowing access to sensitive personal information.\r\n\r\n## Business risk:\r\n\r\nAfter exploiting this vulnerability, an attacker can easily guess links to uploaded files.\r\n\r\n## Technical details:\r\n\r\nDuring the test, it was found that the application‚Äôs upload files mechanism generates static links to uploaded files, thing that allows an attacker to get access to uploaded files that were uploaded into the system, even if were uploaded by other users.\r\n\r\n![screenshot](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.2.jpg)\r\n\r\n## What problem does this feature solve?\r\nFixes security hole.\r\n\r\n## How do you think this should be implemented?\r\n* Do not let users to get access to upload files that were uploaded by another users.\r\n* Image ID should be chosen by unpredictable way and one-time random token should be appended to the\r\nlink in order to prevent exact link guessing.\r\n* Implement an authorization mechanism that validate if user authorized to view or download the specific file.\r\n\r\n## Would you be willing to work on this?\r\nMaybe, with help/guidance from Directus team."},{"labels":["bug",null,null],"text":"# Feature Request\r\n\r\nAbout audited Directus version. \r\nIt has been cloned from suite repo.\r\nLatest commit https://github.com/directus/directus/commit/1d151a9034514e3f2ec1c80001e7c5fffdef2d4e\r\n\r\n## Description:\r\n\r\nDirectory listing provides an attacker with the complete index of all the resources located inside the directory. Some of these files could contain sensitive information or various possible attack vectors.\r\n\r\n## Business risk:\r\n\r\nDiscovering an informative about the internal technologies, components and their versions may help an attacker to perform a successful attack, since they can search and exploit known server vulnerabilities for that specific server type and version.\r\n\r\n## Technical details:\r\n\r\nThe following screenshots represent directory listing on two specific URLs:\r\n\r\n`https://xxxxxx/icons/`\r\n`https://xxxxxx/icons/small/`\r\n\r\n![screenshot](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.16.jpg)\r\n\r\n## What problem does this feature solve?\r\nFixes security hole.\r\n\r\n## How do you think this should be implemented?\r\n\r\n* Restrict access to a fixed location where only the client's files are stored.\r\n* Disable directory listing for all pages.\r\n\r\n## Would you be willing to work on this?\r\nMaybe, with help/guidance from Directus team."},{"labels":["bug",null,null],"text":"# Feature Request\r\n\r\nAbout audited Directus version. \r\nIt has been cloned from suite repo.\r\nLatest commit https://github.com/directus/directus/commit/1d151a9034514e3f2ec1c80001e7c5fffdef2d4e\r\n\r\n### Description:\r\n\r\nIn a replay attack the attacker issues requests that are identical to the ones the user has sent. The application could not distinguish the original legitimate request from the malicious identical requests and will process them again. If HTTPS encryption is in place while call sent to the REST API, then the protocol protects application from replay attacks at the network level. But it will not prevent legitimate clients from issuing the same request multiple times.\r\n\r\n### Business risk:\r\n\r\nA legitimate but malicious user can perform a successful attack against the system.\r\n\r\n### Technical details:\r\n\r\nBy sending a great number of HTTP requests to the web server it is possible in some cases to cause a Denial of Service condition to the application.\r\n\r\nThe following screenshot represent several identical requests sent by the same user in a short period of time:\r\n\r\n![screenshot](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.8.jpg)\r\n\r\n## What problem does this feature solve?\r\nFixes security hole.\r\n\r\n## How do you think this should be implemented?\r\nIt is recommended to implement an anti-automation mechanism such as CAPTCHA.\r\n\r\n## Would you be willing to work on this?\r\nMaybe, with help/guidance from Directus team."},{"labels":["bug",null,null],"text":"# Feature Request\r\n\r\nAbout audited Directus version. \r\nIt has been cloned from suite repo.\r\nLatest commit https://github.com/directus/directus/commit/1d151a9034514e3f2ec1c80001e7c5fffdef2d4e\r\n\r\n### Description:\r\n\r\nThe file upload mechanism allows to get a direct link the uploaded file without any authentication. In addition, the upload file mechanism does not enforce any restriction file extensions or mime type check. This vulnerability allows an attacker to use it to distribute malicious / spyware / malware files etc.\r\n\r\n### Business risk:\r\n\r\nAfter exploiting this vulnerability, an attacker can upload a malicious file to the server.\r\n\r\n### Technical details:\r\n\r\nThe upload mechanism allows a malicious user to upload any file into the system. \r\n\r\nThe following link is the URL to the uploaded eicar malicious testing file.\r\n\r\n`https://xxxxxxx/uploads/_/originals/eicar.com.txt`\r\n\r\n![img1](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.3.jpg)\r\n\r\nA malicious user can use this functionality in order to upload a malicious file and to send it by a legitimate link to other victims and to attack them using their trust to the system.\r\n\r\nIt was also found that file size limitations are permit to users upload large size files (Maximum 50MB) in cases even when a size of uploaded file not required to be large as for example image for the user‚Äôs avatar.\r\n\r\n![img2](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.3_1.jpg)\r\n\r\n## What problem does this feature solve?\r\nFixes security hole.\r\n\r\n## How do you think this should be implemented?\r\n* Do now allow any access to uploaded files without any authentication.\r\n* Restrict file extensions using whitelist approach. The file types allowed to be uploaded should be restricted to only those that are necessary for business functionality.\r\n* The application should perform filtering and content checking on any files which are uploaded to the server. Files should be thoroughly scanned and validated before being made available to other users.\r\n* Limit the file size to a reasonable maximum value in order to prevent denial of service attacks (on file space or other web application‚Äôs functions such as the image resizer).\r\n* Use a virus scanner on the server (if it is applicable). Or, if the contents of files are not confidential, a free virus scanner website can be used. In this case, file should be stored with a random name and without any extension on the server first, and after the virus checking (uploading to a free virus scanner website and getting back the result), it can be renamed to its specific name and extension.\r\n* Implement an authorization mechanism that validate if user authorized to view or download the specific file.\r\n\r\n## Would you be willing to work on this?\r\nMaybe, with help/guidance from Directus team."},{"labels":[null,"bug"],"text":"# Feature Request\r\n\r\nAbout audited Directus version. \r\nIt has been cloned from suite repo.\r\nLatest commit https://github.com/directus/directus/commit/1d151a9034514e3f2ec1c80001e7c5fffdef2d4e\r\n\r\n## Description:\r\n\r\nAn attacker can exploit the file upload function (which lacks efficient restrictions and validations) by uploading web shell to uploads storage directory. Thus, the attacker can take control of the accounts and workstations of application users and administrators and the server itself.\r\n\r\nThe attacker does not need a very high level of technological knowledge to perform this attack. However, he does need specially crafted malicious files.\r\n\r\n## Business risk:\r\n\r\nA malicious user can complete take over the application and the server.\r\n\r\n## Technical details:\r\n\r\nThe upload functionality allows to a user to upload image as a avatar in its profile, however because there are no any validations of the uploaded file types and because of uploaded directory has a `execute` permissions this functionality can be abused by a malicious user in order to upload web shell and take over the whole system.\r\n\r\nIn the screenshots bellow it is possible to see that web shell file was uploaded to the sever via avatar upload functionality. As it is possible to see an attacker was able to run commands on the backend server.\r\n\r\nAs the application sets cookie `PHPSESSID` ‚Äì it is possible to understand that the server-side programming language is PHP.\r\n\r\n\r\n![img1](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.1.jpg)\r\n\r\nIt was also possible to see that every user has a direct access to the uploaded file:\r\n\r\n![img2](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.1_1.jpg)\r\n\r\nAnd\r\n\r\n![img3](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.1_1_1.jpg)\r\n\r\nOnce, an attacker knows which type of shell he needs the next step is uploading web shell itself:\r\n\r\n![img4](https://s3.eu-central-1.amazonaws.com/directus-security-report/4.0.1_2.jpg)\r\n\r\nIt is possible to see that an attacker is able to run commands on the backend server itself, thus can completely compromise the server.\r\n\r\n## What problem does this feature solve?\r\nFixes security hole.\r\n\r\n## How do you think this should be implemented?\r\n* The uploaded file types must be restricted only to the necessary file types and be validated on the server side.\r\n* Uploaded directory should not have any `execute` permission and all the script handlers should be removed from these directories.\r\n\r\n## Would you be willing to work on this?\r\nMaybe, with help/guidance from Directus team."},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nWhen you use a files or file interface you also join users and roles to the collection.\r\nDuring the update the RelationalTableGateway (line 622ff) also tries to update directus_user_roles and directus_roles which is only allowed for admin users (CoreServiceProvider line 643ff). \r\n\r\n## Steps to Reproduce\r\n1. Create a collection with \"user-created\" interface and add a \"files\" interface. \r\n2. Autocreate relations. \r\n3. Add a role, grant \"mine\" permission to \"select/update/delete\". \r\n4. Upload a file, select the file in the \"files\" interface.\r\n5. Click save.\r\n \r\n## Expected Behavior\r\nItem and relation should be saved.\r\n\r\n## Actual Behavior\r\nError: you can not update item in directus_user_roles.\r\n\r\n## Other Context & Screenshots\r\nI would suggest excluding system tables like directus_user_roles, directus_user and directus_roles from the update process in the  RelationalTableGateway.\r\n\r\n## Technical Details\r\nmanual install with latest api and app master branch.\r\n"},{"labels":["bug"],"text":"I'm trying to create a new user using a non-administrator role. I'm having and error `Creating item to \"directus_user_roles\" collection was denied`.\r\n if I go back to the user directory after the error, the users is created but without the role in place. Editing the same user result into the same error.\r\n\r\nI already set the core permission to the role. Like so: \r\n![image](https://user-images.githubusercontent.com/8966692/57904928-560bdb80-78a7-11e9-8a3e-92d49e78599c.png)\r\n\r\nI tried commenting the script below in **CoreServicesProvider.php** but it still didn't work.\r\n `if (!$acl->isAdmin()) {\r\n                    throw new ForbiddenException('You are not allowed to create, update or delete roles');\r\n                }`\r\n\r\nMy goal is allow non-admins to manage their club members on their own without the administrator assistance.\r\nIs this possible on the application? Is there a misconfiguration or additional step to make this work?\r\n"},{"labels":["bug",null,null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nLet me explain my problem:\r\n\r\nI'm running the Directus App and Directus API in two seperate clusters on Kubernetes  (using the official docker images), in between them is a API Gateway which reroutes everything related to Directus straight to the API, I've configured my API end-point as follows:\r\n\r\n`https://example.com/directus/_/`\r\n\r\nI also configured the following env/config options as follows:\r\n\r\n\r\n\r\n```\r\nSTORAGE_ROOT=https://example.com/directus/public/uploads/_/originals\r\n\r\nSTORAGE_ROOT_URL=https://example.com/directus/uploads/_/originals\r\n\r\nSTORAGE_THUMB_URL=https://example.com/directus/public/uploads/_/thumbnails\r\n```\r\n\r\n\r\n\r\nIt all seems good in the responses from the API, the URLS are pointing to the right place, but inside the app it just tries to acces the following `https://example.com/thumbnails/*` which is ofcourse wrong, it seems like it doesn't take the values into account from the api response\r\n\r\nIn the API response there is a block called thumbnails with the right paths, but the app doesn't pick it up, maybe a bug?\r\n\r\n## Steps to Reproduce\r\n\r\nSee above\r\n\r\n## Expected Behavior\r\n\r\nUsing the thumbnail urls from the data response from the API\r\n\r\n## Actual Behavior\r\n\r\nUsing wrong thumbnail urls, don't know even where they are coming from\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10 1809\r\n- Browser: Firefox latest\r\n- Directus App: Latest Docker image\r\n- Directus API: Latest Docker Image\r\n- Install Method: Docker images\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\nSend a mail with the type option set to plain, example payload: \r\n\r\n```json\r\n{\r\n  \"to\": [\r\n    1,\r\n    \"cesar@wdinamo.com\",\r\n    2,\r\n    {\"email\": \"cesasol@hotmail.com\", \"name\": \"Cesar Doe\"}\r\n  ],\r\n  \"subject\": \"Prueba\",\r\n  \"body\": \"Este es un texto de prueba\",\r\n  \"type\": \"plain\",\r\n  \"data\": {}\r\n}\r\n```\r\n\r\n## Expected Behavior\r\n\r\nSend the raw body of the payload.\r\n\r\n## Actual Behavior\r\n\r\nThe mail is sent with html and as plain text resulting in viewing the html code.\r\n\r\n## Other Context & Screenshots\r\n\r\n![Screenshot_20190517_173039](https://user-images.githubusercontent.com/3846473/57959473-9da35f00-78c9-11e9-8ea3-6124a097bc61.png)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Linux\r\n- Web Server: Nginx\r\n- PHP Version: 7.2.x\r\n- Database: MySQL\r\n- Install Method: cloned the directus repo\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Add Collection `blog`\r\n2. Add fileds `title`,`description`\r\n3. Add blog posts,  title ` Hello world `,description ' Hello Directus '\r\n4.Edit this post,click ` save as copy `\r\n\r\n![image](https://user-images.githubusercontent.com/8030134/57797038-20b69f00-777c-11e9-8774-8b13a4f2f7dc.png)\r\n\r\n5.delet this copy\r\n\r\n6.filter user ` logical `\r\n``` javascript\r\n  const getparams = {\r\n    meta:\"result_count\",\r\n    fields: \"id,title,description\",\r\n    filter: {\r\n      title:{\r\n        logical:'or',\r\n        contains: 'Hello'\r\n      },\r\n      description:{\r\n        logical:'or',\r\n        contains: 'Hello'\r\n      }\r\n    },\r\n    status: \"published\"\r\n  }\r\n  \r\n  client.getItems(\"blog\",getparams).then((res) => {\r\n    console.log('list',res.data)\r\n  });\r\n```\r\n6.The deleted data can also be queried because there is this item in the database.\r\n\r\n## Expected Behavior\r\n\r\n## Actual Behavior\r\n\r\n## Other Context & Screenshots\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop]\r\n- OS: [eg: MacOS 10.13.6]\r\n- Web Server: [eg: Nginx 1.8]\r\n- PHP Version: [eg: 7.3]\r\n- Database: [eg: MySQL 5.7]\r\n- Install Method: [eg: cloned `master` branch]\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nIssue on obtaining result while using custom filter hook\r\n\r\n## Steps to Reproduce\r\n\r\n## Expected Behavior\r\nI have product collection with more than 500 records. Product records were created by different users.\r\nI want product collection to return results of a specific user. So I added a custom filter hook. I printed the payload its shows the payload is modified as expected. but its is not returning the expected result. Showing all the products. \r\n**note**: I want to see products of user id 2,3,4.... in the frontend. \r\n\r\n## Actual Behavior\r\nshowing all users products.\r\n\r\n## Other Context & Screenshots\r\n```\r\nreturn [\r\n    'filters' => [\r\n        'item.read.product:before' => function (\\Directus\\Hook\\Payload $payload) {\r\n            $userProduct = new userProduct();\r\n            $filterPayload = $userProduct->handle($payload);\r\n            return $filterPayload;\r\n        }\r\n    ]\r\n];\r\n```\r\nin my UserProduct class .php file, I am adding the filter array.\r\n```\r\nclass UserProduct  implements HookInterface {\r\npublic function getUserProduct($payload = null)\r\n{\r\n        $ids = '2,3,4';\r\n        $key = 'filter';\r\n        $value = array('user' => array('in' => $ids));\r\n        $payload->set($key, $value);\r\n        return $payload;\r\n}\r\npublic function handle($payload = null)\r\n    {\r\n        $this->getUserProduct($payload);\r\n        return $payload;\r\n    }\r\n```\r\n**below is the screen shot of my payload with [filter][user]=>2,3,4**\r\n![image](https://user-images.githubusercontent.com/17745437/57752686-96345800-7707-11e9-860b-7e4df44b0e77.png)\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop, iPhone6, etc]\r\n- OS: [eg: MacOS 10.13.6, Windows 10.1803]\r\n- Web Server: [eg: Apache 2.4.37]\r\n- PHP Version: [eg: 7.2.0]\r\n- Database: [eg: MySQL 8.0.12]\r\n- Install Method: [eg: cloned `master` branch]\r\n\r\n"},{"labels":[null,"bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to `Admin setting` -> Click to `Collections and fields` -> Click to some field -> Toggle `required` -> Click `Save`\r\n2. Show error. but it is toggled actually.\r\n\r\n## Expected Behavior\r\nToggled `required` without error.\r\n\r\n## Actual Behavior\r\nToggled `required` with 500 error.\r\n\r\n## Other Context & Screenshots\r\n```\r\n$ curl 'https://directus.local/_/fields/post/content' -X PATCH -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0' -H 'Accept: application/json, text/plain, */*' -H 'Accept-Language: ko-KR,ko;q=0.8,en-US;q=0.5,en;q=0.3' --compressed -H 'Referer: https://directus.local/admin/' -H 'Content-Type: application/json;charset=utf-8' -H 'Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MSwiZXhwIjoxNTU3ODkzOTc4LCJ0eXBlIjoiYXV0aCIsImtleSI6IkFlZDFhZXBoYWU3T25haWRvbzBjYWVHb2hzN1dlZTdPIiwicHJvamVjdCI6Il8ifQ.kM6cDgiE9eu6V6vHF--srdHDYIm2u5H0B48EuWs_FQQ' -H 'Connection: keep-alive' -H 'Cookie: __cfduid=df27f248e24c4efbaa82ddad80cb8400f1557842991; PHPSESSID=tmdbsh6l2m3nsgvhkgiv4ec7o3' -H 'TE: Trailers' --data '{\"id\":446,\"sort\":null,\"field\":\"content\",\"type\":\"string\",\"datatype\":\"VARCHAR\",\"interface\":\"text-input\",\"default_value\":null,\"options\":{\"trim\":true,\"showCharacterCount\":true,\"formatValue\":false,\"width\":\"auto\"},\"readonly\":false,\"required\":false,\"unique\":false,\"note\":\"\",\"hidden_detail\":false,\"hidden_browse\":false,\"primary_key\":false,\"validation\":null,\"width\":\"full\",\"length\":\"200\"}'\r\n{\"error\":{\"code\":null,\"message\":\"Invalid key \\\"tag!entity_directus_fields_text-input\\\". Valid filenames must match [a-zA-Z0-9_\\\\.! ].\"}}\r\n```\r\n\r\n## Technical Details\r\n- PHP 7.0.0p1, mariadb-10.1.13\r\n- Install Method: upgrade to latest release"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nI noticed a strange bug in API: updateding a numeric interface will reset it's decimal precision to \"x,0\". Can't see a reason, why?\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'Admin Settings'\r\n2. Add 'numeric' Interface to any table, setting \"decimal\" and e.g. _10,4_ as length.\r\n3. Update the same column again (you will see _10,4_ as expected), setting length to _10,2_\r\n4. Update again (just open the modal) you will see _10,0_\r\n\r\n## Expected Behavior\r\n\r\nI expected it the decimals length to be _10,2_.\r\n\r\n## Actual Behavior\r\n\r\nI got _10,0_\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\nThis issue was already reported here: https://github.com/directus/api/issues/814\r\n\r\nIt seems that the App is sending the correct length: _10,2_. But Api is responding with _10,0_.\r\nAlso the MySQL database's column structure will be: `DECIMAL(10,0)`. \r\n\r\nModify the column in MySQL directly works as a workaround.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Linux Fedora 29\r\n- Web Server: nginx (docker)\r\n- PHP Version: 7.2 (docker)\r\n- Database: MySQL 5.7.20\r\n- Install Method: (docker) directus/api:2.0.18\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection\r\n2. Remove 'ID'\r\n3. Create Text Input 'key' and set as primary key\r\n4. Create collection item with key\r\n5. Go to collection item list and try to open created item\r\n6. See error\r\n\r\n## Expected Behavior\r\nCorrect SQL is created and Collection item edit screen is shown.\r\nIn my case the correct SQL would be: \r\n[correct_sql.txt](https://github.com/directus/api/files/3162838/correct_sql.txt)\r\n\r\n## Actual Behavior\r\nWrong SQL is created: \r\n[wrong_sql.txt](https://github.com/directus/api/files/3162839/wrong_sql.txt)\r\nError message is displayed.\r\n\r\n## Other Context & Screenshots\r\n\r\nI'm no expert on MySQL Syntax but it seems clear that the generated syntax is wrong: \r\nCAST(key as CHAR) IN ('key') should be CAST(\\`key\\` as CHAR) IN ('key'). \r\n\r\nBtw. when I change the field type to CHAR instead of VARCHAR then it always sets a length of 1 for the field and all tries to save keys longer than that fail.\r\n\r\nI am using the app, the error is returned from the api as a `500 Internal Server Error`:\r\n\r\n{\r\n    \"error\": {\r\n        \"code\": 9,\r\n        \"message\": \"Failed generating the SQL query.\",\r\n        \"query\": \"SELECT \\`content_component_layout\\`.\\`created_on\\` AS \\`created_on\\`, \\`content_component_layout\\`.\\`modified_by\\` AS \\`modified_by\\`, \\`content_component_layout\\`.\\`modified_on\\` AS \\`modified_on\\`, \\`content_component_layout\\`.\\`key\\` AS \\`key\\`, \\`content_component_layout\\`.\\`layout\\` AS \\`layout\\`, \\`content_component_layout\\`.\\`interface_type\\` AS \\`interface_type\\`, \\`content_component_layout\\`.\\`created_by\\` AS \\`created_by\\` FROM \\`content_component_layout\\` WHERE CAST(key as CHAR) IN ('Default_TextArea') ORDER BY \\`content_component_layout\\`.\\`key\\` IS NULL, \\`content_component_layout\\`.\\`key\\` ASC, \\`content_component_layout\\`.\\`key\\` ASC LIMIT 1 OFFSET 0\"\r\n    }\r\n}\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: macbook\r\n- OS: MacOS 10.14.4 \r\n- Web Server: Apache/2.4.34 (Unix)\r\n- PHP Version: 7.1.23\r\n- Database: 8.0.16 (MySQL Community Server - GPL)\r\n- Install Method: cloned `build` branch\r\n"},{"labels":["bug"],"text":"\r\n\r\n# Bug Report\r\n\r\nAttempting to install new Directus site but fails at database creation. Used to work on same server. Think this is a bug recently introduced.\r\n\r\nLatest commit is, commit eb93d96756de9c7805ed12d249f21eabc94620b6 on May 3\r\n\r\n## Steps to Reproduce\r\n\r\n1. Download latest Directus from Git\r\n2. Install as documented and run /admin\r\n3. Create a new utf8mb4 database in MariaDB\r\n4. Follow install prompts\r\n\r\n## Expected Behavior\r\n\r\nDirectus installs.\r\n\r\n## Actual Behavior\r\n\r\nSQL Error.\r\n`[2019-05-09 10:17:39] api[].ERROR: PDOException: SQLSTATE[HY000]: General error: 1709 Index column size too large. The maximum column size is 767 bytes. in /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php:134\r\nStack trace:\r\n#0 /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php(134): PDO->exec\r\n#1 /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/MysqlAdapter.php(294): Phinx\\Db\\Adapter\\PdoAdapter->execute\r\n#2 /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/AdapterWrapper.php(351): Phinx\\Db\\Adapter\\MysqlAdapter->createTable\r\n#3 /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/TimedOutputAdapter.php(138): Phinx\\Db\\Adapter\\AdapterWrapper->createTable\r\n#4 /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Db/Table.php(628): Phinx\\Db\\Adapter\\TimedOutputAdapter->createTable\r\n#5 /home/collection/directus/migrations/db/schemas/20180220023152_create_collections_presets_table.php(81): Phinx\\Db\\Table->create\r\n#6 /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Migration/Manager/Environment.php(124): CreateCollectionsPresetsTable->change\r\n#7 /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Migration/Manager.php(375): Phinx\\Migration\\Manager\\Environment->executeMigration\r\n#8 /home/collection/directus/vendor/robmorgan/phinx/src/Phinx/Migration/Manager.php(351): Phinx\\Migration\\Manager->executeMigration\r\n#9 /home/collection/directus/src/core/Directus/Util/Installation/InstallerUtils.php(145): Phinx\\Migration\\Manager->migrate\r\n#10 /home/collection/directus/src/core/Directus/Util/Installation/InstallerUtils.php(112): Directus\\Util\\Installation\\InstallerUtils::runMigrationAndSeeder\r\n#11 /home/collection/directus/src/core/Directus/Services/ProjectService.php(92): Directus\\Util\\Installation\\InstallerUtils::createTables\r\n#12 /home/collection/directus/src/endpoints/ProjectsCreate.php(16): Directus\\Services\\ProjectService->create\r\n#13 [internal function]: Directus\\Api\\Routes\\ProjectsCreate->__invoke\r\n#14 /home/collection/directus/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\n#15 /home/collection/directus/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#16 /home/collection/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->__invoke\r\n#17 /home/collection/directus/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\n#18 /home/collection/directus/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\n#19 /home/collection/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->__invoke\r\n#20 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#21 /home/collection/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#22 [internal function]: Slim\\DeferredCallable->__invoke\r\n#23 /home/collection/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#24 /home/collection/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#25 /home/collection/directus/vendor/slim/slim/Slim/App.php(405): Slim\\App->callMiddlewareStack\r\n#26 /home/collection/directus/vendor/slim/slim/Slim/App.php(313): Slim\\App->process\r\n#27 /home/collection/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#28 /home/collection/directus/public/index.php(5): Directus\\Application\\Application->run [] []`\r\n\r\n## Other Context & Screenshots\r\n\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS\r\n- Web Server: Apache 2.4\r\n- PHP Version: PHP 7.2.17\r\n- Database: MariaDB 10.1\r\n- Install Method: standard web install\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nWhen using the TablesService directly from a PHP script instead of through an API endpoint, calling createTable or updateTable with a data parameter that includes an options structure will result in errors that seem to indicate a misinterpretation of the nested array structure. Placing the exact same code in an web API endpoint context will function as expected.\r\n\r\nI'm not sure that my attempt to use this internal service class is supported at all, however for my use case it is the most straightforward method and even if this use is not intended, the issue described is still probably a bug.\r\n\r\nI have put together a minimal reproducing test case.\r\n[bug.php.zip](https://github.com/directus/directus/files/3147120/bug.php.zip)\r\n\r\n## Steps to Reproduce\r\n\r\n1. Place bug.php in the directus root and run.\r\n2. See error:\r\n`PHP Notice:  Undefined index: column in /usr/local/directus/vendor/zendframework/zend-db/src/Sql/AbstractSql.php on line 419\r\nPHP Stack trace:\r\nPHP   1. {main}() /usr/local/directus/bug.php:0\r\nPHP   2. Directus\\Services\\TablesService->createTable() /usr/local/directus/bug.php:64\r\nPHP   3. Directus\\Services\\TablesService->addColumnsInfo() /usr/local/directus/src/core/Directus/Services/TablesService.php:361\r\nPHP   4. Directus\\Services\\TablesService->addOrUpdateFieldInfo() /usr/local/directus/src/core/Directus/Services/TablesService.php:821\r\nPHP   5. Directus\\Services\\TablesService->addFieldInfo() /usr/local/directus/src/core/Directus/Services/TablesService.php:847\r\nPHP   6. Directus\\Database\\TableGateway\\RelationalTableGateway->createRecord() /usr/local/directus/src/core/Directus/Services/TablesService.php:888\r\nPHP   7. Directus\\Database\\TableGateway\\RelationalTableGateway->addRecordByArray() /usr/local/directus/src/core/Directus/Database/TableGateway/RelationalTableGateway.php:410\r\nPHP   8. Directus\\Database\\TableGateway\\RelationalTableGateway->insert() /usr/local/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php:411\r\nPHP   9. Directus\\Database\\TableGateway\\RelationalTableGateway->executeInsert() /usr/local/directus/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php:264\r\nPHP  10. Directus\\Database\\TableGateway\\RelationalTableGateway->executeInsert() /usr/local/directus/src/core/Directus/Database/TableGateway/BaseTableGateway.php:820\r\nPHP  11. Zend\\Db\\Sql\\Sql->prepareStatementForSqlObject() /usr/local/directus/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php:307\r\nPHP  12. Zend\\Db\\Sql\\Platform\\Platform->prepareStatement() /usr/local/directus/vendor/zendframework/zend-db/src/Sql/Sql.php:140\r\nPHP  13. Zend\\Db\\Sql\\Insert->prepareStatement() /usr/local/directus/vendor/zendframework/zend-db/src/Sql/Platform/Platform.php:103\r\nPHP  14. Zend\\Db\\Sql\\Insert->buildSqlString() /usr/local/directus/vendor/zendframework/zend-db/src/Sql/AbstractPreparableSql.php:34\r\nPHP  15. Zend\\Db\\Sql\\Insert->processInsert() /usr/local/directus/vendor/zendframework/zend-db/src/Sql/AbstractSql.php:64\r\nPHP  16. Zend\\Db\\Sql\\Insert->resolveColumnValue() /usr/local/directus/vendor/zendframework/zend-db/src/Sql/Insert.php:193\r\n`\r\n\r\n## Expected Behavior\r\nI expect the stub script to create a collection named 'foo', with two fields (ID and Name). The created text-input field 'Name' should receive the correct options structure (in the JSON field in the directus_fields table) as specified in the script.\r\n\r\n## Actual Behavior\r\nThe collection is added, but the options field in the directus_fields table is NULL.\r\n\r\n## Other Context & Screenshots\r\nThe error indicates that the 'options' key in the supplied field structure is incorrectly interpreted. However, the supplied field structure is exactly the same as when supplied through the API, in which case it functions just fine. I realize that I'm artificially setting up (part of) the context that allows the Directus services to function when directly called from PHP, and that this is not normal use. However, everything else seems to function just fine, and while there may be a context variable responsible for this discrepancy, I expect it not to be intended behavior and thus a bug.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: server \r\n- OS: Debian 8, 64 bit\r\n- Web Server: nginx 1.8.1\r\n- PHP Version: 7.3.4\r\n- Database: MySQL 5.6\r\n- Install Method: cloned `master` branch"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nSet utf8mb4 in api.php\r\nCreate new collection\r\nView DB\r\n\r\n## Expected Behavior\r\nShould be utf8mb4\r\n## Actual Behavior\r\nIs latin1_swedish_ci\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/11723882/57182198-c45ea000-6e9c-11e9-8d07-e80f9de95fee.png)\r\n![image](https://user-images.githubusercontent.com/11723882/57182205-d17b8f00-6e9c-11e9-8a07-5cbe32129010.png)\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nStatus is not enforced in new user creation\r\n## Steps to Reproduce\r\n\r\n1. Add a new user\r\n2. fill all the fields but __status__\r\n2. Save\r\n\r\n## Expected Behavior\r\nUser is marked as Draft\r\n\r\n## Actual Behavior\r\nThe field __status__ in __directus_users__ contain __raf__\r\nThe user is not accesible in the App\r\n\r\n## Technical Details\r\n\r\n- Directus bundle v.7.0.19\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n<!-- Only report bugs with the officially supported LAMP stack. Issues with alternate stacks are \"enhancements\". -->\r\n\r\n## Steps to Reproduce\r\n\r\n1) Go to Roles & Permissions and Click **Public**\r\n2) Toggle Show Directus System Collections\r\n3) Click All on  **Fields**\r\n\r\n## Expected Behavior\r\n- Able to get **Fields** of any collections with endpoint  **<project_key>/fields/[collection]**\r\n\r\n## Actual Behavior\r\n- Got **{\"error\":{\"code\":3,\"message\":\"Permission denied\"}}**\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Ubuntu 18.04\r\n- Browser: Chrome\r\n- Directus App: 7.2.0\r\n- Install Method:  cloned `master` branch of `directus/directus`"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n<!-- Only report bugs with the officially supported LAMP stack. Issues with alternate stacks are \"enhancements\". -->\r\n\r\n## Steps to Reproduce\r\n\r\n1/ Install and set up directus from the digital ocean droplet, I have upgraded directus from the latest master.\r\n2/ Create a new DB in mysql\r\n3/ Create a new directus API\r\n`bin/directus install:config -n <new-database-name> -u <mysql-user> -p <mysql-password> -N <project-name>`\r\n(I'm using the directus user)\r\n`bin/directus install:database -N <project-name>`\r\n`bin/directus install:install -e admin@email.com -p password -t <project-name> -N <project-name>`\r\n4/ Add the new project to the config.s at `/var/www/directus/public/admin/config.js`\r\n\r\n## Expected Behavior\r\n\r\nBe able to login\r\n\r\n## Actual Behavior\r\n\r\nI can't seem to be able to login to the new API with these credentials: admin@email.com // password\r\n\r\n`POST https://api.paulgiron.com/<project-name>/auth/authenticate 404 (Not Found)`\r\n`Wrong username and/or password`\r\n\r\nIt's worth noticing that it used to work before I've updated from master yesterday\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: desktop\r\n- OS: macos\r\n- Browser: chrome\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nHi, \r\n\r\ni just discovered a simple(?) bug while configuring my Directus setup.\r\nI wanted to reduce that many calls that happening to my backend server. Many of them are OPTIONS-Requests. Luckily Directus got me covered: `cors.max_age`. It does it's job, all but for /ping requests.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Configure cors.max_age setting according to https://docs.directus.io/advanced/api/configuration.html#cors, say set it to 500.\r\n2. Request http://directus-api.local/server/ping (or wait while APP is logged in and console is open)\r\n\r\n## Expected Behavior\r\n\r\nResponse should include \"Access-Control-Max-Age: 500\"\r\n\r\n## Actual Behavior\r\n\r\nNo such header \"Access-Control-Max-Age\" (while others do appear).\r\n\r\n## Other Context & Screenshots\r\n\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n\r\n\r\n- Device: Desktop\r\n- OS: Linux\r\n- Web Server: Nginx\r\n- PHP Version: 7.2\r\n- Database: mysql 5.7\r\n- Install Method: Docker'd version of Directus (APP v7.0.18 && API v2.0.18)\r\n"},{"labels":["bug",null],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n<!-- Only report bugs with the officially supported LAMP stack. Issues with alternate stacks are \"enhancements\". -->\r\n\r\n## Steps to Reproduce\r\n\r\n1. Setup some records in a collection\r\n2. Alter the id of said records in the database directly\r\n3. Try to add some record via the App\r\n\r\n## Expected Behavior\r\nThe records is added correctly.\r\n\r\n## Actual Behavior\r\nAn error message pop with a \"duplicate key\" message.\r\n\r\n## Other Context & Screenshots\r\nSorry for the title of the report, couldn't find something short and simple to describe it.\r\n\r\nThe problem is that it seems there is a specific count for the app (I couldn't find where), so if I change the id in the database, the app try to set existing ids. It happens when I take an existing database to integrate with Directus.\r\n\r\nBtw the counter is incremented even if the record isn't added to the database, which is another problem but not so problematic.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS\r\n- Browser: Chrome\r\n- Directus App: 7.0.19\r\n- Directus API: \r\n- Install Method: git clone\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'https://github.com/directus/directus'\r\n2. git clone https://github.com/directus/directus.git\r\n3. Install from App admin\r\n4. See error\r\n[2019-04-25 02:06:55] api[].ERROR: PDOException: SQLSTATE[42000]: Syntax error or access violation: 1071 Specified key was too long; max key length is 767 bytes in /home/admin/web/mydomain.com/public_html/directus/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php:134 Stack trace:\r\n"},{"labels":["bug"],"text":"<!--\r\nFor security issues, please email support@directus.io directly.\r\n\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n- Upon adjusting Thumbnail Quality Tags, Thumbnail Actions, in Global Settings: `Attempting to write an array as the value for field \"value\" in \"directus_settings\"`\r\n- Upon removing a set Logo, `This value should not be blank`\r\n\r\n## Steps to Reproduce\r\n\r\n- Attempt to adjust Thumbnail Quality Tags, Thumbnail Actions\r\n- Attempt to remove set logo\r\n\r\n## Technical Details\r\n\r\nCloned `master` branch of `directus/directus`: c2a534e8e042a7ad1a1757cb7996b2c9fb12c863 (yesterday, April 23)\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nDirectus sets mime type for uploaded image as application/octet-stream if file extension written in uppercase\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'File Library'\r\n2. Click on '+'\r\n3. Open file selector\r\n4. Select file with extension written in uppercase\r\n\r\n## Expected Behavior\r\n\r\nUploaded file with image/jpg mime\r\n\r\n## Actual Behavior\r\n\r\nUploaded file with application/octet-stream mime\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: VPS\r\n- OS: Ubuntu 16.04\r\n- Docker image directus/api:latest\r\n- Database: MySQL 5.7\r\n- Install Method: docker-compose\r\n"},{"labels":["bug"],"text":"Some cached data are sent back from the API whereas they should have been invalidated\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Activate the cache on the API (e.g. through memcache or apcu)\r\n2. Create a collection through the APP or API\r\n3. Retrieve at least once the content of this collection through the APP or API\r\n4. Add a new entry to this collection through the APP or API and save it\r\n5. Retrieve the collection content once again through the APP or API and observe the data sent back\r\n\r\n## Expected Behavior\r\nThe new entry must appear in the collection content\r\n\r\n## Actual Behavior\r\nThis entry is not visible\r\n\r\n## Other Context & Screenshots\r\nThe cache is not invalidated after performing some important actions, the fresh collection data is not always sent back from the API\r\n\r\n## Technical Details\r\nlatest master\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n<!-- Only report bugs with the officially supported LAMP stack. Issues with alternate stacks are \"enhancements\". -->\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create collections with Many-to-Many fields pointing back to each other.\r\n![image](https://user-images.githubusercontent.com/34398302/56061104-29a3f300-5d2e-11e9-82b4-c99246307b8f.png)\r\n![image](https://user-images.githubusercontent.com/34398302/56061108-2c064d00-5d2e-11e9-87e3-e5ea7c1516ed.png)\r\n2. Create new or choose existing items from either collection.\r\n3. Notice the time to save increases as more items are added.\r\n4. Check the ```directus_revisions``` table to see an extraordinary amount of rows being written for each change.\r\n\r\n## Expected Behavior\r\nOnly new changes should be saved to revisions.  https://github.com/directus/api/issues/831\r\nAlthough the above is an extension, I think this is more of a bug when handling relationship fields.  I don't expect each one of the items related to should get stored as a full copy in ```directus_revisions```.\r\n## Actual Behavior\r\nCopies of the objects are saved not only for new related items but also for ALL existing related items.  This causes excessive storage space and delays when updating items through the App.\r\n## Other Context & Screenshots\r\nI think this could be reproduced a number of ways but for me, this was this easiest to observe.  For the purposes of the example, I only related to 25 items in total but you can understand this becomes a much bigger problem the more items you are relating to.  In my implementation, I have items with \r\n\r\n![adding_theaters](https://user-images.githubusercontent.com/34398302/56059731-5d7d1980-5d2a-11e9-8d23-468c605ca17d.gif)\r\n![tables](https://user-images.githubusercontent.com/34398302/56060342-2c9de400-5d2c-11e9-962b-6ee992d15b03.gif)\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n-Device: Desktop\r\n-OS: Windows 10\r\n-Browser: Chrome\r\n-Directus: 190325A\r\n-Install Method: Cloned master branch of directus/directus"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nPassing in the mathematical shorthand for a number returns results\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to \"/_/items/exampletable/2e1\"\r\n2. Will return results for 20\r\n\r\n## Expected Behavior\r\nError as no primary key of 2e1 exists\r\n\r\n## Actual Behavior\r\nReturns results for the result of the representation i.e. 20\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nPassing a 0 as the primary key returns empty data rather than the expected 203 (item not found) error.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to \"/_/items/exampletable/0\"\r\n2. See empty JSON object\r\n\r\n## Expected Behavior\r\nReturn 203 (Item not found) error\r\n\r\n## Actual Behavior\r\nReturns empty JSON object\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nThis seems to be a similar issue to one that Facebook had a while ago. When attempting to get a row by a primary key of 1abc the system will return the results for 1.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to \"/_/items/exampletable/1abc\" on a table with numeric keys\r\n2. See results for \"1\" rather than the expected error\r\n\r\n## Expected Behavior\r\nIf no item exists for the provided primary key then show the row not found error.\r\n\r\n## Actual Behavior\r\nSee results for an unrelated item.\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nJust to provide some context, the use case is to know what translation key belongs to a translation. It could be searched in the _translations_ collection but ideally it should be hidden by default for regular users.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Setup a translated collection (see provided script)\r\n2. Populate with some content\r\n3. Navigate to the main collection\r\n4. Try to search in the _translations_ field\r\n\r\n![image](https://user-images.githubusercontent.com/7592823/55785940-98294c80-5ab3-11e9-8dc9-093cf50224c4.png)\r\n\r\n5. The following error will happen in the API\r\n\r\n```\r\n[2019-04-09 04:14:14] api[_].ERROR: Directus\\Database\\Exception\\InvalidQueryException: Failed generating the SQL query. in /var/www/html/src/core/Directus/Database/TableGateway/BaseTableGateway.php:738\r\nStack trace:\r\n#0 /var/www/html/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(209): Directus\\Database\\TableGateway\\BaseTableGateway->executeSelect\r\n#1 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1047): Zend\\Db\\TableGateway\\AbstractTableGateway->selectWith\r\n#2 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1137): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#3 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(819): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#4 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#10 /var/www/html/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\n#11 /var/www/html/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#12 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#13 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#14 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#15 [internal function]: Slim\\DeferredCallable->__invoke\r\n#16 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#17 /var/www/html/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(81): Slim\\Route->Slim\\{closure}\r\n#18 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#19 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#20 [internal function]: Slim\\DeferredCallable->__invoke\r\n#21 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#39 [internal function]: Slim\\DeferredCallable->__invoke\r\n#40 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#41 /var/www/html/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#42 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#43 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#44 [internal function]: Slim\\DeferredCallable->__invoke\r\n#45 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func#28 /var/www/html/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\n#29 /var/www/html/vendor/slim/slim/Slim/App.php(516): Slim\\Route->runactRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#30 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#31 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#5 /var/www/html/src/core/Directus/Services/AbstractService.php(332): call_user_func_array\r\n#6 /var/www/html/src/core/Directus/Services/AbstractService.php(276): Directus\\Services\\AbstractService->getDataAndSetResponseCacheTags\r\n#7 /var/www/html/src/core/Directus/Services/ItemsService.php(57): Directus\\Services\\AbstractService->getItemsAndSetResponseCacheTags\r\n#8 /var/www/html/src/endpoints/Items.php(43): Directus\\Services\\ItemsService->findAll\r\n#9 [internal function]: Directus\\Api\\Routes\\Items->all\r\n#10 /var/www/html/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\n#11 /var/www/html/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#12 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#13 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#14 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#15 [internal function]: Slim\\DeferredCallable->__invoke\r\n#16 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#17 /var/www/html/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(81): Slim\\Route->Slim\\{closure}\r\n#18 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#19 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#20 [internal function]: Slim\\DeferredCallable->__invoke\r\n#21 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#22 /var/www/html/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#23 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#24 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#25 [internal function]: Slim\\DeferredCallable->__invoke\r\n#26 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#27 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#28 /var/www/html/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\n#29 /var/www/html/vendor/slim/slim/Slim/App.php(516): Slim\\Route->run\r\n#30 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#31 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#32 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#33 [internal function]: Slim\\DeferredCallable->__invoke\r\n#34 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#35 /var/www/html/vendor/wellingguzman/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#36 /var/www/html/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#37 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#38 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#39 [internal function]: Slim\\DeferredCallable->__invoke\r\n#40 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#41 /var/www/html/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#42 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#43 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#44 [internal function]: Slim\\DeferredCallable->__invoke\r\n#45 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#46 /var/www/html/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#47 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#48 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#49 [internal function]: Slim\\DeferredCallable->__invoke\r\n#50 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#51 /var/www/html/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(47): Slim\\App->Slim\\{closure}\r\n#52 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#53 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#54 [internal function]: Slim\\DeferredCallable->__invoke\r\n#55 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#56 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#57 /var/www/html/vendor/slim/slim/Slim/App.php(407): Slim\\App->callMiddlewareStack\r\n#58 /var/www/html/vendor/slim/slim/Slim/App.php(315): Slim\\App->process\r\n#59 /var/www/html/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#60 /var/www/html/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n\r\nNote: the stack trace is is from dev env, but in production it's equivalent.\r\n\r\n## Expected Behavior\r\n\r\nIt searches for the given text in the auxiliary collection that keeps the translated content.\r\n\r\n## Actual Behavior\r\n\r\nAn error occurs.\r\n\r\nNot sure if this is an actual bug or I'm missing some point and simply it is not the intended way of use.\r\n\r\n## Other Context & Screenshots\r\n\r\nScript used to create translated collection:\r\n\r\n```\r\n/*\r\n+------------------------------------------+\r\n            Scripts start here\r\n+------------------------------------------+\r\n*/\r\n\r\n/* LANGUAGES */\r\n\r\nCREATE TABLE `test_languages` (\r\n  `code` varchar(10) NOT NULL,\r\n  `name` varchar(20) NOT NULL,\r\n  PRIMARY KEY (`code`)\r\n);\r\n\r\nINSERT INTO directus_collections\r\n(collection, managed, hidden, single, icon, note, `translation`)\r\nVALUES('test_languages', 1, 0, 0, NULL, NULL, '');\r\n\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_languages', 'code', 'string', 'primary-key', '{\"trim\":true,\"showCharacterCount\":true,\"formatValue\":false,\"width\":\"auto\"}', 0, NULL, 0, 0, 0, 0, NULL, 4, NULL, NULL, '');\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_languages', 'name', 'string', 'text-input', '{\"trim\":true,\"showCharacterCount\":true,\"formatValue\":false,\"width\":\"auto\"}', 0, NULL, 0, 0, 0, 0, NULL, 4, NULL, NULL, '');\r\n\r\nINSERT INTO test_languages\r\n(code, name)\r\nVALUES('en', 'English');\r\n\r\n\r\n/* COLLECTION */\r\n\r\nCREATE TABLE `test_i18n` (\r\n  `id` int(15) unsigned NOT NULL AUTO_INCREMENT,\r\n  `key` varchar(500) DEFAULT NULL,\r\n  PRIMARY KEY (`id`)\r\n);\r\n\r\nCREATE TABLE `test_i18n_translations` (\r\n  `id` int(15) unsigned NOT NULL AUTO_INCREMENT,\r\n  `translation_key_id` int(10) unsigned DEFAULT NULL, /* The FK to the translation in the main collection (generic name since the collection name is dynamic) */\r\n  `language_code` char(10) DEFAULT NULL,\r\n  `content` longtext,\r\n  PRIMARY KEY (`id`)\r\n);\r\n\r\nINSERT INTO directus_collections\r\n(collection, managed, hidden, single, icon, note, `translation`)\r\nVALUES('test_i18n', 1, 0, 0, NULL, NULL, '');\r\nINSERT INTO directus_collections\r\n(collection, managed, hidden, single, icon, note, `translation`)\r\nVALUES('test_i18n_translations', 1, 1, 0, NULL, NULL, '');\r\n\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_i18n', 'id', 'integer', 'primary-key', '', 0, NULL, 0, 0, 1, 1, 0, 4, NULL, NULL, '');\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_i18n', 'key', 'string', 'text-input', '{\"trim\":true,\"showCharacterCount\":true,\"formatValue\":false,\"width\":\"auto\"}', 0, NULL, 0, 0, 0, 0, NULL, 4, NULL, NULL, '');\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_i18n', 'translations', 'translation', 'translation', '{\"languagesCollection\":\"test_languages\",\"languagesPrimaryKeyField\":\"code\",\"languagesNameField\":\"name\",\"translationLanguageField\":\"language_code\"}', 0, NULL, 0, 0, 0, 0, NULL, 4, NULL, NULL, '');\r\n\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_i18n_translations', 'id', 'integer', 'primary-key', '', 0, NULL, 0, 0, 1, 1, 0, 4, NULL, NULL, '');\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_i18n_translations', 'translation_key_id', 'integer', 'numeric', '{\"localized\":true}', 0, NULL, 0, 0, 1, 0, NULL, 4, NULL, NULL, '');\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_i18n_translations', 'language_code', 'lang', 'text-input', '{\"trim\":true,\"showCharacterCount\":true,\"formatValue\":false,\"width\":\"auto\"}', 0, NULL, 0, 0, 1, 0, NULL, 4, NULL, NULL, '');\r\nINSERT INTO directus_fields\r\n(collection, field, `type`, interface, `options`, locked, validation, required, readonly, hidden_detail, hidden_browse, sort, width, `group`, note, `translation`)\r\nVALUES('test_i18n_translations', 'content', 'string', 'textarea', '{\"trim\":true,\"showCharacterCount\":true,\"formatValue\":false,\"width\":\"auto\"}', 0, NULL, 0, 0, 0, 0, NULL, 4, NULL, NULL, '');\r\n\r\nINSERT INTO directus_relations\r\n(collection_many, field_many, collection_one, field_one, junction_field)\r\nVALUES('test_i18n_translations', 'translation_key_id', 'test_i18n', 'translations', NULL);\r\n\r\n\r\n\r\n/*\r\n+------------------------------------------+\r\n             Scripts end here\r\n+------------------------------------------+\r\n*/\r\n```\r\n\r\n## Technical Details\r\n\r\n- Device: Any\r\n- OS: MacOS 10.13.6 (dev) or Amazon Linux AMI 2018.03 (prod)\r\n- Web Server: nginx/1.14.1\r\n- PHP Version: 7.3.2\r\n- Database: MySQL 5.7.25\r\n- Install Method: Docker (dev), cloned `master` branch (prod)"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nPassword is stored in plain text.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Get the latest master from both API&APP\r\n2. Start them with a new mysql db\r\n3. Login in as admin\r\n4. Create a new admin user\r\n5. Go look at the DB content\r\n\r\n## Expected Behavior\r\nThe password is hashed and the user is able to log in (stored and provided hashes match)\r\n\r\n## Actual Behavior\r\nUnable to login the new user, the password is store in plain text\r\n\r\n## Other Context & Screenshots\r\nIf you revert the following merge request (manually) the password will be hashed again.\r\nSomething in the latest commits broke the hashing of the user password, sadly I don't have time to go through everything.\r\n\r\nhttps://github.com/directus/api/pull/591\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: web\r\n- OS: Linux\r\n- Web Server: nginx\r\n- PHP Version: php7.2-fpm\r\n- Database: mariadb latest\r\n- Install Method: clone master branch\r\n"},{"labels":[null,"bug",null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. After login in admin:\r\n2:Error\r\nServer Error\r\nSomething is wrong with this instance‚Äôs server or database.\r\n\r\n\r\n## Expected Behavior\r\n\r\n## Actual Behavior\r\n\r\n## Other Context & ![directus](https://user-images.githubusercontent.com/11546471/55001057-8f645100-4fb2-11e9-9317-1b695a9ce3ad.png)\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: linux CentOS release 6.10\r\n- PHP Version: PHP 7.2.14\r\n- Database: MySQL Ver 14.14 Distrib 5.5.42\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nIt seems that sending mail through sendmail fail due to some reasons (error code null)\r\n\r\n## Steps to Reproduce\r\n\r\n1. Make a POST request to `/_/mail`\r\n2. set body to \r\n```\r\n{\r\n  \"to\": \"r.wetteren@gmail.com\",\r\n  \"subject\": \"New Password\",\r\n  \"body\": \"Hello\",\r\n  \"type\": \"html\"\r\n}\r\n```\r\n\r\n## Expected Behavior\r\n\r\nShould receive code 220 and send mail\r\n\r\n## Actual Behavior\r\n\r\nNo mail sent and response returned by server :\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"Expected response code 220 but got code \\\"\\\", with message \\\"\\\"\"\r\n    }\r\n}\r\n```\r\n\r\n**Logs**\r\n----\r\n```\r\n[2019-04-01 12:46:21] api[_].ERROR: Swift_TransportException: Expected response code 220 but got code \"\", with message \"\" in /var/www/html/vendor/swiftmailer/swiftmailer/lib/classes\r\nStack trace:\r\n#0 /var/www/html/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/AbstractSmtpTransport.php(289): Swift_Transport_AbstractSmtpTransport->_assertResponseCode\r\n#1 /var/www/html/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/AbstractSmtpTransport.php(117): Swift_Transport_AbstractSmtpTransport->_readGreeting\r\n#2 /var/www/html/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/SendmailTransport.php(51): Swift_Transport_AbstractSmtpTransport->start\r\n#3 /var/www/html/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Mailer.php(79): Swift_Transport_SendmailTransport->start\r\n#4 /var/www/html/src/core/Directus/Mail/Mailer.php(76): Swift_Mailer->send\r\n#5 /var/www/html/src/helpers/mail.php(62): Directus\\Mail\\Mailer->sendWithContent\r\n#6 /var/www/html/src/helpers/mail.php(44): Directus\\send_mail_with_content\r\n#7 /var/www/html/src/core/Directus/Services/MailService.php(39): Directus\\send_mail_with_layout\r\n#8 /var/www/html/src/endpoints/Mail.php(22): Directus\\Services\\MailService->send\r\n#9 [internal function]: Directus\\Api\\Routes\\Mail->send\r\n#10 /var/www/html/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\n#11 /var/www/html/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#12 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#13 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#14 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#15 [internal function]: Slim\\DeferredCallable->__invoke\r\n#16 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#17 /var/www/html/src/core/Directus/Application/Http/Middleware/AuthenticatedMiddleware.php(18): Slim\\Route->Slim\\{closure}\r\n#18 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticatedMiddleware->__invoke\r\n#19 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#20 [internal function]: Slim\\DeferredCallable->__invoke\r\n#21 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#22 /var/www/html/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(81): Slim\\Route->Slim\\{closure}\r\n#23 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#24 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#25 [internal function]: Slim\\DeferredCallable->__invoke\r\n#26 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#27 /var/www/html/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#28 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#29 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#30 [internal function]: Slim\\DeferredCallable->__invoke\r\n#31 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#32 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#33 /var/www/html/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\n#34 /var/www/html/vendor/slim/slim/Slim/App.php(516): Slim\\Route->run\r\n#35 /var/www/html/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#36 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#37 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#38 [internal function]: Slim\\DeferredCallable->__invoke\r\n#39 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#40 /var/www/html/vendor/wellingguzman/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#41 /var/www/html/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#42 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#43 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#44 [internal function]: Slim\\DeferredCallable->__invoke\r\n#45 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#46 /var/www/html/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#47 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#48 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#49 [internal function]: Slim\\DeferredCallable->__invoke\r\n#50 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#51 /var/www/html/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#52 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#53 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#54 [internal function]: Slim\\DeferredCallable->__invoke\r\n#55 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#56 /var/www/html/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(47): Slim\\App->Slim\\{closure}\r\n#57 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#58 /var/www/html/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#59 [internal function]: Slim\\DeferredCallable->__invoke\r\n#60 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#61 /var/www/html/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#62 /var/www/html/vendor/slim/slim/Slim/App.php(407): Slim\\App->callMiddlewareStack\r\n#63 /var/www/html/vendor/slim/slim/Slim/App.php(315): Slim\\App->process\r\n#64 /var/www/html/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#65 /var/www/html/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n----\r\n\r\n## Other Context & Screenshots\r\n\r\nConfiguration : Docker\r\nenv:\r\n```\r\nMAIL_DEFAULT_FROM=r.wetteren@gmail.com\r\nMAIL_DEFAULT_TRANSPORT=sendmail\r\n```\r\n\r\nI try localhost and vps, no differences :/\r\n\r\nI also try the `_/auth/password/request` but I do not receive anything in my box.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Debian Jessie\r\n- Web Server: x\r\n- PHP Version: 7.2.13\r\n- Database: MySQL 5.7.25\r\n- Install Method: Docker\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nWhen setting all the collections readable by the public group, the dot notation for filters doesn't work.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Install the provided demo sql dump\r\n2. Go to `/_/items/tag?fields=*.*&filter[tag_type.title][eq]=Category`\r\n3. See error\r\n\r\nNote how it works when you add `&access_token=demo` to the end of that URL\r\n\r\n[dump.zip](https://github.com/directus/api/files/3023520/dump.zip)\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nSometimes i am not able to add a relations field (in my case the files and the many to many interface). I get  this js error : `vue.runtime.esm.js:1888 TypeError: Cannot read property 'fields' of undefined` which is caused by the file: \r\n`getters.js` (webpack:///./src/store/modules/relations/getters.js) \r\nat this line: \r\n`field_many: collections[result.collection_many].fields[result.field_many],`\r\n\r\n## Steps to Reproduce\r\n\r\nOnly on certain collections, i don't know what is the cause since the relational interfaces seems to work on every other collections. I just added and removed some relational fields.\r\n\r\n## Expected Behavior\r\n\r\nTo work as expected\r\n\r\n## Actual Behavior\r\n\r\nI am not able to add some interfaces due to a js errors.\r\n\r\n## Other Context & Screenshots\r\n\r\nhttps://www.dropbox.com/s/b7g0e2c91xfkpo2/Annotazione%202019-03-28%20174133.jpg?dl=0\r\n\r\n## Technical Details\r\n\r\n- Device: Intel Nuc\r\n- OS: Windows 10\r\n- Web Server: Apache\r\n- PHP Version: 7.2\r\n- Database: MySql 5.7\r\n- Install Method: cloned\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Login to https://directus.app/#/files and and see that no thumbnails are shown.\r\n\r\n## Expected Behavior\r\n\r\nThumbnails should be shown.\r\n\r\n## Actual Behavior\r\n\r\nNo thumbnails are shown, and they return 404 errors.\r\n\r\n## Other Context & Screenshots\r\n\r\nWe are trying to set up the thumbnailer locally and not having great success, getting 404s.\r\n\r\n## Technical Details\r\n\r\nDirectus API 2.0.18 Docker (this is not latest- however the issue persists on directus.app)"},{"labels":["bug",null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n<!-- Only report bugs with the officially supported LAMP stack. Issues with alternate stacks are \"enhancements\". -->\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection \"Carousel\"\r\n2. Click another collection \"Carousel Items\" with Title, Image and Sort (all required) fields.\r\n3. Update Carousel Collection to include a O2M field \"Carousel Items\"\r\n4. Create a new Carousel object.\r\n5. Click on Add New Carousel Item\r\n6. Enter Title, leave Image and sort blank.\r\n7. Save Carousel Item.\r\n\r\n## Expected Behavior\r\n\r\nEither on the Carousel Slide modal or on saving carousel, the system should error out saying - required fields are missing.\r\n\r\n## Actual Behavior\r\n\r\nSystem allows storing null values for fields marked as required.\r\n\r\n## Other Context & Screenshots\r\n![Screen Shot 2019-03-26 at 2 26 01 PM](https://user-images.githubusercontent.com/44380643/55034700-54bee080-4fd3-11e9-9035-92f16fdc2f31.png)\r\n![Screen Shot 2019-03-26 at 2 25 52 PM](https://user-images.githubusercontent.com/44380643/55034701-54bee080-4fd3-11e9-9f2f-177dff3154c9.png)\r\n![Screen Shot 2019-03-26 at 2 27 04 PM](https://user-images.githubusercontent.com/44380643/55034702-54bee080-4fd3-11e9-96d3-a5a513655991.png)\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS 10.14.3\r\n- Browser: Firefox\r\n- Directus App: 7.0.19\r\n- Directus API: 2.0.18\r\n- Install Method: cloned `master` branch of `directus/directus`\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nWhen an endpoint is set to be publicly readable, the API still returns error 300 when trying to read it.    See screenshots below for demonstration.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection and add items\r\n2. Set the collection to be public in the \r\n3. Attempt to access to public endpoint\r\n\r\n## Expected Behavior\r\nItems in the collection should be returned\r\n\r\n## Actual Behavior\r\nError 300\r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/30007908/55034417-d15db900-4feb-11e9-8579-2ccb8d4525dd.png)\r\nAll collections are set to be publicly readable\r\n![image](https://user-images.githubusercontent.com/30007908/55034560-0ff37380-4fec-11e9-8c7e-d2d2f957e2a6.png)\r\nWhen attempting to access the items via the API, access is denied.  \r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Virtual Linux Server\r\n- OS: Ubuntu 16.04.2\r\n- Web Server: NGINX 1.10.3\r\n- PHP Version: 7.2.16\r\n- Database: mysqld  Ver 5.7.25-0ubuntu0.16.04.2 for Linux on x86_64\r\n- Install Method: cloned master branch of https://github.com/directus/directus.git \r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nWhen altering any options of a decimal number field it will automatically set the choosen \"Length\" to the default range value of 10,0.\r\n\r\nAfterwards all right digits within this table column will be changed  (i.e percentage values like 0.61 will be changed to 1) and are therefor lost.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to any number field with the datatype DECIMAL\r\n2. Change anything or nothing, but click on save\r\n3. If \"Length\" has been a custom range value, it will be set back to the default 10,0 now\r\n\r\n## Expected Behavior\r\nNever change the choosen decimal range value, since all the saved digits on the right side or numbers with more than 10 digits on the left side are gone afterwards\r\n\r\n## Actual Behavior\r\nSets back the range value of decimal number fields to its default 10,0 everytime when it is saved\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Virtual Server\r\n- OS: Ubuntu 16.04\r\n- Web Server: Apache 2.4.18\r\n- PHP Version:  v7.1.27\r\n- Database: MySQL Ver 14.14 Distrib 5.7.25\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nWhen creating a new project using `/projects`, leaving the db_password field empty will write `null` to the config file resulting in database connection errors when trying to use the API.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a new project in /projects\r\n2. Leave the db_password field empty (or empty string `\"\"`)\r\n3. See problems\r\n\r\n## Expected Behavior\r\n\r\nThe API should support database connections with no password"},{"labels":["bug",null,null,null,null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Refactor from `PHPUnit_Framework_TestCase` to `\\PHPUnit\\Framework\\TestCase`\r\n2. Then click on 'Tests' in the IDE.\r\n\r\n## Expected Behavior\r\nThe unit tests should be matching the source code.\r\n\r\n## Actual Behavior\r\nThe unit tests generally seem quite outdated and barely match the source code.\r\n\r\n## Other Context & Screenshots\r\nThis commit has the changes required to even run the unit tests:\r\nhttps://github.com/syslogic/directus-api/commit/788f66e7e0a7b5a0628cd5294ac2f5948ae8e355\r\n\r\nWhile the result looks about like this:\r\n\r\n![phpunit_screenshot](https://user-images.githubusercontent.com/736481/54863354-c4b93680-4d47-11e9-8779-f6013488e936.png)\r\n\r\nso far, I'm at `36.55%` passed tests... the main issue still are classes & methods which do not exist anymore - and the lack of API documentation, which one could use as an ultimate reference for writing the tests, so that the source code could be properly validated against them.\r\n\r\n## Technical Details\r\n\r\n- Device: [Desktop]\r\n- OS: [Redhat Linux, Kernel 3.10]\r\n- Web Server: [Apache 2.4.37]\r\n- PHP Version: [7.1.26]\r\n- PHPUnit Version [7.5.7]\r\n- Database: [MariaDB 10.2.22]\r\n- Install Method: [cloned the `master` branch]\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nWhile trying to set the page for the first login of a user to his profile page i realized that directus_users.last_page could to the trick. But unfortunately it does not work for non-admin users.\r\n\r\n## Steps to Reproduce\r\nCheck the requests sent on the browser console during login.\r\nFirst request is /auth/authenticate\r\nSecond request is /users/me?fields=last_page\r\n\r\nCompare the request when logging in as admin user and as user with non admin permissions.\r\n## Expected Behavior\r\nAdminUser gets {data: last_page: \"...\"}\r\nRegularUser gets {data: last_page: \"...\"}\r\n\r\n## Actual Behavior\r\nAdminUser gets {data: last_page: \"...\"}\r\nRegularUser gets {data: []}\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n`item.delete.[colection]` action hook doesn't return $data parameter. Instead it returns an ID for a row that doesn't exists anymore in case of :after.\r\n## Steps to Reproduce\r\n\r\n1. Create any action hook \r\n2. `var_dump` the first parameter\r\n3. See only the ID of the item\r\n\r\n## Expected Behavior\r\nReturn full data from the item you're trying to delete\r\n## Actual Behavior\r\nReturning only ID from an item that in some cases doesn't exist.\r\n## Other Context & Screenshots\r\nThis was the function for the action hook i used when testing:\r\n\r\n`'item.create.table' => function($data){\r\n  var_dump($data);\r\n},`\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop PC\r\n- OS: Windows 10 Pro\r\n- Browser: Chrome 72.0.3626.121 64bit\r\n- Directus App: 7.0.19\r\n- Directus API: 2.0.19\r\n- Install Method: Download zip and extract.\r\n"},{"labels":[null,"bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Setup Directus on SE Linux\r\n2. Go to 'File Library'\r\n3. Click on 'new'\r\n4. Select an image\r\n5. VueJS displays a generic error message, most likely it cannot parse the response `JSON`.\r\n6. Firefox & Chrome also display a warning, that `CORS` headers were not sent.\r\n\r\nEdit: I've just tried, but insufficient permissions on the `uploads` directory report the error properly.\r\n\r\n## Expected Behavior\r\nIn case of error, it should not throw the stack-trace, which is preceded by the actual response `JSON`, because this leads to these bogus `CORS` warning messages (despite this works perfectly, when uploading cross-site). A rather specific error message should be displayed, telling it cannot write the file (for whatever reason).\r\n\r\n## Actual Behavior\r\nA generic error message is being displayed, due to a stack-trace being present in the response.\r\nThe `CORS` warning is not completely bogus, because the header is not present in case of error.\r\nAnd the SE troubleshooter displays a useless suggestion, which does not solve the problem.\r\n\r\n## Other Context & Screenshots\r\n\r\nThe `uploads` directory needs to be labeled as  `httpd_sys_rw_content_t`:\r\n\r\n    sudo semanage fcontext -a -t httpd_sys_rw_content_t \"/var/www/local.directus.api/public/uploads(/.*)?\"\r\n    restorecon -v /var/www/local.directus.api/public/uploads\r\n\r\nAnd the `logs` directory needs to be labeled as `httpd_log_t`:\r\n\r\n    sudo semanage fcontext -a -t httpd_log_t \"/var/www/local.directus.api/logs(/.*)?\"\r\n    restorecon -v /var/www/local.directus.api/logs\r\n\r\n## Technical Details\r\n\r\n- Device: [Desktop]\r\n- OS: [Redhat Linux, Kernel 3.10]\r\n- Web Server: [Apache 2.4.37]\r\n- PHP Version: [7.1.26]\r\n- Database: [MariaDB 10.2.22]\r\n- Install Method: [cloned the `master` branch]\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nFile upload via Base64 return 400 'bad request'. Following the instructions here:\r\n\r\nhttps://docs.directus.io/api/reference.html#using-base64-content\r\n\r\n## Steps to Reproduce\r\n\r\nExecute the python code. Make sure you put 'picture.jpeg' file in the script path.\r\n\r\n```python\r\nimport requests\r\nimport json\r\nimport base64\r\n\r\n\r\nwith open('picture.jpeg', \"rb\") as f:\r\n\tdata = base64.b64encode(f.read()).decode('utf-8')\r\n\tpayload = {};\r\n\tpayload['filename'] = f'picture.jpeg'\r\n\tpayload['data'] = data\r\n\tjsonPayload = json.dumps(payload)\r\n\tresponse = requests.post('https://<apibase>/public/_/files?access_token=<your token>', data = jsonPayload)\r\n\r\n```\r\n\r\n## Expected Behavior\r\n\r\nResponse should be 200. \r\n\r\n## Actual Behavior\r\n\r\nResponse is 400.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n- API version: 2.0.19\r\n- Device: Desktop\r\n- OS: Windows 10\r\n- Python: 3.6.3\r\n\r\n\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nNote how the collection is called `Test`, but the related nested fields return the casing as `test`. It does get returned correctly on `/fields` however.\r\n\r\n<img width=\"314\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9141017/54552817-519a7380-4987-11e9-9bda-2f58d63b1536.png\">\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Post to the `/[project]/mail` endpoint as described on: \r\n2. Use this data:\r\n```json\r\n{\r\n  \"to\": [\r\n    {\"user@example.com\"}\r\n  ],\r\n  \"subject\": \"New Password\",\r\n  \"body\": \"Hello <b>{{name}}</b>, this is your new password: <br /><br />{{password}}.\",\r\n  \"type\": \"html\",\r\n  \"data\": {\r\n    \"name\": \"John Doe\",\r\n    \"password\": \"secret\"\r\n  }\r\n}\r\n```\r\n3. Check your email\r\n\r\n## Expected Behavior\r\n\r\nThere should be line breaks in the email\r\n\r\n## Actual Behavior\r\n\r\nThe bold tags are rendered. The line breaks are missing\r\n\r\n## Other Context & Screenshots\r\n\r\nUsed both `{{ body | raw }}` and [autoescape false](https://stackoverflow.com/a/36677815/2078207)\r\n\r\nEmail as shown in Gmail: \r\n<img width=\"622\" alt=\"Screenshot 2019-03-18 at 19 04 31\" src=\"https://user-images.githubusercontent.com/2473490/54552624-d5b52100-49b0-11e9-9650-688a914c009f.png\">\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop, Chrome latest\r\n- OS: MacOs latest\r\n- Web Server: Apache 2.4\r\n- PHP Version: 7.2\r\n- Database: 5.6\r\n- Install Method: api standalone master\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nAfter deploying api and app (both from master) under different domains the app cannot connect due to cors issues.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Clone both API and app as instructed on https://docs.directus.io/advanced/source.html\r\n2. Deploy to api.myapp.com and app.myapp.com\r\n3. Configure api\r\n4. Configure app to point at api\r\n5. Try to login\r\n\r\n## Expected Behavior\r\n\r\nI can login\r\n\r\n## Actual Behavior\r\n\r\nCan't login due to double `*, *,` values in Access-Control-Allow-Origin header:\r\n\r\n```\r\nAccess to XMLHttpRequest at 'http://api.domain.nl/public/server/ping' from origin 'http://app.domain.nl' has been blocked by CORS policy: The 'Access-Control-Allow-Origin' header contains multiple values '*, *', but only one is allowed.\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\n**Direct access to the api is working as expected!**\r\n\r\nHardcoding 'blaat'  instead of `$origin` on https://github.com/directus/api/blob/master/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php#L158 results in: \r\n\r\n```\r\nThe 'Access-Control-Allow-Origin' header contains multiple values 'blaat, *', but only one is allowed.\r\n```\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: MacOS, using Chrome latest stable\r\n- Web Server: Apache 2.4\r\n- PHP Version: 7.2\r\n- Database: MySQL5.6.42\r\n- Install Method: https://docs.directus.io/advanced/source.html\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nArabic characters and other Unicode languages are not shown correctly in the API JSON output\r\n## Steps to Reproduce\r\nStore Arabic text in the database, retrieve data using the api\r\n\r\n## Expected Behavior\r\nCorrect Arabic text is entered by user. For example \"ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖ\"\r\n## Actual Behavior\r\nUnreadable non-Arabic text. For example \"\\u0633\\u0628\\u0627\\u064a\\u0633\\u064a \\u0645\\u064a\\u0644\"\r\n## Other Context & Screenshots\r\nI have a fix for this issue. \r\n\r\n```\r\ngit diff src/core/Directus/Application/Route.php \r\ndiff --git a/src/core/Directus/Application/Route.php b/src/core/Directus/Application/Route.php\r\nindex 69bc202c8..f42136390 100644\r\n--- a/src/core/Directus/Application/Route.php\r\n+++ b/src/core/Directus/Application/Route.php\r\n@@ -97,11 +97,11 @@ abstract class Route\r\n \r\n         switch ($type) {\r\n             case 'scim+json':\r\n-                $response = $response->withScimJson($data);\r\n+                $response = $response->withScimJson($data,null,JSON_UNESCAPED_UNICODE);\r\n                 break;\r\n             case 'json':\r\n             default:\r\n-                $response = $response->withJson($data);\r\n+                $response = $response->withJson($data,null,JSON_UNESCAPED_UNICODE);\r\n         }\r\n```\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop, iPhone6, etc]\r\n- OS: [eg: MacOS 10.13.6, Windows 10.1803]\r\n- Web Server: [eg: Apache 2.4.37]\r\n- PHP Version: [eg: 7.2.0]\r\n- Database: [eg: MySQL 8.0.12]\r\n- Install Method: [eg: cloned `master` branch]\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Run `./directus install:database`\r\n\r\n## Expected Behavior\r\ndatabase table creation.\r\n\r\n## Actual Behavior\r\n\r\nThe problem is, that the files from `/etc/php-cli.d` are by default being loaded in an alphabetical order:\r\n```\r\n\"/usr/bin/php\" \"/var/www/local.directus/directus/bin/directus\" \"install:database\"\r\nPHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib64/php/modules/pdo_mysqlnd.so' - /usr/lib64/php/modules/pdo_mysqlnd.so: undefined symbol: mysqlnd_allocator in Unknown on line 0\r\nYou need to enable the PDO_Mysql extension for Phinx to run properly.\r\nDone.\r\n```\r\n\r\nOnce having fixed this and then running the command twice, it should possibly exit gracefully:\r\n```\r\n\"/usr/bin/php\" \"/var/www/local.directus/directus/bin/directus\" \"install:database\"\r\nSQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'directus_activity-id' for key 'idx_collection_field'\r\nDone.\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\nSymbol `mysqlnd_allocator` is only defined, when loading these modules in a pre-defined order:\r\n\r\n    # nano /etc/php-cli.d/mysqlnd.ini\r\n    ;extension=mysqlnd.so\r\n\r\n    # nano /etc/php-cli.d/pdo_mysqlnd.ini\r\n    extension=mysqlnd.so\r\n    extension=pdo_mysqlnd.so\r\n\r\nUsing `*.ini` file-names prefixed with their priority would also permit to control their loading order, as `cakephp/phinx` [issue #900](https://github.com/cakephp/phinx/issues/900) suggests, which is basically the same problem.\r\n\r\n## Technical Details\r\n\r\n- Device: [Desktop]\r\n- OS: [Redhat Linux, Kernel 3.10]\r\n- Web Server: [Apache 2.4.37]\r\n- PHP Version: [7.1.26]\r\n- Database: [MariaDB 10.2.22]\r\n- Install Method: [cloned the `master` branch]\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Call the API for any collection, appending the query string parameter \"single=false\" or \"single=0\".\r\n\r\n## Expected Behavior\r\nThe API will return multiple values.\r\n\r\n## Actual Behavior\r\nThe API returns a single value.\r\n\r\n## Technical Details\r\n\r\n- Directus API 2.0.18 Docker\r\n"},{"labels":["bug",null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Feature Request\r\nAdding the possibility to filter collections with a many to many relation\r\n\r\n## What problem does this feature solve?\r\nI have a `page` collection and a `tag` collection. I would like to filter pages that have a relation with a `tag` with title values **Tag 1** AND **Tag 2** AND **Tag 3**.\r\n\r\nMy pages table:\r\n![image](https://user-images.githubusercontent.com/6450927/54278201-0866b000-4592-11e9-99c7-7df8178ac888.png)\r\nMy tags table:\r\n![image](https://user-images.githubusercontent.com/6450927/54278228-1a485300-4592-11e9-98fa-2eb61c00ccdc.png)\r\nThe many to many relational table (page_tags):\r\n![image](https://user-images.githubusercontent.com/6450927/54278283-3ea42f80-4592-11e9-8f38-ef3dca837d22.png)\r\n\r\n## How do you think this should be implemented?\r\nNo idea, but the following query is giving me the right result:\r\n```\r\nSELECT p.*\r\n  FROM page p\r\n WHERE EXISTS (SELECT NULL\r\n                 FROM page_tags tg\r\n                 JOIN tags t ON t.id = tg.tags_id\r\n                WHERE t.title IN ('Tag 1','Tag 2','Tag 3')\r\n                  AND tg.page_id = p.id\r\n             GROUP BY tg.page_id\r\n               HAVING COUNT(DISTINCT t.title) = 3)\r\n```\r\n`HAVING COUNT(DISTINCT t.title) = 3` makes sure I only get a result with ALL values:\r\n\r\n![image](https://user-images.githubusercontent.com/6450927/54279314-0fdb8880-4595-11e9-8689-fa756567407c.png)\r\n\r\nHere is my DB\r\n[somedb (1).sql.gz](https://github.com/directus/directus/files/2961413/somedb.1.sql.gz)\r\n\r\n## Would you be willing to work on this?\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nNote: Once again I'm not sure whether this is a bug report or feature request. Let me know if I should reclassify it.\r\n\r\n## Steps to Reproduce\r\n\r\n**My actual use case:** Retrieve promotions which have not yet expired, i.e. `expires_at` is null OR is a time greater than now.\r\n\r\nWhile trying to make this work, I discovered a bit of a can of worms with `logical=or` not working for various operator types (regardless of whether you use multiple filters on the same field or multiple fields) ...\r\n\r\n1. Set up a collection with a nullable `expires_at` field (just because it's easiest to see the problem if the query is of the form \"null OR something\")\r\n2. Run the following query with any of the operators listed below:\r\n    ```\r\n    /items/COLLECTION?filter[expires_at][0][null]&filter[expires_at][1][logical]=or&filter[expires_at][1][OPERATOR]=VALUE\r\n    ```\r\n\r\nOperators which **don't** work: `neq`, `lt`, `lte`, `gt`, `gte`, `nin`, `null`, `nnull`, `ncontains`, `nrlike`, `nbetween`\r\nOperators which **do** work: `eq`, `in`, `contains`, `rlike`, `between`\r\n\r\n## Expected Behavior\r\n\r\nThe API returns all items where `expires_at` is null OR matches the given condition.\r\n\r\n## Actual Behavior\r\n\r\nFor the list of operators which don't work, the API ignores the `or`, uses `and` instead, and therefore returns an empty list.\r\n\r\n## Other Context & Screenshots\r\n\r\nIt looks like this is because the `whereXXX` methods in `src\\core\\Directus\\Database\\Query\\Builder.php` take inconsistent arguments - the operators which work take something like `($column, $value, $not = false, $logical = 'and')` and most of the ones which don't just take `($column, $value)`. The exception is `whereNull`, which has `$logical` as the third parameter instead of the fourth.\r\n\r\nWhen `RelationTableGateway::doFilter` calls those methods on `Builder`, it assumes all the methods take 4 arguments in the same order.\r\n\r\nAs an experiment, I tried updating `whereGreaterThan` to:\r\n\r\n```php\r\n    public function whereGreaterThan($column, $value, $not = false, $logical = 'and')\r\n    {\r\n        return $this->where($column, '>', $value, $not, $logical);\r\n    }\r\n```\r\n\r\nand the query `filter[expires_at][0][null]&filter[expires_at][1][logical]=or&filter[expires_at][1][>]=0` correctly returned all documents.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: WSL Ubuntu 18.04 on Windows 10\r\n- Web Server: Apache/2.4.29 (Ubuntu)\r\n- PHP Version: 7.2.10-0ubuntu0.18.04.1\r\n- Database: Ver 14.14 Distrib 5.7.24, for Linux (x86_64)\r\n- Install Method: Cloned master branch (and pulled just now, just in case)"},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create user in a non admin without full write permissions to directus_collection_presets table\r\n2. Attempt to resize a column as that user\r\n3. Error is returned due to lack of permission \r\n\r\n## Expected Behavior\r\nUser should be able to edit `directus_collection_presets` \r\n\r\n## Actual Behavior\r\nResponse is \r\n```\r\n{code: 302, message: \"Updating item from \"directus_collection_presets\" collection was denied\"}\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\n```\r\n2019-03-03 17:22:08] api[_].ERROR: Directus\\Permissions\\Exception\\ForbiddenCollectionUpdateException: Updating item from \"directus_collection_presets\" collection was denied in /var/www/api/src/core/Directus/Permissions/Acl.php:1072\r\nStack trace:\r\n#0 /var/www/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(1276): Directus\\Permissions\\Acl->enforceUpdateAll\r\n#1 /var/www/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(852): Directus\\Database\\TableGateway\\BaseTableGateway->enforceUpdatePermission\r\n#2 /var/www/api/vendor/zendframework/zend-db/src/TableGateway/AbstractTableGateway.php(361): Directus\\Database\\TableGateway\\BaseTableGateway->executeUpdate\r\n#3 /var/www/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php(455): Zend\\Db\\TableGateway\\AbstractTableGateway->updateWith\r\n#4 /var/www/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(498): Directus\\Database\\TableGateway\\BaseTableGateway->updateRecordByArray\r\n#5 /var/www/api/src/core/Directus/Services/ItemsService.php(156): Directus\\Database\\TableGateway\\RelationalTableGateway->updateRecord\r\n#6 /var/www/api/src/core/Directus/Services/CollectionPresetsService.php(62): Directus\\Services\\ItemsService->update\r\n#7 /var/www/api/src/endpoints/CollectionPresets.php(89): Directus\\Services\\CollectionPresetsService->update\r\n#8 [internal function]: Directus\\Api\\Routes\\CollectionPresets->update\r\n#9 /var/www/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\n```\r\n\r\n## Technical Details\r\n\r\nDevice: Desktop\r\nOS: MacOs High Sierra\r\nWeb Server: nginx\r\nPHP Version: 7.2\r\nDatabase: Mysql 5.2\r\nInstall Method: docker 2.0.17 and 7.0.17\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nRelationships doesn't work when using string based relation for example a slug relation or in the future with UUID\r\n\r\n\r\n## Steps to Reproduce\r\n\r\n1- Create a collection with a varchar primary key \r\n2- Create another collection and set a one to many or many to many relationship to the first collection\r\n3- It will sabe to the database but will not follow relations with things like fields=*.* \r\n\r\n## Expected Behavior\r\n\r\nWork the same way that it does with integer relations\r\n\r\n## Actual Behavior\r\n\r\nDoesn't resolver relations between collections\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\nThe record\r\n![image](https://user-images.githubusercontent.com/3846473/53543260-b29cfd00-3ae7-11e9-9ce9-6bd401bf23ae.png)\r\nThe record with fields=*/*\r\n![image](https://user-images.githubusercontent.com/3846473/53543241-a3b64a80-3ae7-11e9-84af-219b40af8654.png)\r\n\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Any\r\n- OS: Ubuntu (server and client)\r\n- Web Server: Nginx 1.10.3\r\n- PHP Version: 7.2\r\n- Database: MySQL 5.7\r\n- Install Method: The cloned full package at v7.0.18\r\n"},{"labels":[null,"bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Clone directus api from master\r\n2. Use nginx with php-fpm server to serve the data\r\n3. Use Directus Web with api served by nginx\r\n4. Login to Directus Web and check browser logs for CORS and 405 Not Allowed request in Network\r\n\r\n## Expected Behavior\r\n\r\nRetrieve server info succesfully when making the request to endpoint `/` using nginx\r\n\r\n## Actual Behavior\r\n\r\nCannot retrieve server info when it's making a OPTIONS & GET request to the nginx server to endpoint `/`\r\n\r\n## Other Context & Screenshots\r\n\r\nThis works for all other http servers like Apache, Caddy or local php server.\r\n\r\nNginx Default conf\r\nhttps://gist.github.com/benydc/2e41b05edcddce62b17649b707c2931d\r\n\r\nNginx conf\r\nhttps://gist.github.com/benydc/69de3c6d4249551c2ae40fae5a1dcd7e\r\n\r\nScreenshots\r\n<img width=\"1677\" alt=\"screenshot 2019-02-27 at 22 23 23\" src=\"https://user-images.githubusercontent.com/19665791/53526264-5f797900-3aec-11e9-875e-3d7785313182.png\">\r\n<img width=\"835\" alt=\"screenshot 2019-02-27 at 11 45 04\" src=\"https://user-images.githubusercontent.com/19665791/53526286-7029ef00-3aec-11e9-9fbf-afe284100c28.png\">\r\n<img width=\"1580\" alt=\"screenshot 2019-02-27 at 10 17 40\" src=\"https://user-images.githubusercontent.com/19665791/53526295-791ac080-3aec-11e9-8646-c1f87e2641aa.png\">\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: [Desktop, Docker]\r\n- OS: [MacOS 10.14.2, Alpine]\r\n- Web Server: [Nginx 1.15.8]\r\n- PHP Version: [7.3.2]\r\n- Database: [MySQL 8.0.15]\r\n- Install Method: [cloned `master` branch]\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Login\r\n2. Access Admin Settings from dropup menu on the bottom left screen\r\n3. Go to Global Settings\r\n4. Change Thumbnail Dimensions data, for example click the thumbnail size (default 200x200) then add new 100x100\r\n5. Click submit on the right top\r\n6. See error\r\n\r\n## Expected Behavior\r\n\r\nIt save the data\r\n\r\n## Actual Behavior\r\n\r\nIt show error which it cannot save Thumbnail Dimension data (ID: 11 on browser network logger) as array on my database\r\n\r\n## Other Context & Screenshots\r\n\r\n1. Example same size\r\n![image](https://user-images.githubusercontent.com/40653902/53495247-22a08880-3ad2-11e9-85f4-75a8001071f0.png)\r\n2. Example different size\r\n![image](https://user-images.githubusercontent.com/40653902/53495340-5b406200-3ad2-11e9-9650-93cbef7891f9.png)\r\n3. Try to change from external using the submitted array value on chrome network then refresh the page\r\n![image](https://user-images.githubusercontent.com/40653902/53495744-208af980-3ad3-11e9-952a-3a3eb7d77961.png)\r\n4. Which I think the input is not converted to my database as string like 100x200,300x400 which (again) showing better value and even same like if I make it using the field\r\n![image](https://user-images.githubusercontent.com/40653902/53495940-92634300-3ad3-11e9-9cff-ccab575da251.png)\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Lenovo Laptop\r\n- OS: Windows 10 10.0.17134\r\n- Web Server: XAMPP for Windows 7.1.21-0\r\n- PHP Version: 7.1.20\r\n- Database: MariaDB 10.1.34\r\n- Install Method: Download from https://github.com/directus/directus/releases pick the source zip (https://codeload.github.com/directus/directus/zip/v7.0.18), then open domain/public/admin then it ask for installation and provide database info, and voila it show the dashboard\r\n"},{"labels":["bug"],"text":"I try to get 3 random items from the database. Here's the code:\r\n\r\n```\r\nclient.getItems('items',{\r\n      fields:'*.*',\r\n      limit:3,\r\n      sort:'?'\r\n    })\r\n```\r\n\r\nBut I get \"Internal server error\" as a request. Sorting by field names (even with minus in front) works great, just to mention. ;) Maybe I do simething wrong? The JS SDK docs don't show the exact filtering procedure."},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n<!-- Only report bugs with the officially supported LAMP stack. Issues with alternate stacks are \"enhancements\". -->\r\n\r\n## Steps to Reproduce\r\n\r\n1. Login to Directus\r\n2. Navigate to File Library Page\r\n3. Click new\r\n4. Drag a image to the Upload Files window\r\n5. Error happens. \r\nResponse error: \r\n\r\n```\r\n{\"error\":{\"code\":9,\"message\":\"Failed generating the SQL query.\",\"query\":\"INSERT INTO `directus_files` (`type`, `filename`, `title`, `tags`, `description`, `location`, `charset`, `filesize`, `width`, `height`, `storage`, `checksum`, `uploaded_by`, `uploaded_on`) VALUES ('image\\/png', 'test-1.png', 'Test 1', '', '', '', 'binary', '12454', '110', '80', 's3', '06c266c3d6783715c857b94ada48dfb5', '1', '2019-02-19 09:32:04')\"}}\r\n```\r\n\r\n## Expected Behavior\r\nFile can be saved.\r\n## Actual Behavior\r\nUpload file doesn't work.\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\nAPP 7.0.18 and API 2.0.18\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Add a datetime field and set the \"Default to current datetime\" to true\r\n2. Create an item and see the datetime field is set to the current time\r\n3. Save the item\r\n4. See the error \"This value is not a valid datetime.\"\r\n\r\n## Expected Behavior\r\nItem saved successfully\r\n## Actual Behavior\r\nCannot save item.\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\nAPI 2.0.18 and APP 7.0.18\r\n"},{"labels":["bug"],"text":"## Issue\r\nUsing the groups functionality as documented (https://docs.directus.io/api/reference.html#groups) leads to error 9 SQL error. Am I doing something wrong here?\r\n\r\n## Version Info\r\n  - Directus API version (Or commit hash): Directus Demo\r\n  - PHP version: Directus Demo\r\n  - MySQL version: Directus Demo\r\n  - Web server: (Ex. Apache, nginx or IIS?) Directus Demo\r\n  - OS name and version: Directus Demo\r\n\r\n## Expected Behavior\r\n```json\r\n{\r\n  \"data\": [\r\n    {\r\n      \"state\": \"FL\"\r\n    },\r\n    {\r\n      \"state\": \"AZ\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n\r\n## Actual Behavior\r\n```json\r\n{\r\n  \"error\": {\r\n    \"code\": 9,\r\n    \"message\": \"Failed generating the SQL query.\",\r\n    \"query\": \"SELECT `theaters`.`id` AS `id`, `theaters`.`status` AS `status`, `theaters`.`name` AS `name`, `theaters`.`address` AS `address`, `theaters`.`city` AS `city`, `theaters`.`state` AS `state`, `theaters`.`zip` AS `zip`, `theaters`.`general_admission_price` AS `general_admission_price`, `theaters`.`matinee_price` AS `matinee_price`, `theaters`.`child_price` AS `child_price`, `theaters`.`senior_price` AS `senior_price`, `theaters`.`concession_screen_image` AS `concession_screen_image` FROM `theaters` WHERE `theaters`.`status` IN ('published', 'deleted', 'draft') GROUP BY `theaters`.`state` ORDER BY `theaters`.`id` IS NULL, `theaters`.`id` ASC, `theaters`.`id` ASC LIMIT 200 OFFSET 0\"\r\n  }\r\n}\r\n```\r\n\r\n## Steps to Reproduce\r\n 1. Go to https://next.demo-api.directus.app/_/items/theaters?groups=state\r\n"},{"labels":["bug"],"text":"## Steps to Reproduce\r\n\r\n1. I read the tutorial.\r\nhttps://docs.directus.io/extensions/custom-endpoints.html#creating-custom-endpoints\r\n\r\n2. I changed the name of the file `_example.php` in the `/public/extensions/custom/endpoints/` directory to `example.php`.\r\n\r\n3. I tested the endpoint.\r\n```\r\n$ curl http://directus.local/custom/example\r\n{\"error\":{\"error\":8,\"message\":\"API Environment Configuration Not Found: custom\"}}\r\n$ curl http://directus.local/example\r\n{\"error\":{\"error\":8,\"message\":\"API Environment Configuration Not Found: example\"}}\r\n$ curl http:/directus.local/_/example\r\n{\"error\":{\"code\":1,\"message\":\"Not Found\"}}\r\n$ curl http://directus.local/_/custom/example\r\n{\"error\":{\"code\":1,\"message\":\"Not Found\"}}\r\n```\r\n\r\nCan I see what I did wrong?"},{"labels":["bug"],"text":"I uploaded a PDF into Directus. The API will return the thumbnail paths as defined in directus_settings, however, the actual thumbnails are a 404 not found for pdf files."},{"labels":["bug"],"text":"# Bug Report\r\nFollowing error while attempting to edit a Text Input field on a collection's settings:\r\n```\r\nPATCH http://mysuperapi.dev/_/fields/products/name 500 (Internal Server Error)\r\nclass: \"PDOException\"\r\ncode: null\r\nfile: \"D:\\directus\\vendor\\zendframework\\zend-db\\src\\Adapter\\Driver\\Pdo\\Connection.php\"\r\nline: 379\r\nmessage: \"SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 2\"\r\n```\r\n\r\nEDIT:\r\nI think it has to do with the default value, if I enter something in the default value and try to save the field I get this error: \r\n`SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near  'DEFAULT 'something'' at line 2`\r\n\r\n## Steps to Reproduce\r\n\r\nNot sure how exactly this happens but:\r\nIt happened multiple times as the first time I got the error I deleted the field and recreated it, I don't remember having this error on the field creation, only editing it.\r\n\r\nSo...\r\n1. Create a text input field on a collection\r\n2. Try to edit the newly created field by clicking on it and just hit the 'save' button\r\n3. Nothing happens, the modal stays open, and if you go to the inspector you see the error.\r\n\r\n## Expected Behavior\r\nSave the edited field.\r\n\r\n## Actual Behavior\r\nNothing happens, the modal stays open, and if you go to the inspector you see the error.\r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/1764824/52269465-7211ef80-293e-11e9-9b9f-7c50a6458a8c.png)\r\n\r\n\r\n## Technical Details\r\n- OS: MacOS 10.13.6\r\n- Browser: Chrome 71\r\n- Directus App: v7.0.16\r\n- Directus API: v2.0.16\r\n- Install Method: git clone https://github.com/directus/directus.git\r\n- MySQL: 5.7.21\r\n- PHP: 7.2.14\r\n- Apache: 2.3.37\r\n\r\nEdit - Here's the stack trace: \r\n```\r\n[2019-02-05 15:22:19] api[mysuperapi].ERROR: PDOException: SQLSTATE[42000]: Syntax error or access violation: 1064 Erreur de syntaxe pr√®s de '' √† la ligne 2 in D:\\directus\\vendor\\zendframework\\zend-db\\src\\Adapter\\Driver\\Pdo\\Connection.php:379\r\nStack trace:\r\n#0 D:\\directus\\vendor\\zendframework\\zend-db\\src\\Adapter\\Driver\\Pdo\\Connection.php(379): PDO->query\r\n#1 D:\\directus\\vendor\\zendframework\\zend-db\\src\\Adapter\\Adapter.php(205): Zend\\Db\\Adapter\\Driver\\Pdo\\Connection->execute\r\n#2 D:\\directus\\src\\core\\Directus\\Database\\Schema\\SchemaFactory.php(240): Zend\\Db\\Adapter\\Adapter->query\r\n#3 D:\\directus\\src\\core\\Directus\\Services\\TablesService.php(1244): Directus\\Database\\Schema\\SchemaFactory->buildTable\r\n#4 D:\\directus\\src\\core\\Directus\\Services\\TablesService.php(604): Directus\\Services\\TablesService->updateTableSchema\r\n#5 D:\\directus\\src\\endpoints\\Fields.php(110): Directus\\Services\\TablesService->changeColumn\r\n#6 [internal function]: Directus\\Api\\Routes\\Fields->update\r\n#7 D:\\directus\\vendor\\slim\\slim\\Slim\\Handlers\\Strategies\\RequestResponse.php(41): call_user_func\r\n#8 D:\\directus\\vendor\\slim\\slim\\Slim\\Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#9 D:\\directus\\src\\core\\Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#10 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#11 D:\\directus\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(43): call_user_func_array\r\n#12 [internal function]: Slim\\DeferredCallable->__invoke\r\n#13 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#14 D:\\directus\\src\\core\\Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware.php(80): Slim\\Route->Slim\\{closure}\r\n#15 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#16 D:\\directus\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(43): call_user_func_array\r\n#17 [internal function]: Slim\\DeferredCallable->__invoke\r\n#18 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#19 D:\\directus\\src\\core\\Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#20 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#21 D:\\directus\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(43): call_user_func_array\r\n#22 [internal function]: Slim\\DeferredCallable->__invoke\r\n#23 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#24 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#25 D:\\directus\\vendor\\slim\\slim\\Slim\\Route.php(334): Slim\\Route->callMiddlewareStack\r\n#26 D:\\directus\\vendor\\slim\\slim\\Slim\\App.php(516): Slim\\Route->run\r\n#27 D:\\directus\\src\\core\\Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#28 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#29 D:\\directus\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(43): call_user_func_array\r\n#30 [internal function]: Slim\\DeferredCallable->__invoke\r\n#31 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#32 D:\\directus\\vendor\\wellingguzman\\proxy-detection\\src\\ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#33 D:\\directus\\src\\core\\Directus\\Application\\Http\\Middleware\\ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#34 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#35 D:\\directus\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(43): call_user_func_array\r\n#36 [internal function]: Slim\\DeferredCallable->__invoke\r\n#37 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#38 D:\\directus\\vendor\\akrabat\\ip-address-middleware\\src\\IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#39 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#40 D:\\directus\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(43): call_user_func_array\r\n#41 [internal function]: Slim\\DeferredCallable->__invoke\r\n#42 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#43 D:\\directus\\src\\core\\Directus\\Application\\Http\\Middleware\\CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#44 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#45 D:\\directus\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(43): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#48 D:\\directus\\src\\core\\Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware.php(47): Slim\\App->Slim\\{closure}\r\n#49 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#50 D:\\directus\\vendor\\slim\\slim\\Slim\\DeferredCallable.php(43): call_user_func_array\r\n#51 [internal function]: Slim\\DeferredCallable->__invoke\r\n#52 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(70): call_user_func\r\n#53 D:\\directus\\vendor\\slim\\slim\\Slim\\MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#54 D:\\directus\\vendor\\slim\\slim\\Slim\\App.php(407): Slim\\App->callMiddlewareStack\r\n#55 D:\\directus\\vendor\\slim\\slim\\Slim\\App.php(315): Slim\\App->process\r\n#56 D:\\directus\\src\\core\\Directus\\Application\\Application.php(161): Slim\\App->run\r\n#57 D:\\directus\\public\\index.php(5): Directus\\Application\\Application->run [] []\r\n```"},{"labels":["bug"],"text":"Posting a YouTube embed to the API (see request below) I am seeing a few issues:\r\n\r\n* The `directus_files.embed` is not saving (eg: `dQw4w9WgXcQ`)\r\n* The MIME type is saving as an image (`image/jpeg`) but it should be `embed/youtube`\r\n* We don't need a checksum of embeds\r\n\r\n@rijkvanzanten @WellingGuzman  thoughts on the MIME type?\r\n\r\n```\r\nPOST /_/files HTTP/1.1\r\nAuthorization: Bearer demo\r\nContent-Type: application/json\r\nHost: local.api.com\r\nConnection: close\r\nUser-Agent: Paw/3.1.8 (Macintosh; OS X/10.14.2) GCDHTTPRequest\r\nContent-Length: 85\r\n\r\n{\r\n  \"filename\": \"test.jpg\",\r\n  \"data\": \"https://www.youtube.com/watch?v=dQw4w9WgXcQ\"\r\n}```"},{"labels":["bug",null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n**1: Can't update the \"note / comment\" on a field after it's been set once**\r\n\r\n*Replicate*\r\n1) Create a field with a comment\r\n2) Go back to the field and try to edit the comment\r\n3) Get a SQL error in console\r\n\r\n*Expected*\r\n1) \"Note/Comment\" should've been updated.\r\n\r\n---\r\n\r\n**2: Can't update the \"required\" on a field after it's been set once**\r\n\r\n*Replicate*\r\n1) Create a collection with a text field that's not required\r\n2) Try to edit that new field to make it required\r\n3) Get a 500 error in console without any on-screen errors that something went wrong.\r\n\r\n*Expected*\r\n1) \"Required\" should've been updated.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: [eg: Desktop, iPhone6, etc]\r\n- OS: [eg: MacOS 10.13.6, Windows 10.1803]\r\n- Web Server: [eg: Apache 2.4.37]\r\n- PHP Version: 7.1.0\r\n- Database: [eg: MySQL 8.0.12]\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nI am running Directus app and api on Docker using the latest images. I have created my own dockerfile to move custom php settings to allow large file uploads (instead of the default 2Mb). \r\n\r\nmodified php settings\r\nupload_max_filesize=500M\r\npost_max_size=500M\r\nmemory_limit=500M\r\nmax_execution_time=1000\r\n\r\nmodified NGINX conf\r\nclient_max_body_size 500M;  \r\n\r\nHowever with the above settings I can upload a 20Mb video file, but any file that is just over 100Mb in size always returns an error (even though it should allow up to 500Mb).\r\n\r\nI cannot seem to find any log information to determine the cause.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to file library\r\n2. Click on add new file\r\n3. Pick an MP4 video file that is 20MB in size, file uploads ok\r\n4. Repeat 1-3 with a larger MP4 file >100Mb and we get the error shown in the attached image. Essentially there is a server error of some sort.\r\n\r\n## Expected Behavior\r\nFile that is >100Mb but less than 500Mb should be uploaded successfully to file library\r\n\r\n## Actual Behavior\r\nThe large file returns a server error (500) once the upload has completed. See attached image.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n![image](https://user-images.githubusercontent.com/47198569/52025342-d1e84f00-2568-11e9-8067-534455fab0a7.png)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10 Pro, running docker (linux containers)\r\n- Browser: Chrome 71.0.3578.98\r\n- Directus App: [eg: 7.0.6]\r\n- Directus API: latest\r\n- Install Method: taking latest versions of directus/api and directus/app using docker-compose but have my own dockerfile to copy in modified php and nginx configs for large files.\r\n\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nAll date and time types must have a datetime, date and time validation based on the database date, time, and datetime format.\r\n\r\nSending an invalid value will throw an internal error instead of a bad request error.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a field of any of the datetime types such as `time`, `date`, or `datetime`\r\n2. Create a new item with any string (not valid datetime format) to the new datetime field\r\n3. See error\r\n\r\n## Expected Behavior\r\n\r\nSee bad value error\r\n\r\n## Actual Behavior\r\n\r\nError parsing the string of the datetime\r\n\r\n## Other Context & Screenshots\r\n\r\n```json\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"DateTime::__construct(): Failed to parse time string (invalid) at position 0 (i): The timezone could not be found in the database\",\r\n        \"class\": \"Exception\",\r\n        \"file\": \"/Users/welling/src/api/src/core/Directus/Util/DateTimeUtils.php\",\r\n        \"line\": 65\r\n    }\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. create a collection with a time field\r\n2. create an item and give the field a value\r\n3. edit the item and remove the value\r\n\r\n## Expected Behavior\r\n\r\nit shoud remove the value from the field\r\n\r\n## Actual Behavior\r\n\r\nit does not remove the value from the field. \r\nIt sets the value to default time, which is not the default value\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- docker version 2.0.16\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Feature Request\r\nWhen using \"q\" parameter (usually using a search field in header bar of directus app), only rows with a field that exactly matches the searched string is returned. However, in practical life, it would be better if field would be matched partially. \r\n\r\nExample: In demo, collection \"Movies\": https://directus.app/#/collections/movies\r\nTry searching \"Years\". I expect the movie \"18 Years Later (Diciotto anni dopo)\" to be found, but no result is returned.\r\n\r\nIt can be bypassed by using a field filter using \"contains\" mode, however that is more difficult and less intuitive.\r\n\r\n## What problem does this feature solve?\r\nIt is a UX improvement. Users usually expect these \"quick search fields\" to work this way.\r\n\r\n## How do you think this should be implemented?\r\nThe DB query would be constructed using `field LIKE \"%VALUE%\"` instead of `field = \"VALUE\"`. Or at least for text fields.\r\n\r\n## Would you be willing to work on this?\r\nI could probably do this, however an experienced directus developer would do this way faster."},{"labels":["bug",null],"text":"## step by step\r\n\r\n'Admin setting' -> 'Collection and fields' -> choose collection -> choose field -> edit default value in schema tab -> click done -> see error\r\n\r\n## actually behaviors\r\n\r\non /_/fields/receipts/currency\r\n\r\nexecute with v2.0.14 (successfully query, but with issue #740):\r\n```\r\nALTER TABLE `receipts`\r\n   CHANGE COLUMN `currency` `currency` **VARCHAR(201)** DEFAULT 'KRW'\"\r\n```\r\n\r\nexecute with v2.0.16 (invalid query: missing data length #741):\r\n```\r\nALTER TABLE `receipts`\r\n  CHANGE COLUMN `currency` `currency` **VARCHAR** DEFAULT 'KRW'\r\n```\r\nAs a result,\r\n```\r\nSQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DEFAULT 'KRW'' at line 2\r\n```\r\n\r\n## versions\r\n- PHP Version 7.0.0p1\r\n- 10.0.21-MariaDB, for Linux (x86_64)"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection with checkbox field and save\r\n2. Edit the checkbox field to set a default value\r\n3. Save the field\r\n4. See error\r\n\r\n## Expected Behavior\r\nThe field update field window is closed and the field is saved.\r\n\r\n## Actual Behavior\r\nThe update field window is not closed and there is error `SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT 'value3'' at line 2` shown in the browser console. However, there is no error shown on directus UI.\r\n\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\nDirectus APP 7.0.16 and API 2.0.16\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n1. Set up S3 Flysystem adapter.\r\n2. Go to \"My Profile\" and try to upload an avatar.\r\n3. Click \"Save\".\r\n\r\n## Expected Behavior\r\nThe file should be uploaded when dragged into the \"Drop file here\" area, and then saved within the profile's M2M \"Files\" relationship.\r\n\r\n## Actual Behavior\r\nThe file is uploaded initially when dragged into the \"Drop file here\" area, but after clicking \"Save\", it deletes the file from S3, and returns the following JSON when calling PATCH /users/[userid]:\r\n`{\"error\":{\"code\":null,\"message\":\"File not found at path: 00000000812.jpg\"}}`\r\nNote that the \"file\" is leftover still in the File Library, but the file no longer exists in the S3 bucket.\r\nThe same issue occurs when inserting an existing file from the file library into an item- I can select the file, but then it deletes the file on save of the item.\r\n\r\n## Other Context & Screenshots\r\nI have S3 versioning turned on in the bucket, and can see the file gets uploaded successfully, but then is deleted when the item is saved:\r\n![image](https://user-images.githubusercontent.com/2905521/51856288-f5a35f00-22f4-11e9-90c2-5c6bbc27e23a.png)\r\n\r\n## Technical Details\r\nChrome 71 on Windows\r\nAPI 7.0.15 on directus/docker with Aurora MySQL DB, S3 bucket"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nWhen a many to one is created where the field name also exists in the related table, the api stops returning the values for the related collection.\r\n\r\nIf you have the following setup:\r\n\r\n```\r\nbroken_a\r\n--------------------\r\nid\r\ntext (varchar)\r\n\r\nbroken_b\r\n--------------------\r\nid\r\ntext (m2o)\r\n```\r\n\r\n```\r\nrelationship\r\n--------------------\r\ncollection_many: broken_b\r\nfield_many: text\r\ncollection_one: broken_a\r\n```\r\n\r\nfetching items from `broken_a` directly now doesn't return any values anymore.\r\n\r\n## Other Context & Screenshots\r\n\r\nI've provided an empty DB setup with an example of a working relationship and a broken one.\r\n\r\n[tables_dump_January_25_2019.sql.txt](https://github.com/directus/api/files/2797054/tables_dump_January_25_2019.sql.txt)\r\n\r\n## Technical Details\r\n\r\nAPI v7.0.15"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nI have a collections with a *file* field `featured_image`and a *files* field `images`.\r\n\r\nIf I query the table with `?fields=featured_image.filename,featured_image.title,images.image.filename,images.image.title`\r\n\r\nit return only the last field from images (so filename in this case). The other gets ignored.\r\nFor the featured image both values get returned:\r\n\r\n```\r\n{\r\n    \"data\": [\r\n        {\r\n            \"featured_image\": {\r\n                \"filename\": \"visita-tour-sintra-desde-lisboa-palacio-pena.jpg\",\r\n                \"title\": \"visita tour sintra desde lisboa palacio pena\"\r\n            },\r\n            \"images\": [\r\n                {\r\n                    \"image\": {\r\n                        \"title\": \"castelo dos moros castillo de los moros\"\r\n                    }\r\n                },\r\n[...]\r\n```\r\n## Steps to Reproduce\r\n\r\n1. Set up collection with a files field\r\n2. Upload some images\r\n3. Query for several fields in `images.image`\r\n4. See error\r\n\r\n## Expected Behavior\r\n\r\n## Actual Behavior\r\n\r\n## Other Context & Screenshots\r\n\r\n## Technical Details"},{"labels":["bug",null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection\r\n2. Add a TEXT field (e.g. use code interface)\r\n2. Edit the above field and try an make it TINYTEXT\r\n3. See Display Error:\r\n  Trouble processing request. Try again after refreshing the page.\r\n4. See Console Error:\r\n```\r\n{\r\n  \"error\": {\r\n    \"code\": null,\r\n    \"message\": \"SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '(65535)' at line 2\",\r\n    \"class\": \"PDOException\",\r\n    \"file\": \"/vendor/zendframework/zend-db/src/Adapter/Driver/Pdo/Connection.php\",\r\n    \"line\": 379\r\n  }\r\n}\r\n```\r\n\r\n\r\n## Expected Behavior\r\nShould be able to alter TEXT fields in MariaDB\r\n\r\n## Actual Behavior\r\nThe (65535) in the error is Directus trying to execute:\r\n\r\n```\r\n\"ALTER TABLE `test` CHANGE COLUMN `text_col` `text_col` TINYTEXT(65535)\r\n```\r\nMariaDB doesn't allow sizes when creating/altering any TEXT fields (TINY, MEDIUM, LONG, etc).\r\n\r\nMy hack is as follows:\r\n\r\n```\r\n--- a/src/core/Directus/Database/Schema/SchemaFactory.php\r\n+++ b/src/core/Directus/Database/Schema/SchemaFactory.php\r\n@@ -234,9 +234,12 @@ class SchemaFactory\r\n         $connection = $this->schemaManager->getSource()->getConnection();\r\n         $sql = new Sql($connection);\r\n \r\n+       // MariaDB doesn't like sizes for TEXT (tiny, medium, long, etc) columns\r\n+       $_ = preg_replace(\"/TEXT\\([^)]*\\)/\",\"TEXT\",$sql->buildSqlString($table));\r\n+\r\n         // TODO: Allow charset and comment\r\n         return $connection->query(\r\n-            $sql->buildSqlString($table),\r\n+            $_,\r\n             $connection::QUERY_MODE_EXECUTE\r\n         );\r\n     }\r\n```\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: OS X\r\n- Web Server: NGINX\r\n- PHP Version: 7.3\r\n- Database: MariaDB\r\n- Install Method: cloned `master` branch [c6b1ed8]\r\n"},{"labels":["bug",null],"text":"# Bug Report\r\n\r\nI can't do a nested filter (like `?filter[o2mcollection.code][eq]=123456`) on my queries even though the token user has full permissions on all tables and on `directus_relations`. \r\n\r\nI get the following error:\r\n\r\n````\r\n{\r\n    \"error\": {\r\n        \"code\": 215,\r\n        \"message\": \"Unable to access \\\"code\\\" related data\",\r\n        \"class\": \"Directus\\\\Database\\\\Exception\\\\ForbiddenFieldAccessException\",\r\n        \"file\": \"/var/www/directus7/src/core/Directus/Database/TableGateway/RelationalTableGateway.php\",\r\n        \"line\": 1205\r\n    }\r\n}\r\n````\r\n\r\nThe query works if I put the token user into the admin role group.\r\nThe query works if I filter just by the id of the related collection `?filter[o2mcollection]=1`\r\nThe query works without the filter and shows all contents of `o2mcollection` if I query `items/parent?fields=*.*`\r\n\r\nI tried giving the custom role *full permissions* (all blue checkmarks) on every table including directus tables - no change. I tried setting up a new user and a new role group - no change.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Set up two collections with a O2M relation\r\n2. Set up a new user and user role (ideally with only read permissions on created tables and `directus_relations`)\r\n3. Set a static token in the DB\r\n4. Query API & see error\r\n\r\n## Expected Behavior\r\n\r\nFilter the results according to the nested filter\r\n\r\n## Actual Behavior\r\n\r\nError message above\r\n\r\n## Other Context & Screenshots\r\n\r\n```\r\n[2019-01-25 10:28:19] api[_].ERROR: Directus\\Database\\Exception\\ForbiddenFieldAccessException: Unable to access \"code\" related data in /directusapi/src/core/Directus/Database/TableGateway/RelationalTableGateway.php:1205\r\nStack trace:\r\n#0 /directusapi/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1445): Directus\\Database\\TableGateway\\RelationalTableGateway->parseDotFilters\r\n#1 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->processFilter\r\n#2 /directusapi/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(799): call_user_func_array\r\n#3 /directusapi/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1011): Directus\\Database\\TableGateway\\RelationalTableGateway->applyParamsToTableEntriesSelect\r\n#4 /directusapi/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1131): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems\r\n#5 /directusapi/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(819): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData\r\n#6 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems\r\n#7 /directusapi/src/core/Directus/Services/AbstractService.php(326): call_user_func_array\r\n#8 /directusapi/src/core/Directus/Services/AbstractService.php(270): Directus\\Services\\AbstractService->getDataAndSetResponseCacheTags\r\n#9 /directusapi/src/core/Directus/Services/ItemsService.php(57): Directus\\Services\\AbstractService->getItemsAndSetResponseCacheTags\r\n#10 /directusapi/src/endpoints/Items.php(43): Directus\\Services\\ItemsService->findAll\r\n#11 [internal function]: Directus\\Api\\Routes\\Items->all\r\n#12 /directusapi/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\n#13 /directusapi/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#14 /directusapi/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#15 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#16 /directusapi/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#17 [internal function]: Slim\\DeferredCallable->__invoke\r\n#18 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#19 /directusapi/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(80): Slim\\Route->Slim\\{closure}\r\n#20 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#21 /directusapi/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#22 [internal function]: Slim\\DeferredCallable->__invoke\r\n#23 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#24 /directusapi/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#25 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#26 /directusapi/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#27 [internal function]: Slim\\DeferredCallable->__invoke\r\n#28 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#29 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#30 /directusapi/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\n#31 /directusapi/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\n#32 /directusapi/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#33 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#34 /directusapi/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#35 [internal function]: Slim\\DeferredCallable->__invoke\r\n#36 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#37 /directusapi/vendor/wellingguzman/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#38 /directusapi/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#39 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#40 /directusapi/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#41 [internal function]: Slim\\DeferredCallable->__invoke\r\n#42 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#43 /directusapi/vendor/akrabat/ip-address-middleware/src/IpAddress.php(113): Slim\\App->Slim\\{closure}\r\n#44 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#45 /directusapi/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#48 /directusapi/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#49 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#50 /directusapi/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#51 [internal function]: Slim\\DeferredCallable->__invoke\r\n#52 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#53 /directusapi/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(47): Slim\\App->Slim\\{closure}\r\n#54 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#55 /directusapi/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#56 [internal function]: Slim\\DeferredCallable->__invoke\r\n#57 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#58 /directusapi/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#59 /directusapi/vendor/slim/slim/Slim/App.php(406): Slim\\App->callMiddlewareStack\r\n#60 /directusapi/vendor/slim/slim/Slim/App.php(314): Slim\\App->process\r\n#61 /directusapi/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#62 /directusapi/public/index.php(5): Directus\\Application\\Application->run [] []\r\n```\r\n## Technical Details\r\n\r\n- Directus 2.0.15\r\n- same on localhost MAMP and Ubuntu LAMP\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create new role with system defaults\r\n2. Create new user and assign to role\r\n3. Login as new user and try to update My Profile\r\n4. See error:\r\n\r\nUpdating item from \"directus_users\" collection was denied\r\n\r\n## Expected Behavior\r\nCan update self without \"Full\" update access to directus_users\r\n\r\n## Actual Behavior\r\nGet above error.  After updating permissions to allow Full update access it works, but then of course the user can update everyone.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: OSX\r\n- Web Server: NGINX\r\n- PHP Version: 7.3\r\n- Database: MariaDB\r\n- Install Method: cloned `master` branch [c6b1ed8]\r\n"},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\nQuerying any tables with M2M to a file results in the following:\r\n\r\n```\r\n<b>Notice</b>:  Undefined index: uploaded_by in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: uploaded_by in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: uploaded_by in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: uploaded_by in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: uploaded_by in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: uploaded_by in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: folder in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: folder in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: folder in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: folder in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: folder in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n<br />\r\n<b>Notice</b>:  Undefined index: folder in <b>/var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1793</b><br />\r\n```\r\n\r\n## Expected Behavior\r\nI expect to receive the API results without the errors appended.\r\n\r\n## Actual Behavior\r\nI receive the API results, with errors appended to the end.\r\n\r\n## Other Context & Screenshots\r\nThis was an upgrade from Directus v6 so I don't know if that has anything to do with it. I am running in \"staging\" mode... in \"production\" mode this does not occur. I verified the `directus_files` table does contain the `uploaded_by` and `folder` columns.\r\n\r\n## Technical Details\r\nUsing https://github.com/directus/docker with Amazon RDS Aurora MySQL database."},{"labels":["bug"],"text":"# Bug Report\r\n\r\nDirectus Settings doesn't allow any other value to be saved than a String (which makes sense, cause  all the columns are stored in the same string based column). That being said, it makes using non-string interfaces for directus_settings impossible (like `tags` for `thumbnail_dimensions` as it will throw an error\r\n\r\n```\r\nAttempting to write an array as the value for field \"value\" in \"directus_settings\"\r\n```\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'Settings'\r\n2. Enter a value for 'Thumbnail Dimensions\"\r\n3. Save\r\n4. See error\r\n\r\n## Expected Behavior\r\n\r\n`directus_settings` should accept the `type` as set in `directus_fields`. `/settings` should allow any type field and cast it to/from a string before saving.\r\n\r\n## Actual Behavior\r\n\r\nAPI returns error if any non-string value is being saved.\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nFiltering by a read blacklisted field is not enforced. Even if the field is not on the result, you can still filter by the field value. (Ref: #667)\r\n\r\n## Steps to Reproduce\r\n\r\nAdd any field to read blacklist, and try to filter by that field.\r\n\r\n## Expected Behavior\r\n\r\nIt should throw an exception\r\n\r\n## Actual Behavior\r\n\r\nNo error, filter get processed. "},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a new collection with `status` option enabled\r\n2. Add 13 items\r\n3. Delete some and keep 7 items\r\n4. Add this collection as M2O in other collection  \r\n5. Check M2O interface's API response\r\n\r\n## Expected Behavior\r\nThe `total_count` should be `7` excluding deleted items\r\n\r\n## Actual Behavior\r\nThe `total_count` gives `13`\r\n\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/7118937/51455270-d2b20180-1d6e-11e9-80a0-0f637ec5ad54.png)\r\n\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: MacBook\r\n- OS: MacOS Mojave\r\n- Web Server: Apache/2.2.34\r\n- PHP Version: PHP Version 7.2.7\r\n- Database: MySQL 5.7.21\r\n- Install Method: Cloned `master` branch\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a field with translations via the API, for example:\r\n\r\n```bash\r\ncurl \"http://localhost:8080/_/fields/translated_collection\" \\\r\n  -H \"Content-Type: application/json;charset=utf-8\" \\\r\n  -H \"Authorization: Bearer SOMETOKEN\" \\\r\n  --data '{\"sort\":null,\"field\":\"translated_field\",\"type\":\"string\",\"datatype\":\"VARCHAR\",\"interface\":\"slug\",\"default_value\":null,\"options\":{\"placeholder\":\"\",\"forceLowercase\":true},\"readonly\":false,\"required\":false,\"unique\":false,\"note\":null,\"hidden_detail\":false,\"hidden_browse\":false,\"primary_key\":false,\"validation\":null,\"length\":200,\"collection\":\"comparison_page\",\"translation\":{\"en-US\":\"THIS IS TRANSLATED\"}}'\r\n```\r\n\r\n(note the `\"translation\":{\"en-US\":\"THIS IS TRANSLATED\"}` key at the end of the form data)\r\n\r\n2. Request all collections (like the app does to hydrate):\r\n\r\n```bash\r\ncurl \"http://localhost:8080/_/collections\" \\\r\n  -H \"Authorization: Bearer SOMETOKEN\" \\\r\n  -H \"Content-Type: application/json;charset=utf-8\"\r\n```\r\n\r\n## Expected Behavior\r\n\r\nThe `translated_collection` collection and `translated_field` field both have a `translation` property which is an object with an `en-US` key, something like\r\n\r\n```js\r\n\"data\": [\r\n  {\r\n    \"collection\": \"translated_collection\",\r\n    \"fields\": {\r\n      \"translated_field\": { ..., \"translation\": { \"en-US\": \"THIS IS TRANSLATED\" } }\r\n    },\r\n    \"translation\": { \"en-US\": \"TRANSLATED COLLECTION NAME\" },\r\n    ...\r\n  }\r\n]\r\n```\r\n\r\n## Actual Behavior\r\n\r\nThe `translation` property on the collection is in the expected format, but the `translation` property on the field has not been deserialized from JSON (it's still a string):\r\n\r\n```js\r\n\"data\": [\r\n  {\r\n    \"collection\": \"translated_collection\",\r\n    \"fields\": {\r\n      \"translated_field\": { ..., \"translation\": \"{\\\"en-US\\\":\\\"THIS IS TRANSLATED\\\"}\" }\r\n    },\r\n    \"translation\": { \"en-US\": \"TRANSLATED COLLECTION NAME\" },\r\n    ...\r\n  }\r\n]\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\nI discovered this when looking into https://github.com/directus/app/issues/422 - it means that field translations can't be handled in the same way as collection name translations already are.\r\n\r\nI tried investigating this and just got confused, but I wonder if it's something to do with the `item.read` filter in `CoreServicesProvider.php` being called for collection rows but not field rows when that endpoint is hit (that's how it appears based on putting some logging in there). I notice it is hit when the `directus_settings` fields are requested, and if you try adding a translation to the database for one of those fields it comes back in the expected deserialized JSON format.\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: WSL Ubuntu 18.04 on Windows 10 1803\r\n- Web Server: Apache/2.4.29 (Ubuntu)\r\n- PHP Version: 7.2.10-0ubuntu0.18.04.1\r\n- Database: Ver 14.14 Distrib 5.7.24, for Linux (x86_64)\r\n- Install Method: Cloned `master` branch (and pulled just now, just in case)\r\n"},{"labels":["bug",null],"text":"# Bug Report\r\nThis bug is preventing any other user than initial admin from logging in.\r\nI've tried to create a new database and run the install from scratch for a specific project (other than default) as described [here](https://docs.directus.io/advanced/api/configuration.html#configure-with-script), but the only user allowed to navigate around is the initial admin. All other users are getting 405 Not Allowed.\r\n\r\n## Steps to Reproduce\r\n1. Having an existing project with default config create a new database, api config and a new admin user as described [here](https://docs.directus.io/advanced/api/configuration.html#configure-with-script).\r\n2. Login with the admin account and create a new user (Admin or other profile, both didn't work).\r\n3. Login with the new account in the same window. This should allow you to enter. However It looks like you're still seeing the old data.\r\n4. Login in an anonymous window or refresh the page and cache (cmd+shift+r) and you should get a server error message.\r\n\r\n## Expected Behavior\r\nNo application errors.\r\n## Actual Behavior\r\nCouple of errors appear. This seems to be still a problem with the shared env endpoints (layouts, pages, interfaces). However, the only confusing error is the \"User not found\" message, even though I'm 100% sure the user exists in the database.\r\n\r\n![screenshot 2019-01-19 at 01 06 31](https://user-images.githubusercontent.com/7890555/51418923-d6832f80-1b86-11e9-9881-d38f61181435.png)\r\n![screenshot 2019-01-19 at 01 07 03](https://user-images.githubusercontent.com/7890555/51418924-d6832f80-1b86-11e9-9feb-c5bd150f3732.png)\r\n![screenshot 2019-01-19 at 01 07 26](https://user-images.githubusercontent.com/7890555/51418922-d6832f80-1b86-11e9-86f1-aaab3d7348d0.png)\r\n![screenshot 2019-01-19 at 01 07 48](https://user-images.githubusercontent.com/7890555/51418920-d5ea9900-1b86-11e9-8fd2-f20029e89f88.png)\r\n![screenshot 2019-01-19 at 01 08 01](https://user-images.githubusercontent.com/7890555/51418921-d5ea9900-1b86-11e9-8031-5238afda6d50.png)\r\n\r\n\r\n## Technical Details\r\n- API: 2.0.14\r\n- APP: 2.0.14\r\n- OS: Ubuntu 16.04.5 LTS\r\n- Web Server: nginx/1.14.1\r\n- PHP Version: 7.0.32\r\n- Database: MySQL 5.7.24\r\n- Install Method: pulled from `build`\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n‚ö† I'm not sure how to reproduce this bug because I think it is mainly due to the environment.\r\n\r\nHere are some details about the environment: \r\n\r\n - Server API: FPM/FastCGI\r\n - post_max_size: 96M\r\n - upload_max_filesize: 62M\r\n\r\nFeel free to ask if you need more details, I don't know what can be useful to understand the issue.\r\n\r\n1. Go to any form with a file input\r\n2. See wrong max file size\r\n\r\n![image](https://user-images.githubusercontent.com/5880435/51319997-d0922f00-1a5e-11e9-96b9-53ca345110a0.png)\r\n\r\n## Expected Behavior\r\n\r\nMax file size should be 62 MB.\r\n\r\n## Actual Behavior\r\n\r\nMax file size is 2 MB.\r\n\r\n## Other Context & Screenshots\r\n\r\nI made it work by just changing one line of code:\r\n\r\n```diff\r\n--- a/src/endpoints/Home.php\r\n+++ b/src/endpoints/Home.php\r\n@@ -12,7 +12,7 @@ class Home extends Route\r\n     public function __invoke(Request $request, Response $response)\r\n     {\r\n         $service = new ServerService($this->container);\r\n-        $responseData = $service->findAllInfo();\r\n+        $responseData = $service->findAllInfo(false);\r\n\r\n         return $this->responseWithData($request, $response, $responseData);\r\n     }\r\n```\r\n\r\n\r\n\r\n\r\n\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n<!-- Only report bugs with the officially supported LAMP stack. Issues with alternate stacks are \"enhancements\". -->\r\n\r\n## Steps to Reproduce\r\n\r\n1. Configure s3 adapter in api configuration\r\n2. Upload an image in File Library\r\n3. Click on the uploaded image (the thumbnail works fine) to direct to Editing Item page\r\n4. The display of image crash\r\n\r\n## Expected Behavior\r\nThe image displayed correctly with right url.\r\n## Actual Behavior\r\nDirectus tries to find the image directly on the local server but the image is on s3,thus the image cannot be loaded.\r\n## Other Context & Screenshots\r\n![image](https://user-images.githubusercontent.com/35513964/50889165-416b9280-1432-11e9-9579-992c8bb70f20.png)\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- OS: Windows 10\r\n- Browser: Chrome\r\n- Directus App: 7.0.13\r\n- Directus API: 2.0.13\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nI have a managed collection where the primary key is a string column. The items from that collection cannot be removed from the app.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to the collection\r\n2. Select one item\r\n3. Click the delete button\r\n4. Confirm the at the popup\r\n5. See error\r\n\r\n## Expected Behavior\r\n\r\nThe item should be removed from the db and from the interface.\r\n\r\n## Actual Behavior\r\n\r\nAn error is displayed and no item is removed.\r\n\"\r\nTrouble processing request. Try again after refreshing the page.\r\n\"\r\n\r\n## Other Context & Screenshots\r\n\r\nAt the database I see this queries being executed:\r\n\r\nSELECT `items`.* FROM `items` WHERE `rfid` = 'E20000191317008425901324' LIMIT 1\r\nSELECT `items`.`rfid` AS `rfid` FROM `items` WHERE `rfid` = 'E20000191317008425901324'\r\nDELETE FROM `items` WHERE `rfid` IN (NULL)\r\n\r\n## Technical Details\r\n\r\n- Device: Google Cloud Server\r\n- OS: Apache\r\n- Browser: Chrome\r\n- Directus App: 7.0.14\r\n- Install Method: cloned `master` branch of `directus/directus`\r\n"},{"labels":["bug"],"text":"When the custom endpoint is missing the leading slash, the endpoint id and the path merge together as a single name.\r\n\r\nExample:\r\n\r\nWhen Endpoint ID = `example` and the endpoint route path name is `users`, the result endpoint is `/exampleusers` instead of `/example/users`."},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Soft delete a user by changing the status to `deleted`\r\n2. See error\r\n\r\n## Expected Behavior\r\n\r\nUser status should be changed\r\n\r\n## Other Context & Screenshots\r\n\r\n<details>\r\n<summary>Stack trace</summary>\r\n<pre>\r\n[2019-01-15 17:48:46] api[_].ERROR: TypeError: Argument 3 passed to Directus\\Application\\Route::responseWithData() must be of the type array, null given, called in /var/www/api-next/src/endpoints/Users.php on line 131 in /var/www/api-next/src/core/Directus/Application/Route.php:40\r\nStack trace:\r\n#0 /var/www/api-next/src/endpoints/Users.php(131): Directus\\Application\\Route->responseWithData\r\n#1 [internal function]: Directus\\Api\\Routes\\Users->update\r\n#2 /var/www/api-next/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func\r\n#3 /var/www/api-next/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke\r\n#4 /var/www/api-next/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke\r\n#5 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#6 /var/www/api-next/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#7 [internal function]: Slim\\DeferredCallable->__invoke\r\n#8 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#9 /var/www/api-next/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(80): Slim\\Route->Slim\\{closure}\r\n#10 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke\r\n#11 /var/www/api-next/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#12 [internal function]: Slim\\DeferredCallable->__invoke\r\n#13 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#14 /var/www/api-next/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}\r\n#15 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke\r\n#16 /var/www/api-next/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#17 [internal function]: Slim\\DeferredCallable->__invoke\r\n#18 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#19 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}\r\n#20 /var/www/api-next/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack\r\n#21 /var/www/api-next/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run\r\n#22 /var/www/api-next/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke\r\n#23 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke\r\n#24 /var/www/api-next/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#25 [internal function]: Slim\\DeferredCallable->__invoke\r\n#26 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#27 /var/www/api-next/vendor/wellingguzman/proxy-detection/src/ProxyDetectionMiddleware.php(30): Slim\\App->Slim\\{closure}\r\n#28 /var/www/api-next/src/core/Directus/Application/Http/Middleware/ProxyMiddleware.php(18): RKA\\Middleware\\ProxyDetectionMiddleware->__invoke\r\n#29 [internal function]: Directus\\Application\\Http\\Middleware\\ProxyMiddleware->__invoke\r\n#30 /var/www/api-next/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#31 [internal function]: Slim\\DeferredCallable->__invoke\r\n#32 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#33 /var/www/api-next/vendor/akrabat/rka-ip-address-middleware/src/IpAddress.php(93): Slim\\App->Slim\\{closure}\r\n#34 [internal function]: RKA\\Middleware\\IpAddress->__invoke\r\n#35 /var/www/api-next/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#36 [internal function]: Slim\\DeferredCallable->__invoke\r\n#37 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#38 /var/www/api-next/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}\r\n#39 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke\r\n#40 /var/www/api-next/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#41 [internal function]: Slim\\DeferredCallable->__invoke\r\n#42 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#43 /var/www/api-next/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(47): Slim\\App->Slim\\{closure}\r\n#44 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke\r\n#45 /var/www/api-next/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array\r\n#46 [internal function]: Slim\\DeferredCallable->__invoke\r\n#47 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func\r\n#48 /var/www/api-next/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}\r\n#49 /var/www/api-next/vendor/slim/slim/Slim/App.php(406): Slim\\App->callMiddlewareStack\r\n#50 /var/www/api-next/vendor/slim/slim/Slim/App.php(314): Slim\\App->process\r\n#51 /var/www/api-next/src/core/Directus/Application/Application.php(161): Slim\\App->run\r\n#52 /var/www/api-next/public/index.php(5): Directus\\Application\\Application->run [] []\r\n</pre>\r\n</details>\r\n"},{"labels":["bug",null],"text":"In version 2.0.14, I run into the issue that directus crashes after I login.\r\nI clean installed both api and app and when I login, I get these Errors: https://pastebin.com/K9NgFQ1v\r\n(I also clean installed the database)\r\n\r\nI also made me a script for SSH to update directus more easily:\r\n```bash\r\nrm -rf api &&\r\nrm -rf app &&\r\nwget -O api.zip https://github.com/directus/api/archive/build.zip &&\r\nwget -O app.zip https://github.com/directus/app/archive/build.zip &&\r\nunzip api.zip &&\r\nunzip app.zip &&\r\nmv api-build api &&\r\nmv app-build app &&\r\nrm -rf api.zip &&\r\nrm -rf app.zip &&\r\ncp ./configs/api.php ./api/config/ &&\r\ncp ./configs/config.js ./app/\r\n```\r\n\r\nIf I forgot something, please tell me."},{"labels":["bug",null],"text":"I use sendmail as mail transport, then send an mail for password reset requst :\r\n`http://example.com/_/auth/password/request.` , I didn't receive any mail.\r\n![image](https://user-images.githubusercontent.com/6927999/51071352-96094a80-168a-11e9-8bdf-9934a0e8527a.png)\r\nWhen I use `http://example.com/_/mail`  send an mail to someone. it  work.\r\n![image](https://user-images.githubusercontent.com/6927999/51071344-65291580-168a-11e9-842c-a9cc5258c0f7.png)\r\n\r\nsendmail config :\r\n```\r\n 'mail' => [\r\n      'default' => [\r\n           'transport' => 'sendmail',\r\n          'from' => 'xxx@X.xxx.com'\r\n       ],\r\n    ], \r\n```\r\nIs there anything wrong elsewhere?\r\nthanks\r\n\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. create collection with created_on, created_by fields\r\n2. make query with fields=created_on\r\n\r\n## Expected Behavior\r\n\r\nit should return all results, but only the created_on field\r\n\r\n## Actual Behavior\r\n\r\nit returns { error: { code: null, message: 'Internal Server Error' } } }\r\n\r\n## Other Context & Screenshots\r\n\r\n## Technical Details\r\n\r\nlatest docker api image (2.0.13)\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a M2O relationship between two objects.\r\n2. Create a O2M relationship from the other object.\r\n3. Delete both relationships.\r\n\r\n## Expected Behavior\r\n\r\nI think Directus should remove the relationships from the `directus_relations` SQL table upon deleting the relationship fields.\r\n\r\n## Actual Behavior\r\n\r\nDirectus is leaving the relationships in the `directus_relations` SQL table causing issues if I add other relationships with the same field name. For me, it resulted in an error viewing the collection with the O2M relationship. The more I played around with relationships, the more cluttered the relations table got.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10.0.17763 Build 17763\r\n- Web Server: Apache 2.4.37\r\n- PHP Version: 7.3.0\r\n- Database: MariaDB 10.1.37\r\n- Install Method: Cloned master branch: Directus 7.0.11.\r\n"},{"labels":["bug"],"text":"Nothing logged in error log unfortunately "},{"labels":["bug"],"text":"# Bug Report\r\n\r\nWhen you have a collection that uses a primary key that's called something else then `id`, uploading a file fails. This is due to the fact that the API tries to use the name of the primary key field of the collection in directus_files, which fails:\r\n\r\n```\r\n{\r\n    \"error\": {\r\n        \"code\": 9,\r\n        \"message\": \"Failed generating the SQL query.\",\r\n        \"query\": \"SELECT `directus_files`.`id` AS `id`, `directus_files`.`storage` AS `storage`, `directus_files`.`filename` AS `filename`, `directus_files`.`title` AS `title`, `directus_files`.`type` AS `type`, `directus_files`.`uploaded_by` AS `uploaded_by`, `directus_files`.`uploaded_on` AS `uploaded_on`, `directus_files`.`charset` AS `charset`, `directus_files`.`filesize` AS `filesize`, `directus_files`.`width` AS `width`, `directus_files`.`height` AS `height`, `directus_files`.`duration` AS `duration`, `directus_files`.`embed` AS `embed`, `directus_files`.`folder` AS `folder`, `directus_files`.`description` AS `description`, `directus_files`.`location` AS `location`, `directus_files`.`tags` AS `tags`, `directus_files`.`metadata` AS `metadata` FROM `directus_files` WHERE `q_nummer` = '' LIMIT 1\"\r\n    }\r\n}\r\n```\r\n\r\nThe `WHERE `q_nummer` = ''` is wrong. I think this is supposed to be `WHERE `id` = '1'`."},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Using a file field attempt to upload a file.\r\n\r\n## Expected Behavior\r\nFile should upload\r\n## Actual Behavior\r\nAn error is thrown `3776593926486334747-account_id=1.jpg can't be uploaded. Your server is not configured to handle uploads of this size.`\r\n## Other Context & Screenshots\r\nhttps://www.screencast.com/t/7KgazrbPNhk\r\nUsing the docker instance for version 7\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: [Desktop]\r\n- OS: [Windows 7]\r\n- Web Server: [Nginx]\r\n- PHP Version: [7.2.0]\r\n- Database: [MySQL 8.0.12]\r\n- Install Method: [Docker]\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. create a table with a relational table\r\n2. disable the read access for that relational table for a user\r\n3. make a query, filtering on the relational table\r\n4. filter gets applied, but result is not shown\r\n\r\n## Expected Behavior\r\n\r\nfilter should not be applied\r\n\r\n## Actual Behavior\r\n\r\nfilter is applied\r\n\r\n## Note\r\n\r\nThis is also a security issue, because even if the user cant see the result, the user still knows,\r\nthat his filter query did return results, so if the user uses a filter like\r\n\r\nfilter[reltable.name][eq]=foobar\r\n\r\nand the result is not empty, the user knows that the reltable.name IS foobar.\r\n\r\n## Technical Details\r\n\r\n- docker image 2.0.11\r\n"},{"labels":["bug"],"text":"Trying to delete comments will throw the following error:\r\n\r\n```json\r\n{\r\n    \"error\": {\r\n        \"code\": null,\r\n        \"message\": \"Maximum function nesting level of '256' reached, aborting!\",\r\n        \"class\": \"Error\",\r\n        \"file\": \"/Users/welling/src/api/src/core/Directus/Permissions/Acl.php\",\r\n        \"line\": 871\r\n    }\r\n}\r\n```"},{"labels":["bug"],"text":"On master branch (e32b10be2c2749f65f7) it is now impossible to successfully run `db:upgrade`.\r\n The error output looks like following:\r\n```\r\nFatal error: Uncaught PDOException: SQLSTATE[42000]: Syntax error or access violation: 1091 Can't DROP COLUMN `scope`; check that it exists in /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php on line 134\r\n\r\nPDOException: SQLSTATE[42000]: Syntax error or access violation: 1091 Can't DROP COLUMN `scope`; check that it exists in /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php on line 134\r\n\r\nCall Stack:\r\n    0.0098     389464   1. {main}() /Users/janbilek/Projects/directus7-api/bin/directus:0\r\n    0.2175    1632376   2. Directus\\Console\\Cli->run() /Users/janbilek/Projects/directus7-api/bin/directus:9\r\n    0.2175    1632376   3. Directus\\Console\\Cli->cmd() /Users/janbilek/Projects/directus7-api/src/core/Directus/Console/Cli.php:62\r\n    0.2176    1632440   4. Directus\\Console\\Modules\\DatabaseModule->runCommand(???, ???, ???) /Users/janbilek/Projects/directus7-api/src/core/Directus/Console/Cli.php:85\r\n    0.2176    1632480   5. Directus\\Console\\Modules\\DatabaseModule->cmdUpgrade(???, ???) /Users/janbilek/Projects/directus7-api/src/core/Directus/Console/Modules/ModuleBase.php:59\r\n    0.2202    1739952   6. Directus\\Util\\Installation\\InstallerUtils::updateTables(???, ???) /Users/janbilek/Projects/directus7-api/src/core/Directus/Console/Modules/DatabaseModule.php:54\r\n    0.2301    1917152   7. Directus\\Util\\Installation\\InstallerUtils::runMigrationAndSeeder(???) /Users/janbilek/Projects/directus7-api/src/core/Directus/Util/Installation/InstallerUtils.php:123\r\n    0.2438    2220728   8. Phinx\\Migration\\Manager->migrate(???, ???) /Users/janbilek/Projects/directus7-api/src/core/Directus/Util/Installation/InstallerUtils.php:136\r\n    0.4301    3004448   9. Phinx\\Migration\\Manager->executeMigration(???, ???, ???) /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Migration/Manager.php:351\r\n    0.4302    3004448  10. Phinx\\Migration\\Manager\\Environment->executeMigration(???, ???) /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Migration/Manager.php:375\r\n    0.4303    3004448  11. RemoveScope->up() /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Migration/Manager/Environment.php:127\r\n    0.4304    3004608  12. Phinx\\Db\\Table->removeColumn(???) /Users/janbilek/Projects/directus7-api/migrations/upgrades/schemas/20181123171520_remove_scope.php:11\r\n    0.4304    3004608  13. Phinx\\Db\\Adapter\\TimedOutputAdapter->dropColumn(???, ???) /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Db/Table.php:381\r\n    0.4304    3005304  14. Phinx\\Db\\Adapter\\TimedOutputAdapter->dropColumn(???, ???) /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/TimedOutputAdapter.php:222\r\n    0.4305    3005304  15. Phinx\\Db\\Adapter\\MysqlAdapter->dropColumn(???, ???) /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/AdapterWrapper.php:423\r\n    0.4305    3005624  16. Phinx\\Db\\Adapter\\MysqlAdapter->execute(???) /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/MysqlAdapter.php:470\r\n    0.4305    3005624  17. PDO->exec(???) /Users/janbilek/Projects/directus7-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php:134\r\n\r\n```"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n### Requiring a filename but not using the filename\r\n\r\n1. Uploading a embedded video using `/files` endpoint\r\n2. Set `data` to an youtube url\r\n3. Set `filename` to the name of the image\r\n4. See `filename` with the youtube id instead of the one the API made you set.\r\n\r\n### Expected Behavior\r\n\r\nThe `filename` I set in the payload and not the youtube ID, or maybe do not require to use `filename` ins this case?\r\n\r\n### Actual Behavior\r\n\r\nFilename is set to the youtube ID instead of the filename the API made you set.\r\n\r\n---\r\n\r\n### Default title for embedded files.\r\n\r\n0. Not having an `youtube_api_key` in settings.\r\n1. Uploading a embedded video using `/files` endpoint\r\n2. Set `data` to an youtube url\r\n3. Set `filename` to the name of the image\r\n4. See `title` saved as `Unable to retrieve YouTube title`.\r\n\r\n### Expected Behavior\r\n\r\nThe file `title` to be `null` instead.\r\n\r\n### Actual Behavior\r\n\r\nThe file `title` saved as `Unable to retrieve YouTube title`.\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a table with at least 2 m2o fields with 1 nullable m2o field\r\n2. Create an entry with \"null\" as a value for one of the m2o field\r\n3. Access API using either `field.*.*` or `*.*.*` in \"fields\" query param\r\n\r\n## Expected Behavior\r\nThe API should return all the fields for the not-null related field.\r\n\r\n## Actual Behavior\r\nThe API returns \"null\" for the null value, but only returns the m2o related ID for the non-null related field.\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: All\r\n- OS: All\r\n- Web Server: Apache (Docker)\r\n- PHP Version: PHP 7.2.0 (Docker)\r\n- Database: MySQL (Docker)\r\n- Install Method: docker-compose from single-api example\r\n"},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nuse these filters together:\r\nfilter[id][nin]=5,6,7,8,9,10\r\nfilter[id][between]=1,15\r\n\r\n## Expected Behavior\r\n\r\nresult list containing ids 1,2,3,4,11,12,13,14,15\r\n\r\n## Actual Behavior\r\n\r\nresult list contains all ids\r\n\r\n## Technical Details\r\n\r\nusing api docker image 2.0.11"},{"labels":["bug",null],"text":"Removing these lines makes it work again\r\n\r\nhttps://github.com/directus/api/blob/d542e8c58c36acf8e5e7858ddf8431b1af059601/src/helpers/all.php#L200-L203"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nThe uploading files and images feature in the Directus app is not working. \r\n## Steps to Reproduce\r\n1. Go to ' Admin/File Library'\r\n2. Click on 'Add sign on top corner'\r\n3. Upload an Image or a file\r\n4. See error \"Trouble processing request. Try again after refreshing the page.\" \r\n\r\n## Expected Behavior\r\nTo be able to upload an image\r\n## Actual Behavior\r\nError, unable to upload any file or image\r\n## Other Context & Screenshots\r\nThe progress bar completes and just as it reaches 100% this error shows up. I am unable to upload any files or images to my back-end. \r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: [ Laptop]\r\n- OS: [Windows 10]\r\n- Browser: [Chrome  70.0.3538.110]\r\n- Directus App: [eg: 7.0.9]\r\n"},{"labels":["bug",null],"text":"Running `bin/directus install:config -n directus -u root -p` creates the password as `true` in the configuration file.\r\n\r\nIf someone wants to pick this up I want to point a reference where this value is set: https://github.com/directus/api/blob/master/src/core/Directus/Console/Modules/InstallModule.php#L79"},{"labels":["bug",null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Go to 'http://localhost:8081/login' and  choose sign in into `second` API Endpoint\r\n2. Click on login\r\n3. See error \"Server Error  Something is wrong with this instance‚Äôs server or database.\"\r\n\r\n\r\n\r\n## Expected Behavior\r\nNo error\r\n## Actual Behavior\r\nThe app doesn't work with other endpoint/project then `_` default\r\n\r\n## Other Context & Screenshots\r\n![directus_screenshot](https://user-images.githubusercontent.com/4331326/49225574-b33ccf00-f3e4-11e8-9b21-b8f9e9778246.png)\r\n\r\n\r\nIt looks like for some api routes the `app` uses the default project slug `_`\r\nPlease see screnshot which shows network connections and routes which are trying to connect to the default api endpoint without project name.\r\nhttp://localhost:8080\r\nhttp//localhost:8080/pages\r\nhttp//localhost:8080/layouts\r\nhttp//localhost:8080/interfaces\r\n\r\nOn the other hand here are some routes which include project name correcty:\r\nhttp://localhost:8080/second/settings/fields\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop \r\n- OS: MacOS 10.14.1\r\n- Browser: Chrome Version 71.0.3578.75 (Official Build) beta (64-bit)\r\n- Directus App: master\r\n- Directus API: master\r\n- Install Method: cloned master\r\n"},{"labels":["bug",null,null],"text":"# Bug Report\r\nI'm currently migrating my D6 data to a fresh D7 installation on MAMP. After connecting and setting up all the fields in D7 I run into a few issues with `something_id` columns (these are either for relational or  pure data puposes). More details below. I didn't migrate any directus tables but the files table.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Fresh local development D7 installation according to docs\r\n2. Migrating non-directus D6 tables w/o changes (& directus files table with changes according to docs)\r\n3. Set up field types and relations in D7 app\r\n4. Encounter the following oddities\r\n\r\n## 1. Error on an M2M junction table:\r\n\r\nD6 structure:\r\n```\r\nid\r\npost_id\r\ncat_id\r\n```\r\nI set up the M2M in D7 the same way I did in D6. But existing relations didn‚Äôt show up in the app. I could select an existing `category` in the `post` view but couldn‚Äôt save. The patch API call returned a 500.\r\n\r\nAPI error:\r\n`[2018-12-04 09:20:17] api[_].ERROR: Directus\\Database\\Exception\\InvalidQueryException: Failed generating the SQL query. in /Users/seb/Code/directusapi/src/core/Directus/Database/TableGateway/BaseTableGateway.php:862`\r\n\r\nAfter renaming the junction table columns in phpmyadmin to the following (and resetting the fields and relation) everything worked as expected (existing relation show up in `post` an the patch goes through):\r\n\r\n```\r\nid\r\npost\r\ncategory\r\n```\r\n\r\nI encountered the same behaviour for another M2M table.\r\n\r\n## 2. Text Input Field\r\n<img width=\"1021\" alt=\"bildschirmfoto 2018-12-04 um 12 43 58\" src=\"https://user-images.githubusercontent.com/6689405/49584658-aa0fad00-f964-11e8-9bb0-067f40f5ced8.png\">\r\nOriginal field name `tour_id`: values are not showing in the app (list and detail)\r\nCloned the column data into `tourid`: everything working as expected\r\n\r\nWhen I now try to reverse engineer it:\r\n1. delete `tour_id`\r\n2. rename `tourid`-> `tour_id`\r\n3. set up new field `tour_id`\r\n\r\nThe former working field `tourid` is again empty in list and detail. After reversing steps 1-3, content shows up again.\r\n\r\nIf I have both fields it requires `tour_id`to be populated when saving a new item - even though the field is not set to required‚Ä¶. maybe there is some confusion with the `id` primary key field?!?\r\n\r\n## Other Context & Screenshots\r\nThese fields are set up identical and have identical data in the DB. One is showing the data the other one not:\r\n\r\n<img width=\"355\" alt=\"bildschirmfoto 2018-12-04 um 12 44 05\" src=\"https://user-images.githubusercontent.com/6689405/49584680-b7c53280-f964-11e8-893c-c4df79c11517.png\">\r\n<img width=\"407\" alt=\"bildschirmfoto 2018-12-04 um 12 45 08\" src=\"https://user-images.githubusercontent.com/6689405/49584684-bb58b980-f964-11e8-918d-3bff2bd39e80.png\">\r\n<img width=\"1190\" alt=\"bildschirmfoto 2018-12-04 um 12 48 30\" src=\"https://user-images.githubusercontent.com/6689405/49584702-c4498b00-f964-11e8-92f7-4b732b57c58d.png\">\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop / MAMP\r\n- OS: MacOS\r\n- Web Server: Apache\r\n- PHP Version: 7.2.8\r\n- Database: MySQL\r\n- Install Method: dev environment for app and api\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. create a collection with many to many and many to one relationships\r\n2. try to add a new item\r\n\r\n## Expected Behavior\r\n\r\nitem should be created\r\n\r\n## Actual Behavior\r\n\r\nerror:\r\n`{\"error\":{\"code\":9,\"message\":\"Failed generating the SQL query.\",\"query\":\"INSERT INTO `users` (`name`, `email`, `role`, `user_id`, `locations`) VALUES ('test', 'test@test.test', 'test', '2', NULL)\"}}`\r\n\r\nwere locations is the many-to-many relationship\r\nand user_id is the many-to-one relationship\r\n\r\nwhere locations is the many\r\n\r\n## Other Context & Screenshots\r\n\r\nthis error does NOT occure in the docker image version 2.0.8\r\nthis error does occure in the docker image version 2.0.9 and 2.0.10\r\n\r\n## Technical Details\r\n\r\nused the docker image with mysql database\r\n"},{"labels":["bug"],"text":"When `collection_presets` update permission is set to `mine`, which is by default. Regular user is unable to send PATCH request to update his record. This way it's impossible for them to customise their collection view unless the update permissions is manually set to `all`. \r\n\r\n![screenshot 2018-12-04 at 11 07 51](https://user-images.githubusercontent.com/7890555/49434664-f9af7680-f7b4-11e8-855c-ccf3c6be740d.png)\r\n\r\n![screenshot 2018-12-04 at 11 11 14](https://user-images.githubusercontent.com/7890555/49434908-9d992200-f7b5-11e8-9118-af55fe589bd4.png)\r\n![screenshot 2018-12-04 at 11 12 49](https://user-images.githubusercontent.com/7890555/49434909-9d992200-f7b5-11e8-9263-fa766ebd7ac5.png)\r\n![screenshot 2018-12-04 at 11 13 02](https://user-images.githubusercontent.com/7890555/49434910-9d992200-f7b5-11e8-944b-64a1009c0428.png)\r\n\r\nHere, you can see that the record with id 10 exists and is assigned to user with id 2, who is the currently logged in user.\r\n![screenshot 2018-12-04 at 11 18 39](https://user-images.githubusercontent.com/7890555/49435309-9888a280-f7b6-11e8-932e-39468f173540.png)\r\n\r\n\r\n### System\r\n- API: [2.0.10]\r\n- Web Server: [Nginx 1.14.1]\r\n- PHP Version: [eg: 7.0.32]\r\n- Database: [eg: MySQL 5.7.24]\r\n"},{"labels":["bug"],"text":"Hi,\r\n\r\nI was trying to upload logo in Global Settings in Directus 7.0.8 version and it gives error stating \"Attempting to write an array as the value for field \"value\" in \"directus_settings\"\" \r\n\r\nOn checking error log file, I found [2018-11-20 12:23:45] api[_].ERROR: Directus\\Database\\Exception\\SuppliedArrayAsColumnValue: Attempting to write an array as the value for field \"value\" in \"directus_settings\" in {path}/{To}/{directus708}/src/core/Directus/Database/TableGateway/BaseTableGateway.php:1737\r\n\r\nAlso while updating color from the global settings, it gives \"scope: This value should not be blank.\" error.\r\n\r\n[2018-11-20 12:26:16] api[_].ERROR: Directus\\Validator\\Exception\\InvalidRequestException: value: This value should not be blank. in {path}/{To}/{directus708}/src/core/Directus/Services/AbstractService.php:188\r\n\r\nWhat is causing this ?"},{"labels":["bug"],"text":"This should return a 400 Bad Request, not a 500 Internal Server Error\r\n\r\n`2018-11-30 16:03:44] api[projects].ERROR: Directus\\Exception\\Exception: Cannot connect to the database in /var/www/html/directus/src/core/Directus/Util/Installation/InstallerUtils.php:153`"},{"labels":["bug"],"text":"## Version Info\r\n  - Directus API version (Or commit hash): latest release\r\n  - PHP version: 7.1\r\n  - MySQL version: working fine ;)\r\n  - Web server: Apache\r\n  - OS name and version: CentOS 7 (w/DirectAdmin)\r\n\r\n## Expected Behavior\r\n\r\nTrying to login to api from remote directus app (located on same server, but other subdomain for testing purposes). \r\n\r\n## Actual Behavior\r\n\r\nIn Chrome dev console on Directus App login screen I'm getting;\r\n\r\n1. The /server/ping request does work\r\n2. XHR response: CORS error OPTIONS 405 method not allowed when App tries to connect to http://domain.com/_/auth/sso\r\nThe response from the API doesn't show any Acces-Control headers in the dev console\r\n\r\n3. I've tried to set the headers manually in a .htaccess file in, but then also the /server/ping\r\n request breaks, stating Access-Control-Allowed-Origin is already set.\r\n\r\n4. I've also configured the api.php in /config to include the headers, but _/auth/sso don't seem to care for a bit :)\r\n\r\n![cors_directus](https://user-images.githubusercontent.com/45427613/49158662-fdf61280-f322-11e8-89ae-aed65376760a.PNG)\r\n\r\nCould you guys point me in the right direction?\r\nThanx"},{"labels":["bug"],"text":"Newly installed APIs should use `production` by default"},{"labels":["bug"],"text":"# Bug Report\r\nI got the following error when I deploy directus on Google AppEngine Standard Env :\r\n`23/Nov/2018:15:11:44 +0000 [ERROR 0 /index.php] PHP message: PHP Fatal error: Uncaught Error: Call to undefined function Directus\\get_api_project_from_request() in /srv/src/web.php:16 Stack trace: #0 /srv/public/index.php(3): require() #1 {main} thrown in /srv/src/web.php on line 16`\r\n\r\n## Steps to Reproduce\r\n\r\n1- I created an app.yaml file as follow :\r\n`service: test-directus\r\nruntime: php72\r\n\r\nhandlers:\r\n- url: .*\r\n  script: auto`\r\n\r\n2- I created an composer.json file as follow:\r\n'\"autoload\": {\r\n        \"psr-4\": { \"\": \"vendor/\" }\r\n    }\r\n}'\r\n\r\n3- I deploy my app on AppEngine:\r\n'gcloud app deploy --project MY_PROJECT'\r\n\r\n4- I go to the webpage and got the error above in my console (gcloud)\r\n\r\n## Expected Behavior\r\nindex page to display\r\n\r\n## Actual Behavior\r\nHTTP ERROR 500\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: ?\r\n- Browser: Chrome\r\n- Directus App: 7.0.0\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug",null],"text":"I installed\r\n```\r\n git log | head\r\ncommit 61981cb3c8cc64bfe2355117860591f0c7c995e1\r\nAuthor: rijkvanzanten <rijkvanzanten@me.com>\r\nDate:   Fri Nov 16 23:21:00 2018 -0500\r\n\r\n    v2.0.8\r\n\r\ncommit 9a87c4953e47c6ebd664e96dec325b4365dab647\r\nAuthor: rijkvanzanten <rijkvanzanten@me.com>\r\nDate:   Wed Nov 14 10:23:24 2018 -0500\r\n```\r\nFor admin user I set a static token\r\n```\r\nmysql -e\"\r\n  USE directus_test\r\n  SELECT token\r\n  FROM directus_users\r\n  WHERE email = 'admin@example.com'\r\n  ;\r\n \"\r\n\r\n+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n\t| token                                                                                                                                                                                                            |\r\n\t+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n\t| 7d353106bc1db9408dba94c85ac6e26184f3fc3cb2f3d29b6713db47b4a6a99ababdc6fdfca0e57bd99f3cf502a9b8e5f4efe48352d82b5ec0fd67b05a8a9a08edb7ca2f9e752723ebba6a4b479fda93d67cfe09c0410ce232a5f3da0ec58ba5b023dcea62e49914 |\r\n\t+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n```\t\r\n\r\nsecure API access WITH the static token works\r\n```\r\nMY_STATIC_TOKEN=\"7d353106bc1db9408dba94c85ac6e26184f3fc3cb2f3d29b6713db47b4a6a99ababdc6fdfca0e57bd99f3cf502a9b8e5f4efe48352d82b5ec0fd67b05a8a9a08edb7ca2f9e752723ebba6a4b479fda93d67cfe09c0410ce232a5f3da0ec58ba5b023dcea62e49914\"\r\ncurl \\\r\n -H 'content-type: application/json' \\\r\n -H \"Authorization: Bearer $MY_STATIC_TOKEN\" \\\r\n -X GET $URL/roles | jq .\r\n\t{\r\n\t  \"data\": [\r\n\t    {\r\n\t      \"id\": 1,\r\n\t      \"name\": \"Administrator\",\r\n\t      \"description\": \"Admins have access to all managed data within the system by default\",\r\n\t      \"ip_whitelist\": null,\r\n\t      \"nav_blacklist\": null,\r\n\t      \"external_id\": null\r\n\t    },\r\n\t    {\r\n\t      \"id\": 2,\r\n\t      \"name\": \"Public\",\r\n\t      \"description\": \"This sets the data that is publicly available through the API without a token\",\r\n\t      \"ip_whitelist\": null,\r\n\t      \"nav_blacklist\": null,\r\n\t      \"external_id\": null\r\n\t    }\r\n\t  ]\r\n\t}\r\n```\r\n\r\nbut INsecure access with an INCORRECT token ALSO works\r\n```\r\ncurl \\\r\n -H 'content-type: application/json' \\\r\n -H \"Authorization: Bearer invalidjunk\" \\\r\n -X GET $URL/roles | jq .\r\n\t{\r\n\t  \"data\": [\r\n\t    {\r\n\t      \"id\": 1,\r\n\t      \"name\": \"Administrator\",\r\n\t      \"description\": \"Admins have access to all managed data within the system by default\",\r\n\t      \"ip_whitelist\": null,\r\n\t      \"nav_blacklist\": null,\r\n\t      \"external_id\": null\r\n\t    },\r\n\t    {\r\n\t      \"id\": 2,\r\n\t      \"name\": \"Public\",\r\n\t      \"description\": \"This sets the data that is publicly available through the API without a token\",\r\n\t      \"ip_whitelist\": null,\r\n\t      \"nav_blacklist\": null,\r\n\t      \"external_id\": null\r\n\t    }\r\n\t  ]\r\n\t}\r\n```\r\n\r\n"},{"labels":["bug",null],"text":"When requesting a password reset, the link directs to localhost and not to the api url.\r\nI guess the image is also not showing because of that.\r\n\r\n![grafik](https://user-images.githubusercontent.com/22577866/48676858-e2de1280-eb6c-11e8-9c83-10dedebe22e8.png)\r\n\r\nDirectus 2.0.8"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues (YOU ARE HERE)\r\n    API:  https://github.com/directus/api/issues\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nWhen uploading images (or files) via the admin interface the images don't load and the broken image icon appears. I checked the url being requested and the port is wrong. Here is an example:\r\n\r\nhttps://maakom.nfshost.com:80/directus/public/uploads/_/originals/(Solaris).jpg\r\n\r\nport (80) with https does not work. When 80 is removed the image is loaded correctly.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Upload an image to a collection that has a file type.\r\n2. See broken image icon.\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10.1803\r\n- Browser: Chrome 70.0.3538\r\n- Directus suite: 7.0.7\r\n- Install Method: cloned `master` branch\r\n"},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. create a collection with a date field end_date\r\n2. insert some items, where some have end_date = null, and others have end_date = a valid date\r\n3. use the api to filter the items and use the following filters:\r\nfilter[end_date][empty]&\r\nfilter[end_date][logical]=or&\r\nfilter[end_date][gte]=2015-01-01\r\n\r\n## Expected Behavior\r\nthe result should contain the correct dates:\r\nthe ones gte 2015-01-01 and the ones which do not have a date\r\n\r\n## Actual Behavior\r\nthe result does not contain the correct dates:\r\nthe items with date == null are not returned from the api\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: arch linux - directus in docker\r\n- Web Server: the one in directus 7 api docker image\r\n- PHP Version: the one in directus 7 api docker image\r\n- Database: MySQL\r\n- Install Method: docker-compose with mysql database\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\ni'm still struggling with translations.\r\n\r\nAlthough I've folowed the docs https://docs.directus.io/app/admin/relationships.html#translations I end u with and error inserting a new `Article`\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create languages entity\r\n2. Populate languages\r\n3. Create articles\r\n4. Create articles_translations\r\n5. Create extra relational field `article` and `language`\r\n6. Create Translations relations\r\n7. Open articles collection\r\n\r\n## Expected Behavior\r\n\r\n\r\n\r\n## Actual Behavior\r\n\r\n```\r\n[2018-11-16 12:02:43] api[_].ERROR: Error: Call to a member function getCollectionMany() on null in /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php:1659\r\nStack trace:\r\n#0 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1133): Directus\\Database\\TableGateway\\RelationalTableGateway->loadOneToManyRelationships(Array, Array, Array)\r\n#1 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1058): Directus\\Database\\TableGateway\\RelationalTableGateway->loadRelationalData(Array, Array, Array)\r\n#2 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(1116): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchItems(Array)\r\n#3 /var/www/html/src/core/Directus/Database/TableGateway/RelationalTableGateway.php(810): Directus\\Database\\TableGateway\\RelationalTableGateway->fetchData(Array)\r\n#4 [internal function]: Directus\\Database\\TableGateway\\RelationalTableGateway->getItems(Array, NULL)\r\n#5 /var/www/html/src/core/Directus/Services/AbstractService.php(324): call_user_func_array(Array, Array)\r\n```\r\n## Other Context & Screenshots\r\n\r\n```sql\r\nMariaDB [directus]> select * from directus_relations where collection_many like 'article%';\r\n+----+----------------------+------------+----------------+--------------+----------------+\r\n| id | collection_many      | field_many | collection_one | field_one    | junction_field |\r\n+----+----------------------+------------+----------------+--------------+----------------+\r\n| 15 | article_translations | id         | articles       | translations | NULL           |\r\n| 16 | article_translations | article    | articles       | NULL         | NULL           |\r\n| 17 | article_translations | language   | languages      | NULL         | NULL           |\r\n+----+----------------------+------------+----------------+--------------+----------------+\r\n3 rows in set (0.01 sec)\r\n\r\n\r\nMariaDB [directus]> show create table articles;\r\n+----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| Table    | Create Table                                                                                                                                                                 |\r\n+----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| articles | CREATE TABLE `articles` (\r\n  `id` int(15) unsigned NOT NULL AUTO_INCREMENT,\r\n  `author` varchar(200) DEFAULT NULL,\r\n  PRIMARY KEY (`id`)\r\n) ENGINE=InnoDB DEFAULT CHARSET=latin1 |\r\n+----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n\r\nMariaDB [directus]> show create table article_translations;\r\n+----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| Table                | Create Table                                                                                                                                                                                                                                                                                                                          |\r\n+----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| article_translations | CREATE TABLE `article_translations` (\r\n  `id` int(15) unsigned NOT NULL AUTO_INCREMENT,\r\n  `title` varchar(200) DEFAULT NULL,\r\n  `body` varchar(10000) DEFAULT NULL,\r\n  `article` int(10) unsigned DEFAULT NULL,\r\n  `language` int(10) unsigned DEFAULT NULL,\r\n  PRIMARY KEY (`id`)\r\n) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 |\r\n+----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n## Technical Details\r\n\r\n- Device: desktop\r\n- OS: ubuntu/docker\r\n- Web Server: nginx\r\n- PHP Version: as your docker image (see below)\r\n- Database: mariadb:10.2\r\n- Install Method: docker\r\n```\r\ndirectus/api                                   latest                 91e58d465a2f        2 days ago          96.5MB\r\ndirectus/app                                   latest                 3668fe544936        2 days ago          27.2MB\r\n```\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nconfigure google as oauth2 provider and login\r\n\r\n## Expected Behavior\r\nworking login\r\n\r\n## Actual Behavior\r\nwhen the auth code is received on the api (```/auth/sso/google/callback```) it throws an internal server error with the following log statement\r\n```Error: Call to undefined method League\\OAuth2\\Client\\Provider\\Exception\\IdentityProviderException::getErrorCode() in /var/www/html/src/endpoints/Auth.php:233```\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: *\r\n- OS: Linux\r\n- Database: mariadb 10.3.10\r\n- Install Method: docker run ... directus/api:2.0.7\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nThere are two ways to get a 500 error that should be returning `4XX Errors`\r\n\r\n### 1. How to get a bad 500 error\r\n1. Create or make a user as `Draft` through the GUI\r\n2. Create a post request with a body `{\"email\":\"x@x.x\",\"password\":\"xxx\"}` *(X = User info)*\r\n3. Authenticate at endpoint `/auth/authenticate` with the post information above\r\n4. Receive a 500 error\r\n\r\n### 2. How to get a bad 500 error \r\n1. Create or make a user as `Active` through the GUI\r\n2. Create a post request with a body `{\"email\":\"x@x.x\",\"password\":\"yyy\"}` *(X = User info, Y=Invalid info)*\r\n3. Authenticate at endpoint `/auth/authenticate` with the post information above\r\n4. Receive a 500 error\r\n\r\n## Expected Behavior\r\nReceive a `4XX Error` with a useful message about the reason for failing\r\n\r\n## Actual Behavior\r\nReceive a `500 Error`\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: Windows 10\r\n- Web Server: Apache\r\n- PHP Version: 7.1\r\n- Database: MySQL 5.7\r\n- Install Method: Cloned Direcus 7.5\r\n"},{"labels":["bug",null],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Install the API via GIT (git clone -b build https://github.com/directus/api.git)\r\n2. Create config/api.php and enter database credentials\r\n3. Create a Directus app installation and configure to use above API\r\n4. Create a test collection i.e. blog_posts\r\n5. Create an item in blog_posts\r\n6. Call GET https://www.example.com/_/items/blog_posts/1 to fetch the record\r\n\r\nAPI is installed in /var/www/api and apache config file points to /var/www/api/public\r\nAPP is installed in /var/www/app and apache config file points to /var/www/app\r\n\r\nThe App installation works as expected and can interact with API.\r\nDirect API access fails via Postman or curl request via custom web app\r\n\r\n## Expected Behavior\r\nSuccessful API response with blog_posts record with id 1\r\n\r\n## Actual Behavior\r\nFatal error in PHP\r\n\r\nWarning: include(/var/www/api/vendor/composer/../monolog/monolog/src/Monolog/ResettableInterface.php): failed to open stream: No such file or directory in /var/www/api/vendor/composer/ClassLoader.php on line 444\r\n\r\nWarning: include(): Failed opening '/var/www/api/vendor/composer/../monolog/monolog/src/Monolog/ResettableInterface.php' for inclusion (include_path='.:/usr/share/php') in /var/www/api/vendor/composer/ClassLoader.php on line 444\r\n\r\nFatal error: Interface 'Monolog\\ResettableInterface' not found in /var/www/api/vendor/monolog/monolog/src/Monolog/Logger.php on line 28\r\n\r\n## Other Context & Screenshots\r\napi/vendor/monolog/monolog/src/Monolog/ResettableInterface.php is not present, hence the Fatal Error.\r\n\r\nIf I remove any reference of ResettableInterface from monolog the API calls become successful\r\n\r\n(bold text deleted)\r\nmonolog/monolog/src/Monolog/Handler/AbstractHandler.php\r\nabstract class AbstractHandler implements HandlerInterface**, ResettableInterface**\r\n\r\nmonolog/monolog/src/Monolog/Logger.php\r\nclass Logger implements LoggerInterface**, ResettableInterface**\r\n\r\n## Technical Details\r\n\r\n- Device: n/a\r\n- OS: Ubuntu 16.04\r\n- Web Server: Apache 2.4.37\r\n- PHP Version: 7.2\r\n- Database: MySQL 5.7\r\n- Install Method: cloned `build` branch\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection named `test`\r\n2. Add a unique field named `code`\r\n3. execute in mysql `SHOW CREATE TABLE test ` on the collection you created, there is a single `UNIQUE KEY` index on the field \r\n3. Update any attribute of the field\r\n4. repeat `SHOW CREATE TABLE test` on the updated collection, now there are two `UNIQUE KEY` indexes\r\n\r\n## Expected Behavior\r\n\r\nA single `UNIQUE KEY` index per unique field\r\n\r\n## Actual Behavior\r\n\r\nAs many `UNIQUE KEY` indexes as many updates you execute\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: desktop\r\n- OS: ubuntu 18.04\r\n- Web Server: docker image 2.0.5\r\n- PHP Version: docker image 2.0.5\r\n- Database: docker image 2.0.5\r\n- Install Method:  docker image 2.0.5\r\n"},{"labels":["bug"],"text":"The `all` and `has` filter is generating a bad query."},{"labels":["bug"],"text":"I have no info at the moment, but I just experienced this. I will add more details later."},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. go to admin section -> collections & fields -> select a collection\r\n2. choose \"supervised_user_circle \" as icon. \r\n3. click on save\r\n4. See error\r\n\"Failed generating the SQL query.\"\r\nquery: \"UPDATE `directus_collections` SET `icon` = 'supervised_user_circle', `collection` = 'COLLECTION_NAME' WHERE `collection` = 'COLLECTION_NAME'\"\r\n\r\n## Other Context & Screenshots\r\nColumn is varchar(20) but apparently there are some icon names exceeding this columns max length.\r\n\r\n## Technical Details"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nBuild the `npm` dependencies of  the extensions on Windows OS using `npm run build` after `npm install`.\r\n\r\n## Expected Behavior\r\n\r\nThe extensions are built without any error.\r\n\r\n## Actual Behavior\r\n\r\nThe build stops due to the use of *nix specific shell commands.\r\n\r\n## Other Context & Screenshots\r\n\r\n![image](https://user-images.githubusercontent.com/5992716/47969670-19ae2600-e0a1-11e8-8a18-8a080095a57f.png)\r\n\r\n## Technical Details\r\n\r\n- API: Directus API 2.0.5\r\n- OS: Windows 10 Home x64 ver 1803\r\n- Web Server: Apache 2.4.33\r\n- PHP Version: PHP 7.2.6\r\n- Node.js Version: 10.13.0 (x64)\r\n- Install Method: cloned `master` branch\r\n\r\n## Log File\r\n\r\n```\r\n0 info it worked if it ends with ok\r\n1 verbose cli [ 'D:\\\\Program Files\\\\nodejs\\\\node.exe',\r\n1 verbose cli   'D:\\\\Program Files\\\\nodejs\\\\node_modules\\\\npm\\\\bin\\\\npm-cli.js',\r\n1 verbose cli   'run',\r\n1 verbose cli   'clear' ]\r\n2 info using npm@6.4.1\r\n3 info using node@v10.13.0\r\n4 verbose run-script [ 'preclear', 'clear', 'postclear' ]\r\n5 info lifecycle @directus/extensions-builder@1.0.0~preclear: @directus/extensions-builder@1.0.0\r\n6 info lifecycle @directus/extensions-builder@1.0.0~clear: @directus/extensions-builder@1.0.0\r\n7 verbose lifecycle @directus/extensions-builder@1.0.0~clear: unsafe-perm in lifecycle true\r\n8 verbose lifecycle @directus/extensions-builder@1.0.0~clear: PATH: D:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\npm-lifecycle\\node-gyp-bin;D:\\xampp\\htdocs\\api\\extensions\\node_modules\\.bin;D:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\npm-lifecycle\\node-gyp-bin;D:\\xampp\\htdocs\\api\\extensions\\node_modules\\.bin;C:\\Users\\user\\AppData\\Roaming\\npm;D:\\Program Files\\nodejs\\;C:\\Python27\\;C:\\Python27\\Scripts;C:\\ProgramData\\Boxstarter;D:\\Program Files\\ImageMagick-7.0.8-Q16;C:\\Program Files (x86)\\Intel\\iCLS Client\\;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\redist\\intel64\\compiler;C:\\Program Files\\Intel\\iCLS Client\\;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files\\Intel\\WiFi\\bin\\;C:\\Program Files\\Common Files\\Intel\\WirelessCommon\\;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;D:\\Program Files\\Git\\cmd;D:\\Program Files\\PuTTY\\;C:\\WINDOWS\\System32\\OpenSSH\\;D:\\Program Files\\Microsoft VS Code\\bin;C:\\Program Files (x86)\\Intel\\Intel(R) Management Engine Components\\DAL;C:\\Program Files\\Intel\\Intel(R) Management Engine Components\\DAL;C:\\Program Files (x86)\\Intel\\Intel(R) Management Engine Components\\IPT;C:\\Program Files\\Intel\\Intel(R) Management Engine Components\\IPT;D:\\xampp\\php;C:\\ProgramData\\ComposerSetup\\bin;D:\\Program Files (x86)\\AOMEI Backupper;D:\\Program Files\\nodejs\\;C:\\ProgramData\\chocolatey\\bin;D:\\Users\\user\\AppData\\Local\\Programs\\Python\\Python36-32\\Scripts\\;D:\\Users\\user\\AppData\\Local\\Programs\\Python\\Python36-32\\;C:\\Users\\user\\AppData\\Local\\Microsoft\\WindowsApps;D:\\Program Files\\Microsoft VS Code\\bin;C:\\Users\\user\\AppData\\Local\\GitHubDesktop\\bin;C:\\Users\\user\\AppData\\Local\\Microsoft\\WindowsApps;D:\\Program Files (x86)\\Nmap;C:\\Users\\user\\AppData\\Roaming\\Composer\\vendor\\bin;C:\\Users\\user\\AppData\\Roaming\\npm\r\n9 verbose lifecycle @directus/extensions-builder@1.0.0~clear: CWD: D:\\xampp\\htdocs\\api\\extensions\r\n10 silly lifecycle @directus/extensions-builder@1.0.0~clear: Args: [ '/d /s /c',\r\n10 silly lifecycle   'rm -rf ../public/extensions/core/{interfaces,layouts,pages}' ]\r\n11 silly lifecycle @directus/extensions-builder@1.0.0~clear: Returned: code: 1  signal: null\r\n12 info lifecycle @directus/extensions-builder@1.0.0~clear: Failed to exec clear script\r\n13 verbose stack Error: @directus/extensions-builder@1.0.0 clear: `rm -rf ../public/extensions/core/{interfaces,layouts,pages}`\r\n13 verbose stack Exit status 1\r\n13 verbose stack     at EventEmitter.<anonymous> (D:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\npm-lifecycle\\index.js:301:16)\r\n13 verbose stack     at EventEmitter.emit (events.js:182:13)\r\n13 verbose stack     at ChildProcess.<anonymous> (D:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\npm-lifecycle\\lib\\spawn.js:55:14)\r\n13 verbose stack     at ChildProcess.emit (events.js:182:13)\r\n13 verbose stack     at maybeClose (internal/child_process.js:962:16)\r\n13 verbose stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:251:5)\r\n14 verbose pkgid @directus/extensions-builder@1.0.0\r\n15 verbose cwd D:\\xampp\\htdocs\\api\\extensions\r\n16 verbose Windows_NT 10.0.17134\r\n17 verbose argv \"D:\\\\Program Files\\\\nodejs\\\\node.exe\" \"D:\\\\Program Files\\\\nodejs\\\\node_modules\\\\npm\\\\bin\\\\npm-cli.js\" \"run\" \"clear\"\r\n18 verbose node v10.13.0\r\n19 verbose npm  v6.4.1\r\n20 error code ELIFECYCLE\r\n21 error errno 1\r\n22 error @directus/extensions-builder@1.0.0 clear: `rm -rf ../public/extensions/core/{interfaces,layouts,pages}`\r\n22 error Exit status 1\r\n23 error Failed at the @directus/extensions-builder@1.0.0 clear script.\r\n23 error This is probably not a problem with npm. There is likely additional logging output above.\r\n24 verbose exit [ 1, true ]\r\n```"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\nMissing table at first access to api installed using docker\r\n\r\n```docker-compose.yml\r\nversion: '3'\r\nservices:\r\n  directus-api:\r\n    image: directus/api\r\n    ports:\r\n    - \"8083:80\"\r\n    links:\r\n    - directus-db:mysql\r\n    environment:\r\n      - DATABASE_HOST=mysql\r\n      - DATABASE_USERNAME=directus\r\n      - DATABASE_PASSWORD=directus\r\n  directus-db:\r\n    image: mariadb:10.2\r\n    environment:\r\n      - MYSQL_ROOT_PASSWORD=root\r\n      - MYSQL_DATABASE=directus\r\n      - MYSQL_USER=directus\r\n      - MYSQL_PASSWORD=directus\r\n```\r\n\r\n## Steps to Reproduce\r\n\r\n1. launch containers `docker-compose up -d`\r\n2. access service `curl http://localhost:8083`\r\n\r\n## Expected Behavior\r\nStill discovering\r\n\r\n## Actual Behavior\r\nThe error `{\"error\":{\"code\":null,\"message\":\"Statement could not be executed (42S02 - 1146 - Table 'directus.directus_roles' doesn't exist)\"}}` is shown \r\n\r\n## Other Context & Screenshots\r\n\r\nInstalled tables;\r\n![image](https://user-images.githubusercontent.com/1025560/47968047-bd2d1580-e064-11e8-8edf-7eeafb52bcae.png)\r\n\r\nUsers:\r\n```\r\nMariaDB [directus]> select * from directus_users;\r\n+----+--------+------------+-----------+-----------------+--------------------------------------------------------------+------------------+----------------------------------+------------------------------------------+-------------+------------------+----------+----------------+---------------------+---------------------+---------------------------------------------------------------+--------------+-------+----------------------------------------------------------------------------------+----------------+----------+-------+---------+------+-------+---------+------+----------+------------------+--------------+-------------+---------------+-----------------+\r\n| id | status | first_name | last_name | email           | password                                                     | salt             | token                       | access_token                             | reset_token | reset_expiration | position | email_messages | last_login          |last_access         | last_page                                                     | ip           | group | avatar                                       | avatar_file_id | location | phone | address | city | state | country | zip  | language | timezone         | invite_token | invite_date | invite_sender | invite_accepted |\r\n+----+--------+------------+-----------+-----------------+--------------------------------------------------------------+------------------+----------------------------------+------------------------------------------+-------------+------------------+----------+----------------+---------------------+---------------------+---------------------------------------------------------------+--------------+-------+----------------------------------------------------------------------------------+----------------+----------+-------+---------+------+-------+---------+------+----------+------------------+--------------+-------------+---------------+-----------------+\r\n|  1 |      1 | Admin      | User      | admin@admin.com | $2y$12$UhoRXS9j6vtI.bK8Spf8YuOhlo1ka6BRldLPyfhjSk0W1iz92L2HS | 86GZl0euHhHA2VuL | qb4TnKpa4dFSGXVTx7VUf4g9FW1wjxwv | af567d7bfed223e912689312a6a9735cc08b9a9e |             | NULL             |          |              1 | 2018-10-24 17:14:05 |2018-10-24 17:32:15 | {\"path\":\"settings/tables/navigation\",\"route\":\"settingsTable\"} | 192.168.32.1 |     1 | //www.gravatar.com/avatar/64e1b8d34f425d19e1ee2ea7236d3028?s=200&d=identicon&r=g |           NULL | NULL     | NULL  | NULL    | NULL | NULL  | NULL    | NULL | en       | America/New_York | NULL         | NULL        |          NULL |            NULL |\r\n+----+--------+------------+-----------+-----------------+--------------------------------------------------------------+------------------+----------------------------------+------------------------------------------+-------------+------------------+----------+----------------+---------------------+---------------------+---------------------------------------------------------------+--------------+-------+----------------------------------------------------------------------------------+----------------+----------+-------+---------+------+-------+---------+------+----------+------------------+--------------+-------------+---------------+-----------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\n[error.2018-11-04.log](https://github.com/directus/api/files/2546131/error.2018-11-04.log)\r\n\r\n\r\n## Technical Details\r\n\r\n- Device: desktop\r\n- OS: ubuntu 18.04\r\n- Web Server: as for docker image\r\n- PHP Version: as for docker image\r\n- Database: Mariadb  10.2\r\n- Install Method: docker image\r\n"},{"labels":["bug"],"text":"Steps:\r\n1. Create a collecction with a field 'xxx' and set its field type = One2Many\r\n2. Add a record, and select existing items for the fied 'xxx'\r\n3. API returns a failure, and the response is 500, the detail is:\r\n\r\n```json\r\n\r\n{\r\n\"error\":\r\n{\r\n\"code\":9,\r\n\"message\":\"Failed generating the SQL query. Statement could not be executed (42S22 - 1054 - Unknown column 'fans' in 'field list')\",\r\n\"query\":\"INSERT INTO `dr_tweets` (`field_a`, `xxx`, `created_on`, `created_by`) VALUES ('<p>asfasfasf<\\/p>', NULL, '2018-11-04 16:07:51', '1')\",\r\n\"class\":\"Directus\\\\Database\\\\Exception\\\\InvalidQueryException\",\r\n\"file\":\"\\/var\\/www\\/html\\/src\\/core\\/Directus\\/Database\\/TableGateway\\/BaseTableGateway.php\",\r\n\"line\":802\r\n}\r\n}\r\n\r\n```\r\n\r\n"},{"labels":["bug"],"text":"installing latest releases\r\n```\r\ncd /srv/directus-app\r\ngit log | head\r\n\tcommit 088e53ad99c6dd04b7ab5d511aa23d3b96add7e6\r\n\tAuthor: rijkvanzanten <rijkvanzanten@me.com>\r\n\tDate:   Fri Nov 2 17:36:19 2018 -0400\r\n\r\n\t    v7.0.5\r\n\r\n\tcommit 05ef5b7205ac1e0979c3f82db6cb0f232816267c\r\n\tAuthor: rijkvanzanten <rijkvanzanten@me.com>\r\n\tDate:   Sat Oct 27 12:06:40 2018 -0400\r\n\r\ncd /srv/directus-api\r\ngit log | head\r\n\tcommit 2ac0efc8326f897daf4c1a58ce2f3c6fdac16dd1\r\n\tAuthor: rijkvanzanten <rijkvanzanten@me.com>\r\n\tDate:   Fri Nov 2 17:46:04 2018 -0400\r\n\r\n\t    v2.0.5\r\n\r\n\tcommit beac8867179137fc01a872f073b99dda9fb114d8\r\n\tAuthor: rijkvanzanten <rijkvanzanten@me.com>\r\n\tDate:   Sat Oct 27 11:55:05 2018 -0400\r\n```\r\n\r\nwebapp config for directus-app\r\n```\r\ncat directus-app/config.js\r\n\t(function directusConfig() {\r\n\t\tconst config = {\r\n\t\t\tapi: {\r\n\t\t\t\t\"https://directus-api.example.com/_/\": \"TEST API\"\r\n\t\t\t},\r\n\t\t\tallowOtherAPI: false,\r\n\t\t\trouterMode: \"hash\",\r\n\t\t\trouterBaseUrl: \"/\"\r\n\t\t};\r\n\t\twindow.__DirectusConfig__ = config;\r\n\t})();\r\n```\r\n\r\ndirectus-api config\r\n```\r\ncat /srv/directus-api/config/api.php\r\n\t<?php\r\n\r\n\treturn [\r\n\t\t'app' => [\r\n\t\t\t'env' => 'development',\r\n\t\t\t'timezone' => 'America/Los_Angeles',\r\n\t\t],\r\n\t\t'settings' => [\r\n\t\t\t'logger' => [\r\n\t\t\t\t'path' => '/var/log/nginx/directus-api.log',\r\n\t\t\t],\r\n\t\t],\r\n\t\t'database' => [\r\n\t\t\t'type' => 'mysql',\r\n\t\t\t'socket' => '/var/run/mdb/mdb.sock',\r\n\t\t\t'name' => 'directus_db',\r\n\t\t\t'username' => 'directus_api_user',\r\n\t\t\t'password' => 'directus_api_pass',\r\n\t\t\t'engine' => 'InnoDB',\r\n\t\t\t'charset' => 'utf8mb4'\r\n\t\t],\r\n\t\t'cache' => [\r\n\t\t\t'enabled' => true,\r\n\t\t\t'response_ttl' => 3600,\r\n\t\t\t'pool' => [\r\n\t\t\t\t'adapter'   => 'redis',\r\n\t\t\t\t'host'      => '127.0.0.1',\r\n\t\t\t\t'port'      => 6379\r\n\t\t\t],\r\n\t\t],\r\n\t\t'storage' => [\r\n\t\t\t'adapter' => 'local',\r\n\t\t\t'root' => 'public/uploads/_/originals',\r\n\t\t\t'root_url' => '/uploads/_/originals',\r\n\t\t\t'thumb_root' => 'public/uploads/_/thumbnails',\r\n\t\t],\r\n\t\t'mail' => [\r\n\t\t\t'default' => [\r\n\t\t\t\t'transport' => 'smtp',\r\n\t\t\t\t'from' => 'directus-api@example.com',\r\n\t\t\t\t'host' => 'mx.example.net',\r\n\t\t\t\t'port' => 587,\r\n\t\t\t\t'username' => 'sender@mx.example.net',\r\n\t\t\t\t'password' => 'aaaa',\r\n\t\t\t\t'encryption' => 'tls',\r\n\t\t\t],\r\n\t\t],\r\n\t\t'cors' => [\r\n\t\t\t'enabled' => false,\r\n\t\t\t'origin' => ['*'],\r\n\t\t\t'methods' => [\r\n\t\t\t\t'GET',\r\n\t\t\t\t'POST',\r\n\t\t\t\t'PUT',\r\n\t\t\t\t'PATCH',\r\n\t\t\t\t'DELETE',\r\n\t\t\t\t'HEAD',\r\n\t\t\t],\r\n\t\t\t'headers' => [],\r\n\t\t\t'exposed_headers' => [],\r\n\t\t\t'max_age' => null,\r\n\t\t\t'credentials' => false,\r\n\t\t],\r\n\t\t'rate_limit' => [\r\n\t\t\t'enabled' => false,\r\n\t\t\t'limit' => 100,\r\n\t\t\t'interval' => 60,\r\n\t\t\t'adapter' => 'redis',\r\n\t\t\t'host' => '127.0.0.1',\r\n\t\t\t'port' => 6379,\r\n\t\t\t'timeout' => 10\r\n\t\t],\r\n\t\t'hooks' => [\r\n\t\t\t'actions' => [],\r\n\t\t\t'filters' => [],\r\n\t\t],\r\n\t\t'feedback' => [\r\n\t\t\t'token' => 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',\r\n\t\t\t'login' => false,\r\n\t\t],\r\n\t\t'tableBlacklist' => [],\r\n\t\t'auth' => [\r\n\t\t\t'secret_key' => 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb',\r\n\t\t\t'public_key' => 'cccccccccccccccccccccccccccccccc',\r\n\t\t\t'social_providers' => [\r\n\t\t\t]\r\n\t\t],\r\n\t];\r\n```\r\n\r\ninstall schema\r\n```\r\ncd /srv/directus-api\r\nmysqlshow directus_db\r\n\tDatabase: directus_db\r\n\t+--------+\r\n\t| Tables |\r\n\t+--------+\r\n\t+--------+\r\n\r\nbin/directus install:database\r\nmysqlshow directus_db\r\n\tDatabase: directus_db\r\n\t+-----------------------------+\r\n\t|           Tables            |\r\n\t+-----------------------------+\r\n\t| directus_activity           |\r\n\t| directus_activity_seen      |\r\n\t| directus_collection_presets |\r\n\t| directus_collections        |\r\n\t| directus_fields             |\r\n\t| directus_files              |\r\n\t| directus_folders            |\r\n\t| directus_migrations         |\r\n\t| directus_permissions        |\r\n\t| directus_relations          |\r\n\t| directus_revisions          |\r\n\t| directus_roles              |\r\n\t| directus_settings           |\r\n\t| directus_user_roles         |\r\n\t| directus_users              |\r\n\t+-----------------------------+\r\n```\r\n\r\ninstall admin user\r\n```\r\nbin/directus install:install \\\r\n -e \"test_user@example.com\" \\\r\n -p \"test_pass\" \\\r\n -t \"test_token\"\r\n```\r\n\r\nnote that it does NOT install *that* user/pass\r\n```\r\ntail -f /var/log/mariadb/mariadb.log\r\n\t...\r\n\t181104  6:32:19     51 Connect  directus_api_user@localhost as anonymous on directus_db\r\n\t                    51 Query    SET NAMES utf8mb4\r\n\t                    51 Query    SELECT `directus_settings`.* FROM `directus_settings`\r\n\t                    52 Connect  directus_api_user@localhost as anonymous on directus_db\r\n\t                    52 Query    SET NAMES utf8mb4\r\n\t                    52 Query    INSERT INTO `directus_settings` (`scope`, `key`, `value`) VALUES ('global', 'auto_sign_out', '60')\r\n\t                    52 Query    INSERT INTO `directus_settings` (`scope`, `key`, `value`) VALUES ('global', 'project_name', 'Directus')\r\n\t                    52 Query    INSERT INTO `directus_settings` (`scope`, `key`, `value`) VALUES ('global', 'default_limit', '200')\r\n\t                    52 Query    INSERT INTO `directus_settings` (`scope`, `key`, `value`) VALUES ('global', 'logo', '')\r\n\t                    52 Query    INSERT INTO `directus_settings` (`scope`, `key`, `value`) VALUES ('files', 'youtube_api_key', '')\r\n\t                    53 Connect  directus_api_user@localhost as anonymous on directus_db\r\n\t                    53 Query    SET NAMES utf8mb4\r\n\t                    53 Query    INSERT INTO `directus_users` (`status`, `first_name`, `last_name`, `email`, `password`, `token`, `locale`) VALUES ('active', 'Admin', 'User', 'admin@example.com', '$2y$10$cZpwMQKCns3BfiHuLXtCbuRvNELcKq0O4FE8GsLF76IJ1Rgd1F5Jy', NULL, 'en-US')\r\n\t                    53 Query    INSERT INTO `directus_user_roles` (`user`, `role`) VALUES ('1', 1)\r\n\t                    53 Quit\r\n\t                    52 Quit\r\n\t                    51 Quit\r\n\t...\r\n```\r\n\r\nAt nav to\r\n\r\n\thttps://example.com/directus/\r\n\r\nlogin with credentials,\r\n```\r\n\tu -> test_user@example.com\"\r\n\tp -> test_pass\r\n```\r\n\r\nreturns only\r\n```\r\n\t\"error Couldn't reach API\"\r\n```\r\n\r\n--> screenshot: https://i.imgur.com/tfD6m9R.png\r\n\r\nTest API existence, no auth\r\n```\r\n\tRaw Data @ https://directus-api.example.com/\r\n\t\t{\r\n\t\t  \"error\": {\r\n\t\t    \"code\": 108,\r\n\t\t    \"message\": \"User not authenticated\",\r\n\t\t    \"class\": \"Directus\\\\Authentication\\\\Exception\\\\UserNotAuthenticatedException\",\r\n\t\t    \"file\": \"/srv/directus-api/src/core/Directus/Application/Http/Middleware/AuthenticatedMiddleware.php\",\r\n\t\t    \"line\": 21\r\n\t\t  }\r\n\t\t}\r\n```\r\n\r\nTest API access, with token\r\n```\r\n\tcurl --include --insecure --http2 --ipv4 --ssl --tlsv1.2 \\\r\n\t-H \"Accept: application/json\"  -H \"Content-Type: application/json\" \\\r\n\t-X GET https://directus-api.example.com/_/users?access_token=test_token\r\n\r\n\t\tHTTP/2 404\r\n\t\tdate: Sun, 04 Nov 2018 15:06:51 GMT\r\n\t\tcontent-type: application/json;charset=utf-8\r\n\t\tcontent-length: 219\r\n\t\tvary: Accept-Encoding\r\n\t\tx-powered-by: PHP/7.2.12-dev\r\n\t\tsecure: Server\r\n\t\tx-content-type-options: nosniff\r\n\r\n\t\t{\"error\":{\"code\":106,\"message\":\"User not found\",\"class\":\"Directus\\\\Authentication\\\\Exception\\\\UserNotFoundException\",\"file\":\"\\/srv\\/directus-api\\/src\\/core\\/Directus\\/Authentication\\/Provider.php\",\"line\":601}}\r\n```"},{"labels":["bug"],"text":"The `/mail` endpoint must only be accessed by authenticated user, excluding the public role."},{"labels":["bug"],"text":"Hello,\r\nI'm trying to implement a M2M Interface for multiple files import. However when trying to save multiple files (or just one) in the table i get the error:\r\n```\r\nCall to a member function getType() on null\r\nin file www/directus/src/core/Directus/Application/CoreServicesProvider.php\r\non line 562\r\n```\r\n\r\nThis is how my tables are set up:\r\n\r\n```\r\nblog (main table)\r\n- id\r\n- title\r\n- content\r\n- gallery (M2M interface)\r\n\r\nimages (the table where the images are saved)\r\n- id\r\n- image (File field)\r\n\r\nblog_images (junction table)\r\n- id\r\n- blog_id\r\n- images_id\r\n```\r\n\r\nAnd this is the configuration for the blog table:\r\n\r\n![directus_issue1](https://user-images.githubusercontent.com/36792400/47881155-9e8d0b80-de25-11e8-85ba-7ea381231b04.png)\r\n\r\n![directus_issue2](https://user-images.githubusercontent.com/36792400/47881261-e7dd5b00-de25-11e8-8b9e-9852f985b142.png)\r\n\r\nAnd this is how my M2M table looks like with 3 pictures uploaded:\r\n\r\n![directus_issue3](https://user-images.githubusercontent.com/36792400/47884246-460f3b80-de30-11e8-9500-c5bf375eba1b.png)\r\n\r\nWhen I try to confirm the new entry I get the error I mentioned above.\r\n\r\nAm I missing something or have I found a bug?\r\n\r\n\r\nSystem info:\r\nUbuntu 18\r\nNginx 1.14.0\r\nPHP 7.2\r\nMySQL 5.7.24\r\nDirectus 7.0.4"},{"labels":["bug"],"text":"Two bugs are found for API, and they are:\r\n\r\n__1. Read permission is not working for users__\r\n- For the default role 'Public', I checked the read permission of some fields in directus_users table for it, so that the public can access users to fetch the specified fields.\r\n- When I send a request to get some other collections,  and one of the field's type is 'User_created', even if I specify the request parameter as: fields=\\*.\\*,  the response will only include the user id, and other public user fields are just missing.\r\n\r\n__2. /scim/v2/users return null id__\r\n\r\nAccording to the doc, I tried to fetch all users via the /scim/v2/users API, and find the ID is null in the response, see following for details:\r\n\r\n```json\r\n{\r\n    \"schemas\": [\r\n        \"urn:ietf:params:scim:api:messages:2.0:ListResponse\"\r\n    ],\r\n    \"totalResults\": 2,\r\n    \"Resources\": [\r\n        {\r\n            \"schemas\": [\r\n                \"urn:ietf:params:scim:schemas:core:2.0:User\"\r\n            ],\r\n            \"id\": null,\r\n            \"externalId\": 1,\r\n            \"meta\": {\r\n                \"resourceType\": \"User\",\r\n                \"location\": \"http://xxx.com/_/scim/v2/Users/\",\r\n                \"version\": \"W/\\\"319d0add61e8f24cf3e1d4c094aa2f56\\\"\"\r\n            },\r\n            \"name\": {\r\n                \"familyName\": \"abc\",\r\n                \"givenName\": \"xxx\"\r\n            },\r\n            \"userName\": \"xxx@xx.com\",\r\n            \"emails\": [\r\n                {\r\n                    \"value\": \"xxx@xx.com\",\r\n                    \"type\": \"work\",\r\n                    \"primary\": true\r\n                }\r\n            ],\r\n            \"locale\": \"en-US\",\r\n            \"timezone\": \"America/New_York\",\r\n            \"active\": true\r\n        },\r\n...\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"No sensitive information should be in the logs, we can keep the output but passwords should be masked.\r\n\r\n```\r\n#10 C:\\xampp\\htdocs\\directus.test\\src\\endpoints\\Auth.php(49): Directus\\Services\\AuthService->loginWithCredentials('admin@admin.com', 'xxxxxxxxxxxxx!')\r\n```"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Issue Description\r\n\r\nI have a collection named `stories` with the following fields\r\n\r\nID: the default field\r\ntitle: a text field with field type = string\r\nstory: a WYSIWYG editor\r\nbanner_image: a featured image\r\ncategories: a list of categories to select from\r\ncreated_by: a User field with field type = User Created\r\ncreated_on: a DataTime field with field type = DateTime Created\r\n\r\nAPI call =\r\n`GET /items/stories?fields=*.*`\r\n\r\nResponse =\r\n\r\n ```   \"data\": [\r\n        {\r\n            \"id\": 8,\r\n            \"title\": \"Test\",\r\n            \"banner_image\": {\r\n                \"id\": 1,\r\n                \"storage\": \"local\",\r\n                \"filename\": \"love.jpg\",\r\n                \"title\": \"Love\",\r\n                \"type\": \"image/jpeg\",\r\n                \"uploaded_by\": 1,\r\n                \"uploaded_on\": \"2018-10-30T19:21:38+00:00\",\r\n                \"charset\": \"binary\",\r\n                \"filesize\": 52498,\r\n                \"width\": 800,\r\n                \"height\": 450,\r\n                \"duration\": null,\r\n                \"embed\": null,\r\n                \"folder\": null,\r\n                \"description\": \"\",\r\n                \"location\": \"\",\r\n                \"tags\": [],\r\n                \"metadata\": null,\r\n                \"data\": {\r\n                    \"full_url\": \"http://thewriteaddict.com/directus/public/uploads/_/originals/love.jpg\",\r\n                    \"url\": \"/uploads/_/originals/love.jpg\",\r\n                    \"thumbnails\": [\r\n                        {\r\n                            \"url\": \"http://thewriteaddict.com/directus/public/thumbnail/_/200/200/crop/good/love.jpg\",\r\n                            \"relative_url\": \"/thumbnail/_/200/200/crop/good/love.jpg\",\r\n                            \"dimension\": \"200x200\",\r\n                            \"width\": 200,\r\n                            \"height\": 200\r\n                        }\r\n                    ],\r\n                    \"embed\": null\r\n                }\r\n            },\r\n            \"story\": \"<p>Test story</p>\",\r\n            \"created_on\": null,\r\n            \"author\": {\r\n                \"id\": 1\r\n            },\r\n            \"categories\": [\r\n                {\r\n                    \"id\": 14,\r\n                    \"story_id\": \"8\",\r\n                    \"category_id\": \"1\"\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    \"public\": true\r\n}\r\n```\r\n\r\nAs you can see, the `created_on` returns `null`\r\n\r\n## Expected Behavior\r\n`created_on` being a `User Created` interface must pick up the current datetime stamp\r\n\r\n## Actual Behavior\r\nField has `null` value\r\n\r\n## Technical Details\r\n\r\n- Device: Linux Shared Server\r\n- OS: Linux\r\n- Web Server: Apache 2.4.33\r\n- PHP Version: 7.1.0\r\n- Database: MySQL 5.5.61-38.13\r\n- Install Method: cloned master\r\n"},{"labels":["bug"],"text":"MariaDB wrap default value in quotes, making the default value \"incorrect\". This is what makes `null` into `'null'` and a datetime an invalid datetime because the value contain unexpected quote."},{"labels":["bug"],"text":"This method was implemented wrong, as it expects the timezone to always be \"positive\"."},{"labels":["bug",null],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a collection\r\n2. Add a `user` interface to the collection\r\n3. Create an entry in the collection and select any user from the list.\r\n4. Provide `Read` permissions for `Public` role to the collections `Directus Users` and `Relations`\r\n5. Make API request for that collection without token\r\n\r\n## Expected Behavior\r\nSince there is a `read` permission, we should get the complete user details under `user`\r\n\r\n## Actual Behavior\r\nReturns only `id`\r\n\r\n## Other Context & Screenshots\r\nSame API call with Token returns a complete user data.\r\n\r\n## Technical Details\r\n\r\n- Device: Linux Shared Server\r\n- OS: Linux\r\n- Web Server: Apache 2.4.33\r\n- PHP Version: 7.1.0\r\n- Database: MySQL 5.5.61-38.13\r\n- Install Method: cloned `master`\r\n"},{"labels":["bug"],"text":"After adding a `created_on` field type and trying to save a new item, I am getting the following error:\r\n\r\n![screen shot 2018-10-30 at 1 29 57 pm](https://user-images.githubusercontent.com/522079/47737755-00901a00-dc48-11e8-98d9-1fd848d478c8.png)\r\n\r\n@rijkvanzanten could this be an App issue?"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Apply patches from  commit 7245b7aee01e2362e38b9d79d6cc024c568bf276 to cloned suite due to previos issues\r\nFixes #531\r\nRef: #532\r\nRef: #498\r\n\r\n2. Login get error \r\n\r\n\r\n## Expected Behavior\r\n\r\n## Actual Behavior\r\n![image](https://user-images.githubusercontent.com/17192852/47714795-c4ec5480-dc35-11e8-97a8-3d01503f08f5.png)\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\npublic function toISO8601Format() is in DateTimeUtils.php\r\n## Technical Details\r\n\r\n- Device: dedicated Kimsufi server\r\n- OS: Debian GNU/Linux 9 (stretch)\r\n- Web Server: Apache/2.4.25 (Debian)\r\n- PHP Version:PHP 7.0.30-0+deb9u1\r\n- Database: 10.1.26-MariaDB\r\n- Install Method: cloned master suite and patched commit 7245b7aee01e2362e38b9d79d6cc024c568bf276\r\n\r\nError log\r\n`[2018-10-30 04:16:40] api[_].ERROR: Error: Call to undefined method DateTime::toISO8601Format() in /home/directus/src/core/Directus/Database/Schema/SchemaManager.php:569 Stack trace: #0 /home/directus/src/core/Directus/Database/Schema/SchemaManager.php(269): Directus\\Database\\Schema\\SchemaManager->createFieldFromArray(Array) #1 /home/directus/src/core/Directus/Database/Schema/SchemaManager.php(144): Directus\\Database\\Schema\\SchemaManager->getFields('civicrm_contact', Array, false) #2 /home/directus/src/core/Directus/Services/TablesService.php(1447): Directus\\Database\\Schema\\SchemaManager->getCollection('civicrm_contact') #3 /home/directus/src/core/Directus/Services/TablesService.php(1307): Directus\\Services\\TablesService->mergeSchemaCollection('civicrm_contact', Array) #4 /home/directus/src/core/Directus/Services/TablesService.php(66): Directus\\Services\\TablesService->mergeMissingSchemaCollections(Array, Array) #5 /home/directus/src/endpoints/Collections.php(58): Directus\\Services\\TablesService->findAll(Array) #6 [internal function]: Directus\\Api\\Routes\\Collections->all(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Array) #7 /home/directus/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php(41): call_user_func(Array, Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Array) #8 /home/directus/vendor/slim/slim/Slim/Route.php(356): Slim\\Handlers\\Strategies\\RequestResponse->__invoke(Array, Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Array) #9 /home/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\Route->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #10 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Slim\\Route)) #11 /home/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\UserRateLimitMiddleware), Array) #12 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Slim\\Route)) #13 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Slim\\Route)) #14 /home/directus/src/core/Directus/Application/Http/Middleware/AuthenticationMiddleware.php(80): Slim\\Route->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #15 [internal function]: Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #16 /home/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\AuthenticationMiddleware), Array) #17 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #18 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #19 /home/directus/src/core/Directus/Application/Http/Middleware/TableGatewayMiddleware.php(25): Slim\\Route->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #20 [internal function]: Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #21 /home/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\TableGatewayMiddleware), Array) #22 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #23 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #24 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\Route->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #25 /home/directus/vendor/slim/slim/Slim/Route.php(334): Slim\\Route->callMiddlewareStack(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #26 /home/directus/vendor/slim/slim/Slim/App.php(515): Slim\\Route->run(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #27 /home/directus/src/core/Directus/Application/Http/Middleware/AbstractRateLimitMiddleware.php(34): Slim\\App->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #28 [internal function]: Directus\\Application\\Http\\Middleware\\AbstractRateLimitMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Directus\\Application\\Application)) #29 /home/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\IpRateLimitMiddleware), Array) #30 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Directus\\Application\\Application)) #31 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Directus\\Application\\Application)) #32 /home/directus/vendor/akrabat/rka-ip-address-middleware/src/IpAddress.php(93): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #33 [internal function]: RKA\\Middleware\\IpAddress->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #34 /home/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(RKA\\Middleware\\IpAddress), Array) #35 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #36 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #37 /home/directus/src/core/Directus/Application/Http/Middleware/CorsMiddleware.php(66): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #38 [internal function]: Directus\\Application\\Http\\Middleware\\CorsMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #39 /home/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\CorsMiddleware), Array) #40 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #41 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #42 /home/directus/src/core/Directus/Application/Http/Middleware/ResponseCacheMiddleware.php(47): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #43 [internal function]: Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #44 /home/directus/vendor/slim/slim/Slim/DeferredCallable.php(43): call_user_func_array(Object(Directus\\Application\\Http\\Middleware\\ResponseCacheMiddleware), Array) #45 [internal function]: Slim\\DeferredCallable->__invoke(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #46 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(70): call_user_func(Object(Slim\\DeferredCallable), Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response), Object(Closure)) #47 /home/directus/vendor/slim/slim/Slim/MiddlewareAwareTrait.php(117): Slim\\App->Slim\\{closure}(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #48 /home/directus/vendor/slim/slim/Slim/App.php(406): Slim\\App->callMiddlewareStack(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #49 /home/directus/vendor/slim/slim/Slim/App.php(314): Slim\\App->process(Object(Directus\\Application\\Http\\Request), Object(Directus\\Application\\Http\\Response)) #50 /home/directus/src/core/Directus/Application/Application.php(161): Slim\\App->run(false) #51 /home/directus/public/index.php(5): Directus\\Application\\Application->run() #52 {main} [] []`\r\n"},{"labels":["bug"],"text":"```\r\n- Device: Desktop\r\n- OS:\r\n\tlsb_release -rd\r\n\t\tDescription:    openSUSE Leap 15.0\r\n\t\tRelease:        15.0\r\n\tuname -rm\r\n\t\t4.19.0-lp150.3.g09557ad-default x86_64\r\n- Web Server:\r\n\tnginx -v\r\n\t\tnginx version: nginx/1.15.5\r\n- PHP Version:\r\n\tphp -v\r\n\t\tPHP 7.2.12-dev (cli) (built: Oct 16 2018 21:08:17) ( NTS )\r\n\t\tCopyright (c) 1997-2018 The PHP Group\r\n\t\tZend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies\r\n\t\t    with Zend OPcache v7.2.12-dev, Copyright (c) 1999-2018, by Zend Technologies\r\n\tphp -m | grep -i sql\r\n\t\tmysqli\r\n\t\tmysqlnd\r\n\t\tpdo_mysql\r\n\t\tpdo_sqlite\r\n\t\tsqlite3\r\n\r\n- Database:\r\n\tmariadb_config --version\r\n\t\t10.3.11\r\n- Install Method: cloned `build` branch\r\n\r\ncd /srv/directus-api\r\ngit branch -a | head -n 1\r\n\t* build\r\ngit log | head\r\n\tcommit beac8867179137fc01a872f073b99dda9fb114d8\r\n\tAuthor: rijkvanzanten <rijkvanzanten@me.com>\r\n\tDate:   Sat Oct 27 11:55:05 2018 -0400\r\n\r\n\t    v2.0.4\r\n\r\n\tcommit 58747f253bbd0bafdeeb18ba769193ac4c62b739\r\n\tAuthor: rijkvanzanten <rijkvanzanten@me.com>\r\n\tDate:   Fri Oct 26 17:39:09 2018 -0400\r\n\r\nmysql \\\r\n  --socket='/var/run/mdb/mdb.sock' \\\r\n  --user='directus_user' \\\r\n  --password='directus_pass' \\\r\ndirectus_db\r\n\r\n\tMariaDB [directus_db]> status\r\n\t\tstatus\r\n\t\t--------------\r\n\t\tmysql  Ver 15.1 Distrib 10.3.11-MariaDB, for Linux (x86_64) using readline 5.1\r\n\r\n\t\tConnection id:          24\r\n\t\tCurrent database:       directus_db\r\n\t\tCurrent user:           directus_user@localhost\r\n\t\tSSL:                    Not in use\r\n\t\tCurrent pager:          /usr/bin/less\r\n\t\tUsing outfile:          ''\r\n\t\tUsing delimiter:        ;\r\n\t\tServer:                 MariaDB\r\n\t\tServer version:         10.3.11-MariaDB-log Source distribution\r\n\t\tProtocol version:       10\r\n\t\tConnection:             Localhost via UNIX socket\r\n\t\tServer characterset:    utf8mb4\r\n\t\tDb     characterset:    utf8mb4\r\n\t\tClient characterset:    utf8mb4\r\n\t\tConn.  characterset:    utf8mb4\r\n\t\tUNIX socket:            /var/run/mdb/mdb.sock\r\n\t\tUptime:                 4 hours 13 min 33 sec\r\n\r\n\t\tThreads: 8  Questions: 181  Slow queries: 0  Opens: 46  Flush tables: 1  Open tables: 30  Queries per second avg: 0.011\r\n\t\t--------------\r\n\r\n\r\ncat /srv/directus-api/config/api.php\r\n\t<?php\r\n\r\n\treturn [\r\n\t\t'app' => [\r\n\t\t\t'env' => 'development',\r\n\t\t\t'timezone' => 'America/Los_Angeles',\r\n\t\t],\r\n\t\t'settings' => [\r\n\t\t\t'logger' => [\r\n\t\t\t\t'path' => '/var/log/nginx/directus-api.log',\r\n\t\t\t],\r\n\t\t],\r\n\t\t'database' => [\r\n\t\t\t'type' => 'mysql',\r\n\t\t\t'socket' => '/var/run/mdb/mdb.sock',\r\n\t\t\t'name' => 'directus_db',\r\n\t\t\t'username' => 'directus_user',\r\n\t\t\t'password' => 'directus_pass',\r\n\t\t\t'engine' => 'InnoDB',\r\n\t\t\t'charset' => 'utf8mb4'\r\n\t\t],\r\n\t\t'cache' => [\r\n\t\t\t'enabled' => true,\r\n\t\t\t'response_ttl' => 3600, // seconds\r\n\t\t\t'pool' => [\r\n\t\t\t\t'adapter'   => 'redis',\r\n\t\t\t\t'host'      => '127.0.0.1',\r\n\t\t\t\t'port'      => 6379\r\n\t\t\t],\r\n\t\t],\r\n\t\t'storage' => [\r\n\t\t\t'adapter' => 'local',\r\n\t\t\t'root' => 'public/uploads/_/originals',\r\n\t\t\t'root_url' => '/uploads/_/originals',\r\n\t\t\t'thumb_root' => 'public/uploads/_/thumbnails',\r\n\t\t],\r\n\t\t'mail' => [\r\n\t\t\t'default' => [\r\n\t\t\t\t'transport' => 'smtp',\r\n\t\t\t\t'from' => 'directus-api@example.com',\r\n\t\t\t\t'host' => 'mx.example.com',\r\n\t\t\t\t'port' => 587,\r\n\t\t\t\t'username' => 'send@mx.example.com',\r\n\t\t\t\t'password' => 'xxxxxxxxxxxxxxxxxxx',\r\n\t\t\t\t'encryption' => 'tls',\r\n\t\t\t],\r\n\t\t],\r\n\t\t'cors' => [\r\n\t\t\t'enabled' => false,\r\n\t\t\t'origin' => ['*'],\r\n\t\t\t'methods' => [\r\n\t\t\t\t'GET',\r\n\t\t\t\t'POST',\r\n\t\t\t\t'PUT',\r\n\t\t\t\t'PATCH',\r\n\t\t\t\t'DELETE',\r\n\t\t\t\t'HEAD',\r\n\t\t\t],\r\n\t\t\t'headers' => [],\r\n\t\t\t'exposed_headers' => [],\r\n\t\t\t'max_age' => null, // in seconds\r\n\t\t\t'credentials' => false,\r\n\t\t],\r\n\r\n\t\t'rate_limit' => [\r\n\t\t\t'enabled' => false,\r\n\t\t\t'limit' => 100, // number of request\r\n\t\t\t'interval' => 60, // seconds\r\n\t\t\t'adapter' => 'redis',\r\n\t\t\t'host' => '127.0.0.1',\r\n\t\t\t'port' => 6379,\r\n\t\t\t'timeout' => 10\r\n\t\t],\r\n\t\t'hooks' => [\r\n\t\t\t'actions' => [],\r\n\t\t\t'filters' => [],\r\n\t\t],\r\n\t\t'feedback' => [\r\n\t\t\t'token' => '0000000000000000000000000000000',\r\n\t\t\t'login' => false,\r\n\t\t],\r\n\t\t'tableBlacklist' => [],\r\n\t\t'auth' => [\r\n\t\t\t'secret_key' => '11111111111111111111111111111111',\r\n\t\t\t'public_key' => '22222222222222222222222222222222',\r\n\t\t\t'social_providers' => []\r\n\t\t],\r\n\t];\r\n\r\ncd /srv/directus-api\r\nbin/directus install:database\r\n\tPHP Fatal error:  Uncaught InvalidArgumentException: There was a problem connecting to the database: SQLSTATE[HY000] [2002] No such file or directory in /srv/directus-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/MysqlAdapter.php:115\r\n\tStack trace:\r\n\t#0 /srv/directus-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php(103): Phinx\\Db\\Adapter\\MysqlAdapter->connect()\r\n\t#1 /srv/directus-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php(145): Phinx\\Db\\Adapter\\PdoAdapter->getConnection()\r\n\t#2 /srv/directus-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php(164): Phinx\\Db\\Adapter\\PdoAdapter->query('SELECT * FROM d...')\r\n\t#3 /srv/directus-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php(250): Phinx\\Db\\Adapter\\PdoAdapter->fetchAll('SELECT * FROM d...')\r\n\t#4 /srv/directus-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/PdoAdapter.php(227): Phinx\\Db\\Adapter\\PdoAdapter->getVersionLog()\r\n\t#5 /srv/directus-api/vendor/robmorgan/phinx/src/Phin in /srv/directus-api/vendor/robmorgan/phinx/src/Phinx/Db/Adapter/MysqlAdapter.php on line 115\r\n\r\ncat vendor/robmorgan/phinx/src/Phinx/Db/Adapter/MysqlAdapter.php\r\n\t...\r\n\t    try {\r\n\t        $db = new \\PDO($dsn, $options['user'], $options['pass'], $driverOptions);\r\n\t    } catch (\\PDOException $exception) {\r\n115\t        throw new \\InvalidArgumentException(sprintf(\r\n\t            'There was a problem connecting to the database: %s',\r\n\t            $exception->getMessage()\r\n\t        ));\r\n\t        }\r\n\t...\r\n```"},{"labels":["bug"],"text":"Creating a new user with an unknown status (not reference in status mapping), throws a 500 internal error because the API expects an array and gets an `null` instead.\r\n\r\n```\r\nArgument 3 passed to Directus\\Application\\Route::responseWithData() must be of the type array, null given, called in /Users/welling/src/api/src/endpoints/Users.php on line 71\r\n```"},{"labels":["bug"],"text":"MariaDB is returning the default value as string when is `NULL`"},{"labels":["bug",null],"text":"Moved from https://github.com/directus/app/issues/1037\r\n\r\n---\r\n\r\nFrom directus created by [maxia](https://github.com/maxia) : directus/directus#2122  \r\n\r\nI noticed that when a user has an email with a IDN domain (e.g. info@d√∂m√§in.com -> info@xn--dmin-moa0i.com) the login will not work.\r\n\r\nI'm currently using a workaround that converts the email to punycode on login and entered the punycode email for the user.\r\n\r\n## Version Info\r\n  - Directus version and branch (Or commit hash):\r\n  - PHP version: PHP 7.0.28-0ubuntu0.16.04.1\r\n  - MySQL version: 5.7.21-0ubuntu0.16.04.1 \r\n  - Web server: nginx/1.12.1\r\n  - OS name and version:  Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-116-generic x86_64)\r\n\r\n## Steps to Reproduce\r\n 1. Enter a email like info@d√∂m√§in.com for a user\r\n 2. Try to login\r\n"},{"labels":["bug"],"text":"# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\nif you have a table that has a field type `datetime` with `CURRENT_TIMESTAMP` default value you get error.\r\n\r\n1. create a table with this scheme (from mysql console or sequelpro)\r\n\r\n```sql\r\nCREATE TABLE `chains` (\r\n  `id` varchar(255) NOT NULL,\r\n  `name` varchar(255) NOT NULL,\r\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,\r\n  PRIMARY KEY (`id`),\r\n  KEY `name` (`name`)\r\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\r\n```\r\n\r\n2. go to dashboard\r\n3. you will get an error.\r\n\r\n```\r\n{\"error\":{\"code\":null,\"message\":\"Argument 1 passed to Directus\\\\Util\\\\DateTimeUtils::createFromDateTime() must be an instance of DateTime, boolean given, called in \\/var\\/www\\/src\\/core\\/Directus\\/Util\\/DateTimeUtils.php on line 123\",\"class\":\"TypeError\",\"file\":\"\\/var\\/www\\/src\\/core\\/Directus\\/Util\\/DateTimeUtils.php\",\"line\":96}}\r\n```\r\n\r\n## Expected Behavior\r\n\r\nsuccess\r\n\r\n## Actual Behavior\r\n\r\n```\r\n{\"error\":{\"code\":null,\"message\":\"Argument 1 passed to Directus\\\\Util\\\\DateTimeUtils::createFromDateTime() must be an instance of DateTime, boolean given, called in \\/var\\/www\\/src\\/core\\/Directus\\/Util\\/DateTimeUtils.php on line 123\",\"class\":\"TypeError\",\"file\":\"\\/var\\/www\\/src\\/core\\/Directus\\/Util\\/DateTimeUtils.php\",\"line\":96}}\r\n```\r\n\r\n## Other Context & Screenshots\r\n\r\n<!-- Any other relevant information, screenshots, or schema files to help explain your problem -->\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop\r\n- OS: [eg: MacOS 10.13.6, Windows 10.1803]\r\n- Web Server: 2.7\r\n- PHP Version: 7.2\r\n- Database: 5.7\r\n- Install Method: directus suite, clone master\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a field with a \"Many to one\" relationship and save\r\n2. Attempt to go back and change any of the field settings.\r\n3. Get error message due to \"length\"?\r\n\r\n## Expected Behavior\r\nField should be updated with my new changes, without issue.\r\n\r\n## Actual Behavior\r\nReceiving error message: `message: \"field \"server_id\" does not support length\"`\r\n\r\n## Other Context & Screenshots\r\n\r\n![image](https://user-images.githubusercontent.com/16869302/47610177-90ff0c80-da46-11e8-9160-3abb55e7be09.png)\r\n\r\n## Technical Details\r\n\r\n- Device: Desktop PC\r\n- OS: Windows 10\r\n- Web Server: Apache\r\n- PHP Version: Unknown\r\n- Database: MySQL 5.7\r\n- Install Method: ZIP 7.4.0, \r\n\r\nRunning Docker\r\n"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nthe `SchemaManager::getField(collection, field)` method has a bug fetching the correct field data.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create an instance of SchemaManager\r\n2. Try to fetch the data of a field: `SchemaManager->getField('projects', 'title');\r\n3. The returned field should be the first field on the collection\r\n\r\n## Expected Behavior\r\n\r\nReturns the correct field object\r\n\r\n## Actual Behavior\r\n\r\nReturns the first field of the collection"},{"labels":["bug"],"text":"<!--\r\n1. Do not delete this template or the issue will be closed\r\n2. Ensure you're using the latest version of Directus\r\n3. Post to the correct repo:\r\n    App:  https://github.com/directus/app/issues\r\n    API:  https://github.com/directus/api/issues (YOU ARE HERE)\r\n    Docs: https://github.com/directus/docs/issues\r\n-->\r\n\r\n# Bug Report\r\n\r\nUpdating a field that exists but doesn't have any data in `directus_fields` shouldn't require `field.type`.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Add new field to a collection directly in the database\r\n2. Update any simple attribute of the new created field, such as `sort`\r\n3. See error\r\n\r\n## Expected Behavior\r\n\r\nThe `field.type` should be the default from the database schema\r\n\r\n## Actual Behavior\r\n\r\nReturns an error that the `type` cannot be `null`\r\n\r\n```\r\nFailed generating the SQL query. Statement could not be executed (23000 - 1048 - Column 'type' cannot be null)\r\n```"},{"labels":["bug",null],"text":"When I upload a PDF file, or a JS file, or anything non-image?, the type is set to `text/plain`"},{"labels":["bug"],"text":"# Bug Report\r\n\r\nWhen a field exists in the DB (there is a column) but there is NO directus_fields row (when the user created a column in the DB directly). Sending a PATCH request to /fields/:fieldname returns an internal server error.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Add a new column to the DB directly\r\n2. Try updating this column by sending a PATCH request\r\n\r\n## Expected Behavior\r\n\r\nThe API returns 200\r\n\r\n## Actual Behavior\r\n\r\nAPI returns 500 internal server error with:\r\n\r\n```json\r\n{\"error\":{\"code\":null,\"message\":\"Call to a member function toArray() on null\",\"class\":\"Error\",\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Database\\/TableGateway\\/RelationalTableGateway.php\",\"line\":229}}\r\n```\r\n\r\nWeirdly enough, it looks like the row in directus_fields was created. "},{"labels":["bug"],"text":"## Version Info\r\n  - Directus version and branch (Or commit hash): **5d1e014b13c1b20502ef969b0fcb10b60566327e**\r\n  - PHP version: **PHP 7.2.10-0ubuntu0.18.04.1 (cli) (built: Sep 13 2018 13:45:02) ( NTS )**\r\n  - MySQL version: **mysql  Ver 14.14 Distrib 5.7.24, for Linux (x86_64) using  EditLine wrapper**\r\n  - Web server: (Ex. Apache, nginx or IIS?): **nginx version: nginx/1.14.0 (Ubuntu)**\r\n  - OS name and version: **Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-33-generic x86_64)**\r\n\r\n## Expected Behavior\r\nWhen adding M2M relation you should be able to sort by number of related items.\r\n\r\n## Actual Behavior\r\nAfter sorting by M2M field you get an error saying that field is invalid and you no longer have access to collection's browse page because sorting is saved in **directus_collection_presets.view_query**.\r\n\r\n## Steps to Reproduce\r\n 1. Add M2M relation\r\n 2. Make field visible on browse\r\n 3. Try to sort by that field\r\n\r\n## Schema Dump, Logs, or Screenshots\r\n{\"error\":{\"code\":202,\"message\":\"Invalid field \\\"favorites\\\"\"}}\r\n\r\n------\r\n\r\nOriginally posted by @shota-mentesh as https://github.com/directus/directus/issues/2218"},{"labels":["bug"],"text":"From directus created by [airbenich](https://github.com/airbenich) : directus/directus#2205  \n\n## Version Info\r\n  - Directus version and branch (Or commit hash): 6.4.9\r\n  - PHP version: 7.1.22\r\n  - MySQL version: N/A\r\n  - Web server: (Ex. Apache, nginx or IIS?) Apache\r\n  - OS name and version: N/A\r\n\r\n## Expected Behavior\r\nUsing the thumbnail for image scaling should also scale images wich contains german special-chars in the filename.\r\n\r\n## Actual Behavior\r\nOpening a file via thumbnailer with german special chars in the filename results in the default \"Image not found\" graphic.\r\n\r\nLike:\r\nhttps://domain.com/thumbnail/1000/1000/contain/best/this-is-a-special-char-file-√§√∂√º√ü.jpg\r\n\r\n## Steps to Reproduce\r\n 1. Rename locally on your machine an image to: this-is-a-special-char-file-√§√∂√º√ü.jpg\r\n 2. Upload the image via directus\r\n 3. Call this image via thumbnailer:\r\nhttps://domain.com/thumbnail/1000/1000/contain/best/this-is-a-special-char-file-√§√∂√º√ü.jpg\r\n"},{"labels":["bug"],"text":"From directus created by [shushant](https://github.com/shushant) : directus/directus#2180  \n\n**For security issues, please email support@getdirectus.com directly.**\r\n\r\nTo help us resolve your issue more quickly, please use the following template:\r\n\r\nFor feature requests/voting please use the [Directus Request Tool](https://request.getdirectus.com/), or come chat with us through [getdirectus.com](http://getdirectus.com). Accepted feature requests will be added to GitHub Issues for assignment.\r\n\r\n## Version Info\r\n  - Directus version and branch (Or commit hash): 6.4.2\r\n  - PHP version: 5.6.36\r\n  - MySQL version: 5.7.19\r\n  - Web server: Apache\r\n  - OS name and version: Windows 10\r\n\r\n## Expected Behavior\r\nI don't want certain columns to be exposed publicly \r\n\r\n## Actual Behavior\r\n![capture](https://user-images.githubusercontent.com/3940927/42726632-46114032-87b5-11e8-8da8-d9fe619b1aa2.PNG)\r\nPlease look at the screenshot i have attached.\r\nI have read blacklisted the `attachment` column but whenever i browse the endpoints that columns is still there \r\n\r\n```\r\n{\r\n    \"meta\": {\r\n        \"table\": \"products\",\r\n        \"type\": \"collection\",\r\n        \"total\": 2,\r\n        \"Deleted\": 2,\r\n        \"Published\": 2,\r\n        \"Draft\": 0,\r\n        \"total_entries\": 4\r\n    },\r\n    \"data\": [\r\n        {\r\n            \"id\": 3,\r\n            \"status\": 1,\r\n            \"sort\": null,\r\n            \"name\": \"Yoga Tips\",\r\n            \"attachment\": {\r\n                \"meta\": {\r\n                    \"table\": \"directus_files\",\r\n                    \"type\": \"item\"\r\n                },\r\n                \"data\": {\r\n                    \"id\": 2,\r\n                    \"status\": 1,\r\n                    \"name\": \"00000000002.PNG\",\r\n                    \"title\": \"Capture\",\r\n                    \"location\": \"\",\r\n                    \"caption\": \"\",\r\n                    \"type\": \"image\\/png\",\r\n                    \"charset\": \"binary\",\r\n                    \"tags\": \"\",\r\n                    \"width\": 476,\r\n                    \"height\": 439,\r\n                    \"size\": 17543,\r\n                    \"embed_id\": null,\r\n                    \"user\": 1,\r\n                    \"date_uploaded\": \"2018-07-13T09:26:42-04:00\",\r\n                    \"storage_adapter\": \"local\",\r\n                    \"url\": \"\\/storage\\/uploads\\/00000000002.PNG\",\r\n                    \"thumbnail_url\": \"\\/storage\\/uploads\\/thumbs\\/2.PNG\",\r\n                    \"old_thumbnail_url\": \"\\/storage\\/uploads\\/thumbs\\/00000000002-PNG-160-160-true.jpg\",\r\n                    \"html\": null\r\n                }\r\n            },\r\n            \"category\": {\r\n                \"meta\": {\r\n                    \"table\": \"category\",\r\n                    \"type\": \"item\"\r\n                },\r\n                \"data\": {\r\n                    \"id\": 1,\r\n                    \"status\": 1,\r\n                    \"sort\": null,\r\n                    \"name\": \"Kids\",\r\n                    \"slug\": \"kids\"\r\n                }\r\n            }\r\n        },\r\n        {\r\n            \"id\": 4,\r\n            \"status\": 1,\r\n            \"sort\": null,\r\n            \"name\": \"kshushant\",\r\n            \"attachment\": {\r\n                \"meta\": {\r\n                    \"table\": \"directus_files\",\r\n                    \"type\": \"item\"\r\n                },\r\n                \"data\": {\r\n                    \"id\": 3,\r\n                    \"status\": 1,\r\n                    \"name\": \"dca9ee73d2b97a10448dc82283b54e48.PNG\",\r\n                    \"title\": \"Capture\",\r\n                    \"location\": \"\",\r\n                    \"caption\": \"\",\r\n                    \"type\": \"image\\/png\",\r\n                    \"charset\": \"binary\",\r\n                    \"tags\": \"\",\r\n                    \"width\": 476,\r\n                    \"height\": 439,\r\n                    \"size\": 17543,\r\n                    \"embed_id\": null,\r\n                    \"user\": 1,\r\n                    \"date_uploaded\": \"2018-07-13T10:24:35-04:00\",\r\n                    \"storage_adapter\": \"local\",\r\n                    \"url\": \"\\/storage\\/uploads\\/dca9ee73d2b97a10448dc82283b54e48.PNG\",\r\n                    \"thumbnail_url\": \"\\/storage\\/uploads\\/thumbs\\/3.PNG\",\r\n                    \"old_thumbnail_url\": \"\\/storage\\/uploads\\/thumbs\\/dca9ee73d2b97a10448dc82283b54e48-PNG-160-160-true.jpg\",\r\n                    \"html\": null\r\n                }\r\n            },\r\n            \"category\": {\r\n                \"meta\": {\r\n                    \"table\": \"category\",\r\n                    \"type\": \"item\"\r\n                },\r\n                \"data\": {\r\n                    \"id\": 2,\r\n                    \"status\": 1,\r\n                    \"sort\": null,\r\n                    \"name\": \"Sports\",\r\n                    \"slug\": null\r\n                }\r\n            }\r\n        }\r\n    ]\r\n}\r\n```\r\nBut in case of other usergroup which requires access token column is hidden from endpoint\r\n\r\n## Steps to Reproduce\r\n 1. \r\n 2. \r\n 3. \r\n\r\n## Schema Dump, Logs, or Screenshots\r\n"},{"labels":["bug"],"text":"From directus created by [michaelbriordan](https://github.com/michaelbriordan) : directus/directus#2178  \n\n**For security issues, please email support@getdirectus.com directly.**\r\n\r\nTo help us resolve your issue more quickly, please use the following template:\r\n\r\nFor feature requests/voting please use the [Directus Request Tool](https://request.getdirectus.com/), or come chat with us through [getdirectus.com](http://getdirectus.com). Accepted feature requests will be added to GitHub Issues for assignment.\r\n\r\n## Version Info\r\n  - Directus version and branch (Or commit hash): 6.4.0\r\n  - PHP version: 7.1.9\r\n  - MySQL version: 10.1.31-MariaDB\r\n  - Web server: (Ex. Apache, nginx or IIS?) Apache 2.4.27\r\n  - OS name and version: CentOS Linux release 7.4.1708 (Core)\r\n\r\n## Expected Behavior\r\n\r\nHTTP/1.1 200 OK\r\nDate: Thu, 12 Jul 2018 13:21:17 GMT\r\nServer: CentOS WebPanel: Protected by Mod Security\r\nX-Powered-By: PHP/7.1.9\r\nCache-Control: no-store,no-cache,must-revalidate\r\nConnection: close\r\nTransfer-Encoding: chunked\r\nContent-Type: application/json; charset=utf-8\r\n\r\n{\"meta\":{\"table\":\"EDITIONS\",\"type\":\"item\"},\"data\":{\"id\":126,\"Year\":1603,\"Title\":\"... <etc>\r\n\r\n## Actual Behavior\r\n\r\n500 Internal Server Error\r\n\r\n## Steps to Reproduce\r\nCall API on multiple platforms. Tried Paw, browser, cURL and PHP (with/without Guzzle). \r\n\r\nThe HTTP request sent was:\r\nGET /api/1.1/tables/EDITIONS/rows?filters%5BDate%5D%5Beq%5D=1603 HTTP/1.1  \r\n# Paw automatically encodes '[' and ']' - I have tried it in the browser with '[' and ']'\r\nAuthorization: Basic * * * *\r\nCookie: PHPSESSID=dv2u2340v6ov96n4iri8biu39i\r\nHost: directus.michaelriordan.uk\r\nConnection: close\r\nUser-Agent: Paw/3.1.7 (Macintosh; OS X/10.13.5) GCDHTTPRequest\r\n\r\n## Schema Dump, Logs, or Screenshots\r\n\r\ntail apache error_log:\r\n[internal function]: Directus\\\\Database\\\\TableGateway\\\\RelationalTableGateway->processFilters(Object(Directus\\\\Database\\\\Query\\\\Builder), Array) in /home/mbr50/cms/directus/api/core/Directus/Database/TableGateway/RelationalTableGateway.php on line 1171\r\n"},{"labels":["bug"],"text":"From directus created by [bensteers](https://github.com/bensteers) : directus/directus#2177  \n\nWhen you go to a dashboard edit page, e.g. `/tables/[table]/1`, it tries to load all of the revisions into the right sidebar. But when I was dealing with #2176, our `directus_activity` table got to ~7 million records, so the pages just wouldn't load and they would hang on the Loading Data message. It wasn't until I dumped the directus_activity rows that I was able to use those pages again. I'd recommend limiting that query to something like ~100 revisions, just so that even if the directus_activity does explode, the app is still usable."},{"labels":["bug"],"text":"From directus created by [bensteers](https://github.com/bensteers) : directus/directus#2175  \n\n`?skip_activity_log=1` is not disabling activity logging for bulk row uploads.\r\n\r\n## Version Info\r\n- Directus version and branch (Or commit hash): 6.4.9\r\n- PHP version: 7.1.17\r\n- MySQL version: Ver 14.14 Distrib 5.5.60, for debian-linux-gnu (x86_64) using readline 6.3\r\n- OS name and version: Debian GNU/Linux 8 (jessie)\r\n\r\nI suspect that this is the needed update:\r\n```php\r\n// directus/api/core/Directus/Database/TableGateway/RelationalTableGateway.php, line 2018\r\n...\r\n// change\r\n    public function updateCollection($entries)\r\n    {\r\n        $entries = ArrayUtils::isNumericKeys($entries) ? $entries : [$entries];\r\n        foreach ($entries as $entry) {\r\n            $entry = $this->updateRecord($entry);\r\n            $entry->save();\r\n        }\r\n    }\r\n// to\r\n    public function updateCollection($entries)\r\n    {\r\n        $entries = ArrayUtils::isNumericKeys($entries) ? $entries : [$entries];\r\n        foreach ($entries as $entry) {\r\n            $entry = $this->updateRecord($entry, $this->getActivityMode());\r\n            $entry->save();\r\n        }\r\n    }\r\n...\r\n```\r\nI just haven't had a minute to test before submitting a pull request. \r\n"},{"labels":["bug"],"text":"Add an option to pick the project in use when using Directus API CLI.\r\n\r\nFor example:\r\n```\r\n$ bin/directus install:database --project test\r\n```"},{"labels":["bug",null],"text":"The slug value generated based on the value of another field should filter out invalid characters...e.g. the following is produced for a slug based on the \"business_name\" field...\r\n\r\nBusiness Name\r\nWhat is the name of your business\r\nFrank's Haircutting\r\n\r\nBusiness Slug\r\nfrank's-haircutting\r\n\r\n...the slug should be \"franks_haircutting\""},{"labels":["bug"],"text":"### The request\r\n![grafik](https://user-images.githubusercontent.com/22577866/47252147-ff890c80-d43f-11e8-8a34-365df3711ca5.png)\r\n\r\n\r\n### When using SMTP\r\n![grafik](https://user-images.githubusercontent.com/22577866/47252126-b89b1700-d43f-11e8-987b-2d75c026d7c3.png)\r\n\r\n\r\n### When using Sendmail\r\n![grafik](https://user-images.githubusercontent.com/22577866/47252121-97d2c180-d43f-11e8-9856-b46e392cacfe.png)\r\n\r\n"},{"labels":["bug"],"text":"**Describe the bug**\r\n`/interfaces` only returns interfaces in the `core` folder.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Duplicate a core interface (`/public/extensions/core/interfaces/text-input` to `/public/extensions/custom/interfaces/text-input`)\r\n2. Rename this folder (`text-input` -> `my-interface`)\r\n3. Fetch the interfaces from `/interfaces`\r\n4. See error\r\n\r\n**Expected behavior**\r\nThe custom interfaces should be returned too.\r\n"},{"labels":["bug",null],"text":"I upload an image, and then try to upload the same file again... and it gives an error (see below). If I change the file name and try again it works as expected."},{"labels":["bug"],"text":"**Describe the bug**\r\nNormal datetime values are returned in ISO format `yyyy-mm-ddThh:mm:ss+00:00`, however, default values for datetime are returned `yyyy-mm-dd hh:mm:ss`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Set a defaultvalue for a datetime field\r\n2. Retrieve the field information using /fields\r\n3. See error\r\n\r\n**Expected behavior**\r\nThe default value should be returned in the same format as regular values"},{"labels":["bug"],"text":"Requesting or Resetting a new password throws an error that says:\r\n\r\n```\r\nError: Call to a member function get() on array\r\n```"},{"labels":["bug"],"text":"Trying to send email to users' id throws a error that the users couldn't be found.\r\n\r\n```json\r\n{\r\n    \"error\": {\r\n        \"code\": 12,\r\n        \"message\": \"Unable to find some users\"\r\n    }\r\n}\r\n```"},{"labels":["bug",null],"text":"I am getting the wrong error code when trying to log in with a inactive user\r\n\r\n1. Log out\r\n2. Disable user (`draft`)\r\n3. Try to log in\r\n4. Get 104 error (should be 103)\r\n\r\nhttps://docs.directus.io/api/reference.html#error-codes\r\n\r\n![screen shot 2018-10-15 at 9 23 02 pm](https://user-images.githubusercontent.com/522079/46987133-c9a2fb80-d0c0-11e8-8d83-6186f2499ec0.png)\r\n\r\n\r\nRef: https://github.com/directus/app/issues/976"},{"labels":["bug"],"text":"Using the default mailer Directus throws an error because it doesn't extend from the Directus `Directus/Mail/AbstractTransport`\r\n\r\nWhile trying to log the error, there's another error trying to convert the instance (which is not a string) to an string.\r\n\r\n```\r\nCatchable fatal error: Object of class Swift_SendmailTransport could not be converted to string in /api/src/core/Directus/Mail/TransportManager.php on line 108\r\n```"},{"labels":["bug"],"text":"When working with a user in a non-admin role, there are many permission issues that arise. We need to update the default role permissions so that these don't occur.\r\n\r\n* `directus_user_roles` ‚Äì Error just after logging in\r\n* `directus_users` Error when trying to update `last_access`\r\n* `directus_activity` ‚Äì Error with \"mine\"\r\n\r\n\r\n```\r\n[2018-10-15 11:18:55] api[_].ERROR: Directus\\Permissions\\Exception\\ForbiddenCollectionReadException: Reading items from \"directus_user_roles\" collection was denied in /var/www/api/src/core/Directus/Permissions/Acl.php:944\r\n```\r\n\r\nThis one I couldn't fix through permissions:\r\n\r\n![screen shot 2018-10-15 at 11 30 40 am](https://user-images.githubusercontent.com/522079/46962391-01825280-d071-11e8-893d-3e24a1b41b93.png)\r\n"},{"labels":["bug",null,null],"text":"All activity logs are saved correctly in a UTC time, except authentication which the date time is saved in the future (4hrs).\r\n\r\nThe datetime value is changed by a hook, but the weird part is that it only seems to happens to authentication activity."},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen creating a new field, the API doesn't return the `datatype` field in the response object\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Create a new field by posting to /fields/:collection\r\n2. See error\r\n\r\n**Expected behavior**\r\nIt should return `datatype` too\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/9141017/46877365-b5d06e80-ce0e-11e8-8273-7d50a8be8613.png)\r\n"},{"labels":["bug"],"text":"The `sort` values in `/fields` are totally different from the ones nested in `/collections`."},{"labels":["bug"],"text":"I believe this is because it's pulling in relational data too, but there is an error when sorting by random:\r\n\r\n`\"sort\": \"?\"`\r\n\r\n```\r\n\"Failed generating the SQL query.\"\r\n\r\n\"SELECT `work`.`id` AS `id`, `work`.`id` AS `id`, `work`.`status` AS `status`, `work`.`sort` AS `sort`, `work`.`title` AS `title`, `work`.`client` AS `client`, `work`.`image` AS `image` FROM `work` WHERE `work`.`status` = 'published' AND `work`.`status` IN ('published', 'draft') ORDER BY `work`.`?` IS NULL, RAND(), `work`.`id` ASC LIMIT 24 OFFSET 0\"\r\n```"},{"labels":["bug"],"text":"There's a bug I haven't been able to identify exactly what's the problem, but it only happens when you have workflow enabled on permissions, and one of the status has not permission to read.\r\n\r\nIt returns an empty array because \"it can find the owner of the items\" even all permissions are `full` except one which is not `full`."},{"labels":["bug"],"text":"When trying to set the thumbnailer settings, the VARCHAR(255) for `value` max'ed out. We need to increase this to TEXT.\r\n\r\nRef: https://github.com/directus/api/issues/324"},{"labels":["bug"],"text":"`getItems` (plural) respects the `status_mapping.published`\r\n\r\n`getItem` (singular) **does not** respect the `status_mapping.published`\r\n\r\nWe need to be consistent, and I feel that the `getItem` needs to NOT return items that are un-published."},{"labels":["bug"],"text":"When creating a field with type `TEXT`, the API errors because it requires `length`. Providing `length` makes MySQL error because you can't set the length of a `TEXT` field."},{"labels":["bug"],"text":"Directus validate all input data except the related data.\r\n\r\nKnown bug: Adding a file to a related field doesn't validate the required fields.\r\n\r\nExample:\r\n\r\n`image` is a `file` type Field.\r\n```\r\n{\r\n  \"image\": {\"data\": \"<base64-content>\"}\r\n}\r\n```\r\n\r\nIt will throw an error trying to write a file with the name of \"\" (empty string)."},{"labels":["bug",null],"text":"**Describe the bug**\r\ncan't modify already existing table, because there aren't records in the `directus_fields` table.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Create a table directly in mysql.\r\n2. Go to Settings > Collections & Fields page\r\n3. Click the table that you have been created.\r\n4. Click the ID field and select Primary Key interface and next and save\r\n5. you will see the error.\r\n\r\n```json\r\n{\"error\":{\"code\":null,\"message\":\"SQLSTATE[42000]: Syntax error or access violation: 1068 Multiple primary key defined\",\"class\":\"PDOException\",\"file\":\"\\/var\\/www\\/vendor\\/zendframework\\/zend-db\\/src\\/Adapter\\/Driver\\/Pdo\\/Connection.php\",\"line\":379}}\r\n```\r\n\r\n**Expected behavior**\r\nShould be updated.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: [e.g. iOS]\r\n - Browser [e.g. chrome, safari]\r\n - Version [e.g. 22]\r\n\r\n**Smartphone (please complete the following information):**\r\n - Device: [e.g. iPhone6]\r\n - OS: [e.g. iOS8.1]\r\n - Browser [e.g. stock browser, safari]\r\n - Version [e.g. 22]\r\n\r\n**Additional context**\r\n\r\nI think this can be fix like this.\r\n\r\nwhen client request for collection details check the `directus_table` if there is not records for the table add default values based on column types.\r\n"},{"labels":["bug"],"text":"GET https://next.demo-api.directus.app/_/items/concessions?q=Twiz\r\n\r\nThere is an item named `Twizzlers` that should be returned... this doesn't seem to be working at all.\r\n\r\n![screen shot 2018-10-01 at 10 21 01 am](https://user-images.githubusercontent.com/522079/46294436-c73e8e80-c563-11e8-8a33-e8d59a2f5571.png)\r\n"},{"labels":["bug"],"text":"When a Collection's field has not record in `directus_fields`, its Directus' type is unknown. The API returns the database's type instead of the Directus' type.\r\n\r\nThe API now allows the user to provide the database's specific type together with the Directus' type, we need to map each database's type to a Directus' type.\r\n\r\nMySQL Example:\r\n\r\n- `text` -> `string`\r\n- `char` -> `string`\r\n- `integer` -> `integer`\r\n- `double` -> `decimal`"},{"labels":["bug"],"text":"All Fields must always be managed by Directus.\r\n\r\nWhen the fields is not \"managed\" it must add a record to `directus_fields` table."},{"labels":["bug",null],"text":"The API allows you to create field with a primary key, but there's not way to delete the primary key. To delete a constraint in MySQL, it requires the name of the constraint."},{"labels":["bug",null],"text":"If a non-alias field is changed to an alias type the column is dropped. There's a bug when the field exists (it has an actual column) and it's changed to an alias type the column is not dropped because it only checks for its type to be a non-alias instead to check fi the field is actual a non-alias.\r\n\r\nThe conclusion is to drop the column if exists when switching to an alias type even if the type already is an alias type."},{"labels":["bug"],"text":"A field with `file` as type should automatically set a Many to One relationship to `directus_files`.\r\n\r\nCurrently this is not happening."},{"labels":["bug"],"text":"**Describe the bug**\r\nFor some reason, `readonly` doesn't get cast to a boolean when retrieving the fields inside `/collections` as an o2m:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/45887005-90f55800-bd88-11e8-81b9-4c49bd4cfb17.png)\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/45887018-9fdc0a80-bd88-11e8-9ac8-aa079ae15239.png)\r\n\r\n"},{"labels":["bug"],"text":"At some point fields options are saved as string value `null` instead of `NULL` value in the database."},{"labels":["bug"],"text":"Updating an schema that already has primary key should be ignored.\r\n\r\nAn example:\r\n\r\nUpdating the primary key field note, requires to update the column comment in the MySQL, because it tries to add another primary key to the table (the same column). In this case this information should be ignored when it already has a primary key."},{"labels":["bug"],"text":"**Describe the bug**\r\n`PATCH` to `/fields` with this payload:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/45777372-9be2a800-bc23-11e8-8683-241007cb635e.png)\r\n\r\nresults in \r\n\r\n![image](https://user-images.githubusercontent.com/9141017/45777397-ac931e00-bc23-11e8-9326-b248d3c6734b.png)"},{"labels":["bug"],"text":"GET https://next.demo-api.directus.app/_/items/theaters?fields=*\r\n\r\nThis should return data and it does not.\r\n\r\n![screen shot 2018-09-10 at 2 50 51 pm](https://user-images.githubusercontent.com/522079/45317767-f172d280-b508-11e8-8fcb-484e7ba287c3.png)\r\n\r\n![screen shot 2018-09-10 at 2 51 32 pm](https://user-images.githubusercontent.com/522079/45317808-0cdddd80-b509-11e8-97ab-5376f7192cec.png)\r\n"},{"labels":["bug"],"text":"After creating a collection with an encrypted interface, when trying to create an item, adding an encrypted interface passes through, but a quick look at the database shows that the value is stored in plain text, regardless of which hashing method is selected during creation of the collection with the encrypted interface."},{"labels":["bug"],"text":"**Describe the bug**\r\nThe application should disable primary key fields that have auto-increment enabled. This is currently not possible as the API doesn't return the auto-increment information."},{"labels":["bug"],"text":"The status metadata uses the status name instead of the status key.\r\n\r\nUsing the status name instead of the key can lead to conflicts with other names, it isn't useful to use it to map with the its owner object.\r\n\r\nAlso it includes a `total_entries` property with the total value count, which also can lead to conflicts if for some reason a status is called `total_entries`."},{"labels":["bug"],"text":"Uploading files without extensions caused errors, because the directus files class expects all files to have an extension."},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen you have a wrong database name setup in your API's config,¬†the /server/ping endpoint crashes with a 500 internal server error. Switching the `env` to `development` shows that it's trying to use a wrong error class:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/44593307-07eeff00-a791-11e8-9254-1a962ce754c6.png)\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Change your API config to target a non-existing database\r\n2. Target /server/ping\r\n\r\n**Expected behavior**\r\nIt should return:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/44593418-471d5000-a791-11e8-9018-b2b090cfb781.png)\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 10 (using WAMP)\r\n - PHP: 5.6.35\r\n - Apache is 2.4.33\r\n\r\n**Additional context**\r\nIt _does_ work as expected on my local MAMP based installation.........\r\n"},{"labels":["bug",null,null],"text":"Our options should be:\r\n\r\n`uuid` (replaces the old hash)\r\n`original` (appends `*-n` as needed)\r\n`id` (padded with `0`)\r\n\r\nDo ya'll agree with using `uuid` as a file naming default? We _could_ use `original`, but I think `id` is the default right now... and we definitely shouldn't use that one."},{"labels":["bug"],"text":"**Describe the bug**\r\n\r\nThe Query Builder `orderBy` method does not support same column name more than once.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Request items and sort them by `-id` (PK) descending.\r\n\r\n**Expected behavior**\r\nItems to be sorted by `id` in descending order.\r\n"},{"labels":["bug"],"text":"When I edit a tags interface, I can't see the entered tags. This happens if I enter only one tag or if I try to enter many comma separated tags. \r\nIf I hit save all entered tags are saved correctly. They just aren't shown in edit mode.\r\n"},{"labels":["bug"],"text":"I can't upload files to a single file interface. There's no input to upload the field. \r\n\r\nTested locally and on next.directus.app with both apis. E.g. if you try to add a new item to the movie collection:\r\n\r\n![image](https://user-images.githubusercontent.com/41578219/44236558-a7b6f680-a1ad-11e8-800b-411b6d871a0b.png)\r\n\r\nTested on MacOS with Chrome. "},{"labels":["bug"],"text":"We should keep the auto-generating URL as we have it now:\r\n\r\n`http://local.api.com/thumbnail/_/100/100/crop/best/00000000006.jpg`\r\n\r\nBut we should add the ability to create/delete thumbnails from the API\r\n\r\nGET/DELETE `http://local.api.com/_/files/thumbnails/`"},{"labels":["bug"],"text":"A fresh installation gives a bunch of user permission errors.. ü§î "},{"labels":["bug"],"text":"`directus_users.status` has type `varchar`, which makes logging in impossible on newly installed instances."},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen sorting by another field than the primary key, the API will regularly return duplicate items when working with limit and offset. \r\n\r\n**To Reproduce**\r\n1. Query https://demo-api.directus.app/_/items/sales using a `sort` value of something else than `id`, for example `sort=status`. \r\n2. Notice how the response changes drastically when changing offset from 0 to 1.\r\n\r\n**Expected behavior**\r\nEvery value should have \"moved\" by 1 \"spot\":\r\n\r\nSuccessful query should be:\r\n\r\noffset = 0\r\n- 1\r\n- 2\r\n- 3\r\n\r\noffset = 2\r\n- 3\r\n- 4\r\n- 5\r\n\r\nWhich works as expected when querying for the primary key field:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/44093851-9ce3954a-9fa2-11e8-8518-5c4ecd19763d.png)\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/44093856-a1128590-9fa2-11e8-8f77-8edfb8eb4e88.png)\r\n\r\n**The problem**:\r\nAs soon as you start sorting by something else, this doesn't work anymore:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/44093960-e22c164a-9fa2-11e8-8a16-19ce92144d3d.png)\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/44093982-eb8b8748-9fa2-11e8-9d4a-3e22ace759fe.png)\r\n"},{"labels":["bug"],"text":"When updating a relational field (fe m2m), there's currently no way to see the updated value on a PATCH request, as the `fields` param is ignored."},{"labels":["bug"],"text":"![image](https://user-images.githubusercontent.com/9141017/43872264-e0ed6304-9b4e-11e8-9b1c-e351eadd53f0.png)\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/43872277-eed1e440-9b4e-11e8-8dc7-c2f6bc36065d.png)\r\n\r\nEven when fetching just the status that is allowed, the API returns a 403 forbidden:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/43872287-fd29bd06-9b4e-11e8-85ab-b18d35e54b14.png)\r\n\r\n"},{"labels":["bug"],"text":"Fetching fields through `/fields`\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/43860813-e7223406-9b22-11e8-9635-afeaea2159f8.png)\r\n\r\nFetching fields as O2M in `/collections`:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/43860801-d9e41020-9b22-11e8-93e7-1315d49b4f81.png)\r\n"},{"labels":["bug"],"text":"**Describe the bug**\r\nExample:\r\nWhen fetching users, we get the roles\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/43852237-b8c6e1e6-9b0a-11e8-8971-2ac072751188.png)\r\n\r\nThis is working as expected\r\nNow, if I want nested data I end up with a copy of the current user too:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/43852264-ca69198c-9b0a-11e8-9aa5-92eb411046e8.png)\r\n\r\nWhich is not really useful, seeing that I'm already _in_ the current user\r\n\r\nSo I thought I could use `fields=roles.role.*`\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/43852276-d07be232-9b0a-11e8-85a6-24186a75065d.png)\r\n\r\nBut that doesn't play nicely :disappointed:"},{"labels":["bug"],"text":"This means that every installation of directus uses the same admin token for the main admin user, therefore exposing every API 2 instances admin user. \r\n\r\nhttps://github.com/directus/api/blob/18ff98f66d5b174d9ae5aa6b902200a40d4f0ca8/src/core/Directus/Util/Installation/InstallerUtils.php#L198"},{"labels":["bug"],"text":"The file gets created with the correct name and extension, but remains empty (0 bytes) and has the mime type of `application/x-empty`. This is a problem only on my local machine, so it has to do with the specific setup..\r\n\r\n```\r\n<b>Notice</b>:  Undefined index: data in <b>/Users/rijkvanzanten/Development/api/src/core/Directus/Application/CoreServicesProvider.php</b> on line <b>276</b><br />\r\n```\r\n\r\n```\r\n~/Development/app [master]\r\n‚òõ  apachectl -v\r\nServer version: Apache/2.4.33 (Unix)\r\nServer built:   Mar 22 2018 01:24:46\r\n```\r\n\r\n```\r\n~/Development/app [master]\r\n‚òõ  php -v\r\nPHP 7.1.16 (cli) (built: Mar 31 2018 02:59:59) ( NTS )\r\nCopyright (c) 1997-2018 The PHP Group\r\nZend Engine v3.1.0, Copyright (c) 1998-2018 Zend Technologies\r\n``` \r\n\r\n```\r\n~/Development/app [master]\r\n‚òõ  php -m\r\n[PHP Modules]\r\nbcmath\r\nbz2\r\ncalendar\r\nCore\r\nctype\r\ncurl\r\ndate\r\ndba\r\ndom\r\nexif\r\nfileinfo\r\nfilter\r\nftp\r\ngd\r\nhash\r\niconv\r\njson\r\nldap\r\nlibxml\r\nmbstring\r\nmysqli\r\nmysqlnd\r\nopenssl\r\npcre\r\nPDO\r\npdo_mysql\r\npdo_pgsql\r\npdo_sqlite\r\npgsql\r\nPhar\r\nposix\r\nreadline\r\nReflection\r\nsession\r\nshmop\r\nSimpleXML\r\nsnmp\r\nsoap\r\nsockets\r\nSPL\r\nsqlite3\r\nstandard\r\nsysvmsg\r\nsysvsem\r\nsysvshm\r\ntidy\r\ntokenizer\r\nwddx\r\nxml\r\nxmlreader\r\nxmlrpc\r\nxmlwriter\r\nxsl\r\nzip\r\nzlib\r\n\r\n[Zend Modules]\r\n```"},{"labels":["bug",null],"text":"Instead, the server returns HTML:\r\n\r\n```html\r\n<br />\r\n<b>Warning</b>:  POST Content-Length of 35560409 bytes exceeds the limit of 8388608 bytes in <b>Unknown</b> on line <b>0</b><br />\r\n```"},{"labels":["bug"],"text":"Right now, the error for `The uploaded file exceeds max upload size that was specified on the server.` (code 301) uses HTTP status code `500 Internal Server Error`. This should be http status code `413 Payload Too Large`"},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen reverting to a single revision, it should revert to the full `data` of that item, instead of reverting just the fields that were changed (delta)."},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen reverting an item, f.e. `/items/members/1093/revert/3`, the API returns the data of item with id = 1 instead of id = 1093..\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Revert any item\r\n2. See bug\r\n\r\n**Expected behavior**\r\nIt should return the reverted item"},{"labels":["bug"],"text":"![screen shot 2018-07-27 at 6 00 51 pm](https://user-images.githubusercontent.com/522079/43348233-0dffd822-91c7-11e8-998f-40dad6cb392f.png)\r\n"},{"labels":["bug"],"text":"`Request header field Content-Type is not allowed by Access-Control-Allow-Headers in preflight response.`"},{"labels":["bug"],"text":"`Failed to load http://localhost/api/public/_/auth/sso: Request header field Content-Type is not allowed by Access-Control-Allow-Headers in preflight response.`\r\n\r\n"},{"labels":["bug"],"text":"There's issues when trying to use the API without the default configuration (not installed) from different origin."},{"labels":["bug"],"text":"The 404 makes the browser ignore the response body. That means there's no way to tell if the API is not installed or if the URL is wrong."},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen posting to `/_/auth/password/request`, the API returns a 500 internal server error\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Post to `https://next.demo-api.directus.app/_/auth/password/request` with the following body:\r\n\r\n```json\r\n{\r\n  \"email\": \"admin@example.com\"\r\n}\r\n```\r\n\r\n2. See error:\r\n\r\n```\r\n{\"error\":{\"code\":null,\"message\":\"Argument 3 passed to Directus\\\\Mail\\\\TransportManager::register() must be of the type array, string given, called in \\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/CoreServicesProvider.php on line 1032\",\"class\":\"TypeError\",\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Mail\\/TransportManager.php\",\"line\":35,\"trace\":[{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/CoreServicesProvider.php\",\"line\":1032,\"function\":\"register\",\"class\":\"Directus\\\\Mail\\\\TransportManager\",\"type\":\"->\",\"args\":[\"transport\",null,\"mail\"]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/pimple\\/pimple\\/src\\/Pimple\\/Container.php\",\"line\":118,\"function\":\"Directus\\\\Application\\\\{closure}\",\"class\":\"Directus\\\\Application\\\\CoreServicesProvider\",\"type\":\"->\",\"args\":[{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Container\\/Container.php\",\"line\":27,\"function\":\"offsetGet\",\"class\":\"Pimple\\\\Container\",\"type\":\"->\",\"args\":[\"mailer_transport\"]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/CoreServicesProvider.php\",\"line\":1045,\"function\":\"get\",\"class\":\"Directus\\\\Container\\\\Container\",\"type\":\"->\",\"args\":[\"mailer_transport\"]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/pimple\\/pimple\\/src\\/Pimple\\/Container.php\",\"line\":118,\"function\":\"Directus\\\\Application\\\\{closure}\",\"class\":\"Directus\\\\Application\\\\CoreServicesProvider\",\"type\":\"->\",\"args\":[{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Container\\/Container.php\",\"line\":27,\"function\":\"offsetGet\",\"class\":\"Pimple\\\\Container\",\"type\":\"->\",\"args\":[\"mailer\"]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/helpers\\/mail.php\",\"line\":23,\"function\":\"get\",\"class\":\"Directus\\\\Container\\\\Container\",\"type\":\"->\",\"args\":[\"mailer\"]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/helpers\\/mail.php\",\"line\":160,\"function\":\"Directus\\\\send_mail_with_template\",\"args\":[\"forgot-password.twig\",{\"reset_token\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MSwiZW1haWwiOiJhZG1pbkBleGFtcGxlLmNvbSIsImV4cCI6MTUzMjA4NDA3NCwidHlwZSI6InJlc2V0X3Bhc3N3b3JkIn0.1b7eLsIJkMtSmPWUtlxf2Mo_4jfWtVuFPpqBjOHUOkg\"},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/AuthService.php\",\"line\":329,\"function\":\"Directus\\\\send_forgot_password_email\",\"args\":[{\"id\":\"1\",\"status\":\"1\",\"first_name\":\"Admin\",\"last_name\":\"User\",\"email\":\"admin@example.com\",\"email_notifications\":\"1\",\"password\":\"$2y$10$RH460c4sDYy1B.KrueO6P.xWlMoTh033wWJVx7OX7OtaE47ZxotfW\",\"avatar\":null,\"company\":null,\"title\":null,\"locale\":\"en-US\",\"locale_options\":null,\"timezone\":\"America\\/New_York\",\"last_ip\":\"94.215.181.229\",\"last_login\":null,\"last_access\":\"2018-07-19 16:59:47\",\"last_page\":\"\\/interfaces\\/code\",\"token\":\"demo\",\"invite_token\":\"\",\"invite_accepted\":\"0\"},\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MSwiZW1haWwiOiJhZG1pbkBleGFtcGxlLmNvbSIsImV4cCI6MTUzMjA4NDA3NCwidHlwZSI6InJlc2V0X3Bhc3N3b3JkIn0.1b7eLsIJkMtSmPWUtlxf2Mo_4jfWtVuFPpqBjOHUOkg\"]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/endpoints\\/Auth.php\",\"line\":71,\"function\":\"sendResetPasswordToken\",\"class\":\"Directus\\\\Services\\\\AuthService\",\"type\":\"->\",\"args\":[\"admin@example.com\"]},{\"function\":\"forgotPassword\",\"class\":\"Directus\\\\Api\\\\Routes\\\\Auth\",\"type\":\"->\",\"args\":[{},{},{\"env\":\"_\"}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Handlers\\/Strategies\\/RequestResponse.php\",\"line\":41,\"function\":\"call_user_func\",\"args\":[[{},\"forgotPassword\"],{},{},{\"env\":\"_\"}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Route.php\",\"line\":335,\"function\":\"__invoke\",\"class\":\"Slim\\\\Handlers\\\\Strategies\\\\RequestResponse\",\"type\":\"->\",\"args\":[[{},\"forgotPassword\"],{},{},{\"env\":\"_\"}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":117,\"function\":\"__invoke\",\"class\":\"Slim\\\\Route\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Route.php\",\"line\":313,\"function\":\"callMiddlewareStack\",\"class\":\"Slim\\\\Route\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\"line\":513,\"function\":\"run\",\"class\":\"Slim\\\\Route\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/TableGatewayMiddleware.php\",\"line\":26,\"function\":\"__invoke\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\TableGatewayMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/AbstractRateLimitMiddleware.php\",\"line\":34,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\AbstractRateLimitMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/akrabat\\/rka-ip-address-middleware\\/src\\/IpAddress.php\",\"line\":93,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"RKA\\\\Middleware\\\\IpAddress\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/CorsMiddleware.php\",\"line\":20,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\CorsMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/ResponseCacheMiddleware.php\",\"line\":47,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\ResponseCacheMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":117,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\"line\":406,\"function\":\"callMiddlewareStack\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\"line\":314,\"function\":\"process\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Application.php\",\"line\":161,\"function\":\"run\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[false]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/public\\/index.php\",\"line\":5,\"function\":\"run\",\"class\":\"Directus\\\\Application\\\\Application\",\"type\":\"->\",\"args\":[]}]}}<br />\r\n<b>Warning</b>:  array_key_exists() expects parameter 2 to be array, string given in <b>/Users/rijkvanzanten/Development/api/src/core/Directus/Util/ArrayUtils.php</b> on line <b>92</b><br />\r\n```\r\n"},{"labels":["bug"],"text":"Trying to create a new collection from the app GUI spits a 422 error out a on the JS console with the message \"missing length for: id\"\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Open the Directus App\r\n2. Click on Admin Settings\r\n3. Click on Collections and Fields\r\n4. Click the Plus icon on the top right of the App\r\n5. Type in a name for the collection in the popped up modal and then click the create button\r\n6. Check the console to see the error \r\n\r\n**Expected behavior**\r\nI expected to click create and have a new collection be generated with the name I typed in\r\n\r\n**Screenshots**\r\n![screenshot 14](https://user-images.githubusercontent.com/19542804/42771514-7ceb2aa0-88f5-11e8-80ec-d346d88fc3fc.png)\r\n\r\n\r\n**Desktop (please complete the following information):**\r\n - Windows 10\r\n - Chrome\r\n - Version  67.0.3396.99 \r\n"},{"labels":["bug"],"text":"We cannot delete records in `directus_collections` through the API. DELETE to /collections not only deletes the row in `directus_collections`, but it also deletes the full collection in the database (by design!). This makes it impossible to use just the existence of the row in `directus_collections` as a `managed` state. To make it work, we should instead use a dedicated `managed` flag column in `directus_collections`"},{"labels":["bug"],"text":"![image](https://user-images.githubusercontent.com/9141017/42235928-8c3cb650-7ef9-11e8-92d4-eaa904cba8ba.png)\r\n\r\n¬øWhen uploading a file, it returns an error that the file couldn't be found?\r\n\r\nThe file itself has been uploaded though."},{"labels":["bug"],"text":"Existing tables that aren't in `directus_collections` should be returned with `managed` set to false"},{"labels":["bug"],"text":"Right now, the api returns all collections _including all fields_ when GETting `/collections`. It should only return the collections, and be able to nest the fields using a O2M relationship when requested through the `fields` parameter"},{"labels":["bug"],"text":"![image](https://user-images.githubusercontent.com/9141017/42221185-91f2b2f2-7ed1-11e8-97b2-9e629f22c6e5.png)\r\n\r\n\r\nIt always returns a 404, even if the item / collection combo exists"},{"labels":["bug",null],"text":"For example, in the `kiosks` table there are columns for `id`, `status`, `location`, and `theater`. However, `directus_fields` contains an additional row: `number`.\r\n\r\nThe API returns **all 5** of the rows from `directus_fields` on GET:\r\n\r\n```json\r\n{\r\n  \"data\": [\r\n    {\r\n      \"collection\": \"kiosks\",\r\n      \"field\": \"id\",\r\n      \"sort\": \"1\",\r\n      \"primary_key\": true,\r\n      \"default_value\": null,\r\n      \"note\": null,\r\n      \"signed\": false,\r\n      \"id\": 137,\r\n      \"type\": \"INT\",\r\n      \"managed\": true,\r\n      \"interface\": \"primary-key\",\r\n      \"hidden_input\": true,\r\n      \"hidden_list\": false,\r\n      \"required\": true,\r\n      \"options\": null,\r\n      \"locked\": false,\r\n      \"translation\": null,\r\n      \"readonly\": false,\r\n      \"view_width\": 4,\r\n      \"validation\": null,\r\n      \"group\": null\r\n    },\r\n    {\r\n      \"collection\": \"kiosks\",\r\n      \"field\": \"status\",\r\n      \"sort\": \"2\",\r\n      \"primary_key\": false,\r\n      \"default_value\": \"online\",\r\n      \"note\": null,\r\n      \"id\": 141,\r\n      \"type\": \"VARCHAR\",\r\n      \"managed\": true,\r\n      \"interface\": \"status\",\r\n      \"hidden_input\": false,\r\n      \"hidden_list\": false,\r\n      \"required\": false,\r\n      \"options\": {\r\n        \"status_mapping\": {\r\n          \"draft\": {\r\n            \"name\": \"Draft\"\r\n          },\r\n          \"offline\": {\r\n            \"name\": \"Offline\"\r\n          },\r\n          \"online\": {\r\n            \"name\": \"Online\"\r\n          }\r\n        }\r\n      },\r\n      \"locked\": false,\r\n      \"translation\": null,\r\n      \"readonly\": false,\r\n      \"view_width\": 4,\r\n      \"validation\": null,\r\n      \"group\": null,\r\n      \"signed\": null\r\n    },\r\n    {\r\n      \"collection\": \"kiosks\",\r\n      \"field\": \"location\",\r\n      \"sort\": \"3\",\r\n      \"primary_key\": false,\r\n      \"default_value\": null,\r\n      \"note\": null,\r\n      \"id\": 140,\r\n      \"type\": \"VARCHAR\",\r\n      \"managed\": true,\r\n      \"interface\": \"text-input\",\r\n      \"hidden_input\": false,\r\n      \"hidden_list\": false,\r\n      \"required\": false,\r\n      \"options\": null,\r\n      \"locked\": false,\r\n      \"translation\": null,\r\n      \"readonly\": false,\r\n      \"view_width\": 4,\r\n      \"validation\": null,\r\n      \"group\": null,\r\n      \"signed\": null\r\n    },\r\n    {\r\n      \"collection\": \"kiosks\",\r\n      \"field\": \"theater\",\r\n      \"sort\": null,\r\n      \"primary_key\": false,\r\n      \"default_value\": null,\r\n      \"note\": null,\r\n      \"id\": 138,\r\n      \"type\": \"M2O\",\r\n      \"managed\": true,\r\n      \"interface\": \"many-to-one\",\r\n      \"hidden_input\": false,\r\n      \"hidden_list\": false,\r\n      \"required\": false,\r\n      \"options\": {\r\n        \"template\": \"{{name}}\"\r\n      },\r\n      \"locked\": false,\r\n      \"translation\": null,\r\n      \"readonly\": false,\r\n      \"view_width\": 4,\r\n      \"validation\": null,\r\n      \"group\": null,\r\n      \"signed\": null\r\n    },\r\n    {\r\n      \"id\": 139,\r\n      \"collection\": \"kiosks\",\r\n      \"field\": \"number\",\r\n      \"type\": \"INT\",\r\n      \"interface\": \"numeric\",\r\n      \"options\": null,\r\n      \"locked\": false,\r\n      \"translation\": null,\r\n      \"readonly\": false,\r\n      \"required\": false,\r\n      \"sort\": null,\r\n      \"note\": null,\r\n      \"hidden_input\": false,\r\n      \"hidden_list\": false,\r\n      \"view_width\": 4,\r\n      \"group\": null,\r\n      \"validation\": null\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nHOWEVER, when trying to update the `number` field, the API throws an error, because it can't find the `number` column in the DB.\r\n\r\nIf a field _doesn't_ exist in the DB, but _it does_ in `directus_fields`, the API should ignore it."},{"labels":["bug"],"text":"Updating anything returns \r\n\r\n```\r\n{\"error\":{\"code\":null,\"message\":\"Argument 2 passed to Directus\\\\Services\\\\AbstractService::fetchItems() must be of the type array, null given, called in \\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/AbstractService.php on line 521\",\"class\":\"TypeError\",\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/AbstractService.php\",\"line\":534,\"trace\":[{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/AbstractService.php\",\"line\":521,\"function\":\"fetchItems\",\"class\":\"Directus\\\\Services\\\\AbstractService\",\"type\":\"->\",\"args\":[\"directus_collection_presets\",null,{\"id\":\"29\"}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/AbstractService.php\",\"line\":565,\"function\":\"fetchItem\",\"class\":\"Directus\\\\Services\\\\AbstractService\",\"type\":\"->\",\"args\":[\"directus_collection_presets\",\"29\",null,{\"id\":\"29\"}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/AbstractService.php\",\"line\":577,\"function\":\"itemExists\",\"class\":\"Directus\\\\Services\\\\AbstractService\",\"type\":\"->\",\"args\":[\"directus_collection_presets\",\"29\",[]]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/ItemsService.php\",\"line\":123,\"function\":\"checkItemExists\",\"class\":\"Directus\\\\Services\\\\AbstractService\",\"type\":\"->\",\"args\":[\"directus_collection_presets\",\"29\"]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/CollectionPresetsService.php\",\"line\":51,\"function\":\"update\",\"class\":\"Directus\\\\Services\\\\ItemsService\",\"type\":\"->\",\"args\":[\"directus_collection_presets\",\"29\",{\"view_options\":{\"tabular\":{\"widths\":{\"first_name\":191,\"last_name\":200,\"email\":200},\"spacing\":\"comfortable\"}}},[]]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/endpoints\\/CollectionPresets.php\",\"line\":89,\"function\":\"update\",\"class\":\"Directus\\\\Services\\\\CollectionPresetsService\",\"type\":\"->\",\"args\":[\"29\",{\"view_options\":{\"tabular\":{\"widths\":{\"first_name\":191,\"last_name\":200,\"email\":200},\"spacing\":\"comfortable\"}}},[]]},{\"function\":\"update\",\"class\":\"Directus\\\\Api\\\\Routes\\\\CollectionPresets\",\"type\":\"->\",\"args\":[{},{},{\"env\":\"_\",\"id\":\"29\"}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Handlers\\/Strategies\\/RequestResponse.php\",\"line\":41,\"function\":\"call_user_func\",\"args\":[[{},\"update\"],{},{},{\"env\":\"_\",\"id\":\"29\"}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Route.php\",\"line\":335,\"function\":\"__invoke\",\"class\":\"Slim\\\\Handlers\\\\Strategies\\\\RequestResponse\",\"type\":\"->\",\"args\":[[{},\"update\"],{},{},{\"env\":\"_\",\"id\":\"29\"}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/AbstractRateLimitMiddleware.php\",\"line\":34,\"function\":\"__invoke\",\"class\":\"Slim\\\\Route\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\AbstractRateLimitMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/AuthenticationMiddleware.php\",\"line\":71,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\Route\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\AuthenticationMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":117,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\Route\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Route.php\",\"line\":313,\"function\":\"callMiddlewareStack\",\"class\":\"Slim\\\\Route\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\"line\":513,\"function\":\"run\",\"class\":\"Slim\\\\Route\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/TableGatewayMiddleware.php\",\"line\":26,\"function\":\"__invoke\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\TableGatewayMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/AbstractRateLimitMiddleware.php\",\"line\":34,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\AbstractRateLimitMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/akrabat\\/rka-ip-address-middleware\\/src\\/IpAddress.php\",\"line\":93,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"RKA\\\\Middleware\\\\IpAddress\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/CorsMiddleware.php\",\"line\":20,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\CorsMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/ResponseCacheMiddleware.php\",\"line\":47,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"function\":\"__invoke\",\"class\":\"Directus\\\\Application\\\\Http\\\\Middleware\\\\ResponseCacheMiddleware\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\"line\":43,\"function\":\"call_user_func_array\",\"args\":[{},[{},{},{}]]},{\"function\":\"__invoke\",\"class\":\"Slim\\\\DeferredCallable\",\"type\":\"->\",\"args\":[{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":70,\"function\":\"call_user_func\",\"args\":[{},{},{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\"line\":117,\"function\":\"Slim\\\\{closure}\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\"line\":406,\"function\":\"callMiddlewareStack\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\"line\":314,\"function\":\"process\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[{},{}]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Application.php\",\"line\":161,\"function\":\"run\",\"class\":\"Slim\\\\App\",\"type\":\"->\",\"args\":[false]},{\"file\":\"\\/Users\\/rijkvanzanten\\/Development\\/api\\/public\\/index.php\",\"line\":5,\"function\":\"run\",\"class\":\"Directus\\\\Application\\\\Application\",\"type\":\"->\",\"args\":[]}]}}\r\n```\r\n\r\n@WellingGuzman marked this as closed in https://github.com/directus/api/issues/224, but I'm still seeing the same error"},{"labels":["bug"],"text":"**Describe the bug**\r\n`\"Payload fields: \"length\" does not exists in \"directus_fields\" collection.\"`\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Create a new field\r\n2. API returns above error\r\n\r\n**Expected behavior**\r\nIt should create the field. The `length` field should be used to set the length in MySQL"},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen a field has been set to type `ARRAY` and the value is `null`, the API returns `[\"\"]` (an array containing an empty string.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Add a row in the DB with an `array` field set to `null`:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/42123558-63cdf564-7c54-11e8-8275-3354065bf53a.png)\r\n\r\n2. Get that field from the API\r\n3. See problem\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/42123568-738cacc0-7c54-11e8-9fbe-9928cbad88f2.png)\r\n\r\n**Expected behavior**\r\nIt should instead return `[]` (a truly empty array).\r\n"},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen using the batch way of updating / posting items, it fails when only inserting one item.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. PATCH to `/permissions` with an array containing one item:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/42090794-084d2e14-7ba3-11e8-885f-ac8284552a57.png)\r\n\r\n2. See error\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/42090808-1a4b78a0-7ba3-11e8-8d5b-90f6fdeca86d.png)\r\n\r\n**Expected behavior**\r\nI expected the same thing to happen as on the stable API: it updates without erroring\r\n\r\n**Additional context**\r\nAPI latest: next.demo-api.directus.app\r\n\r\n<details>\r\n<summary>Full Error</summary>\r\n<pre>\r\n{\r\n  \"error\": {\r\n    \"code\": null,\r\n    \"message\": \"Argument 3 passed to Directus\\\\Services\\\\AbstractService::fetchItem() must be of the type array, null given, called in \\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Services\\/AbstractService.php on line 546\",\r\n    \"class\": \"TypeError\",\r\n    \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Services\\/AbstractService.php\",\r\n    \"line\": 514,\r\n    \"trace\": [\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Services\\/AbstractService.php\",\r\n        \"line\": 546,\r\n        \"function\": \"fetchItem\",\r\n        \"class\": \"Directus\\\\Services\\\\AbstractService\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          \"directus_permissions\",\r\n          10,\r\n          null,\r\n          []\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Services\\/AbstractService.php\",\r\n        \"line\": 558,\r\n        \"function\": \"itemExists\",\r\n        \"class\": \"Directus\\\\Services\\\\AbstractService\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          \"directus_permissions\",\r\n          10,\r\n          []\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Services\\/ItemsService.php\",\r\n        \"line\": 123,\r\n        \"function\": \"checkItemExists\",\r\n        \"class\": \"Directus\\\\Services\\\\AbstractService\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          \"directus_permissions\",\r\n          10\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Services\\/ItemsService.php\",\r\n        \"line\": 213,\r\n        \"function\": \"update\",\r\n        \"class\": \"Directus\\\\Services\\\\ItemsService\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          \"directus_permissions\",\r\n          10,\r\n          {\r\n            \"id\": 10,\r\n            \"read\": \"full\"\r\n          },\r\n          []\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Services\\/PermissionsService.php\",\r\n        \"line\": 93,\r\n        \"function\": \"batchUpdate\",\r\n        \"class\": \"Directus\\\\Services\\\\ItemsService\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          \"directus_permissions\",\r\n          [\r\n            {\r\n              \"id\": 10,\r\n              \"read\": \"full\"\r\n            }\r\n          ],\r\n          []\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/endpoints\\/Permissions.php\",\r\n        \"line\": 153,\r\n        \"function\": \"batchUpdate\",\r\n        \"class\": \"Directus\\\\Services\\\\PermissionsService\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          [\r\n            {\r\n              \"id\": 10,\r\n              \"read\": \"full\"\r\n            }\r\n          ],\r\n          []\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/endpoints\\/Permissions.php\",\r\n        \"line\": 75,\r\n        \"function\": \"batch\",\r\n        \"class\": \"Directus\\\\Api\\\\Routes\\\\Permissions\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"update\",\r\n        \"class\": \"Directus\\\\Api\\\\Routes\\\\Permissions\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {\r\n            \"env\": \"_\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/Handlers\\/Strategies\\/RequestResponse.php\",\r\n        \"line\": 41,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          [\r\n            {},\r\n            \"update\"\r\n          ],\r\n          {},\r\n          {},\r\n          {\r\n            \"env\": \"_\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/Route.php\",\r\n        \"line\": 335,\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\Handlers\\\\Strategies\\\\RequestResponse\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          [\r\n            {},\r\n            \"update\"\r\n          ],\r\n          {},\r\n          {},\r\n          {\r\n            \"env\": \"_\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/AbstractRateLimitMiddleware.php\",\r\n        \"line\": 34,\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\AbstractRateLimitMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/AuthenticationMiddleware.php\",\r\n        \"line\": 69,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\AuthenticationMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 117,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/Route.php\",\r\n        \"line\": 313,\r\n        \"function\": \"callMiddlewareStack\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\r\n        \"line\": 513,\r\n        \"function\": \"run\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/TableGatewayMiddleware.php\",\r\n        \"line\": 26,\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\TableGatewayMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/AbstractRateLimitMiddleware.php\",\r\n        \"line\": 34,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\AbstractRateLimitMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/akrabat\\/rka-ip-address-middleware\\/src\\/IpAddress.php\",\r\n        \"line\": 93,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"RKA\\\\Middleware\\\\IpAddress\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/CorsMiddleware.php\",\r\n        \"line\": 20,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\CorsMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/ResponseCacheMiddleware.php\",\r\n        \"line\": 47,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\ResponseCacheMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 117,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\r\n        \"line\": 406,\r\n        \"function\": \"callMiddlewareStack\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\r\n        \"line\": 314,\r\n        \"function\": \"process\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/src\\/core\\/Directus\\/Application\\/Application.php\",\r\n        \"line\": 161,\r\n        \"function\": \"run\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          false\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/var\\/www\\/api-next\\/public\\/index.php\",\r\n        \"line\": 5,\r\n        \"function\": \"run\",\r\n        \"class\": \"Directus\\\\Application\\\\Application\",\r\n        \"type\": \"->\",\r\n        \"args\": []\r\n      }\r\n    ]\r\n  }\r\n}\r\n</pre>\r\n</details>"},{"labels":["bug"],"text":"**Describe the bug**\r\nInstead of just the changes, the whole items is saved in `delta` in `directus_revisions`\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Change any item\r\n2. Checkout the `delta` field in `directus_revisions`\r\n\r\n**Expected behavior**\r\nIt should only save the .. delta\r\n"},{"labels":["bug",null],"text":"The API still returns alpha 1 as version in the API info. What controls this number in the API?"},{"labels":["bug"],"text":"**Describe the bug**\r\nSending a request to the API without the Content-Type header set to `application/json` throws a nasty 500 Internal Server Error. \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Send any request with Content-Type: text/plain\r\n2. See error\r\n\r\n**Expected behavior**\r\nI would've expected the API to return a 400 Bad Request error with an error message saying that the API only supports the content-type application/json header.\r\n\r\n**Additional Info**\r\n\r\n<details>\r\n<summary>Full error</summary>\r\n<pre>\r\n{\r\n  \"error\": {\r\n    \"code\": null,\r\n    \"message\": \"Argument 3 passed to Directus\\\\Services\\\\TablesService::changeColumn() must be of the type array, null given, called in \\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/endpoints\\/Fields.php on line 113\",\r\n    \"class\": \"TypeError\",\r\n    \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Services\\/TablesService.php\",\r\n    \"line\": 497,\r\n    \"trace\": [\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/endpoints\\/Fields.php\",\r\n        \"line\": 113,\r\n        \"function\": \"changeColumn\",\r\n        \"class\": \"Directus\\\\Services\\\\TablesService\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          \"members\",\r\n          null,\r\n          null,\r\n          {\r\n            \"access_token\": \"demo\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"update\",\r\n        \"class\": \"Directus\\\\Api\\\\Routes\\\\Fields\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {\r\n            \"env\": \"_\",\r\n            \"collection\": \"members\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Handlers\\/Strategies\\/RequestResponse.php\",\r\n        \"line\": 41,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          [\r\n            {},\r\n            \"update\"\r\n          ],\r\n          {},\r\n          {},\r\n          {\r\n            \"env\": \"_\",\r\n            \"collection\": \"members\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Route.php\",\r\n        \"line\": 335,\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\Handlers\\\\Strategies\\\\RequestResponse\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          [\r\n            {},\r\n            \"update\"\r\n          ],\r\n          {},\r\n          {},\r\n          {\r\n            \"env\": \"_\",\r\n            \"collection\": \"members\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/AuthenticationMiddleware.php\",\r\n        \"line\": 69,\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\AuthenticationMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 117,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/Route.php\",\r\n        \"line\": 313,\r\n        \"function\": \"callMiddlewareStack\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\r\n        \"line\": 513,\r\n        \"function\": \"run\",\r\n        \"class\": \"Slim\\\\Route\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/TableGatewayMiddleware.php\",\r\n        \"line\": 39,\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\TableGatewayMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/akrabat\\/rka-ip-address-middleware\\/src\\/IpAddress.php\",\r\n        \"line\": 93,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"RKA\\\\Middleware\\\\IpAddress\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/CorsMiddleware.php\",\r\n        \"line\": 20,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\CorsMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Http\\/Middleware\\/ResponseCacheMiddleware.php\",\r\n        \"line\": 47,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Directus\\\\Application\\\\Http\\\\Middleware\\\\ResponseCacheMiddleware\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/DeferredCallable.php\",\r\n        \"line\": 43,\r\n        \"function\": \"call_user_func_array\",\r\n        \"args\": [\r\n          {},\r\n          [\r\n            {},\r\n            {},\r\n            {}\r\n          ]\r\n        ]\r\n      },\r\n      {\r\n        \"function\": \"__invoke\",\r\n        \"class\": \"Slim\\\\DeferredCallable\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 70,\r\n        \"function\": \"call_user_func\",\r\n        \"args\": [\r\n          {},\r\n          {},\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/MiddlewareAwareTrait.php\",\r\n        \"line\": 117,\r\n        \"function\": \"Slim\\\\{closure}\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\r\n        \"line\": 406,\r\n        \"function\": \"callMiddlewareStack\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/vendor\\/slim\\/slim\\/Slim\\/App.php\",\r\n        \"line\": 314,\r\n        \"function\": \"process\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          {},\r\n          {}\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/core\\/Directus\\/Application\\/Application.php\",\r\n        \"line\": 154,\r\n        \"function\": \"run\",\r\n        \"class\": \"Slim\\\\App\",\r\n        \"type\": \"->\",\r\n        \"args\": [\r\n          false\r\n        ]\r\n      },\r\n      {\r\n        \"file\": \"\\/Users\\/rijkvanzanten\\/Development\\/api\\/public\\/index.php\",\r\n        \"line\": 5,\r\n        \"function\": \"run\",\r\n        \"class\": \"Directus\\\\Application\\\\Application\",\r\n        \"type\": \"->\",\r\n        \"args\": []\r\n      }\r\n    ]\r\n  }\r\n}\r\n</pre>\r\n</details>"},{"labels":["bug"],"text":"**Describe the bug**\r\nTrying to PATCH the /fields endpoint without providing a body throws a 500 error without an error code:\r\n```\r\n\"code\": null,\r\n\"message\": \"Argument 3 passed to Directus\\\\Services\\\\TablesService::changeColumn() must be of the type array, null given, called in \\/Users\\/rijkvanzanten\\/Development\\/api\\/src\\/endpoints\\/Fields.php on line 113\",\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. PATCH /fields without body\r\n2. See error\r\n\r\n**Expected behavior**\r\nI expected a 400 Bad Request error with an error message saying something along the lines of \"Missing body\"\r\n"},{"labels":["bug"],"text":"**Describe the bug**\r\nWhen `directus_collections` contains a collection that doesn't exist in the database, the API returns the following error:\r\n\r\n```\r\n{\"error\":{\"code\":200,\"message\":\"Unable to find collection: test0\",\"class\":\"...\r\n```\r\n\r\nThis error is returned with a 404 status code.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Add a row to `directus_collections` with a non-existing collection name\r\n2. Fetch the collections through the `/collections` endpoint\r\n3. See error\r\n\r\n**Expected behavior**\r\nI expected the API to return a 500 error\r\n"},{"labels":["bug"],"text":"I'm not able to create new fields. It seems to not accept JSON for the `options` field\r\n\r\n```\r\nPOST /fields/members\r\n\r\nbody:\r\n{\"sort\":null,\"field\":\"colores\",\"type\":\"VARCHAR\",\"interface\":\"color\",\"options\":{\"input\":\"rgb\",\"output\":\"hsl\"},\"readonly\":false,\"required\":false,\"unique\":false,\"note\":\"\",\"hidden_input\":false,\"hidden_list\":false,\"length\":30,\"default\":\"\",\"validation\":\"\"}\r\n\r\nresult:\r\n{\"error\":{\"code\":9,\"message\":\"Failed generating the SQL query.\",\"query\":\"INSERT INTO `directus_fields` (`collection`, `field`, `type`, `interface`, `required`, `sort`, `note`, `hidden_input`, `hidden_list`, `options`, `readonly`, `validation`) VALUES ('members', 'colores', 'VARCHAR', 'color', '', NULL, '', '', '', , '', '')\"}}<br />\r\n<b>Warning</b>:  PDO::quote() expects parameter 1 to be string, object given in <b>/var/www/api/vendor/zendframework/zend-db/src/Adapter/Platform/Mysql.php</b> on line <b>101</b><br />\r\n<br />\r\n<b>Warning</b>:  PDO::quote() expects parameter 1 to be string, object given in <b>/var/www/api/vendor/zendframework/zend-db/src/Adapter/Platform/Mysql.php</b> on line <b>101</b><br />\r\n\r\n```"},{"labels":["bug"],"text":"Fetching a non existing collection `GET /collections/rijk` returns:\r\n\r\n```js\r\n{\r\n  \"error\": {\r\n    \"code\": 203,\r\n    \"message\": \"Item with id \\\"rijk\\\" not found\"\r\n  }\r\n}\r\n```\r\n\r\nThis should be \"Collection 'rijk' not found\"\r\n\r\n\r\nBonus: Item with ~id~ **primary key** \\\"rijk\\\" not found"},{"labels":["bug"],"text":"If I create a collection (`POST /collections`), the returned item (the one I just created) doesn't have it's values converted according to the datatypes:\r\n\r\n```js\r\n// üò≠ üò± ‚ùåPOST https://demo-api.directus.app/_/collections\r\n\r\n{\r\n  \"data\": {\r\n    \"collection\": \"rijks-test\",\r\n    \"item_name_template\": null,\r\n    \"preview_url\": null,\r\n    \"hidden\": \"0\", // ‚ùå\r\n    \"translation\": null,\r\n    \"single\": \"0\", // ‚ùå\r\n    \"note\": null\r\n  }\r\n}\r\n\r\n// üëåüèª ‚úÖüéâ GET https://demo-api.directus.app/_/collections/rijks-test\r\n\r\n{\r\n  \"data\": {\r\n    \"collection\": \"rijks-test\",\r\n    \"item_name_template\": null,\r\n    \"preview_url\": null,\r\n    \"hidden\": false, // ‚úÖ\r\n    \"translation\": null,\r\n    \"single\": false, // ‚úÖ\r\n    \"note\": null\r\n  }\r\n}\r\n```"},{"labels":["bug"],"text":"For example, when setting the `hidden` field of a collection to `0` and trying to PATCH update another field, it throws:\r\n\r\n```js\r\n{code: 4, message: \"hidden: This value should not be blank.\"}\r\n```\r\n\r\nHidden already has a value `0` and thus shouldn't throw this error"},{"labels":["bug"],"text":"Calling the `/_/users/me` endpoint gives me the following response, which is an invalid JSON and cannot be parsed. There's some html warning being appended to the end.\r\nIt's probably going to be another MariaDB specific behaviour, but this shouldn't be happening normallyü§î.\r\nLet me know if you need anything else. \r\n\r\n```json\r\n{\r\n    \"data\": {\r\n        \"id\": 1,\r\n        \"status\": 1,\r\n        \"first_name\": \"Admin\",\r\n        \"last_name\": \"User\",\r\n        \"email\": \"admin@example.com\",\r\n        \"email_notifications\": true,\r\n        \"avatar\": null,\r\n        \"company\": null,\r\n        \"title\": null,\r\n        \"locale\": \"en-US\",\r\n        \"locale_options\": null,\r\n        \"timezone\": \"America\\/New_York\",\r\n        \"last_ip\": \"24.61.58.0\",\r\n        \"last_login\": null,\r\n        \"last_access\": \"2018-05-25T22:59:28+00:00\",\r\n        \"last_page\": \"\\/collections\\/members\",\r\n        \"token\": \"demo\",\r\n        \"invite_token\": \"\",\r\n        \"invite_accepted\": false\r\n    }\r\n}<br />\r\n<b>Warning</b>:  count(): Parameter must be an array or an object that implements Countable in <b>/Users/janbilek/Projects/directus-api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php</b> on line <b>1022</b><br />\r\n```\r\n![screen shot 2018-06-07 at 19 50 41](https://user-images.githubusercontent.com/7890555/41117029-343f2432-6a8c-11e8-9e01-26aaa4f88d26.png)\r\n\r\n**System information:**\r\n**OS**:     Mac OS 10.13.4\r\n**PHP:**   7.2.6\r\n**DB:**      MariaDB 10.2.9. (InnoDB)\r\n**SQL Mode:** `STRICT_TRANS_TABLES`, `ERROR_FOR_DIVISION_BY_ZERO`, `NO_AUTO_CREATE_USER`, `NO_ENGINE_SUBSTITUTION`  "},{"labels":["bug"],"text":"**Describe the bug**\r\nA user is able to create a collection where none of the fields are set as the primary key. This causes issues when the user attempts to do anything with the collection, such as retrieve the fields for the collection, because it throws an error stating that the table has no primary key.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior\r\n\r\n1. send a post request to `/collections?access_token=admin_token` with the body:\r\n\r\n```json\r\n{\r\n    \"collection\":\"test\",\r\n    \"single\":false,\r\n    \"hidden\": false,\r\n    \"note\":\"hello world\",\r\n    \"fields\":[\r\n        {\r\n            \"type\":\"integer\",\r\n            \"field\":\"field1\",\r\n            \"interface\":\"check\"\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\n2. send a get request to `/items/test1?access_token=admin_token`\r\n\r\n3. The response should contain `\"message\": \"This row object does not have a primary key column set.\"`\r\n\r\n**Expected behavior**\r\nIf the primary key is required, then I would expect to get a 400 when I attempt to create the collection. \r\n"},{"labels":["bug"],"text":"I found out there is a bug when using \"unprotected\" endpoints when there's not public group.\r\n\r\nWhat this actually does is block the API from authentication. Yikes!"},{"labels":["bug"],"text":"It saves the message, and an activity record saying the message was created.\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/40263016-de93da52-5ada-11e8-8bb2-cb76f5562e0e.png)\r\n\r\nIt also creates a revision record for the message:\r\n\r\n![image](https://user-images.githubusercontent.com/9141017/40263017-eb1994e2-5ada-11e8-92fd-3d1cfd7e0e64.png)\r\n\r\n"},{"labels":["bug"],"text":"When we revert a file data. Everything should change except for the `filename` field. As the filename may be different to the file is related to, unless the file naming is `file_id`"},{"labels":["bug"],"text":"<img width=\"1405\" alt=\"screen shot 2018-05-11 at 2 04 26 pm\" src=\"https://user-images.githubusercontent.com/9141017/39939419-39d65df2-5524-11e8-85aa-4222d66a0b10.png\">\r\n"},{"labels":["bug"],"text":"The API takes a solid `5550ms` to retrieve 1000 items. Even when fetching just the `id` field, it takes 4.5 seconds.\r\n\r\nQuerying the same data set in MySQL directly takes `8.8ms`. I don't know what the API is doing, but it's adding _a lot_ of latency üò¨"},{"labels":["bug"],"text":"We need a special endpoint to track the users last page / last online. This info is saved in `last_page`, `last_access`, and `last_ip`.\r\n\r\n``` \r\nPOST /_/users/tracking/page\r\n\r\n{\r\n  \"last_page\": \"/collections/projects\"\r\n}\r\n```\r\n\r\nThe API should add the `last_access` (date) and `last_ip` when saving this to `directus_users`.\r\n\r\nThis update **should skip directus_activity**, seeing the endpoint is going to be used every ~5 seconds"},{"labels":["bug"],"text":"The `delta` in directus_revisions always contains the primary key field, even when this value hasn't changed"},{"labels":["bug"],"text":"```\r\nFatal error: Class 'Directus\\Authentication\\Sso\\Provider\\GitHub\\Provider' not found in /var/www/directus-demo-api/src/core/Directus/Application/CoreServicesProvider.php on line 771\r\n```\r\n\r\nThis is on the live demo-api.getdirectus.com api "},{"labels":["bug",null],"text":"I just got `Failed to load https://api.directus.io/_/collection_presets/40: Method PATCH is not allowed by Access-Control-Allow-Methods in preflight response.`. Adding `Access-Control-Allow-Methods` with `GET,POST,PATCH,PUT,DELETE` as value fixes it."},{"labels":["bug"],"text":""},{"labels":["bug"],"text":"```\r\n> demo-api.getdirectus.com/_/files\r\n\r\n{\r\n    \"data\": [\r\n        {\r\n            \"id\": 1,\r\n            \"filename\": \"00000000001.jpg\",\r\n            \"title\": \"Mountain Range\",\r\n            \"description\": \"A gorgeous view of this wooded mountain range\",\r\n            \"location\": \"Earth\",\r\n            \"tags\": \"trees,rocks,nature,mountains,forest\",\r\n            \"width\": 1800,\r\n            \"height\": 1200,\r\n            \"filesize\": 602058,\r\n            \"duration\": null,\r\n            \"metadata\": null,\r\n            \"type\": \"image/jpeg\",\r\n            \"charset\": \"binary\",\r\n            \"embed\": null,\r\n            \"folder\": null,\r\n            \"upload_user\": 1,\r\n            \"upload_date\": \"2018-02-23T16:10:08-05:00\",\r\n            \"storage_adapter\": \"local\",\r\n            \"storage\": {\r\n                \"full_url\": \"https://demo-api.getdirectus.com/storage/uploads/00000000001.jpg\",\r\n                \"url\": \"/storage/uploads/00000000001.jpg\",\r\n                \"thumbnails\": [\r\n                    {\r\n                        \"full_url\": \"https://demo-api.getdirectus.com/thumbnail/200/200/crop/good/00000000001.jpg\",\r\n                        \"url\": \"https://demo-api.getdirectus.com/thumbnail/200/200/crop/good/00000000001.jpg\",\r\n                        \"dimension\": \"200x200\",\r\n                        \"width\": \"200\",\r\n                        \"height\": \"200\"\r\n                    }\r\n                ],\r\n                \"embed\": null\r\n            }\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\n```\r\n> demo-api.getdirectus.com/_/files?fields=*\r\n\r\n{\r\n    \"data\": [\r\n        []\r\n    ]\r\n}\r\n```\r\n\r\n```\r\n> demo-api.getdirectus.com/_/files?fields=*.*\r\n\r\n{\r\n    \"data\": [\r\n        []\r\n    ]\r\n}\r\n```\r\n"},{"labels":["bug"],"text":"The api is missing the storage in `public/storage` directory and its default image."},{"labels":["bug"],"text":"Fetching any items returns \r\n```json\r\n{\r\n    \"error\": {\r\n        \"code\": 0,\r\n        \"message\": \"\\\"projects\\\" collection status mapping is empty\",\r\n        \"class\": \"Directus\\\\Database\\\\Exception\\\\StatusMappingEmptyException\",\r\n        \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php\",\r\n        \"line\": 1597,\r\n        \"trace\": [\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php\",\r\n                \"line\": 1580,\r\n                \"function\": \"validateStatusMapping\",\r\n                \"class\": \"Directus\\\\Database\\\\TableGateway\\\\BaseTableGateway\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php\",\r\n                \"line\": 1544,\r\n                \"function\": \"getStatusMapping\",\r\n                \"class\": \"Directus\\\\Database\\\\TableGateway\\\\BaseTableGateway\",\r\n                \"type\": \"->\",\r\n                \"args\": []\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Database/TableGateway/BaseTableGateway.php\",\r\n                \"line\": 1531,\r\n                \"function\": \"getStatuses\",\r\n                \"class\": \"Directus\\\\Database\\\\TableGateway\\\\BaseTableGateway\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    \"published\"\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php\",\r\n                \"line\": 595,\r\n                \"function\": \"getPublishedStatuses\",\r\n                \"class\": \"Directus\\\\Database\\\\TableGateway\\\\BaseTableGateway\",\r\n                \"type\": \"->\",\r\n                \"args\": []\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php\",\r\n                \"line\": 820,\r\n                \"function\": \"applyDefaultEntriesSelectParams\",\r\n                \"class\": \"Directus\\\\Database\\\\TableGateway\\\\RelationalTableGateway\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    []\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Database/TableGateway/RelationalTableGateway.php\",\r\n                \"line\": 690,\r\n                \"function\": \"loadItems\",\r\n                \"class\": \"Directus\\\\Database\\\\TableGateway\\\\RelationalTableGateway\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    []\r\n                ]\r\n            },\r\n            {\r\n                \"function\": \"getItems\",\r\n                \"class\": \"Directus\\\\Database\\\\TableGateway\\\\RelationalTableGateway\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    [],\r\n                    null\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Services/AbstractService.php\",\r\n                \"line\": 272,\r\n                \"function\": \"call_user_func_array\",\r\n                \"args\": [\r\n                    [\r\n                        {\r\n                            \"primaryKeyFieldName\": \"id\",\r\n                            \"memcache\": null\r\n                        },\r\n                        \"getItems\"\r\n                    ],\r\n                    [\r\n                        [],\r\n                        null\r\n                    ]\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Services/AbstractService.php\",\r\n                \"line\": 237,\r\n                \"function\": \"getDataAndSetResponseCacheTags\",\r\n                \"class\": \"Directus\\\\Services\\\\AbstractService\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    [\r\n                        {\r\n                            \"primaryKeyFieldName\": \"id\",\r\n                            \"memcache\": null\r\n                        },\r\n                        \"getItems\"\r\n                    ],\r\n                    [\r\n                        [],\r\n                        null\r\n                    ]\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Services/ItemsService.php\",\r\n                \"line\": 48,\r\n                \"function\": \"getItemsAndSetResponseCacheTags\",\r\n                \"class\": \"Directus\\\\Services\\\\AbstractService\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {\r\n                        \"primaryKeyFieldName\": \"id\",\r\n                        \"memcache\": null\r\n                    },\r\n                    []\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/endpoints/Items.php\",\r\n                \"line\": 39,\r\n                \"function\": \"findAll\",\r\n                \"class\": \"Directus\\\\Services\\\\ItemsService\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    \"projects\",\r\n                    []\r\n                ]\r\n            },\r\n            {\r\n                \"function\": \"all\",\r\n                \"class\": \"Directus\\\\Api\\\\Routes\\\\Items\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {\r\n                        \"env\": \"_\",\r\n                        \"collection\": \"projects\"\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/Handlers/Strategies/RequestResponse.php\",\r\n                \"line\": 41,\r\n                \"function\": \"call_user_func\",\r\n                \"args\": [\r\n                    [\r\n                        {},\r\n                        \"all\"\r\n                    ],\r\n                    {},\r\n                    {},\r\n                    {\r\n                        \"env\": \"_\",\r\n                        \"collection\": \"projects\"\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/Route.php\",\r\n                \"line\": 335,\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"Slim\\\\Handlers\\\\Strategies\\\\RequestResponse\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    [\r\n                        {},\r\n                        \"all\"\r\n                    ],\r\n                    {},\r\n                    {},\r\n                    {\r\n                        \"env\": \"_\",\r\n                        \"collection\": \"projects\"\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php\",\r\n                \"line\": 117,\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"Slim\\\\Route\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/Route.php\",\r\n                \"line\": 313,\r\n                \"function\": \"callMiddlewareStack\",\r\n                \"class\": \"Slim\\\\Route\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/App.php\",\r\n                \"line\": 495,\r\n                \"function\": \"run\",\r\n                \"class\": \"Slim\\\\Route\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/akrabat/rka-ip-address-middleware/src/IpAddress.php\",\r\n                \"line\": 93,\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"Slim\\\\App\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"RKA\\\\Middleware\\\\IpAddress\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/DeferredCallable.php\",\r\n                \"line\": 43,\r\n                \"function\": \"call_user_func_array\",\r\n                \"args\": [\r\n                    {},\r\n                    [\r\n                        {},\r\n                        {},\r\n                        {}\r\n                    ]\r\n                ]\r\n            },\r\n            {\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"Slim\\\\DeferredCallable\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php\",\r\n                \"line\": 70,\r\n                \"function\": \"call_user_func\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Application/Http/Middlewares/AuthenticationMiddleware.php\",\r\n                \"line\": 113,\r\n                \"function\": \"Slim\\\\{closure}\",\r\n                \"class\": \"Slim\\\\App\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"Directus\\\\Application\\\\Http\\\\Middlewares\\\\AuthenticationMiddleware\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/DeferredCallable.php\",\r\n                \"line\": 43,\r\n                \"function\": \"call_user_func_array\",\r\n                \"args\": [\r\n                    {},\r\n                    [\r\n                        {},\r\n                        {},\r\n                        {}\r\n                    ]\r\n                ]\r\n            },\r\n            {\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"Slim\\\\DeferredCallable\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php\",\r\n                \"line\": 70,\r\n                \"function\": \"call_user_func\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Application/Http/Middlewares/CorsMiddleware.php\",\r\n                \"line\": 20,\r\n                \"function\": \"Slim\\\\{closure}\",\r\n                \"class\": \"Slim\\\\App\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"Directus\\\\Application\\\\Http\\\\Middlewares\\\\CorsMiddleware\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/DeferredCallable.php\",\r\n                \"line\": 43,\r\n                \"function\": \"call_user_func_array\",\r\n                \"args\": [\r\n                    {},\r\n                    [\r\n                        {},\r\n                        {},\r\n                        {}\r\n                    ]\r\n                ]\r\n            },\r\n            {\r\n                \"function\": \"__invoke\",\r\n                \"class\": \"Slim\\\\DeferredCallable\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php\",\r\n                \"line\": 70,\r\n                \"function\": \"call_user_func\",\r\n                \"args\": [\r\n                    {},\r\n                    {},\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/MiddlewareAwareTrait.php\",\r\n                \"line\": 117,\r\n                \"function\": \"Slim\\\\{closure}\",\r\n                \"class\": \"Slim\\\\App\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/App.php\",\r\n                \"line\": 388,\r\n                \"function\": \"callMiddlewareStack\",\r\n                \"class\": \"Slim\\\\App\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/vendor/slim/slim/Slim/App.php\",\r\n                \"line\": 296,\r\n                \"function\": \"process\",\r\n                \"class\": \"Slim\\\\App\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    {},\r\n                    {}\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/src/core/Directus/Application/Application.php\",\r\n                \"line\": 154,\r\n                \"function\": \"run\",\r\n                \"class\": \"Slim\\\\App\",\r\n                \"type\": \"->\",\r\n                \"args\": [\r\n                    false\r\n                ]\r\n            },\r\n            {\r\n                \"file\": \"/Users/rijkvanzanten/Development/api/public/index.php\",\r\n                \"line\": 5,\r\n                \"function\": \"run\",\r\n                \"class\": \"Directus\\\\Application\\\\Application\",\r\n                \"type\": \"->\",\r\n                \"args\": []\r\n            }\r\n        ]\r\n    }\r\n}\r\n```\r\n\r\neven with the status_mapping column `directus_collections.status` filled with the default:\r\n\r\n```json\r\n{\"active\":{\"name\":\"Active\",\"textColor\":\"#FFFFFF\",\"backgroundColor\":\"#3498DB\",\"subduedInListing\":false,\"showListingBadge\":false,\"hiddenGlobally\":false,\"hardDelete\":false,\"published\":true},\"draft\":{\"textColor\":\"#999999\",\"backgroundColor\":\"#EEEEEE\",\"subduedInListing\":true,\"showListingBadge\":true,\"hiddenGlobally\":false,\"hardDelete\":false,\"published\":false,\"translations\":{\"en-US\":\"Draft\",\"nl-NL\":\"Concept\"}},\"delete\":{\"textColor\":\"#FFFFFF\",\"backgroundColor\":\"#F44336\",\"subduedInListing\":true,\"showListingBadge\":true,\"hiddenGlobally\":true,\"hardDelete\":false,\"published\":false}}\r\n```"},{"labels":["bug"],"text":"For example `/thumbnail/200/200/crop/good/filename.jpg` returns \r\n\r\n```\r\n{\r\n    \"error\": {\r\n        \"error\": 8,\r\n        \"message\": \"API Environment Configuration Not Found: 200\"\r\n    }\r\n}\r\n```\r\n\r\nor `/storage/uploads/filename.jpg` returns \r\n\r\n```\r\n{\r\n    \"error\": {\r\n        \"error\": 8,\r\n        \"message\": \"API Environment Configuration Not Found: storage\"\r\n    }\r\n}"},{"labels":["bug"],"text":"`/_/users?fields=*.*`\r\n\r\nReturns\r\n\r\n```\r\n{\r\n    \"data\": [\r\n        {\r\n            \"id\": {\r\n                \"id\": 1,\r\n                \"status\": 1,\r\n                \"first_name\": \"Admin\",\r\n                \"last_name\": \"User\",\r\n                \"email\": \"demo@getdirectus.com\",\r\n                \"email_notifications\": true,\r\n                \"group\": 1,\r\n                \"avatar\": \"2\",\r\n                \"company\": null,\r\n                \"title\": null,\r\n                \"locale\": \"en-US\",\r\n                \"locale_options\": null,\r\n                \"timezone\": \"America/New_York\",\r\n                \"last_ip\": null,\r\n                \"last_login\": null,\r\n                \"last_access\": null,\r\n                \"last_page\": \"\",\r\n                \"token\": \"JVl4J0inbW6IqjNR8QzCPZ2nvP6b4fHM\",\r\n                \"invite_token\": \"\",\r\n                \"invite_accepted\": 0\r\n            },\r\n            \"status\": 1,\r\n            \"first_name\": \"Admin\",\r\n            \"last_name\": \"User\",\r\n            \"email\": \"demo@getdirectus.com\",\r\n            \"email_notifications\": true,\r\n            \"group\": 1,\r\n            \"avatar\": {\r\n                \"id\": 2,\r\n                \"filename\": \"29386209_1216971415099541_8182455277803536384_n.jpg\",\r\n                \"title\": \"29386209 1216971415099541 8182455277803536384 N\",\r\n                \"description\": \"Mooie foto van richard\",\r\n                \"location\": \"\",\r\n                \"tags\": \"\",\r\n                \"width\": 320,\r\n                \"height\": 320,\r\n                \"filesize\": 11977,\r\n                \"duration\": null,\r\n                \"metadata\": null,\r\n                \"type\": \"image/jpeg\",\r\n                \"charset\": \"binary\",\r\n                \"embed\": null,\r\n                \"folder\": null,\r\n                \"upload_user\": 1,\r\n                \"upload_date\": \"2018-04-06T17:01:59-04:00\",\r\n                \"storage_adapter\": \"local\",\r\n                \"url\": \"/storage/uploads/29386209_1216971415099541_8182455277803536384_n.jpg\",\r\n                \"thumbnail_url\": \"/storage/uploads/thumbs/2.jpg\",\r\n                \"old_thumbnail_url\": \"/storage/uploads/thumbs/29386209_1216971415099541_8182455277803536384_n-jpg-160-160-true.jpg\",\r\n                \"html\": null\r\n            },\r\n            \"company\": null,\r\n            \"title\": null,\r\n            \"locale\": \"en-US\",\r\n            \"locale_options\": null,\r\n            \"timezone\": \"America/New_York\",\r\n            \"last_ip\": null,\r\n            \"last_login\": null,\r\n            \"last_access\": null,\r\n            \"last_page\": \"\",\r\n            \"token\": \"JVl4J0inbW6IqjNR8QzCPZ2nvP6b4fHM\",\r\n            \"invite_token\": \"\",\r\n            \"invite_accepted\": 0\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\nNote how the ID field populates the same user _again_?"},{"labels":["bug"],"text":"The server returns a 505. I think it's because of the fact that directus_revisions doesn't get a parent item.  \r\n\r\n```\r\n\"Failed generating the SQL query. Statement could not be executed (23000 - 1048 - Column 'parent_item' cannot be null)\"\r\nquery\r\n:\r\n\"INSERT INTO `directus_revisions` (`activity`, `collection`, `item`, `data`, `delta`, `parent_item`, `parent_collection`, `parent_changed`) VALUES ('1319', 'directus_collection_presets', '14', '{\\\"id\\\":\\\"14\\\",\\\"title\\\":null,\\\"user\\\":\\\"1\\\",\\\"group\\\":\\\"1\\\",\\\"collection\\\":\\\"projects\\\",\\\"search_query\\\":\\\"\\\",\\\"filters\\\":null,\\\"view_options\\\":\\\"{\\\\\\\"tabular\\\\\\\":{\\\\\\\"spacing\\\\\\\":\\\\\\\"cozy\\\\\\\",\\\\\\\"widths\\\\\\\":{\\\\\\\"id\\\\\\\":78,\\\\\\\"featured_image\\\\\\\":121,\\\\\\\"status\\\\\\\":88,\\\\\\\"type\\\\\\\":180,\\\\\\\"name\\\\\\\":200,\\\\\\\"slug\\\\\\\":200,\\\\\\\"group\\\\\\\":200,\\\\\\\"info\\\\\\\":200}},\\\\\\\"tile\\\\\\\":{\\\\\\\"title\\\\\\\":\\\\\\\"name\\\\\\\",\\\\\\\"subtitle\\\\\\\":\\\\\\\"slug\\\\\\\",\\\\\\\"content\\\\\\\":\\\\\\\"name\\\\\\\"}}\\\",\\\"view_type\\\":\\\"tabular\\\",\\\"view_query\\\":\\\"{\\\\\\\"sort\\\\\\\":\\\\\\\"featured_image\\\\\\\"}\\\"}', '{\\\"view_query\\\":{\\\"sort\\\":\\\"featured_image\\\"},\\\"id\\\":\\\"14\\\"}', NULL, NULL, NULL)\"\r\ntrace\r\n:\r\n(32) [{‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}, {‚Ä¶}]\r\n__proto__\r\n:\r\nObject\r\n\r\n```"},{"labels":["bug"],"text":"Fetching items with related files items the \"extra\" url files are ignored"},{"labels":["bug",null],"text":"Updating a file record with a new image should replace the current file with the new one."}]