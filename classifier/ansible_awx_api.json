[{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIt seems as scheduled jobs can only be edited by the creating user, or by a user with admin rights to the template the job was scheduled from. \r\nWe create schedules of templates using a service user, and it would be nice to have the possibility to give other users with execute rights on the template the right to enable/disable these schedules or to edit them, without having to give them admin rights on the template."},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nExpose the value of \"Execution Node\" as a variable when running a job from Ansible Tower.\r\n\r\n**Example use-case:** Secret lookup which provides access token based on the execution node ip address "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Create GitHub Releases\r\n\r\n##### SUMMARY\r\nCurrently only tags are being created when a new version is out. GitHub releases would notify users about new versions and could also include a changelog. \r\n\r\nThis would keep users more informed about new releases and they will probably update faster. \r\n"},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Add support for composite variables in Workflow Surveys\r\n\r\n##### SUMMARY\r\nIt would be really nice to create composite variables when calling Workflows from other Workflows.\r\nIn the example below, OMGEVING is a variable defined in the parent Workflow, that should be usable in variable values of child flows.\r\nThis is a feature that is supported by Azure DevOps and proves to be very convenient in several use cases.\r\n\r\n![2020-09-08 18_56_09-Ansible AWX _ templates editWorkflowJobTemplate workflowMaker](https://user-images.githubusercontent.com/5285435/92508122-5cdf0000-f208-11ea-9d15-f8ba19140ce2.png)\r\n\r\n"},{"labels":["api",null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nFew organisation manages there credential using namespace, we should support that feature. Currently awx code/ui does not have option to pass namespace name, I did try. to fix locally on on env and it works!"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nFrish installed AWX 14.1.0 with demo project. The Demo Project is synchronized, the Demo Job Template runs without any problem. A schedule is created which should start Demo Job Template every minute 5 times. The job is started just once.\r\n\r\nI can't find any information in the logs. It looks like it starts once and that's ok.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 14.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.10\r\n* Operating System: CentOS 7\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd the schedule.\r\n\r\nThe defined schedule:\r\n\r\n```\r\n{\r\n  \"rrule\": \"DTSTART;TZID=Europe/Berlin:20200903T155000 RRULE:FREQ=MINUTELY;INTERVAL=1;COUNT=5\",\r\n  \"id\": 6,\r\n  \"type\": \"schedule\",\r\n  \"url\": \"/api/v2/schedules/6/\",\r\n  \"related\": {\r\n    \"created_by\": \"/api/v2/users/1/\",\r\n    \"modified_by\": \"/api/v2/users/1/\",\r\n    \"credentials\": \"/api/v2/schedules/6/credentials/\",\r\n    \"unified_jobs\": \"/api/v2/schedules/6/jobs/\",\r\n    \"unified_job_template\": \"/api/v2/job_templates/7/\",\r\n    \"project\": \"/api/v2/projects/6/\",\r\n    \"inventory\": \"/api/v2/inventories/1/\"\r\n  },\r\n  \"summary_fields\": {\r\n    \"unified_job_template\": {\r\n      \"id\": 7,\r\n      \"name\": \"Demo Job Template\",\r\n      \"description\": \"\",\r\n      \"unified_job_type\": \"job\"\r\n    },\r\n    \"created_by\": {\r\n      \"id\": 1,\r\n      \"username\": \"admin\",\r\n      \"first_name\": \"\",\r\n      \"last_name\": \"\"\r\n    },\r\n    \"modified_by\": {\r\n      \"id\": 1,\r\n      \"username\": \"admin\",\r\n      \"first_name\": \"\",\r\n      \"last_name\": \"\"\r\n    },\r\n    \"user_capabilities\": {\r\n      \"edit\": true,\r\n      \"delete\": true\r\n    },\r\n    \"inventory\": {\r\n      \"id\": 1,\r\n      \"name\": \"Demo Inventory\",\r\n      \"description\": \"\",\r\n      \"has_active_failures\": false,\r\n      \"total_hosts\": 1,\r\n      \"hosts_with_active_failures\": 0,\r\n      \"total_groups\": 0,\r\n      \"has_inventory_sources\": false,\r\n      \"total_inventory_sources\": 0,\r\n      \"inventory_sources_with_failures\": 0,\r\n      \"organization_id\": 1,\r\n      \"kind\": \"\",\r\n      \"insights_credential_id\": null\r\n    }\r\n  },\r\n  \"created\": \"2020-09-03T13:49:01.947731Z\",\r\n  \"modified\": \"2020-09-03T13:49:01.947738Z\",\r\n  \"name\": \"test\",\r\n  \"description\": \"\",\r\n  \"extra_data\": {},\r\n  \"inventory\": null,\r\n  \"scm_branch\": null,\r\n  \"job_type\": null,\r\n  \"job_tags\": null,\r\n  \"skip_tags\": null,\r\n  \"limit\": null,\r\n  \"diff_mode\": null,\r\n  \"verbosity\": null,\r\n  \"unified_job_template\": 7,\r\n  \"enabled\": true,\r\n  \"dtstart\": \"2020-08-27T13:50:00Z\",\r\n  \"dtend\": \"2020-08-27T13:54:00Z\",\r\n  \"next_run\": null,\r\n  \"timezone\": \"Europe/Berlin\",\r\n  \"until\": \"\"\r\n}\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe job is executed 5 times.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe job is executed just once.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nJobs output:\r\n\r\n```\r\n{\r\n  \"count\": 1,\r\n  \"next\": null,\r\n  \"previous\": null,\r\n  \"results\": [\r\n    {\r\n      \"id\": 4,\r\n      \"type\": \"job\",\r\n      \"url\": \"/api/v2/jobs/4/\",\r\n      \"related\": {\r\n        \"labels\": \"/api/v2/jobs/4/labels/\",\r\n        \"inventory\": \"/api/v2/inventories/1/\",\r\n        \"project\": \"/api/v2/projects/6/\",\r\n        \"organization\": \"/api/v2/organizations/1/\",\r\n        \"credentials\": \"/api/v2/jobs/4/credentials/\",\r\n        \"unified_job_template\": \"/api/v2/job_templates/7/\",\r\n        \"schedule\": \"/api/v2/schedules/6/\",\r\n        \"stdout\": \"/api/v2/jobs/4/stdout/\",\r\n        \"job_events\": \"/api/v2/jobs/4/job_events/\",\r\n        \"job_host_summaries\": \"/api/v2/jobs/4/job_host_summaries/\",\r\n        \"activity_stream\": \"/api/v2/jobs/4/activity_stream/\",\r\n        \"notifications\": \"/api/v2/jobs/4/notifications/\",\r\n        \"create_schedule\": \"/api/v2/jobs/4/create_schedule/\",\r\n        \"job_template\": \"/api/v2/job_templates/7/\",\r\n        \"cancel\": \"/api/v2/jobs/4/cancel/\",\r\n        \"relaunch\": \"/api/v2/jobs/4/relaunch/\"\r\n      },\r\n      \"summary_fields\": {\r\n        \"organization\": {\r\n          \"id\": 1,\r\n          \"name\": \"Default\",\r\n          \"description\": \"\"\r\n        },\r\n        \"inventory\": {\r\n          \"id\": 1,\r\n          \"name\": \"Demo Inventory\",\r\n          \"description\": \"\",\r\n          \"has_active_failures\": false,\r\n          \"total_hosts\": 1,\r\n          \"hosts_with_active_failures\": 0,\r\n          \"total_groups\": 0,\r\n          \"has_inventory_sources\": false,\r\n          \"total_inventory_sources\": 0,\r\n          \"inventory_sources_with_failures\": 0,\r\n          \"organization_id\": 1,\r\n          \"kind\": \"\"\r\n        },\r\n        \"project\": {\r\n          \"id\": 6,\r\n          \"name\": \"Demo Project\",\r\n          \"description\": \"\",\r\n          \"status\": \"successful\",\r\n          \"scm_type\": \"git\"\r\n        },\r\n        \"job_template\": {\r\n          \"id\": 7,\r\n          \"name\": \"Demo Job Template\",\r\n          \"description\": \"\"\r\n        },\r\n        \"schedule\": {\r\n          \"id\": 6,\r\n          \"name\": \"test\",\r\n          \"description\": \"\"\r\n        },\r\n        \"unified_job_template\": {\r\n          \"id\": 7,\r\n          \"name\": \"Demo Job Template\",\r\n          \"description\": \"\",\r\n          \"unified_job_type\": \"job\"\r\n        },\r\n        \"instance_group\": {\r\n          \"id\": 1,\r\n          \"name\": \"tower\",\r\n          \"is_containerized\": false\r\n        },\r\n        \"user_capabilities\": {\r\n          \"delete\": true,\r\n          \"start\": true\r\n        },\r\n        \"labels\": {\r\n          \"count\": 0,\r\n          \"results\": []\r\n        },\r\n        \"credentials\": [\r\n          {\r\n            \"id\": 1,\r\n            \"name\": \"Demo Credential\",\r\n            \"description\": \"\",\r\n            \"kind\": \"ssh\",\r\n            \"cloud\": false\r\n          }\r\n        ]\r\n      },\r\n      \"created\": \"2020-09-03T13:50:08.938226Z\",\r\n      \"modified\": \"2020-09-03T13:50:15.029052Z\",\r\n      \"name\": \"Demo Job Template\",\r\n      \"description\": \"\",\r\n      \"unified_job_template\": 7,\r\n      \"launch_type\": \"scheduled\",\r\n      \"status\": \"successful\",\r\n      \"failed\": false,\r\n      \"started\": \"2020-09-03T13:50:15.217321Z\",\r\n      \"finished\": \"2020-09-03T13:50:18.783942Z\",\r\n      \"canceled_on\": null,\r\n      \"elapsed\": 3.567,\r\n      \"job_explanation\": \"\",\r\n      \"execution_node\": \"awx\",\r\n      \"controller_node\": \"\",\r\n      \"job_type\": \"run\",\r\n      \"inventory\": 1,\r\n      \"project\": 6,\r\n      \"playbook\": \"hello_world.yml\",\r\n      \"scm_branch\": \"\",\r\n      \"forks\": 0,\r\n      \"limit\": \"\",\r\n      \"verbosity\": 0,\r\n      \"extra_vars\": \"{}\",\r\n      \"job_tags\": \"\",\r\n      \"force_handlers\": false,\r\n      \"skip_tags\": \"\",\r\n      \"start_at_task\": \"\",\r\n      \"timeout\": 0,\r\n      \"use_fact_cache\": false,\r\n      \"organization\": 1,\r\n      \"job_template\": 7,\r\n      \"passwords_needed_to_start\": [],\r\n      \"allow_simultaneous\": false,\r\n      \"artifacts\": {},\r\n      \"scm_revision\": \"347e44fea036c94d5f60e544de006453ee5c71ad\",\r\n      \"instance_group\": 1,\r\n      \"diff_mode\": false,\r\n      \"job_slice_number\": 0,\r\n      \"job_slice_count\": 1,\r\n      \"webhook_service\": \"\",\r\n      \"webhook_credential\": null,\r\n      \"webhook_guid\": \"\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n"},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCurrently, Tower doesn't provide the ability to tag logs from the UI as syslog does.\r\n\r\nhttps://www.rsyslog.com/doc/v8-stable/configuration/templates.html#generating-json\r\n\r\nIt could be great to have this possibility from the logger configuration screen.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - RFE\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nTower lacks of some intermediate modify role between read and admin and this is applicable for all kind of objects in tower - projects, credentials, inventories.\r\n\r\nNext higher level after read role is an admin. Admin has rights to grant permissions to other users up to admin level. Admin must be so powerful for sure, but current RBAC model really lacks modify role without ability to change permissions. With current  model is very problematic or impossible to design permission scheme with different roles, like operators who uses (operates with) playbooks, and developers, who creates and tests new playbooks.\r\n\r\nWe want that some users would be able to modify, for example, projects, but want to have control over permission granting for critical objects like project or credentials. Granting admin role for each user, who just needs modify permissions is excess.\r\n\r\n"},{"labels":["api",null,null,null],"text":"\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nAzure DevOps has code hosting, with its own webhook mechanism. It would be useful if AWX et al supported this.\r\n\r\nhttps://docs.microsoft.com/en-us/azure/devops/service-hooks/services/webhooks?view=azure-devops\r\n\r\n"},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAdd a workflow_job_id_trace array in job events.\r\n\r\nRelated to issue  #3770\r\n\r\nReason: \r\nThere is currently no way of eficiently keeping tracks of job events emitted within nested workflows (workflow_job_id is replaced by last workflow).\r\n\r\nDescription:\r\nThe idea is to define an array within job events in which each workflow will append its ID so that down the line we have an array of ids of workflows responsible for the launch of any given job events. This allows a much clearer view of workflows executions within each other.\r\n\r\nExample:\r\n```json\r\n{\r\n  \"job_event\": {\r\n    \"job\": 44,\r\n    \"workflow_job_id\": 43,\r\n    \"workflow_job_id_trace\": [41, 42, 43],\r\n    . . .\r\n  }\r\n}\r\n```\r\nBy just adding this array we now know that this job event was launched through the execution of workflow job 41 which launched the workflow job 42 which launched the workflow 43 which finally launched the job 44.\r\n\r\nAlternative:\r\nIf this feature is too complex to implement I guess that adding just the \"initiator\" workflow job id would already be great because the current properties of job events does not permit to know the \"initiator\" of a job (in case of nested workflow).\r\n```json\r\n{\r\n  \"job_event\": {\r\n    \"job\": 44,\r\n    \"workflow_job_id\": 43,\r\n    \"workflow_initiator_job_id_\": 41,\r\n    . . .\r\n  }\r\n}\r\n```\r\nThis allows us to group job events by initiator which should be good enough for most people.\r\n\r\nPassing an integer down the nested workflows might be just as difficult as an array so it would be better to go with the array so there won't be any related issues in the future."},{"labels":["api",null,null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nThe feature should allow all jobs related to specified job template be exempt from the removal of job history in Ansible Tower.\r\n"},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nrunning the `package_facts` module on a given host does not update the facts for that host.\r\n\r\nUnsure, but this might be applicable to other `*_facts` modules like `ios_facts` as well.\r\n"},{"labels":["api",null,null,null],"text":"\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUnable to set region of GovCloud us east; \r\nus-gov-east-1\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 14.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.11\r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nClick \\ Inventories \\ sources \\ Amazon EC2 \\ Regions drop down does not have a US-EAST (GovCloud)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expected it would have this option\r\n\r\n---\r\n\r\nI also cannot find any workaround. If I would set it to all it would fail \r\n\r\n    1.872 INFO     Updating inventory 2: test-east-us-gov\r\n    2.272 INFO     Reading Ansible inventory source: /tmp/awx_8_bny8y3fg/aws_ec2.yml\r\n    2.274 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    2.275 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    2.275 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 154, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1149, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1039, in handle\r\n    venv_path=venv_path, verbosity=self.verbosity).load()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 215, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 198, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nansible-inventory 2.9.11\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible-inventory\r\n  python version = 3.6.8 (default, Apr 16 2020, 01:36:27) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n[WARNING]:  * Failed to parse /tmp/awx_8_bny8y3fg/aws_ec2.yml with auto plugin:\r\nCould not connect to the endpoint URL: \"https://ec2.us-east-1.amazonaws.com/\"\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 280\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"1.  Create an inventory w/ 25+ (local connection) hosts.\r\n2.  Run this playbook w/ a 100MB artifact file for `set_stats`:\r\n\r\n```yaml\r\n---\r\n- hosts: all\r\n  connection: local\r\n  tasks:\r\n  - set_stats:\r\n      data:\r\n        random_data: \"{{ lookup('file', 'random_data.txt') }}\"\r\n    delegate_to: localhost\r\n```\r\n\r\n```shell\r\nbash-4.4$ base64 /dev/urandom | head -c 100000000 > random_data.txt\r\nbash-4.4$ du -h random_data.txt\r\n96M\trandom_data.txt\r\n```\r\n\r\n3.  Go to `/api/v2/inventories/N/hosts/`\r\n4.  Become very, very sad:\r\n\r\n<img width=\"372\" alt=\"image\" src=\"https://user-images.githubusercontent.com/214912/91335777-e15c6800-e79e-11ea-8d52-f29c2efdbcf4.png\">\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nA customer would like to give individual technical teams the ability to create smart inventories, limiting the source pool to the hosts that they are supposed to see. A simplified example could be \"team windows manages all the windows hosts and should not see any linux or aix\".\r\n\r\nThe only permission currently available to unprivileged user is \"inventory admin\", but while this allows them to create smart inventories, it also allows them to create arbitrary inventories and this is an undesired side effect.\r\nThe alternative would be to not give users this permission, which would force them to limit host exclusively by name or group which becomes prohibitive on their scale of thousands of target hosts. Being able to group target hosts by their characteristics as is done with smart inventories is an essential feature for them.\r\n\r\nA possible solution could be to split the \"inventory admin\" role into two - \"regular\" inventory and smart inventory admin"},{"labels":["api",null,null,null],"text":"Not an issue with current awx, as I don't believe we attempt to prefetch `instance_groups` anywhere in the codebase, but I wanted to document my findings for this as prefetching is used heavily in general.\r\n\r\n**why it's needed**\r\n.prefetch_related() is important for reducing database hits. In this case, if we want to grab instance_groups associated with organization _per job_, and there are thousands of jobs, then prefetching `instance_groups` would be straightforward optimization.\r\n\r\n**the issue**\r\ne.g. `Organization.objects.all().prefetch_related('instance_groups`)` does not work\r\n\r\nThe reason why is our custom [`OrderedManyToManyDescriptor`](https://github.com/ansible/awx/blob/2a824fc1d5b5ca48eeff8bf33998c8d909287d0e/awx/main/fields.py#L1024)\r\n\r\n```python\r\ndef get_queryset(self):\r\n    return super(OrderedManyRelatedManager, self).get_queryset().order_by(\r\n        '%s__position' % self.through._meta.model_name\r\n    )\r\n```\r\n\r\nif I get rid of the `.order_by..` filter from the query, `instance_groups` is prefetched as expected.\r\n\r\nfrom Django docs\r\n\r\n> Remember that, as always with QuerySets, any subsequent chained methods which imply a different database query will ignore previously cached results, and retrieve data using a fresh database query.\r\n\r\nI believe that is what is going on when we add the `.order_by..` filter.\r\n\r\n**test setup**\r\nI have 60 Jobs in the database,\r\n\r\n```python\r\np = Job.objects.select_related(\"organization\").prefetch_related(\"organization__instance_groups\")\r\nfor i in p:\r\n    H = [x for x in i.organization.instance_groups.all()]\r\n```\r\n\r\nWithout commenting out `.order_by..`\r\nNumber of Queries : 63\r\n\r\nCommenting out `.order_by..`\r\nNumber of Queries : 3"},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAble to restrict the view permission for the activity stream. Only an administration can see the complete activity stream. Other users can see actions from their team, but not from other teams, orgs or admins.\r\n"},{"labels":["api",null,null,null,null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nOur development teams use a software development lifecycle process that builds a versioned artifact for the final product. This process has been extended to the development of Ansible projects, which include the roles, modules, plugins, and playbooks required for the project's goals. The build process produces an immutable artifact in [Artifactory](https://jfrog.com/artifactory/), and our users need to be able to pull that artifact into AWX instead of pulling it from the git repository used in development. \r\n\r\nA generic feature to pull archives from a remote URL would fill this use case, as well as other use cases, such as [GitHub Releases](https://github.com/philipsd6/test-playbook/releases)\r\n\r\nFrom the UI perspective, all that is necessary for this SCM type is the SCM URL field, as there is no generic concept of branch/ref spec/version for artifact URLs. \r\n\r\nTo kick off this discussion, PR #7911 implements the feature as I envision it for general use."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThis has merged in Ansible core:\r\n\r\nhttps://github.com/ansible/ansible/pull/70970\r\n\r\nStarting with Ansible 2.11 it will be possible to supply `--extra-vars` to `ansible-inventory`, so credential types that define extra vars in their injector configuration should apply those to inventory updates. That is avoided now via:\r\n\r\nhttps://github.com/ansible/awx/blob/d0ac02826537343880b09282666639cf5135779c/awx/main/models/credential/__init__.py#L546\r\n"},{"labels":["api",null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Deprecation\r\n\r\nMark mercurial project updates as deprecated, to be removed in a future release\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nWarning should probably be displayed during project updates of mercurial sourced projects, not sure where else\r\n"},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen browsing credential type data via the REST API, i.e. /api/v2/credential_types/, the injector configuration is blank on many ( but not all) credential types. This appears to be inconsistent with the documentation for these credential types\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n* AWX install method: rancher\r\n* Ansible version:  2.9\r\n* Operating System: Oracle Linux 7.8\r\n* Web Browser: Chrome 84.0.4147.89\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\naccess awx server REST API with admin account to view credential types:  <server>/api/v2/credential_types/\r\n\r\nview the credential types for 'Amazon Web Services' (id:5) and 'Ansible Tower' (id:16). Note the data for the injectors property is an empty dictionary for 'Amazon Web Services' and is populated for 'Ansible Tower'\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPer the documentation listed here: https://docs.ansible.com/ansible-tower/latest/html/userguide/credentials.html#amazon-web-services I would expect to see an injector configuration that looked like this:\r\n\r\n\"injectors\": {\r\n                \"env\": {\r\n                    \"AWS_ACCESS_KEY_ID\": \"{{username}}\",\r\n                    \"AWS_SECRET_ACCESS_KEY\": \"{{password}}\",\r\n                    \"AWS_SECURITY_TOKEN\": \"{{security_token}}\"\r\n                }\r\n            }\r\n\r\n##### ACTUAL RESULTS\r\n\r\nthe REST API output has an empty dictionary for the injectors configuration:\r\n\r\n\"injectors\": {}\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI am assuming this is a cosmetic issue with the API output, and that the credential types themselves are functioning correctly.  That is an assumption as I haven't tested any of them. I have noticed that the API reports the injectors correctly for any of the custom credential types I've created.\r\n"},{"labels":["api",null,null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - When using a Load balancer and a Tower/Awx cluster with VIP we are redirected to login screen but we can't know what node we will doing the login.\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nIn case of using a Load balancer and a VIP as a front end of Tower for example. It will be very helpful to have an option of show the hostname or other info which identify the node into login screen."},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nUnder the Settings page for **Authentication/LDAP** it appears that the **LDAP Require Group** field is limited to a single group.  We would like to see this function expanded to a list of groups.\r\n\r\nWe would like to list multiple LDAP groups, which we already have in place today, instead of creating and having to populate a new LDAP group specifically for AWX authorized users.\r\n\r\nOur POC implementation has proved out this is technically possible by modifying the setting.py file found in /etc/tower/\r\n\r\nfrom django_auth_ldap.config import LDAPGroupQuery \r\nAUTH_LDAP_REQUIRE_GROUP = (\r\n    LDAPGroupQuery(\"cn=awx_admin, ou=UXgroups, ou=Groups, ou=Entsys,dc=company.com\")\r\n    | LDAPGroupQuery(\"cn=awx_user, ou=UXgroups, ou=Groups, ou=Entsys,dc=company.com\")\r\n)\r\n\r\nhttps://django-auth-ldap.readthedocs.io/en/latest/groups.html#limiting-access\r\n\r\nOur use case is that we would use multiple groups to establish authorization level into the system (i.e; Admin, Users, System Auditors,...)  instead of adding a group of all users to AWX a granting individual  access roles."},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nIt would be very beneficial to have ability to set proxy setting for only 'Project Update' phase of running Job. Example use case:\r\nAWX is placed in network A which is completely isolated from external network. All machines that has to be configured are also placed in this network. However, Git server (Gitea, GitLab) is placed in network B which is isolated from network A. Also, downloading Ansible collection from Ansible Galaxy or any other source is not possible in network A.\r\n\r\nBy having ability to specify proxy for just 'Project Update' phase, AWX can still be placed in network A, in which it can easily configure machines, but still be able to update project from external source and install collections."},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCurrently, organization admins can rename an organization.  However, if the organization was created by an LDAP or SAML configuration, this leads to the proliferation of organizations.  Organization Admins should NOT be able to rename organizations, or this should at least be configurable."},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAdd the ability to disable automatic organization creation when a user logs into AWX/Tower and add controls regarding what organizations can be created through SAML authentication.\r\n\r\nIf an attribute is mistakenly updated to contain a large number of values, the next time a user logs into AWX/Tower, all of those erroneously added organizations will be populated as objects into the application. There should be controls around what organizations are created to prevent this for a better user experience.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen sourcing an inventory from a project using git submodules only top git repository submodules are loaded.\r\nIf a git submodule includes another git submodule this is ignored.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 14.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.11\r\n* Operating System: CentOS7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a GIT repository (1) with an inventory.yml including another GIT repository (2) as a subfolder via git submodules.\r\nIn this GIT repository (2) include an inventory2.yml with another GIT repository (3) as a subfolder via git submodules.\r\nIn this GIT repository (3) include an inventory3.yml.\r\n\r\nYou should have the following structure:\r\n```\r\n|- .gitmodules\r\n|- inventory.yml\r\n|- inv2\r\n   |- .gitmodules\r\n   |- inventory2.yml\r\n   |- inv3\r\n      |- inventory3.yml\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nWhen sourcing an inventory from this project using `/ (project root)` as Inventory file I would expect that all three inventory.yml files are loaded.\r\n\r\n##### ACTUAL RESULTS\r\ninventory3.yml is not loaded because the directory inv3 is empty.\r\n\r\nThe inventory job is throwing the warning message:\r\n`[WARNING]: Unable to parse /tmp/awx_27_un9j3oyb/project/inv2/inv3 as an inventory source`\r\n\r\n##### ADDITIONAL INFORMATION\r\nThe project directory in the awx_task container (/usr/lib/awx/projects) seems to have the inventory3.yml. Just the tmp folder of the Inventory Sync Job does not contain the file.\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI am trying to run a playbook from ansible tower to fetch all the listed host zone from the aws r53. We are using assume role and we have allowed ansible tower instance to fetch data from other AWS accounts.\r\n\r\n statement = {\r\n    sid    = \"AnsibleInventoryPermissions\"\r\n    effect = \"Allow\"\r\n\r\n    actions = [\r\n      \"ec2:Describe*\",\r\n      \"route53:ListHostedZones\",\r\n      \"route53:ListResourceRecordSets\",\r\n      \"rds:Describe*\",\r\n      \"elasticache:Describe*\"\r\n    ]\r\n\r\n    resources = [\r\n      \"*\",\r\n    ]\r\n  }\r\n} \r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For new features, show how the feature would be used. For bugs, please show\r\nexactly how to reproduce the problem. Ideally, provide all steps and data needed\r\nto recreate the bug from a new awx install. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nPlaybook I used\r\n\r\n---\r\n- name: Route53 entry lists\r\n  hosts: localhost\r\n  gather_facts: true\r\n  connection: local\r\n  tasks:\r\n  - name: List all hosted zones\r\n    route53_info:\r\n      query: hosted_zone\r\n    register: record_sets\r\n  - name: PRINT OUT RECORD SETS\r\n    debug:\r\n      var: record_sets\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nWhen exporting job templates from once AWX instance and importing them into another new instance, job templates lose associated surveys.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 14.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.11\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Chrome\r\n\r\nThe above is for the new instance. The old instance is AWX 7.0.0 with Ansible 2.8.4, all other environment items are the same for the old instance.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. export job templates from existing system: `awx export -k --job_templates > job_templates.json`\r\n2. import job templates to new system: `awx import -k < job_templates.json`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob templates are imported with surveys\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSurveys are empty.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nExported job template survey:\r\n\r\n![image](https://user-images.githubusercontent.com/1863643/89939550-b8a07400-dbdd-11ea-9f23-de2eecf5be80.png)\r\n\r\n![image](https://user-images.githubusercontent.com/1863643/89939413-8db62000-dbdd-11ea-9bc8-0ebd99909ea7.png)\r\n\r\nImported job template survey:\r\n\r\n![image](https://user-images.githubusercontent.com/1863643/89939588-ca821700-dbdd-11ea-80e1-fd1e1198e1a3.png)\r\n\r\n![image](https://user-images.githubusercontent.com/1863643/89939620-dec61400-dbdd-11ea-96f0-369b0ea01832.png)\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAfter exporting artifacts from an existing AWX instance and importing into a new instance, job templates don't have any credentials associated with them.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 14.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.911\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Chrome\r\n\r\nThe above is for the new instance. The old instance is AWX 7.0.0 with Ansible 2.8.4, all other environment items are the same for the old instance.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Use awxkit's `awx` command to login and export artifacts from an existing AWX instance. I use a playbook to do this and my task looks like this:\r\n\r\n```yaml\r\n- name: SHELL | export artifacts from {{ ap_awx_export_from }}\r\n  shell: awx export -k --{{ item }} > awx_{{ ap_awx_export_from | urlsplit('hostname') }}_{{ item }}.json\r\n  args:\r\n    executable: /bin/bash\r\n    creates: awx_{{ ap_awx_export_from | urlsplit('hostname') }}_{{ item }}.json\r\n  environment:\r\n    TOWER_HOST: \"{{ ap_awx_export_from }}\"\r\n    TOWER_USERNAME: \"{{ ap_awx_export_from_username }}\"\r\n    TOWER_PASSWORD: \"{{ ap_awx_export_from_password }}\"\r\n    TOWER_OAUTH_TOKEN: \"{{ ap_awx_export_token }}\"\r\n  tags: [ artifacts, export ]\r\n  loop:\r\n    - organizations\r\n    - users\r\n    - teams\r\n    - credential_types\r\n    - credentials\r\n    - notification_templates\r\n    - projects\r\n    - inventory\r\n    - inventory_sources\r\n    - job_templates\r\n    - workflow_job_templates\r\n```\r\nThis command is executed on the new instance and, as shown, results in several *.json files corresponding to each AWX artifact type.\r\n\r\n2. I have a subsequent task that performs the import into the new instance, but only imports the following artifacts: organizations, users, teams, credential_types, and credentials\r\n\r\n3. I have another task which fixes the imported credentials by assigning actual values for each credential (e.g. SSH keys, passwords, vault passwords) since the import of credentials brings these things in empty.\r\n\r\n4. I import additional artifacts in the following order: notification_templates, projects\r\n\r\n5. I get a list of imported projects and perform an awx projects update <proj_id> --wait for each imported project to ensure they are all sync'd from Git repos\r\n\r\n6. Finally, I import the remaining artifacts in the following order: inventory, inventory_sources, job_templates, workflow_job_templates\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expect that a given job template on the import system have the credentials field populated with the same set of credentials that were in the job template from the export system.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe job templates import, but the credentials field is empty.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nExported job template credentials:\r\n\r\n![image](https://user-images.githubusercontent.com/1863643/89938859-bb4e9980-dbdc-11ea-9d33-737e304d15fc.png)\r\n\r\nImported job template credentials:\r\n\r\n![image](https://user-images.githubusercontent.com/1863643/89938914-cf929680-dbdc-11ea-9872-2b3ed2e484ec.png)\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - If a job have rescued tasks, but no failed tasks, AWX marks the job as failed:\r\n\r\n```\r\nPLAY RECAP *********************************************************************\r\nhost1 : ok=43   changed=27   unreachable=0    failed=0    skipped=24   rescued=1    ignored=0   \r\nhost2: ok=26   changed=16   unreachable=0    failed=0    skipped=26   rescued=0    ignored=0   \r\nhost3 : ok=133  changed=20   unreachable=0    failed=0    skipped=62   rescued=1    ignored=0   \r\nhost4 : ok=62   changed=16   unreachable=0    failed=0    skipped=40   rescued=0    ignored=2   \r\nhost5: ok=30   changed=18   unreachable=0    failed=0    skipped=26   rescued=0    ignored=2   \r\nhost6 : ok=26   changed=16   unreachable=0    failed=0    skipped=26   rescued=0    ignored=2\r\n```\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0\r\n* AWX install method: docker \r\n* Operating System: Debian 9\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe job should me marked as successful by AWX (and not failed)\r\n"},{"labels":["api",null,null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\nCan we have an option on workflow \"prompt on launch\" for credential\r\n\r\n##### SUMMARY\r\nThis would be similar to the following issue and pull, except it would be for workflow:\r\n\r\nhttps://github.com/ansible/awx/issues/2256\r\nhttps://github.com/ansible/awx/pull/2342\r\n"},{"labels":["api",null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAdd an organization role for users/teams which has the following:\r\n- create jobs, templates and workflows\r\n- edit jobs, templates and workflows\r\n- read jobs, templates and workflows\r\n\r\nThis role does not have execute permissions.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nTo start, we are backing up a cluster and restoring to servers in a different data center which may have different names. In the database the main_instance table has entries with the same UUIDs but different hostnames. When this happens the dispatcher for running jobs becomes unreachable and you can no longer cancel jobs. \r\n\r\nPR https://github.com/ansible/awx/pull/7823 fixes a 500 error from happening within the UI when trying to cancel a job running on a non-reachable dispatcher. While it works for a job template, workflow job templates appear to \"resurrect\" themselves in the UI. https://drive.google.com/file/d/1KBdTjOeY1Jag1eISlKbR9WJhiwwv9x_k/view?usp=sharing This appears to be happening because on a workflow only the cancel_flag is set too True and then the dispatcher picks up this flag and actually performs the job cancel. So the UI makes it looked canceled but then (after the status is reloaded) the UI puts it back into its running state.\r\n\r\nShould the reaper logic should be updated to handle dispatcher processes which have been lost and will not return?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0 (Tower 3.7.1)\r\n* AWX install method: Tower Cluster\r\n* Ansible version:  X.Y.Z\r\n* Operating System: RHEL\r\n* Web Browser: Any\r\n\r\n##### STEPS TO REPRODUCE\r\nBuild a 3 node cluster with external database.\r\nStart a workflow running on the cluster.\r\nBackup the cluster.\r\n\r\nRestore the backup into a new 3 node cluster.\r\nThe workflow that was running in the old cluster during the backup will not be cancelable. \r\nNOTE: there is a PR to the backup code #841 which will auto-cancel running jobs during a restore. If the above is tested with that PR this will not be reproducible.\r\n\r\n##### EXPECTED RESULTS\r\nCanceling a job in the UI will result in the job being canceled.\r\n\r\n##### ACTUAL RESULTS\r\nJobs are stuck running in queue.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"<!-- Issues are for **concrete, actionable bugs and feature requests** only - if you're just asking for debugging help or technical support, please use:\r\n\r\n- http://webchat.freenode.net/?channels=ansible-awx\r\n- https://groups.google.com/forum/#!forum/awx-project\r\n\r\nWe have to limit this because of limited volunteer time to respond to issues! -->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n[Ansible Tower Administration Guide v3.7.2](https://docs.ansible.com/ansible-tower/latest/html/administration/clustering.html#setup-considerations) (i.e. `latest` at the moment of writing):\r\n> PostgreSQL is still a standalone instance and is not clustered. Tower does not manage replica configuration or database failover (if the user configures standby replicas).\r\n\r\nThis is a request for adding PostgreSQL replication management to Tower.\r\n\r\n##### Justification: \r\n\r\nPostgreSQL replication is a must for eliminating SPOF (Single Point Of Failure). However, currently we can have that feature available only if the DB is _not_ managed by Ansible Tower.\r\n\r\nIn a business context that adds to unnecessary complication of both setting up and upgrading Tower: usually there's a separate team that takes care of the DB setup, and therefore upgrades need to be carefully examined for additional requirements/dependencies.\r\n\r\nIn short, the upgrade cadence becomes much more cumbersome and prone to mistakes.\r\n\r\n\r\n##### Downstream links:\r\n[Is Database Replication Supported with an Ansible Tower subscription?](https://access.redhat.com/solutions/3682951) \r\n[Red Hat Ansible Tower Database Scope of Coverage](https://access.redhat.com/articles/4010491)\r\n "},{"labels":["api",null,null,null,null,null,null,null],"text":"Today, AWX users can specify Ansible role/collection dependencies in their SCM repositories in a `requirements.yml` file, and AWX will install these as part of the Project Update.  Currently, AWX has support for pulling this content from https://galaxy.ansible.org or *one* Galaxy-like API such as Red Hat's cloud-based Ansible Automation Hub.\r\n\r\nThe model for configuring Galaxy credentials today is too simple (you can only specify *one* \"private\" Galaxy, ordering is complicated, and it's a set of *global* settings that can't be differentiated per Organization).\r\n\r\nThis issue is meant to track a change to this interface whereby Galaxy credentials will be assigned to Organizations, and can be unlimited and ordered as the user sees fit.\r\n\r\n### Scope of API Change\r\n\r\n- [x]  Introduce a new CredentialType of e.g., `kind=\"galaxy\"` which represents a content source for fetching collections defined in `requirements.yml` when project updates are run (e.g., galaxy.ansible.com, cloud.redhat.com, on-premise Automation Hub).  This new type will represent a URL and (optional) authentication details necessary to construct the environment variables _when a project update runs_ `ansible-galaxy collection install` as described in https://docs.ansible.com/ansible/latest/user_guide/collections_using.html#configuring-the-ansible-galaxy-client. It will have fields which map directly to the configuration options exposed to the Ansible Galaxy CLI, e.g., per-server:\r\n    - `url` (required str)\r\n    - `auth_url` (optional str)\r\n    - `token` (optional str, encrypted)\r\n\r\nNote that a URL will *always* be required, but authentication (as in the case of galaxy.ansible.com) is optional. \r\n\r\n**This new solution _will not_ support basic authentication, because several of these APIs will be removing support for basic auth in the next year** (see: https://github.com/ansible/awx/pull/7811/)\r\n\r\n- [x]  Add an API endpoint for associating an _ordered list_ of these credentials _at the Organization level_.  For example, an Organization may have an empty list (the default), or one or more items in the list (i.e., Public Galaxy, _then_ On-Prem AH).  This might be something like:\r\n\r\n`/api/v2/organizations/N/galaxy_credentials/`\r\n\r\n- [x]  Write code to detect and migrate the *existing* Galaxy-oriented setting values in such a way that post-upgrade, proper credentials are created and attached to _every_ Organization in the AWX install:\r\n    - `PRIMARY_GALAXY_URL`\r\n    - `PRIMARY_GALAXY_USERNAME`\r\n    - `PRIMARY_GALAXY_PASSWORD`\r\n    - `PRIMARY_GALAXY_TOKEN`\r\n    - `PRIMARY_GALAXY_AUTH_URL`\r\n    - `PUBLIC_GALAXY_ENABLED`\r\n\r\nIn other words, after upgrading, you should find that *every* organization that existed prior to upgrade now has a list of (one or more) \"Galaxy\" credentials associated with it.\r\n\r\nAdditionally, post-upgrade, these settings should not be visible (or editable) from `/api/v2/settings/jobs/`.\r\n\r\n- [x]  Change the `awx.main.tasks` code such that when a project update runs, it looks at the list of Galaxy/AH credentials assigned to the organization, and (respecting the defined order) builds the appropriate environment variables to properly configure the `ansible-galaxy` CLI.  See: https://docs.ansible.com/ansible/latest/user_guide/collections_using.html#configuring-the-ansible-galaxy-client\r\n\r\n> As well as being defined in the ansible.cfg file, these server options can be defined as an environment variable. The environment variable is in the form `ANSIBLE_GALAXY_SERVER_{{ id }}_{{ key }}` where `{{ id }}` is the upper case form of the server identifier and `{{ key }}` is the key to define. For example I can define token for release_galaxy by setting `ANSIBLE_GALAXY_SERVER_RELEASE_GALAXY_TOKEN=secret_token`.\r\n\r\nFor example:\r\n\r\n```\r\nANSIBLE_GALAXY_SERVER_LIST=server1,server2\r\nANSIBLE_GALAXY_SERVER_SERVER1_URL=https://galaxy.ansible.com\r\nANSIBLE_GALAXY_SERVER_SERVER2_URL=https://cloud.redhat.com/api/automation-hub/\r\nANSIBLE_GALAXY_SERVER_SERVER2_AUTH_URL=https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token\r\nANSIBLE_GALAXY_SERVER_SERVER2_TOKEN=secret123\r\n```\r\n\r\nIn this way, when `awx/playbooks/project_update.yml` runs `ansible-galaxy collection install`, it will attempt the servers in order:\r\n\r\n> The GALAXY_SERVER_LIST option is a list of server identifiers in a prioritized order. When searching for a collection, the install process will search in that order, e.g. automation_hub first, then my_org_hub, release_galaxy, and finally test_galaxy until the collection is found.\r\n\r\n- [x]  Continue to support `GALAXY_IGNORE_CERTS` as a global setting, as the `ansible-galaxy` CLI doesn't currently have the ability to specify this value at a per-server level.\r\n\r\n- [x]  We should ensure that this implementation _continues_ to provide support for the use case where users want to fetch roles directly from public Galaxy _even if_ galaxy.ansible.com is not the _first_ credential in the list for the Organization).\r\n\r\n### Scope of UI Change\r\n\r\n- [x] the organization add/edit form will need a non-required credential lookup field for credentials of `kind=galaxy`.  A note is needed to let the user know the order of these credentials matters (order sets precedence for the sync and lookup of the content)\r\n\r\n- [x] Remove the global \"Galaxy\" settings from `/#/settings/jobs`."},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nIf a project's last update is failed, you cannot run a JT that uses that project. Hard fail implemented here, maybe in some other ways as well:\r\n\r\nhttps://github.com/ansible/awx/blob/708244881cc6cd04722d3bc36d7d6036bffc329a/awx/main/tasks.py#L1858-L1863\r\n\r\nThere are several reasons a project update could fail, and not all of them should break running of a previously-known commit from a prior project update. If a project update fails, there's no way to \"revert\" to the last successful commit, and jobs will refuse to run as things stand. Some of these scenarios, you _could_ keep running jobs successfully, but AWX _blocks_ the user from doing that.\r\n\r\nDrafting some scenarios for that:\r\n\r\n##### Project branch deletion\r\n\r\n - a project in AWX defines `scm_branch` to \"master\"\r\n - the repo changes its default branch to another name, like \"main\"\r\n - the maintainers delete the \"master\" branch\r\n - subsequent project update fails\r\n\r\nJobs will no longer run. The last-known SCM revision can still be obtained from the remote.\r\n\r\n##### Local commit still available\r\n\r\nIn conventional single-node installs, you know for sure that the the local filesystem is up-to-date with the last project update.\r\n\r\n - A general error happens with the SCM (connectivity or otherwise)\r\n - A project update runs, it marks the project as failed\r\n\r\nJobs will no longer run. This behavior is debatable - in some cases people would prefer to stop jobs from running if the latest could not be pulled. In some cases, they would prefer for the server to keep using last-known revisions, which will use the local copy in some cases.\r\n\r\n----\r\n\r\nSome very preliminary ideas:\r\n\r\n - [ ] Introduce a configurable, either on project / organization / system that allows running a job with a failed project, or some other kind of implementation which will allow jobs to keep running with the previously-known revision\r\n - [ ] In the event that a job does run with a project that had a previously failed update, put up some kind of warning\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nCurrently job_metadata is a string and makes it hard to pull information out to make the notification more readable.\r\nPartly because some of the jinja methods are blocked in the GUI for security reasons.\r\nLastly some of the info is also available in host_status_counts, however this is limited to a single host.\r\n\r\n\r\n##### SUMMARY\r\nIn order to create more readable notification e-mails, is it possible to add a dict with the same information as job_metadata, or have host_status_counts expanded to include all hosts?\r\n\r\n\r\nKind Regards,"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWe are removing inventory scripts from awx. This ticket tracks the API work necessary to do that for docs and QE.\r\n\r\n##### Related Issues\r\nRelated ui_next issue: https://github.com/ansible/awx/pull/7577\r\nRelated docs issue referenced below\r\nRelated tests issue referenced below"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThis needs to be backed off from 2.8 to 2.9:\r\n\r\nhttps://github.com/ansible/awx/blob/708244881cc6cd04722d3bc36d7d6036bffc329a/awx/playbooks/project_update.yml#L165\r\n\r\nBecause if you run with Ansible 2.8, it gives blank `stdout` and that's confusing.\r\n\r\nIf my research is correct, @jborean93 added the `ansible-galaxy collection` CLI in https://github.com/ansible/ansible/pull/57106, which was 2.9. Version 2.8 seems to mistake these invocations for a role command, and it doesn't work right.\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIf you want to rerun a completed job, you can go to your job template, look up its completed job and then hit the rocket ship relaunch button. When clicking this button it seems like it will use the original parameters for the corresponding job run, but it rather uses the current job templates parameters. The point of going back to that completed job is find the exact configuration that was run before, not repeat the current saved config. "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nSimilar to issue 308, allow users authenticated via RADIUS to be authorized via LDAP group membership, as well as allowing team and organization mapping using LDAP attributes.\r\n\r\nA good use case example is that LDAP (such as active directory) already contains all of the team and organization mappings, as well as the authorization groups, which currently cannot be derived from RADIUS, while still allowing the stronger authentication methods that RADIUS can provide.  \r\n"},{"labels":["api",null,null,null],"text":"see: https://github.com/django/channels/issues/1181#issuecomment-663550284"},{"labels":["api",null],"text":"\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n \r\n##### SUMMARY\r\nFor security auditing purposes it would be ideal for the External Logger to record any changes, especially disablement along with username info, into the said logs before performing the action.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: >=12.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  >=2.9.9\r\n* Operating System: ANY\r\n* Web Browser: ANY\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nMake a change to the External Logger settings, click save.\r\n\r\n##### EXPECTED RESULTS\r\n Ideally pending changes along with user info should be recorded into the said logging facility.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nChanges are committed without indication of what changed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNone\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n- vCenter Inventory\r\n\r\n##### SUMMARY\r\nDespite the use of a \"virtualenv\" with the necessary dependencies (VMware vSphere Automation), I don't have any tags associated to my VMs that go up in my AWX inventory.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 13.0.0\r\n* AWX install method: Kubernetes\r\n* Ansible version:  2.9.10\r\n* Operating System: Ubuntu 20.04\r\n* Web Browser: Firefox 78.0.2\r\n* vCenter : 6.7.16243230 \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Deploy AWX on Kubernetes\r\n\r\n2 ) Create virtualenv with vmware sdk \r\n- https://docs.ansible.com/ansible-tower/3.4.5/html/upgrade-migration-guide/virtualenv.html\r\n- https://github.com/vmware/vsphere-automation-sdk-python\r\n(create virtualenv on task and web container)\r\n\r\n3) Select your virtualenv for your source inventory for vmware (and use values \"use tags: true on source variable) and lauch inventory\r\n\r\n##### EXPECTED RESULTS\r\ntag value for each VM on Variables Details in Inventory \r\n\r\n##### ACTUAL RESULTS\r\nno tag\r\n\r\n##### ADDITIONAL INFORMATION\r\nI tried to force the \"true\" parameter for the tags directly in the plugin code in the containers \r\n(/usr/lib/python3.6/site-packages/ansible/plugins/inventory/vmware_vm_inventory.py)\r\n\r\nIf I delete the plugin file from the containers, I get no error. I just have the impression that AWX doesn't use this plugin and continues to use a simple scripting inventory method (which I thought was not recommended anymore).\r\n\r\nhttps://docs.ansible.com/ansible-tower/latest/html/userguide/inventories.html#inventory-plugins\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAnsible 2.10 throws errors with some inventory updates, and it _seems_ that this is a problem with the configs that AWX is laying down, as opposed to an incompatibility between the collection and ansible-base\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0\r\n* Ansible version:  2.10, 2.11\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHack the system to have `ansible-base` not `ansible` and run an ec2 inventory updates\r\n\r\n##### EXPECTED RESULTS\r\n\r\nsuccess\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n[WARNING]:  * Failed to parse /tmp/awx_1933_9dbpk2dz/aws_ec2.yml with auto\r\nplugin: Invalid group name format, expected a string or a list of them or\r\ndictionary, got: <class 'int'>\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer an user's request, they're wondering if it's possible to blacklist/whitelist users who are authenticating via SAML. Could this be implemented by specifying an attribute to lookup in the response?"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer an user's request, they would like the addition of an \"Use\" role on an organizational level. The organizational \"Use\" role should give access to all of the resources within the configured organization."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWhen specifying `ignore_unreachable: yes` in a playbook task, any hosts that were unreachable at the time show as `unreachable` and `skipped`, but not `failed`. \r\n\r\nHowever, when you look in the AWX host inventory view, hosts that were unreachable but didn't essentially fail show as failing:\r\n\r\n![image](https://user-images.githubusercontent.com/25699347/67393872-40df5b00-f571-11e9-8d0b-7c1566b1214d.png)\r\n\r\nIn the preceding example, CentOS1 was unreachable while CentOS2 was reachable. The playbook task had `ignore_unreachable: yes` included. The `PLAY RECAP` shows CentOS1 being unreachable and skipped, but not failed:\r\n\r\n~~~\r\nPLAY RECAP *********************************************************************\r\nCentOS1                    : ok=0    changed=0    unreachable=1    failed=0    skipped=1    rescued=0    ignored=0   \r\nCentOS2                    : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n~~~\r\n\r\nOddly though, in `awx-manage shell_plus`, CentOS1 is showing active failures:\r\n\r\n~~~\r\n>>> r = Host.objects.filter(id=34)\r\n>>> for x in r:\r\n...     print(x.has_active_failures)\r\n... \r\nTrue\r\n~~~\r\n\r\nAs a test, I went into `psql` and manually updated `main_host` to change `has_active_failures` to `False`. After doing this, I verified the change via `awx-manage shell_plus` and re-ran the same job template.\r\n\r\n~~~\r\n>>> r = Host.objects.filter(id=34)\r\n>>> for x in r:\r\n...     print(x.has_active_failures)\r\n... \r\nFalse\r\n~~~\r\n\r\nAs I would expect, the job template was successful, however, CentOS1 was still marked as a failed node, even though no failures were reported in the `PLAY RECAP`.\r\n\r\nI verified the reversion via `awx-manage shell_plus`:\r\n\r\n~~~\r\n>>> r = Host.objects.filter(id=34)\r\n>>> for x in r:\r\n...     print(x.has_active_failures)\r\n... \r\nTrue\r\n~~~\r\n\r\nPer an user's request, they would like to see hosts that were marked `unreachable` and `skipped`, but not `failed` as successful in the AWX inventory host view."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Request\r\n\r\n##### SUMMARY\r\n\r\nAn user was wondering how AWX handles a change in LDAP Team Mapping (e.g. If the `is_superuser` mapping is removed, does AWX update the user objects?).\r\n\r\nI observed the following:\r\n\r\nIf the `LDAP User Flags by Group` is removed, pre-existing users in AWX do not update according to the changes made. \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1. Create a LDAP connection from AWX.\r\n2. Specify a `LDAP User Flags by Group` parameter.\r\n3. Login with a LDAP user and verify its creation within AWX.\r\n4. Verify the user has the proper permissions.\r\n5. Change the `LDAP User Flags by Group` to no longer reflect the user.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nI would expect the user object within AWX to update itself based on the LDAP mapping specified.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nIt looks like the user object has to be manually updated in order for the permissions to update. If `is_superuser` is granted to many users in a LDAP group and the mapping has to change, this could be an undesired behavior."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer an user's request, they would like to be able to specify their own conditions on acceptable survey answers (i.e. regular expressions). \r\n\r\nIn the user's environment, they would like to validate an IP address in the survey answer. This could also extend out to other use cases (e.g. If an user has a naming convention for assets, systems, etc., the user can populate information in order to verify the provided answer is considered acceptable.)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe API will accept a PATCH to edit `local_path` for a git project, but the change will not take effect.\r\n\r\nSome version of a 400 error would be preferable to this. This is a valid field to edit in the case of manual projects, so there's no valid justification that it's \"not a field\".\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0\r\n* AWX install method: N/A\r\n* Ansible version:  N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPATCH `/api/v2/projects/6/`\r\n\r\n```json\r\n{\r\n  \"description\": \"asdf\",\r\n  \"local_path\": \"_6__demo_project_edited\"\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nOne of:\r\n\r\n - the local_path value changes to \"_6__demo_project_edited\"\r\n - get error\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo error\r\n\r\ndescription changes to \"asdf\"\r\n\r\nthe `local_path` remains at prior value of \"_6__demo_project\"\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWe are testing AWX/Ansible Tower as a scalable central Deployment-Method & Technical Workflow Handler and ran into an issue with schedules.\r\nWe have a colocated kubernetes cluster of 15 AWX instances (1485 capacity) & dedicated DB.\r\nFor testing we've made several testjobs.\r\nWhile trying 100 scheduled Jobs per minute, we've been experiencing Database-Locks (330 seconds while updating \"Last Job ID\" on Templates) when using the same project, job-template & inventory.\r\n\r\nSo we've split and reduced it to:\r\n- 8 projects\r\n  - each project has one inventory\r\n  - each project has one job template\r\n    - each job template is run 6 times per minute (0, 10, 20, 30, 40, 50)\r\n\r\nScheduler should therefore start 48 Jobs per minute.\r\n\r\nBut it only starts around 10-30 Jobs per minute.\r\n\r\nWe've couldn't find any errors in logs.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0\r\n* AWX install method: minishift\r\n* Ansible version:  2.9.10\r\n* Operating System: CentOS8\r\n* Web Browser: Firefox, Chromium\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nEnable SSH Pipelining in ansible.cfg\r\n\r\nCreate Playbook to simulate workload:\r\n- creates tempdir\r\n- pulls ansible/awx into tempdir\r\n- writes 100 lines via ansible loop into a file (jep, not efficient, but it shouldn't be, just take some time)\r\n- wait 10s\r\n- remove tempdir\r\n\r\nCreate Resources:\r\n- 8 projects\r\n  - one inventory per project with 15 hosts\r\n  - one inventory per job template with 15 forks\r\n    - 6 schedules per job template, run once per minute für seconds: 0, 10, 20, 30, 40, 50\r\n\r\n##### EXPECTED RESULTS\r\n\r\n48 Jobs per minute\r\n\r\n##### ACTUAL RESULTS\r\n\r\n10-30 Jobs per minute, even with a lot of remaining capacity (~75%)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nMade a simple script to log job counts. Example output:\r\n```\r\nDate | Queued Jobs | Queued Diff | Running Jobs | Finished Jobs (not canceled) | Finished Jobs Diff\r\n2020-07-20T15:41:22+02:00 | 41 | 33 | 19 | 625169 | 12\r\n2020-07-20T15:42:23+02:00 | 10 | -31 | 23 | 625204 | 35\r\n2020-07-20T15:43:25+02:00 | 14 | 4 | 11 | 625225 | 21\r\n2020-07-20T15:44:26+02:00 | 14 | 0 | 11 | 625244 | 19\r\n2020-07-20T15:45:27+02:00 | 2 | -12 | 19 | 625267 | 23\r\n2020-07-20T15:46:28+02:00 | 4 | 2 | 15 | 625288 | 21\r\n2020-07-20T15:47:30+02:00 | 13 | 9 | 33 | 625320 | 32\r\n2020-07-20T15:48:31+02:00 | 40 | 27 | 19 | 625337 | 17\r\n2020-07-20T15:49:32+02:00 | 21 | -19 | 19 | 625363 | 26\r\n2020-07-20T15:50:33+02:00 | 15 | -6 | 15 | 625379 | 16\r\n2020-07-20T15:51:35+02:00 | 9 | -6 | 13 | 625405 | 26\r\n2020-07-20T15:52:36+02:00 | 2 | -7 | 17 | 625424 | 19\r\n2020-07-20T15:53:38+02:00 | 32 | 30 | 19 | 625443 | 19\r\n2020-07-20T15:54:39+02:00 | 3 | -29 | 26 | 625478 | 35\r\n2020-07-20T15:55:40+02:00 | 1 | -2 | 12 | 625502 | 24\r\n2020-07-20T15:56:41+02:00 | 2 | 1 | 12 | 625520 | 18\r\n2020-07-20T15:57:42+02:00 | 1 | -1 | 9 | 625537 | 17\r\n2020-07-20T15:58:44+02:00 | 27 | 26 | 11 | 625551 | 14\r\n2020-07-20T15:59:45+02:00 | 3 | -24 | 39 | 625579 | 28\r\n2020-07-20T16:00:46+02:00 | 17 | 14 | 45 | 625604 | 25\r\n2020-07-20T16:01:47+02:00 | 10 | -7 | 53 | 625641 | 37\r\n2020-07-20T16:02:48+02:00 | 6 | -4 | 30 | 625668 | 27\r\n2020-07-20T16:03:50+02:00 | 6 | 0 | 14 | 625693 | 25\r\n2020-07-20T16:04:51+02:00 | 4 | -2 | 14 | 625713 | 20\r\n2020-07-20T16:05:52+02:00 | 9 | 5 | 19 | 625730 | 17\r\n```\r\n\r\nA lot of capacity is remaining:\r\n```json\r\n{\r\n    (...)\r\n    \"name\": \"tower\",\r\n    (...)\r\n    \"capacity\": 1485,\r\n    \"committed_capacity\": 0,\r\n    \"consumed_capacity\": 310,\r\n    \"percent_capacity_remaining\": 79.12,\r\n    (...)\r\n}\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nA customer's analytics uploads were failing since the bundle size was greater than 100MB.  This is due to an upload size limit in the upload service.    Tower should upload bundles smaller than 100MB by building a bundle and if it is too big then divide the time period in half and send two bundles instead. Recurse until small enough bundles are reached.    \r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWith a lot of pending Jobs (e.g. if Instances were disabled/down for maintenance, Cluster was restarted, Failover, ...) the Job-Scheduler/Dispatcher \"run_task_manager\" will not finish in under 5 Minutes and be killed by: https://github.com/ansible/awx/blob/devel/awx/main/dispatch/pool.py#L385\r\nFrom our observation Jobs will only be executed, if Scheduler/Dispatcher ran through all pending/new Jobs and dispatched/skipped them.\r\nTherefore no Jobs will be executed, and \"run_callback_receiver\" will never be run.\r\n\r\nWe've tried it with following setups:\r\n- kubernetes with 15 instances, dedicated db\r\n- just for testing: docker on linux (5 instances, with modified settings.py for unique UUIDs & Hostnames, dedicated db)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0\r\n* AWX install method: minishift, docker on linux\r\n* Ansible version:  2.9.10\r\n* Operating System: CentOS8\r\n* Web Browser: Firefox, Chromium\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nFirst method:\r\n- have a cluster with e.g. 10 instances\r\n- spawn >600 Jobs (depends on latency to DB & instance resources)\r\n- shut down DB or all instances\r\n- start DB or all instances again\r\n\r\nSecond method:\r\n- have a cluster with e.g. 10 instances\r\n- set instances to disabled\r\n- spawn >600 Jobs (depends on latency to DB & instance resources)\r\n- enable instances again\r\n\r\n##### EXPECTED RESULTS\r\n\r\nEither:\r\n- Jobs are being run\r\nOr:\r\n- Job is being run right after Scheduler/Dispatcher dispatched it, not after Scheduler/Dispatcher is done\r\n  - this way at least some Jobs will be executed\r\n\r\n##### ACTUAL RESULTS\r\n\r\n- no jobs are executed, as Scheduler/Dispatcher never finishes processing queue before 5 minutes\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nExample log output of the Scheduler/Dispatcher being killed:\r\n```\r\nawx_task | 2020-07-16T12:05:24.565256659Z 2020-07-16 12:05:24,564 DEBUG    awx.main.scheduler job 657142 (pending) couldn't be scheduled on graph, waiting for next cycle\r\nawx_task | 2020-07-16T12:05:25.381709968Z 2020-07-16 12:05:25,381 DEBUG    awx.main.scheduler No instance available in group tower to run job job 657143 (pending) w/ capacity requirement 2\r\nawx_task | 2020-07-16T12:05:25.382505862Z 2020-07-16 12:05:25,382 DEBUG    awx.main.scheduler job 657143 (pending) couldn't be scheduled on graph, waiting for next cycle\r\nawx_task | 2020-07-16T12:05:25.397228851Z 2020-07-16 12:05:25,286 ERROR    awx.main.dispatch run_task_manager has held the advisory lock for >5m, sending SIGTERM to 8784\r\nawx_task | 2020-07-16T12:05:25.399474966Z 2020-07-16 12:05:25,398 WARNING  awx.main.dispatch scaling down worker pid:8789\r\nawx_task | 2020-07-16T12:05:25.402610294Z 2020-07-16 12:05:25,401 WARNING  awx.main.dispatch worker exiting gracefully pid:8789\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently, there is no way to let the user know that the token is about to expire.\r\n\r\n##### Customer Explanation:\r\n\r\n- Is there any add-on or plugin where we can have the notification or alert mechanism to each user on his token expiry in Tower. By default, validity is 1000 years. As per Organization best practices, we have set to few days. However, we see there is no option in Ansible Tower to send the email or any alert notification to user in advance.\r\n- We see this usage of token in most of API usage and during some workflow process like CI-CD pipeline in DevOps. Workflow process fails due this Token expiry and users are complaining on no notification sent.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer an user's request, Project Admins should be able to configure which Python virtual environment is used within a Project. Currently, only System/Organization Administrators have this ability."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer a customer's request, they would like to be able to review the last time a Credential was utilized.\r\n\r\nCredentials show a modified date/time:\r\n~~~\r\n\"modified\": \"2019-05-28T20:01:05.156590Z\"\r\n~~~\r\n\r\nIn the same way a Credential is modified, they would like to see a \"last-utilized\" timestamp."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer an user's request, they would like to be able to review the last time an Inventory was utilized.\r\n\r\nInventories show a modified date/time:\r\n~~~\r\n\"modified\": \"2019-05-28T20:00:24.252273Z\"\r\n~~~\r\n\r\nIn the same way an Inventory is modified, they would like to see a \"last-utilized\" timestamp."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n- UI\r\n\r\nAnsible Tower currently does not have the ability to allow a Normal User to add/remove hosts from an Inventory (unless you're a Tower admin or admin of an Inventory). Per an user's request, they would like to be able to give a normal user the **Update** role and then have the normal user add/remove hosts from the Inventory (without giving them full admin rights or full rights on the Inventory)."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUnable to create Smart Inventory from information of Inventory created in different Organizations even if users have inventory \"Admin\" permission.\r\n\r\n##### ENVIRONMENT\r\nAnsible Tower version: 3.7.0 and 3.6.2\r\nOperating System: RHEL 7.7\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n**Creating Access**\r\nLogin to Dashboard as admin user \r\n\r\n1. Create Organization \"ORG-GROUP\" and \"ORG-TEAM\"\r\n2. Create Team \"MY-TEAM\" (Organization is ORG-TEAM)\r\n3. Create User \"testuser\" (Organization is ORG-TEAM)\r\n4. Register \"testuser\" with \"MY-TEAM\" Team\r\n5. Inventory Create \"Test Inventory\" and register some hosts (Organization is ORG-GROUP)\r\n6. Assign Admin Role of \"Test Inventory\" to Team \"MY-TEAM\"\r\n\r\n**Creating Smart Inventory**\r\nLogin to Dashboard again as testuser user\r\n\r\n7. Make sure \"Test Inventory\" is existing in Inventory\r\n8. Check that the host can be listed from the HOST tab of \"Test Inventory\" and you are able to see the host list.\r\n\r\n ![image](https://user-images.githubusercontent.com/58404577/87636837-abca6500-c784-11ea-8522-ee9cae0ff48a.png)\r\n \r\n9. Try to create a Smart Inventory\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAble to search the host list from Dynamic/Static Inventory(Test Inventory) to create Smart Inventory with user \"testuser\".\r\n\r\n##### ACTUAL RESULTS\r\n\r\nUnable to search any host from Dynamic/Static Inventory(Test Inventory) to create a Smart Inventory with user \"testuser\". \r\n![image](https://user-images.githubusercontent.com/58404577/87636088-82f5a000-c783-11ea-8aa2-34b59461a1df.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNone\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\nWe need to ensure the work done in https://github.com/ansible/awx/issues/5518 does not regress once we move to Execution Environments.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen choosing MemberDNGroupType and trying to save you get the error message\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0/AWX 11.2.0  I have two environments with the same problem\r\n* AWX install method: docker on Linux/ Kubernetes\r\n* Ansible version:  2.9.10 / 2.9.7\r\n* Operating System: Ubuntu 20/ Whatever Kube is running.  Used the defaults\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGo into Settings\\Auth and choose MemberDNGroupType from the LDAP.  Save\r\n![image](https://user-images.githubusercontent.com/58124021/87495789-15246980-c607-11ea-8490-512a6b33223b.png)\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSave with no errors\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError.  See attached screenshot\r\n![image (1)](https://user-images.githubusercontent.com/58124021/87495863-413fea80-c607-11ea-8e4f-81719b5df0b3.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen using or testing the CyberArk AIM Central Credential Provider Lookup, no test status message notification is returned.  After approximately 60 seconds or so, it will return ‘Test Failed’ with no further information as to the error.\r\n\r\n##### ENVIRONMENT\r\n* Tower version: 3.6.3+\r\n* Tower install method: ansible\r\n* Ansible version:  X.Y.Z\r\n* Operating System: RHEL 8\r\n* Web Browser: Mozilla Firefox 78.02\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Setup CyberArk AIM Central Credential Lookup to point to your Central Credential Provider web service in the URL field.\r\n2. Enter in the Application ID assigned for access to the secrets' safe.\r\n3. Add any optional client certificate and key data needed for client certificate authentication to the web service and Certificate Serial Number verification for CyberArk authentication.\r\n4. Click \"Test\" and nothing will happen.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWithin 5 seconds, a toast notification message should appear and say whether the 'Test Succeeded' or 'Test Failed'.  If 'Test Failed' is received, clear and concise error message information is provided for debugging.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNothing happens.  If you're lucky, about 60 seconds later you will receive a 'Test Failed' toast notification message with no error message output.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n**The following tests were ran on Tower v3.7.1 and v3.6.4 all with the same issue.**\r\n**_The first working version was v3.6.2, which I am back on again._**\r\n_Test #1: curl from Tower host_\r\nTo test this, I SSH’ed into the Tower host itself.  I used `curl` to communicate with our Central Credential Provider web service and gave all the same information as was setup in the Lookup.  The test failed.  The failure was due to HTTP/2 being used and the error message requested the usage of HTTP/1.1 instead.\r\n \r\n_Test #2: curl from Tower host with --http1.1 flag set_\r\nI then used the same `curl` command again and added the flag, `--http1.1`, to require HTTP/1.1 to be used regardless of the default setting.  The test was successful.\r\n \r\n_Test #3: curl from Tower host with CURLOPT_HTTP_VERSION=CURL_HTTP_VERSION_1_1_\r\nFinally, I tested setting the environment variable for the CURLOPT_HTTP_VERSION to 1.1 and the test failed again.  Apparently, the only way it would work is by setting the `--http1.1` flag on the `curl` request.\r\n\r\nWith all of that done, is there a way to configure the CyberArk AIM Central Credential Provider Lookup to force HTTP/1.1 instead of HTTP/2 and avoid these issues?  Is there a way to set the entire Tower host to enforce HTTP/1.1 only?  Finally, if none of those are possibilities, would it be possible to update the `curl` command our plugin uses to have a hardcoded `--http1.1` appended to the requests?\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\ngcp_compute inventory plugin failing under 13.0.0\r\n\r\n##### SUMMARY\r\nI have an inventory script that worked fine under 11.0.0, and still works under 2.9.6 from the command line, \r\nbut fails with a:\r\n\r\n```\r\nawx/scratch.gcp.yml with auto plugin: Credential type 'serviceaccount' not\r\nimplemented\r\n``` \r\nunder 13.0.0\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.9.10\r\n* Operating System: Centos 7 on tower, Mac on client\r\n* Web Browser: chrome\r\n##### STEPS TO REPRODUCE\r\n\r\nUsing this script, which worked in 11.0.0\r\n```\r\nzones:\r\n - us-central1-a\r\n - us-central1-b\r\n - us-central1-c\r\n - us-central1-f\r\nprojects:\r\n - redacted\r\nfilters:\r\n - labels.environment = devel\r\n - labels.managed = \"true\"\r\ngroups:\r\n gcp_hosts: true\r\n gke: \"'goog-gke-node' in (labels|list)\"\r\nauth_kind: serviceaccount\r\nhostnames:\r\n - name\r\nscopes:\r\n - https://www.googleapis.com/auth/compute\r\ncompose:\r\n dc: labels.hostname.split('_')[2]\r\n dc_grp: \"'dc_' + labels.hostname.split('_')[2]\"\r\n private_ip_address: networkInterfaces[0].networkIP\r\n ansible_host: networkInterfaces[0].networkIP\r\n```\r\n\r\nwith a credential defined and assigned i get the \r\n```\r\nawx/scratch.gcp.yml with auto plugin: Credential type 'serviceaccount' not\r\nimplemented\r\n``` \r\nerror.  I've generated a new key, and created a new credential, and assigned it to verify the key is ok.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nInventory to be updated\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSee error above.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nIf users have Inventory Admin permissions, then they are not allowed to create inventory sources.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker\r\n* Ansible version:  2.9.9\r\n* Operating System: Debian 9\r\n* Web Browser: Firefox 74\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n```\r\nGET /api/v2/users/76\r\n{\r\n    \"id\": 76,\r\n    \"type\": \"user\",\r\n    \"url\": \"/api/v2/users/76/\",\r\n    \"related\": {\r\n        ...\r\n    },\r\n    \"summary_fields\": {\r\n        \"user_capabilities\": {\r\n            \"edit\": true,\r\n            \"delete\": true\r\n        }\r\n    },\r\n    \"created\": \"2019-12-11T17:26:44.744286Z\",\r\n    \"username\": \"myuser\",\r\n    \"first_name\": \"Service User\",\r\n    \"last_name\": \"myuser\",\r\n    \"email\": myuser@example.com\",\r\n    \"is_superuser\": false,\r\n    \"is_system_auditor\": false,\r\n    \"ldap_dn\": \"\",\r\n    \"last_login\": \"2020-07-09T14:46:16.679122Z\",\r\n    \"external_account\": null,\r\n    \"auth\": []\r\n}\r\n```\r\n```\r\nGET /api/v2/users/76/roles/\r\n{\r\n    \"count\": 4,\r\n    \"next\": null,\r\n    \"previous\": null,\r\n    \"results\": [\r\n        {\r\n            \"id\": 1305,\r\n            \"type\": \"role\",\r\n            \"url\": \"/api/v2/roles/1305/\",\r\n            \"related\": {\r\n                \"users\": \"/api/v2/roles/1305/users/\",\r\n                \"teams\": \"/api/v2/roles/1305/teams/\",\r\n                \"credential\": \"/api/v2/credentials/75/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"user_capabilities\": {\r\n                    \"unattach\": true\r\n                },\r\n                \"resource_name\": \"mycredential\",\r\n                \"resource_type\": \"credential\",\r\n                \"resource_type_display_name\": \"Credential\"\r\n            },\r\n            \"name\": \"Use\",\r\n            \"description\": \"Can use the credential in a job template\"\r\n        },\r\n        {\r\n            \"id\": 233,\r\n            \"type\": \"role\",\r\n            \"url\": \"/api/v2/roles/233/\",\r\n            \"related\": {\r\n                \"users\": \"/api/v2/roles/233/users/\",\r\n                \"teams\": \"/api/v2/roles/233/teams/\",\r\n                \"organization\": \"/api/v2/organizations/6/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"user_capabilities\": {\r\n                    \"unattach\": true\r\n                },\r\n                \"resource_name\": \"myorga\",\r\n                \"resource_type\": \"organization\",\r\n                \"resource_type_display_name\": \"Organization\"\r\n            },\r\n            \"name\": \"Member\",\r\n            \"description\": \"User is a member of the organization\"\r\n        },\r\n        {\r\n            \"id\": 227,\r\n            \"type\": \"role\",\r\n            \"url\": \"/api/v2/roles/227/\",\r\n            \"related\": {\r\n                \"users\": \"/api/v2/roles/227/users/\",\r\n                \"teams\": \"/api/v2/roles/227/teams/\",\r\n                \"organization\": \"/api/v2/organizations/6/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"user_capabilities\": {\r\n                    \"unattach\": true\r\n                },\r\n                \"resource_name\": \"myorga\",\r\n                \"resource_type\": \"organization\",\r\n                \"resource_type_display_name\": \"Organization\"\r\n            },\r\n            \"name\": \"Inventory Admin\",\r\n            \"description\": \"Can manage all inventories of the organization\"\r\n        },\r\n        {\r\n            \"id\": 1382,\r\n            \"type\": \"role\",\r\n            \"url\": \"/api/v2/roles/1382/\",\r\n            \"related\": {\r\n                \"users\": \"/api/v2/roles/1382/users/\",\r\n                \"teams\": \"/api/v2/roles/1382/teams/\",\r\n                \"project\": \"/api/v2/projects/166/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"user_capabilities\": {\r\n                    \"unattach\": true\r\n                },\r\n                \"resource_name\": \"myproject\",\r\n                \"resource_type\": \"project\",\r\n                \"resource_type_display_name\": \"Project\"\r\n            },\r\n            \"name\": \"Use\",\r\n            \"description\": \"Can use the project in a job template\"\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n```\r\nawx --conf.host https://awx.example.com --conf.token mytoken inventory_sources create --inventory 238 --name foobar --source scm --credential 75 --source_project 166 --source_path inventory.py\r\n{\r\n     \"id\": 684,                                                                                                                        \r\n     \"type\": \"inventory_source\",                                                                                                       \r\n     \"url\": \"/api/v2/inventory_sources/684/\",\r\n    ...\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n```\r\nawx --conf.host https://awx.example.com --conf.token mytoken inventory_sources create --inventory 238 --name foobar --source scm --credential 75 --source_project 166 --source_path inventory.py\r\nusage: awx inventory_sources [-h] action ...\r\n\r\npositional arguments:\r\n  action\r\n    list\r\n    get\r\n    modify\r\n    delete\r\n    update\r\n    associate\r\n    disassociate\r\n\r\noptional arguments:\r\n  -h, --help    show this help message and exit\r\n\r\nawx inventory_sources: argument action: invalid choice: 'create' (choose from 'list', 'get', 'modify', 'delete', 'update', 'associate', 'disassociate')\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAssigning OrgAdmin permissions to the user helps, but this shouldn't be necessary.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently when you submit a workflow with an approval as the first step and the workflow is scheduled at later date.\r\nThe approval is requested at the time scheduled, it would be nice to have the possibility to get the approval directly but the job to run at a later date.\r\n\r\n##### ENVIRONMENT\r\nTower: 3.6.3\r\nAnsible: 2.9.9\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a workflow job with a first step being an approval and the next one being a playbook.\r\nAdd a schedule to a later date and run the workflow.\r\nThe approval will only happen at the time scheduled.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe Users > Tokens > description for the token doesn't have a character limit. EDIT: it also doesn't have one for custom credential type descriptions. an audit should be done of all description char limits.\r\n![Screenshot from 2020-07-08 14-51-16](https://user-images.githubusercontent.com/19942822/86959327-9ec9c800-c12b-11ea-9cdd-9aa3fb0ac0a8.png)\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Get a user, go to the tokens tab.\r\n2. Create a token with a very, very long description. \r\n3. Save\r\n\r\n##### EXPECTED RESULTS\r\nIt doesn't let you do that.\r\n\r\n##### ACTUAL RESULTS\r\nIt lets a very long string go through without issues."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea / Improvement\r\n\r\n##### SUMMARY\r\nCurrently:\r\n\r\nWhen fetching Inventories, the value `inventory_sources_with_failures` is currently a count of sources with failures. From a UI perspective, this effectively acts as a boolean (0 or non-zero) to indicate whether the Inventory has a successful (green) sync status or not. When a websocket event shows that an inventory source is updated with a success/failure sync status, the UI does not have enough information to know whether this means the inventory as a whole is now green or red, and additional API calls are required to keep the UI in sync.\r\n\r\nProposed change:\r\n\r\nChange `inventory_sources_with_failures` to list of ids, rather than a count. The UI would be able to add/remove ids to this list in the client and display the Inventory status accurately without making successive calls to the API.\r\n\r\nAlternatively, a separate key could be added to the response that includes the list of ids, to avoid a breaking change.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n1. Have two organizations (id 2 and id 3)\r\n2. Have a job template XYZ, in organization 2\r\n3. Log in as superuser, who is not a member of any organization\r\n4. Add some new labels to job template XYZ\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nsee above\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLabels created in organization 2, as that's the org of the JT\r\n\r\n##### ACTUAL RESULTS\r\n\r\nLabels created in organization 3\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nRsyslog daemon seam to unexpectedly stop publication of events to Splunk HTTP event collector.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.7\r\n* Operating System: RHEL 7\r\n* Web Browser: Firefox 78\r\n\r\n##### STEPS TO REPRODUCE\r\n- Setup external logger to publish events on Splunk HTTP event collector\r\n- Run playbooks\r\n- Wait until events are not published anymore\r\n\r\n##### EXPECTED RESULTS\r\nEvents published to Splunk HTTP event collector\r\n\r\n##### ACTUAL RESULTS\r\nI increased verbosity of logs by adding `$DebugLevel 2` to `/var/lib/awx/rsyslog/rsyslog.conf` file. Like the following :\r\n\r\n```\r\n$DebugLevel 2\r\n$WorkDirectory /var/lib/awx/rsyslog\r\n$MaxMessageSize 700000\r\n$IncludeConfig /var/lib/awx/rsyslog/conf.d/*.conf\r\nmain_queue(queue.spoolDirectory=\"/var/lib/awx\" queue.maxdiskspace=\"1g\" queue.type=\"Disk\" queue.filename=\"awx-external-logger-backlog\")\r\nmodule(load=\"imuxsock\" SysSock.Use=\"off\")\r\ninput(type=\"imuxsock\" Socket=\"/var/run/awx-rsyslog/rsyslog.sock\" unlink=\"on\")\r\ntemplate(name=\"awx\" type=\"string\" string=\"%rawmsg-after-pri%\")\r\nmodule(load=\"omhttp\")\r\naction(type=\"omhttp\" server=\"xxx\" serverport=\"8088\" usehttps=\"on\" allowunsignedcerts=\"on\" skipverifyhost=\"on\" action.resumeRetryCount=\"-1\" template=\"awx\" errorfile=\"/var/log/tower/rsyslog.err\" action.resumeInterval=\"10\" restpath=\"services/collector/event\" httpheaderkey=\"Authorization\" httpheadervalue=\"Splunk xxx\")\r\n```\r\n\r\nAnd then restarted rsyslogd daemon by running:\r\n\r\n```sh\r\ndocker container exec -ti awx_web supervisorctl -c /supervisor.conf restart tower-processes:awx-rsyslogd\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nI get the following logs with `2020-07-07T09:30:38.645Z` as the very last timestamp processed by Splunk. It seams that next events fail to publish because we can see that omHttp try commit action return non-zero code. But I don't see the root cause in logs.\r\n\r\n```\r\n...\r\n2020-07-07T09:30:38.692724000Z  4238.685265456:imuxsock.c     : imuxsock.c: Message from UNIX socket: #4, size 2144\r\n2020-07-07T09:30:38.692933000Z  4238.685275329:imuxsock.c     : parser.c: dropped LF at very end of message (DropTrailingLF is set)\r\n2020-07-07T09:30:38.693141000Z  4238.685279952:imuxsock.c     : datetime.c: ParseTIMESTAMP3339: invalid year: 0, pszTS: '\"'\r\n2020-07-07T09:30:38.693357000Z  4238.685284023:imuxsock.c     : ruleset.c: processBATCH: batch of 1 elements must be processed\r\n2020-07-07T09:30:38.693566000Z  4238.685286499:imuxsock.c     : ruleset.c: processBATCH: next msg 0: <14>{\"event\": {\"@timestamp\": \"2020-07-07T09:30:38.645Z\", \"me\r\nssage\": \"Event data saved.\", \"host\": 149, \"level\": \"INFO\", \"logger_n\r\n2020-07-07T09:30:38.693788000Z  4238.685289404:imuxsock.c     : rainerscript.c:     ACTION 0 [omhttp:action(type=\"omhttp\" ...)]\r\n2020-07-07T09:30:38.693998000Z  4238.685295419:imuxsock.c     : ruleset.c: executing action 0\r\n2020-07-07T09:30:38.694215000Z  4238.685298043:imuxsock.c     : ../action.c: action 'action-0-omhttp': called, logging to omhttp (susp 0/0, direct q 1)\r\n2020-07-07T09:30:38.694425000Z  4238.685301860:imuxsock.c     : ../action.c: action 'action-0-omhttp': is transactional - executing in commit phase\r\n2020-07-07T09:30:38.694640000Z  4238.685304435:imuxsock.c     : ../action.c: actionPrepare[action-0-omhttp]: enter\r\n2020-07-07T09:30:38.694857000Z  4238.685306679:imuxsock.c     : ../action.c: checking external state file\r\n2020-07-07T09:30:38.695066000Z  4238.685308782:imuxsock.c     : ../action.c: done checking external state file, iRet=0\r\n2020-07-07T09:31:00.031976000Z  RESULT 2\r\n2020-07-07T09:31:00.032297000Z  OKREADY\r\n2020-07-07T09:31:07.082980000Z  4267.081868585:imuxsock.c     : imuxsock.c: Message from UNIX socket: #4, size 1236\r\n2020-07-07T09:31:07.083269000Z  4267.081886907:imuxsock.c     : parser.c: dropped LF at very end of message (DropTrailingLF is set)\r\n2020-07-07T09:31:07.083499000Z  4267.081891938:imuxsock.c     : datetime.c: ParseTIMESTAMP3339: invalid year: 0, pszTS: '\"'\r\n2020-07-07T09:31:07.083730000Z  4267.081898096:imuxsock.c     : ruleset.c: processBATCH: batch of 1 elements must be processed\r\n2020-07-07T09:31:07.083950000Z  4267.081901096:imuxsock.c     : ruleset.c: processBATCH: next msg 0: <14>{\"event\": {\"@timestamp\": \"2020-07-07T09:31:07.080Z\", \"me\r\nssage\": \"Event data saved.\", \"host\": 36, \"level\": \"INFO\", \"logger_na\r\n2020-07-07T09:31:07.084173000Z  4267.081904611:imuxsock.c     : rainerscript.c:     ACTION 0 [omhttp:action(type=\"omhttp\" ...)]\r\n2020-07-07T09:31:07.084389000Z  4267.081911077:imuxsock.c     : ruleset.c: executing action 0\r\n2020-07-07T09:31:07.084602000Z  4267.081914375:imuxsock.c     : ../action.c: action 'action-0-omhttp': called, logging to omhttp (susp 0/0, direct q 1)\r\n2020-07-07T09:31:07.084825000Z  4267.081919046:imuxsock.c     : ../action.c: action 'action-0-omhttp': is transactional - executing in commit phase\r\n2020-07-07T09:31:07.085040000Z  4267.081922051:imuxsock.c     : ../action.c: actionPrepare[action-0-omhttp]: enter\r\n2020-07-07T09:31:07.085251000Z  4267.081924724:imuxsock.c     : ../action.c: action 'action-0-omhttp': set suspended state to 0\r\n2020-07-07T09:31:07.085470000Z  4267.081927362:imuxsock.c     : ruleset.c: END batch execution phase, entering to commit phase [processed 1 of 1 messages]\r\n2020-07-07T09:31:07.085680000Z  4267.081930072:imuxsock.c     : ../action.c: actionCommitAllDirect: action 0, state 5, nbr to commit 1 isTransactional 1\r\n2020-07-07T09:31:07.085904000Z  4267.081932513:imuxsock.c     : ../action.c: actionCommit[action-0-omhttp]: enter, 1 msgs\r\n2020-07-07T09:31:07.086140000Z  4267.081934637:imuxsock.c     : ../action.c: actionCommit[action-0-omhttp]: processing...\r\n2020-07-07T09:31:07.086364000Z  4267.081936725:imuxsock.c     : ../action.c: actionTryCommit[action-0-omhttp] enter\r\n2020-07-07T09:31:07.086578000Z  4267.081938889:imuxsock.c     : ../action.c: actionPrepare[action-0-omhttp]: enter\r\n2020-07-07T09:31:07.086804000Z  4267.081941372:imuxsock.c     : ../action.c: doTransaction: action 'action-0-omhttp', currIParam 1\r\n2020-07-07T09:31:07.087017000Z  4267.081943473:imuxsock.c     : ../action.c: actionPrepare[action-0-omhttp]: enter\r\n2020-07-07T09:31:07.087235000Z  4267.081945859:imuxsock.c     : ../action.c: doTransaction: action 0, processing msg 0, result -2218\r\n2020-07-07T09:31:07.087458000Z  4267.081948059:imuxsock.c     : ../action.c: actionCommit[action-0-omhttp]: return actionTryCommit -2218\r\n2020-07-07T09:31:07.087669000Z  4267.081950261:imuxsock.c     : ../action.c: actionCommit[action-0-omhttp]: done, iRet -2218\r\n2020-07-07T09:31:07.090779000Z  4267.081952391:imuxsock.c     : ruleset.c: processBATCH: batch of 1 elements has been processed2020-07-07T09:31:07.091045000Z  4267.081957182:imuxsock.c     : imuxsock.c: --------imuxsock calling poll() on 2 fds\r\n2020-07-07T09:31:07.098515000Z  4267.097736092:imuxsock.c     : imuxsock.c: Message from UNIX socket: #4, size 1911\r\n2020-07-07T09:31:07.098803000Z  4267.097756048:imuxsock.c     : parser.c: dropped LF at very end of message (DropTrailingLF is set)\r\n2020-07-07T09:31:07.099032000Z  4267.097761546:imuxsock.c     : datetime.c: ParseTIMESTAMP3339: invalid year: 0, pszTS: '\"'\r\n2020-07-07T09:31:07.099255000Z  4267.097767933:imuxsock.c     : ruleset.c: processBATCH: batch of 1 elements must be processed\r\n2020-07-07T09:31:07.099472000Z  4267.097771126:imuxsock.c     : ruleset.c: processBATCH: next msg 0: <14>{\"event\": {\"@timestamp\": \"2020-07-07T09:31:07.093Z\", \"message\": \"Event data saved.\", \"host\": 670, \"level\": \"INFO\", \"logger_n\r\n2020-07-07T09:31:07.099712000Z  4267.097774770:imuxsock.c     : rainerscript.c:     ACTION 0 [omhttp:action(type=\"omhttp\" ...)]\r\n2020-07-07T09:31:07.099932000Z  4267.097781233:imuxsock.c     : ruleset.c: executing action 0\r\n2020-07-07T09:31:07.100151000Z  4267.097784508:imuxsock.c     : ../action.c: action 'action-0-omhttp': called, logging to omhttp (susp 0/0, direct q 1)\r\n2020-07-07T09:31:07.100367000Z  4267.097789530:imuxsock.c     : ../action.c: action 'action-0-omhttp': is transactional - executing in commit phase\r\n2020-07-07T09:31:07.100580000Z  4267.097792267:imuxsock.c     : ../action.c: actionPrepare[action-0-omhttp]: enter\r\n2020-07-07T09:31:07.100801000Z  4267.097795152:imuxsock.c     : ../action.c: action 'action-0-omhttp': set suspended state to 0\r\n2020-07-07T09:31:07.101020000Z  4267.097797424:imuxsock.c     : ruleset.c: END batch execution phase, entering to commit phase [processed 1 of 1 messages]\r\n2020-07-07T09:31:07.101231000Z  4267.097800529:imuxsock.c     : ../action.c: actionCommitAllDirect: action 0, state 5, nbr to commit 1 isTransactional 1\r\n2020-07-07T09:31:07.101456000Z  4267.097803055:imuxsock.c     : ../action.c: actionCommit[action-0-omhttp]: enter, 1 msgs\r\n2020-07-07T09:31:07.101669000Z  4267.097805090:imuxsock.c     : ../action.c: actionCommit[action-0-omhttp]: processing...\r\n2020-07-07T09:31:07.101937000Z  4267.097807151:imuxsock.c     : ../action.c: actionTryCommit[action-0-omhttp] enter\r\n2020-07-07T09:31:07.102149000Z  4267.097809295:imuxsock.c     : ../action.c: actionPrepare[action-0-omhttp]: enter\r\n2020-07-07T09:31:07.102364000Z  4267.097811763:imuxsock.c     : ../action.c: doTransaction: action 'action-0-omhttp', currIParam 1\r\n2020-07-07T09:31:07.102572000Z  4267.097813873:imuxsock.c     : ../action.c: actionPrepare[action-0-omhttp]: enter\r\n2020-07-07T09:31:07.102790000Z  4267.097816217:imuxsock.c     : ../action.c: doTransaction: action 0, processing msg 0, result -2218\r\n2020-07-07T09:31:07.103001000Z  4267.097818403:imuxsock.c     : ../action.c: actionCommit[action-0-omhttp]: return actionTryCommit -2218\r\n2020-07-07T09:31:07.103215000Z  4267.097820562:imuxsock.c     : ../action.c: actionCommit[action-0-omhttp]: done, iRet -2218\r\n2020-07-07T09:31:07.103433000Z  4267.097822641:imuxsock.c     : ruleset.c: processBATCH: batch of 1 elements has been processed\r\n2020-07-07T09:31:07.103651000Z  4267.097827025:imuxsock.c     : imuxsock.c: --------imuxsock calling poll() on 2 fds\r\n...\r\n```\r\n\r\n\r\nIt somtimes works again after a manual trigger of Rsyslogd restart with this cmd, but never for a long time...\r\n\r\n```sh\r\ndocker container exec -ti awx_web supervisorctl -c /supervisor.conf restart tower-processes:awx-rsyslogd\r\n```\r\n\r\nCan you help me to identify and fix the root cause ?\r\nThank you\r\n\r\n**Edit**: \r\nI found a first clue : Rsyslog error code 2218 is about failure caused by data passed to action. (https://www.rsyslog.com/rsyslog-error-2218/)\r\nMaybe we can dig in this direction ?"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nModules in the `azure.azcollection` Galaxy collection fail due to a missing API version.\r\n\r\nBased on issues opened in the Azure collection like [this](https://github.com/ansible-collections/azure/issues/136), it seems as if the culprit is outdated azure packages in the python virtual environment.\r\n\r\nHow can I ensure that the collections downloaded automatically by AWX can execute successfully?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0\r\n* AWX install method: docker on Linux\r\n* Ansible version:  2.9.10\r\n* Operating System: MacOS Catalina\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Enable collection download from AWX Jobs settings (using public Galaxy)\r\n1. Define a collection in `/collections/requirements.yml` like this:\r\n\r\n```yaml\r\n---\r\ncollections:\r\n  - name: azure.azcollection\r\n```\r\n1. Define a playbook that utilizes the collection:\r\n\r\n```yaml\r\n---\r\n- hosts: localhost\r\n  connection: local\r\n  gather_facts: true\r\n  collections:\r\n    - azure.azcollection\r\n  tasks:\r\n    - name: Get vm info\r\n      azure_rm_virtualmachine_info:\r\n        resource_group: rg-awxdev\r\n        subscription_id: xxxx-xxxxxxxx-xxxxx\r\n        name: testvm01\r\n        auth_source: msi\r\n      register: output\r\n    - debug:\r\n        var: output\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo errors, like when I run the module without the collection specified (which uses the `/ansible/modules/cloud/azure` module).\r\n![Screen Shot 2020-07-02 at 11 29 54 AM](https://user-images.githubusercontent.com/18073815/86378355-92d79500-bc57-11ea-8903-e936b278ecce.png)\r\n\r\n##### ACTUAL RESULTS\r\n\r\nModule fails due to a missing API version, and I can see that by executing `/var/lib/awx/venv/ansible/bin/pip3.6 freeze` in the container, the versions of `azure-mgmt-*` are much older than those defined by the [Azure Collection's requirements file](https://github.com/ansible-collections/azure/blob/v0.1.3/requirements-azure.txt).\r\n![86377033-d03b2300-bc55-11ea-84c2-d17fa3fe4684](https://user-images.githubusercontent.com/18073815/87079210-b3719300-c1f3-11ea-988b-3319623071ed.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nPackage versions:\r\n- Left is the output of `/var/lib/awx/venv/ansible/bin/pip3.6 freeze` when executed from *awx_task*.\r\n- Right is https://github.com/ansible-collections/azure/blob/v0.1.3/requirements-azure.txt\r\n![Screen Shot 2020-07-02 at 11 39 47 AM](https://user-images.githubusercontent.com/18073815/86379370-c2d36800-bc58-11ea-9477-32d531b142e2.png)\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI tried to follow https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md as close as possible. First tests (possibly incomplete) with the new venv seemed successful. Now the inventory sync failes. I'm sure it's my fault, but I don't see it.\r\n\r\nPlease advise what I could check.\r\n\r\nKind regards,\r\nDietmar\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.5\r\n* Operating System: Oracle Linux 7.8\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nFollow https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md (see below). Log in to your Docker host.\r\n\r\n```\r\nsu - awx\r\ncd .awx/awxcompose\r\nvi docker-compose.yml\r\n--> in \"web:\" and \"task:\"\r\n    volumes:\r\n       …\r\n      - \"~/venv:/opt/custom_venvs/:rw\"\r\ndocker-compose up\r\n\r\ndocker exec -it CONTAINER_ID /bin/bash\r\n\r\nvirtualenv /opt/custom_venvs/rdsintra\r\n/opt/custom_venvs/rdsintra/bin/pip install /opt/custom_venvs/pykeepass-3.2.0.tar.gz\r\n(I also manually installed dependencies to pykeepass. This machine has no direct internet access.)\r\n```\r\n\r\nI installed psutil into the Docker volume from within the Docker host as the container image doesn't include gcc. It's just luck that both Linuxes are close enough...\r\n\r\nLast I assigned the venv to my organization, to the project, and the template, as stated in https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md#assigning-custom-virtualenvs.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nInventory should get synced.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nProblem: Inventory sync failes:\r\n```\r\n    4.546 INFO     Updating inventory 9: DB Phase 1 - SE\r\n    5.522 INFO     Reading Ansible inventory source: /tmp/awx_1746_v4upcq0x/project/roles/rdsintra/inv_phase1.yml\r\n    5.526 INFO     Using VIRTUAL_ENV: /opt/custom_venvs/rdsintra/\r\n    5.526 INFO     Using PATH: /opt/custom_venvs/rdsintra/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    5.527 INFO     Using PYTHONPATH: /opt/custom_venvs/rdsintra/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1151, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1041, in handle\r\n    venv_path=venv_path, verbosity=self.verbosity).load()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 215, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 198, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/ansible-inventory\", line 34, in <module>\r\n    from ansible import context\r\nModuleNotFoundError: No module named 'ansible'\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNone.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIf reverse proxy host(name or IP) is in inventory of Tower and run curl, I get {\"msg\":\"Multiple hosts matched the request!\"} error message.\r\n\r\n##### ENVIRONMENT\r\n* Ansible Tower version: 3.7.0\r\n* Operating System: RHEL 7.7\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nOur infrastructure: 3 hosts\r\n1) external tester host (run curl for the callbacks) : 172.31.1.55\r\n2) reverse proxy host : 172.31.8.131\r\n3) internal tester host (Tower run on this host) : 172.31.4.170\r\n\r\nIf the reverse proxy host(name or IP) is in inventory of Tower on internal tester host and run curl on external tester host, I get {\"msg\":\"Multiple hosts matched the request!\"} error message.\r\nConfirmed that Provisioning Callback does not work if reverse proxy host(name or IP) is in inventory of Tower.\r\nHowever, If I remove the reverse proxy host(name or IP) from the inventory of Tower and rerun curl for Provisioning Callback, I don’t see the error message.\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n[root@ip-172-31-1-55 ~]# curl -kvvv -H \"X-Forwarded-For: 172.31.8.131\" -d \"host_config_key=c239daf4-fd15-40da-a562-71d08a41b620\" https://172.31.4.170/api/v2/job_templates/14/callback/ -v\r\n* About to connect() to 172.31.4.170 port 443 (#0)\r\n*   Trying 172.31.4.170...\r\n* Connected to 172.31.4.170 (172.31.4.170) port 443 (#0)\r\n* Initializing NSS with certpath: sql:/etc/pki/nssdb\r\n* skipping SSL peer certificate verification\r\n* SSL connection using TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\r\n* Server certificate:\r\n* \tsubject: CN=localhost\r\n* \tstart date: Jul 01 00:27:36 2020 GMT\r\n* \texpire date: Oct 03 00:27:36 2022 GMT\r\n* \tcommon name: localhost\r\n* \tissuer: CN=localhost\r\n> POST /api/v2/job_templates/14/callback/ HTTP/1.1\r\n> User-Agent: curl/7.29.0\r\n> Host: 172.31.4.170\r\n> Accept: */*\r\n> X-Forwarded-For: 172.31.8.131\r\n> Content-Length: 52\r\n> Content-Type: application/x-www-form-urlencoded\r\n> \r\n* upload completely sent off: 52 out of 52 bytes\r\n< HTTP/1.1 400 Bad Request\r\n< Server: nginx\r\n< Date: Thu, 02 Jul 2020 00:38:29 GMT\r\n< Content-Type: application/json\r\n< Content-Length: 45\r\n< Connection: keep-alive\r\n< Vary: Accept, Accept-Language, Origin, Cookie\r\n< Allow: GET, POST, HEAD, OPTIONS\r\n< X-API-Product-Version: 3.7.1\r\n< X-API-Product-Name: Red Hat Ansible Tower\r\n< X-API-Node: localhost\r\n< X-API-Time: 0.089s\r\n< Content-Language: en\r\n< X-API-Total-Time: 0.118s\r\n< \r\n* Connection #0 to host 172.31.4.170 left intact\r\n{\"msg\":\"Multiple hosts matched the request!\"}[root@ip-172-31-1-55 ~]# \r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n       \r\n![Screenshot from 2020-07-02 10-41-54](https://user-images.githubusercontent.com/58404577/86304002-dbd81b00-bc50-11ea-8647-c8423093cbda.png)\r\n\r\n    \r\n##### EXPECTED RESULTS\r\nEven if a reverse proxy host(name or IP) is in inventory of Tower, it may need to be successfully run curl for Provisioning Callback. \r\n\r\n##### ACTUAL RESULTS\r\nIf reverse proxy host(name or IP) is in inventory of Tower and run curl, I get {\"msg\":\"Multiple hosts matched the request!\"} error message.\r\n\r\n##### ADDITIONAL INFORMATION\r\nNone\r\n"},{"labels":["api",null,null,null],"text":"##### STEPS TO REPRODUCE\r\n\r\n* Create a job template that has a survey with required variables\r\n* Create a schedule for that job\r\n* disable the schedule\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* To be able to disable the schedule\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`{\"variables_needed_to_start\":[\"'no_spaces' value missing\"]}` where `no_spaces` is the name of the job template survey required variable.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPATCH\r\n\r\n`{\"enabled\":true}`\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Enhancement\r\n\r\n##### COMPONENT NAME\r\n- API\r\n- UI\r\n\r\n##### SUMMARY\r\n- Keystone v3 requires user_domain_name  to authenticate, but AWX openstack credential doesn't provide / request those in the credential templating.\r\n\r\nCurrently when the cloud.yml file is generated it is populated with:\r\n\r\n```\r\nclouds:\r\n  devstack:\r\n    auth:\r\n      auth_url: \r\n      domain_name: \r\n      password:\r\n      project_name:\r\n      username:\r\n\r\n```\r\nInstead for v3 this should include \"user_domain_name\" & \"project_domain_name\" :\r\n```\r\nclouds:\r\n  devstack:\r\n    auth:\r\n      auth_url: \r\n      domain_name:\r\n      password:\r\n      project_name:\r\n      project_domain_name:\r\n      username: \r\n      user_domain_name:\r\n```\r\n##### STEPS TO REPRODUCE\r\n- No steps needed as it's a feature request."},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Add webhook service support for Jira Service Desk automation\r\n\r\n##### SUMMARY\r\nMy small engineering team would like to use Jira Service Desk (JSD) automation rules to facilitate user self-service for common, low-risk requests. Most of our requests are already automated using Ansible playbooks and roles, however, we currently have to use Jenkins to provide self-service. The desired goal would be to trigger a job template from a JSD webhook payload. The final step of the role/playbook would be to update the Jira issue via API with success or failure. To that end, we need the contents of the JSD payload available to playbooks and roles so we can execute based upon custom fields for each request type.\r\n\r\nFor example, say a developer wants to pull production down to stage. The JSD request type requires approval from a member of QA so any ongoing work in our test environment does not get blown away. Once that approval is received, JSD sends a POST webhook containing the standard issue payload containing two custom fields (eg. source and target). The webhook triggers a job template which passes the payload to Ansible as a known variable, say perhaps tower_webhook_payload, which can then be used as needed. At that point we'd have the Jira issue id and could post back to Jira REST api to update the status of the issue.\r\n\r\nhttps://developer.atlassian.com/server/jira/platform/jira-service-desk-webhooks/\r\n\r\nPayload details:\r\n```\r\n{\r\n    \"issue\" : {\r\n        \"id\": \"18001\",\r\n        \"self\": \"https://mycompany.atlassian.net/rest/api/2/issue/18001\",\r\n        \"key\": \"IT-4\",\r\n        \"fields\": {\r\n            \"summary\" : \"I cannot get my second screen to work\",\r\n            \"description\" : \"Have tried multiple ports, cables, but no luck\",\r\n            \"status\" : {\r\n                \"name\" : \"Waiting for Support\",\r\n                ...\r\n            },\r\n            \"reporter\" : {\r\n                \"name\" : \"jsmith\",\r\n                ...\r\n            },\r\n            ...\r\n        }\r\n    },\r\n    \"timestamp\" : 1462941258113 // Time when webhook was fired - UTC milliseconds from epoch\r\n}\r\n```\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nAdd support for cluster mode with docker-compose method of deploy\r\n\r\n##### SUMMARY\r\nWith the official role we can already set up the `docker-compose.yml` on multiple machines but they will not go in cluster mode as all will report as awx (both in `CLUSTER_HOST_ID` and by the hostname of the `awx_task `container), if we change the `settings.py` to get the `CLUSTER_HOST_ID` by environment variable, the hostname in `docker-compose.yml` (paired with `CLUSTER_HOST_ID`) and send `CLUSTER_HOST_ID` in `environment.sh.j2` we can easily create an AWX cluster running on top of a few simple docker-composes.\r\n\r\nI am already working on this possibility, but I would like to know how much these changes will impact the deployment through Kubernetes or OpenShift since it will affect the image of the container.\r\n\r\nLink to my fork: https://github.com/bryanasdev000/awx/commits/clustering\r\n\r\nI would also like to understand the role of UUID in this case (join / left of the cluster) since a quick look at the code shows me that it uses hostname and `CLUSTER_HOST_ID` only.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen running a playbook with the pip module from a container group where the executable parameter is set, job errors out with encrypted playbook response and error:\r\n\r\n```shell\r\nSyntaxError: EOF while scanning triple-quoted string literal\r\ncommand terminated with exit code 1\r\n\", \"module_stdout\": \"\", \"msg\": \"MODULE FAILURE\r\nSee stdout/stderr for the exact error\", \"rc\": 1} PLAY RECAP ********************************************************************* awx-job-29124 : ok=3 changed=2 unreachable=0 failed=1 skipped=1 rescued=0 ignored=\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method: docker\r\n* Ansible version:  2.9.5\r\n* Operating System: CentOS 7\r\n* Web Browser: Firefox \r\n\r\n##### STEPS TO REPRODUCE\r\nPlaybook task as below using Python3 interpreter.\r\n\r\n```yaml\r\n    - name: Install Openshift Python Library\r\n      pip:\r\n        name: openshift\r\n        executable: pip3\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob to run and pip to install while forwarding errors to the output window.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nJob executes on target k8s cluster, pod gets created then terminates after 45 seconds. Job in AWX Errors with encrypted error details and SyntaxError: EOF while scanning triple-quoted string literal at the end.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nJob executes on leaf node using direct SSH without issue, error only occurs when using container groups.\r\n\r\nI was originally running the hardcoded executable parameter when it was using the auto_legacy interpreter discovery. When using python2 it, understandably, fails due to my node not having setuptools for python2 installed.  Job executes successfully in all scenarios tested if the executable parameter is not declared.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Make sure that exported metrics conform with Prometheus best practices\r\n\r\n##### SUMMARY\r\nI have made a PR at Prometheus docs to add AWX as a software exposing Prometheus metrics (https://github.com/prometheus/docs/pull/1685#issuecomment-649323355) and after a quick peek at AWX metrics code from @brian-brazil, he appointed a few things to change. I have see a few others open issues about metrics too, so maybe a check with a guideline or something like that can benefit AWX monitoring.\r\n\r\nNOTE: I am not familiar with any of the code bases of the projects, I am simply messenger interested in both projects.\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAWS EC2 inventory sync is no longer pulling down hosts after moving to version 13.0.0, but job status completes as successful.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 13.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.10\r\n* Operating System: RHEL 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAttempt to run an EC2 inventory sync on AWX v13.0.0\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe EC2 inventory sync would pull down more than 0 hosts and update the facts for the hosts in the inventory.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n    3.064 INFO     Updating inventory 8: Windows_Servers\r\n    3.740 INFO     Reading Ansible inventory source: /tmp/awx_9945_1ckq7nqv/aws_ec2.yml\r\n    3.742 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    3.742 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    3.742 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\n    5.288 ERROR    ansible-inventory 2.9.10\r\n    5.288 ERROR      config file = /etc/ansible/ansible.cfg\r\n    5.288 ERROR      configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n    5.288 ERROR      ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n    5.288 ERROR      executable location = /usr/bin/ansible-inventory\r\n    5.288 ERROR      python version = 3.6.8 (default, Apr 16 2020, 01:36:27) [GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]\r\n    5.289 ERROR    Using /etc/ansible/ansible.cfg as config file\r\n    5.289 ERROR    Parsed /tmp/awx_9945_1ckq7nqv/aws_ec2.yml inventory source with auto plugin\r\n    5.289 INFO     Processing JSON output...\r\n    5.289 INFO     Loaded 1 groups, 0 hosts\r\n2020-06-25 14:12:04,531 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=8\r\n2020-06-25 14:12:04,555 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=8, in 0.023 seconds\r\n    5.345 INFO     Inventory import completed for AWS - US-EAST-1 (N. Virginia) - EC2 - Windows - Prod in 2.3s\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nInstance Filters: tag:Platform=Windows*,tag:Environment=PROD\r\n\r\nSource Variables: \r\nhostname_variable: 'tag:name=value'\r\ndestination_format: \"{0}.OUR.DOMAIN.COM\"\r\ndestination_format_tags: Name\r\nstack_filters: True\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* AWX install method: any\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n1) Create an org and a team (link the team to the org)\r\n2) Create a new credential via the API and pass the team ID as the owner field:\r\n\r\n```json\r\n{\r\n    \"name\": \"Test\",\r\n    \"description\": \"\",\r\n    \"organization\": null,\r\n    \"credential_type\": 1,\r\n    \"inputs\": {},\r\n    \"user\": null,\r\n    \"team\": 4\r\n}\r\n```\r\n\r\n3) Check the credentials owners:\r\n\r\nVia API:\r\n\r\n```json\r\n        \"owners\": [\r\n            {\r\n                \"id\": 82,\r\n                \"type\": \"organization\",\r\n                \"name\": \"Ansible\",\r\n                \"description\": \"\",\r\n                \"url\": \"/api/v2/organizations/82/\"\r\n            },\r\n            {\r\n                \"id\": 4,\r\n                \"type\": \"team\",\r\n                \"name\": \"Ansible IT\",\r\n                \"description\": \"\",\r\n                \"url\": \"/api/v2/teams/4/\"\r\n            }\r\n        ]\r\n```\r\n\r\nVia UI:\r\n\r\n![Screenshot from 2020-06-24 15-35-20](https://user-images.githubusercontent.com/48132/85619475-5a6d0100-b630-11ea-9ae1-de2c09b2355f.png)\r\n\r\n4) Use awx cli to export the resources `awx --conf.username user --conf.password 'pass' --conf.host \"https://awx.example.com/\" -k export > export.json`. Checking the exported data:\r\n\r\nThe team was exported as:\r\n\r\n```json\r\n          {\r\n               \"name\": \"Ansible IT\",\r\n               \"description\": \"\",\r\n               \"organization\": {\r\n                    \"name\": \"Ansible\",\r\n                    \"type\": \"organization\"\r\n               },\r\n               \"related\": {\r\n                    \"roles\": [\r\n                         {\r\n                              \"name\": \"Use\",\r\n                              \"type\": \"role\",\r\n                              \"content_object\": {\r\n                                   \"organization\": {\r\n                                        \"name\": \"Ansible\",\r\n                                        \"type\": \"organization\"\r\n                                   },\r\n                                   \"name\": \"Test\",\r\n                                   \"credential_type\": {\r\n                                        \"name\": \"Machine\",\r\n                                        \"kind\": \"ssh\",\r\n                                        \"type\": \"credential_type\"\r\n                                   },\r\n                                   \"type\": \"credential\"\r\n                              }\r\n                         }\r\n                    ]\r\n               },\r\n               \"natural_key\": {\r\n                    \"organization\": {\r\n                         \"name\": \"Ansible\",\r\n                         \"type\": \"organization\"\r\n                    },\r\n                    \"name\": \"Ansible IT\",\r\n                    \"type\": \"team\"\r\n               }\r\n          }\r\n```\r\n\r\nThe credential was exported as:\r\n\r\n```json\r\n          {\r\n               \"name\": \"Test\",\r\n               \"description\": \"\",\r\n               \"inputs\": {},\r\n               \"organization\": {\r\n                    \"name\": \"Ansible\",\r\n                    \"type\": \"organization\"\r\n               },\r\n               \"credential_type\": {\r\n                    \"name\": \"Machine\",\r\n                    \"kind\": \"ssh\",\r\n                    \"type\": \"credential_type\"\r\n               },\r\n               \"natural_key\": {\r\n                    \"organization\": {\r\n                         \"name\": \"Ansible\",\r\n                         \"type\": \"organization\"\r\n                    },\r\n                    \"name\": \"Test\",\r\n                    \"credential_type\": {\r\n                         \"name\": \"Machine\",\r\n                         \"kind\": \"ssh\",\r\n                         \"type\": \"credential_type\"\r\n                    },\r\n                    \"type\": \"credential\"\r\n               }\r\n          }\r\n```\r\n\r\nAnd the org was exported as:\r\n\r\n```json\r\n          {\r\n               \"name\": \"Ansible\",\r\n               \"description\": \"\",\r\n               \"max_hosts\": 0,\r\n               \"custom_virtualenv\": null,\r\n               \"related\": {\r\n                    \"notification_templates\": [],\r\n                    \"notification_templates_started\": [],\r\n                    \"notification_templates_success\": [],\r\n                    \"notification_templates_error\": [],\r\n                    \"notification_templates_approvals\": []\r\n               },\r\n               \"natural_key\": {\r\n                    \"name\": \"Ansible\",\r\n                    \"type\": \"organization\"\r\n               }\r\n          },\r\n```\r\n\r\n5) Delete the credential and import it from the exported data. Check its owners:\r\n\r\nVia API:\r\n\r\n```json\r\n        \"owners\": [\r\n            {\r\n                \"id\": 82,\r\n                \"type\": \"organization\",\r\n                \"name\": \"Ansible\",\r\n                \"description\": \"\",\r\n                \"url\": \"/api/v2/organizations/82/\"\r\n            }\r\n        ]\r\n```\r\n\r\nVia UI:\r\n\r\n![Screenshot from 2020-06-24 15-43-04](https://user-images.githubusercontent.com/48132/85620264-88067a00-b631-11ea-80c6-1278cd36f172.png)\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nImporting credentials should keep the owners as when it was exported.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nAfter importing, the credential does not have the same owners as when it was exported.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nGET request at /api/v2/teams/4/roles/ returned similar roles before and after the import:\r\n\r\n```json\r\n{\r\n    \"count\": 1,\r\n    \"next\": null,\r\n    \"previous\": null,\r\n    \"results\": [\r\n        {\r\n            \"id\": 1462,\r\n            \"type\": \"role\",\r\n            \"url\": \"/api/v2/roles/1462/\",\r\n            \"related\": {\r\n                \"users\": \"/api/v2/roles/1462/users/\",\r\n                \"teams\": \"/api/v2/roles/1462/teams/\",\r\n                \"credential\": \"/api/v2/credentials/42/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"user_capabilities\": {\r\n                    \"unattach\": true\r\n                },\r\n                \"resource_name\": \"Test\",\r\n                \"resource_type\": \"credential\",\r\n                \"resource_type_display_name\": \"Credential\",\r\n                \"resource_id\": 42\r\n            },\r\n            \"name\": \"Use\",\r\n            \"description\": \"Can use the credential in a job template\"\r\n        }\r\n    ]\r\n}\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Repor\r\n\r\n##### SUMMARY\r\n\r\nbecause inventory script /api/v2/inventory_scripts/ is deprecated i try to migrate to project_source \r\n\r\nthe refresh source in awx stuck but cmd awx-manage inventory_import is work. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 12.0.0\r\n* AWX install method: docker\r\n* Ansible version:  2.9.9\r\n* Operating System: redhat\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nset source to inventory with project and target script python , default venv and try refresh (verbose mode)\r\n\r\n##### EXPECTED RESULTS\r\n\r\ninventory import success or display error in ui \r\n\r\n##### ACTUAL RESULTS\r\n\r\nthe refresh job stuck\r\n\r\n    2.567 INFO     Updating inventory 64: equipe_itg\r\n    3.120 DEBUG    Using base command: python /usr/bin/ansible-inventory -i /tmp/awx_253_8cmyst9w/project/get_inventory/consul/cmdb_ansible.py --playbook-dir /tmp/awx_253_8cmyst9w/project/get_inventory/consul -vvvvv\r\n    3.120 INFO     Reading Ansible inventory source: /tmp/awx_253_8cmyst9w/project/get_inventory/consul/cmdb_ansible.py\r\n    3.122 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible/\r\n    3.122 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    3.122 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages: \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nmanually exec cmd work correctly \r\n\r\npython /usr/bin/ansible-inventory -i /tmp/awx_253_8cmyst9w/project/get_inventory/consul/cmdb_ansible.py --playbook-dir /tmp/awx_253_8cmyst9w/project/get_inventory/consul -vvvvv\r\n\r\nor\r\n\r\n/var/lib/awx/venv/awx/bin/python3 /var/lib/awx/venv/awx/bin/awx-manage inventory_import --inventory-id 64 --venv /var/lib/awx/venv/ansible/ --group-filter ^.+$ --host-filter ^.+$ --source /tmp/awx_245_v_3e74cs/project/get_inventory/consul/cmdb_ansible.py -v2\r\n\r\n    2.464 INFO     Updating inventory 64: equipe_itg\r\n    3.279 DEBUG    Using base command: python /usr/bin/ansible-inventory -i /tmp/awx_245_v_3e74cs/project/get_inventory/consul/cmdb_ansible.py --playbook-dir /tmp/awx_245_v_3e74cs/project/get_inventory/consul -vvvvv\r\n    3.280 INFO     Reading Ansible inventory source: /tmp/awx_245_v_3e74cs/project/get_inventory/consul/cmdb_ansible.py\r\n    3.282 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible/\r\n    3.282 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/ansible/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    3.282 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\n    8.986 ERROR    ansible-inventory 2.9.9\r\n    8.986 ERROR      config file = /etc/ansible/ansible.cfg\r\n    8.986 ERROR      configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n    8.986 ERROR      ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n    8.986 ERROR      executable location = /usr/bin/ansible-inventory\r\n    8.986 ERROR      python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\n    8.986 ERROR    Using /etc/ansible/ansible.cfg as config file\r\n    8.986 ERROR    setting up inventory plugins\r\n    8.986 ERROR    host_list declined parsing /tmp/awx_245_v_3e74cs/project/get_inventory/consul/cmdb_ansible.py as it did not pass its verify_file() method\r\n    8.986 ERROR    Parsed /tmp/awx_245_v_3e74cs/project/get_inventory/consul/cmdb_ansible.py inventory source with script plugin\r\n    8.987 DEBUG    Finished loading from source: /tmp/awx_245_v_3e74cs/project/get_inventory/consul/cmdb_ansible.py\r\n    8.987 INFO     Processing JSON output...\r\n    8.987 DEBUG    Loaded group: all\r\n    8.987 DEBUG    Loaded group: integration_cnaf_va_linux_apache_standard\r\n    8.987 DEBUG    Adding child group integration_cnaf_va_linux_apache_standard to parent all\r\n2020-06-24 10:04:49,329 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=64\r\n2020-06-24 10:04:49,368 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=64, in 0.038 seconds\r\n    9.283 INFO     Inventory import completed for  (equipe_itg - 29) in 6.8s\r\n\r\n\r\nvault_password appear when cancel job in ui \r\n\r\n![image](https://user-images.githubusercontent.com/27526373/85540266-13bedd00-b617-11ea-9be0-b0ddd4adc825.png)\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\nI have a HA AWX with 2 instances (actif /actif) with a LB (HAPROXY), everything works good, but when i try to run a job works but i get 500 error when i try te see the job details.\r\nLog :\r\n\r\nawx.main.models.events.ProjectUpdateEvent.MultipleObjectsReturned: get() returned more than one ProjectUpdateEvent -- it returned 2\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For new features, show how the feature would be used. For bugs, please show\r\nexactly how to reproduce the problem. Ideally, provide all steps and data needed\r\nto recreate the bug from a new awx install. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen upgrading from AWX 11.2.0 to 12.0.0 we get permission denied with API-request with the admin account. \r\n\r\n```\r\n[22/Jun/2020:13:48:35 +0000] \"GET /api/v2/settings/all/ HTTP/1.1\" 200 11354 \"-\" \"python-requests/2.23.0\" \"-\"\r\n2020-06-22 13:48:35,685 INFO     awx.api.authentication User admin performed a OPTIONS to /api/v2/settings/all/ through the API\r\n2020/06/22 13:48:36 [crit] 89#0: *7 open() \"/var/lib/nginx/tmp/uwsgi/1/00/0000000001\" failed (13: Permission denied) while reading upstream, client: **OMITTED**, server: _, request: \"OPTIONS /api/v2/settings/all/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: **\"OMITTED\"**\r\n```\r\nRunning `chown -R nginx:nginx /var/lib/nginx` on the `awx_web` container fixes the issue (Though I doubt this is the recommended way of solving it?)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 12.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.9\r\n* Operating System: CentOS 8\r\n* Web Browser: n/a\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a tower-cli command with admin account in tower-cli config\r\n\r\n##### EXPECTED RESULTS\r\n\r\non 11.2.0 the command admin had access to run the command setting any setting.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPermission denied\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nRemove activity stream entries older than a certain number of days fails with an error\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 12.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.9\r\n* Operating System: CentOS\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun management job to remove activity stream entries older than a certain number of days \r\n\r\n##### EXPECTED RESULTS\r\n\r\nold activity stream entries older than a certain number of days removed\r\n\r\n##### ACTUAL RESULTS\r\n\r\n` \r\n```\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\npsycopg2.errors.DiskFull: could not write to tuplestore temporary file: No space left on device\r\nThe above exception was the direct cause of the following exception:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/sql/compiler.py\", line 1140, in execute_sql\r\n    cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 67, in execute\r\n    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 76, in _execute_with_wrappers\r\n    return executor(sql, params, many, context)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/utils.py\", line 89, in __exit__\r\n    raise dj_exc_value.with_traceback(traceback) from exc_value\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\ndjango.db.utils.OperationalError: could not write to tuplestore temporary file: No space left on device\r\nDuring handling of the above exception, another exception occurred:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 154, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/cleanup_activitystream.py\", line 70, in handle\r\n    self.cleanup_activitystream()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/cleanup_activitystream.py\", line 44, in cleanup_activitystream\r\n    for asobj in ActivityStream.objects.iterator():\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 341, in _iterator\r\n    yield from self._iterable_class(self, chunked_fetch=use_chunked_fetch, chunk_size=chunk_size)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 55, in __iter__\r\n    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/sql/compiler.py\", line 1143, in execute_sql\r\n    cursor.close()\r\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_140645989772160_1\" does not exist\r\n\r\n```\r\n `\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIt is not a disk space issue:\r\n\r\n\r\n\r\n```\r\n# df -kh | grep ansible\r\n\r\n/dev/mapper/vg_system-lv_ansible      45G   36G  7.0G  84% /ansible\r\n\r\n# cd /ansible/pgdocker/\r\n# du . -sh\r\n23G     .\r\n```\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nScheduled jobs that end up with error because their running time is over the specified timeout threshold for said job are not triggering a \"failed notification\". This used to work in AWX 8.0.0.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 12.0.0\r\n* AWX install method: docker on Linux\r\n* Ansible version:  2.9.9\r\n* Operating System: CentOS7\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create some notifications in an AWX instance. I'm my case I'm trying with \"email\" and \"Slack\" notification types.\r\n\r\n2. Create or modify an AWX job and set the following:\r\n\r\n   * An \"On error\" notification.\r\n   * A timeout. In order to reproduce the bug I recommend setting up an abnormally short timeout. In my case I'm trying with 5s.\r\n\r\n3. Run the job and be sure to make it fail due to timeout.\r\n\r\n4. Verify that no \"failure notification\" is triggered.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA \"failure\" notification should be triggered. This is the behavior that AWX 8.0.0 used to have.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo notification is triggered and the job fails silently.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nScreenshot of a failed job reporting a timeout error:\r\n\r\n![image](https://user-images.githubusercontent.com/3204332/85262998-d4ee2300-b46e-11ea-9e9b-a9a8be067c50.png)\r\n\r\nThe notification configuration for the failed job:\r\n\r\n![image](https://user-images.githubusercontent.com/3204332/85263134-0535c180-b46f-11ea-9178-b3fd7a4679e2.png)\r\n\r\nThe failing job configuration used to reproduce the issue. Please note that the low timeout is there just for demonstration purposes. The original failing job has a timeout of 3600s.\r\n\r\n![image](https://user-images.githubusercontent.com/3204332/85263313-462dd600-b46f-11ea-84de-abb3ceac1de8.png)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWhere should I set it to display Chinese properly\r\n\r\n````\r\nProject Update #744 had status successful, view details at https://towerhost/#/jobs/project/744\r\n\r\n{\r\n    \"id\": 744,\r\n    \"name\": \"\\u6279\\u91cf\\u5b89\\u88c5jdk\\u9879\\u76ee-test3\",\r\n\"url\": \"https://towerhost/#/jobs/project/744\",\r\n    \"created_by\": \"None\",\r\n    \"started\": \"2020-06-22T02:49:31.785910+00:00\",\r\n    \"finished\": \"2020-06-22T02:49:36.336942+00:00\",\r\n    \"status\": \"successful\",\r\n    \"traceback\": \"\"\r\n}\r\n\r\n````"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Extend “HashiCorp Vault Signed SSH” credential support for passing namespace\r\n\r\n##### SUMMARY\r\nWe have our internal private vault server for credential management, to retrieve the token from the vault we are using app_role authentication.\r\n\r\nBelow is the equivalent curl command:\r\n\r\n_curl --request POST -H \"X-Vault-Namespace: <NAMESPACE>\" --data '{\"role_id\": \"<ROLE_ID>\", \"secret_id\": \"<SECRET_ID>\"}' http://<VAULT_ADDR>/v1/auth/approle/login_\r\n\r\nSo here in this case passing namespace is mandatory for us else it will return incorrect role_id not found because we are using namespace in Vault.\r\n\r\nAs we are integrating AWX with Vault, we are using HashiCorp Vault Signed SSH for authentication using APPROLE ROLE_ID and APPROLE SECRET_ID. There are other all the required fields to pass as input to vault queries like role_name, path_to_secert, and public_key. However, there is no way to pass the vault namespace (and no code to set header) and so we are getting the result as \"invalid role_id\".\r\n\r\nWe have tried to hardcode the namespace in awx_web and awx_task in hashivault.py file, then it works for us.\r\n\r\n _import requests\r\n sess = requests.Session()\r\n headers = {'X-Vault-Namespace': 'our_ns'}\r\n resp = sess.post(request_url, **request_kwargs, headers=headers)\r\n resp.raise_for_status()\r\n token = resp.json()['auth']['client_token']_\r\n\r\nCan someone please suggest to us how to pass the namespace from AWX UI or is there any other way to handle this scenario?\r\n"},{"labels":["api",null,null,null],"text":"Proposed feature:\r\n \r\n- It would come in handy if we could pull our code from CodeCommit but I'm unable to make this work atm.\r\nUnless someone could guide me through it it would be a nice feature in the future."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAfter the LDAP user logged in first time and the user was created in AWX, the email attribute is empty. The first and the last name are ok.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.7\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLogin with LDAP user\r\n\r\n##### EXPECTED RESULTS\r\n\r\nemail field will be filled with AD email attribute address\r\n\r\n##### ACTUAL RESULTS\r\n\r\nemail filed is empty\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nSometimes calling the /launch Endpoint of a Job Template returns a 404, when the template is clearly available. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0 and 12.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.9\r\n* Operating System: RedHat Enterprise Linux 7.7\r\n* Web Browser: Firefox / Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nIt is not reliably reproducible. \r\n\r\n- Do a GET or POST Request to: /api/v2/job_templates/templatename++orgname/launch/\r\n\r\n##### EXPECTED RESULTS\r\n\r\n401 or 201 (depending on logged in state)\r\n\r\n##### ACTUAL RESULTS\r\n\r\n404\r\n\r\nLog from awx_web container: (removed sensitive information)\r\n```\r\n2020-06-19 06:48:06,620 WARNING  django.request Not Found: /api/v2/job_templates/templatename++orgname/launch/\r\n2020-06-19 06:48:06,620 WARNING  django.request Not Found: /api/v2/job_templates/templatename++orgname/launch/\r\n[pid: 77|app: 0|req: 17/102] 172.18.0.1 () {52 vars in 3075 bytes} [Fri Jun 19 06:48:06 2020] GET /api/v2/job_templates/templatename++orgname/launch/ => generated 12304 bytes in 98 msecs (HTTP/1.1 404) 6 headers in 295 bytes (1 switches on core 0)\r\n172.18.0.1 - - [19/Jun/2020:06:48:06 +0000] \"GET /api/v2/job_templates/templatename++orgname/launch/ HTTP/1.1\" 404 12304 \"-\" \"Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:77.0) Gecko/20100101 Firefox/77.0\" \"10.100.X.X\"\r\n\r\n\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nThe issue occurs mysteriously often when the endpoint is called from our jenkins instance. \r\n\r\nPipeline Log:\r\n```\r\n[INFO] Request URI: https://awx.company.org/api/v2/job_templates/templatename++orgname/launch/\r\n[INFO] Request Method: POST\r\n[INFO] Request Headers: {Accept=application/json;charset=UTF-8, Content-Type=application/json;charset=UTF-8, Content-Length=286}\r\n[INFO] Request Body: {\"extra_vars\":{\"appname\":\"superniceapp\",\"url\":\"someurl\"}}\r\n[INFO] Response Status Code: 404\r\n[INFO] Response Headers: {Server=nginx/1.16.1, Date=Fri, 19 Jun 2020 08:13:30 GMT, Content-Type=application/json, Content-Length=55, Connection=keep-alive, Vary=Accept, Accept-Language, Origin, Cookie, Content-Language=en, X-API-Total-Time=0.028s}\r\n[INFO] Response Body: {\"detail\":\"The requested resource could not be found.\"}\r\n```\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAs admin user, create a place into the UI in order to see the current logged users. "},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\npassing an id to `unified_job_template` params in the `schedule` and `workflow_job_template_node` modules fails because `module.resolve_name_to_id('unified_job_templates', unified_job_template)` fails (due to api behavior).\r\n\r\n@ryanpetrello noted the CLI hits the same issue ( https://github.com/ansible/awx/issues/6587 ), so maybe we need/want an api fix for this.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 12.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9\r\n* Operating System: ubuntu\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nrun a playbook containing:\r\n\r\n```\r\n- hosts: localhost\r\n  collections:\r\n    - awx.awx\r\n  vars:\r\n    proj_name: project1\r\n    inv_name: inventory1\r\n    inv_source_name: inventory_source1\r\n    jt_name: jt1\r\n    wfjt_name: wfjt1\r\n    organization_name: Default\r\n    schedule_name: sched1\r\n  tasks:\r\n    - name: Create \"{{ proj_name }}\"\r\n      tower_project:\r\n        name: \"{{ proj_name }}\"\r\n        organization: \"{{ organization_name }}\"\r\n        scm_type: git\r\n        scm_url: https://github.com/ansible/test-playbooks.git\r\n\r\n    - name: Create \"{{ inv_name }}\"\r\n      tower_inventory:\r\n        name: \"{{ inv_name }}\"\r\n        organization: \"{{ organization_name }}\"\r\n        state: present\r\n\r\n    - name: Add an inventory source to \"{{ inv_name }}\" using \"{{ proj_name }}\"\r\n      tower_inventory_source:\r\n        name: \"{{ inv_source_name }}\"\r\n        inventory: \"{{ inv_name }}\"\r\n        source: scm\r\n        source_project: \"{{ proj_name }}\"\r\n        source_path: \"inventories/create_500_hosts.ini\"\r\n\r\n    - name: Create \"{{ jt_name }}\"\r\n      tower_job_template:\r\n        name: \"{{ jt_name }}\"\r\n        organization: \"{{ organization_name }}\"\r\n        project: \"{{ proj_name }}\"\r\n        inventory: \"{{ inv_name }}\"\r\n        playbook: chatty_tasks.yml\r\n        job_type: run\r\n        state: present\r\n      register: jt\r\n\r\n    - name: Create \"{{ wfjt_name }}\"\r\n      tower_workflow_job_template:\r\n        name: \"{{ wfjt_name }}\"\r\n        organization: \"{{ organization_name }}\"\r\n        inventory: \"{{ inv_name }}\"\r\n      register: wfjt\r\n\r\n    - name: Create a wf node\r\n      tower_workflow_job_template_node:\r\n        unified_job_template: \"{{ jt.id }}\"\r\n        identifier: root\r\n        organization: \"{{ organization_name }}\"\r\n        workflow: \"{{ wfjt_name }}\"\r\n\r\n    - name: Create a schedule\r\n      tower_schedule:\r\n        name: \"{{ schedule_name }}\"\r\n        state: present\r\n        unified_job_template: \"{{ wfjt.id }}\"\r\n        rrule: \"DTSTART:20191219T130551Z RRULE:FREQ=MINUTELY;INTERVAL=1\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nthe workflow node and schedule should be created\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nTASK [Create a wf node] ***************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"The unified_job_templates 10 was not found on the Tower server\"}\r\n```\r\n\r\nand without the wf node creation task:\r\n\r\n```\r\nTASK [Create a schedule] **************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"The unified_job_templates 11 was not found on the Tower server\"}\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nWhen creating a credential the following check is not done https://github.com/ansible/awx/blob/devel/awx/api/views/__init__.py#L1094-L1097. So one can go ahead and have a owner that is not part of the credential organization.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current devel\r\n* AWX install method: docker on linux\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n1) Create two organizations A and B (id 1 and 2 respectively)\r\n2) Create a user and associate it with org B (id 2)\r\n3) Perform a POST request to `/api/v2/credentials/` with the following content:\r\n\r\n```json\r\n{\r\n    \"name\": \"Credential on Org A\",\r\n    \"description\": \"\",\r\n    \"organization\": 1,\r\n    \"credential_type\": 1,\r\n    \"inputs\": {},\r\n    \"user\": 2,\r\n    \"team\": null\r\n}\r\n```\r\n\r\nNote: `credential_type` 1 translates to SSH/Machine credential.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe credential should not be created and as the error a similar message as the one provided here https://github.com/ansible/awx/blob/devel/awx/api/views/__init__.py#L1094-L1097 should be returned.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe credential is created and the owner is a user from an org different from the credential's org\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPerforming a GET request at `/api/v2/organizations/2/credentials/` returns:\r\n\r\n```\r\n{\"count\":0,\"next\":null,\"previous\":null,\"results\":[]}\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nRelated to #5099\r\n\r\nCurrent `OPTIONS` for `job_templates` output doesn't have default listed as `\"default\": \"\"` for `webhook_service`, which have `required: false`.\r\n\r\nDefault is expected to be listed within the API since it is not required - \r\n```json\r\n            \"webhook_service\": {\r\n                \"type\": \"choice\",\r\n                \"required\": false,\r\n                \"label\": \"Webhook service\",\r\n                \"help_text\": \"Service that webhook requests will be accepted from\",\r\n                \"filterable\": true,\r\n                \"choices\": [\r\n                    [\r\n                        \"\",\r\n                        \"---------\"\r\n                    ],\r\n                    [\r\n                        \"github\",\r\n                        \"GitHub\"\r\n                    ],\r\n                    [\r\n                        \"gitlab\",\r\n                        \"GitLab\"\r\n                    ]\r\n                ]\r\n            },\r\n```\r\n\r\n##### ENVIRONMENT\r\n\r\nAWX version: 11.2.0\r\nAWX install method: N/A\r\nAnsible version: N/A\r\nOperating System:\r\nWeb Browser:\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nunable to get awx to pull vmware inventory\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 12.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.9\r\n* Operating System: Redhat Linux 7.8\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSet up inventory with vcenter credentials\r\nrun inventory\r\n\r\n##### EXPECTED RESULTS\r\n\r\nobtain inventory of vmware systems\r\n\r\n##### ACTUAL RESULTS\r\n\r\n    2.025 INFO     Updating inventory 3: Vcenter4\r\n    2.472 INFO     Reading Ansible inventory source: /tmp/awx_4_furbkc9p/vmware_vm_inventory.yml\r\n    2.474 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    2.474 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    2.474 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 154, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1141, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1031, in handle\r\n    venv_path=venv_path, verbosity=self.verbosity).load()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 215, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 198, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nansible-inventory 2.9.9\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible-inventory\r\n  python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n[WARNING]:  * Failed to parse /tmp/awx_4_furbkc9p/vmware_vm_inventory.yml with\r\nauto plugin: Invalid empty host name provided: None\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 280, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/auto.py\", line 58, in parse\r\n    plugin.parse(inventory, loader, path, cache=cache)\r\n  File \"/var/lib/awx/vendor/awx_ansible_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 606, in parse\r\n    cacheable_results = self._populate_from_source()\r\n  File \"/var/lib/awx/vendor/awx_ansible_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 689, in _populate_from_source\r\n    self._populate_host_properties(host_properties, host)\r\n  File \"/var/lib/awx/vendor/awx_ansible_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 720, in _populate_host_properties\r\n    self.inventory.add_host(host)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/data.py\", line 230, in add_host\r\n    raise AnsibleError(\"Invalid empty host name provided: %s\" % host)\r\n[WARNING]: Unable to parse /tmp/awx_4_furbkc9p/vmware_vm_inventory.yml as an\r\ninventory source\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nOrganization created with local account (admin organization privileges). From organization administrator account I tried add user to organization but nothing happen - looks that action is ignored. \r\nIn awx logs I found:\r\n2020-06-15 15:16:54,302 WARNING  django.request Forbidden: /api/v2/users/85/roles/\r\n2020-06-15 15:33:17,601 WARNING  awx.api.generics status 403 received by user testapi_admin_org_user attempting to access /api/v2/users/85/roles/ from 10.96.72.228\r\n2020-06-15 15:33:17,605 WARNING  django.request Forbidden: /api/v2/users/85/roles/\r\n\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2\r\n* AWX install method: rpm version\r\n* Ansible version:  2.9.5\r\n* Operating System: Red Hat 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create organization \r\n2. Create user as a organization administrator\r\n3. From organization admin try add user which is not already in organization (but account exists)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nUser will be added to organization \r\n\r\n##### ACTUAL RESULTS\r\nAction looks for ignored and 403 error appear in logs.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nSource variables not filtering when running vCentre inventory sync.\r\nAll vm hosts and all properties are synchronised.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 12.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.9\r\n* Operating System: Centos 8\r\n* Web Browser: Chrome\r\n*vCentre version: 6.7\r\n\r\n##### STEPS TO REPRODUCE\r\nPost AWX install steps:\r\nConfigured authentication with kerberos as per Ansible doc.\r\nCreated vCentre credentials\r\nCreated vCentre inventory\r\n\r\nAdded the following to the Source Variables section;\r\n\r\nalias_pattern: \"{{ config.name }}\"\r\nhost_filters: \"{{ guest.gueststate == 'running' }}\"\r\nproperties:\r\n  prop01: \"config.name\"\r\n  prop02: \"guest.hostName\"\r\n  prop03: \"guest.ipAddress\"\r\n  prop04: \"guest.guestId\"\r\n  prop05: \"guest.guestState\"\r\n  prop06: \"guest.guestFamily\"\r\n  prop07: \"config.annotation\"\r\n\r\nSaved, and ran the inventory sync.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nImport VM hosts without the GUID in the name, in a running state and with a set of properties (host variables) matching the above.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAll vm hosts are imported regardless of running state, GUID in the name, and with up to 2400 host variables.\r\n\r\nSync log has errors;\r\n\r\n    2.025 INFO     Updating inventory 2: vcentre\r\n    2.463 DEBUG    Using base command: python /usr/bin/ansible-inventory -i /tmp/awx_14_vj6lh2p9/vmware_vm_inventory.yml --playbook-dir /tmp/awx_14_vj6lh2p9 -vvvvv\r\n    2.464 INFO     Reading Ansible inventory source: /tmp/awx_14_vj6lh2p9/vmware_vm_inventory.yml\r\n    2.465 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    2.465 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    2.465 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\n   21.188 ERROR    ansible-inventory 2.9.9\r\n   21.189 ERROR      config file = /etc/ansible/ansible.cfg\r\n   21.189 ERROR      configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n   21.189 ERROR      ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n   21.189 ERROR      executable location = /usr/bin/ansible-inventory\r\n   21.189 ERROR      python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\n   21.189 ERROR    Using /etc/ansible/ansible.cfg as config file\r\n   21.189 ERROR    setting up inventory plugins\r\n   21.189 ERROR    Parsed /tmp/awx_14_vj6lh2p9/vmware_vm_inventory.yml inventory source with auto plugin\r\n   21.415 DEBUG    Finished loading from source: /tmp/awx_14_vj6lh2p9/vmware_vm_inventory.yml\r\n\r\nThis entry appears for every host \"<hostname> has no \"config.instanceuuid\" variable\"\r\n\r\n##### ADDITIONAL INFORMATION\r\nAll of the config has been complete in the gui.\r\nI have installed awx twice from scratch on vanilla Centos 8 vm's with exactly the same result\r\nInstance filters do work, ie {{ _\"string\"_ in config.name }}\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"https://github.com/ansible/awx/blob/241931309e134bc3ffb3b2badf358d62690f5452/awx/main/tasks.py#L2330\r\n[The git clone made by make_local_copy](https://github.com/ansible/awx/blob/241931309e134bc3ffb3b2badf358d62690f5452/awx/main/tasks.py#L2330-L2355) makes it impossible to use tools that need an initial setup, like [git crypt](https://www.agwa.name/projects/git-crypt/).\r\nIt would be great if there was a way to completely disable `git clone` here.\r\nBesides, all other scm types will just make a plain copy of the project tree, which works well in that use case.\r\n\r\nAnother approach would be to be able to run a custom playbook on update_project, but i'm not sure it's simpler.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nRequest to add a flag to control enable/disable of certificate verification when LOG_AGGREGATOR_PROTOCOL is \"tcp\".\r\n\r\nCurrently certificate verification option is only applicable to HTTPS log aggregator protocol.\r\n\r\nCustomer Explaination:\r\nAs part of our setup, we ship user activity logs to syslog-ng. This is working fine with UDP and the \"other\" logging aggregator. However our preferred syslog configuration is to use TCP with a certificate but no such option is available in ansible tower.\r\n * HTTPS log aggregator protocol:\r\n![http_protocol](https://user-images.githubusercontent.com/30921032/84733294-7979ec00-afbb-11ea-9149-9923c545fcce.png)\r\n\r\n*  TCP log aggregator protocol:\r\n![tcp_protocol](https://user-images.githubusercontent.com/30921032/84733300-7ed73680-afbb-11ea-894a-dc6f2346a307.png)\r\n"},{"labels":["api",null,null,null],"text":"I have AWX 12.0.0 and i was testing the UI functionality. i found that the UI doesnt lockout even after 10-15 wrong password attempt. "},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nThe ability to configure proxy_env per component.\r\n\r\n##### SUMMARY\r\nThe ability to configure proxy_env per component.  An example use case:\r\nA Tower cluster with no internet access and only Analytics traffic is allowed.\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nLaunching large number of workflows can cause playbook runs  not being processed. In #7136 I reported the performance issue when launching workflows. To \"solve\" this I came with the cunning plan: use threaded launching. Since I considered to deploy at least 3 awx instances behind the load balancer I wanted to check on how far I can go with a single instance first. \r\n\r\nSadly it appears large number of workflows can \"starve\" the playbook runs of execution times, and system can spend long time without being able to execute any playbook run (and consequently workflow). I believe that in this case it spends most of it time on checking if any of the workflow related playbook runs did finish. It appears that workflows occupy the complete execution capacity, so very few playbook runs actually execute. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.7\r\n* Operating System: CentOS 8\r\n* Web Browser: Irrelevant\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPrepare standalone awx based on docker with 4 cores and 8 GB RAM.\r\n\r\n1. prepare a workflow template consisting of 2 chained (All) playbooks (e.g. git-unsuspend account and jira-resolve issue). \r\n2. launch the 5 series of 200 workflows over 30 threads over REST API. \r\n3. Wait some time, until there are enough workflows in \"running\" state to actually choke the execution of playbooks. \r\n4. Observe the playbook jobs running on instance, most likely you will see 0, with occasional rare activity. \r\n\r\n##### EXPECTED RESULTS\r\n\r\n1. many concurrent workflows in running state\r\n2. playbook runs continue to execute despite large number of workflows being active.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n1. many concurrent workflows in running state\r\n2. playbooks do not get executed almost at all. Consequently no luck work workflows either. \r\n\r\nGiven the fact that playbook runs are the ones pulling the weight, I would expect them to be prioritized over workflow runs, which despite being higher level abstraction are mostly \"passive\" and wait for the actual results from playbook runs.\r\n\r\nIn fact, the total throughput of the system is many times smaller then single thread invocation of workflows.\r\n\r\n##### ADDITIONAL INFORMATION"},{"labels":["api",null,null,null,null],"text":"Recently 🐰 mq and memcached were replaced with Redis and it is a good choice.\r\nHowever, AWX is using Redis via hardcoded unix socket.\r\n\r\nPlease add a support for the minimal configuration options such as REDIS_HOST, REDIS_PORT and REDIS_PASSWORD.\r\n\r\nThanks!"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAllow setting a custom description and/or icon.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWhen we receive the notification after successful workflow execution, it should have schedule reference as well because it was triggered by the schedule\r\n\r\nBelow details received as notification.\r\n{\r\n    \"id\": 10470,\r\n    \"name\": \"Ajit test workflow\",\r\n    \"url\": \"https://towerhost/#/workflows/10470\",\r\n    \"created_by\": \"awxadmin\",\r\n    \"started\": \"2020-06-08T07:21:16.908279+00:00\",\r\n    \"finished\": \"2020-06-08T07:21:37.150384+00:00\",\r\n    \"status\": \"successful\",\r\n    \"traceback\": \"\",\r\n    \"body\": \"Workflow job summary:\\n\\n- node #3300 spawns job #10472, \\\"Ajit Return Value\\\", which finished with status successful.\\n- node #3299 spawns job #10471, \\\"Ajit Job Template - Create Directory\\\", which finished with status successful.\"\r\n}, {'host_status_counts': {}, 'id': 10470, 'type': 'workflow_job', 'url': '/api/v2/workflow_jobs/10470/', 'created': datetime.datetime(2020, 6, 8, 7, 21, 15, 734597, tzinfo=<UTC>), 'modified': datetime.datetime(2020, 6, 8, 7, 21, 37, 166299, tzinfo=<UTC>), 'name': 'Ajit test workflow', 'description': '', 'limit': None, 'launch_type': 'relaunch', 'status': 'successful', 'failed': False, 'started': '2020-06-08T07:21:16.908279Z', 'finished': '2020-06-08T07:21:37.150384Z', 'elapsed': 20.242, 'job_explanation': '', 'allow_simultaneous': False, 'scm_branch': None, 'summary_fields': {'unified_job_template': {'id': 141, 'name': 'Ajit test workflow', 'description': '', 'unified_job_type': 'workflow_job'}, 'created_by': {'id': 1, 'username': 'awxadmin', 'first_name': '', 'last_name': ''}, 'labels': {'count': 0, 'results': []}}}\r\n\r\nWhen I call the API to get the workflow details, it is showing the schedule object into \"summary_fields\". can it be added onto the notifications as well\r\n\r\nBelow data received through API\r\n{\r\n    \"id\": 10467,\r\n    \"type\": \"workflow_job\",\r\n    \"url\": \"/api/v2/workflow_jobs/10467/\",\r\n    \"related\": {\r\n        \"unified_job_template\": \"/api/v2/workflow_job_templates/141/\",\r\n        \"schedule\": \"/api/v2/schedules/250/\",\r\n        \"workflow_job_template\": \"/api/v2/workflow_job_templates/141/\",\r\n        \"notifications\": \"/api/v2/workflow_jobs/10467/notifications/\",\r\n        \"workflow_nodes\": \"/api/v2/workflow_jobs/10467/workflow_nodes/\",\r\n        \"labels\": \"/api/v2/workflow_jobs/10467/labels/\",\r\n        \"activity_stream\": \"/api/v2/workflow_jobs/10467/activity_stream/\",\r\n        \"relaunch\": \"/api/v2/workflow_jobs/10467/relaunch/\",\r\n        \"cancel\": \"/api/v2/workflow_jobs/10467/cancel/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"organization\": {\r\n            \"id\": 6,\r\n            \"name\": \"SDI\",\r\n            \"description\": \"\"\r\n        },\r\n        \"workflow_job_template\": {\r\n            \"id\": 141,\r\n            \"name\": \"Ajit test workflow\",\r\n            \"description\": \"\"\r\n        },\r\n        \"schedule\": {\r\n            \"id\": 250,\r\n            \"name\": \"AjitWFTest\",\r\n            \"description\": \"every day for 1 time\"\r\n        },\r\n        \"unified_job_template\": {\r\n            \"id\": 141,\r\n            \"name\": \"Ajit test workflow\",\r\n            \"description\": \"\",\r\n            \"unified_job_type\": \"workflow_job\"\r\n        },\r\n        \"user_capabilities\": {\r\n            \"delete\": true,\r\n            \"start\": true\r\n        },\r\n        \"labels\": {\r\n            \"count\": 0,\r\n            \"results\": []\r\n        }\r\n    },\r\n    \"created\": \"2020-06-08T07:20:10.754313Z\",\r\n    \"modified\": \"2020-06-08T07:20:11.933544Z\",\r\n    \"name\": \"Ajit test workflow\",\r\n    \"description\": \"\",\r\n    \"unified_job_template\": 141,\r\n    \"launch_type\": \"scheduled\",\r\n    \"status\": \"successful\",\r\n    \"failed\": false,\r\n    \"started\": \"2020-06-08T07:20:11.933251Z\",\r\n    \"finished\": \"2020-06-08T07:20:34.683411Z\",\r\n    \"canceled_on\": null,\r\n    \"elapsed\": 22.75,\r\n    \"job_args\": \"\",\r\n    \"job_cwd\": \"\",\r\n    \"job_env\": {},\r\n    \"job_explanation\": \"\",\r\n    \"result_traceback\": \"\",\r\n    \"workflow_job_template\": 141,\r\n    \"extra_vars\": \"{}\",\r\n    \"allow_simultaneous\": false,\r\n    \"job_template\": null,\r\n    \"is_sliced_job\": false,\r\n    \"inventory\": null,\r\n    \"limit\": null,\r\n    \"scm_branch\": null,\r\n    \"webhook_service\": \"\",\r\n    \"webhook_credential\": null,\r\n    \"webhook_guid\": \"\"\r\n}\r\n\r\nThanks in advance\r\n\r\nRegards,\r\nAjit"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently, the events received after the execution of the scheduled workflow job not showing any reference to schedule. Please see below screenshots.\r\n\r\nSchedule event:\r\n{\r\n            \"object2\" => \"\",\r\n            \"changes\" => {\r\n        \"enabled\" => [\r\n            [0] false,\r\n            [1] true\r\n        ]\r\n    },\r\n     \"summary_fields\" => {\r\n                     \"schedule\" => [\r\n            [0] {\r\n                         \"id\" => 8,\r\n                       \"name\" => \"Ajit SCH test\",\r\n                   \"next_run\" => \"2020-06-03T16:00:00Z\",\r\n                \"description\" => \"every day for 1 time\"\r\n            }\r\n        ],\r\n        \"workflow_job_template\" => [\r\n            [0] {\r\n                         \"id\" => 10,\r\n                       \"name\" => \"Workflow Test - TTT\",\r\n                \"description\" => \"\"\r\n            }\r\n        ],\r\n                        \"actor\" => {\r\n            \"first_name\" => \"\",\r\n              \"username\" => \"admin\",\r\n                    \"id\" => 1,\r\n             \"last_name\" => \"\"\r\n        }\r\n    },\r\n              \"level\" => \"INFO\",\r\n          \"operation\" => \"update\",\r\n         \"tower_uuid\" => nil,\r\n            \"object1\" => \"schedule\",\r\n           \"@version\" => \"1\",\r\n         \"stack_info\" => nil,\r\n       \"relationship\" => \"\",\r\n         \"@timestamp\" => 2020-06-03T15:59:38.364Z,\r\n            \"message\" => \"Activity Stream update entry for schedule\",\r\n              \"actor\" => \"admin\",\r\n            \"headers\" => {\r\n              \"http_host\" => \"10.107.100.50:8080\",\r\n           \"content_type\" => \"application/json; charset=utf-8\",\r\n        \"http_user_agent\" => nil,\r\n            \"http_accept\" => \"*/*\",\r\n         \"content_length\" => \"724\",\r\n           \"http_version\" => \"HTTP/1.1\",\r\n           \"request_path\" => \"/\",\r\n         \"request_method\" => \"POST\"\r\n    },\r\n        \"logger_name\" => \"awx.analytics.activity_stream\",\r\n               \"host\" => \"10.0.182.16\",\r\n    \"cluster_host_id\" => \"awx-84786965d-sztrh\"\r\n}\r\n\r\nWorkflow Job event:\r\n{\r\n            \"object2\" => \"\",\r\n            \"changes\" => {\r\n           \"allow_simultaneous\" => false,\r\n                \"is_sliced_job\" => false,\r\n                 \"webhook_guid\" => \"\",\r\n              \"webhook_service\" => \"\",\r\n                        \"limit\" => nil,\r\n           \"webhook_credential\" => nil,\r\n                  \"description\" => \"\",\r\n                           \"id\" => 291,\r\n                   \"extra_vars\" => \"{}\",\r\n                         \"name\" => \"Workflow Test - TTT\",\r\n        \"workflow_job_template\" => \"Workflow Test - TTT-10\",\r\n                    \"inventory\" => nil,\r\n                 \"job_template\" => nil,\r\n                   \"scm_branch\" => nil\r\n    },\r\n     \"summary_fields\" => {\r\n        \"workflow_job\" => [\r\n            [0] {\r\n                         \"id\" => 291,\r\n                       \"name\" => \"Workflow Test - TTT\",\r\n                \"description\" => \"\"\r\n            }\r\n        ]\r\n    },\r\n              \"level\" => \"INFO\",\r\n          \"operation\" => \"create\",\r\n         \"tower_uuid\" => nil,\r\n            \"object1\" => \"workflow_job\",\r\n           \"@version\" => \"1\",\r\n         \"stack_info\" => nil,\r\n       \"relationship\" => \"\",\r\n         \"@timestamp\" => 2020-06-03T16:00:01.718Z,\r\n            \"message\" => \"Activity Stream update entry for workflow_job\",\r\n              \"actor\" => nil,\r\n            \"headers\" => {\r\n              \"http_host\" => \"10.107.100.50:8080\",\r\n           \"content_type\" => \"application/json; charset=utf-8\",\r\n        \"http_user_agent\" => nil,\r\n            \"http_accept\" => \"*/*\",\r\n         \"content_length\" => \"826\",\r\n           \"http_version\" => \"HTTP/1.1\",\r\n           \"request_path\" => \"/\",\r\n         \"request_method\" => \"POST\"\r\n    },\r\n        \"logger_name\" => \"awx.analytics.activity_stream\",\r\n               \"host\" => \"10.0.182.16\",\r\n    \"cluster_host_id\" => \"awx-84786965d-sztrh\"\r\n}\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nThe awx_task container logs a traceback:\r\n\r\n```--- Logging error ---\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/logging/handlers.py\", line 936, in emit\r\n    self.socket.send(msg)\r\nOSError: [Errno 90] Message too long\r\n```\r\nI stumbled on it while examining the logs and found it worth reporting.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method:docker\r\n* Ansible version:  2.9.7\r\n* Operating System: Debian 10\r\n* Web Browser: Firefox 75\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nActually I don't know how to reproduce this.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo traceback.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nA traceback is logged.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n2020-06-08 06:00:24,531 DEBUG    awx.main.commands.run_callback_receiver JobEvent.objects.bulk_create(1)\r\n--- Logging error ---\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/logging/handlers.py\", line 936, in emit\r\n    self.socket.send(msg)\r\nOSError: [Errno 90] Message too long\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/logging/handlers.py\", line 940, in emit\r\n    self.socket.send(msg)\r\nOSError: [Errno 90] Message too long\r\nCall stack:\r\n  File \"/usr/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/run_callback_receiver.py\", line 24, in handle\r\n    queues=[getattr(settings, 'CALLBACK_QUEUE', '')],\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/base.py\", line 54, in __init__\r\n    self.pool.init_workers(self.worker.work_loop)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 219, in init_workers\r\n    self.up()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 231, in up\r\n    worker.start()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 69, in start\r\n    self.process.start()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 105, in start\r\n    self._popen = self._Popen(self)\r\n  File \"/usr/lib64/python3.6/multiprocessing/context.py\", line 223, in _Popen\r\n    return _default_context.get_context().Process._Popen(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/context.py\", line 277, in _Popen\r\n    return Popen(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/popen_fork.py\", line 19, in __init__\r\n    self._launch(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/popen_fork.py\", line 73, in _launch\r\n    code = process_obj._bootstrap()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\r\n    self.run()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/callback.py\", line 71, in work_loop\r\n    return super(CallbackBrokerWorker, self).work_loop(*args, **kw)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/base.py\", line 184, in work_loop\r\n    self.perform_work(body, *args)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/callback.py\", line 154, in perform_work\r\n    event = cls.create_from_data(**body)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/events.py\", line 415, in create_from_data\r\n    event._update_from_event_data()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/events.py\", line 373, in _update_from_event_data\r\n    extra=dict(python_objects=dict(job_event=self))\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1308, in info\r\n    self._log(INFO, msg, args, **kwargs)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1444, in _log\r\n    self.handle(record)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1454, in handle\r\n    self.callHandlers(record)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1516, in callHandlers\r\n    hdlr.handle(record)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 865, in handle\r\n    self.emit(record)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/utils/handlers.py\", line 22, in emit\r\n    return super(RSysLogHandler, self).emit(msg)\r\nMessage: 'Event data saved.'\r\nArguments: ()\r\n2020-06-08 06:00:25,901 DEBUG    awx.main.commands.run_callback_receiver JobEvent.objects.bulk_create(1)\r\n2020-06-08 06:00:25,901 DEBUG    awx.main.commands.run_callback_receiver JobEvent.objects.bulk_create(1)\r\n--- Logging error ---\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/logging/handlers.py\", line 936, in emit\r\n    self.socket.send(msg)\r\nOSError: [Errno 90] Message too long\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/logging/handlers.py\", line 940, in emit\r\n    self.socket.send(msg)\r\nOSError: [Errno 90] Message too long\r\nCall stack:\r\n  File \"/usr/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/run_callback_receiver.py\", line 24, in handle\r\n    queues=[getattr(settings, 'CALLBACK_QUEUE', '')],\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/base.py\", line 54, in __init__\r\n    self.pool.init_workers(self.worker.work_loop)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 219, in init_workers\r\n    self.up()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 231, in up\r\n    worker.start()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 69, in start\r\n    self.process.start()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 105, in start\r\n    self._popen = self._Popen(self)\r\n  File \"/usr/lib64/python3.6/multiprocessing/context.py\", line 223, in _Popen\r\n    return _default_context.get_context().Process._Popen(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/context.py\", line 277, in _Popen\r\n    return Popen(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/popen_fork.py\", line 19, in __init__\r\n    self._launch(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/popen_fork.py\", line 73, in _launch\r\n    code = process_obj._bootstrap()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\r\n    self.run()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/callback.py\", line 71, in work_loop\r\n    return super(CallbackBrokerWorker, self).work_loop(*args, **kw)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/base.py\", line 184, in work_loop\r\n    self.perform_work(body, *args)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/callback.py\", line 154, in perform_work\r\n    event = cls.create_from_data(**body)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/events.py\", line 415, in create_from_data\r\n    event._update_from_event_data()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/events.py\", line 373, in _update_from_event_data\r\n    extra=dict(python_objects=dict(job_event=self))\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1308, in info\r\n    self._log(INFO, msg, args, **kwargs)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1444, in _log\r\n    self.handle(record)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1454, in handle\r\n    self.callHandlers(record)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1516, in callHandlers\r\n    hdlr.handle(record)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 865, in handle\r\n    self.emit(record)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/utils/handlers.py\", line 22, in emit\r\n    return super(RSysLogHandler, self).emit(msg)\r\nMessage: 'Event data saved.'\r\nArguments: ()\r\n--- Logging error ---\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/logging/handlers.py\", line 936, in emit\r\n    self.socket.send(msg)\r\nOSError: [Errno 90] Message too long\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/logging/handlers.py\", line 940, in emit\r\n    self.socket.send(msg)\r\nOSError: [Errno 90] Message too long\r\nCall stack:\r\n  File \"/usr/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/run_callback_receiver.py\", line 24, in handle\r\n    queues=[getattr(settings, 'CALLBACK_QUEUE', '')],\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/base.py\", line 54, in __init__\r\n    self.pool.init_workers(self.worker.work_loop)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 219, in init_workers\r\n    self.up()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 231, in up\r\n    worker.start()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/pool.py\", line 69, in start\r\n    self.process.start()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 105, in start\r\n    self._popen = self._Popen(self)\r\n  File \"/usr/lib64/python3.6/multiprocessing/context.py\", line 223, in _Popen\r\n    return _default_context.get_context().Process._Popen(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/context.py\", line 277, in _Popen\r\n    return Popen(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/popen_fork.py\", line 19, in __init__\r\n    self._launch(process_obj)\r\n  File \"/usr/lib64/python3.6/multiprocessing/popen_fork.py\", line 73, in _launch\r\n    code = process_obj._bootstrap()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\r\n    self.run()\r\n  File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/callback.py\", line 71, in work_loop\r\n    return super(CallbackBrokerWorker, self).work_loop(*args, **kw)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/base.py\", line 184, in work_loop\r\n    self.perform_work(body, *args)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/worker/callback.py\", line 154, in perform_work\r\n    event = cls.create_from_data(**body)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/events.py\", line 415, in create_from_data\r\n    event._update_from_event_data()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/events.py\", line 373, in _update_from_event_data\r\n    extra=dict(python_objects=dict(job_event=self))\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1308, in info\r\n    self._log(INFO, msg, args, **kwargs)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1444, in _log\r\n    self.handle(record)\r\n2020-06-08 06:00:26,150 DEBUG    awx.main.commands.run_callback_receiver JobEvent.objects.bulk_create(2)\r\n2020-06-08 06:00:26,150 DEBUG    awx.main.commands.run_callback_receiver JobEvent.objects.bulk_create(2)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1454, in handle\r\n    self.callHandlers(record)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 1516, in callHandlers\r\n    hdlr.handle(record)\r\n  File \"/usr/lib64/python3.6/logging/__init__.py\", line 865, in handle\r\n    self.emit(record)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/utils/handlers.py\", line 22, in emit\r\n    return super(RSysLogHandler, self).emit(msg)\r\nMessage: 'Event data saved.'\r\nArguments: ()\r\n2020-06-08 06:00:26,156 DEBUG    awx.main.commands.run_callback_receiver JobEvent.objects.bulk_create(2)\r\n2020-06-08 06:00:26,156 DEBUG    awx.main.commands.run_callback_receiver JobEvent.objects.bulk_create(2)\r\n2020-06-08 06:00:26,174 DEBUG    awx.main.commands.run_callback_receiver JobEvent.objects.bulk_create(1)\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\n```\r\nawx_web      | 2020-06-05 10:42:08,968 DEBUG    awx.main.wsbroadcast Connection from awx0102 to awx attempt number 2644.\r\nawx_web      | 2020-06-05 10:42:10,075 WARNING  awx.main.consumers client 'specific.RSJQsacH!pdtQNsDziqHK' failed to authorize against the broadcast endpoint.\r\nawx_web      | 2020-06-05 10:42:10,075 WARNING  awx.main.consumers client 'specific.RSJQsacH!pdtQNsDziqHK' failed to authorize against the broadcast endpoint.\r\nawx_web      | 2020-06-05 10:42:10,075 WARNING  client 'specific.RSJQsacH!pdtQNsDziqHK' failed to authorize against the broadcast endpoint.\r\nawx_web      | 172.18.0.1 - - [05/Jun/2020:10:42:10 +0000] \"GET /websocket/broadcast/ HTTP/1.0\" 403 0 \"-\" \"Python/3.6 aiohttp/3.6.2\" \"10.61.35.10\"\r\nawx_web      | 2020-06-05 10:42:10,079 INFO     awx.main.consumers client '{self.channel_name}' disconnected from the broadcast group.\r\nawx_web      | 2020-06-05 10:42:10,079 INFO     awx.main.consumers client '{self.channel_name}' disconnected from the broadcast group.\r\nawx_web      | 2020-06-05 10:42:10,079 INFO     client '{self.channel_name}' disconnected from the broadcast group.\r\nawx_web      | 2020-06-05 10:42:13,990 WARNING  awx.main.wsbroadcast Connection from awx0102 to awx failed for unknown reason: '403, message='Invalid response status', url=URL('https://awx:443/websocket/broadcast/')'.\r\n```\r\n\r\nThe url is reachable from inside the awx_web container (without tls verification):\r\n```\r\nbash-4.4# curl -Ik https://awx:443/websocket/broadcast/\r\nHTTP/1.1 404 Not Found\r\nServer: nginx/1.10.3\r\nDate: Fri, 05 Jun 2020 10:49:51 GMT\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 3911\r\nConnection: keep-alive\r\nVary: Cookie, Accept-Language, Origin\r\nContent-Language: en\r\nX-Api-Total-Time: 0.037s\r\nSet-Cookie: csrftoken=XAIS6mk4eMLF6t2AWBkNtedTb4pQVsGk1iZwV6Kn5JpQ4Iuy4RTQcXlTackfgAhC; Path=/; SameSite=Lax\r\n```\r\n\r\nThis is a clustered docker setup. Where each node has a unique UUID. \r\n\r\nHow can I debug this connection problem?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker\r\n* Ansible version:  2.9.7\r\n* Operating System: Debian 10\r\n* Web Browser: Firefox 74\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nsee: https://github.com/ansible/awx/pull/7265\r\n\r\n##### EXPECTED RESULTS\r\n\r\nEach node should be able broadcast events to each other.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNodes can not broadcast events to other nodes.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\nbash-4.4# awx-manage list_instances\r\n[tower capacity=601 policy=100%]\r\n        awx0102 capacity=300 version=11.2.0 heartbeat=\"2020-06-05 10:53:21\"\r\n        awx capacity=301 version=11.2.0 heartbeat=\"2020-06-05 10:53:26\"\r\n```\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nTrying to send a (test) notification to a Mattermost Channel fails with\r\n```\r\n mattermostinfo: Notification failed.\r\nError sending notification mattermost: {\"id\":\"api.webhook.incoming.error\",\"message\":\"Could not decode the multipart payload of incoming webhook.\",\"detailed_error\":\"\",\"request_id\":\"<request ID>\",\"status_code\":400}\r\n```\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.7\r\n* Operating System: CentOS 7.8\r\n* Web Browser: Chrome,Chromium,Firefox\r\n* Mattermost Server Version: 5.22.1\r\n\r\n##### STEPS TO REPRODUCE\r\n- Create an incomming webhook\r\n- Create a mattermost notification\r\n- Send a test notification\r\n\r\n\r\n##### EXPECTED RESULTS\r\nHaving a notification in the Channel\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSending failed with above error message\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe error message in the mattermost log shows\r\n```\r\n{\"level\":\"error\",\"ts\":1591342011.6592789,\"caller\":\"mlog/log.go:175\",\"msg\":\"Could not decode the multipart payload of incoming webhook.\",\"path\":\"/\r\nhooks/<hook ID>\",\"request_id\":\"<request ID>\",\"ip_addr\":\"<IP Address>\",\"user_id\":\"\",\"method\":\"POST\",\"err_where\":\"\r\nincomingWebhook\",\"http_code\":400,\"err_details\":\"mime: no media type\"}\r\n```\r\n---\r\nedit: some ID removed in the log sample, mattermost server version added"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nWe started testing API calls to AWX via ServiceNow. Suddenly we're getting \"Invalid search term entered. GET returned: 500 A server error has occurred.\" when viewing job info after it finishes. Job monitoring works fine while job is running. It seems to be not affecting jobs that fail.\r\nWe've been using an external PSQL db\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.95\r\n* Operating System: CentOS7\r\n* Web Browser: Edge, chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPErform API call to AWX, job completes and then check job history and click on job link\r\n\r\n##### EXPECTED RESULTS\r\n\r\njob run info displays\r\n\r\n##### ACTUAL RESULTS\r\n\r\nInvalid search term entered. GET returned: 500 A server error has occurred.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nawx_web tail\r\n2020-06-04 15:09:43,523 ERROR    django.request Internal Server Error: /api/v2/project_updates/27792/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/base.py\", line 115, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/base.py\", line 113, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n    return func(*args, **kwds)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/views/decorators/csrf.py\", line 54, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/views/generic/base.py\", line 71, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/api/generics.py\", line 299, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/views.py\", line 505, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/views.py\", line 465, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/views.py\", line 476, in raise_uncaught_exception\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/views.py\", line 502, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/generics.py\", line 208, in get\r\n    return self.retrieve(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/mixins.py\", line 56, in retrieve\r\n    return Response(serializer.data)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/serializers.py\", line 562, in data\r\n    ret = super().data\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/serializers.py\", line 260, in data\r\n    self._data = self.to_representation(self.instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/api/serializers.py\", line 802, in to_representation\r\n    ret = super(UnifiedJobSerializer, self).to_representation(obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/serializers.py\", line 529, in to_representation\r\n    ret[field.field_name] = field.to_representation(attribute)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/rest_framework/fields.py\", line 1905, in to_representation\r\n    return method(value)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/api/serializers.py\", line 1515, in get_host_status_counts\r\n    counts = obj.project_update_events.only('event_data').get(event='playbook_on_stats').get_host_status_counts()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 412, in get\r\n    (self.model._meta.object_name, num)\r\nawx.main.models.events.ProjectUpdateEvent.MultipleObjectsReturned: get() returned more than one ProjectUpdateEvent -- it returned 3!\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\ndevl branch is not url encoding '/' for conjur credential plugin.\r\n\r\n##### ENVIRONMENT\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a secret with '/'. Then '/' will not be url encoded.\r\n\r\n##### EXPECTED RESULTS\r\nTo retrieve the secret value\r\n\r\n##### ACTUAL RESULTS\r\nFailed to find secret\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nNot a huge deal, just something I noticed while debugging some unrelated test failures: If you make a GET request to ` api/v2/workflow_job_template_nodes/n/create_approval_template/` when unauthenticated, you'll get a 500 instead of a 401. It seems to work fine if you're logged in.\r\n\r\n##### STEPS TO REPRODUCE\r\n- make a workflow with nodes\r\n- log out\r\n- open browser dev tools and network tab\r\n- visit ` api/v2/workflow_job_template_nodes/n/create_approval_template/` in api browser\r\n\r\n##### EXPECTED RESULTS\r\n401\r\n\r\n##### ACTUAL RESULTS\r\n500\r\n\r\n##### ADDITIONAL INFORMATION\r\n![Screenshot from 2020-06-03 19-11-23](https://user-images.githubusercontent.com/9753817/83697865-08efca00-a5ce-11ea-9d0c-0173751041df.png)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nI am trying to find a way, how to integrate AWX notifications with OpsGenie using API.\r\nIt can be done using https://docs.opsgenie.com/docs/alert-api, I have to only find a way how to create a payload.\r\n\r\nBut anyway if AWX has already PagerDuty notification type, it would be also nice to have the same with OpsGenie with a native notification type.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIn upgrading from 11.0.0 to 11.2.0, I found that my inventory source host_filters were no longer being honored.  Instead, they were pulling the entire list of hosts from Foreman as if no filter was applied.  (for example host_filters: 'os = windows'  should only pull windows hosts)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  [whatever is in the task container]\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Set up an Inventory with a Red Hat Satellite 6 source as you normally would.\r\n2 In Source Variables put something like:\r\n```\r\n---\r\nhost_filters: 'os = windows'\r\n```\r\n3. Run the source pull -- you'll see it ignores the filter completely and pulls all of your hosts from Foreman.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expect it to honor the host_filters setting as it did in 11.0.0.  =)  I should have ended up with a handful of Windows hosts we have in Foreman.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nI got all hosts from Foreman, Linux and Windows alike.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI didn't see anything in the debug output that looked relevant."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAdd the ability to set up multiple external log aggregators in the UI. Currently, you can only set up one. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen searching for inventory:example in Tower, it returns the following:\r\n\r\n```\r\nERROR: Related Field got invalid lookup: icontains \r\n```\r\n\r\nThe below is the network debug:\r\n\r\n```\r\nRequest URL:https://10.10.181.147/api/v2/hosts/?order_by=name&page_size=5&inventory__organization=1&host_filter=inventory__icontains=example\r\n```\r\n\r\n##### ENVIRONMENT\r\n* Tower version: 3.6 and 3.7 \r\n* AWX install method: Tower package installer\r\n* Ansible version:  2.9.9\r\n* Operating System: Fedora\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nTry to search for a key in smart host filter using `inventory:`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nReturns the query successfully\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nERROR: Related Field got invalid lookup: icontains \r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIt looks like inventory is both in Related Fields and Fields for this window.  Also, searching for the inventory's id or name gives that same icontains error.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nInvalid HTTP request when Conjur credential secret has a space in the name\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a conjur credential containing a space.\r\nWhen retrieving the credential a 404 is returned from conjur.\r\nThe reason for this is because the conjur credential plugin url encodes the secretID with a `+` however conjur is expecting a `%20`.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTo get back the credential content.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAWX fails to retrieve the credential and a 404 is returned.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently, the http_method field for webhook notification_templates isn't an option to modify using awx-cli. This RFE is to add support for modifying this field with awx-cli."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nSumoLogic collector is typically URL with token in base64 format ending with two equal signs `==`. When this is saved in Tower, the incorrect URL will be stored in `/var/lib/awx/rsyslog/rsyslog.conf` where it automatically replaces those signs with `%3D%3D`. Underlying curl used by `rsyslogd` will further try to encode it and ends up with `%253D%253D`.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Red Hat Tower `3.7.0`\r\n* AWX install method: https://releases.ansible.com/ansible-tower/setup-bundle/ansible-tower-setup-bundle-3.7.0-4.tar.gz\r\n* Ansible version:  Red Hat Ansible `2.9.7`\r\n* Operating System on the server: Red Hat Enterprise Linux release 8.2 (Ootpa)\r\n* Web Browser: Chrome `80.0.3987.122` (Official Build) (64-bit) on Red Hat Enterprise Linux release 8.0 (Ootpa)\r\n\r\n##### STEPS TO REPRODUCE\r\n1. `https://<TOWER>/#/settings/system` - LOGGING\r\n2. Logging aggregator type: `sumologic`\r\n3. Logging aggregator: `https://<REDACTED>.sumologic.com/receiver/v1/http/<LONG TOKEN>==`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIntegration with SumoLogic works. Logs will appear in the SumoLogic collector.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIntegration with SumoLogic does not work due to incorrect parsing of the URL where external logs will be sent to. Logs do not appear in the SumoLogic collector.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n`cat /var/lib/awx/rsyslog/rsyslog.conf`\r\n\r\n```\r\n$DebugFile <REDACTED>\r\n$DebugLevel 2\r\n$WorkDirectory /var/lib/awx/rsyslog\r\n$MaxMessageSize 700000\r\n$IncludeConfig /var/lib/awx/rsyslog/conf.d/*.conf\r\nmain_queue(queue.spoolDirectory=\"/var/lib/awx\" queue.maxdiskspace=\"1g\" queue.type=\"Disk\" queue.filename=\"awx-external-logger-backlog\")\r\nmodule(load=\"imuxsock\" SysSock.Use=\"off\")\r\ninput(type=\"imuxsock\" Socket=\"/var/run/awx-rsyslog/rsyslog.sock\" unlink=\"on\")\r\ntemplate(name=\"awx\" type=\"string\" string=\"%rawmsg-after-pri%\")\r\nmodule(load=\"omhttp\")\r\naction(type=\"omhttp\" server=\"<REDACTED>.sumologic.com\" serverport=\"443\" usehttps=\"on\" allowunsignedcerts=\"off\" skipverifyhost=\"off\" action.resumeRetryCount=\"-1\" template=\"awx\" errorfile=\"/var/log/tower/rsyslog.err\" action.resumeInterval=\"5\" restpath=\"receiver/v1/http/<LONG TOKEN>%3D%3D\")\r\n```\r\n\r\nWhen the correct URL is hardcoded into the above file, the collection works."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n - Performance problem\r\n - Configuration problem?\r\n\r\n##### SUMMARY\r\nJob launching through job_template API is slow. Initially I have observed this when using awx.awx.tower_job_launch. It appears that the job launching rate is ~ 1 job/second. \r\nInitially I attributed this to the initial slowness of ansible when it comes to execution of single tasks due to the overhead. \r\n\r\nHowever, to confirm this I wrote a small python program that connects submits the POST requests to /api/v2/job_templates/{id}/launch/ endpoint. \r\nTo be absolutely clear I do not expect the jobs to be executed immediately but I was expecting that launching a job should be in millisecond range, enabling queuing tens or even hundreds of jobs per second.  Please note that this is observed on an empty non-clustered environment. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.7\r\n* Operating System: CentOS 8\r\n* Web Browser: irrelevant for the issue\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. create a \"simple\" playbook with just single debug task output and prompt on extra_vars\r\n2. execute the following bash script, adjust: username/password, HOST and ID of the job\r\n```\r\n for i in {1..100}; do curl -d '{ \"extra_vars\": { \"username\": \"some_username\" }}' -H \"Content-Type: application/json\" http://admin:password@HOST/api/v2/job_templates/ID/launch/; done\r\n```\r\nThe issue arises on 2 tested environments:\r\n- openstack cluster\r\n- VirtualBox VM on my own PC, (VM has 8 GB, 4 cores, SSD, Host has 8 cores, 32 GB)\r\n\r\n##### EXPECTED RESULTS\r\n\r\n100 jobs get launched (not executed) within up to 10 seconds.\r\nPlease comment on what is the expected throughput based on your own experience, since we also suspect we are missing something in our setup. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nIt takes ~ 100 seconds, due to the 1 job/second rate.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n- systems were freshly installed\r\n- no other jobs were running at the time\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAn inventory configured with inventory source Ansible Tower is unable to sync\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.9\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nNOTE: need to have an existing AWX node that hosts the inventory data\r\n\r\n1. Pull the latest commit of AWX\r\n2. build a local AWX container image\r\n3. Create an Ansible Tower kind credential to be used in the inventory source\r\n4. Create an inventory with inventory source Ansible Tower, connect to the existing AWX\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAWX should be able to sync host and groups from inventory source from Ansible Tower\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n    2.579 INFO     Updating inventory 2: FO\r\n    3.167 INFO     Reading Ansible inventory source: /tmp/awx_11578_f30pyq46/tower.yml\r\n    3.171 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    3.171 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    3.171 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 154, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1139, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1029, in handle\r\n    venv_path=venv_path, verbosity=self.verbosity).load()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 215, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 198, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nansible-inventory 2.9.9\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible-inventory\r\n  python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n[WARNING]:  * Failed to parse /tmp/awx_11578_f30pyq46/tower.yml with auto\r\nplugin: inventory config '/tmp/awx_11578_f30pyq46/tower.yml' specifies unknown\r\nplugin 'awx.awx.tower'\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 280, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/auto.py\", line 53, in parse\r\n    raise AnsibleParserError(\"inventory config '{0}' specifies unknown plugin '{1}'\".format(path, plugin_name))\r\n[WARNING]: Unable to parse /tmp/awx_11578_f30pyq46/tower.yml as an inventory\r\nsource\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"Note: i heard of another issue about this, but i couldn't find it. please link them together if you know the issue.\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n`pip` does not honor symlinks in local clones. It got merged three weeks ago and they're going to have to revert it: https://github.com/pypa/pip/issues/7555\r\n\r\nThe issue has been somewhat existent since 2016: https://github.com/pypa/pip/issues/3500\r\n\r\nCurrent workaround is rm awx/awxkit/VERSION and cp awx/VERSION awx/awxkit/VERSION.\r\n\r\nThis issue should be about either acknowledging the pip issue and monitoring it via this repo, or making the VERSION file not a symlink. \r\n\r\n##### STEPS TO REPRODUCE\r\nrun `pip install awx/awxkit`. \r\n\r\n##### EXPECTED RESULTS\r\nInstall succeeds.\r\n\r\n##### ACTUAL RESULTS\r\nVERSION file isn't found, failure occurs."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nApproval workflow job notification fails to be sent to PagerDuty (all others notif backends are working for approval notifications) No issues with Start /  Success / Failure notifications.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.7\r\n* Operating System: Ubuntu 18.04 LTS\r\n* Web Browser: Firefox 76\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Configure a new PagerDuty service\r\n- Add a new Event API V2 Integration\r\n- Add a new PagerDuty notification template in AWX (fill all fields but don't customize messages)\r\n- Create a new workflow job with at least an approval node (fill all fields)\r\n- Enable PagerDuty notification on approval\r\n- Run the workflow job\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe approval notification should be successfully sent\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNotification fails to be sent (with stack trace) \"Description is missing or blank\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n> 2020-05-19 10:17:25,818 ERROR    awx.main.notifications.pagerduty_backend Exception sending messages: {'status': 'invalid event', 'message': 'Event object is invalid', 'errors': ['Description is missing or blank']} (99999): []\r\n> 2020-05-19 10:17:25,821 ERROR    awx.main.tasks Send Notification Failed {'status': 'invalid event', 'message': 'Event object is invalid', 'errors': ['Description is missing or blank']} (99999): []\r\n> Traceback (most recent call last):\r\n>   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/pygerduty/__init__.py\", line 597, in execute_request\r\n>     response = (self.opener.open(request, timeout=self.timeout).\r\n>   File \"/usr/lib64/python3.6/urllib/request.py\", line 532, in open\r\n>     response = meth(req, response)\r\n>   File \"/usr/lib64/python3.6/urllib/request.py\", line 642, in http_response\r\n>     'http', request, response, code, msg, hdrs)\r\n>   File \"/usr/lib64/python3.6/urllib/request.py\", line 570, in error\r\n>     return self._call_chain(*args)\r\n>   File \"/usr/lib64/python3.6/urllib/request.py\", line 504, in _call_chain\r\n>     result = func(*args)\r\n>   File \"/usr/lib64/python3.6/urllib/request.py\", line 650, in http_error_default\r\n>     raise HTTPError(req.full_url, code, msg, hdrs, fp)\r\n> urllib.error.HTTPError: HTTP Error 400: Bad Request\r\n> \r\n> During handling of the above exception, another exception occurred:\r\n> \r\n> Traceback (most recent call last):\r\n>   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 340, in send_notifications\r\n>     sent = notification.notification_template.send(notification.subject, notification.body)\r\n>   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/notifications.py\", line 196, in send\r\n>     return backend_obj.send_messages([notification_obj])\r\n>   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/notifications/pagerduty_backend.py\", line 70, in send_messages\r\n>     client=m.from_email)\r\n>   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/pygerduty/__init__.py\", line 593, in trigger_incident\r\n>     client=client, client_url=client_url, contexts=contexts)\r\n>   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/pygerduty/__init__.py\", line 557, in create_event\r\n>     response = self.execute_request(request)\r\n>   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/pygerduty/__init__.py\", line 603, in execute_request\r\n>     raise BadRequest(self.json_loader(err.read().decode(\"utf-8\")))\r\n> pygerduty.exceptions.BadRequest: {'status': 'invalid event', 'message': 'Event object is invalid', 'errors': ['Description is missing or blank']} (99999): []\r\n> "},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThe current UI uses the unitary `credential` field when configuring inventory sources.\r\n\r\nThe UI rewrite should use the `credentials` list and associate credential(s), if it doesn't already.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently, AWX does not escape a trailing backslash when used with surveys.  Desired functionality would be to allow the character `\\` to be at the end without needing a manual escape from the user.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nSee an example in #7052 \r\nAn inventory update failed, producing the following output:\r\n```\r\nTraceback (most recent call last):\r\nFile \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in\r\nsys.exit(manage())\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/init.py\", line 152, in manage\r\nexecute_from_command_line(sys.argv)\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/init.py\", line 381, in execute_from_command_line\r\nutility.execute()\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/init.py\", line 375, in execute\r\nself.fetch_command(subcommand).run_from_argv(self.argv)\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\nself.execute(*args, **cmd_options)\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\noutput = self.handle(*args, **options)\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1139, in handle\r\nraise exc\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1029, in handle\r\nvenv_path=venv_path, verbosity=self.verbosity).load()\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 215, in load\r\nreturn self.command_to_json(base_args + ['--list'])\r\nFile \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 198, in command_to_json\r\nself.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nansible-inventory 2.9.7\r\nconfig file = /etc/ansible/ansible.cfg\r\nconfigured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\nansible python module location = /usr/lib/python3.6/site-packages/ansible\r\nexecutable location = /usr/bin/ansible-inventory\r\npython version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n[WARNING]: * Failed to parse /tmp/awx_1072_i0i4h5_1/vmware_vm_inventory.yml\r\nwith auto plugin: Invalid empty host name provided: None\r\nFile \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 280, in parse_source\r\nplugin.parse(self._inventory, self._loader, source, cache=cache)\r\nFile \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/auto.py\", line 58, in parse\r\nplugin.parse(inventory, loader, path, cache=cache)\r\nFile \"/var/lib/awx/vendor/inventory_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 606, in parse\r\ncacheable_results = self._populate_from_source()\r\nFile \"/var/lib/awx/vendor/inventory_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 689, in _populate_from_source\r\nself._populate_host_properties(host_properties, host)\r\nFile \"/var/lib/awx/vendor/inventory_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 720, in _populate_host_properties\r\nself.inventory.add_host(host)\r\nFile \"/usr/lib/python3.6/site-packages/ansible/inventory/data.py\", line 230, in add_host\r\nraise AnsibleError(\"Invalid empty host name provided: %s\" % host)\r\n[WARNING]: Unable to parse /tmp/awx_1072_i0i4h5_1/vmware_vm_inventory.yml as an\r\ninventory source\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n```\r\n\r\nEvery part of that error before:\r\n```\r\n[WARNING]: * Failed to parse /tmp/awx_1072_i0i4h5_1/vmware_vm_inventory.yml\r\nwith auto plugin: Invalid empty host name provided: None\r\n```\r\n\r\ncould be elided without losing context.\r\n\r\nThis may require ansible changes.\r\n"},{"labels":["api",null,null,null],"text":"This is a subtask of a larger enhancement/initiative surrounding execution environments: #5157\r\n\r\nExecution Environments may require a credential to pull from a protected registry. Different execution environments may come from different registries. We need a way to handle the authentication process that does not involve a shared global config. Whatever we do should be secure in terms of file permissions."},{"labels":["api",null,null,null,null,null,null,null],"text":"This is a subtask of a larger enhancement/initiative surrounding execution environments: https://github.com/ansible/awx/issues/5157\r\n\r\nImplement APIs for defining execution environment and their sources (registries).\r\n\r\n- A model and API for defining, interacting with, and authenticating to one or more execution environments (e.g., name, URL, any necessary credential data).\r\n  - A name\r\n   - Credentials specific to registry authentication\r\n   - A URL e.g., `quay.io/redhat/someimage:latest`\r\n-  An interface for attaching execution environments to Organization, Inventories, and Job Templates.\r\n-  RBAC for execution environments\r\n- A documented process for registering new execution environments, and notifying AWX of their existance.\r\n\r\nThis work will be consumed by https://github.com/ansible/awx/issues/7060\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n![all_parents](https://user-images.githubusercontent.com/9889020/82239367-abd5f200-9906-11ea-8c60-39ef86625ff8.gif)\r\n\r\nRelates to https://github.com/ansible/awx/issues/6998\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create an empty workflow\r\n2. Attempt to POST to `/api/v2/workflow_job_templates/:id/workflow_nodes/` with the following payload:\r\n\r\n```\r\n{\r\n    \"all_parents_must_converge\": true\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nA node is created with `all_parents_must_converge` set to `true`\r\n\r\n##### ACTUAL RESULTS\r\nA node is created with `all_parents_must_converge` set to `false`\r\n\r\n##### ADDITIONAL INFORMATION\r\nThe use case here is approval nodes.  In order to create an approval node in the UI we make this initial POST request to create the node.  After we have a node, we create the corresponding approval template.  If the user were to attempt to create a new approval node in the UI where `all_parents_must_converge` was set to true it would currently save but `all_parents_must_converge` would be set to false.\r\n\r\nIf this becomes problematic to fix, the UI could always issue a 3rd request to go back and PATCH the node from the first request but this would be less desirable.\r\n"},{"labels":["api",null,null,null],"text":"To support custom SDKs/libraries in playbook execution, AWX supports the notion of \"custom virtual environments\" today, whereby users:\r\n\r\n1.  Build and deploy Python virtualenvs across their AWX infrastructure (in particular, on all `awx_task` nodes)\r\n2.  AWX code _discovers_ these virtualenvs on the file system and exposes them as \"options\" for selection.\r\n3.  Users associate these virtualenvs at the Organization, Inventory, or Job Template level so that they will be utilized for playbook runs or inventory updates.\r\n\r\nIn a future version of AWX, we'd like to **replace** this functionality with the custom execution environments described in https://github.com/ansible/awx/issues/7059\r\n\r\nThis has a few implications for migration:\r\n\r\n1.  The process for defining these custom execution environments will be different (the thing you're producing is a container image, not a Python virtualenv), and as such it is possible to incorporate system-level dependencies and collection-based content.  We'll need good documentation on the new way of doing things, and will need to point users looking to migrate in the right direction.\r\n\r\n2.  We may want to consider a process for aiding users in migration from \"old style\" virtual environments (perhaps via `pip freeze` and a generated `requirements.txt`) to the new execution environments process.\r\n\r\n3.  In newer versions of AWX, we'll likely need a way to detect that you _have_ old virtual environments associated with Organizations/Inventory/Job Templates and warn you that you'll need to migrate to the new custom execution enviroment approach described in https://github.com/ansible/awx/issues/7059\r\n\r\n    - In this scenario, what should the behavior be?  If you have an \"old style\" virtual environment, should we just use the *default* execution environment, or should AWX refuse to run the job until you've migrated away?"},{"labels":["api",null,null,null],"text":"This is a subtask of a larger enhancement/initiative surrounding execution environments: #5157\r\n\r\nSpecifically, it is a component of the work described in https://github.com/ansible/awx/issues/7060\r\n\r\nToday, inventory updates operate by spawning an `awx-manage` command that:\r\n\r\n1.  Uses `bubblewrap` and `subprocess.Popen` to fork an `ansible-inventory` invocation.\r\n2.  Parses the JSON result of the `ansible-inventory` process.\r\n3.  Translates that JSON data into a series of ORM calls in Python to create/update/delete appropriate inventory/group/host records.\r\n\r\nUnder a containerized model (as described in https://github.com/ansible/awx/issues/7060), we'd need to rethink how we accomplish this."},{"labels":["api",null,null,null],"text":"This is a subtask of a larger enhancement/initiative surrounding execution environments: https://github.com/ansible/awx/issues/5157\r\n\r\nAWX's current execution system is limited to executing jobs under [bubblewrap](https://github.com/containers/bubblewrap) for process isolation. For OpenShift and Kubernetes based deployments, this requires any container running jobs to run in privileged mode.\r\n\r\nIn a future release of AWX, we'd like to replace this execution mechanism with execution based strictly on containers, likely via Docker and/or podman.\r\n\r\nThis is a multi-stepped change that will require:\r\n\r\n1.  Changes to the https://github.com/ansible/ansible-runner project itself to support container-based execution.\r\n2. Modification to AWX's task execution to interface with runner to properly mount certain volume data (such as the appropriate project/SCM data that contains playbooks)\r\n3.  Changes to the way that AWX executes and manages the JSON artifact data of inventory imports (today, inventory imports in AWX rely on a specific `awx-manage` process that is necessary to save inventory/group/host artifacts into the database).\r\n4.  Certain types of \"jobs\" will continue to follow the model of local execution (meaning, they won't run in a container), in particular system jobs.\r\n\r\nOther considerations include:\r\n\r\n- How will this affect existing users that have grown accustomed to the \"bwrap whitelist\" mechanism, by which certain file paths can be \"exposed\" to the ansible-playbook runtime?  Should we continue to support this type of functionality?  How will that affect \"Job Isolation\"-specific settings that exist today.\r\n- This new model will require AWX installations to either include to interact with a container registry.  What should be the default behavior for new installs (are users required to bring their own, or will all AWX installations provide a default container registry via the galaxy-ng project (https://github.com/ansible/galaxy_ng)?"},{"labels":["api",null,null,null],"text":"This is a subtask of a larger enhancement/initiative surrounding execution environments: https://github.com/ansible/awx/issues/5157\r\n\r\nAWX users should be able to utilize the schema definition and tooling defined in https://github.com/ansible/awx/issues/7057 to build custom execution environments.  The output of this tooling is a `Dockerfile/Containerfile`."},{"labels":["api",null,null,null],"text":"This is a subtask of a larger enhancement/initiative surrounding execution environments: https://github.com/ansible/awx/issues/5157\r\n\r\nAutomate the process of building and shipping a set of default execution environments using the schemas and tooling defined in:  https://github.com/ansible/awx/issues/7057\r\n\r\nThis work involves shipping a set of default execution environments for all supported AWX platforms, and support for any downstream implementations:\r\n\r\n- Take the existing requirements from the default virtual environments today, and use this to compose default execution environments.\r\n- Develop a mechanism for pinning and incrementing dependency versions (to support newer software releases, and to address security issues) as we do today."},{"labels":["api",null,null,null],"text":"This is a subtask of a larger enhancement/initiative surrounding execution environments: https://github.com/ansible/awx/issues/5157\r\n\r\nAWX needs to expand to provision and manage execution environments, including how they get to execution nodes.\r\n\r\n**What is an execution environment?**\r\n\r\nAn execution environment definition consists of:\r\n- an ansible version\r\n- a python version (defaults to system python)\r\n- a set of required python libraries\r\n- zero or more collections (optional). This could be sourced from the requirements present in a playbook repo\r\n- python dependencies of those collections\r\n\r\nThe concept of specifying a set of collections for an environment is to resolve and install their dependencies. The collections themselves are not required to be in the environment (and arguably should not be.)\r\n\r\nAn execution environment is built from this definition. This will likely be a container image."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n    - create a service discovery names for awx_task and awx_web so it can be communicated outside the VM and discover each other, this will be useful to launch awx in fargate ecs.\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n  - unable to launch awx in fargate because awx_task and awx_web is unable to discover each other. \r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUpon upgrading from 11 to 11.2 I no longer able to sync my vcenter dynamic inventory objects within the GUI.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker\r\n* Ansible version:  ansible-2.9.7-1.el8.noarch\r\n* Operating System: RHEL 8\r\n* Web Browser: Chrome, Firefox, IE\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWhen running the job for vmware inventory sync the job is failling with \"ERROR! No inventory was parsed, please check your configuration and options.\"\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe expected outcome should reflect successful and the inventory should get updated from vcenter objects.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n 2.030 INFO     Updating inventory 4: vCenter-DI\r\n    2.452 INFO     Reading Ansible inventory source: /tmp/awx_1072_i0i4h5_1/vmware_vm_inventory.yml\r\n    2.454 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    2.454 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    2.454 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1139, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1029, in handle\r\n    venv_path=venv_path, verbosity=self.verbosity).load()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 215, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 198, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nansible-inventory 2.9.7\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible-inventory\r\n  python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n[WARNING]:  * Failed to parse /tmp/awx_1072_i0i4h5_1/vmware_vm_inventory.yml\r\nwith auto plugin: Invalid empty host name provided: None\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 280, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/auto.py\", line 58, in parse\r\n    plugin.parse(inventory, loader, path, cache=cache)\r\n  File \"/var/lib/awx/vendor/inventory_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 606, in parse\r\n    cacheable_results = self._populate_from_source()\r\n  File \"/var/lib/awx/vendor/inventory_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 689, in _populate_from_source\r\n    self._populate_host_properties(host_properties, host)\r\n  File \"/var/lib/awx/vendor/inventory_collections/ansible_collections/community/vmware/plugins/inventory/vmware_vm_inventory.py\", line 720, in _populate_host_properties\r\n    self.inventory.add_host(host)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/data.py\", line 230, in add_host\r\n    raise AnsibleError(\"Invalid empty host name provided: %s\" % host)\r\n[WARNING]: Unable to parse /tmp/awx_1072_i0i4h5_1/vmware_vm_inventory.yml as an\r\ninventory source\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNo additional details as provided.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe `satellite6_group_prefix` satellite source vars should replace the default `foreman_` prefix with a custom one when creating host groups. This prefix is not being applied to all groups. Namely, it is missing from the groups we create here:\r\n\r\nhttps://github.com/ansible/awx/blob/devel/awx/main/models/inventory.py#L2605-L2622\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: any\r\n* Ansible version:  2.9+ (needed to enable use of inv. plugins)\r\n* Operating System: any\r\n* Web Browser: any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a satellite inventory\r\n2. In inv. source section, set `satellite6_group_prefix: newprefix_`\r\n3. Confirm not all groups have new prefix.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAll groups use new prefix.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n![Screen Shot 2020-05-14 at 1 28 34 PM](https://user-images.githubusercontent.com/4440360/81982578-eda12880-95e6-11ea-849a-244551762ef0.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n[This section](https://github.com/ansible/awx/blob/devel/awx/main/models/inventory.py#L2605-L2622), mentioned in the description, is a part of awx's 'compatibility layer' that bridges the differences between foreman's script and plugin. We need to update this section so that it takes the custom prefix into consideration.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe `ANY`/`ALL` convergence setting doesn't change the behavior of approval nodes\r\n\r\n##### STEPS TO REPRODUCE\r\n- create a workflow that has successful job templates feeding into an approval node:\r\n![Screenshot from 2020-05-12 10-04-55](https://user-images.githubusercontent.com/9753817/81701486-146d2c80-9438-11ea-9c1f-d392c6680148.png)\r\n- create a second workflow much like the first, but change the convergence value of the approval node to `ALL`:\r\n![Screenshot from 2020-05-12 10-04-21](https://user-images.githubusercontent.com/9753817/81701536-2949c000-9438-11ea-96f0-530fa5f4f3c3.png)\r\n- run both workflows\r\n \r\n##### EXPECTED RESULTS\r\n- The behavior of the two workflows at runtime should be different.\r\n- The first workflow should create the approval notification as soon as one of the leading jobs finishes.\r\n- The second workflow should create the approval notification once _all_ of the leading jobs finish.\r\n\r\n##### ACTUAL RESULTS\r\n- The behavior of the two workflows at runtime is identical. For both workflows, the approval notification is created only when all leading jobs finish."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nGenerate an inventory with 5000 hosts, and run a playbook.\r\nObserve that the `playbook_on_stats` event takes a **very** long time (depending on total hosts, and how your inventory is structured, several minutes+) to show up.\r\n\r\nThis code is super duper crazy slow (mostly because it generates *lots* of insert and update queries for large inventories):\r\n\r\nhttps://github.com/ansible/awx/blob/devel/awx/main/models/events.py#L482\r\n\r\n```python\r\n@pytest.mark.django_db\r\ndef test_host_summary_generation():\r\n    hostnames = [f'Host {i}' for i in range(5000)]\r\n    inv = Inventory()\r\n    inv.save()\r\n    for h in hostnames:\r\n        Host(name=h, inventory_id=inv.id).save()\r\n    j = Job(inventory=inv)\r\n    j.save()\r\n    JobEvent.create_from_data(\r\n        job_id=j.pk,\r\n        parent_uuid='abc123',\r\n        event='playbook_on_stats',\r\n        event_data={'ok': dict((hostname, 5) for hostname in hostnames)}\r\n    ).save()\r\n\r\n    je = JobEvent.objects.first()\r\n    je._update_host_summary_from_stats(hostnames)\r\n    assert j.job_host_summaries.count() == len(hostnames)\r\n    assert sorted([s.host_name for s in j.job_host_summaries.all()]) == sorted(hostnames)\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nCredential CyberArk AIM with certs Timeout, Non-Cert works.\r\nWe are able to use CuberArk AIm credentials and pull password, however when we try to add Key Cert to the call the process hangs and times out.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.9.3\r\n* Operating System: Red-Hat 7.7\r\n* Web Browser: Chrome\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\nWe have setup safe and App Id  in CyberArk to test pulling passwords from a CyberArk safe.,  The process is working fine with the Test URL(https://[awxhost]/api/v2/credentials/XX/test/) able to pull a test password.  However, when l we configure to use a client key and certificate to validate the client connection  the process \"hangs\" and nginx  reports a timeout.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTest URL(https://[awxhost]/api/v2/credentials/XX/test/)  Responds with with the password for the Query I pass in, this does work if I don't use Key/Cert validation.\r\n\r\n##### ACTUAL RESULTS\r\nTest URL(https://[awxhost]/api/v2/credentials/XX/test/) produces Nginx timeout\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI'm not sure where I can pull any logs related to the API URL Test URL(https://[awxhost]/api/v2/credentials/XX/test/).  I've tried docker logs on each container and I cant see anything related to the call.\r\n\r\nI have test the CyberArk call Certs with a basic Python Program and it works fine so I'm fairly certain that CyberArk is properly configured to respond.  Include the Pyhton Code I'm using that works :\r\n\r\n#import http.client\r\nimport http.client\r\nimport json\r\nimport ssl\r\n\r\n# Defining certificate related stuff and host of endpoint\r\ncertificate_file = '/loc/cert.pem'\r\ncertificate_secret= ''\r\nhost = 'cyberarkhost'\r\n\r\n# Defining parts of the HTTP request\r\nrequest_url='/AIMWebService/api/Accounts?AppID=APP_GSF_D_Ansible_Test&Safe=GSF_D_Ansible_Test&UserName=Ansible-User'\r\nrequest_headers = {\r\n    'Content-Type': 'application/json'\r\n}\r\nrequest_body_dict={\r\n   \"AppID\": \"APP_GSF_D_Ansible_Test\",\r\n   \"object_query\": \"Safe=GSF_D_Ansible_Test;UserName=Ansible-User\",\r\n   \"object_query_format\": \"Exact\",\r\n   \"reason\":\"sss\"\r\n}\r\n\r\n# Define the client certificate settings for https connection\r\ncontext = ssl.SSLContext(ssl.PROTOCOL_SSLv23)\r\ncontext.load_cert_chain(certfile=certificate_file, password=certificate_secret)\r\n\r\n# Create a connection to submit HTTP requests\r\nconnection = http.client.HTTPSConnection(host, port=443, context=context)\r\n\r\n# Use connection to submit a HTTP POST request\r\nconnection.request(method=\"GET\", url=request_url, headers=request_headers, body=json.dumps(request_body_dict))\r\n\r\n# Print the HTTP response from the IOT service endpoint\r\nresponse = connection.getresponse()\r\nprint(response.status, response.reason)\r\ndata = response.read()\r\nprint(data)\r\n\r\nThanks Matt"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently when inventory is being populated from a custom script, the Host description is always 'imported'.\r\n\r\n![description always imported](https://i.imgur.com/Rsds4DP.png)\r\n\r\nIt would be nice to specify this to something else, during the import process itself.\r\n\r\nSay, if there is a `description` field present in the JSON payload, use that to populated the Host description in AWX as well.\r\n\r\nI think updating these 2 lines: [1](https://github.com/ansible/awx/blob/c0e07198cf3d35bf98ac98a89fb13d63874055ef/awx/main/management/commands/inventory_import.py#L780), [2](https://github.com/ansible/awx/blob/c0e07198cf3d35bf98ac98a89fb13d63874055ef/awx/main/management/commands/inventory_import.py#L656) should satisfy this.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nProblem with awx is security. I dont understand why prompt is only on machine credentials.\r\n\r\n##### SUMMARY\r\nPlease add prompt possibility on all credential types like it is on machine type. I don't get the point why this is only on machine type and not on all of them. Most of the time i need it for vmware but it would be very usefull for any kind of credential, for sure.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n Test option in the credential section \r\n\r\n##### SUMMARY\r\nI think having a test option when we add credentials of any type in Ansible AWX/Tower will be very handy . \r\n\r\nFor example , If one adds Azure creentials or AWS credentials , having a option to test if those credentials work fine will be very handy. \r\n\r\nI am thinking something similar on this line \r\n\r\nhttps://octopus.com/docs/infrastructure/deployment-targets/azure#add-service-principal-account \r\n\r\nClick SAVE AND TEST to confirm the account can interact with Azure. Octopus will then attempt to use the account credentials to access the Azure Resource Management (ARM) API and list the Resource Groups in that subscription. You may need to whitelist the IP Addresses for the Azure Data Center you are targeting. See deploying to Azure via a Firewall for more details.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\ngit commands for currently used repo are unavailable. Unable to run `git describe` on localhost for current running template\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method: openshift\r\n* Ansible version:  2.9.1\r\n* Operating System: RHEL 7.6\r\n* Web Browser: firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nRun the following tasks:\r\n  - name: get last git tag\r\n    command: git describe\r\n    delegate_to: localhost\r\n    register: output\r\n \r\n  - debug: msg=\"{{ output }}\"\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nv1.3.0-5-5c1f940\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nTASK get last git tag] ***************************************\r\nfatal: [my-test-host -> localhost]: FAILED! => {\"changed\": true, \"cmd\": [\"git\", \"describe\"], \"delta\": \"0:00:00.010565\", \"end\": \"2020-05-06 17:34:22.161630\", \"msg\": \"non-zero return code\", \"rc\": 128, \"start\": \"2020-05-06 17:34:22.151065\", \"stderr\": \"fatal: No names found, cannot describe anything.\", \"stderr_lines\": [\"fatal: No names found, cannot describe anything.\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker\r\n* Ansible version:  2.9\r\n* Operating System: Centos 8\r\n* Web Browser: any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a new mail notification\r\n check the option TLS\r\nfill smtp.office365.com port 587 and set a username and password\r\n   anonymous login is forbidden\r\ntry testing it\r\n\r\n##### EXPECTED RESULTS\r\n\r\nmail sent\r\n\r\n##### ACTUAL RESULTS\r\n\r\nexception in awx_task logs\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n2020-05-06 14:21:57,746 DEBUG    awx.main.dispatch task f7190f15-aac7-4ca3-8f3b-c885f8e9a248 starting awx.main.tasks.send_notifications(*[[19]])\r\n2020-05-06 14:21:58,019 ERROR    awx.main.tasks Send Notification Failed SMTP AUTH extension not supported by server.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 324, in send_notifications\r\n    sent = notification.notification_template.send(notification.subject, notification.body)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/notifications.py\", line 196, in send\r\n    return backend_obj.send_messages([notification_obj])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/mail/backends/smtp.py\", line 103, in send_messages\r\n    new_conn_created = self.open()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/mail/backends/smtp.py\", line 70, in open\r\n    self.connection.login(self.username, self.password)\r\n  File \"/usr/lib64/python3.6/smtplib.py\", line 697, in login\r\n    \"SMTP AUTH extension not supported by server.\")\r\nsmtplib.SMTPNotSupportedError: SMTP AUTH extension not supported by server.\r\nRESULT 2\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nToggle that allow you to suppress all or certain warnings that Ansible normally generates, easily available from job template so that user is not required to mess up with ansible.cfg to suppress them\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIt would be great if AWX could show some kind of progress bar for how many tasks out of expected tasks were executed. This may not be easy to implement as many ansible playbooks don't have predetermined set of tasks, but they vary based on some variables, but still would be cool.\r\n\r\nExample:\r\nYou run some task on 20 servers, AWX calculates this task will have 500 individual steps and show progress bar of how many is done"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - use credential to access private gitlab repo\r\n\r\n##### SUMMARY\r\nWe need download galaxy-install download from private repository , I can't find any solution to resolve this issue but I found out add ssh private key to docker file \r\nwe use git:// url in requirement and we don't use https:// so need key file auth \r\nso please add this feature , can access git:// repo in requiement by adding ssh credential section\r\n"},{"labels":["api",null,null],"text":"Now that every AWX node has a local independent redis server, we can probably just get rid of our memcached usage (and just use redis instead).\r\n\r\nIn modern versions of AWX, memcached is used specifically for:\r\n\r\n- a local cache for AWX settings access (see: `awx.conf.settings`); any time `django.conf.settings` is accessed (e.g., `settings.TOWER_URL_BASE`), we *first* query memcached via Django's cache framework (https://docs.djangoproject.com/en/3.0/topics/cache/) to see if the value exists in memcached (if not, we pull the value from the database and _then_ place it in the cache)\r\n- any time a setting value is *changed* via the API, we run a task on **every** AWX node, which removes the _old_ value from that nodes' local memcached\r\n- there are various other places where AWX code interacts with memcached, but it generally does so using Django's cache interface i.e., `cache.get()`, `cache.set()`\r\n- AWX *used to* use memcached as a holding space for in-flight playbook event data, and for fact gathering, but we've removed this type of usage\r\n\r\n##### PLAN OF ACTION\r\n\r\nI highly suspect that **all** of the above interactions are implemented *only* through Django's cache interface (i.e., I don't think we've got code that _directly_ accesses memcached using the `python-memcached` library), so replacing memcached with redis **should** be as simple as just swapping out the dependency and the Django caching configuration.\r\n\r\n- investigate https://github.com/jazzband/django-redis as an alternative cache plugin, and add it to the list of dependencies in `./requirements`\r\n- remove the `python-memcached` library from our list of dependencies in `./requirements`\r\n- update our definition of `CACHES` under `awx.settings` to point at the redis Unix domain socket _instead of_ memcached\r\n- remove any and all installer code and configuration that provisions memcached containers\r\n   - in the local Docker installer\r\n   - in the k8s installer\r\n- remove any integration or functional tests that test/verify memcached connectivity at startup/install time"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIsolated jobs are made possible by a few [internal playbooks](https://github.com/ansible/awx/tree/devel/awx/playbooks) used to start, check, heartbeat, and cleanup. This is also true for container groups. In Ansible 2.10 those playbooks will no longer work because content used by them has been moved out of ansible-base.\r\n\r\nWe recently began to vendor inventory plugins in https://github.com/ansible/awx/pull/6283, the same pattern can be used for isolated playbooks. As far as I know, this will require:\r\n\r\n - `community.kubernetes` for `kubectl` connection plugin\r\n - `ansible.posix.synchronize` for `synchronize` module\r\n\r\nSo we need to put those in a folder at build time, and then change the isolated logic to set the collections path for their location.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe instructions here:\r\n\r\nhttps://github.com/ansible/awx/blob/devel/docs/performance_data.md\r\n\r\nWill break with Ansible 2.10, because it relies on a callback plugin that is moved out of ansible-base.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nfollow instructions\r\n\r\n##### EXPECTED RESULTS\r\n\r\nworks\r\n\r\n##### ACTUAL RESULTS\r\n\r\ndoes not work\r\n\r\n> The data is stored under /var/log/tower/playbook_profiling. A new folder is created for each job run. The folder's name is set to the job's ID.\r\n\r\nBasically, that folder doesn't get populated, and playbooks show that something went wrong. Needs investigation.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSettings are applied in AWX, passed to ansible-runner\r\n\r\nhttps://github.com/ansible/awx/blob/d688f7b833bd963b8ecbb01bd6f3c9d8347ee0ab/awx/main/tasks.py#L1013-L1018\r\n\r\nThen Ansible runner enables the plugin, assuming that it is _available_ in the default search paths.\r\n\r\nhttps://github.com/ansible/ansible-runner/blob/f73705bf9b09424c9e5353d7f5119147e844eaa5/ansible_runner/runner_config.py#L210\r\n\r\nHowever, since that plugin moved to ~`community.general`~ `ansible.posix`, a step is missing. Actually 2 or 3 steps...\r\n\r\n - the community.general collection needs to be installed\r\n - (sometimes implied) that collection needs to be in the collection search paths\r\n - the plugin needs to be enabled with the fully qualified name\r\n\r\nThese will require fixes to `ansible-runner`, but the contract of how the collection gets installed needs to be solved in a inter-repo sense. Or maybe that gets left to the user. Or maybe the plugin gets moved to another collection...\r\n\r\nPing @jladdjr @sivel \r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen creating an inventory from a project that is based on a non-default git branch, inventory fails to sync because it only checks out the default branch regardless of the setting in the project\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.7\r\n* Operating System: Centos8\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a new project with the non-default git branch specified that contains your inventory file\r\n2. create an inventory based on this project. Use drop-down to specify the inventory file (the file does show up in the drop down)\r\n3. Attempt to sync inventory\r\n\r\n##### EXPECTED RESULTS\r\nInventory syncs successfully \r\n\r\n##### ACTUAL RESULTS\r\n```\r\n1.649 INFO     Updating inventory 11: K8S\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1139, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1026, in handle\r\n    source = self.get_source_absolute_path(self.source)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 326, in get_source_absolute_path\r\n    raise IOError('Source does not exist: %s' % source)\r\nOSError: Source does not exist: /tmp/awx_260_do3od8vj/project/inventory/k8s/hosts\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAfter running a job in AWX there is an error appearing in `importer.py` Not sure what is causing it. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.1.0\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.9.6\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a job and wait to finish it\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo Error\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nawx-ddfcd87cf-j5h6s awx-task 2020-04-29 11:56:03,429 ERROR    awx.main.tasks job 65882 (running) Exception occurred while running task\r\nawx-ddfcd87cf-j5h6s awx-task Traceback (most recent call last):\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 1481, in run\r\nawx-ddfcd87cf-j5h6s awx-task     res = ansible_runner.interface.run(**params)\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/ansible_runner/interface.py\", line 178, in run\r\nawx-ddfcd87cf-j5h6s awx-task     r.run()\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/ansible_runner/runner.py\", line 265, in run\r\nawx-ddfcd87cf-j5h6s awx-task     _delete()\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/ansible_runner/runner.py\", line 256, in _delete\r\nawx-ddfcd87cf-j5h6s awx-task     shutil.rmtree(self.config.process_isolation_path_actual)\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib64/python3.6/shutil.py\", line 486, in rmtree\r\nawx-ddfcd87cf-j5h6s awx-task     _rmtree_safe_fd(fd, path, onerror)\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib64/python3.6/shutil.py\", line 424, in _rmtree_safe_fd\r\nawx-ddfcd87cf-j5h6s awx-task     _rmtree_safe_fd(dirfd, fullname, onerror)\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib64/python3.6/shutil.py\", line 424, in _rmtree_safe_fd\r\nawx-ddfcd87cf-j5h6s awx-task     _rmtree_safe_fd(dirfd, fullname, onerror)\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib64/python3.6/shutil.py\", line 424, in _rmtree_safe_fd\r\nawx-ddfcd87cf-j5h6s awx-task     _rmtree_safe_fd(dirfd, fullname, onerror)\r\nawx-ddfcd87cf-j5h6s awx-task   [Previous line repeated 1 more time]\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib64/python3.6/shutil.py\", line 444, in _rmtree_safe_fd\r\nawx-ddfcd87cf-j5h6s awx-task     onerror(os.unlink, fullname, sys.exc_info())\r\nawx-ddfcd87cf-j5h6s awx-task   File \"/var/lib/awx/venv/awx/lib64/python3.6/shutil.py\", line 442, in _rmtree_safe_fd\r\nawx-ddfcd87cf-j5h6s awx-task     os.unlink(name, dir_fd=topfd)\r\nawx-ddfcd87cf-j5h6s awx-task PermissionError: [Errno 13] Permission denied: 'importer.py'\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n- External RDS Postgresql Database\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nFollowing the upgrade to 11.2.0, the vm_vm_inventory plugin does not seem to be accepting source variables from the UI. Customisation to settings are not reflected in the inventory output.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.2.0\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.9.7\r\n* Operating System: \r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a vmware inventory source with the following settings:\r\n\r\ncompose:\r\n  ansible_host: guest.hostName\r\n  ansible_ssh_host: guest.hostName\r\n\r\nrun inventory refresh. \r\n\r\n##### EXPECTED RESULTS\r\n\r\nansible_host and ansible_ssh_host should use the hostname of the device rather than ip and tags should be present.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nansible_host and ansible_ssh_host still contain IP address.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nHave tried other parameters too.\r\n\r\nthe hostname field doesnt appear to work\r\nthe with_tags field also doesnt do anything that i can see\r\nno errors outputted when debug level enabled.\r\n\r\nvmmware_vm_inventory.yml file in /tmp at runtime looks like this (missing custom values):\r\n\r\ncompose:\r\n  ansible_host: guest.ipAddress\r\n  ansible_ssh_host: guest.ipAddress\r\n  ansible_uuid: 99999999 | random | to_uuid\r\n  availablefield: availableField\r\n  configissue: configIssue\r\n  configstatus: configStatus\r\n  customvalue: customValue\r\n  effectiverole: effectiveRole\r\n  guestheartbeatstatus: guestHeartbeatStatus\r\n  layoutex: layoutEx\r\n  overallstatus: overallStatus\r\n  parentvapp: parentVApp\r\n  recenttask: recentTask\r\n  resourcepool: resourcePool\r\n  rootsnapshot: rootSnapshot\r\n  triggeredalarmstate: triggeredAlarmState\r\nfilters:\r\n- runtime.powerState == \"poweredOn\"\r\nkeyed_groups:\r\n- key: guest.guestId\r\n  prefix: ''\r\n  separator: ''\r\n- key: '\"templates\" if config.template else \"guests\"'\r\n  prefix: ''\r\n  separator: ''\r\nplugin: community.vmware.vmware_vm_inventory\r\nproperties:\r\n- availableField\r\n- configIssue\r\n- configStatus\r\n- customValue\r\n- datastore\r\n- effectiveRole\r\n- guestHeartbeatStatus\r\n- layout\r\n- layoutEx\r\n- name\r\n- network\r\n- overallStatus\r\n- parentVApp\r\n- permission\r\n- recentTask\r\n- resourcePool\r\n- rootSnapshot\r\n- snapshot\r\n- tag\r\n- triggeredAlarmState\r\n- value\r\n- capability\r\n- config\r\n- guest\r\n- runtime\r\n- storage\r\n- summary\r\nstrict: false\r\nwith_nested_properties: true\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: openshift\r\n* Ansible version: 2.6.19\r\n* Operating System: Red Hat Enterprise Linux 7.7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!\r\nInstallation has no error msg reported:\r\n\r\nTASK [local_docker : Update CA trust in awx_task container] *************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nPLAY RECAP **************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=47   changed=20   unreachable=0    failed=0\r\n\r\n[root@uswix532 awx]# oc get pod\r\nNAME                   READY     STATUS    RESTARTS   AGE\r\nawx-85575c8fbd-l9mf9   4/4       Running   0          7m\r\npostgresql-1-ttjqb     1/1       Running   0          11m\r\n[root@uswix532 awx]#\r\n[root@uswix532 awx]# oc get route\r\nNAME          HOST/PORT                                 PATH      SERVICES      PORT      TERMINATION     WILDCARD\r\nawx-web       awx-web.tapps.oc.kohlerco.com                       awx-web-svc   http                      None\r\nawx-web-svc   awx-web-svc-awx-1.tapps.oc.kohlerco.com             awx-web-svc   http      edge/Redirect   None\r\n[root@uswix532 awx]# curl http://awx-web.tapps.oc.kohlerco.com\r\n<html>\r\n<head><title>502 Bad Gateway</title></head>\r\n<body bgcolor=\"white\">\r\n<center><h1>502 Bad Gateway</h1></center>\r\n<hr><center>nginx</center>\r\n</body>\r\n</html>\r\n[root@uswix532 awx]#\r\n\r\n\r\nI look into awx pod logs, and saw this:\r\n\r\n\r\n335 static files copied to '/var/lib/awx/public/static'.\r\n2020-04-30 19:03:43,330 INFO RPC interface 'supervisor' initialized\r\n2020-04-30 19:03:43,330 CRIT Server 'unix_http_server' running without any HTTP authentication checking\r\n2020-04-30 19:03:43,330 INFO supervisord started with pid 72\r\n2020-04-30 19:03:44,333 INFO spawned: 'awx-config-watcher' with pid 75\r\n2020-04-30 19:03:44,337 INFO spawned: 'nginx' with pid 76\r\n2020-04-30 19:03:44,338 INFO spawnerr: can't find command 'scl'\r\n2020-04-30 19:03:44,339 INFO spawnerr: can't find command 'scl'\r\n2020-04-30 19:03:44,341 INFO spawned: 'wsbroadcast' with pid 77\r\n2020-04-30 19:03:44,343 INFO spawnerr: can't find command 'rsyslogd'\r\nREADY\r\n2020-04-30 19:03:45,483 INFO success: awx-config-watcher entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-04-30 19:03:45,484 INFO success: nginx entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-04-30 19:03:45,485 INFO spawnerr: can't find command 'scl'\r\n2020-04-30 19:03:45,486 INFO spawnerr: can't find command 'scl'\r\n2020-04-30 19:03:45,486 INFO success: wsbroadcast entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-04-30 19:03:45,487 INFO spawnerr: can't find command 'rsyslogd'\r\n2020-04-30 19:03:47,498 INFO spawnerr: can't find command 'scl'\r\n2020-04-30 19:03:47,498 INFO spawnerr: can't find command 'scl'\r\n2020-04-30 19:03:47,499 INFO spawnerr: can't find command 'rsyslogd'\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/run_wsbroadcast.py\", line 19, in handle\r\n    broadcast_websocket_mgr = BroadcastWebsocketManager()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/wsbroadcast.py\", line 154, in __init__\r\n    self.local_hostname = get_local_host()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/wsbroadcast.py\", line 45, in get_local_host\r\n    return Instance.objects.me().hostname\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/managers.py\", line 116, in me\r\n    raise RuntimeError(\"No instance found with the current cluster host id\")\r\nRuntimeError: No instance found with the current cluster host id\r\n2020-04-30 19:03:48,225 INFO exited: wsbroadcast (exit status 1; not expected)\r\n2020-04-30 19:03:49,228 INFO spawned: 'wsbroadcast' with pid 84\r\n2020-04-30 19:03:50,233 INFO success: wsbroadcast entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-04-30 19:03:51,234 INFO spawnerr: can't find command 'scl'\r\n2020-04-30 19:03:51,234 INFO gave up: uwsgi entered FATAL state, too many start retries too quickly\r\n2020-04-30 19:03:51,235 INFO spawnerr: can't find command 'scl'\r\n2020-04-30 19:03:51,235 INFO gave up: daphne entered FATAL state, too many start retries too quickly\r\n2020-04-30 19:03:51,235 INFO spawnerr: can't find command 'rsyslogd'\r\n2020-04-30 19:03:51,235 INFO gave up: awx-rsyslogd entered FATAL state, too many start retries too quickly\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/run_wsbroadcast.py\", line 19, in handle\r\n    broadcast_websocket_mgr = BroadcastWebsocketManager()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/wsbroadcast.py\", line 154, in __init__\r\n    self.local_hostname = get_local_host()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/wsbroadcast.py\", line 45, in get_local_host\r\n    return Instance.objects.me().hostname\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/managers.py\", line 116, in me\r\n    raise RuntimeError(\"No instance found with the current cluster host id\")\r\nRuntimeError: No instance found with the current cluster host id\r\n2020-04-30 19:03:53,162 INFO exited: wsbroadcast (exit status 1; not expected)\r\n2020-04-30 19:03:54,165 INFO spawned: 'wsbroadcast' with pid 90\r\n2020-04-30 19:03:55,168 INFO success: wsbroadcast entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2020-04-30 19:03:57,701 WARNING  awx.main.wsbroadcast awx-85575c8fbd-vk4m8 going to add {'10.130.1.13'} to the websocket broadcast list\r\n2020-04-30 19:03:57,706 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 0 to 10.130.1.13\r\n2020-04-30 19:04:00,725 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\nRESULT 2\r\nOKREADY\r\n2020-04-30 19:04:00,734 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 1 to 10.130.1.13\r\n2020-04-30 19:04:08,749 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:04:08,752 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 2 to 10.130.1.13\r\n2020-04-30 19:04:16,765 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:04:16,768 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 3 to 10.130.1.13\r\n2020-04-30 19:04:24,783 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:04:24,787 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 4 to 10.130.1.13\r\n2020-04-30 19:04:32,799 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:04:32,803 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 5 to 10.130.1.13\r\n2020-04-30 19:04:40,815 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:04:40,818 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 6 to 10.130.1.13\r\n2020-04-30 19:04:48,829 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:04:48,832 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 7 to 10.130.1.13\r\n2020-04-30 19:04:56,843 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:04:56,846 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 8 to 10.130.1.13\r\nRESULT 2\r\nOKREADY\r\n2020-04-30 19:05:04,861 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:05:04,945 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 9 to 10.130.1.13\r\n2020-04-30 19:05:07,767 WARNING  awx.main.wsbroadcast awx-85575c8fbd-vk4m8 going to remove {'10.130.1.13'} from the websocket broadcast list\r\n2020-04-30 19:05:07,769 WARNING  awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connection to 10.130.1.13 cancelled\r\n\r\n\r\n\r\n\r\n\r\n2020-04-30 19:05:04,861 WARNING  awx.main.wsbroadcast Failed to connect to 10.130.1.13: 'Cannot connect to host 10.130.1.13:8052 ssl:False [Connect call failed ('10.130.1.13', 8052)]'. Reconnecting ...\r\n2020-04-30 19:05:04,945 DEBUG    awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connect attempt 9 to 10.130.1.13\r\n2020-04-30 19:05:07,767 WARNING  awx.main.wsbroadcast awx-85575c8fbd-vk4m8 going to remove {'10.130.1.13'} from the websocket broadcast list\r\n2020-04-30 19:05:07,769 WARNING  awx.main.wsbroadcast awx-85575c8fbd-vk4m8 connection to 10.130.1.13 cancelled\r\n2020/04/30 19:05:45 [error] 78#0: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 10.129.0.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx-web-svc-awx.tapps.oc.kohlerco.com\", referrer: \"https://uswix532.kohlerco.com:8443/ \"\r\n10.129.0.1 - - [30/Apr/2020:19:05:45 +0000] \"GET / HTTP/1.1\" 502 568 \"https://uswix532.kohlerco.com:8443/ \" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36\" \"10.20.5.218\"\r\nRESULT 2\r\nOKREADY\r\n2020/04/30 19:06:41 [error] 78#0: *3 connect() failed (111: Connection refused) while connecting to upstream, client: 10.129.0.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx-web-svc-awx.tapps.oc.kohlerco.com\", referrer: \"https://uswix532.kohlerco.com:8443/ \"\r\n10.129.0.1 - - [30/Apr/2020:19:06:41 +0000] \"GET / HTTP/1.1\" 502 568 \"https://uswix532.kohlerco.com:8443/ \" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36\" \"10.20.5.218\"\r\nRESULT 2\r\n\r\n\r\n\r\n>\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nI'd like to see kerberos supported as an auth method for the web UI, much like satellite supports kerberos SSO for their web UI. \r\n\r\nI realize there is kerberos support for winrm, that is not what I am talking about here. I want as a user, to be able to go to my awx/tower instance in my web browser which is properly configured to expose kerberos credentials, and just be logged in. \r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Documentation\r\n##### COMPONENT NAME\r\n - API\r\n##### SUMMARY\r\nHi,\r\nI'm during the synchronization of OpenStack and AWX. I made a dynamic inventory of hosts that are deployed on my OpenStack cloud using the appriopriate credentials. The hosts are detected correctly, and doing job templates manually works, but I will be in need of making an API callbacks and SSH using floating ips of the virtual machines. So, right now I can see in AWX, in the host variables that these parameters are the private-networks IPs:\r\nansible_host: 192.168.100.11\r\nansible_ssh_host: 192.168.100.11\r\nI can see that both IPs are discovered:\r\naddresses:\r\n    private:\r\n      - 'OS-EXT-IPS-MAC:mac_addr': 'fa:16:3e:19:9f:fb'\r\n        'OS-EXT-IPS:type': fixed\r\n        addr: 192.168.100.11\r\n        version: 4\r\n      - 'OS-EXT-IPS-MAC:mac_addr': 'fa:16:3e:19:9f:fb'\r\n        'OS-EXT-IPS:type': floating\r\n        addr: 10.0.0.147\r\n        version: 4\r\n\r\nFor this inventory job I use the venv: /var/lib/awx/venv/ansible\r\nI can't find out in the docs, how I can change the script to take the floating IPs from an inventory as an assible_ssh_host parameter.. In this case 10.0.0.147\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.0.0\r\n* AWX install method: docker\r\n* Ansible version:  2.9.5\r\n* Operating System: CentOS7\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For new features, show how the feature would be used. For bugs, please show\r\nexactly how to reproduce the problem. Ideally, provide all steps and data needed\r\nto recreate the bug from a new awx install. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\nansible_ssh_host: 10.0.0.147 <-- floating ip from OpenStack\r\n\r\n##### ACTUAL RESULTS\r\n\r\nansible_ssh_host: 192.168.100.11 <-- right now i collect private ip from OpenStack\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nTrying to configure AWX with SAML Authentication to work against AWS SSO.\r\nCan log in to the SSO page, but when I select the AWX app, login appears to work, but gets redirected to the login page.\r\n\r\nawx_web log indicates: ERROR social 'Subject'\r\nGuidance required regarding the setting of attr_user_permanent_id and mapping in AWS SSO\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.3\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHave configured AWS SSO with a Microsoft AD server as per AWS Landing Zone.\r\nCreated AWX Application in AWS SSO:\r\n\r\nWith Attribute mappings:\r\n\r\n```\r\nSubject : ${user:subject} format=unspecified \r\nUser.Email : ${user:email} format=unspecified \r\nUser.FirstName: ${user.givenName} format=unspecified \r\nUser.LastName: ${user.familyName} format=unspecified \r\n```\r\n\r\nAWX SAML Configured with:\r\nSAML Enabled Identity Providers:\r\n```\r\n{\r\n \"amazon\": {\r\n  \"entity_id\": \"https://portal.sso.eu-west-2.amazonaws.com/saml/assertion/<id here>\",\r\n  \"attr_last_name\": \"User.LastName\",\r\n  \"attr_first_name\": \"User.FirstName\",\r\n  \"x509cert\": \"<cert here>\",\r\n  \"attr_username\": \"User.Email\",\r\n  \"attr_user_permanent_id\": \"Subject\",\r\n  \"attr_email\": \"User.Email\",\r\n  \"url\": \"https://portal.sso.eu-west-2.amazonaws.com/saml/assertion/<id here>\"\r\n }\r\n}\r\n```\r\n\r\nWent to AWX login page. Selected S option for SAML.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nGot redirected to AWX as logged user:\r\n\r\n##### ACTUAL RESULTS\r\n\r\nlogin failure:\r\n\r\n```\r\n10.0.0.136 - - [29/Apr/2020:22:09:38 +0000] \"GET /api/ HTTP/1.1\" 200 186 \"https://awx.bright-env.co.uk/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36\" \"109.207.29.2\"\r\n[pid: 1054|app: 0|req: 67/164] 10.0.0.136 () {56 vars in 1064 bytes} [Wed Apr 29 22:09:38 2020] GET /api/v2/auth/ => generated 296 bytes in 28 msecs (HTTP/1.1 200) 8 headers in 231 bytes (1 switches on core 0)\r\n10.0.0.136 - - [29/Apr/2020:22:09:38 +0000] \"GET /api/v2/auth/ HTTP/1.1\" 200 296 \"https://awx.bright-env.co.uk/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36\" \"109.207.29.2\"\r\n[pid: 1054|app: 0|req: 68/165] 10.0.0.136 () {36 vars in 410 bytes} [Wed Apr 29 22:09:40 2020] GET / => generated 11361 bytes in 27 msecs (HTTP/1.1 200) 5 headers in 169 bytes (1 switches on core 0)\r\n10.0.0.136 - - [29/Apr/2020:22:09:40 +0000] \"GET / HTTP/1.1\" 200 11361 \"-\" \"ELB-HealthChecker/1.0\" \"-\"\r\n[pid: 1058|app: 0|req: 49/166] 10.0.0.136 () {58 vars in 1210 bytes} [Wed Apr 29 22:09:41 2020] GET /sso/login/saml/?idp=amazon => generated 0 bytes in 38 msecs (HTTP/1.1 302) 10 headers in 1327 bytes (1 switches on core 0)\r\n10.0.0.136 - - [29/Apr/2020:22:09:41 +0000] \"GET /sso/login/saml/?idp=amazon HTTP/1.1\" 302 0 \"https://awx.bright-env.co.uk/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36\" \"109.207.29.2\"\r\n[pid: 1058|app: 0|req: 50/167] 10.0.0.79 () {36 vars in 409 bytes} [Wed Apr 29 22:09:41 2020] GET / => generated 11361 bytes in 28 msecs (HTTP/1.1 200) 5 headers in 169 bytes (1 switches on core 0)\r\n10.0.0.79 - - [29/Apr/2020:22:09:41 +0000] \"GET / HTTP/1.1\" 200 11361 \"-\" \"ELB-HealthChecker/1.0\" \"-\"\r\n10.0.0.136 - - [29/Apr/2020:22:09:43 +0000] \"GET /websocket/ HTTP/1.1\" 499 0 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36\" \"109.207.29.2\"\r\n2020-04-29 22:09:44,371 ERROR    social 'Subject'.\r\n[pid: 1058|app: 0|req: 51/168] 10.0.0.136 () {64 vars in 1301 bytes} [Wed Apr 29 22:09:44 2020] POST /sso/complete/saml/ => generated 0 bytes in 55 msecs (HTTP/1.1 302) 8 headers in 356 bytes (1 switches on core 0)\r\n10.0.0.136 - - [29/Apr/2020:22:09:44 +0000] \"POST /sso/complete/saml/ HTTP/1.1\" 302 0 \"https://d-9c67284071.awsapps.com/start\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36\" \"109.207.29.2\"\r\n10.0.0.136 - - [29/Apr/2020:22:09:44 +0000] \"GET /sso/error/ HTTP/1.1\" 301 0 \"https://d-9c67284071.awsapps.com/start\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36\" \"109.207.29.2\"\r\n[pid: 1054|app: 0|req: 69/169] 10.0.0.136 () {58 vars in 1237 bytes} [Wed Apr 29 22:09:44 2020] GET /sso/error/ => generated 0 bytes in 40 msecs (HTTP/1.1 301) 8 headers in 373 bytes (1 switches on core 0)\r\n[pid: 1058|app: 0|req: 52/170] 10.0.0.136 () {58 vars in 1217 bytes} [Wed Apr 29 22:09:44 2020] GET / => generated 11361 bytes in 32 msecs (HTTP/1.1 200) 7 headers in 334 bytes (1 switches on core 0)\r\n10.0.0.136 - - [29/Apr/2020:22:09:44 +0000] \"GET / HTTP/1.1\" 200 11361 \"https://d-9c67284071.awsapps.com/start\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36\" \"109.207.29.2\"\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<! Trying to login to AWX UI as admin user but unable to authenticate. tried changing password of admin user, but still unable to login. Tried creating new Superuser, and tried login, but not able to authenticate \r\n\r\n[root@installer]# docker container list\r\nCONTAINER ID        IMAGE                        COMMAND                  CREATED             STATUS              PORTS\r\n65c557c0795c        ansible/awx_task:9.2.0       \"/tini -- /bin/sh ...\"   2 months ago        Up 4 days           8052/tcp\r\n351d03535368        postgres:10                  \"docker-entrypoint...\"   2 months ago        Up 4 days           5432/tcp\r\nca93079fba25        memcached:alpine             \"docker-entrypoint...\"   2 months ago        Up 4 days           11211/tcp\r\n0aa178b007a4        ansible/awx_rabbitmq:3.7.4   \"docker-entrypoint...\"   2 months ago        Up 4 days           4369/tcp, 5671-5672/tcp, 15671-15672/tcp, 25672/tc\r\n[root@installer]# ansible-playbook -i inventory  install.yml^C\r\n[root@installer]# docker exec -it awx_task bash\r\nbash-4.4# awx-manage\r\n\r\nbash-4.4# awx-manage changepassword admin\r\nChanging password for user 'admin'\r\nPassword:\r\nPassword (again):\r\nPassword changed successfully for user 'admin'\r\nbash-4.4# awx-manage changepassword admin\r\nChanging password for user 'admin'\r\nPassword:\r\nPassword (again):\r\nPassword changed successfully for user 'admin'\r\nbash-4.4# awx-manage createsuperuser\r\nUsername (leave blank to use 'root'): parashar\r\nEmail address: abc@abc.com\r\nPassword:\r\nPassword (again):\r\nSuperuser created successfully.\r\nbash-4.4# exit\r\n[root@installer]#\r\n\r\nUpon login showing \"Invalid username and/or password. Please try again.\"\r\n>\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.8\r\n* Operating System: RHEL 7.7\r\n* Web Browser: Chrom\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For new features, show how the feature would be used. For bugs, please show\r\nexactly how to reproduce the problem. Ideally, provide all steps and data needed\r\nto recreate the bug from a new awx install. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\n###### OPTION 1\r\n\r\nRight now, the administrator for our AWX instance doesn't want to give out administrator privileges to organization owners. This means I can't create custom credential types. I'd like to be able to set environment variables using credentials, but doesn't seem possible in our current setup.\r\n\r\nA fix could be to allow custom credential types to optionally exist in an organization so an organization owner can define their own credential types.\r\n\r\n###### OPTION 2\r\n\r\nThis option might be easier.\r\n\r\nThere could also be a credential type of ENVIRONMENT VARIABLE. Where you can set the name of the environment variable and it's value that will get set prior to running the playbook.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIn dev environment, if we try and run an inventory update for a source that uses a plugin from one of the vendored collections, it says it cannot find it.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nTry and run an aws, gce, openstack, rhv, vmware or foreman update in the dev environment\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nfinds vendored content and uses it\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\n```\r\n[WARNING]:  * Failed to parse /tmp/awx_3_x8wetew_/aws_ec2.yml with auto plugin:\r\ninventory config '/tmp/awx_3_x8wetew_/aws_ec2.yml' specifies unknown plugin\r\n'amazon.aws.aws_ec2'\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n1) Update awx/settings/local_settings.py.docker_compose to have INVENTORY_COLLECTIONS_ROOT = '/vendor/inventory_collections'\r\n2) At container build time when /vendor/inventory_collections gets made, we need to make sure it belongs to or is usable by the awx user (edited) "},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nSupport OAuth on Bitbucket Cloud\r\n\r\n##### SUMMARY\r\nIn nowadays platform already supports `Azure AD`, `Github`, `Google Oauth2` and others...\r\n\r\nAtlassian products have a wide general adoption among many companies and would be great to have support to use [OAuth with Bitbucket](https://confluence.atlassian.com/bitbucket/oauth-on-bitbucket-cloud-238027431.html)\r\n\r\nIt's a good feature to add?"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Organisational process\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI contact you to get information on the processes to have in a large company.\r\n\r\nWe have a fleet of many machines (more than 12000) in a reference (Service Now).\r\nWe want to create them automatically by product via an admin account in the AWX organizations to which they correspond, while allowing normal users to assign them in inventories as they wish (adding only the machines already created). On the other hand, they should not be able to create new machines themselves.\r\nHow can we do this without removing their right to add variables on hosts or the ability to create groups?\r\n\r\nThanks in advance for your help\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method: docker on linux"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nAWX not publishing logs to Splunk HEC\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.5 \r\n* Operating System: RHEL\r\n* Web Browser: Firefox 75\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn System settings / logging tab fill setup form with\r\n- logging collector ip/fqdn\r\n- logging collector type : Splunk\r\n- logging collector password : Token from Splunk HEC setup console\r\n- logs to be sent : awx, activity_stream, job_events, system_tracking\r\n- logging collector protocol : HTTP/HTTPS\r\n- disable HTTPS certificate check (that's because it's a self-signed in my case)\r\n\r\nThen save changes and activate external logging by checking 'Enable external logging' option \r\n\r\nClick on 'TEST' button to send test event to Splunk collector. \r\nTry to launch a test playbook to confirm there is nothing logged in Splunk.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLog events are expected in Splunk console from the right event collector.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo event found at all in Splunk console for defined event collector.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI tryed with IP and FQDN of Splunk HEC as target in settings.\r\n\r\nEvents are well received when sent from curl command line -> Not an issue in Splunk setup\r\nEvent logging is working with AWX 1.0.7.2\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently I can only define permissions \"approve\" for a whole \"workflow\".  \r\nBut sometimes it is important that different persons or teams can approve multiple approve-steps in one workflow.  \r\nFor example team1 is responsible to approve the 1st task, team2 is responsible to approve the 2nd task.\r\nSo there is the need to have a more detailed permission schema for approvals.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nWhen a playbook is not valid but its filename is specified using a rest api enpoint, (e.g using job_templates endpoint) the system returns \"Playbook not found for project\".\r\n\r\n##### SUMMARY\r\nError \"Playbook not found for project\", suggest users that yaml file doesn't exist at specified playbook path. In this particular situation error message like \"Playbook specified doesn't contain any plays\" or \"Playbook specified is not a valid playbook\" would clearly suggest user where problem lies.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Enhancement \r\n\r\n##### SUMMARY\r\nKeystone v3 requires project_domain_name to authenticate, but AWX openstack credential doesn't provide / request those in the credential templating.\r\n\r\nCurrently when the cloud.yml file is generated it is populated with:\r\n\r\n```\r\nclouds:\r\n  devstack:\r\n    auth:\r\n      auth_url: \r\n      domain_name: \r\n      password:\r\n      project_name:\r\n      username:\r\n```\r\n\r\nInstead for v3 this should include \"project_domain_name\"\r\n\r\n```\r\nclouds:\r\n  devstack:\r\n    auth:\r\n      auth_url: \r\n      domain_name:\r\n      password:\r\n      project_domain_name: \r\n      project_name:\r\n      username: \r\n```\r\n"},{"labels":["api",null,null,null],"text":"This appears to be missing from the foreman plugin -- believe it will need to be added.\r\n\r\nHere is where rich_params are implemented in the script:\r\nhttps://github.com/ansible/ansible/blob/stable-2.9/contrib/inventory/foreman.py#L218-L232\r\n\r\nIt seems like this shouldn't be too tricky to add, but will require a new foreman collection release."},{"labels":["api",null,null],"text":"Believe this can be achieved with:\r\n```\r\nif want_ansible_ssh_host:\r\n             ret['compose'] = {'ansible_ssh_host': \"foreman['ip6'] | default(foreman['ip'], true)\"}\r\n```"},{"labels":["api",null,null],"text":"I have talked with @wtome about this and we have an idea of how this can be done. The solution is gnarly, and there may still be problems with it, so not trivial. Probably a few hours of work to confirm that the approach does in fact work and actually add it in.\r\n"},{"labels":["api",null,null],"text":"`awx-manage run_wsbroadcast --status` events per minute calculate isn't quite correct. Run something that continues to emit events. Let it run a bit and observe it. After about a minute it sort of resets."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWe have scheduled jobs which run periodically but should **not** run on holidays.\r\nCurrently we manually disable this job or change the \"start time\" to a later day.\r\n\r\nSpecially in highly automated environments I could imagine that issue affects some users.\r\nGreets\r\nSimon"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWhen the fact cache is utilized in AWX, we query the database for the fact blobs at job start for each host, write them to the execution bundle alongside the project, and send it off for execution.\r\n\r\nThis can lead to a notable startup penalty when a) the facts for a host are large b) the size of the inventory is large.\r\n\r\nWe should investigate what can be done to optimize this, both tactically at the in terms of optimizing queries, and strategically in terms of potentially moving to a different mode of fact storage.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\nAdd native AWS Cognito support to AWX\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nTogether with other authentication mechanisms it would be useful if AWX could support AWS Cognito.\r\nTo get some lightweight support, we are currently having to jerry rig a solution with:\r\nAWX authenticates with Azure AD \r\nAzure AD has AWS Cognito has an identity provider.\r\n\r\nThis is less than ideal as it requires us to maintain two Identity systems across two cloud providers.\r\nIt would be preferable if AWX could directly support Cognito.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n# Unified workflow\r\n\r\n**TL;DR**: Possibility to concatenate multiple templates, treating them as one unit. Plus adding support for error handling on per host basis in a workflow. \r\n\r\n## Problem\r\n\r\n Todays workflow job templates (WFJT) are not usable in a large scale deployment environment with multiple teams writing their own playbooks for installing different platforms\r\n\r\nApart from being awesome it'd make AWX a better contender to other automation platforms **cough***vRA***cough** as engine for deploying virtual machines.\r\n\r\n## Example\r\nRun a multiple stage vm deployment (with a cleanup node for failed hosts) against an inventory of new hosts. If one of these hosts fails in a node the full inventory will be sent to the fail link of that node and even if the desired outcome is run the fail node on all hosts, the node will exit on a success and not mark the WFJT as failed.\r\n\r\n\r\n\r\n- Team 1 are in charge of creating virtual machines, they create the playbooks \"Clone\", \"Destroy\" and \"Add disk\".\r\n- Team 2 are in charge of server tuning and baseline installations, they create the playbooks \"Server tuning\", \"Add interface\", \"Create and mount disk\" contained in \"New server installation\". \r\n- Team 3 are the network guys. They create the playbooks \"Get IP from IPAM\" and \"Delete from IPAM\". \r\n- Team 4 are consumers of the playbooks above. Using a UWFT they create a simple vm with one root disk and two interfaces to later on add their own platform on top of it.\r\n- Team 5 adds their application on.\r\n\r\n````\r\nTeam 4: New server installation \r\nTeam 1:  |       |---> Clone\r\nTeam 2:  |              |-----------------> Add interface (eth0)\r\nTeam 3:  |                                        |------------> Get IP from IPAM.\r\nTeam 2:  |-----------------> Server tuning.\r\nTeam 4:  |-----------------> Add interface (eth1).\r\nTeam 3:  |                         |------------> Get IP from IPAM.\r\nTeam 4:  |-----------------> Template: run `package` module\r\n         |\r\n         |---> <All above successful?>\r\n         |       - Yes: ------------------------|\r\n         |       - No:                          |\r\n         |         | ----> Notify team 2 and 4. |\r\n         |         | -----> Destoy machine.     |\r\n         |                  |------> Fail host. |\r\nTeam 5:  |                                      | -> Install application\r\n         |                                              |--> <OK?>\r\n         |                                                    - No: Notify team 4 and 5, keep host.\r\n         |---> Notify team 5.\r\n\r\n````\r\n\r\nIn a single-host inventory this would not pose a problem since all (one) hosts should fail. But if one were to deploy a multi server app were there are more consumers such as `team 4`, one failed host would destroy all other hosts and they all would have to be rebuilt because (for instance) something as as simple as a upstream webserver being unavailable. \r\n\r\n## Propsal\r\n\r\n* UWFT should override the inventory set in template **or** only work on templates set to blank inventory (and thus checked 'Prompt on launch').\r\n* UWFT should inherit surveys from workflow/templates.\r\n* Variables from one survey should be able to be mapped in a subsequent survey variable. \r\n* UFWT nodes links should have at least two (optimal three) selections: \"Only failed\", \"Only successful\" (, and \"Only changed\"), making it possible to do cleanups and streamlining workflows.\r\n* New node type: Notification. Use a existing notification in AWX as a node. \r\n* New node type: Fail. Used when any type node has run successfully to fail the host and/or (workflow) template. Failed host can be removed from inventory. For instance: delete and cleanup dns from failed host ran ok -> fail host, do not include in following nodes.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nafter inventory file changes , inventory sync jobs are stuck with awx 11 (it was working on awx 10).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.9.5\r\n* Operating System: CentOS 7.5 (docker)\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nlog from job (and the job keep running forever, and i need to manually cancel):\r\n\r\n    6.200 INFO     Updating inventory 2: Linux\r\n    7.081 INFO     Reading Ansible inventory source: /tmp/awx_10158_58549ekn/project/hosts\r\n    7.085 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    7.085 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/pgsql-10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    7.085 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\n    8.049 ERROR    ansible-inventory 2.9.5\r\n    8.049 ERROR      config file = /etc/ansible/ansible.cfg\r\n    8.049 ERROR      configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n    8.050 ERROR      ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n    8.050 ERROR      executable location = /usr/bin/ansible-inventory\r\n    8.050 ERROR      python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\n    8.050 ERROR    Using /etc/ansible/ansible.cfg as config file\r\n    8.050 ERROR    host_list declined parsing /tmp/awx_10158_58549ekn/project/hosts as it did not pass its verify_file() method\r\n    8.050 ERROR    script declined parsing /tmp/awx_10158_58549ekn/project/hosts as it did not pass its verify_file() method\r\n    8.050 ERROR    auto declined parsing /tmp/awx_10158_58549ekn/project/hosts as it did not pass its verify_file() method\r\n    8.050 ERROR    Parsed /tmp/awx_10158_58549ekn/project/hosts inventory source with ini plugin\r\n    8.050 ERROR    \r\n    8.050 INFO     Processing JSON output...\r\n    8.058 INFO     Loaded 27 groups, 476 hosts\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nthe job should sync quickly the inventory from remote git file\r\n\r\n##### ACTUAL RESULTS\r\n\r\njob stuck\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWhen using AWX 10.0 there is the approval process when using workflows. \r\n\r\nIt seems that for the slack integration there is limited variables for the approval process compared to the message process (success message, error message etc.) \r\n\r\nAlso, you are unable to add a new line for the approval process (WORKFLOW APPROVED MESSAGE, WORKFLOW DENIED MESSAGE, WORKFLOW PENDING APPROVAL MESSAGE, WORKFLOW TIMED OUT MESSAGE) making the slack messages not very customisable. \r\n\r\n- It would be good to be able to add new lines \r\n- Have more variables accessible as currently they are limited for the approval. \r\n- Able to approve workflows via a slack button, and to also have more information about the request inside of slack, to make the approval via a button possible so users are not approving blindly. \r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n![image](https://user-images.githubusercontent.com/214912/79778925-7fc75100-8307-11ea-9fdd-d7d382eca855.png)\r\n\r\n![image](https://user-images.githubusercontent.com/214912/79778935-835ad800-8307-11ea-91be-bf692185e882.png)\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen using satellite6(.7) as inventory source, the foreman_params are not populated whereas with satellite6.6 this worked.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.5\r\n* Operating System: RHEL 7.7\r\n* Web Browser: Chromium\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n- Use satellite6 as inventory and specify a satellite6.7 host\r\n- Sync and check one of the hosts\r\n- foreman_params is empty even when parameters are set\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nParameters set in satellite are available in AWX\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nforeman_params: {}\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nSatellite 6.6 worked fine but with the recently released update to 6.7 it doesn't work anymore."},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhile installing I am getting error\r\nTASK [local_docker : Start the containers] *****************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"errors\": [], \"module_stderr\": \"\", \"module_stdout\": \"\", \"msg\": \"Error starting project 500 Server Error: Internal Server Error (\\\"Get https://registry-1.docker.io/v2/library/memcached/manifests/alpine: Get https://auth.docker.io/token?scope=repository%3Alibrary%2Fmemcached%3Apull&service=registry.docker.io: net/http: TLS handshake timeout\\\")\"}\r\n\r\nPLAY RECAP *************************************************************************************************************************************************************\r\nlocalhost                  : ok=15   changed=2    unreachable=0    failed=1    skipped=97   rescued=0    ignored=0   \r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For new features, show how the feature would be used. For bugs, please show\r\nexactly how to reproduce the problem. Ideally, provide all steps and data needed\r\nto recreate the bug from a new awx install. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nI think for some monitoring setups it might be helpful to have an option that would allow for retrieving `/api/v2/metrics` without being authenticated. It would be opt-in, though."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nprocess in awx-task container continually crashes with \r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\npsycopg2.errors.UniqueViolation: duplicate key value violates unique constraint \"main_instance_ip_address_key\"\r\nDETAIL:  Key (ip_address)=(10.42.240.2) already exists.\r\nThe above exception was the direct cause of the following exception:\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/run_dispatcher.py\", line 55, in handle\r\n    reaper.reap()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/dispatch/reaper.py\", line 38, in reap\r\n    (changed, me) = Instance.objects.get_or_register()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/managers.py\", line 142, in get_or_register\r\n    return self.register(ip_address=pod_ip)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/managers.py\", line 129, in register\r\n    instance.save(update_fields=['ip_address'])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/ha.py\", line 40, in save\r\n    super(BaseModel, self).save(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/base.py\", line 741, in save\r\n    force_update=force_update, update_fields=update_fields)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/base.py\", line 779, in save_base\r\n    force_update, using, update_fields,\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/base.py\", line 851, in _save_table\r\n    forced_update)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/base.py\", line 900, in _do_update\r\n    return filtered._update(values) > 0\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 760, in _update\r\n    return query.get_compiler(self.db).execute_sql(CURSOR)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/sql/compiler.py\", line 1469, in execute_sql\r\n    cursor = super().execute_sql(result_type)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/sql/compiler.py\", line 1140, in execute_sql\r\n    cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 67, in execute\r\n    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 76, in _execute_with_wrappers\r\n    return executor(sql, params, many, context)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/utils.py\", line 89, in __exit__\r\n    raise dj_exc_value.with_traceback(traceback) from exc_value\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\ndjango.db.utils.IntegrityError: duplicate key value violates unique constraint \"main_instance_ip_address_key\"\r\nDETAIL:  Key (ip_address)=(10.42.240.2) already exists.\r\n```\r\n\r\nLogging into the container and running \r\n\r\n```\r\nbash-4.4$ supervisorctl -c /supervisor_task.conf status all\r\nawx-config-watcher                  RUNNING   pid 99, uptime 0:15:46\r\ntower-processes:callback-receiver   RUNNING   pid 101, uptime 0:15:46\r\ntower-processes:dispatcher          STARTING  \r\n```\r\n\r\nThe tower-process:dispatcher continually crashes with the error above\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.0.0 (upgrade from 10.0.0)\r\n* AWX install method: k8s\r\n\r\n##### Additional information\r\n\r\n```\r\nawx=> select * from main_instance;\r\n id |                 uuid                 |       hostname       |            created            |           modified            | capacity | version | last_isolated_check | capacity_adjustment | cpu | memory | cpu_capacity | mem_capacity | enabled | managed_by_policy | ip_address  \r\n----+--------------------------------------+----------------------+-------------------------------+-------------------------------+----------+---------+---------------------+---------------------+-----+--------+--------------+--------------+---------+-------------------+-------------\r\n  4 | 0a2640f6-7eee-4253-a609-fe37881229af | awx-7586cffcfb-76g4t | 2020-04-19 17:44:02.996354+00 | 2020-04-19 17:45:07.938583+00 |       20 | 11.0.0  |                     |                1.00 |   0 |      0 |            6 |           20 | t       | t                 | 10.42.128.1\r\n  5 | fca90a8c-7bba-49d7-a123-37e298ce6aa2 | awx-7586cffcfb-w84hg | 2020-04-19 17:45:50.45218+00  | 2020-04-19 17:45:55.683659+00 |       20 | 11.0.0  |                     |                1.00 |   0 |      0 |            6 |           20 | t       | t                 | 10.42.240.2\r\n  6 | a187ea32-95a7-4c7e-baa2-d952bf169482 | awx-7586cffcfb-dqdnz | 2020-04-19 17:46:29.799294+00 | 2020-04-19 17:46:29.799321+00 |        0 |         |                     |                1.00 |   0 |      0 |            0 |            0 | t       | t                 | \r\n  7 | af573bc6-6216-484c-b935-5147ffaee13d | awx-7586cffcfb-xjhzx | 2020-04-19 19:14:45.289215+00 | 2020-04-19 19:14:45.289241+00 |        0 |         |                     |                1.00 |   0 |      0 |            0 |            0 | t       | t                 | \r\n  8 | f74638fb-340e-46d0-bbf2-26e7910c5b5a | awx-7586cffcfb-zdnm9 | 2020-04-19 19:15:29.573238+00 | 2020-04-19 19:15:29.573303+00 |        0 |         |                     |                1.00 |   0 |      0 |            0 |            0 | t       | t                 | \r\n```\r\n\r\n```\r\nawx=> select * from main_instancegroup_instances;\r\n id | instancegroup_id | instance_id \r\n----+------------------+-------------\r\n  4 |                1 |           4\r\n  5 |                1 |           5\r\n(2 rows)\r\n\r\n```\r\n\r\nRunning \r\n\r\n```\r\nDELETE FROM main_instancegroup_instances WHERE id=5;\r\nDELETE FROM main_instance where id = 5;\r\n```\r\n\r\nAllows the process to start and then AWX is responsive."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nCan't selectively use the web UI\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.6\r\n* Operating System: CentOS 7\r\n* Web Browser: OperaGX,Chrome Latest,Firefox Latest, Microsoft Edge(web kit based)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCan't really describe how to reproduce because it happened after updating from 6.1.0 to 10.0.0\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\ngetting net::ERR_CONTENT_LENGTH_MISMATCH 200 (OK)\r\ntrying to open:\r\n\r\n1. Setting\r\n2. Running jobs\r\n3. Just randomly browsing templates\r\n\r\nTried to include custom nginx config disabling proxy buffer and increasing client body, didn't help.\r\n\r\nseems similar to https://github.com/ansible/awx/issues/5496"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nThe tower_project module scm_allow_override option does not work.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 11.0.0\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.9.6\r\n* Operating System: macOS\r\n* Web Browser: Chrome 80\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\ntask\r\n```yaml\r\n    - name: create projects\r\n      awx.awx.tower_project:\r\n        tower_host: \"http://{{ ansible_host }}\"\r\n        tower_username: \"{{ conn.tower_username }}\"\r\n        tower_password: \"{{ conn.tower_password }}\"\r\n        validate_certs: no\r\n        name: test_project\r\n        organization: test_org\r\n        scm_type: git\r\n        scm_url: https://github.com/akira6592/tower-sample-nw.git\r\n        scm_branch: master\r\n        scm_allow_override: true    # here\r\n```\r\n\r\n```\r\nansible-playbook -i inventory.ini create_pj.yml\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n```\r\nTASK [create projects] \r\nchanged: [awx1]\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/16851744/79631877-cd707c00-8196-11ea-9024-62e529d9804d.png)\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n```\r\nTASK [create projects] *********************************************************************************************\r\n[WARNING]: The field scm_allow_override of project 18 has encrypted data and may inaccurately report task is changed\r\nchanged: [awx1]\r\n```\r\n![image](https://user-images.githubusercontent.com/16851744/79631872-c3e71400-8196-11ea-9aa1-5a7998ab3d4d.png)\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\n\r\nThe API specification corresponding to `scm_allow_override` option is `allow_override`, not `scm_allow_override`.\r\n\r\nBut in `tower_project` module, it's set to `scm_allow_override`.\r\n\r\nhttps://github.com/ansible/awx/blob/b90a296d4196ccccf99a1ba9bfb00ee9de796edb/awx_collection/plugins/modules/tower_project.py#L257"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n1.  Turn on logging and point it at `localhost:8000`\r\n2.  Don't run any TCP services on `localhost:8000`.\r\n3.  Open `awx-manage shell_plus` and do this (and let it run for awhile):\r\n\r\n```python\r\nimport logging\r\nx = 'x' * (1024 * 64)\r\nl = logging.getLogger('awx')\r\nwhile True:\r\n    l.error(x)\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAWX continues to function without `rsyslogd` using gobs of memory, and when `localhost:8000` is properly enabled (minutes, hours) later, logs start being recorded properly.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nhttps://www.youtube.com/watch?v=QqMVjsaGEZo"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen using the VMware vCenter dynamic inventory the host name is imported in the format 'name_uuid'.  For example:\r\n`awx_43374ba9-b3f0-74cb-9ac4-fc4fa55bb14b`\r\n\r\nWhen using the limit parameter the hostname has to be in format `awx_*` , otherwise it does not match any hosts.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.5\r\n* Operating System: CentOS 7.7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd VMware vSphere as dynamic inventory source and start sync process\r\n\r\n##### EXPECTED RESULTS\r\n\r\nHosts are imported with the name as shown in the vCenter UI or using the hostname provided by VMware Tools installed on the VM\r\n\r\n##### ACTUAL RESULTS\r\n\r\nHost names are imported in the format 'name_uuid'.  For example:\r\n`awx_43374ba9-b3f0-74cb-9ac4-fc4fa55bb14b`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAlready tried to things to workaround this problem:\r\nAdd the following line to the Source Variables of the inventory source\r\n`alias_pattern: {{ config.name }}`\r\n\r\nEdited vmware_inventory.py and changed line 228 from `'alias_pattern': '{{ config.name + \"_\" + config.uuid }}'` to `'alias_pattern': '{{ config.name }}'`\r\n\r\nBut host names are still shown in format name_uuid\r\n\r\nIs this a expected behaviour?\r\nIs anyone else facing this issue? What can be done to change the name of the imported hosts?"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThis occurred when trying to delete in the `ui_next` project, but am unsure if it's doable elsewhere.\r\nUnder certain conditions, deleting multiple schedules from a job template results in a 500 error.\r\n\r\nThe schedule fails to delete, and still exists. A second attempt to delete the schedule succeeded without issue.\r\n\r\n##### STEPS TO REPRODUCE\r\nI have made this occur twice, but am unable to get consistent steps. Here is what I do know:\r\n1. Two schedules were created and toggled on/off a few times.\r\n2. Both schedules had high interval counts (like repeating once every 99999999 days)\r\n3. Both were deleted in a bulk-delete, that is clicking the select-all button and deleting the list of schedules on the job template. The API receives two DELETE requests in succession when this happens.\r\n\r\n##### EXPECTED RESULTS\r\nSuccessful deletion.\r\n\r\n##### ACTUAL RESULTS\r\n ```\r\nIntegrityError\r\n  at /api/v2/schedules/12/\r\ninsert or update on table \"main_unifiedjobtemplate\"; violates foreign key constraint \r\n\r\n\"main_unifiedjobtempl_next_schedule_id_955ff55d_fk_main_sche\"\r\nDETAIL:  Key (next_schedule_id)=(13) is not present in table \"main_schedule\"\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nWhen I'm trying to run the template or Project getting the below error, and stuck the screen and showing status is Pending\r\n\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/amqp/abstract_channel.py\", line 145, in dispatch_method\r\n    listener(*args)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/amqp/channel.py\", line 280, in _on_close\r\n    reply_code, reply_text, (class_id, method_id), ChannelError,\r\namqp.exceptions.NotFound: Queue.declare: (404) NOT_FOUND - failed to perform operation on queue 'awx_private_queue' in vhost 'awx' due to timeout\r\n2020-04-13 18:42:20,530 DEBUG    awx.main.dispatch listening on ['awx_private_queue [direct]', 'awx [direct]', 'tower_broadcast_all_awx [fanout]']\r\n2020-04-13 18:42:27,167 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(8823ce89-3d82-4f21-8f4e-f51bc4a7142a, queue=awx_private_queue)\r\n[2020-04-13 18:42:27,167: DEBUG/Process-1] publish awx.main.scheduler.tasks.run_task_manager(8823ce89-3d82-4f21-8f4e-f51bc4a7142a, queue=awx_private_queue)\r\n2020-04-13 18:42:35,689 DEBUG    awx.main.dispatch publish awx.main.tasks.awx_periodic_scheduler(d6644a44-9f3f-4d25-8490-0ebe29274305, queue=awx_private_queue)\r\n[2020-04-13 18:42:35,689: DEBUG/Process-1] publish awx.main.tasks.awx_periodic_scheduler(d6644a44-9f3f-4d25-8490-0ebe29274305, queue=awx_private_queue)\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 9.1.1\r\n* AWX install method: docker on Linux\r\n* Ansible version:  2.8.5\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For new features, show how the feature would be used. For bugs, please show\r\nexactly how to reproduce the problem. Ideally, provide all steps and data needed\r\nto recreate the bug from a new awx install. -->\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPlease help me out about these issues ASAP.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIn the new rsyslogd-based logging implementation, we should find a way to properly respect `settings.LOG_AGGREGATOR_TCP_TIMEOUT`.\r\n\r\nAs I recall, the *main* reason for this setting was to avoid having hung Python processes that never time out on requests.  That said, we should probably still do our best to respect it in our rsyslogd-based new implementation.\r\n\r\nThe `omhttp` module itself has a setting, `healthchecktimeout`, which we're properly passing in:\r\n\r\nhttps://github.com/rsyslog/rsyslog/blob/df17aee50132c7e6898b475bffd9dffef3c54b3b/contrib/omhttp/omhttp.c#L188\r\n\r\nThis value is used by the `omhttp` module to pass a timeout value to `libcurl` when it performs connectivity checks:\r\n\r\nhttps://github.com/rsyslog/rsyslog/blob/df17aee50132c7e6898b475bffd9dffef3c54b3b/contrib/omhttp/omhttp.c#L1624\r\nhttps://curl.haxx.se/libcurl/c/CURLOPT_TIMEOUT_MS.html\r\n\r\nThe TCP and UDP methods, however, are implemented using `omfwd`, which doesn't appear to support a timeout parameter for TCP (so far as I can tell):\r\n\r\nhttps://www.rsyslog.com/doc/v8-stable/configuration/modules/omfwd.html\r\n\r\nWe should figure out what to do about TCP.  Maybe *hide* the `LOG_AGGREGATOR_TCP_TIMEOUT` field in the UI if the logging type is *not* HTTP/s, or investigate TCP keepalive settings."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - When adding a multiple hosts manually you can only do it one at a time. The ability to add hostnames from a list would save time when hosts are manually managed. \r\n\r\n##### SUMMARY\r\nAbility to take a list of hostnames and add them all at one time or via a single API call. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nLarge jobs (both in number of managed hosts and number of tasks) can swamp the user with a lot of detail and blow up the size of the job events table. It would seem to be a good idea to have an optional flag that can be enabled on a job template that will restrict the types of events that are recorded. The default would be `all` but it could be further limited to `error` events or `none` where Only the section headers and final job summary are shown.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nIn some circumstances, running an Ansible playbook as an isolated job causes a spurious failure (despite all individual Ansible tasks succeeding), because a stray `.~tmp~` directory pops up in an unexpected place.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 10.0.0\r\n* AWX install method: openshift\r\n* Ansible version:  2.9.5\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Set `AWX_RESOURCE_PROFILING_ENABLED = True`\r\n- Keep running isolated jobs until the problem shows up\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAll such jobs should succeed or fail depending solely on the underlying Ansible tasks' outcomes\r\n\r\n##### ACTUAL RESULTS\r\n\r\nHere is an example stack trace (also found in #6280):\r\n\r\n```\r\nTraceback (most recent call last): \r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 1468, in run\r\n    ident=str(self.instance.pk)) \r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 422, in run   status, rc = self.check() \r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 241, in check\r\n     self.consume_events() \r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 293, in consume_events\r\n    open(os.path.join(events_path, event), 'r')\r\nIsADirectoryError: [Errno 21] Is a directory: '/tmp/awx_754_hs8ylxru/artifacts/754/job_events/.~tmp~' \r\n```\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen I configure AWX the base url of the tower host was **www.examp.com**. After that, I created Templates and integrated Notifications with Slack to a particular Slack channel. \r\n\r\nLater I figured out that the Base URL of the tower host is wrong. Hence, I went to AWX Settings > System > Base URL of Tower Host and did the necessary changes to the host i.e. **www.example.com**\r\n\r\nNow, when the slack notification appears in the slack channel, some time the Template job url will be,\r\nhttps://**examp.com**/#/jobs/playbook/1\r\nanother time the url will be, \r\nhttps://**example.com**/#/jobs/playbook/1\r\n\r\nHow to fix this issue? Request your assistance in this regards\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  \r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nMistype Base URL of Tower Host in AWX Settings > System > Base URL Tower Host block\r\nThen, enable Slack notifications. Found the typo error.\r\n\r\nLater, change the url to the correct one in the AWX Settings > System.\r\nEven after changing the base url, the slack notification gets typo url\r\n\r\n##### EXPECTED RESULTS\r\nI expect the Base url of Tower host is correct one in Slack notification.\r\n\r\n##### ACTUAL RESULTS\r\nSlack notification should have the correct base url \r\n\r\n##### ADDITIONAL INFORMATION\r\nI tried removing the Slack Integration/Notification completely in AWX and created a new Slack integration, but the issue prevails.\r\n\r\nRequest your assistance in this regards. \r\n\r\n~Mithun"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nHello,\r\nI run an AWX behind a httpd reverse proxy. We have non ssl http between reverse proxy and awx_web and clients access are https.\r\nI setup the built-in SAML authentication and there is a difference in assertions consummer url between admin panel and SAMLrequest generated by AWX.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1.0\r\n* AWX install method: docker on linux with ansible playbook\r\n* Ansible version:  2.8.5\r\n* Operating System: Red Hat 7.7\r\n* Web Browser: Firefox 68.7ESR \r\n\r\n##### STEPS TO REPRODUCE\r\nNeed a reverse proxy in front of AWX. Clients use https on 443 with proxy and proxy use http on 80 with AWX.\r\nIn SAML admin panel, ACS URL is auto generated and cant be modify. This URL seems good and have this format : https://<my_app>/sso/complete/saml/.\r\nSetup one or more identity provider, exchange metadata with service provider and identity provider. Then test (plugin samltracer maybe usefull).\r\n\r\n##### EXPECTED RESULTS\r\nIdentity provider look into metadata in request assertion consommer url exist, do the authentication and send SAMLresponse to service provider.\r\n\r\n##### ACTUAL RESULTS\r\nWhen AWX send SAMLrequest, assertion consummer url mismatch the one setup in admin panel, use the wrong protocol (http instead of https). \r\n```\r\n<samlp:AuthnRequest xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\"\r\n                    xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\"\r\n                    ID=\"ONELOGIN_d49724618111881c963be5d17a07d242995d7042\"\r\n                    Version=\"2.0\"\r\n                    ProviderName=\"<my_app>\"\r\n                    IssueInstant=\"2020-04-09T12:43:53Z\"\r\n                    Destination=\"https://<my_identity_proivder>/idp/profile/SAML2/Redirect/SSO\"\r\n                    ProtocolBinding=\"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST\"\r\n                    AssertionConsumerServiceURL=\"http://<my_app>/sso/complete/saml/\"\r\n                    >\r\n    <saml:Issuer>https://<my_app>/sp</saml:Issuer>\r\n    <samlp:NameIDPolicy Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\"\r\n                        AllowCreate=\"true\"\r\n                        />\r\n</samlp:AuthnRequest>\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nI try to overwrite them in field \"SAML SERVICE PROVIDER EXTRA CONFIGURATION DATA\" with a JSON like this :\r\n```\r\n{\r\n \"sp\": {\r\n  \"assertionConsumerService\": {\r\n   \"url\": \"https://<my_app>/sso/complete/saml/\",\r\n   \"binding\": \"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST\"\r\n  }\r\n }\r\n}\r\n```\r\n\r\nI try with the http version of ACS declared in identity provider metadata, SAMLrequest and authN work but i have a new error rise by AWX :\r\n```\r\nAuthentication failed: SAML login failed: ['invalid_response'] (The response was received at http://<my_app>:8052/sso/complete/saml/ instead of http://<my_app>/sso/complete/saml/).\r\n```\r\n\r\nIn awx_web, we found this :\r\n```\r\n[pid: 126|app: 0|req: 121/413] <reverse_proxy_ip_address> () {50 vars in 1748 bytes} [Thu Apr  9 13:06:10 2020] GET /sso/login/saml/?idp=<my_idp> => generated 0 bytes in 49 msecs (HTTP/1.1 302) 10 headers in 1088 bytes (1 switches on core 0)\r\n<reverse_proxy_ip_address> - - [09/Apr/2020:13:06:10 +0000] \"GET /sso/login/saml/?idp=<my_idp> HTTP/1.1\" 302 0 \"https://<my_app>/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0\" \"10.251.146.2\"\r\nfunc=xmlSecOpenSSLX509StoreVerify:file=x509vfy.c:line=341:obj=x509-store:subj=unknown:error=71:certificate verification failed:X509_verify_cert: subject=/C=FR/L=LLL/O=OOOO/CN=<my_app>; issuer=/C=FR/L=LLL/O=OOO/CN=<my_app>; err=18; msg=self signed certificate\r\nfunc=xmlSecOpenSSLX509StoreVerify:file=x509vfy.c:line=380:obj=x509-store:subj=unknown:error=71:certificate verification failed:subject=/C=FR/L=LLL/O=OOOO/CN=<my_app>; issuer=/C=FR/L=LLL/O=OOO/CN=<my_app>; err=18; msg=self signed certificate\r\nThe response was received at http://<my_app>:8052/sso/complete/saml/ instead of http://<my_app>/sso/complete/saml/\r\n2020-04-09 13:06:13,866 ERROR    social Authentication failed: SAML login failed: ['invalid_response'] (The response was received at http://<my_app>:8052/sso/complete/saml/ instead of http://<my_app>/sso/complete/saml/).\r\n```\r\nFor information, self signed x509 is used for SAML, not for HTTPS.\r\n\r\nMy reverse proxy configuration is very simple :\r\n```\r\n        # Reverse proxy\r\n        ProxyPreserveHost On\r\n        ProxyPass / http://<awx_pivate_address>:80/\r\n        ProxyPassReverse / http://<awx_pivate_address>:80/\r\n```\r\n\r\nI hope the information i provide is complete and clear.\r\nHave a nice day, Gilian."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen attempting to copy a small workflow (with a single approval node), I found that the copied workflow launched and completed without requesting an approval. Further investigation showed that the copied workflow visualizer showed an empty workflow.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n\r\n##### STEPS TO REPRODUCE\r\nBoth @jakemcdermott and I were able to reproduce this (osx, fedora)\r\n\r\n1. Create a new workflow job template.\r\n2. Add one approval node to the workflow. Save it, and launch it. Do not approve the workflow, so it stays in a pending state.\r\n3. Copy the workflow using the copy button in the template list.\r\n4. Attempt to launch the copied workflow.\r\n\r\n##### EXPECTED RESULTS\r\nThe workflow also waits for approval.\r\n\r\n##### ACTUAL RESULTS\r\nThe workflow does not wait for approval. Inspection shows that the workflow is empty."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUsing password grant type, refresh token does not expire according to `REFRESH_TOKEN_EXPIRE_SECONDS`.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: docker on linux\r\n* Operating System: CentOS v8\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSet the expiry times low from AWX GUI > Settings > System\r\nConfirm the settings from api\r\n```\r\nhttps://x.x.x.x/api/v2/settings/all/\r\n```\r\n```\r\n\"OAUTH2_PROVIDER\": {\r\n        \"ACCESS_TOKEN_EXPIRE_SECONDS\": 10,\r\n        \"REFRESH_TOKEN_EXPIRE_SECONDS\": 10,\r\n        \"AUTHORIZATION_CODE_EXPIRE_SECONDS\": 600\r\n    },\r\n```\r\nCreate an Application from the GUI of Authorization Grant Type `Resource owner password-based`.  Save a copy of the `clientId` and `clientSecret`.\r\n\r\nCreate the access and refresh tokens using password grant:\r\n```bash\r\ncurl -v -k -X POST -d \\\r\n\"grant_type=password&username=someuser&password=somepassword&scope=read\" \\\r\n-u \"clientId:clientSecret\" https://x.x.x.x/api/o/token/ -i\r\n```\r\nWhich returns\r\n```json\r\n{\"access_token\": \"Ma5cLFKYs1Q8iknITJjAe0VXJyiUVP\", \"expires_in\": 10, \"token_type\": \"Bearer\",\r\n \"scope\": \"read\", \"refresh_token\": \"IymTfQp0JtT3HtDUitoAj7eaxXr3zM\"}\r\n```\r\nWait at least 20 seconds and try use refresh token\r\n```\r\ncurl -k -X POST -d \\\r\n\"grant_type=refresh_token&refresh_token=IymTfQp0JtT3HtDUitoAj7eaxXr3zM\" \\\r\n-u \"clientId:clientSecret\" https://x.x.x.x/api/o/token/ -i\r\n```\r\nThat previous refresh token continues to generate new `access_token` and new `refresh_token` after 20 seconds.  Even after I waited 12 hours it still worked.\r\n\r\nI also tried manually adding the settings to `/etc/tower/settings.py` of the docker container.\r\n```\r\nOAUTH2_PROVIDER = {'ACCESS_TOKEN_EXPIRE_SECONDS': 10,\r\n                    'REFRESH_TOKEN_EXPIRE_SECONDS': 10,\r\n                   'AUTHORIZATION_CODE_EXPIRE_SECONDS': 600}\r\n```\r\nand restarting the container.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe refresh token should have failed to generate a new access token and returned an error message after more than 10 + 10 seconds.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe last refresh token still generates a new `access_token` and new `refresh_token` after 20 seconds.  I waited 12 hours and the last generated refresh token still works.  So it appears to ignore the refresh token expiry time.\r\n\r\n#### ADDITIONAL INFO\r\nShould the refresh token stay the same each time it is used?  Current behavior is that a new refresh token is generated each time it is used. The previous one no longer works.  So the way it works currently, refresh tokens are one-time use only.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWe're setting up webhooks into AWS from Github. We currently proxy webhooks into our org - we send the webhooks to a Lambda function in AWS, then \"re-send\" them after validation to our CI/CD tools (over a VPN) - our CI/CD tools are not internet-accessible.\r\n\r\nWe use Jenkins heavily - Jenkins allows us to have a single webhook URL for our instance, and because the webhook metadata contains the info about what Github repo is sending the request, and so does the Jenkins job, Jenkins itself can match the inbound webhook to the correct job.\r\n\r\nIt would be super nice with AWX if there was a similar concept - one webhook URL for the entire instance, and AWX figured out which job(s) to call based on the JSON data (which repo + branch triggered the webhook).\r\n\r\nSimilarly - I'd love if we could log a single webhook secret for all webhook integrations.\r\n\r\nI do have this working and functional now with the current functionality - this would just make integrations like this much easier.\r\n\r\nThanks for all the work on AWX. Cheers.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nsee: https://github.com/ansible/awx/issues/6517#issuecomment-609637267\r\n\r\n> You're reading this because you're looking for info on legacy custom integrations - an outdated way for teams to integrate with Slack. These integrations lack newer features and they will be deprecated and possibly removed in the future. We do not recommend their use.\r\nLegacy token generator\r\nThis tool will not allow creation of new tokens beginning May 5th, 2020. Learn more about why you shouldn't use it anymore.\r\n\r\nIt _sounds like_ AWX's **current** Slack implementation is based on these legacy tokens, and it's been suggested by AWX users that the new Slack Apps don't work with AWX's current integration.\r\n\r\nWe'll likely need to support both."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIf I create a new project or used an existing project (I deleted all of them :grimacing:) I got an error message and I can't do anything.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: docker\r\n* Ansible version: 2.9.5\r\n* Operating System: Ubuntu 18.04.4\r\n* Web Browser: Firefox, Chromium\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Added credentials\r\n2. Setup an new project (select name, scm type(git), scm url, scm credentials)\r\n2.1. Clicked Save\r\n2.2. In-windows popup message notified: \r\n```\r\nERROR!\r\nFailed to create new project. POST returned status: 500 A server error has occurred.\r\n```\r\n3. Job to update project starts automatically\r\n3.1. Update job failed, without any message, only with the following explanation:\r\n```\r\nTask was marked as running in Tower but was not present in the job queue, so it has been marked as failed. \r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSCM update works, without any interrupts.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nI can't update or create a new project.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n* awx-web log:\r\n```\r\n2020-04-06 17:34:25,271 WARNING  awx.main.analytics.broadcast_websocket ('Unsupported URI scheme', 'amqp')\r\n2020-04-06 17:34:25,423 ERROR    django.request Internal Server Error: /api/v2/projects/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/base.py\", line 115, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/base.py\", line 113, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n    return func(*args, **kwds)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/transaction.py\", line 284, in __exit__\r\n    connection.set_autocommit(True)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 410, in set_autocommit\r\n    self.run_and_clear_commit_hooks()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 636, in run_and_clear_commit_hooks\r\n    func()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/unified_jobs.py\", line 1255, in <lambda>\r\n    connection.on_commit(lambda: self._websocket_emit_status(status))\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/unified_jobs.py\", line 1245, in _websocket_emit_status\r\n    emit_channel_notification('jobs-status_changed', status_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/consumers.py\", line 248, in emit_channel_notification\r\n    channel_layer = get_channel_layer()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/channels/layers.py\", line 363, in get_channel_layer\r\n    return channel_layers[alias]\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/channels/layers.py\", line 80, in __getitem__\r\n    self.backends[key] = self.make_backend(key)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/channels/layers.py\", line 46, in make_backend\r\n    return self._make_backend(name, config)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/channels/layers.py\", line 63, in _make_backend\r\n    % name\r\nchannels.exceptions.InvalidChannelLayerError: ROUTING key found for default - this is no longer needed in Channels 2.\r\n2020-04-06 17:34:25,423 ERROR    django.request Internal Server Error: /api/v2/projects/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/base.py\", line 115, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/handlers/base.py\", line 113, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n    return func(*args, **kwds)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/transaction.py\", line 284, in __exit__\r\n    connection.set_autocommit(True)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 410, in set_autocommit\r\n    self.run_and_clear_commit_hooks()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 636, in run_and_clear_commit_hooks\r\n    func()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/unified_jobs.py\", line 1255, in <lambda>\r\n    connection.on_commit(lambda: self._websocket_emit_status(status))\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/unified_jobs.py\", line 1245, in _websocket_emit_status\r\n    emit_channel_notification('jobs-status_changed', status_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/consumers.py\", line 248, in emit_channel_notification\r\n    channel_layer = get_channel_layer()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/channels/layers.py\", line 363, in get_channel_layer\r\n    return channel_layers[alias]\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/channels/layers.py\", line 80, in __getitem__\r\n    self.backends[key] = self.make_backend(key)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/channels/layers.py\", line 46, in make_backend\r\n    return self._make_backend(name, config)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/channels/layers.py\", line 63, in _make_backend\r\n    % name\r\nchannels.exceptions.InvalidChannelLayerError: ROUTING key found for default - this is no longer needed in Channels 2.\r\n172.18.0.7 - - [06/Apr/2020:17:34:25 +0200] \"POST /api/v2/projects/ HTTP/1.1\" 500 41 \"https://awx.COMPANY.TLD/\" \"Mozilla/5.0 (X11; Linux x86_64; rv:74.0) Gecko/20100101 Firefox/74.0\" \"XXX.XXX.XXX.XXX\"\r\n[pid: 102|app: 0|req: 283/751] 172.18.0.7 () {68 vars in 2832 bytes} [Mon Apr  6 17:34:25 2020] POST /api/v2/projects/ => generated 41 bytes in 411 msecs (HTTP/1.1 500) 5 headers in 185 bytes (1 switches on core 0)\r\n```\r\n\r\nScreenshot: in-windows popup message\r\n![scrn-2020-04-06-17-49-02](https://user-images.githubusercontent.com/36081959/78578961-8a2a1b00-7830-11ea-948c-8d065eab6fe0.png)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen I try to send a notification to Grafana, AWX returns an error.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: Kubernetes 1.18.0\r\n* Ansible version:  2.9.5\r\n* Operating System: macOS Catalina\r\n* Web Browser: Mozilla Firefox 74.0\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Configure Grafana notification\r\n2. Click on \"Test notification\"\r\n\r\n##### EXPECTED RESULTS\r\nNotification sent successfully.\r\n\r\n##### ACTUAL RESULTS\r\nFrom awx_tasks log:\r\n```\r\n2020-04-04 23:37:53,653 DEBUG    awx.main.dispatch task 7bc53b9c-c78c-4f96-91e6-08dd52eb9285 starting awx.main.tasks.send_notifications(*[[8]])\r\n2020-04-04 23:37:53,717 ERROR    awx.main.notifications.grafana_backend Error sending notification grafana: [{\"classification\":\"DeserializationError\",\"message\":\"json: cannot unmarshal string into Go struct field PostAnnotationsCmd.tags of type []string\"}]\r\n2020-04-04 23:37:53,719 ERROR    awx.main.tasks Send Notification Failed Error sending notification grafana: [{\"classification\":\"DeserializationError\",\"message\":\"json: cannot unmarshal string into Go struct field PostAnnotationsCmd.tags of type []string\"}]\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 330, in send_notifications\r\n    sent = notification.notification_template.send(notification.subject, notification.body)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/notifications.py\", line 196, in send\r\n    return backend_obj.send_messages([notification_obj])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/notifications/grafana_backend.py\", line 103, in send_messages\r\n    raise Exception(smart_text(_(\"Error sending notification grafana: {}\").format(r.text)))\r\nException: Error sending notification grafana: [{\"classification\":\"DeserializationError\",\"message\":\"json: cannot unmarshal string into Go struct field PostAnnotationsCmd.tags of type []string\"}]\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nBoth AWX and Grafana are deployed in the same Kubernetes cluster."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nCan not supply my own value for `identifier` on workflow job template node creation. I *can* PATCH to change the identifer.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n* Create a workflow job template node w/ `identifier` value `this_does_not_work`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* The return created object to have an `identifier` value of `this_does_not_work`\r\n\r\n##### ACTUAL RESULTS\r\n\r\n* `identifier` has a generated UUID value\r\n\r\n##### ADDITIONAL INFORMATION\r\n![workflow_identifier](https://user-images.githubusercontent.com/722880/78377580-c6921880-759d-11ea-8799-e28220b1dc0a.gif)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Change username mappings for Azure AD configuration\r\n\r\n##### SUMMARY\r\nAt the moment when configuring Azure AD SSO the username is mapped as NameSurname. It would be nice to be able to change the mapping to a different attribute in Azure AD\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nInitially scale OpenShift AWX cluster to 12 pods without any issue, then try to add one more pods, which started successfully, but AWX GUI stop responding with the following error:\r\n\r\nServer Error\r\nA server error has occurred.\r\n\r\n#### ENVIRONMENT\r\n* AWX version: 10\r\n* AWX install method: openshift\r\n* Ansible version:  2.9.5\r\n* Operating System:\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nStart 12 pods in openshift then try to add additional pods\r\nReducing number of pods to 12 restored GUI and normal operations\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\nCluster stop responding \r\n\r\n##### ADDITIONAL INFORMATION\r\nWEB log:\r\n2020-04-02 14:59:55,405 WARNING  awx.main.wsbroadcast awx-0 going to add {'awx-11'} to the websocket broadcast list\r\n2020-04-02 14:59:55,406 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 0 to awx-11\r\n2020-04-02 14:59:55,420 WARNING  awx.main.wsbroadcast Failed to connect to awx-11: 'Cannot connect to host awx-11:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 14:59:55,421 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 1 to awx-11\r\n2020-04-02 14:59:57,861 INFO     awx.main.consumers Broadcast client connected.\r\n2020-04-02 14:59:57,861 INFO     Broadcast client connected.\r\n2020-04-02 15:00:00,444 WARNING  awx.main.wsbroadcast Failed to connect to awx-11: 'Cannot connect to host awx-11:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:00:00,445 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 2 to awx-11\r\nRESULT 2\r\nOKREADY\r\n2020-04-02 15:00:05,414 WARNING  awx.main.wsbroadcast awx-0 going to remove {'awx-11'} from the websocket broadcast list\r\n2020-04-02 15:00:05,414 WARNING  awx.main.wsbroadcast awx-0 going to add {'172.20.218.191'} to the websocket broadcast list\r\n2020-04-02 15:00:05,415 WARNING  awx.main.wsbroadcast awx-0 connection to awx-11 cancelled\r\n2020-04-02 15:00:05,415 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 0 to 172.20.218.191\r\nRESULT 2\r\nOKREADY\r\nRESULT 2\r\nOKREADY\r\n2020-04-02 15:02:05,512 WARNING  awx.main.wsbroadcast awx-0 going to add {'awx-12'} to the websocket broadcast list\r\n2020-04-02 15:02:05,513 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 0 to awx-12\r\n2020-04-02 15:02:05,526 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:05,527 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 1 to awx-12\r\n2020-04-02 15:02:09,724 INFO     awx.main.consumers Broadcast client connected.\r\n2020-04-02 15:02:09,724 INFO     Broadcast client connected.\r\n2020-04-02 15:02:10,539 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:10,540 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 2 to awx-12\r\n2020-04-02 15:02:15,555 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:15,556 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 3 to awx-12\r\n2020-04-02 15:02:20,571 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:20,572 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 4 to awx-12\r\n2020-04-02 15:02:25,593 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:25,594 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 5 to awx-12\r\n2020-04-02 15:02:30,658 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:30,659 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 6 to awx-12\r\n2020-04-02 15:02:35,704 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:35,706 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 7 to awx-12\r\n2020-04-02 15:02:40,722 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:40,722 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 8 to awx-12\r\n2020-04-02 15:02:45,771 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:45,771 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 9 to awx-12\r\n2020-04-02 15:02:50,782 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:50,783 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 10 to awx-12\r\n2020-04-02 15:02:55,800 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:02:55,800 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 11 to awx-12\r\n2020-04-02 15:03:00,825 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\nRESULT 2\r\nOKREADY\r\n2020-04-02 15:03:00,826 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 12 to awx-12\r\n2020-04-02 15:03:05,839 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:03:05,914 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 13 to awx-12\r\n2020-04-02 15:03:10,927 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:03:10,928 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 14 to awx-12\r\n2020-04-02 15:03:15,941 WARNING  awx.main.wsbroadcast Failed to connect to awx-12: 'Cannot connect to host awx-12:8052 ssl:False [Name or service not known]'. Reconnecting ...\r\n2020-04-02 15:03:15,942 DEBUG    awx.main.wsbroadcast awx-0 connect attempt 15 to awx-12\r\n\r\nTASK log:\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 217, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 195, in connect\r\n    self.connection = self.get_new_connection(conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/postgresql/base.py\", line 178, in get_new_connection\r\n    connection = Database.connect(**conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/psycopg2/__init__.py\", line 126, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\npsycopg2.OperationalError: FATAL:  remaining connection slots are reserved for non-replication superuser connections\r\n\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/conf/settings.py\", line 76, in _ctit_db_wrapper\r\n    yield\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/conf/settings.py\", line 404, in __getattr__\r\n    value = self._get_local(name)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/conf/settings.py\", line 347, in _get_local\r\n    setting = Setting.objects.filter(key=name, user__isnull=True).order_by('pk').first()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 653, in first\r\n    for obj in (self if self.ordered else self.order_by('pk'))[:1]:\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 274, in __iter__\r\n    self._fetch_all()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 1242, in _fetch_all\r\n    self._result_cache = list(self._iterable_class(self))\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 55, in __iter__\r\n    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/sql/compiler.py\", line 1138, in execute_sql\r\n    cursor = self.connection.cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 256, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 233, in _cursor\r\n    self.ensure_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 217, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/utils.py\", line 89, in __exit__\r\n    raise dj_exc_value.with_traceback(traceback) from exc_value\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 217, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 195, in connect\r\n    self.connection = self.get_new_connection(conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/postgresql/base.py\", line 178, in get_new_connection\r\n    connection = Database.connect(**conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/psycopg2/__init__.py\", line 126, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\ndjango.db.utils.OperationalError: FATAL:  remaining connection slots are reserved for non-replication superuser connections\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nWhen using AWX 10.0.0 to call the Ansible template module AWX 10.0.0 produces different results than AWX 8.0.0. This is when using the same virtual environment. When using the template module against a output file that already exists AWX 10.0.0 will report the output file has changed, when doing this against AWX 8.0.0 the file isn't changed. \r\n\r\nIt seems that AWX 10.0.0 calls the template module with different module_args than AWX 8.0.0 even though it's using the same virtual environment and Ansible version.\r\n\r\nThis can't be replicated in AWX 10.0.0 when running the playbook manually within the container via command line.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: openshift\r\n* Ansible version:  2.4.3.0\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHave a git repo where there are already existing output files from the template module.\r\n\r\nSetup AWX 8.0.0 with a virtualenv and point to it to a playbook that performs a template function that already produced the output files from above. There will be no changes.\r\n\r\nSetup AWX 10.0.0 with the same virtualenv and point to it to a playbook that performs a template function that already produced the output files from above. There will be changes.\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo changes detected\r\n\r\n##### ACTUAL RESULTS\r\n\r\nChanges detected\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWhen checking the invocation for the template module the module_args are different although we're using the same virtualenv which has the same Ansible version. I wouldn't expect these to change.\r\nThe diff is also different too, file names have changed too. \r\n\r\nAWX8.0.0\r\n\r\n```\r\n{\r\n    \"_ansible_parsed\": true,\r\n    \"group\": \"root\",\r\n    \"uid\": 1000,\r\n    \"checksum\": \"f4ec7c23594121a180c1feaa2b669b2a7fcbfe60\",\r\n    \"changed\": false,\r\n    \"state\": \"file\",\r\n    \"gid\": 0,\r\n    \"mode\": \"0644\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"directory_mode\": null,\r\n            \"force\": false,\r\n            \"remote_src\": null,\r\n            \"path\": \"output/SITE/myconfig.cfg\",\r\n            \"owner\": null,\r\n            \"follow\": false,\r\n            \"group\": null,\r\n            \"unsafe_writes\": null,\r\n            \"state\": \"file\",\r\n            \"content\": null,\r\n            \"serole\": null,\r\n            \"diff_peek\": null,\r\n            \"setype\": null,\r\n            \"dest\": \"output/SITE/myconfig.cfg\",\r\n            \"selevel\": null,\r\n            \"original_basename\": \"myjinja.j2\",\r\n            \"regexp\": null,\r\n            \"validate\": null,\r\n            \"src\": \"myjinja.j2\",\r\n            \"seuser\": null,\r\n            \"recurse\": false,\r\n            \"delimiter\": null,\r\n            \"mode\": null,\r\n            \"attributes\": null,\r\n            \"backup\": null\r\n        }\r\n    },\r\n    \"owner\": \"awx\",\r\n    \"diff\": {\r\n        \"after\": {\r\n            \"path\": \"output/SITE/myconfig.cfg\"\r\n        },\r\n        \"before\": {\r\n            \"path\": \"output/SITE/myconfig.cfg\"\r\n        }\r\n    },\r\n    \"path\": \"output/SITE/myconfig.cfg\",\r\n    \"size\": 45817,\r\n    \"_ansible_no_log\": false\r\n}\r\n```\r\n\r\nAWX 10.0.0\r\n\r\n```\r\n{\r\n    \"_ansible_parsed\": true,\r\n    \"src\": \"/var/lib/awx/.ansible/tmp/ansible-tmp-1585821354.32-194655161154611/source\",\r\n    \"md5sum\": \"6713681ba2a89120b255d81db6921d31\",\r\n    \"group\": \"root\",\r\n    \"uid\": 1000,\r\n    \"dest\": \"output/SITE/myconfig.cfg\",\r\n    \"checksum\": \"9c080b0fc34238dd8388296db38c7bc2633df1c2\",\r\n    \"changed\": true,\r\n    \"owner\": \"awx\",\r\n    \"state\": \"file\",\r\n    \"gid\": 0,\r\n    \"mode\": \"0644\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"directory_mode\": null,\r\n            \"force\": true,\r\n            \"remote_src\": null,\r\n            \"owner\": null,\r\n            \"follow\": false,\r\n            \"local_follow\": null,\r\n            \"group\": null,\r\n            \"unsafe_writes\": null,\r\n            \"setype\": null,\r\n            \"content\": null,\r\n            \"serole\": null,\r\n            \"dest\": \"output/SITE/myconfig.cfg\",\r\n            \"selevel\": null,\r\n            \"original_basename\": \"myjinja.j2\",\r\n            \"regexp\": null,\r\n            \"validate\": null,\r\n            \"src\": \"/var/lib/awx/.ansible/tmp/ansible-tmp-1585821354.32-194655161154611/source\",\r\n            \"seuser\": null,\r\n            \"delimiter\": null,\r\n            \"mode\": null,\r\n            \"attributes\": null,\r\n            \"backup\": false\r\n        }\r\n    },\r\n    \"diff\": [\r\n        {\r\n            \"after\": \"a lot of output\",\r\n            \"after_header\": \"/tmp/tmpLSJWJr/myjinja.j2\",\r\n            \"before_header\": \"output/SITE/myconfig.cfg\",\r\n            \"before\": \"a lot of output but with some extra whitespace\"\r\n        }\r\n    ],\r\n    \"size\": 45817,\r\n    \"_ansible_no_log\": false\r\n}\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nWhen performing a project update on an existing project it's not pulling the latest commit. \r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: openshift\r\n* Ansible version:  NA\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a new project to point to a Git branch, take note of the revision and the commit in your branch from git. Push a new commit to the branch and take note of the commit and then perform a project update in AWX. You'll see the revision in AWX doesn't reflect the latest commit in the branch. This happens with all variants of SCM Update options (clean/delete/update rev)\r\n\r\nIf you create a new project with a different name only then does it pull the latest commit.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAWX updates the project to the latest commit\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAWX doesn't update the project to the latest commit. It's stuck with the commit from the first time the project is setup.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen checking the job output you can see that the job is sometimes missing lines\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: openshift\r\n* Ansible version:  Any (2.4.3.0, 2.7.6, 2.9.0)\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a job a few times and check output\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAble to see all the lines\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSometimes lines don't appear;\r\n\r\n![image](https://user-images.githubusercontent.com/35037942/78239375-8a938080-74d5-11ea-952f-5c5c0b3caab1.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature request\r\n\r\n##### SUMMARY\r\nAdd support for webhooks from [Gogs](https://gogs.io/).  \r\n[Gogs webhooks](https://gogs.io/docs/features/webhook) are quite similar to github ones, except the  signature use hmac-sha256.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nSlack integration fails with invalid_auth for notifications.\r\n\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.5\r\n* Operating System: Ubuntu 18.04.4\r\n* Web Browser: Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSlack credentials created by adding new configuration to the \"Incoming WebHooks\" Slack App. Verified that these work by posting to channel with Curl.\r\n\r\nCreate a new notification of type Slack. Add token (xxx/xxxxx/xxxxxxx format) and destination channel. Save and click on test bell.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nMessage posted to the Slack channel specified.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError message in GUI:\r\n> Slack notifications: Norification failed.\r\n> Slack Notification unable to send drift: Tower Notification Test 2 https://someserver.somedomain.com (invalid_auth)\r\n\r\n##### ADDITIONAL INFORMATION\r\nLog output below.\r\n```\r\n2020-04-01 09:21:36,106 DEBUG    awx.main.notifications.slack_backend {'ok': False, 'error': 'invalid_auth', 'headers': {'Content-Type': 'application/json; charset=utf-8', 'Content-Length': '55', 'Connection': 'keep-alive', 'Date': 'Wed, 01 Apr 2020 09:21:36 GMT', 'Server': 'Apache', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'Access-Control-Allow-Headers': 'slack-route, x-slack-version-ts, x-b3-traceid, x-b3-spanid, x-b3-parentspanid, x-b3-sampled, x-b3-flags', 'Referrer-Policy': 'no-referrer', 'X-Slack-Backend': 'h', 'Access-Control-Expose-Headers': 'x-slack-req-id, retry-after', 'Vary': 'Accept-Encoding', 'X-Content-Type-Options': 'nosniff', 'X-Slack-Req-Id': 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX', 'X-XSS-Protection': '0', 'Content-Encoding': 'gzip', 'Access-Control-Allow-Origin': '*', 'X-Via': 'haproxy-www-cy4d', 'X-Cache': 'Miss from cloudfront', 'Via': '1.1 bcd5dadccb0831729969c938747ff79a.cloudfront.net (CloudFront)', 'X-Amz-Cf-Pop': 'OSL50-C1', 'X-Amz-Cf-Id': 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'}}\r\n2020-04-01 09:21:36,107 ERROR    awx.main.notifications.slack_backend Exception sending messages: Slack Notification unable to send drift: Tower Notification Test 2 https://someserver.somedomain.com (invalid_auth)\r\n2020-04-01 09:21:36,109 ERROR    awx.main.tasks Send Notification Failed Slack Notification unable to send drift: Tower Notification Test 2 https://someserver.somedomain.com (invalid_auth)\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 324, in send_notifications\r\n    sent = notification.notification_template.send(notification.subject, notification.body)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/notifications.py\", line 196, in send\r\n    return backend_obj.send_messages([notification_obj])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/notifications/slack_backend.py\", line 56, in send_messages\r\n    raise RuntimeError(\"Slack Notification unable to send {}: {} ({})\".format(r, m.subject, ret['error']))\r\nRuntimeError: Slack Notification unable to send drift: Tower Notification Test 2 https://someserver.somedomain.com (invalid_auth)\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nCan't create job templates as project admin in AWX 10.0.0\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.6\r\n* Operating System: Ubuntu 18.04 LTS\r\n* Web Browser: Firefox 70\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1. Start AWX 10.0.0\r\n2. Add a new user e.g. `test`\r\n3. Go to the `Demo Project`\r\n4. Add `test` as project admin to the `Demo Project`\r\n5. Login as user `test` and navigate to `Templates`\r\n6. Unable to create new templates. There is no permission.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nAble to create Templates as project admin. Like in AWX 9.3.0 and before\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nButton for creation doesn’t appear. \r\nError from API/URL:\r\n`You do not have permission to add a job template, or there are no projects available.`\r\n\r\n##### ADDITIONAL INFORMATION\r\nOnly able to edit job templates as project admin. Copy function is not available, too.\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI have differents errors on postgres pod after one fresh install\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.9.4\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Firefox / chromium\r\n\r\nHelm postgresql chart: postgresql-8.3.0  (app version 11.6.0)\r\n\r\n##### STEPS TO REPRODUCE\r\nInventory file\r\n```\r\nlocalhost ansible_connection=local ansible_python_interpreter=\"/usr/bin/env python\"\r\n\r\n[all:vars]\r\ndockerhub_base=ansible\r\n# Kubernetes Install\r\nkubernetes_context=awx-prp\r\nkubernetes_namespace=awx-prp\r\nkubernetes_deployment_name=awx-prp\r\nkubernetes_deployment_replica_size=1\r\ntiller_namespace=kube-system\r\n\r\npg_volume_capacity=20\r\n\r\n# Kubernetes Ingress Configuration\r\nkubernetes_ingress_hostname=cloud-awx-z00n-prp.cloud.620nm.net\r\nkubernetes_ingress_annotations={'kubernetes.io/ingress.class': 'nginx'}\r\nkubernetes_ingress_tls_secret=wildcard.cloud.620nm.net\r\n\r\n# Common Docker parameters\r\nawx_task_hostname=awx\r\nawx_web_hostname=awxweb\r\npostgres_data_dir=\"~/.awx/pgdocker\"\r\nhost_port=80\r\nhost_port_ssl=443\r\n#ssl_certificate=\r\ndocker_compose_dir=\"~/.awx/awxcompose\"\r\n\r\n# Set pg_hostname if you have an external postgres server, otherwise\r\n# a new postgres service will be created\r\n# pg_hostname=postgresql\r\npg_username=awx\r\n# pg_password should be random 10 character alphanumeric string, when postgresql is running on kubernetes\r\n# NB: it's a limitation of the \"official\" postgres helm chart\r\npg_password=\"<10 character alphanumeric string >\"\r\npg_database=awx\r\npg_port=5432\r\n#pg_sslmode=require\r\n\r\n# pg_admin_password=postgrespass\r\n\r\n# RabbitMQ Configuration\r\nrabbitmq_password=\"< rabbitmq_password >\"\r\nrabbitmq_erlang_cookie=cookiemonster\r\n\r\n# This will create or update a default admin (superuser) account in AWX, if not provided\r\n# then these default values are used\r\nadmin_user=admin\r\nadmin_password=\"< awx_password >\"\r\n\r\n# Whether or not to create preload data for demonstration purposes\r\ncreate_preload_data=False\r\n\r\n# AWX Secret key\r\n# It's *very* important that this stay the same between upgrades or you will lose the ability to decrypt\r\n# your credentials\r\nsecret_key=awxsecret\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nNo error in postgres pod\r\n\r\n##### ACTUAL RESULTS\r\nOn the first playbook execution, i have a failed at  \"kubernetes : create django super user if it does not exist\" task.\r\n\r\n```\r\nTASK [kubernetes : Check for Tower Super users] *******************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": \"kubectl -n awx-prp exec ansible-tower-management --  bash -c \\\"echo 'from django.contrib.auth.models import User; nsu = User.objects.filter(is_superuser=True).count(); exit(0 if nsu > 0 else 1)' | awx-manage shell\\\"\\n\", \"delta\": \"0:00:02.624181\", \"end\": \"2020-03-31 12:28:16.431460\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2020-03-31 12:28:13.807279\", \"stderr\": \"command terminated with exit code 1\", \"stderr_lines\": [\"command terminated with exit code 1\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n...ignoring\r\n\r\nTASK [kubernetes : create django super user if it does not exist] *************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"censored\": \"the output has been hidden due to the fact that 'no_log: true' was specified for this result\", \"changed\": true}\r\n\r\n```\r\nIf i re lunch the playbook, it's good for ansible, but in postgres  log, i have \r\n```\r\nERROR:  must be owner of database awx\r\nSTATEMENT:  ALTER DATABASE \"awx\" OWNER TO \"awx\"\r\n```\r\n\r\n```\r\nkubectl exec -it awx-prp-postgresql-postgresql-0 -- /bin/bash\r\nI have no name!@awx-prp-postgresql-postgresql-0:/$ \r\nI have no name!@awx-prp-postgresql-postgresql-0:/$ psql --user awx\r\nPassword for user awx: \r\npsql (11.6)\r\nType \"help\" for help.\r\n\r\nawx=> \\l\r\n                                  List of databases\r\n   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   \r\n-----------+----------+----------+-------------+-------------+-----------------------\r\n awx       | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =Tc/postgres         +\r\n           |          |          |             |             | postgres=CTc/postgres+\r\n           |          |          |             |             | awx=CTc/postgres\r\n postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | \r\n template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +\r\n           |          |          |             |             | postgres=CTc/postgres\r\n template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +\r\n           |          |          |             |             | postgres=CTc/postgres\r\n(4 rows)\r\n\r\nawx=> \\du\r\n                                   List of roles\r\n Role name |                         Attributes                         | Member of \r\n-----------+------------------------------------------------------------+-----------\r\n awx       | Create DB                                                  | {}\r\n postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}\r\n\r\nawx=> \r\n\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nansible-playbook install.yml -i ../inventory_os_k8s_prp\r\n<details>\r\n  <summary> playbook logs </summary>\r\n\r\n```\r\nPLAY [Build and deploy AWX] ***************************************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [check_vars : include_tasks] *********************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [check_vars : include_tasks] *********************************************************************************************************************************************************************************\r\nincluded: /home/mrkw3241/work/k8s/awx/installer/roles/check_vars/tasks/check_docker.yml for localhost\r\n\r\nTASK [check_vars : postgres_data_dir should be defined] ***********************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [check_vars : host_port should be defined] *******************************************************************************************************************************************************************\r\nok: [localhost] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [image_build : Set global version if not provided] ***********************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Verify awx-logos directory exists for official install] ***************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Copy logos for inclusion in sdist] ************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Set sdist file name] **************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : AWX Distribution] *****************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stat distribution file] ***********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Clean distribution] ***************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build sdist builder image] ********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build AWX distribution using container] *******************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build AWX distribution locally] ***************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Set docker build base path] *******************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Set awx_web image name] ***********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Set awx_task image name] **********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Ensure directory exists] **********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage sdist] **********************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Template web Dockerfile] **********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Template task Dockerfile] *********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage launch_awx] *****************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage launch_awx_task] ************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage google-cloud-sdk.repo] ******************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage supervisor.conf] ************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage supervisor_task.conf] *******************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage settings.py] ****************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage requirements] ***************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage config watcher] *************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage Makefile] *******************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build base web image] *************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build base task image] ************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Tag task and web images as latest] ************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Clean docker base directory] ******************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Authenticate with Docker registry if registry password given] **********************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Remove web image] ******************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Remove task image] *****************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Tag and push web image to registry] ************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Tag and push task image to registry] ***********************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Set full image path for Registry] **************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : fail] ******************************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : include_tasks] *********************************************************************************************************************************************************************************\r\nskipping: [localhost] => (item=openshift_auth.yml) \r\nskipping: [localhost] => (item=openshift.yml) \r\n\r\nTASK [kubernetes : include_tasks] *********************************************************************************************************************************************************************************\r\nincluded: /home/mrkw3241/work/k8s/awx/installer/roles/kubernetes/tasks/kubernetes_auth.yml for localhost\r\nincluded: /home/mrkw3241/work/k8s/awx/installer/roles/kubernetes/tasks/kubernetes.yml for localhost\r\n\r\nTASK [kubernetes : Set the Kubernetes Context] ********************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Get Namespace Detail] **************************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Create AWX Kubernetes Project] *****************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Set postgresql service name] *******************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Get Kubernetes API version] ********************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Extract server version from command output] ****************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Use kubectl or oc] *****************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : set_fact] **************************************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Record deployment size] ************************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": \"kubectl get sts  awx-prp  -n awx-prp -o=jsonpath='{.status.replicas}'\\n\", \"delta\": \"0:00:00.453192\", \"end\": \"2020-03-31 12:25:54.961335\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2020-03-31 12:25:54.508143\", \"stderr\": \"Error from server (NotFound): statefulsets.apps \\\"awx-prp\\\" not found\", \"stderr_lines\": [\"Error from server (NotFound): statefulsets.apps \\\"awx-prp\\\" not found\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n...ignoring\r\n\r\nTASK [kubernetes : Set expected post-deployment Replicas value] ***************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Delete existing Deployment] ********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Get Postgres Service Detail] *******************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": \"kubectl describe svc awx-prp-postgresql -n awx-prp\", \"delta\": \"0:00:00.367317\", \"end\": \"2020-03-31 12:25:55.641523\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2020-03-31 12:25:55.274206\", \"stderr\": \"Error from server (NotFound): services \\\"awx-prp-postgresql\\\" not found\", \"stderr_lines\": [\"Error from server (NotFound): services \\\"awx-prp-postgresql\\\" not found\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n...ignoring\r\n\r\nTASK [kubernetes : Template PostgreSQL Deployment (OpenShift)] ****************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Deploy and Activate Postgres (OpenShift)] ******************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Create Temporary Values File (Kubernetes)] *****************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Populate Temporary Values File (Kubernetes)] ***************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Deploy and Activate Postgres (Kubernetes)] *****************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Remove tempfile] *******************************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Set postgresql hostname to helm package service (Kubernetes)] **********************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Wait for Postgres to activate] *****************************************************************************************************************************************************************\r\nPausing for 60 seconds\r\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Check if Postgres 9.6 is being used] ***********************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Set new pg image] ******************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Wait for change to take affect] ****************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Set env var for pg upgrade] ********************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Wait for change to take affect] ****************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Set env var for new pg version] ****************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Wait for Postgres to redeploy] *****************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Wait for Postgres to finish upgrading] *********************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Unset upgrade env var] *************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Wait for Postgres to redeploy] *****************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Set task image name] ***************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Set web image name] ****************************************************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Generate SSL certificates for RabbitMQ, if needed] *********************************************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Determine StatefulSet api version] *************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Render deployment templates] *******************************************************************************************************************************************************************\r\nok: [localhost] => (item=None)\r\nok: [localhost] => (item=None)\r\nok: [localhost] => (item=None)\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Apply Deployment] ******************************************************************************************************************************************************************************\r\nchanged: [localhost] => (item=None)\r\nchanged: [localhost] => (item=None)\r\nchanged: [localhost] => (item=None)\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Delete any existing management pod] ************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Template management pod] ***********************************************************************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Create management pod] *************************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Wait for management pod to start] **************************************************************************************************************************************************************\r\nFAILED - RETRYING: Wait for management pod to start (60 retries left).\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Migrate database] ******************************************************************************************************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Check for Tower Super users] *******************************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": \"kubectl -n awx-prp exec ansible-tower-management --  bash -c \\\"echo 'from django.contrib.auth.models import User; nsu = User.objects.filter(is_superuser=True).count(); exit(0 if nsu > 0 else 1)' | awx-manage shell\\\"\\n\", \"delta\": \"0:00:02.624181\", \"end\": \"2020-03-31 12:28:16.431460\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2020-03-31 12:28:13.807279\", \"stderr\": \"command terminated with exit code 1\", \"stderr_lines\": [\"command terminated with exit code 1\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n...ignoring\r\n\r\nTASK [kubernetes : create django super user if it does not exist] *************************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"censored\": \"the output has been hidden due to the fact that 'no_log: true' was specified for this result\", \"changed\": true}\r\n\r\nPLAY RECAP ********************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=30   changed=15   unreachable=0    failed=1    skipped=57   rescued=0    ignored=3   \r\n\r\n```\r\n\r\n</details>\r\n\r\nkubectl logs awx-prp-postgresql-postgresql-0\r\n\r\n<details>\r\n  <summary> postgres logs </summary>\r\n\r\n```\r\n+ id\r\ncurrent user id: uid=0(root) gid=0(root) groups=0(root),1001\r\n+ echo current user id: uid=0(root) gid=0(root) groups=0(root),1001\r\n+ mkdir -p /bitnami/postgresql/data\r\n+ chmod 700 /bitnami/postgresql/data\r\n+ find /bitnami/postgresql -mindepth 1 -maxdepth 1 -not -name .snapshot -not -name lost+found\r\n+ xargs chown -R 1001:1001\r\n+ chmod -R 777 /dev/shm\r\npostgresql 10:26:17.28 \r\npostgresql 10:26:17.29 Welcome to the Bitnami postgresql container\r\npostgresql 10:26:17.29 Subscribe to project updates by watching https://github.com/bitnami/bitnami-docker-postgresql\r\npostgresql 10:26:17.29 Submit issues and feature requests at https://github.com/bitnami/bitnami-docker-postgresql/issues\r\npostgresql 10:26:17.29 Send us your feedback at containers@bitnami.com\r\npostgresql 10:26:17.29 \r\npostgresql 10:26:17.31 INFO  ==> ** Starting PostgreSQL setup **\r\npostgresql 10:26:17.36 INFO  ==> Validating settings in POSTGRESQL_* env vars..\r\npostgresql 10:26:17.36 INFO  ==> Loading custom pre-init scripts...\r\npostgresql 10:26:17.36 INFO  ==> Initializing PostgreSQL database...\r\npostgresql 10:26:17.38 INFO  ==> postgresql.conf file not detected. Generating it...\r\npostgresql 10:26:17.39 INFO  ==> pg_hba.conf file not detected. Generating it...\r\npostgresql 10:26:17.39 INFO  ==> Generating local authentication configuration\r\npostgresql 10:26:18.53 INFO  ==> Starting PostgreSQL in background...\r\npostgresql 10:26:18.91 INFO  ==> Creating user awx\r\npostgresql 10:26:18.92 INFO  ==> Grating access to \"awx\" to the database \"awx\"\r\npostgresql 10:26:18.94 INFO  ==> Configuring replication parameters\r\npostgresql 10:26:18.96 INFO  ==> Configuring fsync\r\npostgresql 10:26:18.97 INFO  ==> Loading custom scripts...\r\npostgresql 10:26:18.97 INFO  ==> Enabling remote connections\r\npostgresql 10:26:18.98 INFO  ==> Stopping PostgreSQL...\r\n\r\npostgresql 10:26:19.99 INFO  ==> ** PostgreSQL setup finished! **\r\npostgresql 10:26:20.04 INFO  ==> ** Starting PostgreSQL **\r\n2020-03-31 10:26:20.063 GMT [1] LOG:  listening on IPv4 address \"0.0.0.0\", port 5432\r\n2020-03-31 10:26:20.063 GMT [1] LOG:  listening on IPv6 address \"::\", port 5432\r\n2020-03-31 10:26:20.066 GMT [1] LOG:  listening on Unix socket \"/tmp/.s.PGSQL.5432\"\r\n2020-03-31 10:26:20.080 GMT [213] LOG:  database system was shut down at 2020-03-31 10:26:19 GMT\r\n2020-03-31 10:26:20.085 GMT [1] LOG:  database system is ready to accept connections\r\n2020-03-31 10:27:12.953 GMT [268] LOG:  incomplete startup packet\r\n2020-03-31 10:27:14.254 GMT [269] LOG:  incomplete startup packet\r\n2020-03-31 10:27:25.429 GMT [283] ERROR:  relation \"conf_setting\" does not exist at character 158\r\n2020-03-31 10:27:25.429 GMT [283] STATEMENT:  SELECT \"conf_setting\".\"id\", \"conf_setting\".\"created\", \"conf_setting\".\"modified\", \"conf_setting\".\"key\", \"conf_setting\".\"value\", \"conf_setting\".\"user_id\" FROM \"conf_setting\" WHERE (\"conf_setting\".\"key\" IN ('ACTIVITY_STREAM_ENABLED', 'ACTIVITY_STREAM_ENABLED_FOR_INVENTORY_SYNC', 'ORG_ADMINS_CAN_SEE_ALL_USERS', 'MANAGE_ORGANIZATION_AUTH', 'TOWER_URL_BASE', 'PROXY_IP_WHITELIST', 'LICENSE', 'REDHAT_USERNAME', 'REDHAT_PASSWORD', 'INSTALL_UUID', 'CUSTOM_VENV_PATHS', 'AD_HOC_COMMANDS', 'ALLOW_JINJA_IN_EXTRA_VARS', 'AWX_PROOT_ENABLED', 'AWX_PROOT_BASE_PATH', 'AWX_PROOT_HIDE_PATHS', 'AWX_PROOT_SHOW_PATHS', 'AWX_ISOLATED_VERBOSITY', 'AWX_ISOLATED_CHECK_INTERVAL', 'AWX_ISOLATED_LAUNCH_TIMEOUT', 'AWX_ISOLATED_CONNECTION_TIMEOUT', 'AWX_ISOLATED_HOST_KEY_CHECKING', 'AWX_ISOLATED_KEY_GENERATION', 'AWX_ISOLATED_PRIVATE_KEY', 'AWX_ISOLATED_PUBLIC_KEY', 'AWX_RESOURCE_PROFILING_ENABLED', 'AWX_RESOURCE_PROFILING_CPU_POLL_INTERVAL', 'AWX_RESOURCE_PROFILING_MEMORY_POLL_INTERVAL', 'AWX_RESOURCE_PROFILING_PID_POLL_INTERVAL', 'AWX_TASK_ENV', 'INSIGHTS_TRACKING_STATE', 'PROJECT_UPDATE_VVV', 'AWX_ROLES_ENABLED', 'AWX_COLLECTIONS_ENABLED', 'PRIMARY_GALAXY_URL', 'PRIMARY_GALAXY_USERNAME', 'PRIMARY_GALAXY_PASSWORD', 'PRIMARY_GALAXY_TOKEN', 'PRIMARY_GALAXY_AUTH_URL', 'PUBLIC_GALAXY_ENABLED', 'GALAXY_IGNORE_CERTS', 'STDOUT_MAX_BYTES_DISPLAY', 'EVENT_STDOUT_MAX_BYTES_DISPLAY', 'SCHEDULE_MAX_JOBS', 'AWX_ANSIBLE_CALLBACK_PLUGINS', 'DEFAULT_JOB_TIMEOUT', 'DEFAULT_INVENTORY_UPDATE_TIMEOUT', 'DEFAULT_PROJECT_UPDATE_TIMEOUT', 'ANSIBLE_FACT_CACHE_TIMEOUT', 'MAX_FORKS', 'LOG_AGGREGATOR_HOST', 'LOG_AGGREGATOR_PORT', 'LOG_AGGREGATOR_TYPE', 'LOG_AGGREGATOR_USERNAME', 'LOG_AGGREGATOR_PASSWORD', 'LOG_AGGREGATOR_LOGGERS', 'LOG_AGGREGATOR_INDIVIDUAL_FACTS', 'LOG_AGGREGATOR_ENABLED', 'LOG_AGGREGATOR_TOWER_UUID', 'LOG_AGGREGATOR_PROTOCOL', 'LOG_AGGREGATOR_TCP_TIMEOUT', 'LOG_AGGREGATOR_VERIFY_CERT', 'LOG_AGGREGATOR_LEVEL', 'LOG_AGGREGATOR_AUDIT', 'BROKER_DURABILITY', 'AUTOMATION_ANALYTICS_LAST_GATHER', 'AUTOMATION_ANALYTICS_GATHER_INTERVAL', 'SESSION_COOKIE_AGE', 'SESSIONS_PER_USER', 'AUTH_BASIC_ENABLED', 'OAUTH2_PROVIDER', 'ALLOW_OAUTH2_FOR_EXTERNAL_USERS', 'LOGIN_REDIRECT_OVERRIDE', 'PENDO_TRACKING_STATE', 'CUSTOM_LOGIN_INFO', 'CUSTOM_LOGO', 'MAX_UI_JOB_EVENTS', 'UI_LIVE_UPDATES_ENABLED', 'SOCIAL_AUTH_ORGANIZATION_MAP', 'SOCIAL_AUTH_TEAM_MAP', 'SOCIAL_AUTH_USER_FIELDS', 'AUTH_LDAP_SERVER_URI', 'AUTH_LDAP_BIND_DN', 'AUTH_LDAP_BIND_PASSWORD', 'AUTH_LDAP_START_TLS', 'AUTH_LDAP_CONNECTION_OPTIONS', 'AUTH_LDAP_USER_SEARCH', 'AUTH_LDAP_USER_DN_TEMPLATE', 'AUTH_LDAP_USER_ATTR_MAP', 'AUTH_LDAP_GROUP_SEARCH', 'AUTH_LDAP_GROUP_TYPE', 'AUTH_LDAP_GROUP_TYPE_PARAMS', 'AUTH_LDAP_REQUIRE_GROUP', 'AUTH_LDAP_DENY_GROUP', 'AUTH_LDAP_USER_FLAGS_BY_GROUP', 'AUTH_LDAP_ORGANIZATION_MAP', 'AUTH_LDAP_TEAM_MAP', 'AUTH_LDAP_1_SERVER_URI', 'AUTH_LDAP_1_BIND_DN', 'AUTH_LDAP_1_BIND_PASSWORD', 'AUTH_LDAP_1_START_TLS', 'AUTH_LDAP_1_CONNECTION_OPTIONS', 'AUTH_LDAP_1_USER_SEARCH', 'AUTH_LDAP_1_USER_DN_TEMPLATE', 'AUTH_LDAP_1_USER_ATTR_MAP', 'AUTH_LDAP_1_GROUP_SEARCH', 'AUTH_LDAP_1_GROUP_TYPE', 'AUTH_LDAP_1_GROUP_TYPE_PARAMS', 'AUTH_LDAP_1_REQUIRE_GROUP', 'AUTH_LDAP_1_DENY_GROUP', 'AUTH_LDAP_1_USER_FLAGS_BY_GROUP', 'AUTH_LDAP_1_ORGANIZATION_MAP', 'AUTH_LDAP_1_TEAM_MAP', 'AUTH_LDAP_2_SERVER_URI', 'AUTH_LDAP_2_BIND_DN', 'AUTH_LDAP_2_BIND_PASSWORD', 'AUTH_LDAP_2_START_TLS', 'AUTH_LDAP_2_CONNECTION_OPTIONS', 'AUTH_LDAP_2_USER_SEARCH', 'AUTH_LDAP_2_USER_DN_TEMPLATE', 'AUTH_LDAP_2_USER_ATTR_MAP', 'AUTH_LDAP_2_GROUP_SEARCH', 'AUTH_LDAP_2_GROUP_TYPE', 'AUTH_LDAP_2_GROUP_TYPE_PARAMS', 'AUTH_LDAP_2_REQUIRE_GROUP', 'AUTH_LDAP_2_DENY_GROUP', 'AUTH_LDAP_2_USER_FLAGS_BY_GROUP', 'AUTH_LDAP_2_ORGANIZATION_MAP', 'AUTH_LDAP_2_TEAM_MAP', 'AUTH_LDAP_3_SERVER_URI', 'AUTH_LDAP_3_BIND_DN', 'AUTH_LDAP_3_BIND_PASSWORD', 'AUTH_LDAP_3_START_TLS', 'AUTH_LDAP_3_CONNECTION_OPTIONS', 'AUTH_LDAP_3_USER_SEARCH', 'AUTH_LDAP_3_USER_DN_TEMPLATE', 'AUTH_LDAP_3_USER_ATTR_MAP', 'AUTH_LDAP_3_GROUP_SEARCH', 'AUTH_LDAP_3_GROUP_TYPE', 'AUTH_LDAP_3_GROUP_TYPE_PARAMS', 'AUTH_LDAP_3_REQUIRE_GROUP', 'AUTH_LDAP_3_DENY_GROUP', 'AUTH_LDAP_3_USER_FLAGS_BY_GROUP', 'AUTH_LDAP_3_ORGANIZATION_MAP', 'AUTH_LDAP_3_TEAM_MAP', 'AUTH_LDAP_4_SERVER_URI', 'AUTH_LDAP_4_BIND_DN', 'AUTH_LDAP_4_BIND_PASSWORD', 'AUTH_LDAP_4_START_TLS', 'AUTH_LDAP_4_CONNECTION_OPTIONS', 'AUTH_LDAP_4_USER_SEARCH', 'AUTH_LDAP_4_USER_DN_TEMPLATE', 'AUTH_LDAP_4_USER_ATTR_MAP', 'AUTH_LDAP_4_GROUP_SEARCH', 'AUTH_LDAP_4_GROUP_TYPE', 'AUTH_LDAP_4_GROUP_TYPE_PARAMS', 'AUTH_LDAP_4_REQUIRE_GROUP', 'AUTH_LDAP_4_DENY_GROUP', 'AUTH_LDAP_4_USER_FLAGS_BY_GROUP', 'AUTH_LDAP_4_ORGANIZATION_MAP', 'AUTH_LDAP_4_TEAM_MAP', 'AUTH_LDAP_5_SERVER_URI', 'AUTH_LDAP_5_BIND_DN', 'AUTH_LDAP_5_BIND_PASSWORD', 'AUTH_LDAP_5_START_TLS', 'AUTH_LDAP_5_CONNECTION_OPTIONS', 'AUTH_LDAP_5_USER_SEARCH', 'AUTH_LDAP_5_USER_DN_TEMPLATE', 'AUTH_LDAP_5_USER_ATTR_MAP', 'AUTH_LDAP_5_GROUP_SEARCH', 'AUTH_LDAP_5_GROUP_TYPE', 'AUTH_LDAP_5_GROUP_TYPE_PARAMS', 'AUTH_LDAP_5_REQUIRE_GROUP', 'AUTH_LDAP_5_DENY_GROUP', 'AUTH_LDAP_5_USER_FLAGS_BY_GROUP', 'AUTH_LDAP_5_ORGANIZATION_MAP', 'AUTH_LDAP_5_TEAM_MAP', 'RADIUS_SERVER', 'RADIUS_PORT', 'RADIUS_SECRET', 'TACACSPLUS_HOST', 'TACACSPLUS_PORT', 'TACACSPLUS_SECRET', 'TACACSPLUS_SESSION_TIMEOUT', 'TACACSPLUS_AUTH_PROTOCOL', 'SOCIAL_AUTH_GOOGLE_OAUTH2_KEY', 'SOCIAL_AUTH_GOOGLE_OAUTH2_SECRET', 'SOCIAL_AUTH_GOOGLE_OAUTH2_WHITELISTED_DOMAINS', 'SOCIAL_AUTH_GOOGLE_OAUTH2_AUTH_EXTRA_ARGUMENTS', 'SOCIAL_AUTH_GOOGLE_OAUTH2_ORGANIZATION_MAP', 'SOCIAL_AUTH_GOOGLE_OAUTH2_TEAM_MAP', 'SOCIAL_AUTH_GITHUB_KEY', 'SOCIAL_AUTH_GITHUB_SECRET', 'SOCIAL_AUTH_GITHUB_ORGANIZATION_MAP', 'SOCIAL_AUTH_GITHUB_TEAM_MAP', 'SOCIAL_AUTH_GITHUB_ORG_KEY', 'SOCIAL_AUTH_GITHUB_ORG_SECRET', 'SOCIAL_AUTH_GITHUB_ORG_NAME', 'SOCIAL_AUTH_GITHUB_ORG_ORGANIZATION_MAP', 'SOCIAL_AUTH_GITHUB_ORG_TEAM_MAP', 'SOCIAL_AUTH_GITHUB_TEAM_KEY', 'SOCIAL_AUTH_GITHUB_TEAM_SECRET', 'SOCIAL_AUTH_GITHUB_TEAM_ID', 'SOCIAL_AUTH_GITHUB_TEAM_ORGANIZATION_MAP', 'SOCIAL_AUTH_GITHUB_TEAM_TEAM_MAP', 'SOCIAL_AUTH_AZUREAD_OAUTH2_KEY', 'SOCIAL_AUTH_AZUREAD_OAUTH2_SECRET', 'SOCIAL_AUTH_AZUREAD_OAUTH2_ORGANIZATION_MAP', 'SOCIAL_AUTH_AZUREAD_OAUTH2_TEAM_MAP', 'SOCIAL_AUTH_SAML_SP_ENTITY_ID', 'SOCIAL_AUTH_SAML_SP_PUBLIC_CERT', 'SOCIAL_AUTH_SAML_SP_PRIVATE_KEY', 'SOCIAL_AUTH_SAML_ORG_INFO', 'SOCIAL_AUTH_SAML_TECHNICAL_CONTACT', 'SOCIAL_AUTH_SAML_SUPPORT_CONTACT', 'SOCIAL_AUTH_SAML_ENABLED_IDPS', 'SOCIAL_AUTH_SAML_SECURITY_CONFIG', 'SOCIAL_AUTH_SAML_SP_EXTRA', 'SOCIAL_AUTH_SAML_EXTRA_DATA', 'SOCIAL_AUTH_SAML_ORGANIZATION_MAP', 'SOCIAL_AUTH_SAML_TEAM_MAP', 'SOCIAL_AUTH_SAML_ORGANIZATION_ATTR', 'SOCIAL_AUTH_SAML_TEAM_ATTR') AND \"conf_setting\".\"user_id\" IS NULL) ORDER BY \"conf_setting\".\"id\" ASC\r\n2020-03-31 10:27:25.647 GMT [283] ERROR:  relation \"django_migrations\" does not exist at character 124\r\n2020-03-31 10:27:25.647 GMT [283] STATEMENT:  SELECT \"django_migrations\".\"id\", \"django_migrations\".\"app\", \"django_migrations\".\"name\", \"django_migrations\".\"applied\" FROM \"django_migrations\" WHERE (\"django_migrations\".\"app\" = 'main' AND \"django_migrations\".\"name\" IN ('0005a_squashed_v310_v313_updates', '0005b_squashed_v310_v313_updates'))\r\n2020-03-31 10:27:25.662 GMT [283] ERROR:  relation \"django_migrations\" does not exist at character 124\r\n2020-03-31 10:27:25.662 GMT [283] STATEMENT:  SELECT \"django_migrations\".\"id\", \"django_migrations\".\"app\", \"django_migrations\".\"name\", \"django_migrations\".\"applied\" FROM \"django_migrations\" WHERE (\"django_migrations\".\"app\" = 'main' AND NOT (\"django_migrations\".\"name\"::text LIKE '%squashed%')) ORDER BY \"django_migrations\".\"id\" DESC  LIMIT 1\r\n2020-03-31 10:27:25.665 GMT [283] ERROR:  relation \"django_migrations\" does not exist at character 124\r\n2020-03-31 10:27:25.665 GMT [283] STATEMENT:  SELECT \"django_migrations\".\"id\", \"django_migrations\".\"app\", \"django_migrations\".\"name\", \"django_migrations\".\"applied\" FROM \"django_migrations\" WHERE (\"django_migrations\".\"app\" = 'main' AND NOT (\"django_migrations\".\"name\"::text LIKE '%squashed%')) ORDER BY \"django_migrations\".\"id\" DESC  LIMIT 1\r\n2020-03-31 10:27:25.676 GMT [283] ERROR:  relation \"django_migrations\" does not exist at character 124\r\n2020-03-31 10:27:25.676 GMT [283] STATEMENT:  SELECT \"django_migrations\".\"id\", \"django_migrations\".\"app\", \"django_migrations\".\"name\", \"django_migrations\".\"applied\" FROM \"django_migrations\" WHERE (\"django_migrations\".\"app\" = 'main' AND NOT (\"django_migrations\".\"name\"::text LIKE '%squashed%')) ORDER BY \"django_migrations\".\"id\" DESC  LIMIT 1\r\n2020-03-31 10:27:25.681 GMT [283] ERROR:  relation \"django_migrations\" does not exist at character 124\r\n2020-03-31 10:27:25.681 GMT [283] STATEMENT:  SELECT \"django_migrations\".\"id\", \"django_migrations\".\"app\", \"django_migrations\".\"name\", \"django_migrations\".\"applied\" FROM \"django_migrations\" WHERE (\"django_migrations\".\"app\" = 'main' AND NOT (\"django_migrations\".\"name\"::text LIKE '%squashed%')) ORDER BY \"django_migrations\".\"id\" DESC  LIMIT 1\r\n2020-03-31 10:27:25.690 GMT [283] ERROR:  relation \"django_migrations\" does not exist at character 124\r\n2020-03-31 10:27:25.690 GMT [283] STATEMENT:  SELECT \"django_migrations\".\"id\", \"django_migrations\".\"app\", \"django_migrations\".\"name\", \"django_migrations\".\"applied\" FROM \"django_migrations\" WHERE (\"django_migrations\".\"app\" = 'main' AND NOT (\"django_migrations\".\"name\"::text LIKE '%squashed%')) ORDER BY \"django_migrations\".\"id\" DESC  LIMIT 1\r\n2020-03-31 10:27:25.692 GMT [283] ERROR:  relation \"django_migrations\" does not exist at character 124\r\n2020-03-31 10:27:25.692 GMT [283] STATEMENT:  SELECT \"django_migrations\".\"id\", \"django_migrations\".\"app\", \"django_migrations\".\"name\", \"django_migrations\".\"applied\" FROM \"django_migrations\" WHERE (\"django_migrations\".\"app\" = 'main' AND NOT (\"django_migrations\".\"name\"::text LIKE '%squashed%')) ORDER BY \"django_migrations\".\"id\" DESC  LIMIT 1\r\n2020-03-31 10:28:19.603 GMT [359] ERROR:  column \"deleted_actor\" of relation \"main_activitystream\" does not exist at character 85\r\n2020-03-31 10:28:19.603 GMT [359] STATEMENT:  INSERT INTO \"main_activitystream\" (\"actor_id\", \"operation\", \"timestamp\", \"changes\", \"deleted_actor\", \"action_node\", \"object_relationship_type\", \"object1\", \"object2\", \"setting\") VALUES (NULL, 'create', '2020-03-31T10:28:19.598577+00:00'::timestamptz, '{\"username\": \"admin\", \"first_name\": \"\", \"last_name\": \"\", \"email\": \"root@localhost\", \"is_superuser\": true, \"password\": \"hidden\", \"id\": 1}', NULL, 'ansible-tower-management', '', 'user', '', '{}') RETURNING \"main_activitystream\".\"id\"\r\n\r\n```\r\n</details>\r\n\r\nkubectl logs awx-prp-0 -f --all-containers\r\n\r\n<details>\r\n  <summary> all containers awx-prp-0 logs </summary>\r\n\r\n\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file\r\n127.0.0.1 | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\r\n    },\r\n    \"changed\": false,\r\n2020-03-31 10:27:21.608 [info] <0.8.0> Feature flags: list of feature flags found:\r\n2020-03-31 10:27:21.608 [info] <0.8.0> Feature flags: feature flag states written to disk: yes\r\n2020-03-31 10:27:21.634 [info] <0.239.0> \r\n    \"elapsed\": 0,\r\n    \"match_groupdict\": {},\r\n    \"match_groups\": [],\r\n    \"path\": null,\r\n    \"port\": 5432,\r\n    \"search_regex\": null,\r\n    \"state\": \"started\"\r\n}\r\nUsing /etc/ansible/ansible.cfg as config file\r\n127.0.0.1 | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\r\n Starting RabbitMQ 3.7.21 on Erlang 22.1.7\r\n Copyright (C) 2007-2019 Pivotal Software, Inc.\r\n Licensed under the MPL.  See https://www.rabbitmq.com/\r\n\r\n  ##  ##\r\n  ##  ##      RabbitMQ 3.7.21. Copyright (C) 2007-2019 Pivotal Software, Inc.\r\n  ##########  Licensed under the MPL.  See https://www.rabbitmq.com/\r\n  ######  ##\r\n  ##########  Logs: <stdout>\r\n\r\n              Starting broker...\r\n2020-03-31 10:27:21.635 [info] <0.239.0> \r\n node           : rabbit@10.233.93.26\r\n home dir       : /var/lib/rabbitmq\r\n config file(s) : /etc/rabbitmq/rabbitmq.conf\r\n cookie hash    : at619UOZzsenF44tSK3ulA==\r\n    },\r\n log(s)         : <stdout>\r\n database dir   : /var/lib/rabbitmq/mnesia/rabbit@10.233.93.26\r\n2020-03-31 10:27:21.650 [info] <0.239.0> Running boot step pre_boot defined by app rabbit\r\n    \"changed\": false,\r\n    \"elapsed\": 1,\r\n    \"match_groupdict\": {},\r\n    \"match_groups\": [],\r\n    \"path\": null,\r\n    \"port\": 11211,\r\n    \"search_regex\": null,\r\n    \"state\": \"started\"\r\n}\r\nUsing /etc/ansible/ansible.cfg as config file\r\nUsing /etc/ansible/ansible.cfg as config file\r\n127.0.0.1 | SUCCESS => {\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\r\n2020-03-31 10:27:21.650 [info] <0.239.0> Running boot step rabbit_core_metrics defined by app rabbit\r\n2020-03-31 10:27:21.650 [info] <0.239.0> Running boot step rabbit_alarm defined by app rabbit\r\n2020-03-31 10:27:21.654 [info] <0.245.0> Memory high watermark set to 6416 MiB (6727725875 bytes) of 16040 MiB (16819314688 bytes) total\r\n2020-03-31 10:27:21.658 [info] <0.247.0> Enabling free disk space monitoring\r\n2020-03-31 10:27:21.658 [info] <0.247.0> Disk free limit set to 50MB\r\n2020-03-31 10:27:21.661 [info] <0.239.0> Running boot step code_server_cache defined by app rabbit\r\n2020-03-31 10:27:21.662 [info] <0.239.0> Running boot step file_handle_cache defined by app rabbit\r\n2020-03-31 10:27:21.662 [info] <0.250.0> Limiting to approx 1048476 file handles (943626 sockets)\r\n2020-03-31 10:27:21.662 [info] <0.251.0> FHC read buffering:  OFF\r\n2020-03-31 10:27:21.663 [info] <0.251.0> FHC write buffering: ON\r\n2020-03-31 10:27:21.663 [info] <0.239.0> Running boot step worker_pool defined by app rabbit\r\n    },\r\n    \"changed\": false,\r\n    \"elapsed\": 0,\r\n    \"match_groupdict\": {},\r\n    \"match_groups\": [],\r\n2020-03-31 10:27:21.663 [info] <0.240.0> Will use 4 processes for default worker pool\r\n2020-03-31 10:27:21.663 [info] <0.240.0> Starting worker pool 'worker_pool' with 4 processes in it\r\n2020-03-31 10:27:21.664 [info] <0.239.0> Running boot step database defined by app rabbit\r\n2020-03-31 10:27:21.664 [info] <0.239.0> Node database directory at /var/lib/rabbitmq/mnesia/rabbit@10.233.93.26 is empty. Assuming we need to join an existing cluster or initialise from scratch...\r\n2020-03-31 10:27:21.664 [info] <0.239.0> Configured peer discovery backend: rabbit_peer_discovery_k8s\r\n2020-03-31 10:27:21.665 [info] <0.239.0> Will try to lock with peer discovery backend rabbit_peer_discovery_k8s\r\n2020-03-31 10:27:21.665 [info] <0.239.0> Peer discovery backend does not support locking, falling back to randomized delay\r\n2020-03-31 10:27:21.665 [info] <0.239.0> Peer discovery backend rabbit_peer_discovery_k8s does not support registration, skipping randomized startup delay.\r\n2020-03-31 10:27:21.686 [info] <0.239.0> k8s endpoint listing returned nodes not yet ready: 10.233.93.26\r\n2020-03-31 10:27:21.686 [info] <0.239.0> All discovered existing cluster peers: \r\n2020-03-31 10:27:21.686 [info] <0.239.0> Discovered no peer nodes to cluster with\r\n2020-03-31 10:27:21.691 [info] <0.43.0> Application mnesia exited with reason: stopped\r\n2020-03-31 10:27:21.743 [info] <0.239.0> Waiting for Mnesia tables for 30000 ms, 9 retries left\r\n2020-03-31 10:27:21.771 [info] <0.239.0> Waiting for Mnesia tables for 30000 ms, 9 retries left\r\n2020-03-31 10:27:21.799 [info] <0.239.0> Waiting for Mnesia tables for 30000 ms, 9 retries left\r\n2020-03-31 10:27:21.799 [info] <0.239.0> Peer discovery backend rabbit_peer_discovery_k8s does not support registration, skipping registration.\r\n2020-03-31 10:27:21.800 [info] <0.239.0> Running boot step database_sync defined by app rabbit\r\n2020-03-31 10:27:21.800 [info] <0.239.0> Running boot step feature_flags defined by app rabbit\r\n2020-03-31 10:27:21.800 [info] <0.239.0> Running boot step codec_correctness_check defined by app rabbit\r\n2020-03-31 10:27:21.800 [info] <0.239.0> Running boot step external_infrastructure defined by app rabbit\r\n2020-03-31 10:27:21.800 [info] <0.239.0> Running boot step rabbit_registry defined by app rabbit\r\n2020-03-31 10:27:21.801 [info] <0.239.0> Running boot step rabbit_auth_mechanism_cr_demo defined by app rabbit\r\n2020-03-31 10:27:21.801 [info] <0.239.0> Running boot step rabbit_queue_location_random defined by app rabbit\r\n2020-03-31 10:27:21.801 [info] <0.239.0> Running boot step rabbit_event defined by app rabbit\r\n2020-03-31 10:27:21.801 [info] <0.239.0> Running boot step rabbit_auth_mechanism_amqplain defined by app rabbit\r\n2020-03-31 10:27:21.802 [info] <0.239.0> Running boot step rabbit_auth_mechanism_plain defined by app rabbit\r\n2020-03-31 10:27:21.802 [info] <0.239.0> Running boot step rabbit_exchange_type_direct defined by app rabbit\r\n2020-03-31 10:27:21.802 [info] <0.239.0> Running boot step rabbit_exchange_type_fanout defined by app rabbit\r\n2020-03-31 10:27:21.802 [info] <0.239.0> Running boot step rabbit_exchange_type_headers defined by app rabbit\r\n2020-03-31 10:27:21.802 [info] <0.239.0> Running boot step rabbit_exchange_type_topic defined by app rabbit\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Running boot step rabbit_mirror_queue_mode_all defined by app rabbit\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Running boot step rabbit_mirror_queue_mode_exactly defined by app rabbit\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Running boot step rabbit_mirror_queue_mode_nodes defined by app rabbit\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Running boot step rabbit_priority_queue defined by app rabbit\r\n    \"path\": null,\r\n    \"port\": 5432,\r\n    \"search_regex\": null,\r\n    \"state\": \"started\"\r\n}\r\nUsing /etc/ansible/ansible.cfg as config file\r\n127.0.0.1 | SUCCESS => {\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Priority queues enabled, real BQ is rabbit_variable_queue\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Running boot step rabbit_queue_location_client_local defined by app rabbit\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Running boot step rabbit_queue_location_min_masters defined by app rabbit\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Running boot step kernel_ready defined by app rabbit\r\n2020-03-31 10:27:21.803 [info] <0.239.0> Running boot step rabbit_sysmon_minder defined by app rabbit\r\n2020-03-31 10:27:21.804 [info] <0.239.0> Running boot step rabbit_epmd_monitor defined by app rabbit\r\n2020-03-31 10:27:21.804 [info] <0.424.0> epmd monitor knows us, inter-node communication (distribution) port: 25672\r\n2020-03-31 10:27:21.805 [info] <0.239.0> Running boot step guid_generator defined by app rabbit\r\n2020-03-31 10:27:21.806 [info] <0.239.0> Running boot step rabbit_node_monitor defined by app rabbit\r\n2020-03-31 10:27:21.806 [info] <0.428.0> Starting rabbit_node_monitor\r\n2020-03-31 10:27:21.807 [info] <0.239.0> Running boot step delegate_sup defined by app rabbit\r\n2020-03-31 10:27:21.807 [info] <0.239.0> Running boot step rabbit_memory_monitor defined by app rabbit\r\n2020-03-31 10:27:21.807 [info] <0.239.0> Running boot step core_initialized defined by app rabbit\r\n2020-03-31 10:27:21.807 [info] <0.239.0> Running boot step upgrade_queues defined by app rabbit\r\n2020-03-31 10:27:21.833 [info] <0.239.0> message_store upgrades: 1 to apply\r\n2020-03-31 10:27:21.833 [info] <0.239.0> message_store upgrades: Applying rabbit_variable_queue:move_messages_to_vhost_store\r\n2020-03-31 10:27:21.833 [info] <0.239.0> message_store upgrades: No durable queues found. Skipping message store migration\r\n2020-03-31 10:27:21.833 [info] <0.239.0> message_store upgrades: Removing the old message store data\r\n2020-03-31 10:27:21.834 [info] <0.239.0> message_store upgrades: All upgrades applied successfully\r\n2020-03-31 10:27:21.866 [info] <0.239.0> Running boot step rabbit_connection_tracking defined by app rabbit\r\n2020-03-31 10:27:21.866 [info] <0.239.0> Running boot step rabbit_connection_tracking_handler defined by app rabbit\r\n2020-03-31 10:27:21.866 [info] <0.239.0> Running boot step rabbit_exchange_parameters defined by app rabbit\r\n2020-03-31 10:27:21.866 [info] <0.239.0> Running boot step rabbit_mirror_queue_misc defined by app rabbit\r\n2020-03-31 10:27:21.867 [info] <0.239.0> Running boot step rabbit_policies defined by app rabbit\r\n    \"ansible_facts\": {\r\n        \"discovered_interpreter_python\": \"/usr/libexec/platform-python\"\r\n    },\r\n    \"changed\": false,\r\n    \"elapsed\": 3,\r\n    \"match_groupdict\": {},\r\n    \"match_groups\": [],\r\n    \"path\": null,\r\n    \"port\": 11211,\r\n2020-03-31 10:27:21.867 [info] <0.239.0> Running boot step rabbit_policy defined by app rabbit\r\n2020-03-31 10:27:21.868 [info] <0.239.0> Running boot step rabbit_queue_location_validator defined by app rabbit\r\n2020-03-31 10:27:21.868 [info] <0.239.0> Running boot step rabbit_vhost_limit defined by app rabbit\r\n2020-03-31 10:27:21.868 [info] <0.239.0> Running boot step rabbit_mgmt_reset_handler defined by app rabbitmq_management\r\n2020-03-31 10:27:21.868 [info] <0.239.0> Running boot step rabbit_mgmt_db_handler defined by app rabbitmq_management_agent\r\n2020-03-31 10:27:21.868 [info] <0.239.0> Management plugin: using rates mode 'basic'\r\n2020-03-31 10:27:21.868 [info] <0.239.0> Running boot step recovery defined by app rabbit\r\n2020-03-31 10:27:21.869 [info] <0.239.0> Running boot step load_definitions defined by app rabbitmq_management\r\n2020-03-31 10:27:21.869 [info] <0.239.0> Applying definitions from /etc/rabbitmq/rabbitmq_definitions.json\r\n2020-03-31 10:27:21.869 [info] <0.239.0> Asked to import definitions. Acting user: rmq-internal\r\n2020-03-31 10:27:21.870 [info] <0.239.0> Importing users...\r\n    \"search_regex\": null,\r\n    \"state\": \"started\"\r\n}\r\nUsing /etc/ansible/ansible.cfg as config file\r\n2020-03-31 10:27:21.870 [info] <0.239.0> Creating user 'awx'\r\n2020-03-31 10:27:21.871 [info] <0.239.0> Setting user tags for user 'awx' to [administrator]\r\n2020-03-31 10:27:21.872 [info] <0.239.0> Importing vhosts...\r\n2020-03-31 10:27:21.872 [info] <0.239.0> Adding vhost 'awx'\r\n2020-03-31 10:27:21.880 [info] <0.471.0> Making sure data directory '/var/lib/rabbitmq/mnesia/rabbit@10.233.93.26/msg_stores/vhosts/5A7PFSQL4N28PQOL0INDFDDLU' for vhost 'awx' exists\r\n2020-03-31 10:27:21.882 [info] <0.471.0> Starting message stores for vhost 'awx'\r\n2020-03-31 10:27:21.883 [info] <0.475.0> Message store \"5A7PFSQL4N28PQOL0INDFDDLU/msg_store_transient\": using rabbit_msg_store_ets_index to provide index\r\n2020-03-31 10:27:21.884 [info] <0.471.0> Started message store of type transient for vhost 'awx'\r\n2020-03-31 10:27:21.884 [info] <0.478.0> Message store \"5A7PFSQL4N28PQOL0INDFDDLU/msg_store_persistent\": using rabbit_msg_store_ets_index to provide index\r\n2020-03-31 10:27:21.884 [warning] <0.478.0> Message store \"5A7PFSQL4N28PQOL0INDFDDLU/msg_store_persistent\": rebuilding indices from scratch\r\n2020-03-31 10:27:21.885 [info] <0.471.0> Started message store of type persistent for vhost 'awx'\r\n2020-03-31 10:27:21.886 [info] <0.239.0> Importing user permissions...\r\n2020-03-31 10:27:21.886 [info] <0.239.0> Setting permissions for 'awx' in 'awx' to '.*', '.*', '.*'\r\n2020-03-31 10:27:21.887 [info] <0.239.0> Importing topic permissions...\r\n2020-03-31 10:27:21.887 [info] <0.239.0> Importing parameters...\r\n2020-03-31 10:27:21.888 [info] <0.239.0> Importing global parameters...\r\n2020-03-31 10:27:21.888 [info] <0.239.0> Importing policies...\r\n2020-03-31 10:27:21.890 [info] <0.239.0> Importing queues...\r\n2020-03-31 10:27:21.890 [info] <0.239.0> Importing exchanges...\r\n2020-03-31 10:27:21.890 [info] <0.239.0> Importing bindings...\r\n2020-03-31 10:27:21.891 [info] <0.239.0> Running boot step empty_db_check defined by app rabbit\r\n2020-03-31 10:27:21.891 [info] <0.239.0> Running boot step rabbit_looking_glass defined by app rabbit\r\n2020-03-31 10:27:21.891 [info] <0.239.0> Running boot step rabbit_core_metrics_gc defined by app rabbit\r\n2020-03-31 10:27:21.891 [info] <0.239.0> Running boot step background_gc defined by app rabbit\r\n2020-03-31 10:27:21.891 [info] <0.239.0> Running boot step connection_tracking defined by app rabbit\r\n2020-03-31 10:27:21.893 [info] <0.239.0> Setting up a table for connection tracking on this node: 'tracked_connection_on_node_rabbit@10.233.93.26'\r\n2020-03-31 10:27:21.895 [info] <0.239.0> Setting up a table for per-vhost connection counting on this node: 'tracked_connection_per_vhost_on_node_rabbit@10.233.93.26'\r\n2020-03-31 10:27:21.896 [info] <0.239.0> Running boot step routing_ready defined by app rabbit\r\n2020-03-31 10:27:21.896 [info] <0.239.0> Running boot step pre_flight defined by app rabbit\r\n2020-03-31 10:27:21.896 [info] <0.239.0> Running boot step notify_cluster defined by app rabbit\r\n2020-03-31 10:27:21.896 [info] <0.239.0> Running boot step networking defined by app rabbit\r\n2020-03-31 10:27:21.899 [info] <0.524.0> started TCP listener on [::]:5672\r\n2020-03-31 10:27:21.899 [info] <0.239.0> Running boot step direct_client defined by app rabbit\r\n2020-03-31 10:27:21.901 [info] <0.570.0> Peer discovery: enabling node cleanup (will remove nodes not known to the discovery backend). Check interval: 10 seconds.\r\n2020-03-31 10:27:21.929 [info] <0.580.0> Management plugin: HTTP (non-TLS) listener started on port 15672\r\n2020-03-31 10:27:21.929 [info] <0.686.0> Statistics database started.\r\n2020-03-31 10:27:21.929 [info] <0.685.0> Starting worker pool 'management_worker_pool' with 3 processes in it\r\n2020-03-31 10:27:22.027 [info] <0.8.0> Server startup complete; 5 plugins started.\r\n * rabbitmq_management\r\n * rabbitmq_web_dispatch\r\n * rabbitmq_peer_discovery_k8s\r\n * rabbitmq_peer_discovery_common\r\n * rabbitmq_management_agent\r\n completed with 5 plugins.\r\n\r\n```\r\n</details>\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nIn our organisation we use Tower / AWX for a majority of internal package deployments.\r\nWe're currently undergoing a review of existing tooling in this space and a suggestion was made to see if AWX / Tower can achieve this functionality.\r\n\r\nI've had a look though previous issues and cant really see anything about this, though i may have searched some incorrect keywords.\r\n\r\nBasically, my idea to achieve this would be to add some mechanism to update a 'package inventory' - perhaps an extended version of the standard job template that exposes some additional fields\r\n- a new 'dashboard' that allows search on application name, version, hostname\r\n\r\nFields would be pretty basic and would require (probably) require two new DB tables:\r\n- one for software definitions (name, id, created, updated, version)\r\n- one for software deployments (id, host, relation to software defn, install date, uninstall date)\r\n\r\nAn extension to the API that allows you to update these fields from an external source may also be required to allow retrofitting of existing playbooks with a new tower_package module. This woudl also allow several app installs to be completed in a single play.\r\n\r\nI understand though that this may not be in the scope of what AWX is designed to do, but i would love some opinions / review on this to see if there is any interest for this kind of functionality."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nDatabase errors following 10.0.0 upgrade\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.0.0\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.9.0\r\n* Operating System: Ubuntu (Docker Host Base)\r\n* Web Browser: Chrome Latest\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun AWX Upgrade from 9.3.0 - 10.0.0\r\nLoad AWX homepage (following login)\r\nView Postgres DB Logs\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo Database errors\r\n\r\n##### ACTUAL RESULTS\r\n\r\nDB Errors as follows:\r\n\r\n2020-03-31 02:20:25.892 GMT [237] ERROR: relation \"_old_main_jobevent\" does not exist at character 21\r\n2020-03-31 02:20:25.892 GMT [237] STATEMENT: SELECT MAX(id) FROM _old_main_jobevent\r\n2020-03-31 02:20:25.893 GMT [237] ERROR: relation \"_old_main_inventoryupdateevent\" does not exist at character 21\r\n2020-03-31 02:20:25.893 GMT [237] STATEMENT: SELECT MAX(id) FROM _old_main_inventoryupdateevent\r\n2020-03-31 02:20:25.893 GMT [237] ERROR: relation \"_old_main_projectupdateevent\" does not exist at character 21\r\n2020-03-31 02:20:25.893 GMT [237] STATEMENT: SELECT MAX(id) FROM _old_main_projectupdateevent\r\n2020-03-31 02:20:25.894 GMT [237] ERROR: relation \"_old_main_adhoccommandevent\" does not exist at character 21\r\n2020-03-31 02:20:25.894 GMT [237] STATEMENT: SELECT MAX(id) FROM _old_main_adhoccommandevent\r\n2020-03-31 02:20:25.895 GMT [237] ERROR: relation \"_old_main_systemjobevent\" does not exist at character 21\r\n2020-03-31 02:20:25.895 GMT [237] STATEMENT: SELECT MAX(id) FROM _old_main_systemjobevent\r\n2020-03-31 02:20:38.210 GMT [259] ERROR: relation \"_old_main_jobevent\" does not exist at character 21\r\n2020-03-31 02:20:38.210 GMT [259] STATEMENT: SELECT MAX(id) FROM _old_main_jobevent\r\n2020-03-31 02:20:38.211 GMT [259] ERROR: relation \"_old_main_inventoryupdateevent\" does not exist at character 21\r\n2020-03-31 02:20:38.211 GMT [259] STATEMENT: SELECT MAX(id) FROM _old_main_inventoryupdateevent\r\n2020-03-31 02:20:38.212 GMT [259] ERROR: relation \"_old_main_projectupdateevent\" does not exist at character 21\r\n2020-03-31 02:20:38.212 GMT [259] STATEMENT: SELECT MAX(id) FROM _old_main_projectupdateevent\r\n2020-03-31 02:20:38.212 GMT [259] ERROR: relation \"_old_main_adhoccommandevent\" does not exist at character 21\r\n2020-03-31 02:20:38.212 GMT [259] STATEMENT: SELECT MAX(id) FROM _old_main_adhoccommandevent\r\n2020-03-31 02:20:38.213 GMT [259] ERROR: relation \"_old_main_systemjobevent\" does not exist at character 21\r\n2020-03-31 02:20:38.213 GMT [259] STATEMENT: SELECT MAX(id) FROM _old_main_systemjobevent\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAppears a lookup or somethign hasnt been removed in v10.0.0. Let me know if you want any additional info. will get it to you asap :)\r\n"},{"labels":["api"],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Job Template Run - POST returned status: 504\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: How to know the version? This is a newly installed AWX as well\r\n* AWX install method: docker on Linux\r\n* Ansible version:  2.9.6\r\n* Operating System: CentOS 7\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nThe issue will be reproduced when Launching the Job Template\r\n\r\n<!-- For new features, show how the feature would be used. For bugs, please show\r\nexactly how to reproduce the problem. Ideally, provide all steps and data needed\r\nto recreate the bug from a new awx install. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n-  Call to /api/v2/job_templates/12/launch failed. POST returned status: 504.\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nGUYS, PLEASE HELP ME WITH THIS ISSUE. :( Let me know if you need more info."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIn order to embrace the Windows ecosystem even further, adding support for psrp in the default awx Virtual Environment would benefit the management of said systems.\r\n\r\nUsing psrp over WinRM offers the added feature of Just Enough Administration (think sudo), which is becoming the standard in many (Enterprise) environments, due to the possibility to harden it.\r\n\r\nCurrently all required pip packages to support WinRM connectivity are included.\r\nIn order to enable psrp one needs to copy the existing venv and add the required python modules using well known methods.\r\n\r\nAdding the pypsrp pip packages by default would omit the need to install them manually and provide a more complete and supported method of managing (Enterprise) Windows systems.\r\n\r\n\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI'm unable to save any forms in AWX 9.3.0.\r\nWhen I try to click on the save button to create a new sample project or add LDAP authencatication I have a status code 504.  And the form is never saved.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.5\r\n* Operating System: CentOS 7.7\r\n* Web Browser: Chrome and Chrome in private\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate a new project sample and click save\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nThe form should be saved\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nFailed to create new project. POST returned status: 504\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nIn the logs I can see : \r\n`awx_web      | 2020/03/27 14:23:31 [error] 122#0: *47 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 10.204.35.76, server: _, request: \"GET /websocket/ HTTP/1.1\", upstream: \"http://127.0.0.1:8051/websocket/\", host: \"myserver:82\"\r\n`\r\nAnd in the browser console I have : \r\n```\r\nFailed to load resource: the server responded with a status of 504 (Gateway Time-out)\r\nWebSocket connection to 'ws://myserver:82/websocket/' failed: WebSocket opening handshake \r\ntimed out\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nRegression on https://github.com/ansible/awx/issues/3840\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* AWX install method: openshift\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Make 3 instance groups\r\n* Go to an org and associate each, one by one\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* For them to be returned in the order in which you added them\r\n\r\n##### ACTUAL RESULTS\r\n\r\n* 1st is 2nd\r\n* 2nd is last\r\n* 3rd is first"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUsing the API one is able to create same combo of (project name, organization) - organization is set to null.\r\n\r\n##### ENVIRONMENT\r\n* AWX: \"version\": \"devel\",\r\n* AWX install method: linux\r\n* Ansible version:  ansible 2.9.1\r\n* Operating System:RHEL8.1 (Ootpa)\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nUsing the API create a project called - Project A, and with a not null Organization.\r\nUsing the API create a project called - Project A, and with a  null Organization.\r\nUsing the API create a project called - Project A, and with a  null Organization.\r\n\r\n##### EXPECTED RESULTS\r\nNot able to create multiples with the same combo of (name, organization)\r\n\r\n##### ACTUAL RESULTS\r\nAble to create multiples with the same combo of (name, organization)\r\n\r\n```json\r\n\r\n    \"id\": 24,\r\n    \"type\": \"project\",\r\n    \"url\": \"/api/v2/projects/24/\",\r\n    \"related\": {\r\n        \"named_url\": \"/api/v2/projects/ansible-examples.git (git)++Bender Products/\",\r\n        \"created_by\": \"/api/v2/users/1/\",\r\n        \"modified_by\": \"/api/v2/users/1/\",\r\n        \"last_job\": \"/api/v2/project_updates/17/\",\r\n        \"teams\": \"/api/v2/projects/24/teams/\",\r\n        \"playbooks\": \"/api/v2/projects/24/playbooks/\",\r\n        \"inventory_files\": \"/api/v2/projects/24/inventories/\",\r\n        \"update\": \"/api/v2/projects/24/update/\",\r\n        \"project_updates\": \"/api/v2/projects/24/project_updates/\",\r\n        \"scm_inventory_sources\": \"/api/v2/projects/24/scm_inventory_sources/\",\r\n        \"schedules\": \"/api/v2/projects/24/schedules/\",\r\n        \"activity_stream\": \"/api/v2/projects/24/activity_stream/\",\r\n        \"notification_templates_started\": \"/api/v2/projects/24/notification_templates_started/\",\r\n        \"notification_templates_success\": \"/api/v2/projects/24/notification_templates_success/\",\r\n        \"notification_templates_error\": \"/api/v2/projects/24/notification_templates_error/\",\r\n        \"access_list\": \"/api/v2/projects/24/access_list/\",\r\n        \"object_roles\": \"/api/v2/projects/24/object_roles/\",\r\n        \"copy\": \"/api/v2/projects/24/copy/\",\r\n        \"organization\": \"/api/v2/organizations/58/\",\r\n        \"last_update\": \"/api/v2/project_updates/17/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"organization\": {\r\n            \"id\": 58,\r\n            \"name\": \"Bender Products\",\r\n            \"description\": \"Bender Products, Ltd.\"\r\n        },\r\n        \"last_job\": {\r\n            \"id\": 17,\r\n            \"name\": \"ansible-examples.git (git)\",\r\n            \"description\": \"scm_type:git\",\r\n            \"finished\": \"2020-03-25T15:38:02.178682Z\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false\r\n        },\r\n        \"last_update\": {\r\n            \"id\": 17,\r\n            \"name\": \"ansible-examples.git (git)\",\r\n            \"description\": \"scm_type:git\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false\r\n        },\r\n        \"created_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"modified_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"object_roles\": {\r\n            \"admin_role\": {\r\n                \"description\": \"Can manage all aspects of the project\",\r\n                \"name\": \"Admin\",\r\n                \"id\": 1363\r\n            },\r\n            \"use_role\": {\r\n                \"description\": \"Can use the project in a job template\",\r\n                \"name\": \"Use\",\r\n                \"id\": 1364\r\n            },\r\n            \"update_role\": {\r\n                \"description\": \"May update the project\",\r\n                \"name\": \"Update\",\r\n                \"id\": 1365\r\n            },\r\n            \"read_role\": {\r\n                \"description\": \"May view settings for the project\",\r\n                \"name\": \"Read\",\r\n                \"id\": 1366\r\n            }\r\n        },\r\n        \"user_capabilities\": {\r\n            \"edit\": true,\r\n            \"delete\": true,\r\n            \"start\": true,\r\n            \"schedule\": true,\r\n            \"copy\": true\r\n        }\r\n    },\r\n    \"created\": \"2020-03-25T15:37:55.110152Z\",\r\n    \"modified\": \"2020-03-25T15:37:55.367068Z\",\r\n    \"name\": \"ansible-examples.git (git)\",\r\n    \"description\": \"scm_type:git\",\r\n    \"local_path\": \"_24__ansible_examplesgit_git\",\r\n    \"scm_type\": \"git\",\r\n    \"scm_url\": \"https://github.com/ansible/ansible-examples.git\",\r\n    \"scm_branch\": \"\",\r\n    \"scm_refspec\": \"\",\r\n    \"scm_clean\": false,\r\n    \"scm_delete_on_update\": false,\r\n    \"credential\": null,\r\n    \"timeout\": 0,\r\n    \"scm_revision\": \"13f862497df5687ae6dc03fd2036cfac3b9e1fb7\",\r\n    \"last_job_run\": \"2020-03-25T15:38:02.178682Z\",\r\n    \"last_job_failed\": false,\r\n    \"next_job_run\": null,\r\n    \"status\": \"successful\",\r\n    \"organization\": 58,\r\n    \"scm_update_on_launch\": false,\r\n    \"scm_update_cache_timeout\": 0,\r\n    \"allow_override\": false,\r\n    \"custom_virtualenv\": null,\r\n    \"last_update_failed\": false,\r\n    \"last_updated\": \"2020-03-25T15:38:02.178682Z\"\r\n}\r\n\r\n```\r\n\r\nSecond project with the same name above and null organization.\r\n\r\n\r\n\r\n```json\r\n\r\n{\r\n    \"id\": 8,\r\n    \"type\": \"project\",\r\n    \"url\": \"/api/v2/projects/8/\",\r\n    \"related\": {\r\n        \"named_url\": \"/api/v2/projects/ansible-examples.git (git)++/\",\r\n        \"created_by\": \"/api/v2/users/1/\",\r\n        \"modified_by\": \"/api/v2/users/1/\",\r\n        \"last_job\": \"/api/v2/project_updates/1/\",\r\n        \"teams\": \"/api/v2/projects/8/teams/\",\r\n        \"playbooks\": \"/api/v2/projects/8/playbooks/\",\r\n        \"inventory_files\": \"/api/v2/projects/8/inventories/\",\r\n        \"update\": \"/api/v2/projects/8/update/\",\r\n        \"project_updates\": \"/api/v2/projects/8/project_updates/\",\r\n        \"scm_inventory_sources\": \"/api/v2/projects/8/scm_inventory_sources/\",\r\n        \"schedules\": \"/api/v2/projects/8/schedules/\",\r\n        \"activity_stream\": \"/api/v2/projects/8/activity_stream/\",\r\n        \"notification_templates_started\": \"/api/v2/projects/8/notification_templates_started/\",\r\n        \"notification_templates_success\": \"/api/v2/projects/8/notification_templates_success/\",\r\n        \"notification_templates_error\": \"/api/v2/projects/8/notification_templates_error/\",\r\n        \"access_list\": \"/api/v2/projects/8/access_list/\",\r\n        \"object_roles\": \"/api/v2/projects/8/object_roles/\",\r\n        \"copy\": \"/api/v2/projects/8/copy/\",\r\n        \"last_update\": \"/api/v2/project_updates/1/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"last_job\": {\r\n            \"id\": 1,\r\n            \"name\": \"ansible-examples.git (git)\",\r\n            \"description\": \"scm_type:git\",\r\n            \"finished\": \"2020-03-25T15:24:33.234273Z\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false\r\n        },\r\n        \"last_update\": {\r\n            \"id\": 1,\r\n            \"name\": \"ansible-examples.git (git)\",\r\n            \"description\": \"scm_type:git\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false\r\n        },\r\n        \"created_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"modified_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"object_roles\": {\r\n            \"admin_role\": {\r\n                \"description\": \"Can manage all aspects of the project\",\r\n                \"name\": \"Admin\",\r\n                \"id\": 477\r\n            },\r\n            \"use_role\": {\r\n                \"description\": \"Can use the project in a job template\",\r\n                \"name\": \"Use\",\r\n                \"id\": 478\r\n            },\r\n            \"update_role\": {\r\n                \"description\": \"May update the project\",\r\n                \"name\": \"Update\",\r\n                \"id\": 479\r\n            },\r\n            \"read_role\": {\r\n                \"description\": \"May view settings for the project\",\r\n                \"name\": \"Read\",\r\n                \"id\": 480\r\n            }\r\n        },\r\n        \"user_capabilities\": {\r\n            \"edit\": true,\r\n            \"delete\": true,\r\n            \"start\": true,\r\n            \"schedule\": true,\r\n            \"copy\": true\r\n        }\r\n    },\r\n    \"created\": \"2020-03-25T15:24:28.738484Z\",\r\n    \"modified\": \"2020-03-25T15:24:32.786829Z\",\r\n    \"name\": \"ansible-examples.git (git)\",\r\n    \"description\": \"scm_type:git\",\r\n    \"local_path\": \"_8__ansible_examplesgit_git\",\r\n    \"scm_type\": \"git\",\r\n    \"scm_url\": \"https://github.com/ansible/ansible-examples.git\",\r\n    \"scm_branch\": \"\",\r\n    \"scm_refspec\": \"\",\r\n    \"scm_clean\": false,\r\n    \"scm_delete_on_update\": false,\r\n    \"credential\": null,\r\n    \"timeout\": 0,\r\n    \"scm_revision\": \"13f862497df5687ae6dc03fd2036cfac3b9e1fb7\",\r\n    \"last_job_run\": \"2020-03-25T15:24:33.234273Z\",\r\n    \"last_job_failed\": false,\r\n    \"next_job_run\": null,\r\n    \"status\": \"successful\",\r\n    \"organization\": null,\r\n    \"scm_update_on_launch\": false,\r\n    \"scm_update_cache_timeout\": 0,\r\n    \"allow_override\": false,\r\n    \"custom_virtualenv\": null,\r\n    \"last_update_failed\": false,\r\n    \"last_updated\": \"2020-03-25T15:24:33.234273Z\"\r\n}\r\n\r\n```\r\nThird project with the same name above and null organization.\r\n\r\n```json\r\n{\r\n    \"id\": 16,\r\n    \"type\": \"project\",\r\n    \"url\": \"/api/v2/projects/16/\",\r\n    \"related\": {\r\n        \"named_url\": \"/api/v2/projects/ansible-examples.git (git)++/\",\r\n        \"created_by\": \"/api/v2/users/1/\",\r\n        \"modified_by\": \"/api/v2/users/1/\",\r\n        \"last_job\": \"/api/v2/project_updates/9/\",\r\n        \"teams\": \"/api/v2/projects/16/teams/\",\r\n        \"playbooks\": \"/api/v2/projects/16/playbooks/\",\r\n        \"inventory_files\": \"/api/v2/projects/16/inventories/\",\r\n        \"update\": \"/api/v2/projects/16/update/\",\r\n        \"project_updates\": \"/api/v2/projects/16/project_updates/\",\r\n        \"scm_inventory_sources\": \"/api/v2/projects/16/scm_inventory_sources/\",\r\n        \"schedules\": \"/api/v2/projects/16/schedules/\",\r\n        \"activity_stream\": \"/api/v2/projects/16/activity_stream/\",\r\n        \"notification_templates_started\": \"/api/v2/projects/16/notification_templates_started/\",\r\n        \"notification_templates_success\": \"/api/v2/projects/16/notification_templates_success/\",\r\n        \"notification_templates_error\": \"/api/v2/projects/16/notification_templates_error/\",\r\n        \"access_list\": \"/api/v2/projects/16/access_list/\",\r\n        \"object_roles\": \"/api/v2/projects/16/object_roles/\",\r\n        \"copy\": \"/api/v2/projects/16/copy/\",\r\n        \"last_update\": \"/api/v2/project_updates/9/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"last_job\": {\r\n            \"id\": 9,\r\n            \"name\": \"ansible-examples.git (git)\",\r\n            \"description\": \"scm_type:git\",\r\n            \"finished\": \"2020-03-25T15:33:52.777140Z\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false\r\n        },\r\n        \"last_update\": {\r\n            \"id\": 9,\r\n            \"name\": \"ansible-examples.git (git)\",\r\n            \"description\": \"scm_type:git\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false\r\n        },\r\n        \"created_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"modified_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"object_roles\": {\r\n            \"admin_role\": {\r\n                \"description\": \"Can manage all aspects of the project\",\r\n                \"name\": \"Admin\",\r\n                \"id\": 920\r\n            },\r\n            \"use_role\": {\r\n                \"description\": \"Can use the project in a job template\",\r\n                \"name\": \"Use\",\r\n                \"id\": 921\r\n            },\r\n            \"update_role\": {\r\n                \"description\": \"May update the project\",\r\n                \"name\": \"Update\",\r\n                \"id\": 922\r\n            },\r\n            \"read_role\": {\r\n                \"description\": \"May view settings for the project\",\r\n                \"name\": \"Read\",\r\n                \"id\": 923\r\n            }\r\n        },\r\n        \"user_capabilities\": {\r\n            \"edit\": true,\r\n            \"delete\": true,\r\n            \"start\": true,\r\n            \"schedule\": true,\r\n            \"copy\": true\r\n        }\r\n    },\r\n    \"created\": \"2020-03-25T15:33:46.888246Z\",\r\n    \"modified\": \"2020-03-25T15:33:47.157592Z\",\r\n    \"name\": \"ansible-examples.git (git)\",\r\n    \"description\": \"scm_type:git\",\r\n    \"local_path\": \"_16__ansible_examplesgit_git\",\r\n    \"scm_type\": \"git\",\r\n    \"scm_url\": \"https://github.com/ansible/ansible-examples.git\",\r\n    \"scm_branch\": \"\",\r\n    \"scm_refspec\": \"\",\r\n    \"scm_clean\": false,\r\n    \"scm_delete_on_update\": false,\r\n    \"credential\": null,\r\n    \"timeout\": 0,\r\n    \"scm_revision\": \"13f862497df5687ae6dc03fd2036cfac3b9e1fb7\",\r\n    \"last_job_run\": \"2020-03-25T15:33:52.777140Z\",\r\n    \"last_job_failed\": false,\r\n    \"next_job_run\": null,\r\n    \"status\": \"successful\",\r\n    \"organization\": null,\r\n    \"scm_update_on_launch\": false,\r\n    \"scm_update_cache_timeout\": 0,\r\n    \"allow_override\": false,\r\n    \"custom_virtualenv\": null,\r\n    \"last_update_failed\": false,\r\n    \"last_updated\": \"2020-03-25T15:33:52.777140Z\"\r\n}\r\n\r\n```\r\n![image](https://user-images.githubusercontent.com/9053044/77571829-5e0fb100-6ea4-11ea-8528-3bea23c3306d.png)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAn user is requesting the ability to generate a failed host summary using notification attributes (https://docs.ansible.com/ansible-tower/latest/html/installandreference/notification_parameters_supported.html). The failed host summary would be sent via email.\r\n\r\nIdeally, they want a structure similar to this:\r\n\r\n~~~\r\nFailed Hosts:\r\n<HOSTNAME> failed <TASK_NAME> in <PLAYBOOK_NAME>\r\n~~~\r\n\r\nThere is a `job_metadata` attribute, which includes all target hosts and their status.\r\n\r\nEXAMPLE:\r\n~~~\r\n{\r\n  \"test1.example.com\": {\r\n    \"failed\": true,\r\n    \"changed\": 0,\r\n    \"dark\": 1,\r\n    \"failures\": 0,\r\n    \"ok\": 0,\r\n    \"processed\": 1,\r\n    \"skipped\": 0,\r\n    \"rescued\": 0,\r\n    \"ignored\": 0\r\n  },\r\n  \"test2.example.com\": {\r\n    \"failed\": true,\r\n    \"changed\": 0,\r\n    \"dark\": 1,\r\n    \"failures\": 0,\r\n    \"ok\": 0,\r\n    \"processed\": 1,\r\n    \"skipped\": 0,\r\n    \"rescued\": 0,\r\n    \"ignored\": 0\r\n  }\r\n}\r\n~~~\r\n\r\nHowever, it appears you can't query deeper into the JSON body with filters and grab the necessary information. At this point, all metadata about the job is displayed.\r\n\r\nIs it possible to implement a failed host summary with the preceding structure? If not, is it possible to generate a new notification attribute with just failed host information?\r\n\r\nMaybe something like this:\r\n\r\nEXAMPLE BODY:\r\n~~~\r\nFailed Hosts:\r\n\r\n{{ job_failed_hosts }}\r\n~~~\r\n\r\nJSON BODY:\r\n~~~\r\n{\r\n  \"failed_hosts\": {\r\n    \"test1.example.com\": {\r\n      \"failed_task_name\": \"Gathering Info\",\r\n      \"playbook\": \"test.yml\"\r\n    },\r\n    \"test2.example.com\": {\r\n      \"failed_task_name\": \"Gathering Data\",\r\n      \"playbook\": \"test.yml\"\r\n    }\r\n  }\r\n}\r\n~~~\r\n\r\nEXAMPLE RENDERED EMAIL:\r\n\r\n~~~\r\nFailed Hosts:\r\n\r\n{\r\n  \"failed_hosts\": {\r\n    \"test1.example.com\": {\r\n      \"failed_task_name\": \"Gathering Info\",\r\n      \"playbook\": \"test.yml\"\r\n    },\r\n    \"test2.example.com\": {\r\n      \"failed_task_name\": \"Gathering Data\",\r\n      \"playbook\": \"test.yml\"\r\n    }\r\n  }\r\n}\r\n~~~\r\n\r\nAny guidance is much appreciated!"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAs an admin of several well-loved towers and awx instances used by people to do work in the past, I've often wished for a simple way to turn off all notifications and/or scheduled jobs globally.\r\n\r\nExample scenarios:\r\n\r\n- A job or workflow has started unexpectedly failing and I want to debug the playbooks in production. To avoid spamming the team's slack channels, emails, etc. with repeat failure notifications while I shamelessly hack my way to a solution, I need to sign in and manually disable every single notification related to any job template in my workflows before iterating.  I also need to _remember_ to turn everything back on once I'm done.\r\n\r\n- I'm running a backup-restore (or export-import) procedure to preview some new changes or set up a development, test, or staging environment with rich data copied over from a live tower or awx instance. Unless I immediately sign in and delete all schedules, the timed jobs on the copied instance will attempt to run at their scheduled times, likely creating unexpected and potentially disastrous results like duplicate jobs from both the source and destination instances executing against the same hosts at the same time.\r\n\r\n\r\n**Proposed idea**\r\n\r\n1. Add a global toggle switch to the system settings (sysadmins only) for disabling all notifications and scheduled jobs. \r\n\r\n2. Also add an option to installers and restore playbooks that disable these things as part of the post-install or post-restore process.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\ncurrently when we query /api/v2/ping/ we get the health-check for all the instances in the cluster we need is way to query he API and only display the information of that instance.\r\ne.g\r\n~~~\r\ncurl -s 'https://<myserver1>/api/v2/ping/?active_node_only=true'\r\n\r\n{\r\n      \"version\": \"3.6.0\",\r\n      \"capacity\": 19,\r\n      \"heartbeat\": \"2020-03-24T21:13:15.271164Z\",\r\n      \"uuid\": \"xxx-xxxx-xxx-xxxx-xxxx\",\r\n      \"node\": \"tower1\"\r\n    },\r\n~~~\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\"We need to schedule a template to run automatically five days every month. We need to know how to do this without having to create 5 different schedules, one for each day. \"\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIf a user has authenticated through another external mechanism such as LDAP, a SAML IdP initiated login for the same user results in a new user created with a random suffix hash.\r\n\r\nFor example if LDAP auth is configured and a user `bob.test` is authenticated via LDAP that user account is created.  If SAML auth is also configured where the username `bob.test`, as mapped in the SAML config to the assertion, matches the LDAP username a new user is created for the SAML login in the form `bob.test87687678687687` with a hash appended.  \r\n\r\nThis can lead to confusion in the UI and create management issues as these users will need to be cleaned up. \r\n\r\nI would propose either having SAML logins fail if the username is already present as an LDAP user or to replace/re-flag the existing user as social.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWe need to upgrade to a newer pyyaml to address CVE-2017-18342 (though, to my knowledge, we're _already using_ `safe_load()` appropriately everywhere, so this upgrade is really just to tick a box).\r\n\r\nUnfortunately, the currently released version of `openshift` relies on a `kubernetes` version that pins to an older version of `pyyaml`:\r\n\r\nhttps://github.com/kubernetes-client/python/blob/v10.1.0/requirements.txt#L5\r\n\r\nOnce a new `openshift` library version is released, we should update our dependencies to pull in a newer `pyyaml`."},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCan't save any system settings after using the lastest installer. Results in a long wait and then 504 error. Reproduced this issue on CentOS 8 and Ubuntu 18.04.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 9.3.0 \r\n* AWX install method: docker on linux\r\n* Ansible version: 2.9.5\r\n* Operating System: Ubuntu and CentOS 8\r\n* Web Browser: FireFox and Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nInstall the latest version of AWX from source.\r\nAttempt to save a system setting such as Authentication or even UI.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSetting to save.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nLong wait time and error message:\r\n\"Failed to save settings. Returned status: 504\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nSearching keyword finds more than I expected at Templates menu\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.3\r\n* Operating System: Centos7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create Job Templates with name prefix N_CAT01_ , R_CAT01_ and   T_CAT01_  serveral kinds.\r\n2. Repeat 1. with changing prefix number  01 to 02, 10, 11.\r\n3. Search with keyword T_CAT10  (or T_CAT11)\r\n4. Results have N_CAT10_xxx (or N_CAT11_xxx)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nDo not find templates which doesn't have keyword in name\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOne or two job templates not related with keyword was found.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![T_CAT10](https://user-images.githubusercontent.com/25745571/77148646-4b2b6400-6ad3-11ea-987a-6c4a92e30ce5.png)\r\n![T_CAT11](https://user-images.githubusercontent.com/25745571/77148650-4c5c9100-6ad3-11ea-90eb-de62446c7049.png)\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIn the UI each line in the task job log has an additional newline.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.5\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLaunch a JT for multiple targets\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<img width=\"797\" alt=\"Screen Shot 2020-03-20 at 9 00 59 AM\" src=\"https://user-images.githubusercontent.com/10410660/77128005-899c3100-6a89-11ea-9b8b-8d74e683a6b5.png\">\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<img width=\"815\" alt=\"Screen Shot 2020-03-20 at 9 01 37 AM\" src=\"https://user-images.githubusercontent.com/10410660/77128009-8e60e500-6a89-11ea-8023-6491789ca19c.png\">\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nDownloading the logs shows\r\n\r\n<img width=\"705\" alt=\"Screen Shot 2020-03-20 at 9 04 57 AM\" src=\"https://user-images.githubusercontent.com/10410660/77128113-ef88b880-6a89-11ea-8f8b-8d7d0b88acb8.png\">\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen disassociating inventory hosts from a group in bulk, the API returns a 204 success response but the hosts remain in the group. The UI could address this issue by enforcing a single disassociate at a time, or through disassociating the hosts sequentially. There is an API component to this because it shouldn't return a 204 success if it did not successfully disassociate the host. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method:  docker for mac\r\n* Ansible version: 2.10.0\r\n\r\n##### STEPS TO REPRODUCE\r\n* Navigate to Inventory Group Host List `/inventories/inventory/1/groups/11/nested_hosts`\r\n  * Make sure you have at least 10 hosts in the list\r\n* Check select all hosts\r\n* Click Disassociate button\r\n  * A modal should popup and display the list of selected hosts\r\n* Click Disassociate button in the modal \r\n  * Watch network requests in browser developer tools\r\n* Modal disappears \r\n* Inventory group host list remains unchanged even after a hard refresh \r\n\r\n##### EXPECTED RESULTS\r\n* The hosts are removed from the inventory group host list\r\n\r\n##### ACTUAL RESULTS\r\n* The hosts remain in the inventory group host list \r\n\r\n##### ADDITIONAL INFORMATION\r\n![disassociate test3](https://user-images.githubusercontent.com/15881645/77095516-65d2df80-69e4-11ea-9085-25a645e774a1.gif)\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nError when applying\r\n`curl -X PATCH 'https://admin:mypass@myurl/api/v2/organizations/my_org/' \\\r\n    -d '{\"custom_virtualenv\": \"/opt/custom-venvs/my_env/\"}'  -H 'Content-Type:application/json'`\r\n`{\"custom_virtualenv\":[\"/opt/custom-venvs/my_env/ is not a valid virtualenv in /var/lib/awx/venv\"]}`\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method: Kubernetes v1.15.3\r\n* Ansible version:  2.9.5\r\n\r\n##### STEPS TO REPRODUCE\r\n1) Install AWX to kubernetes with similar config\r\n\r\n<details>\r\n  <summary>inventory config</summary> \r\n\r\n```\r\nlocalhost ansible_connection=local ansible_python_interpreter=\"/usr/bin/env python\"\r\n\r\n[all:vars]\r\n\r\ndockerhub_base=ansible\r\n\r\nkubernetes_context=mycontext\r\nkubernetes_namespace=awx\r\n\r\nkubernetes_ingress_hostname=myingress\r\n\r\nawx_task_hostname=awx\r\nawx_web_hostname=awxweb\r\npostgres_data_dir=\"~/.awx/pgdocker\"\r\nhost_port=80\r\nhost_port_ssl=443\r\ndocker_compose_dir=\"~/.awx/awxcompose\"\r\n\r\npg_hostname=mypghost\r\npg_username=awx\r\npg_password=mypgpass\r\npg_database=awx\r\npg_port=5432\r\n\r\nrabbitmq_password=awxpass\r\nrabbitmq_erlang_cookie=cookiemonster\r\n\r\nadmin_user=admin\r\nadmin_password=myadminpass\r\n\r\nsecret_key=mysecretkey\r\n\r\nlogos/blob/master/TRADEMARKS.md\r\n```\r\n\r\n</details>\r\n\r\n\r\n<details>\r\n  <summary>venv_vars.yaml</summary>\r\n\r\n```\r\n---\r\ncustom_venvs:\r\n  - name: my_env\r\n    python: python3\r\n    python_ansible_version: 2.9.6\r\n    python_modules:\r\n      - dnspython\r\n      - zabbix-api\r\n      - jmespath\r\n```\r\n\r\n</details>\r\n\r\n2) Assigning custom venv according to [this documentation](https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md)\r\n`curl -X PATCH 'https://admin:mypass@myurl/api/v2/settings/system/' \\\r\n    -d '{\"CUSTOM_VENV_PATHS\": [[\"/opt/custom-venvs/my_env/\"]}'  -H 'Content-Type:application/json'`\r\n<details>\r\n  <summary>answer</summary>\r\n\r\n```\r\n{\r\n   \"ACTIVITY_STREAM_ENABLED\":true,\r\n   \"ACTIVITY_STREAM_ENABLED_FOR_INVENTORY_SYNC\":false,\r\n   \"ORG_ADMINS_CAN_SEE_ALL_USERS\":true,\r\n   \"MANAGE_ORGANIZATION_AUTH\":true,\r\n   \"TOWER_URL_BASE\":\"myurl\",\r\n   \"REMOTE_HOST_HEADERS\":[\r\n      \"HTTP_X_FORWARDED_FOR\"\r\n   ],\r\n   \"PROXY_IP_WHITELIST\":[\r\n\r\n   ],\r\n   \"LICENSE\":{\r\n\r\n   },\r\n   \"REDHAT_USERNAME\":\"admin\",\r\n   \"REDHAT_PASSWORD\":\"$encrypted$\",\r\n   \"AUTOMATION_ANALYTICS_URL\":\"https://example.org\",\r\n   \"INSTALL_UUID\":\"c1885c2a-d736-4023-9517-49929f8d77fa\",\r\n   \"CUSTOM_VENV_PATHS\":[\r\n      \"/opt/custom-venvs/my_env/\"\r\n   ],\r\n   \"INSIGHTS_TRACKING_STATE\":false,\r\n   \"BROKER_DURABILITY\":true,\r\n   \"AUTOMATION_ANALYTICS_LAST_GATHER\":null,\r\n   \"AUTOMATION_ANALYTICS_GATHER_INTERVAL\":14400\r\n}\r\n```\r\n\r\n</details>\r\n\r\n3) Assigning custom venv to organization and get and error\r\n`curl -X PATCH 'https://admin:mypass@myurl/api/v2/organizations/my_org/' \\\r\n    -d '{\"custom_virtualenv\": \"/opt/custom-venvs/my_env/\"}'  -H 'Content-Type:application/json'`\r\n<details>\r\n  <summary>error</summary>\r\n\r\n```\r\n{\"custom_virtualenv\":[\"/opt/custom-venvs/my_env/ is not a valid virtualenv in /var/lib/awx/venv\"]}\r\n```\r\n\r\n</details>\r\n\r\n##### EXPECTED RESULTS\r\n\r\n`my_org` will use custom venv\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`my_org` raises an error when apllying custom venv\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI've checked both containers `awx_web` and `awx_task`, they have `/opt/custom-venvs/my_env/` dir with working venv. \r\n\r\nEven if `PATCH api/v2/settings/system/` works properly (according to it answer, and i can see added venv in web interface), `GET api/v2/config/` still returns no venv's\r\n<details>\r\n  <summary>api/v2/config/ answer</summary>\r\n\r\n```\r\n{\r\n    \"time_zone\": \"UTC\",\r\n    \"license_info\": {\r\n        \"license_key\": \"OPEN\",\r\n        \"valid_key\": true,\r\n        \"compliant\": true,\r\n        \"features\": {\r\n            \"activity_streams\": true,\r\n            \"ha\": true,\r\n            \"ldap\": true,\r\n            \"multiple_organizations\": true,\r\n            \"surveys\": true,\r\n            \"system_tracking\": true,\r\n            \"rebranding\": true,\r\n            \"enterprise_auth\": true,\r\n            \"workflows\": true\r\n        },\r\n        \"license_type\": \"open\"\r\n    },\r\n    \"version\": \"9.3.0\",\r\n    \"ansible_version\": \"2.9.5\",\r\n    \"eula\": \"\",\r\n    \"analytics_status\": \"off\",\r\n    \"become_methods\": [\r\n        [\r\n            \"sudo\",\r\n            \"Sudo\"\r\n        ],\r\n        [\r\n            \"su\",\r\n            \"Su\"\r\n        ],\r\n        [\r\n            \"pbrun\",\r\n            \"Pbrun\"\r\n        ],\r\n        [\r\n            \"pfexec\",\r\n            \"Pfexec\"\r\n        ],\r\n        [\r\n            \"dzdo\",\r\n            \"DZDO\"\r\n        ],\r\n        [\r\n            \"pmrun\",\r\n            \"Pmrun\"\r\n        ],\r\n        [\r\n            \"runas\",\r\n            \"Runas\"\r\n        ],\r\n        [\r\n            \"enable\",\r\n            \"Enable\"\r\n        ],\r\n        [\r\n            \"doas\",\r\n            \"Doas\"\r\n        ],\r\n        [\r\n            \"ksu\",\r\n            \"Ksu\"\r\n        ],\r\n        [\r\n            \"machinectl\",\r\n            \"Machinectl\"\r\n        ],\r\n        [\r\n            \"sesu\",\r\n            \"Sesu\"\r\n        ]\r\n    ],\r\n    \"project_base_dir\": \"/var/lib/awx/projects\",\r\n    \"project_local_paths\": [],\r\n    \"custom_virtualenvs\": [\r\n        \"/var/lib/awx/venv/ansible/\"\r\n    ]\r\n}\r\n```\r\n\r\n</details>\r\n\r\n\r\nAfter finding that venv doesn't apply even in `system`, i've tried to make fresh install of awx on another kube cluster, with same results."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\nJobs not running with external PostgreSQL database after PR https://github.com/ansible/awx/pull/6034\r\n\r\n##### SUMMARY\r\nJobs not running with external PostgreSQL database after PR https://github.com/ansible/awx/pull/6034\r\nI've found that the issue is in following code:\r\nhttps://github.com/ansible/awx/blob/db7f0f9421853f2489ebb2f6b904202986dee99a/awx/main/dispatch/__init__.py#L72-L78\r\n\r\nReplacing it with:\r\n```\r\n    conn = psycopg2.connect(dbname=conf['NAME'],\r\n                            host=conf['HOST'],\r\n                            user=conf['USER'],\r\n                            password=conf['PASSWORD'],\r\n                            port=conf['PORT'],\r\n                            sslmode=conf[\"OPTIONS\"]['sslmode'])\r\n```\r\nenables job execution (note: this is specific to my setup which omits some options in credentials.py which are part of default AWX K8S credentials.py.j2 template, specifically I'm not using 'sslrootcert': '{{ ca_trust_bundle }}')\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0 (devel branch)\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.9.3\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Deploy latest AWX devel in Kubernetes with external PostgreSQL database.\r\n2) Execute job\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob should execute\r\n\r\n##### ACTUAL RESULTS\r\n\r\nJob stays in pending with exceptions in `awx-task` log\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nDidn't open a PR since there might be more option in following file, and should be a clever way to enable them in `psycopg2.connect()` method. https://github.com/ansible/awx/blob/devel/installer/roles/kubernetes/templates/credentials.py.j2"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI was trying to associate an inventory script with an inventory as an inventory source. When I did a POST to api/v2/inventories/<ID>/inventory_sources/ with id and name I got a 201 created (should be 400) and an inventory source object back. I then launched an inventory update and the following traceback was produced:\r\n\r\n```\r\nTraceback (most recent call last): File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py\", line 1308, in run args = self.build_args(self.instance, private_data_dir, passwords) File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py\", line 2472, in build_args if getattr(settings, '%s_EXCLUDE_EMPTY_GROUPS' % src.upper()): File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py\", line 511, in __getattr_without_cache__ return getattr(self._wrapped, name) File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py\", line 418, in __getattr__ value = self._get_default(name) File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py\", line 405, in _get_default return getattr(self.default_settings, name) AttributeError: 'Settings' object has no attribute '_EXCLUDE_EMPTY_GROUPS'\r\n```\r\n\r\nSeems like the bug is that we are not requiring the `source` perhaps among other things and ignoring `id`"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nSchedule a Job to run at specific time and date from survey\r\n\r\n\"When executing a Ansible Tower Job the survey prompt pop up.  I want to define a specific date and time to run this job once without creating a scheduler.\r\nA team is only allowed to execute the job, but cannot/should not be able to create schedulers and at the same time they must be able to execute the job at a specific time.\""},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.4\r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Update notification text to include: {{ job_metadata }}\r\n2. Click Save\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected a JSON string to be returned in my notification as indicated here: https://docs.ansible.com/ansible-tower/latest/html/installandreference/notification_parameters_supported.html\r\n\r\n##### ACTUAL RESULTS\r\n\r\nERROR! Popup:  Failed to update notifier. Field 'job_metadata' unavailable.\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nIncrease the ability for both the UI and Django to accept first_name fields beyond 30 (similar to last_name which supports 150 characters)."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen running a job in a container group the job returns with status error and a stack trace in the error details field.  The same Job runs perfectly when not run in a container group.\r\n\r\nstatus: error\r\nerror details:  `Traceback (most recent call last): File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 1401, in run ident=str(self.instance.pk)) File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 432, in run status, rc = self.check() File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 241, in check self.consume_events(dispatcher) File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 306, in consume_events event_data.setdefault(self.event_data_key, self.instance.id) UnboundLocalError: local variable 'event_data' referenced before assignment`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.3.0\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.9.5\r\n* Operating System: linux\r\n* Web Browser: chromium\r\n\r\n##### STEPS TO REPRODUCE\r\nsetup a job template in a container group and run it.  This error does not always happen it seems to only happen against specific inventories.\r\n\r\n##### EXPECTED RESULTS\r\nI expected the job to return with no error as it does when not run in a container-instance.\r\n\r\n##### ACTUAL RESULTS\r\nstatus: error\r\nerror details:\r\n `Traceback (most recent call last): File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 1401, in run ident=str(self.instance.pk)) File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 432, in run status, rc = self.check() File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 241, in check self.consume_events(dispatcher) File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 306, in consume_events event_data.setdefault(self.event_data_key, self.instance.id) UnboundLocalError: local variable 'event_data' referenced before assignment`\r\n##### ADDITIONAL INFORMATION\r\nHere is some more info from the logs:\r\n\r\n```\r\n2020-03-12 23:43:10,040 ERROR    awx.isolated.manager.playbooks \r\nPLAY [Poll for status of active job.] ******************************************\r\n\r\nTASK [Determine if daemon process is alive.] ***********************************\r\nchanged: [awx-job-164]\r\n\r\nTASK [Copy artifacts from the isolated host.] **********************************\r\nskipping: [awx-job-164]\r\n\r\nTASK [Copy daemon log from the isolated host] **********************************\r\nskipping: [awx-job-164]\r\n\r\nTASK [Copy artifacts from pod] *************************************************\r\n\r\n2020-03-12 23:43:10,042 ERROR    awx.main.tasks job 164 (running) Exception occurred while running task\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 1401, in run\r\n    ident=str(self.instance.pk))\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 432, in run\r\n    status, rc = self.check()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 241, in check\r\n    self.consume_events(dispatcher)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/isolated/manager.py\", line 294, in consume_events\r\n    open(os.path.join(events_path, event), 'r')\r\nIsADirectoryError: [Errno 21] Is a directory: '/tmp/awx_164_pojd2p9l/artifacts/164/job_events/.~tmp~'\r\n2020-03-12 23:43:10,044 DEBUG    awx.main.tasks job 164 (running) finished running, producing 0 events.\r\n```\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nSee: https://github.com/ansible/ansible/pull/67843\r\n\r\nRight now, we install files\r\n\r\n```\r\nroles/requirements.yml\r\ncollections/requirements.yml\r\n```\r\n\r\nThe first will install with `ansible-galaxy install`, the second will install with `ansible-galaxy collection install`.\r\n\r\nThat PR will allow installing _both types_ with `ansible-galaxy install`.\r\n\r\nAssuming this is the final form that merges (there seems little doubt), none of this will make a lot of sense. It doesn't make sense to allow putting collection requirements in the roles folder.\r\n\r\nTentative idea of how to react to this:\r\n\r\n - Depending on Ansible version, switch to `ansible-galaxy role install roles/requirements.yml`\r\n - Look for a unified requirements.yml file in a 3rd, new, yet-to-be-decided location\r\n"},{"labels":["api",null,null],"text":"When an approval node needs review and an email notification is setup, the email body contains null started, when the started field is actually set in the api\r\n\r\nSteps to reproduce:\r\n1. Create a WFJT with approval node\r\n2. associate it with Email notification template that will send notification on WF Approvals\r\n3. launch the WFJT\r\n4. wait for the email notification when the approval node needs review:\r\n\r\nExpected Results:\r\nthe notification should be as follows:\r\n```\r\nThe approval node \"approval node MediumResident�\" needs review. This approval node can be viewed at: https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86\r\n\r\n{\r\n    \"id\": 87,\r\n    \"name\": \"approval node MediumResident\\ufffd\",\r\n    \"url\": \"https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86\",\r\n    \"created_by\": \"apurva\",\r\n    \"started\": \"2020-03-11T21:21:19.898052+00:00\",\r\n    \"finished\": null,\r\n    \"status\": \"pending\",\r\n    \"traceback\": \"\"\r\n}\r\n```\r\nActual Results: \r\nthe notification has null started field\r\n```\r\nThe approval node \"approval node MediumResident�\" needs review. This approval node can be viewed at: https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86\r\n\r\n{\r\n    \"id\": 87,\r\n    \"name\": \"approval node MediumResident\\ufffd\",\r\n    \"url\": \"https://ec2-18-212-167-124.compute-1.amazonaws.com/#/workflows/86\",\r\n    \"created_by\": \"apurva\",\r\n    \"started\": null,\r\n    \"finished\": null,\r\n    \"status\": \"pending\",\r\n    \"traceback\": \"\"\r\n}\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nOne of the main deployment information is the tag and/or branch version, or the scm_branch parameter is not available through the job dictionary and so notifications cannot include that common field. Could you please add it to the JOB_FIELDS_WHITELIST  in notifications.yml? thank you.\r\n"},{"labels":["api",null,null,null],"text":" - Feature Idea\r\n\r\nSUMMARY\r\n\r\nAdd a new check box to templates that allows the template to run with if the underlying playbook get's updated. The big advantage of this approach would be we don't need to have a Jenkins job to do this. \r\n\r\nFurthermore if we have 200 Playbooks that we want to trigger with CI/CD we need to create mapping lists or group change sets on Jenkins to be able to identify which playbook to trigger.  Or is there a better way to trigger playbooks that have being change my a commit? \r\n\r\nAs AWX already have the git credentials it could pull the repository and trigger the playbooks that were changed. \r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen trying to use Tower_inventory module to create smart inventory, it fails with server error.\r\n\r\n##### ENVIRONMENT\r\n\r\n    * Tower version: 3.6.2\r\n    * AWX install method: linux using bundle\r\n    * Ansible version: 2.9.1 on Tower, 2.9.2 on my local system from where I run the playbook\r\n    * Operating System: not relevant I believe\r\n    * Web Browser: N/A\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUse following content to create inventory:\r\n```\r\n  - name: Test Inventory - Smart\r\n    organization: Default\r\n    description: created by Ansible Playbook\r\n    state: present\r\n    kind: smart\r\n    host_filter: ansible\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSmart Inventory should be created\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 102, in <module>\r\n  File \"<stdin>\", line 94, in _ansiballz_main\r\n  File \"<stdin>\", line 40, in invoke_module\r\n  File \"/usr/lib64/python2.7/runpy.py\", line 176, in run_module\r\n    fname, loader, pkg_name)\r\n  File \"/usr/lib64/python2.7/runpy.py\", line 82, in _run_module_code\r\n    mod_name, mod_fname, mod_loader, pkg_name)\r\n  File \"/usr/lib64/python2.7/runpy.py\", line 72, in _run_code\r\n    exec code in run_globals\r\n  File \"/tmp/ansible_tower_inventory_payload_Ptt6kB/ansible_tower_inventory_payload.zip/ansible/modules/web_infrastructure/ansible_tower/tower_inventory.py\", line 130, in <module>\r\n  File \"/tmp/ansible_tower_inventory_payload_Ptt6kB/ansible_tower_inventory_payload.zip/ansible/modules/web_infrastructure/ansible_tower/tower_inventory.py\", line 116, in main\r\n  File \"/usr/lib/python2.7/site-packages/tower_cli/models/base.py\", line 720, in modify\r\n    return self.write(pk, create_on_missing=create_on_missing, force_on_exists=True, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/tower_cli/models/base.py\", line 424, in write\r\n    r = getattr(client, method.lower())(url, data=kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/requests/sessions.py\", line 578, in post\r\n    return self.request('POST', url, data=data, json=json, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/tower_cli/api.py\", line 262, in request\r\n    raise exc.ServerError('The Tower server sent back a server error. '\r\ntower_cli.exceptions.ServerError: The Tower server sent back a server error. Please try again later.\r\n\r\nfailed: [dhcp-3-213.vms.sat.rdu2.redhat.com] (item={'name': 'Test Inventory - Smart', 'organization': 'Default', 'description': 'created by Ansible Playbook', 'state': 'present', 'kind': 'smart', 'host_filter': 'ansible'}) => {\r\n    \"ansible_loop_var\": \"item\",\r\n    \"changed\": false,\r\n    \"item\": {\r\n        \"description\": \"created by Ansible Playbook\",\r\n        \"host_filter\": \"ansible\",\r\n        \"kind\": \"smart\",\r\n        \"name\": \"Test Inventory - Smart\",\r\n        \"organization\": \"Default\",\r\n        \"state\": \"present\"\r\n    },\r\n    \"module_stderr\": \"Traceback (most recent call last):\\n  File \\\"<stdin>\\\", line 102, in <module>\\n  File \\\"<stdin>\\\", line 94, in _ansiballz_main\\n  File \\\"<stdin>\\\", line 40, in invoke_module\\n  File \\\"/usr/lib64/python2.7/runpy.py\\\", line 176, in run_module\\n    fname, loader, pkg_name)\\n  File \\\"/usr/lib64/python2.7/runpy.py\\\", line 82, in _run_module_code\\n    mod_name, mod_fname, mod_loader, pkg_name)\\n  File \\\"/usr/lib64/python2.7/runpy.py\\\", line 72, in _run_code\\n    exec code in run_globals\\n  File \\\"/tmp/ansible_tower_inventory_payload_Ptt6kB/ansible_tower_inventory_payload.zip/ansible/modules/web_infrastructure/ansible_tower/tower_inventory.py\\\", line 130, in <module>\\n  File \\\"/tmp/ansible_tower_inventory_payload_Ptt6kB/ansible_tower_inventory_payload.zip/ansible/modules/web_infrastructure/ansible_tower/tower_inventory.py\\\", line 116, in main\\n  File \\\"/usr/lib/python2.7/site-packages/tower_cli/models/base.py\\\", line 720, in modify\\n    return self.write(pk, create_on_missing=create_on_missing, force_on_exists=True, **kwargs)\\n  File \\\"/usr/lib/python2.7/site-packages/tower_cli/models/base.py\\\", line 424, in write\\n    r = getattr(client, method.lower())(url, data=kwargs)\\n  File \\\"/usr/lib/python2.7/site-packages/requests/sessions.py\\\", line 578, in post\\n    return self.request('POST', url, data=data, json=json, **kwargs)\\n  File \\\"/usr/lib/python2.7/site-packages/tower_cli/api.py\\\", line 262, in request\\n    raise exc.ServerError('The Tower server sent back a server error. '\\ntower_cli.exceptions.ServerError: The Tower server sent back a server error. Please try again later.\\n\",\r\n    \"module_stdout\": \"\",\r\n    \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n    \"rc\": 1\r\n}\r\n\r\n```\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe help text for \"PATHS TO EXPOSE TO ISOLATED JOBS\" not mention that lines must be comma-separated.\r\n\r\n##### ENVIRONMENT\r\n*Every AWX versions\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nClick on the interrogation icon of \"PATHS TO EXPOSE TO ISOLATED JOBS\"\r\n\r\n##### EXPECTED RESULTS\r\nText should be:\r\n\r\n> Whitelist of paths that would otherwise be hidden to expose to isolated jobs. \r\nEnter one comma-separated path per line.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nText actually saiys\r\n\r\n> Whitelist of paths that would otherwise be hidden to expose to isolated jobs. Enter one path per line.\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\nask_variables_on_launch is set to true still getting error as undefined variable.\r\n\r\n##### SUMMARY\r\nI have created a Job template via API and set the ask_variables_on_launch value to true. Though setting the value as true, playbook fails during execution, saying 'undefined variable'\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* Tower CLI 3.3.8\r\n* API v2\r\n* AWX install method: Installation without Docker on CentOS7\r\n* Ansible version:  2.9.5\r\n* Operating System: CentOS Linux release 7.7.1908 (Core)\r\n* Web Browser: Google Chrome Version 80.0.3987.132 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n>> Created a Job Template for sample.\r\n>> Verify the values of the sample job template for 'project, inventory, playbook' attributes, and its corresponding values.\r\n>> With the values observed from the sample job template, create a new job template via APIv2 and set the value of \"ask_variables_on_launch to true\" \r\n\r\n* API URL:\r\n* http://awx-server-ip/api/v2/job_templates/\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBeing set the value of 'ask_variables_on_launch' to true, I should be able to execute the playbook by passing extra variable during launch of the playbook and via Survey as well.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\"msg\": \"The task includes an option with an undefined variable. The error was: 'ansible.utils.unsafe_proxy.AnsibleUnsafeText object' has no attribute 'it_user'\\n\\nThe error appears to be in '/tmp/awx_25_ahs6_izp/project/useradd_IT.yml': line 7, column 7, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n  tasks:\\n    - name: Adding users\\n      ^ here\\n\",\r\n    \"_ansible_no_log\": false\r\n\r\n--The same error occurred when the value of 'ask_variables_on_launch' set as false.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![image](https://user-images.githubusercontent.com/47471901/76210019-3d4f2680-6229-11ea-95f8-04dc9ac4f84d.png)\r\n\r\n![image](https://user-images.githubusercontent.com/47471901/76210151-87380c80-6229-11ea-8e8e-2359422c1276.png)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n- Add LDAP inventory source with capability of fine grained control about objects and attributes\r\n- Follow RFC2307bis and implement nested groups\r\n\r\n- Eg. use device or computer objects for hosts and groupOfNames for groups and group memberships\r\n\r\n##### SUMMARY\r\nLeveraging LDAP/Active Directory for device/computer discovery/inventory source\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - There should be a Kerberos Keytab Credential Type that should allow supplying a Kerberos Keytab file\r\n- Authentication to Machines and SCMs could be able via that Keytab (OS independent)\r\n- Access protocols able to handle Kerberos, should be able to utilize a Keytab. Eg. SSH, HTTP, etc..\r\n\r\n##### SUMMARY\r\nAs of today Kerberos authentication is not managed by Ansible or AWX. There is some control through the winrm module, however Kerberos can be used for authentication in general and is agnostic.\r\n\r\nI wish to be able to supply a Keytab for authentication. To access Linux+Windows systems via Keytab and SCMs via Keytab (eg. git+ssh or http://...)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nError Details\r\nTraceback (most recent call last): File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 1275, in run self.pre_run_hook(self.instance, private_data_dir) File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 1879, in pre_run_hook job.project.scm_type, job_revision File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 2271, in make_local_copy copy_tree(project_path, destination_folder) File \"/usr/lib64/python3.6/distutils/dir_util.py\", line 124, in copy_tree \"cannot copy tree '%s': not a directory\" % src) distutils.errors.DistutilsFileError: cannot copy tree '/var/lib/awx/projects/XXX_Project': not a directory \r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: kubernetes\r\n* Kubernetes Cluster - Ansible version:  2.9.5\r\n* Kubernetes Cluster - Operating System: Fedora 31"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\nSmart Inventory Filter\r\n\r\n\r\n##### SUMMARY\r\nIssues building a Smart Inventory with a key that contains a dot(.).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 8.0.0\r\n* AWX  docker\r\n* Ansible version:  2.8.8\r\n* Operating System: CentOS\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGathering services with service_facts module\r\n  - name: populate service facts\r\n    service_facts:\r\n  },\r\n  \"docker.service\": {\r\n   \"name\": \"docker.service\",\r\n   \"state\": \"running\",\r\n   \"source\": \"systemd\",\r\n   \"status\": \"enabled\"\r\n  },\r\n\r\n  - debug:\r\n      var: ansible_facts.services['docker.service'].state\r\n\r\nTASK [debug] *****************************************************************************************************************************************************************************************************\r\nok: [awx] => {\r\n    \"ansible_facts.services['docker.service'].state\": \"running\"\r\n}\r\n\r\nAttempting to build Smart Inventory filter with following on service(s) key that contains a dot(.). \r\nansible_facts.services['docker.service'].state:running\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFunctioning filter.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nFilter not functioning.\r\n\r\n\r\n"},{"labels":[null,"api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n`workflowapproval` job under unified jobs has NULL `started` timestamp, leading to elapsed time 0\r\n\r\nWe need elapsed time in analytics, to be able to subtract the waiting from the real run time.\r\n\r\n![Screenshot from 2020-03-06 12-57-51](https://user-images.githubusercontent.com/1737058/76082182-0cfa5480-5fab-11ea-8513-6fed5bc6911b.png)\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* AWX install method: yolo (devel from 2020-03-05)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd approval step to workflow\r\n\r\n##### EXPECTED RESULTS\r\n\r\nApproval job in unified jobs will have started time and correct elapsed time\r\n\r\n##### ACTUAL RESULTS\r\n\r\nApproval job in unified jobs misses started time and elapsed is 0\r\n\r\n\r\n"},{"labels":[null,"api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWorkflows are not being sent to analytics (nor other types, e.g. workflow approvals)\r\n\r\nWorkflows do not have a record in main_job, therefore the JOIN\r\nwas ignoring those. We need to do LEFT JOIN to include also\r\nworkflows.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSend payload to analytics\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWorkflows and approvals should be part of unified_jobs.csv\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWorkflows and approvals are not part of the unified_jobs.csv\r\n\r\n"},{"labels":[null,"api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIt can take several hours for a job to go from pending to successful/failed state and we need to also send the job with a changed state, otherwise the analytics will be incorrect.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHave a long running job\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAnalytics should have the last state of the job present\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAnalytics has the first state of the snapshot taken (`pending` or `running`)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nIf a Job fails to update its project (or project dependencies) then the error details will show a traceback as error message.\r\n\r\n![grafik](https://user-images.githubusercontent.com/51952982/76071090-fb5a8200-5f95-11ea-8b97-5569540e9446.png)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker\r\n* Ansible version:  2.9.4\r\n* Operating System: Debian 9\r\n* Web Browser: Firefox 69\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Create a Git repo with a roles/requirements.yml\r\n* The requirements.yml should contain a repository which is not accessible (not existent or missing permissions)\r\n* Create a sample playbook (must not do anything, but syntax must be correct)\r\n* Create a Project in AWX and select the Git repo from above as source\r\n* Create a Job Template in AWX and select the AWX project as project. Select the playbook, an inventory\r\n* Run the Job Template\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe job should fail with a meaningful error message. (e.g. \"The project update has failed. See job id 12345 for details.\")\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe job fails with a stack trace.\r\n\r\n```\r\nTraceback (most recent call last):\\n  File \\\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\\\", line 1275, in run\\n    self.pre_run_hook(self.instance, private_data_dir)\\n  File \\\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\\\", line 1858, in pre_run_hook\\n    sync_task.run(local_project_sync.id)\\n  File \\\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\\\", line 698, in _wrapped\\n    return f(self, *args, **kwargs)\\n  File \\\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\\\", line 1440, in run\\n    raise AwxTaskError.TaskError(self.instance, rc)\\nException: project_update 29219 (failed) encountered an error (rc=2), please see task stdout for details.\\n\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\napi/v2/jobs/29218/:\r\n```\r\n{\r\n    \"id\": 29218,\r\n    \"type\": \"job\",\r\n    \"url\": \"/api/v2/jobs/29218/\",\r\n    \"related\": {\r\n        \"created_by\": \"/api/v2/users/2/\",\r\n        \"labels\": \"/api/v2/jobs/29218/labels/\",\r\n        \"inventory\": \"/api/v2/inventories/223/\",\r\n        \"project\": \"/api/v2/projects/560/\",\r\n        \"extra_credentials\": \"/api/v2/jobs/29218/extra_credentials/\",\r\n        \"credentials\": \"/api/v2/jobs/29218/credentials/\",\r\n        \"unified_job_template\": \"/api/v2/job_templates/566/\",\r\n        \"stdout\": \"/api/v2/jobs/29218/stdout/\",\r\n        \"job_events\": \"/api/v2/jobs/29218/job_events/\",\r\n        \"job_host_summaries\": \"/api/v2/jobs/29218/job_host_summaries/\",\r\n        \"activity_stream\": \"/api/v2/jobs/29218/activity_stream/\",\r\n        \"notifications\": \"/api/v2/jobs/29218/notifications/\",\r\n        \"create_schedule\": \"/api/v2/jobs/29218/create_schedule/\",\r\n        \"job_template\": \"/api/v2/job_templates/566/\",\r\n        \"cancel\": \"/api/v2/jobs/29218/cancel/\",\r\n        \"project_update\": \"/api/v2/project_updates/29219/\",\r\n        \"relaunch\": \"/api/v2/jobs/29218/relaunch/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"inventory\": {\r\n            \"id\": 223,\r\n            \"name\": \"nventory\",\r\n            \"description\": \"\",\r\n            \"has_active_failures\": true,\r\n            \"total_hosts\": 12,\r\n            \"hosts_with_active_failures\": 2,\r\n            \"total_groups\": 9,\r\n            \"has_inventory_sources\": true,\r\n            \"total_inventory_sources\": 1,\r\n            \"inventory_sources_with_failures\": 0,\r\n            \"organization_id\": 32,\r\n            \"kind\": \"\"\r\n        },\r\n        \"project\": {\r\n            \"id\": 560,\r\n            \"name\": \"website\",\r\n            \"description\": \"\",\r\n            \"status\": \"successful\",\r\n            \"scm_type\": \"git\"\r\n        },\r\n        \"project_update\": {\r\n            \"id\": 29219,\r\n            \"name\": \"website\",\r\n            \"description\": \"\",\r\n            \"status\": \"failed\",\r\n            \"failed\": true\r\n        },\r\n        \"job_template\": {\r\n            \"id\": 566,\r\n            \"name\": \"Playbook: test.yml\",\r\n            \"description\": \"\"\r\n        },\r\n        \"unified_job_template\": {\r\n            \"id\": 566,\r\n            \"name\": \"Playbook: test.yml\",\r\n            \"description\": \"\",\r\n            \"unified_job_type\": \"job\"\r\n        },\r\n        \"instance_group\": {\r\n            \"id\": 1,\r\n            \"name\": \"tower\",\r\n            \"is_containerized\": false\r\n        },\r\n        \"created_by\": {\r\n            \"id\": 2,\r\n            \"username\": \"foobar\",\r\n            \"first_name\": \"foo\",\r\n            \"last_name\": \"bar\"\r\n        },\r\n        \"user_capabilities\": {\r\n            \"delete\": true,\r\n            \"start\": true\r\n        },\r\n        \"labels\": {\r\n            \"count\": 0,\r\n            \"results\": []\r\n        },\r\n        \"extra_credentials\": [],\r\n        \"credentials\": [\r\n            {\r\n                \"id\": 86,\r\n                \"name\": \"root\",\r\n                \"description\": \"host access after bootstrapping\",\r\n                \"kind\": \"ssh\",\r\n                \"cloud\": false\r\n            }\r\n        ]\r\n    },\r\n    \"created\": \"2020-03-06T08:58:10.932797Z\",\r\n    \"modified\": \"2020-03-06T08:58:11.215703Z\",\r\n    \"name\": \"Playbook: test.yml\",\r\n    \"description\": \"\",\r\n    \"job_type\": \"run\",\r\n    \"inventory\": 223,\r\n    \"project\": 560,\r\n    \"playbook\": \"test.yml\",\r\n    \"scm_branch\": \"\",\r\n    \"forks\": 0,\r\n    \"limit\": \"\",\r\n    \"verbosity\": 0,\r\n    \"extra_vars\": \"{}\",\r\n    \"job_tags\": \"\",\r\n    \"force_handlers\": false,\r\n    \"skip_tags\": \"\",\r\n    \"start_at_task\": \"\",\r\n    \"timeout\": 0,\r\n    \"use_fact_cache\": false,\r\n    \"unified_job_template\": 566,\r\n    \"launch_type\": \"relaunch\",\r\n    \"status\": \"error\",\r\n    \"failed\": true,\r\n    \"started\": \"2020-03-06T08:58:11.324897Z\",\r\n    \"finished\": \"2020-03-06T08:58:16.725877Z\",\r\n    \"canceled_on\": null,\r\n    \"elapsed\": 0.0,\r\n    \"job_args\": \"\",\r\n    \"job_cwd\": \"\",\r\n    \"job_env\": {},\r\n    \"job_explanation\": \"Previous Task Failed: {\\\"job_type\\\": \\\"project_update\\\", \\\"job_name\\\": \\\"website\\\", \\\"job_id\\\": \\\"29219\\\"}\",\r\n    \"execution_node\": \"awx\",\r\n    \"controller_node\": \"\",\r\n    \"result_traceback\": \"Traceback (most recent call last):\\n  File \\\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\\\", line 1275, in run\\n    self.pre_run_hook(self.instance, private_data_dir)\\n  File \\\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\\\", line 1858, in pre_run_hook\\n    sync_task.run(local_project_sync.id)\\n  File \\\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\\\", line 698, in _wrapped\\n    return f(self, *args, **kwargs)\\n  File \\\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\\\", line 1440, in run\\n    raise AwxTaskError.TaskError(self.instance, rc)\\nException: project_update 29219 (failed) encountered an error (rc=2), please see task stdout for details.\\n\",\r\n    \"event_processing_finished\": true,\r\n    \"job_template\": 566,\r\n    \"passwords_needed_to_start\": [],\r\n    \"allow_simultaneous\": false,\r\n    \"artifacts\": {},\r\n    \"scm_revision\": \"\",\r\n    \"instance_group\": 1,\r\n    \"diff_mode\": false,\r\n    \"job_slice_number\": 0,\r\n    \"job_slice_count\": 1,\r\n    \"webhook_service\": \"\",\r\n    \"webhook_credential\": null,\r\n    \"webhook_guid\": \"\",\r\n    \"host_status_counts\": {},\r\n    \"playbook_counts\": {\r\n        \"play_count\": 0,\r\n        \"task_count\": 0\r\n    },\r\n    \"custom_virtualenv\": null\r\n}\r\n```\r\n\r\napi/v2/project_updates/29219/:\r\n```\r\n{\r\n    \"id\": 29219,\r\n    \"type\": \"project_update\",\r\n    \"url\": \"/api/v2/project_updates/29219/\",\r\n    \"related\": {\r\n        \"credential\": \"/api/v2/credentials/122/\",\r\n        \"unified_job_template\": \"/api/v2/projects/560/\",\r\n        \"stdout\": \"/api/v2/project_updates/29219/stdout/\",\r\n        \"project\": \"/api/v2/projects/560/\",\r\n        \"cancel\": \"/api/v2/project_updates/29219/cancel/\",\r\n        \"scm_inventory_updates\": \"/api/v2/project_updates/29219/scm_inventory_updates/\",\r\n        \"notifications\": \"/api/v2/project_updates/29219/notifications/\",\r\n        \"events\": \"/api/v2/project_updates/29219/events/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"project\": {\r\n            \"id\": 560,\r\n            \"name\": \"website\",\r\n            \"description\": \"\",\r\n            \"status\": \"successful\",\r\n            \"scm_type\": \"git\"\r\n        },\r\n        \"credential\": {\r\n            \"id\": 122,\r\n            \"name\": \"website deploy key (ro)\",\r\n            \"description\": \"\",\r\n            \"kind\": \"scm\",\r\n            \"cloud\": false,\r\n            \"kubernetes\": false,\r\n            \"credential_type_id\": 2\r\n        },\r\n        \"unified_job_template\": {\r\n            \"id\": 560,\r\n            \"name\": \"website\",\r\n            \"description\": \"\",\r\n            \"unified_job_type\": \"project_update\"\r\n        },\r\n        \"instance_group\": {\r\n            \"id\": 1,\r\n            \"name\": \"tower\",\r\n            \"is_containerized\": false\r\n        },\r\n        \"user_capabilities\": {\r\n            \"delete\": true,\r\n            \"start\": true\r\n        }\r\n    },\r\n    \"created\": \"2020-03-06T08:58:11.456097Z\",\r\n    \"modified\": \"2020-03-06T08:58:11.456111Z\",\r\n    \"name\": \"website\",\r\n    \"description\": \"\",\r\n    \"local_path\": \"_560__ansible\",\r\n    \"scm_type\": \"git\",\r\n    \"scm_url\": \"...website.git\",\r\n    \"scm_branch\": \"\",\r\n    \"scm_refspec\": \"\",\r\n    \"scm_clean\": true,\r\n    \"scm_delete_on_update\": true,\r\n    \"credential\": 122,\r\n    \"timeout\": 0,\r\n    \"scm_revision\": \"e138ee5b70aece5c25d5a277e5528044fe8b68cc\",\r\n    \"unified_job_template\": 560,\r\n    \"launch_type\": \"sync\",\r\n    \"status\": \"failed\",\r\n    \"failed\": true,\r\n    \"started\": \"2020-03-06T08:58:11.455444Z\",\r\n    \"finished\": \"2020-03-06T08:58:16.690922Z\",\r\n    \"canceled_on\": null,\r\n    \"elapsed\": 5.235,\r\n    \"job_args\": \"[\\\"ansible-playbook\\\", \\\"-t\\\", \\\"install_roles\\\", \\\"-i\\\", \\\"/tmp/awx_29219_jlk1b4l9/inventory/hosts\\\", \\\"-e\\\", \\\"@/tmp/awx_29219_jlk1b4l9/env/extravars\\\", \\\"project_update.yml\\\"]\",\r\n    \"job_cwd\": \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks\",\r\n    \"job_env\": {\r\n        \"LC_ALL\": \"en_US.UTF-8\",\r\n        \"LANG\": \"en_US.UTF-8\",\r\n        \"HOSTNAME\": \"awx-task-a8n\",\r\n        \"PWD\": \"/home/awx\",\r\n        \"HOME\": \"/var/lib/awx\",\r\n        \"SHLVL\": \"2\",\r\n        \"LANGUAGE\": \"en_US.UTF-8\",\r\n        \"PATH\": \"/var/lib/awx/venv/ansible/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\r\n        \"_\": \"/usr/local/bin/supervisord\",\r\n        \"SUPERVISOR_ENABLED\": \"1\",\r\n        \"SUPERVISOR_SERVER_URL\": \"unix:///tmp/supervisor.sock\",\r\n        \"SUPERVISOR_PROCESS_NAME\": \"dispatcher\",\r\n        \"SUPERVISOR_GROUP_NAME\": \"tower-processes\",\r\n        \"LC_CTYPE\": \"en_US.UTF-8\",\r\n        \"DJANGO_SETTINGS_MODULE\": \"awx.settings.production\",\r\n        \"DJANGO_LIVE_TEST_SERVER_ADDRESS\": \"localhost:9013-9199\",\r\n        \"TZ\": \"UTC\",\r\n        \"ANSIBLE_FORCE_COLOR\": \"True\",\r\n        \"ANSIBLE_HOST_KEY_CHECKING\": \"False\",\r\n        \"ANSIBLE_INVENTORY_UNPARSED_FAILED\": \"True\",\r\n        \"ANSIBLE_PARAMIKO_RECORD_HOST_KEYS\": \"False\",\r\n        \"ANSIBLE_VENV_PATH\": \"/var/lib/awx/venv/ansible\",\r\n        \"AWX_PRIVATE_DATA_DIR\": \"/tmp/awx_29219_jlk1b4l9\",\r\n        \"VIRTUAL_ENV\": \"/var/lib/awx/venv/ansible\",\r\n        \"PYTHONPATH\": \"/var/lib/awx/venv/ansible/lib/python3.6/site-packages:\",\r\n        \"ANSIBLE_RETRY_FILES_ENABLED\": \"False\",\r\n        \"ANSIBLE_ASK_PASS\": \"False\",\r\n        \"ANSIBLE_BECOME_ASK_PASS\": \"False\",\r\n        \"DISPLAY\": \"\",\r\n        \"TMP\": \"/tmp\",\r\n        \"PROJECT_UPDATE_ID\": \"29219\",\r\n        \"ANSIBLE_CALLBACK_PLUGINS\": \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/plugins/callback\",\r\n        \"ANSIBLE_GALAXY_SERVER_GALAXY_URL\": \"https://galaxy.ansible.com\",\r\n        \"ANSIBLE_GALAXY_SERVER_LIST\": \"galaxy\",\r\n        \"ANSIBLE_STDOUT_CALLBACK\": \"awx_display\",\r\n        \"AWX_ISOLATED_DATA_DIR\": \"/tmp/awx_29219_jlk1b4l9/artifacts/29219\",\r\n        \"RUNNER_OMIT_EVENTS\": \"False\",\r\n        \"RUNNER_ONLY_FAILED_EVENTS\": \"False\"\r\n    },\r\n    \"job_explanation\": \"\",\r\n    \"execution_node\": \"awx\",\r\n    \"result_traceback\": \"\",\r\n    \"event_processing_finished\": true,\r\n    \"project\": 560,\r\n    \"job_type\": \"run\",\r\n    \"job_tags\": \"install_roles\",\r\n    \"host_status_counts\": {\r\n        \"failures\": 1\r\n    },\r\n    \"playbook_counts\": {\r\n        \"play_count\": 2,\r\n        \"task_count\": 2\r\n    }\r\n}\r\n```\r\napi/v2/project_updates/29219/stdout/?format=txt:\r\n```\r\nPLAY [Update source tree if necessary] *****************************************\r\n\r\nPLAY [Install content with ansible-galaxy command if necessary] ****************\r\n\r\nTASK [detect requirements.yml] *************************************************\r\nok: [localhost]\r\n\r\nTASK [fetch galaxy roles from requirements.yml] ********************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": [\"ansible-galaxy\", \"install\", \"-r\", \"requirements.yml\", \"-p\", \"/tmp/awx_29218_3nyoftwk/requirements_roles\"], \"delta\": \"0:00:00.634267\", \"end\": \"2020-03-06 08:58:16.252183\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2020-03-06 08:58:15.617916\", \"stderr\": \"[WARNING]: - myrole was NOT installed successfully: -\\\\ncommand /usr/bin/git clone git@example.com:myrole.git myrole failed in\\\\ndirectory /var/lib/awx/.ansible/tmp/ansible-local-16920s4fktw85/tmp_q2x71sw\\\\n(rc=128)\\\\nERROR! - you can use --ignore-errors to skip failed roles and finish processing the list.\", \"stderr_lines\": [\"[WARNING]: - myrole was NOT installed successfully: -\", \"command /usr/bin/git clone git@example.com:myrole.git myrole failed in\", \"directory /var/lib/awx/.ansible/tmp/ansible-local-16920s4fktw85/tmp_q2x71sw\", \"(rc=128)\", \"ERROR! - you can use --ignore-errors to skip failed roles and finish processing the list.\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0 \r\n```\r\napi/v2/projects/560/:\r\n```\r\n{\r\n    \"id\": 560,\r\n    \"type\": \"project\",\r\n    \"url\": \"/api/v2/projects/560/\",\r\n    [...]\r\n    \"name\": \"website\",\r\n    \"description\": \"\",\r\n    \"local_path\": \"_560__ansible\",\r\n    \"scm_type\": \"git\",\r\n    \"scm_url\": \"git@example.com:website.git\",\r\n    \"scm_branch\": \"\",\r\n    \"scm_refspec\": \"\",\r\n    \"scm_clean\": true,\r\n    \"scm_delete_on_update\": true,\r\n    \"credential\": 109,\r\n    \"timeout\": 0,\r\n    \"scm_revision\": \"cb76d3c3009f1240bf8ca607bcbea7e019ca6fcf\",\r\n    \"last_job_run\": \"2020-03-06T09:09:15.029262Z\",\r\n    \"last_job_failed\": false,\r\n    \"next_job_run\": null,\r\n    \"status\": \"successful\",\r\n    \"organization\": 32,\r\n    \"scm_update_on_launch\": false,\r\n    \"scm_update_cache_timeout\": 0,\r\n    \"allow_override\": true,\r\n    \"custom_virtualenv\": \"\",\r\n    \"last_update_failed\": false,\r\n    \"last_updated\": \"2020-03-06T09:09:15.029262Z\"\r\n}\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version: \r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Firefox Nightly\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nNavigate to `/api/v2/workflow_job_template_nodes/` and click the `OPTIONS` button. Then search for `verbosity`, the 3rd match is: \r\n```\r\n            \"verbosity\": {\r\n                \"type\": \"choice\",\r\n                \"label\": \"Verbosity\",\r\n                \"filterable\": false,\r\n                \"choices\": [\r\n                    [\r\n                        \"\",\r\n                        \"---------\"\r\n                    ],\r\n                    [\r\n                        0,\r\n                        \"0 (Normal)\"\r\n                    ],\r\n                    [\r\n                        1,\r\n                        \"1 (Verbose)\"\r\n                    ],\r\n                    [\r\n                        2,\r\n                        \"2 (More Verbose)\"\r\n                    ],\r\n                    [\r\n                        3,\r\n                        \"3 (Debug)\"\r\n                    ],\r\n                    [\r\n                        4,\r\n                        \"4 (Connection Debug)\"\r\n                    ],\r\n                    [\r\n                        5,\r\n                        \"5 (WinRM Debug)\"\r\n                    ]\r\n                ]\r\n            },\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe first choice is invalid and shouldnt be there\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSee above"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Unable to run linux playbooks, geting this issue\r\n![image](https://user-images.githubusercontent.com/26820733/75951128-f382db00-5ecc-11ea-9cf7-7f591e0e2835.png)\r\n\r\n\r\n##### SUMMARY\r\nInstalled a new centos 7.7 machine with python 3 as default interpeter \r\n[root@awx awxcompose]# alternatives --config python\r\n\r\nThere are 2 programs which provide 'python'.\r\n\r\n  Selection    Command\r\n-----------------------------------------------\r\n   1           /usr/bin/python2\r\n*+ 2           /usr/bin/python3\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker on linux, \r\n* Ansible version:  2.9.3\r\n* Operating System: Centos 7.7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nusing a ping in a playbook to check connectivity of the host\r\n- hosts: all\r\n  gather_facts: false\r\n  tasks:\r\n    - ping:\r\nwhen i ran the playbook it started giving me the above error, its only doing it with linux machines , windows host connecting with winrm are working.\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUsing a workflow within another workflow, results in `Deleted` Node - when using tower_workflow_template ansible module to create workflows on Ansible Tower.\r\n\r\n##### ENVIRONMENT\r\n\r\n* Tower version: 3.6.2\r\n* AWX install method: linux using bundle\r\n* Ansible version: 2.9.1 on Tower, 2.9.2 on my local system from where I run the playbook\r\n* Operating System: not relevant I believe\r\n* Web Browser: N/A\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUse tower_workflow_template ansible module to create workflow and pass it following data:\r\n```\r\ntower_workflows:\r\n  - name: Test workflow\r\n    description: created by Ansible Playbook\r\n    organization: Default\r\n    survey_enabled: false\r\n    allow_simultaneous: no\r\n    schema:\r\n      - job_template: Demo Job Template\r\n        failure_nodes:\r\n          - job_template: bherring-MR\r\n        success_nodes:\r\n          - workflow_template: Satellite SNAP Build  \r\n            always_nodes:\r\n              - job_template:  Deploy base RHEL 7 box\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSee screenshot below. I ended up with Deleted node in workflow. \r\n\r\n##### ACTUAL RESULTS\r\n\r\n`Deleted` Node in my workflow. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![image](https://user-images.githubusercontent.com/8180469/75922718-9128cc80-5e31-11ea-9aa1-8ffc5f11f7fe.png)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\nIt would be useful to have an external credential able to create a hashicorp vault token type with specified capabilities and ttl.\r\nThis way we can have a master token in AWX and create short lived token to inject in playbook.\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Ansible facts from AWX fact cache are flushed itself for many servers in inventory.\r\n\r\n\r\n##### SUMMARY\r\nWe are using \"ENABLE FACT CACHE\" to cache facts for all servers in AWX inventory.\r\nHowever we noticed twice that facts were no longer present for many servers but available for only few servers and our scheduled job starts failing.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.5\r\n* Operating System: 8.0.1905 (Core)\r\n* Web Browser: N/A\r\n\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\nWe have recently upgraded AWX from 6.1.0 to 9.1.0 and postgres DB from 9.6 to 10.\r\nIt has occurred twice where facts are gone missing for many servers where as cache time out is set to 0.  We gather facts from all servers once in every 24 hours and facts are cached with option \"ENABLE FACT CACHE\". Also we store custom facts once ansible facts are captured.\r\n\r\nUnder Settings --> Job --> PER-HOST ANSIBLE FACT CACHE TIMEOUT is set to 0\r\n\r\nServers on which ansible facts are missing, we can only see \"discovered_interpreter_python = /usr/bin/python\" in fact cache for that host and rest ansible facts were missing.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAnsible facts from Fact Cache should never be flushed by itself.\r\n\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nFacts for many servers missing from fact cache.\r\n\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nbash-4.4# ansible --version\r\nansible 2.8.5\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/home/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\n\r\nbash-4.4# cat /etc/redhat-release\r\nCentOS Linux release 8.0.1905 (Core)\r\nbash-4.4#\r\n\r\n\r\n[root@server ~]# docker ps\r\nCONTAINER ID        IMAGE                        COMMAND                  CREATED             STATUS              PORTS                                                 NAMES\r\nd37406e2d894        ansible/awx_task:9.1.0       \"/tini -- /bin/sh -c…\"   7 weeks ago         Up 12 days          8052/tcp                                              awx_task\r\nce7b6a2059e9        ansible/awx_web:9.1.0        \"/tini -- /bin/sh -c…\"   7 weeks ago         Up 12 days          0.0.0.0:8443->8052/tcp                                awx_web\r\nb03a2c903396        postgres:10                  \"docker-entrypoint.s…\"   7 weeks ago         Up 7 weeks          5432/tcp                                              awx_postgres\r\ne6abe2607a89        proxy                        \"nginx -g 'daemon of…\"   2 months ago        Up 7 weeks          0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp              r_proxy\r\nd476262f278d        memcached:alpine             \"docker-entrypoint.s…\"   4 months ago        Up 7 weeks          11211/tcp                                             awx_memcached\r\nd3e9bb379b81        ansible/awx_rabbitmq:3.7.4   \"docker-entrypoint.s…\"   4 months ago        Up 7 weeks          4369/tcp, 5671-5672/tcp, 15671-15672/tcp, 25672/tcp   awx_rabbitmq"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - AWX Grafana notification is not working\r\n\r\n##### SUMMARY\r\nThe system is not able to send a notification to Grafana. Every time I receiving \"Failed to start\". Logs of awx_task container there are logs likes this:\r\n- test notification\r\n\r\n```\r\n2020-03-03 08:57:05,279 ERROR    awx.main.tasks Send Notification Failed 'started'\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 324, in send_notifications\r\n    sent = notification.notification_template.send(notification.subject, notification.body)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/notifications.py\", line 196, in send\r\n    return backend_obj.send_messages([notification_obj])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/notifications/grafana_backend.py\", line 46, in send_messages\r\n    grafana_data['time'] = int((dp.parse(m.body['started']).replace(tzinfo=None) - epoch).total_seconds() * 1000)\r\nKeyError: 'started'\r\n```\r\n\r\n- notification from job\r\n\r\n```\r\n2020-03-03 09:47:36,134 ERROR    awx.main.tasks Send Notification Failed string indices must be integers\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\", line 324, in send_notifications\r\n    sent = notification.notification_template.send(notification.subject, notification.body)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/notifications.py\", line 196, in send\r\n    return backend_obj.send_messages([notification_obj])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/notifications/grafana_backend.py\", line 46, in send_messages\r\n    grafana_data['time'] = int((dp.parse(m.body['started']).replace(tzinfo=None) - epoch).total_seconds() * 1000)\r\nTypeError: string indices must be integers\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.5\r\n* Operating System: Centos 7.5\r\n* Web Browser: Chrome 79\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Add notification type: Grafana\r\n2. Add URL, API key\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNotification will be send to Grafana\r\n\r\n##### ACTUAL RESULTS\r\n\r\nTEST Grafana: Notification failed.\r\n'started'\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nas above\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen running the vCenter dynamic inventory job to refresh the inventory objects within AWX and error occurs.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.3\r\n* Operating System: RHEL 7.7\r\n* Web Browser: Chrome, Firefox, IE\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWhen running Dynamic inventory job to update the vCenter inventory form our vCenter we are getting job failure.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWe expect the job to finish without issues.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe following error were observed:\r\n```\r\n    1.971 INFO     Updating inventory 3: vCenter-DI\r\n    2.386 DEBUG    Using base command: python /usr/bin/ansible-inventory -i /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py --playbook-dir /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/plugins/inventory -vvvvv\r\n    2.386 INFO     Reading Ansible inventory source: /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py\r\n    2.388 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    2.388 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    2.388 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\n 1580.088 ERROR    ansible-inventory 2.9.3\r\n 1580.088 ERROR      config file = /etc/ansible/ansible.cfg\r\n 1580.088 ERROR      configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n 1580.088 ERROR      ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n 1580.088 ERROR      executable location = /usr/bin/ansible-inventory\r\n 1580.088 ERROR      python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\n 1580.088 ERROR    Using /etc/ansible/ansible.cfg as config file\r\n 1580.088 ERROR    setting up inventory plugins\r\n 1580.088 ERROR    Parsed /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py inventory source with script plugin\r\n 1580.088 ERROR    [WARNING]: No setting was provided for required configuration plugin_type:\r\n 1580.088 ERROR    cache plugin: redis setting: _uri\r\n 1580.088 ERROR    \r\n 1580.788 DEBUG    Finished loading from source: /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py\r\n 1580.788 INFO     Processing JSON output...\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\npsycopg2.errors.UniqueViolation: duplicate key value violates unique constraint \"main_host_name_inventory_id_45aecd68_uniq\"\r\nDETAIL:  Key (name, inventory_id)=(fcebsdbdev01_clone, 3) already exists.\r\nThe above exception was the direct cause of the following exception:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django_pglocks/__init__.py\", line 74, in advisory_lock\r\n    yield acquired\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/utils/pglock.py\", line 14, in advisory_lock\r\n    yield internal_lock\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 898, in load_into_database\r\n    self._create_update_hosts()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 772, in _create_update_hosts\r\n    self._update_db_host_from_mem_host(db_host, mem_host)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 708, in _update_db_host_from_mem_host\r\n    db_host.save(update_fields=update_fields)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/inventory.py\", line 597, in save\r\n    super(Host, self).save(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/base.py\", line 319, in save\r\n    super(PrimordialModel, self).save(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/models/base.py\", line 164, in save\r\n    super(CreatedModifiedModel, self).save(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/base.py\", line 741, in save\r\n    force_update=force_update, update_fields=update_fields)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/base.py\", line 779, in save_base\r\n    force_update, using, update_fields,\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/base.py\", line 851, in _save_table\r\n    forced_update)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/base.py\", line 900, in _do_update\r\n    return filtered._update(values) > 0\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/query.py\", line 760, in _update\r\n    return query.get_compiler(self.db).execute_sql(CURSOR)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/sql/compiler.py\", line 1462, in execute_sql\r\n    cursor = super().execute_sql(result_type)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/models/sql/compiler.py\", line 1133, in execute_sql\r\n    cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 67, in execute\r\n    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 76, in _execute_with_wrappers\r\n    return executor(sql, params, many, context)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/utils.py\", line 89, in __exit__\r\n    raise dj_exc_value.with_traceback(traceback) from exc_value\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\ndjango.db.utils.IntegrityError: duplicate key value violates unique constraint \"main_host_name_inventory_id_45aecd68_uniq\"\r\nDETAIL:  Key (name, inventory_id)=(srv01_clone, 3) already exists.\r\nDuring handling of the above exception, another exception occurred:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1157, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1092, in handle\r\n    self.load_into_database()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 900, in load_into_database\r\n    self._create_update_group_hosts()\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 99, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/utils/pglock.py\", line 14, in advisory_lock\r\n    yield internal_lock\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 99, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django_pglocks/__init__.py\", line 80, in advisory_lock\r\n    cursor.execute(command)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 67, in execute\r\n    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 76, in _execute_with_wrappers\r\n    return executor(sql, params, many, context)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/utils.py\", line 79, in _execute\r\n    self.db.validate_no_broken_transaction()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/db/backends/base/base.py\", line 438, in validate_no_broken_transaction\r\n    \"An error occurred in the current transaction. You can't \"\r\ndjango.db.transaction.TransactionManagementError: An error occurred in the current transaction. You can't execute queries until the end of the 'atomic' block.\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNo additional details were provided by the job output.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n- Instance groups are required to be assigned to the node pool to delegate the ability to assign to other organization objects\r\n- Due to how instance groups fallback for capacity from job template -> inventory -> organizations, any nodes which are out of capacity at any of these levels will inherit all nodes in the organization pool\r\n- If you only add the instance groups to the organization for allowing users to assign to objects, its a counter-intuitive user experience when an instance group becomes unavailable and another is picked up for fallback from the org pool.\r\n- If an instance group has restrictions, such as managing separate external environments, you wouldn't want other instance groups inheriting the jobs as fallback which could cause unnecessary job failures.\r\n\r\nPlease add a new role or change the current to allow instance group assignment without adding the node to the execution pool."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a workflow that looks like this:\r\n\r\n![Screen Shot 2020-02-27 at 9 53 53 PM](https://user-images.githubusercontent.com/1385596/75506344-b342ca80-59ab-11ea-812d-31c05bbc5562.png)\r\n\r\nBut have `TellTelephoneᏤ` just do a simple `fail:` task\r\n\r\nhave `FigureRespond銻` do something trivial that should be successful.\r\n\r\nLaunch that, but do it several times because this is flaky.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nsuccessful JT is always successful\r\n\r\n##### ACTUAL RESULTS\r\n\r\nsometimes successful JT is errored. Logs with relevant error:\r\n\r\n```\r\nawx_1        | 2020-02-28 02:42:25,363 DEBUG    awx.main.dispatch task 32b6d512-214c-4868-9371-d52f58f26eb2 starting awx.main.tasks.RunJob(*[86])\r\nawx_1        | 2020-02-28 02:42:25,385 DEBUG    awx.main.models.mixins No credential configured to post back webhook status, skipping.\r\nawx_1        | 2020-02-28 02:42:25,389 DEBUG    awx.main.dispatch publish awx.main.tasks.RunJob(27b30ad6-9ea1-4f56-8caa-5212b27401ab, queue=awx)\r\nawx_1        | 2020-02-28 02:42:25,428 WARNING  awx.main.dispatch scaling up worker pid:2111\r\nawx_1        | 2020-02-28 02:42:25,440 DEBUG    awx.main.dispatch task 27b30ad6-9ea1-4f56-8caa-5212b27401ab starting awx.main.tasks.RunJob(*[87])\r\nawx_1        | 2020-02-28 02:42:25,530 DEBUG    awx.main.models.mixins No credential configured to post back webhook status, skipping.\r\nawx_1        | 2020-02-28 02:42:25,586 DEBUG    awx.main.models.mixins No credential configured to post back webhook status, skipping.\r\nawx_1        | 2020-02-28 02:42:25,592 DEBUG    awx.main.models.mixins No credential configured to post back webhook status, skipping.\r\nawx_1        | 2020-02-28 02:42:25,713 INFO     awx.main.tasks Skipping project sync for job 84 (running) because commit is locally available\r\nawx_1        | 2020-02-28 02:42:25,751 INFO     awx.main.tasks Skipping project sync for job 85 (running) because commit is locally available\r\nawx_1        | 2020-02-28 02:42:25,759 INFO     awx.main.tasks Skipping project sync for job 86 (running) because commit is locally available\r\nawx_1        | 2020-02-28 02:42:25,941 DEBUG    awx.main.models.mixins No credential configured to post back webhook status, skipping.\r\nawx_1        | 2020-02-28 02:42:26,029 ERROR    awx.main.tasks job 85 (running) Exception occurred while running task\r\nawx_1        | Traceback (most recent call last):\r\nawx_1        |   File \"/awx_devel/awx/main/tasks.py\", line 1275, in run\r\nawx_1        |     self.pre_run_hook(self.instance, private_data_dir)\r\nawx_1        |   File \"/awx_devel/awx/main/tasks.py\", line 1879, in pre_run_hook\r\nawx_1        |     job.project.scm_type, job_revision\r\nawx_1        |   File \"/awx_devel/awx/main/tasks.py\", line 2255, in make_local_copy\r\nawx_1        |     source_branch = git_repo.create_head(tmp_branch_name, scm_revision)\r\nawx_1        |   File \"/venv/awx/lib/python3.6/site-packages/git/repo/base.py\", line 389, in create_head\r\nawx_1        |     return Head.create(self, path, commit, force, logmsg)\r\nawx_1        |   File \"/venv/awx/lib/python3.6/site-packages/git/refs/symbolic.py\", line 546, in create\r\nawx_1        |     return cls._create(repo, path, cls._resolve_ref_on_create, reference, force, logmsg)\r\nawx_1        |   File \"/venv/awx/lib/python3.6/site-packages/git/refs/symbolic.py\", line 513, in _create\r\nawx_1        |     ref.set_reference(target, logmsg)\r\nawx_1        |   File \"/venv/awx/lib/python3.6/site-packages/git/refs/symbolic.py\", line 329, in set_reference\r\nawx_1        |     assure_directory_exists(fpath, is_file=True)\r\nawx_1        |   File \"/venv/awx/lib/python3.6/site-packages/git/util.py\", line 181, in assure_directory_exists\r\nawx_1        |     os.makedirs(path)\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/os.py\", line 220, in makedirs\r\nawx_1        |     mkdir(name, mode)\r\nawx_1        | FileExistsError: [Errno 17] File exists: '/var/lib/awx/projects/_71__project_aspectmatter/.git/refs/heads/awx_internal'\r\nawx_1        | 2020-02-28 02:42:26,069 DEBUG    awx.main.tasks job 85 (running) finished running, producing 0 events.\r\nawx_1        | 2020-02-28 02:42:26,200 INFO     awx.main.tasks Skipping project sync for job 87 (running) because commit is locally available\r\nawx_1        | 2020-02-28 02:42:26,375 DEBUG    awx.main.dispatch publish awx.main.tasks.update_inventory_computed_fields(31bd28db-a87d-4314-8a1c-f46e6088a96d, queue=awx_private_queue)\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n##### COMPONENT NAME\r\n- UI\r\n- API\r\n\r\n##### SUMMARY\r\nI think that can be a good idea add support for Gitea OAuth2 (exactly like GitHub or Google)"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nWe are an international company using Tower for network automation (RH contract).\r\nWe are in the process of pushing all our plays to templates in tower, we want to extensively use the survey feature to let users input data for specific variables. So far so good.\r\n\r\nMore precisely, we want to use survey to have list of dictionnaries as input variable for specific playbooks. However, the only type of survey that can allow that, the textarea, is not processed as YAML. This forces our developers to pretask all those manual playbooks with:\r\n````\r\nset_fact:  user_input_var=\"{{ user_input_var | from_yaml }}\"\r\n````\r\n\r\nThe reason to do so, if I understand correctly, is because the variable is set as:\r\n````\r\nuser_input_var: |-\r\n````\r\nThe hyphen here creates the trouble, as we only need:\r\n````\r\nuser_input_var: |\r\n````\r\n\r\nIf I use the GUI extra var in the template and set it as \"user_input_var: |\" the data is processed as YAML and all is fine, a data structure such as the one below works:\r\n````\r\nuser_input_var: |\r\n  - { key1: val1,\r\n      key2: val2\r\n    }\r\n  - { key1: val3,\r\n      key2: val4\r\n    }\r\n````\r\n=> we would like to suggest the addition of another type of survey:\r\ntextarea (YAML)\r\n\r\nWhere we can input a multiple line YAML variables (a list of dict) the same we do via group_vars or host_vars.\r\nBasically, it is the same as the existing textarea except that it's processed by \"| from_yaml\" so that we can keep the consistency between how ansible works in CLI and via tower (if somehow tower is not reachable when we need it - disaster recovery or else - we want to make sure CLI and GUI works with the same data structure)."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n##### COMPONENT\r\n - UI\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n- Feature request to include integrations for **Total Privileged Access Management** (TPAM) as secret management system with Ansible Tower.\r\n##### STEPS TO REPRODUCE\r\n- No steps needed as it's a feature request.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n@dsesami updated w/ repro steps\r\nPage will crash if viewing Org Permission page in specific scenario.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.next\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Give a user Cred/Inventory/JT/Notification/Project/WF admin permissions (in other words, pretty much full permissions) \r\n2. As this normal user, try to make a new project and try to click the save button. The button did not work and I saw a 400 Bad Request when inspecting the Network tab in devtools. \r\n3. After this, if that same user goes to the Organization page for their org, and checks out the access/permissions tab, the entire page crashes.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nProject saves normally, org access page does not crash.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nProject does not save, org access page crashes."},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAwx seems to not parse properly a path set in vars\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: kubernetes\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nI have a role to add ssh user keys, basically the role is like this:\r\n- name: Add User SSH Keys\r\n  authorized_key:\r\n    user: \"{{ item.name }}\"\r\n    key: \"{{ lookup('file', '{{ item.key_directory }}{{ item.name }}.pub') }}\"\r\n    state: present\r\n  with_items:\r\n  - \"{{ users.accounts }}\"\r\n  when: item.state == \"present\"\r\n\r\nthe var file is like this:\r\nusers:\r\n  home_directory_mask: 27\r\n  groups:\r\n…\r\n…\r\n…\r\n  accounts:\r\n…\r\n…\r\n    - {name: test-automation, uid: 1011, groups: [‘automation’, 'docker'], shell: /bin/bash, key_directory: '{{inventory_dir}}/../shared/public_keys/', state: present }\r\n\r\nwhen i execute a playbook with that role i'm getting this error:\r\n\r\n{\r\n    \"msg\": \"An unhandled exception occurred while running the lookup plugin 'file'. Error was a <class 'ansible.errors.AnsibleError'>, original message: could not locate file in lookup: /var/lib/awx/projects/_6__alan/environments/test/../shared/public_keys/test-automation.pub\",\r\n    \"_ansible_no_log\": false\r\n}\r\n but the file is definitely there and the path is correct; i've double checked on the celery container;\r\n\r\ni have an extra variable set on the template for the inventory_dir var:\r\ninventory_dir: /var/lib/awx/projects/_6__alan/environments/test\r\n\r\n\r\nAny tips?\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nhangs permanently @ fetch galaxy roles from requierements.yml (with 9.0.2 it worked)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker-compose\r\n* Ansible version:  2.9+\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nuse requierements.yml with tower version 9.2.0\r\nto see it failing\r\nuse requierements.yml with tower version 9.0.1\r\nto see it working\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\nawx 9.2.0 (canceld it manually after some waiting):\r\n<a href=\"http://epvpimg.com/V1R1fab\"><img src=\"http://i.epvpimg.com/V1R1fab.png\" alt=\"\" title=\"Hosted by epvpimg.com\" /></a>\r\n\r\nawx 9.0.1 (working):\r\n\r\n<a href=\"http://epvpimg.com/oTkFeab\"><img src=\"http://i.epvpimg.com/oTkFeab.png\" alt=\"\" title=\"Hosted by epvpimg.com\" /></a>\r\n##### ADDITIONAL INFORMATION\r\n\r\nwe use following ansible.cfg it seems in 9.0.1 this parameters where used, in 9.2.0 not:\r\n\r\n```\r\n...\r\n[ssh_connection]\r\nssh_args = -C -o ForwardAgent=yes -o ControlMaster=auto -o ControlPersist=30m -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no\r\n#scp_if_ssh=yes\r\npipelining=True\r\n...\r\n```\r\nin the working version (9.0.1) there i see at the start of project update: \r\n\"Using /etc/ansible/ansible.cfg as config file\"\r\n\r\nin the failing version (9.2.0) there i dont see at the start of project update: \r\n\"Using /etc/ansible/ansible.cfg as config file\" <-- its missing\r\n\r\n\r\nfailing project_update_147.txt (9.2.0):\r\n\r\n<a href=\"http://epvpimg.com/V1R1fab\"><img src=\"http://i.epvpimg.com/V1R1fab.png\" alt=\"\" title=\"Hosted by epvpimg.com\" /></a>\r\n\r\nworking project_update_147.txt (9.0.1):\r\n\r\n```\r\nIdentity added: /tmp/awx_147_8x_k2q1m/artifacts/147/ssh_key_data (/tmp/awx_147_8x_k2q1m/artifacts/147/ssh_key_data)\r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [delete project directory before update] **********************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [update project using git] ************************************************\r\nok: [localhost, -> localhost] => {\"after\": \"46973dd714abf1ab0a6704ac8e6b22f8151ea7d5\", \"before\": \"46973dd714abf1ab0a6704ac8e6b22f8151ea7d5\", \"changed\": false, \"remote_url_changed\": false}\r\n\r\nTASK [Set the git repository version] ******************************************\r\nok: [localhost, -> localhost] => {\"ansible_facts\": {\"scm_version\": \"46973dd714abf1ab0a6704ac8e6b22f8151ea7d5\"}, \"changed\": false}\r\n\r\nTASK [update project using hg] *************************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Set the hg repository version] *******************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [parse hg version string properly] ****************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [update project using svn] ************************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Set the svn repository version] ******************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [parse subversion version string properly] ********************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Ensure the project directory is present] *********************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Fetch Insights Playbook(s)] **********************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Save Insights Version] ***************************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Repository Version] ******************************************************\r\nok: [localhost,] => {\r\n    \"msg\": \"Repository Version 46973dd714abf1ab0a6704ac8e6b22f8151ea7d5\"\r\n}\r\n\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [detect requirements.yml] *************************************************\r\nok: [localhost, -> localhost] => {\"changed\": false, \"stat\": {\"atime\": 1582569541.547898, \"attr_flags\": \"\", \"attributes\": [], \"block_size\": 4096, \"blocks\": 0, \"charset\": \"unknown\", \"ctime\": 1582569541.5438972, \"dev\": 149, \"device_type\": 0, \"executable\": false, \"exists\": true, \"gid\": 0, \"gr_name\": \"root\", \"inode\": 12352972, \"isblk\": false, \"ischr\": false, \"isdir\": false, \"isfifo\": false, \"isgid\": false, \"islnk\": true, \"isreg\": false, \"issock\": false, \"isuid\": false, \"lnk_source\": \"/var/lib/awx/projects/_9__ans_artifactory/roles/requirements.yaml\", \"lnk_target\": \"requirements.yaml\", \"mimetype\": \"unknown\", \"mode\": \"0777\", \"mtime\": 1582569541.5438972, \"nlink\": 1, \"path\": \"/var/lib/awx/projects/_9__ans_artifactory/roles/requirements.yml\", \"pw_name\": \"root\", \"readable\": true, \"rgrp\": true, \"roth\": true, \"rusr\": true, \"size\": 17, \"uid\": 0, \"version\": null, \"wgrp\": true, \"woth\": true, \"writeable\": true, \"wusr\": true, \"xgrp\": true, \"xoth\": true, \"xusr\": true}}\r\n\r\nTASK [fetch galaxy roles from requirements.yml] ********************************\r\nThe authenticity of host 'bitbucket.example.com (10.10.206.103)' can't be established.\r\nRSA key fingerprint is SHA256:Oc3f7WVwBm2oo0etKmv2KypSPe/PedFLDP5Gevle9+Y.\r\nAre you sure you want to continue connecting (yes/no)? \r\nThe authenticity of host 'bitbucket.example.com (10.10.206.103)' can't be established.\r\nRSA key fingerprint is SHA256:Oc3f7WVwBm2oo0etKmv2KypSPe/PedFLDP5Gevle9+Y.\r\nAre you sure you want to continue connecting (yes/no)? \r\nchanged: [localhost, -> localhost] => {\"changed\": true, \"cmd\": [\"ansible-galaxy\", \"install\", \"-r\", \"requirements.yml\", \"-p\", \"/tmp/awx_145_225oubaj/requirements_roles\", \"-v\"], \"delta\": \"0:00:00.918886\", \"end\": \"2020-02-24 18:45:27.626085\", \"rc\": 0, \"start\": \"2020-02-24 18:45:26.707199\", \"stderr\": \"\", \"stderr_lines\": [], \"stdout\": \"Using /etc/ansible/ansible.cfg as config file\\\\n- extracting oeamtc.docker to /tmp/awx_145_225oubaj/requirements_roles/oeamtc.docker\\\\n- oeamtc.docker (master) was installed successfully\\\\n- extracting oeamtc.filer to /tmp/awx_145_225oubaj/requirements_roles/oeamtc.filer\\\\n- oeamtc.filer (master) was installed successfully\", \"stdout_lines\": [\"Using /etc/ansible/ansible.cfg as config file\", \"- extracting oeamtc.docker to /tmp/awx_145_225oubaj/requirements_roles/oeamtc.docker\", \"- oeamtc.docker (master) was installed successfully\", \"- extracting oeamtc.filer to /tmp/awx_145_225oubaj/requirements_roles/oeamtc.filer\", \"- oeamtc.filer (master) was installed successfully\"]}\r\n\r\nTASK [detect collections/requirements.yml] *************************************\r\nok: [localhost, -> localhost] => {\"changed\": false, \"stat\": {\"exists\": false}}\r\n\r\nTASK [fetch galaxy collections from collections/requirements.yml] **************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost,                 : ok=6    changed=1    unreachable=0    failed=0    skipped=11   rescued=0    ignored=0   \r\n\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Provide an option to queue incoming jobs for maintenance, or bleed them off, or kill them off and run them again once maintenance is done.\r\n\r\n##### SUMMARY\r\nProvide some kind of maintenance mode option wherein if we need to rebuild the pod for any reason it doesn't just fail all of the jobs running on the pod. This could be as simple as adding a feature in that takes everything and kills it, but puts it into some kind of not launched job templates area, that way we can have another pod pick up the work and execute it. As playbooks should be idempotent this should just allow for individuals to re-execute the playbook without any problems. Or if we had some kind of option where we stick the pod in maintenance mode, and it just runs all the existing jobs until completion, but then removes itself from available pods once all the jobs are done running, an the pod during that time accepts no new requests for jobs.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - In addition to allowing concurrent jobs to execute, provide an option to have a delay time between actual execution. Also offer an option to throttle a number of concurrent jobs. Only allow 5 jobs to be spawned from this template at any given time.\r\n\r\n##### SUMMARY\r\nThe idea behind this would be to allow a job to execute or run at the same time, however it would force that if 10 requests to the same job came in at the same time, there would be a delay of n seconds before allowing the next job to run, that way none of them are being initiated at the same exact time, however they can execute concurrently.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Add an option on the Template to have it enabled/disabled, this would also control anything that calls into the template i.e. schedules.\r\n\r\n##### SUMMARY\r\nRight now if someone calls into a template externally, there is no way to stop someone from running it. Ideally it would not only be cool to offer an option to either disable or enable a template, but would be cool to have an option to have the template queued for release once the template is no longer disabled. The model might look something like this\r\n\r\nState - enable | disabled - Reject call | disabled - Build queue\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCurrently, there is not an option to pass vault encrypted vars to a job template/workflow  API as extra_vars. Encrypted vars will get interpreted as-is in the job. Placing these vars in the host/group vars of the inventory or within the project/playbook works as expected.\r\n\r\n`Use Case Need`: Passing encrypted vars from Jenkins to the Job Template/Workflow launch API as extra_vars. \r\n\r\n\r\n![Screen Shot 2020-02-21 at 10 54 29](https://user-images.githubusercontent.com/31855206/75049636-903e8500-5498-11ea-82c0-550a295df5f5.png)\r\n\r\n\r\n![Screen Shot 2020-02-21 at 10 44 48](https://user-images.githubusercontent.com/31855206/75049574-70a75c80-5498-11ea-8fc2-b8ad1e05df71.png)\r\n\r\n##### RELATED\r\n[#1992](https://github.com/ansible/awx/issues/1992)\r\n[#2297](https://github.com/ansible/awx/pull/2297)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nSeeing as `/api/v2/jobs/<JOB_ID>/relaunch/` relaunches the job by creating another job with the same _user_ prompts, I think it may be a good idea to add a `/api/v2/jobs/<JOB_ID>/parent/` endpoint.\r\n\r\nThe `/api/v2/jobs/<JOB_ID>/parent/` endpoint would only be valid on jobs that were \"relaunched\" via the API or UI. This would be exceptionally useful, especially in cases where the user may question the environment that was relaunched and its origin (e.g. job auditing).\r\n\r\n**EXAMPLE:**\r\n\r\nORIGIN JOB:\r\n\r\n~~~\r\n{\r\n    \"id\": 1,\r\n    \"type\": \"job\",\r\n    \"url\": \"/api/v2/jobs/1/\",\r\n    \"related\": {\r\n        \"created_by\": \"/api/v2/users/1/\",\r\n        \"labels\": \"/api/v2/jobs/1/labels/\",\r\n        \"inventory\": \"/api/v2/inventories/1/\",\r\n        \"project\": \"/api/v2/projects/6/\",\r\n        \"extra_credentials\": \"/api/v2/jobs/1/extra_credentials/\",\r\n        \"credentials\": \"/api/v2/jobs/1/credentials/\",\r\n        \"unified_job_template\": \"/api/v2/job_templates/7/\",\r\n        \"stdout\": \"/api/v2/jobs/1/stdout/\",\r\n        \"job_events\": \"/api/v2/jobs/1/job_events/\",\r\n        \"job_host_summaries\": \"/api/v2/jobs/1/job_host_summaries/\",\r\n        \"activity_stream\": \"/api/v2/jobs/1/activity_stream/\",\r\n        \"notifications\": \"/api/v2/jobs/1/notifications/\",\r\n        \"create_schedule\": \"/api/v2/jobs/1/create_schedule/\",\r\n        \"job_template\": \"/api/v2/job_templates/7/\",\r\n        \"cancel\": \"/api/v2/jobs/1/cancel/\",\r\n        \"relaunch\": \"/api/v2/jobs/1/relaunch/\"\r\n    }\r\n~~~\r\n\r\nRELAUNCH JOB:\r\n\r\n~~~\r\n{\r\n    \"id\": 92,\r\n    \"type\": \"job\",\r\n    \"url\": \"/api/v2/jobs/92/\",\r\n    \"related\": {\r\n        \"created_by\": \"/api/v2/users/1/\",\r\n        \"labels\": \"/api/v2/jobs/92/labels/\",\r\n        \"inventory\": \"/api/v2/inventories/1/\",\r\n        \"project\": \"/api/v2/projects/36/\",\r\n        \"extra_credentials\": \"/api/v2/jobs/92/extra_credentials/\",\r\n        \"credentials\": \"/api/v2/jobs/92/credentials/\",\r\n        \"stdout\": \"/api/v2/jobs/92/stdout/\",\r\n        \"job_events\": \"/api/v2/jobs/92/job_events/\",\r\n        \"job_host_summaries\": \"/api/v2/jobs/92/job_host_summaries/\",\r\n        \"activity_stream\": \"/api/v2/jobs/92/activity_stream/\",\r\n        \"notifications\": \"/api/v2/jobs/92/notifications/\",\r\n        \"create_schedule\": \"/api/v2/jobs/92/create_schedule/\",\r\n        \"cancel\": \"/api/v2/jobs/92/cancel/\",\r\n        \"parent\": \"/api/v2/jobs/3/\",\r\n        \"relaunch\": \"/api/v2/jobs/92/relaunch/\"\r\n    }\r\n~~~"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe JSON payload received through webhook notifications has a null value for the ``friendly_name`` attribute.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.0\r\n* AWX install method: Kubernetes\r\n* Ansible version:  2.8.5\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Create a WebHook notification\r\n- Configure a job template to call the webhook notification on success / failure\r\n- Run the job template\r\n- Inspect the json payload received through the webhook\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe JSON payload has the value `Job` or `Workflow Job` for the friendly_name attribute\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe JSON payload has a null value for the friendly_name attribute\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nThe primary key for `main_jobevent` (and other event tables) is an `int`, which can only handle _at most_ 2B+ events before overflowing:\r\n\r\nhttps://www.postgresql.org/docs/9.1/datatype-numeric.html\r\n\r\n```\r\ntower=# select max(id) from public.main_jobevent;\r\n   max\r\n------------\r\n2147483647\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun very chatty playbooks very often across very many devices.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n![cady-heron](https://media.giphy.com/media/4zQ5yigKckj5u/giphy.gif)\r\n\r\n##### ACTUAL RESULTS\r\n\r\n![pac-man-bug](https://media.giphy.com/media/DWtn59Up9b5GE/giphy.gif)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen viewing the browsable api via https://mytower.com/api/v2/jobs/, it is incredibly slow and my browser asks me if I want to keep waiting.\r\n\r\nViewing the data raw does not show this slow response, e.g. https://mytower.com/api/v2/jobs/?format=json\r\n\r\nWaited over 2 min and still did not finish loading jobs (less than 100 jobs on tower)\r\n\r\n![slow_browsable_api](https://user-images.githubusercontent.com/29239279/74873296-f0181d00-532c-11ea-811f-52967ee0a0e9.gif)\r\n![browsable_api_timeout](https://user-images.githubusercontent.com/29239279/74873289-edb5c300-532c-11ea-8bf2-9d98c9ba1288.gif)\r\n![Screenshot from 2020-02-19 15-30-56](https://user-images.githubusercontent.com/29239279/74873308-f4dcd100-532c-11ea-9488-22800f2b83f1.png)\r\n\r\n@ryanpetrello mentioned he thinks may just be some ancient javascript lib that is being used that is kneeling under pressure of parsing the json and formatting it/doing highlighting\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nOur AWS infrastructure is IPv6 ready. All machines are IPv6 reachable and can be reached via SSH over IPv6. The ec2.py dynamic inventory does not generate IPv6 hosts. Is this something that can be added in the future or is this planned at some point?"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nRouter ACL Changes -\r\nAnsible playbook Execution – While updating the below Router ACL changes in router, The playbook execution status was changed, but the changes are not replicated in Router and not getting any error message.\r\nPlease find the below changes.\r\nChanges: If the existing rule sequence number is modified for new rule with same sequence number.\r\nManual configuration – while updating the same rule change in manual configuration. I’m getting error message % Duplicate sequence number\r\n\r\n\r\n##### ENVIRONMENT\r\n* Ansible version:  2.8.7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nCurrently in order to use an Azure-RM inventory you have to create an Azure-RM Credential giving it a subscription.  That credential can potentially see many subscriptions though. Then you create an inventory source which refers to that credential.  \r\n\r\nThat inventory source appears to be limited to only looking at the credential's known subscription.  It would be nice if that inventory source could be given a subscription id to limit it to just the given subscription, or no subscription id and would then iterate through all subscriptions known to that ID.  \r\n\r\nI currently have access to 154 subscriptions, this means creating 154 copies of essentially the same credential with different subscription ids, then creating 154 inventory sources, each one linked to one of those credentials.  At the very least linking the inventory sources to an individual subscription would mean I could use one credential for 154 inventory sources.  Alternatively allowing the inventory source to examine all subscriptions would allow me to create one source, one credential, and do any filtering at the inventory level.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - SAML Service Provider Metadata URL return \"Error parsing metadata. xmlParseEntityRef: no name, line 18, column 33 (<string>, line 18)\"\r\n\r\n##### SUMMARY\r\nDo the SAML configuration, save it then try to reach the SAML Service Provider Metadata URL https://XXX/sso/metadata/saml/\r\n\r\nGet an error Error parsing metadata. xmlParseEntityRef: no name, line 18, column 33 (<string>, line 18)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.9.3\r\n* Operating System: centos 7.7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nDo the SAML configuration, generate certificate/ key with openssl for the SP.\r\nTry to reach https://XXX/sso/metadata/saml/\r\n\r\n##### EXPECTED RESULTS\r\n\r\nShow xml metadata file\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError parsing metadata. xmlParseEntityRef: no name, line 18, column 33 (<string>, line 18)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\ndocker logs from awx_web container :\r\n\r\n10.236.241.160 - - [18/Feb/2020:13:13:40 +0000] \"GET /sso/metadata/saml/ HTTP/1.1\" 200 90 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36\" \"-\"\r\n2020-02-18 13:13:40,751 ERROR    awx.sso.views unable to generate SAML metadata\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/onelogin/saml2/metadata.py\", line 252, in add_x509_key_descriptors\r\n    root = OneLogin_Saml2_XML.to_etree(metadata)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/onelogin/saml2/xml_utils.py\", line 68, in to_etree\r\n    return OneLogin_Saml2_XML._parse_etree(compat.to_bytes(xml), forbid_dtd=True)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/defusedxml/lxml.py\", line 145, in fromstring\r\n    rootelement = _etree.fromstring(text, parser, base_url=base_url)\r\n  File \"src/lxml/etree.pyx\", line 3236, in lxml.etree.fromstring\r\n  File \"src/lxml/parser.pxi\", line 1876, in lxml.etree._parseMemoryDocument\r\n  File \"src/lxml/parser.pxi\", line 1764, in lxml.etree._parseDoc\r\n  File \"src/lxml/parser.pxi\", line 1127, in lxml.etree._BaseParser._parseDoc\r\n  File \"src/lxml/parser.pxi\", line 601, in lxml.etree._ParserContext._handleParseResultDoc\r\n  File \"src/lxml/parser.pxi\", line 711, in lxml.etree._handleParseResult\r\n  File \"src/lxml/parser.pxi\", line 640, in lxml.etree._raiseParseError\r\n  File \"<string>\", line 18\r\nlxml.etree.XMLSyntaxError: xmlParseEntityRef: no name, line 18, column 33\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/sso/views.py\", line 67, in get\r\n    metadata, errors = saml_backend.generate_metadata_xml()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/social_core/backends/saml.py\", line 246, in generate_metadata_xml\r\n    metadata = saml_settings.get_sp_metadata()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/onelogin/saml2/settings.py\", line 628, in get_sp_metadata\r\n    metadata = OneLogin_Saml2_Metadata.add_x509_key_descriptors(metadata, cert, add_encryption)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/onelogin/saml2/metadata.py\", line 254, in add_x509_key_descriptors\r\n    raise Exception('Error parsing metadata. ' + str(e))\r\nException: Error parsing metadata. xmlParseEntityRef: no name, line 18, column 33 (<string>, line 18)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nGitHub is deprecating certain types of API authentication:  https://developer.github.com/changes/2019-11-05-deprecated-passwords-and-authorizations-api/#authenticating-using-query-parameters\r\n\r\n> GitHub is deprecating authentication to the GitHub API using query parameters, such as using a access_token query parameter for OAuth user authentication or a client_id/client_secret query parameter for OAuth application authentication. All authentication to the GitHub API should be done using HTTP basic authentication.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n* AWX install method: all\r\n* Ansible version:  all\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAt the very least, we'll need to update to the latest social auth for GitHub SSO logins to continue to work.  See:\r\n\r\nhttps://github.com/python-social-auth/social-core/issues/430\r\nhttps://github.com/python-social-auth/social-core/pull/428\r\n\r\n@jbradberry will this have any side effects for your recent addition of GitHub webhook support?"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen authentication fails awx kit gives a cryptic error message\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* AWX install method: mac\r\n* Ansible version:  2.8.2\r\n* Operating System: mac\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAttempt to login to awx with bad credentials.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n> Unauthorized: Unauthorized (401) received - {'detail': 'Authentication credentials were not provided. To establish a login session, visit /api/login/.'}\r\n\r\n##### ACTUAL RESULTS\r\n\r\n> TypeError: '>=' not supported between instances of 'Unauthorized' and 'int'\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n> akit --base-url httsp://some-awx -c ~/creds/credentials.vault -f load_resources.py -x\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nCannot check out the ansible galxy roles on a project run. Running this locally works. The roles are on a private git server, and the same SSH key that is used to checkout the project is also used to download the roles\r\n\r\nAdditional information: Killing the container **awx-celery** will make it work only the first run only. After that the error bellow from the run log shows up.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: k8s\r\n* Ansible version:  2.9.3\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBeing able to check out the ansible galaxy roles\r\n\r\n##### ACTUAL RESULTS\r\n\r\nHangs indefinitely for a checkout of the ansible galaxy roles.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRun log\r\n```\r\nIdentity added: /tmp/awx_2550_0fu1yi5d/artifacts/2550/ssh_key_data (awx)\r\nansible-playbook 2.9.3\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 3.6.8 (default, Nov 21 2019, 19:31:34) [GCC 8.3.1 20190507 (Red Hat 8.3.1-4)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nhost_list declined parsing /tmp/awx_2550_0fu1yi5d/inventory/hosts as it did not pass its verify_file() method\r\nscript declined parsing /tmp/awx_2550_0fu1yi5d/inventory/hosts as it did not pass its verify_file() method\r\nauto declined parsing /tmp/awx_2550_0fu1yi5d/inventory/hosts as it did not pass its verify_file() method\r\nParsed /tmp/awx_2550_0fu1yi5d/inventory/hosts inventory source with ini plugin\r\nPLAYBOOK: project_update.yml ***************************************************\r\n2 plays in project_update.yml\r\nPLAY [Update source tree if necessary] *****************************************\r\nMETA: ran handlers\r\nMETA: ran handlers\r\nMETA: ran handlers\r\nPLAY [Install content with ansible-galaxy command if necessary] ****************\r\nMETA: ran handlers\r\nTASK [detect requirements.yml] *************************************************\r\ntask path: /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks/project_update.yml:133\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: awx\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~awx && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.0153997-274054373534382 `\" && echo ansible-tmp-1581719618.0153997-274054373534382=\"` echo /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.0153997-274054373534382 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.6/site-packages/ansible/modules/files/stat.py\r\n<127.0.0.1> PUT /var/lib/awx/.ansible/tmp/ansible-local-3zvuarjl6/tmp08hc4g9h TO /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.0153997-274054373534382/AnsiballZ_stat.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.0153997-274054373534382/ /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.0153997-274054373534382/AnsiballZ_stat.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python3.6 /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.0153997-274054373534382/AnsiballZ_stat.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.0153997-274054373534382/ > /dev/null 2>&1 && sleep 0'\r\nok: [localhost] => {\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"checksum_algorithm\": \"sha1\",\r\n            \"follow\": false,\r\n            \"get_attributes\": true,\r\n            \"get_checksum\": true,\r\n            \"get_md5\": false,\r\n            \"get_mime\": true,\r\n            \"path\": \"/var/lib/awx/projects/_8__baseline/roles/requirements.yml\"\r\n        }\r\n    },\r\n    \"stat\": {\r\n        \"atime\": 1581719306.717563,\r\n        \"attr_flags\": \"\",\r\n        \"attributes\": [],\r\n        \"block_size\": 4096,\r\n        \"blocks\": 8,\r\n        \"charset\": \"unknown\",\r\n        \"checksum\": \"873ac04b1592376ef928d565cc2ce5155883d558\",\r\n        \"ctime\": 1581719306.2855692,\r\n        \"dev\": 228,\r\n        \"device_type\": 0,\r\n        \"execu…\r\nTASK [fetch galaxy roles from requirements.yml] ********************************\r\ntask path: /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks/project_update.yml:138\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: awx\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~awx && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.5172336-42218225795671 `\" && echo ansible-tmp-1581719618.5172336-42218225795671=\"` echo /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.5172336-42218225795671 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python3.6/site-packages/ansible/modules/commands/command.py\r\n<127.0.0.1> PUT /var/lib/awx/.ansible/tmp/ansible-local-3zvuarjl6/tmpjax4m5ei TO /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.5172336-42218225795671/AnsiballZ_command.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.5172336-42218225795671/ /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.5172336-42218225795671/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'ANSIBLE_FORCE_COLOR=False /usr/bin/python3.6 /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.5172336-42218225795671/AnsiballZ_command.py && sleep 0'\r\nThe authenticity of host 'git.<redacted>.com (176.9.x.x)' can't be established.\r\nECDSA key fingerprint is SHA256:qPurwghZ7CHDtzfDJ2JfNVfj8LEAnHpprxDy+3P23JY.\r\n```\r\n\r\n**ps -faux**\r\n```\r\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\r\nawx       2645  0.0  0.0  14948  3604 pts/1    Ss   22:40   0:00 /bin/bash\r\nawx       2656  0.0  0.0  49276  3660 pts/1    R+   22:43   0:00  \\_ ps -faux\r\nawx       2657  0.0  0.0   9672  2116 pts/1    S+   22:43   0:00  \\_ less\r\nawx          1  0.0  0.0  37344  4160 ?        Ss   Feb13   0:00 bash /usr/bin/launch_awx_task.sh\r\nawx        132  0.0  0.2 105860 24128 ?        S    Feb13   0:20 /usr/bin/python3.6 /usr/local/bin/supervisord -c /supervisor_task.conf\r\nawx        135  0.0  0.2  83264 17876 ?        S    Feb13   0:00  \\_ python3 /usr/bin/config-watcher\r\nawx        136  0.1  1.8 770312 152220 ?       Sl   Feb13   2:22  \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_dispatcher\r\nawx        160  0.0  0.0      0     0 ?        Z    Feb13   0:35  |   \\_ [awx-manage] <defunct>\r\nawx        161  0.0  1.6 473996 136804 ?       Sl   Feb13   0:41  |   \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_dispatcher\r\nawx        162  0.0  1.6 474252 137220 ?       Sl   Feb13   0:42  |   \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_dispatcher\r\nawx       2578  0.0  0.0  23060  4504 ?        S    22:33   0:00  |   |   \\_ git cat-file --batch-check\r\nroot      2581  0.0  0.0  17652  1264 pts/0    Ss+  22:33   0:00  |   |   \\_ /usr/bin/bwrap --die-with-parent --unshare-pid --dev-bind / / --proc /proc --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmp_twvbhc6 /etc/ssh --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmpr_on7l8s /etc/tower --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmpgbjqe0a0 /tmp --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmpf6a20bcu /var/lib/awx --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmp369ttbmc /var/lib/awx/projects --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmpwl9a_sbj /var/log --ro-bind /var/lib/awx/venv/ansible /var/lib/awx/venv/ansible --ro-bind /var/lib/awx/venv/awx /var/lib/awx/venv/awx --bind /tmp/awx_2547_imikqrpl /tmp/awx_2547_imikqrpl --bind /tmp/awx_2550_0fu1yi5d /tmp/awx_2550_0fu1yi5d --bind /var/lib/awx/projects /var/lib/awx/projects --bind /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks --chdir /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks ssh-agent sh -c ssh-add /tmp/awx_2550_0fu1yi5d/artifacts/2550/ssh_key_data && rm -f /tmp/awx_2550_0fu1yi5d/artifacts/2550/ssh_key_data && ansible-playbook -vvv -t install_roles -i /tmp/awx_2550_0fu1yi5d/inventory/hosts -e @/tmp/awx_2550_0fu1yi5d/env/extravars project_update.yml\r\nawx       2582  0.0  0.0  17748  1316 pts/0    S+   22:33   0:00  |   |       \\_ /usr/bin/bwrap --die-with-parent --unshare-pid --dev-bind / / --proc /proc --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmp_twvbhc6 /etc/ssh --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmpr_on7l8s /etc/tower --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmpgbjqe0a0 /tmp --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmpf6a20bcu /var/lib/awx --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmp369ttbmc /var/lib/awx/projects --bind /tmp/ansible_runner_pi_445pegtp/ansible_runner_pi_rv6c_wj8/tmpwl9a_sbj /var/log --ro-bind /var/lib/awx/venv/ansible /var/lib/awx/venv/ansible --ro-bind /var/lib/awx/venv/awx /var/lib/awx/venv/awx --bind /tmp/awx_2547_imikqrpl /tmp/awx_2547_imikqrpl --bind /tmp/awx_2550_0fu1yi5d /tmp/awx_2550_0fu1yi5d --bind /var/lib/awx/projects /var/lib/awx/projects --bind /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks --chdir /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks ssh-agent sh -c ssh-add /tmp/awx_2550_0fu1yi5d/artifacts/2550/ssh_key_data && rm -f /tmp/awx_2550_0fu1yi5d/artifacts/2550/ssh_key_data && ansible-playbook -vvv -t install_roles -i /tmp/awx_2550_0fu1yi5d/inventory/hosts -e @/tmp/awx_2550_0fu1yi5d/env/extravars project_update.yml\r\nawx       2584  6.5  0.8 388624 70520 pts/0    Sl+  22:33   0:39  |   |           \\_ /usr/bin/python3.6 -s /usr/bin/ansible-playbook -vvv -t install_roles -i /tmp/awx_2550_0fu1yi5d/inventory/hosts -e @/tmp/awx_2550_0fu1yi5d/env/extravars project_update.yml\r\nawx       2585  0.0  0.0  29440   548 ?        Ss   22:33   0:00  |   |               \\_ ssh-agent sh -c ssh-add /tmp/awx_2550_0fu1yi5d/artifacts/2550/ssh_key_data && rm -f /tmp/awx_2550_0fu1yi5d/artifacts/2550/ssh_key_data && ansible-playbook -vvv -t install_roles -i /tmp/awx_2550_0fu1yi5d/inventory/hosts -e @/tmp/awx_2550_0fu1yi5d/env/extravars project_update.yml\r\nawx       2609  0.0  0.7 396804 64140 pts/0    S+   22:33   0:00  |   |               \\_ /usr/bin/python3.6 -s /usr/bin/ansible-playbook -vvv -t install_roles -i /tmp/awx_2550_0fu1yi5d/inventory/hosts -e @/tmp/awx_2550_0fu1yi5d/env/extravars project_update.yml\r\nawx       2618  0.0  0.0  14816  3216 pts/0    S+   22:33   0:00  |   |                   \\_ /bin/sh -c ANSIBLE_FORCE_COLOR=False /usr/bin/python3.6 /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.5172336-42218225795671/AnsiballZ_command.py && sleep 0\r\nawx       2619  0.0  0.2  92212 18136 pts/0    S+   22:33   0:00  |   |                       \\_ /usr/bin/python3.6 /var/lib/awx/.ansible/tmp/ansible-tmp-1581719618.5172336-42218225795671/AnsiballZ_command.py\r\nawx       2620  0.0  0.5 166468 42588 pts/0    S+   22:33   0:00  |   |                           \\_ /usr/bin/python3.6 -s /usr/bin/ansible-galaxy install -r requirements.yml -p /tmp/awx_2547_imikqrpl/requirements_roles -vvv\r\nawx       2624  0.0  0.0  23420  4668 pts/0    S+   22:33   0:00  |   |                               \\_ /usr/bin/git clone git@git.<redacted>.com:msp/ansible/roles/msp.sshd.git msp.sshd\r\nawx       2625  0.0  0.0  48216  6296 pts/0    S+   22:33   0:00  |   |                                   \\_ /usr/bin/ssh git@git.<redacted>.com git-upload-pack 'msp/ansible/roles/msp.sshd.git'\r\nawx        930  0.0  1.7 694040 145176 ?       Sl   21:11   0:04  |   \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_dispatcher\r\nawx       1008  0.0  1.8 762644 149716 ?       Sl   21:12   0:05  |   \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_dispatcher\r\nawx        137  0.0  1.5 605312 125328 ?       Sl   Feb13   0:14  \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_callback_receiver\r\nawx        154  0.1  1.5 389792 125400 ?       Sl   Feb13   2:30  |   \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_callback_receiver\r\nawx        155  0.1  1.5 389512 125264 ?       Sl   Feb13   2:29  |   \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_callback_receiver\r\nawx        156  0.1  1.5 390112 125148 ?       Sl   Feb13   2:29  |   \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_callback_receiver\r\nawx        157  0.1  1.5 389592 125316 ?       Sl   Feb13   2:30  |   \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage run_callback_receiver\r\nawx        138  0.0  1.6 320288 132104 ?       S    Feb13   0:23  \\_ /var/lib/awx/venv/awx/bin/python3 /usr/bin/awx-manage runworker --only-channels websocket.*\r\n```\r\n\r\nansible.cfg\r\n```\r\n[defaults]\r\nhost_key_checking = False\r\ntimeout = 30\r\nremote_tmp = ~/.ansible/tmp\r\nremote_user = root\r\ninterpreter_python = auto_silent\r\nroles_path = ./roles\r\nstrategy = linear\r\n\r\n[ssh_connection]\r\npipelining = yes\r\n```"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.8-1.el7ae.noarch\r\n* Operating System: Red Hat Enterprise Linux\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nInstalling Ansible with it's Playbook: ansible-playbook -i inventory install.yml\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe Install is failing with error msg: \r\nTASK [local_docker : Render SECRET_KEY file] ***************************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [local_docker : Start the containers] *****************************************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"msg\": \"Unable to load docker-compose. Try `pip install docker-compose`. Error: No module named compose\"}\r\n        to retry, use: --limit @/i01/awx/installer/install.retry\r\n\r\nPLAY RECAP *************************************************************************************************************************************************\r\nlocalhost                  : ok=11   changed=0    unreachable=0    failed=1\r\n\r\n[root@installer]#\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nUpdate inventory fails for sourced script, without retry and without an useful message.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.5\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n- Add a job template with an inventory source that uses a script sourced from a project with\r\nthe box \"Update on launch\" ticked\r\n- Run the job template\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nThe inventory should be updated, if not the update should retry for\r\nsome times and display an useful message about the cause of failure.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n- The update inventory job sometimes (1 every 5) fails.\r\n- There is no retry or ignore option, and the job template will fail to start.\r\n- There is no useful indication about the reason of the failure.\r\n- The stdout mentioned is empty or not shown in the web interface, even with the debug verbosity (that is the maximum level of verbosity).\r\n- The useless error message is the following:\r\n\r\n```\r\nTraceback (most recent call last): File\r\n\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\",\r\nline 1243, in run self.pre_run_hook(self.instance, private_data_dir)\r\nFile\r\n\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\",\r\nline 2532, in pre_run_hook sync_task.run(local_project_sync.id) File\r\n\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\",\r\nline 683, in _wrapped return f(self, *args, **kwargs) File\r\n\"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/tasks.py\",\r\nline 1408, in run raise AwxTaskError.TaskError(self.instance, rc)\r\nException: project_update 508 (failed) encountered an error (rc=254),\r\nplease see task stdout for details.\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nThe job template and inventory are custom for a project, but I can\r\ncreate a dummy project to reproduce this bug.  Please give me some\r\npointer on the best practices for integrating a test case."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nRight now if you put many same templates in the job workflow with different parameters, the name of jobs is same in tree and it's hard to figure out which one is which, it would be nice if you could give them some nickname in tree\r\n\r\n<img width=\"456\" alt=\"image\" src=\"https://user-images.githubusercontent.com/1560121/74513120-2a875180-4f0a-11ea-9d69-adbe41845316.png\">\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUser-forwarded traceback:\r\n```\r\n2020-02-13 19:10:29,258 ERROR    awx.main.tasks job 909 (successful) Final run hook errored.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py\", line 1411, in run\r\n    self.final_run_hook(self.instance, status, private_data_dir, fact_modification_times, isolated_manager_instance=isolated_manager_instance)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py\", line 1864, in final_run_hook\r\n    fact_modification_times,\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/models/jobs.py\", line 821, in finish_job_fact_cache\r\n    ansible_local_system_id = ansible_facts.get('ansible_local', {}).get('insights', {}).get('system_id', None)\r\nAttributeError: 'str' object has no attribute 'get'\r\n```\r\n\r\nUser stated they were returning custom windows facts.\r\n\r\nAssumption - this needs bulletproofed against arbitrary data structures in these namespaces.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n"},{"labels":[null,"api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIn order to support workflow analytics on Automation Analytics we need additional data from Tower.    We may need a dump of the workflow relationship table in order to analyze root cause failures.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe special variable \"inventory_dir\" has the wrong value according to the ansible docs.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.8.5\r\n* Operating System: MacOS 10.15.2\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWhen using a project from GIT the inventory_dir is incorrect. \r\nSteps to reproduce:\r\n1. Create a directory inside the root called \"inventory\".\r\n2. Create a directory inside the directory \"inventory\" called \"myTest\"\r\n3. Create an \"inventory.ini\" file inside \"myTest\"\r\n4. Run a playbook against a host defined in inventory.ini\r\n5. Put a file you want to copy to the remote host.\r\n5. if using {{ inventory_dir }}/file_i_want_to_copy.yml awx throws an error \"Could not find or access\".\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAs described in the docs https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html inventory_dir should be filled in with the directory where your host is first defined in the inventory file, in my case /inventory/myTest/ \r\n\r\n##### ACTUAL RESULTS\r\n\r\ninventory_dir points at the root of my project.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWe have a use case from a customer where they want to use Git with Kerberos authentication. We tested the following workaround which is working fine.\r\n\r\n* Manually create a  ticket for the Kerberos user from the awx user on all the Tower nodes.\r\n* Add a project on Tower with the SCM URL.without attaching any cred.\r\n* Disable job isolation and run the project sync.\r\n* The job will use the Kerberos ticket that was manually created for project sync.\r\n\r\nThe issue here is that we need to disable isolation, ticket needs to be created manually on all the nodes. Also we cannot specify a user from the SCM project for which a ticket will be created on the fly. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Allow multiple instances of the same custom credential to be used in the same playbook\r\n##### SUMMARY\r\nCurrently, if we create a generic custom credential named \"REST API Credential\" that injects `api_username` and `api_password` and `api_base_url` into the extravars and/or environment, we can only use that to deal with _one_ API, because there can be only one extravar of `api_username`, etc.\r\n\r\nFor example, I cannot use such a custom credential type to create credentials for ServiceOne and ServiceTwo _and_ work with both in the same playbook. So the only way to manage this is to create a custom credential for ServiceOne and another for ServiceTwo. But then, what if I want to create two ServiceOne credentials for two accounts? Back to the original problem. \r\n\r\nWe should be able to create multiple credentials of the same custom type, and use each of them in the playbooks. Obviously there must be a way to distinguish between them then. I'm sure there is more than one way to model this, but what I wanted to do was this:\r\n\r\n**Input Configuration**\r\n```yaml\r\nfields:\r\n  - type: string\r\n    id: api_username\r\n    label: Username\r\n  - secret: true\r\n    type: string\r\n    id: api_password\r\n    label: Password\r\n  - type: string\r\n    id: api_baseurl\r\n    label: Base URL\r\n  - type: string\r\n    id: prefix\r\n    label: Credential Prefix\r\nrequired:\r\n  - api_username\r\n  - api_password\r\n  - api_baseurl\r\n```\r\n**Injector Configuration**\r\n```yaml\r\nextra_vars:\r\n  \"{{ [prefix, 'api_username'] | join('_') }}\": \"{{ api_username }}\"\r\n  \"{{ [prefix, 'api_password'] | join('_') }}\": \"{{ api_password }}\"\r\n  \"{{ [prefix, 'api_baseurl'] | join('_') }}\": \"{{ api_baseurl }}\"\r\n```\r\nWith a prefix of \"one\", I'd expect to be able to use `one_api_username`, etc... in my playbooks. But of course I can't do that, because injector keys are not evaluated as Jinja2. Or is there a better way to achieve my goals with Credentials?"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI've setup two roles. Role a contains just the templates, role b contains tasks. Role a is a dependency for role b. When I run role b from a playbook of an awx project, I except that a task from inside role b can access templates defined in role a without having to define the path to the template. According to official ansible documentation, this has to work (see https://docs.ansible.com/ansible/2.8/user_guide/playbook_pathing.html). However, in recent awx, it just throws an error that the template couldn't be found.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n* AWX install method: docker on linux (docker-compose)\r\n* Ansible version:  2.8.5\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Google Chrome 79.0.3945.130\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate role a which has the folders meta, tasks and templates. In meta, there is a default main.yml which I use for all my roles (Example below for role b). In tasks, the following main.yml is included:\r\n```yml\r\n- name: debug that role is being executed\r\n  debug:\r\n    msg: \"Role a is being executed\"\r\n```\r\nIn templates, the following template test.j2 is included:\r\n```yml\r\necho {{ foo }} {{ bar }}\r\n```\r\nThen, create role b which contains defaults, meta and tasks. Defaults contains a main.yml with:\r\n```yml\r\nfoo: footext\r\nbar: bartext\r\n```\r\nMeta contains a main.yml with:\r\n```yml\r\n---\r\ngalaxy_info:\r\n  author: <email address>\r\n  description: debug role for github\r\n  company: <company>\r\n  license: \"license (BSD, MIT)\"\r\n  min_ansible_version: 2.8\r\n  platforms:\r\n    - name: Ubuntu\r\n      versions:\r\n        - bionic\r\n  categories:\r\n    - system\r\ndependencies:\r\n  - a\r\n```\r\nNote the dependencies list at the end.\r\nTasks contains the following main.yml:\r\n```yml\r\n- name: template out test.txt\r\n  template:\r\n    src: test.j2\r\n    dest: test.txt\r\n```\r\nAt last, create an awx project which contains a requirements.yml under roles with the git sources in it (as this is trivial, I won't include it here) and a playbook.yml which looks like this:\r\n```yml\r\n- name: debug template search paths\r\n  hosts: all\r\n  remote_user: root\r\n  roles:\r\n    - b\r\n```\r\nNow, add that awx project to your awx instance, create a job template which runs playbook.yml and launch it.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTask from role a should be executed first, then the template from role a should be found correctly by role b and written out to the target machine.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nPLAY [debug template search paths] *********************************************\r\nTASK [Gathering Facts] *********************************************************\r\nok: [redacted]\r\nTASK [a : debug that role is being executed] ***********************************\r\nok: [redacted] => {\r\n    \"msg\": \"Role a is being executed\"\r\n}\r\nTASK [b : template out test.txt] ***********************************************\r\nfatal: [redacted]: FAILED! => {\"changed\": false, \"msg\": \"Could not find or access 'test.j2'\\nSearched in:\\n\\t/tmp/awx_8201_ivl_qi0w/requirements_roles/b/templates/test.j2\\n\\t/tmp/awx_8201_ivl_qi0w    /requirements_roles/b/test.j2\\n\\t/tmp/awx_8201_ivl_qi0w/requirements_roles/b/tasks/templates    /test.j2\\n\\t/tmp/awx_8201_ivl_qi0w/requirements_roles/b/tasks/test.j2\\n\\t/tmp/awx_8201_ivl_qi0w   /project/templates/test.j2\\n\\t/tmp/awx_8201_ivl_qi0w/project/test.j2 on the Ansible Controller.\\nIf    you are using a module and expect the file to exist on the remote, see the remote_src option\"}\r\n```\r\n\r\nAs a workaround, I can point role b directly to the template from role a defining src as ../requirements_roles/a/templates/test.j2 but that's not very nice. Would be good to have this working as advertised. Thanks!\r\nRegards,\r\ndansou901\r\n"},{"labels":["api",null,null,null],"text":"##### SUMMARY\r\nWe're going to add some new behavior to the websocket subscription flow in the API and UI. The goal is to address the \"websocket storm\" issue.\r\n\r\n[details](https://github.com/ansible/awx/pull/5968#issuecomment-591565513)\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\nBug maybe?\r\n##### SUMMARY\r\nMissing information in the WFJT end point re: webhook credentials. JobTemplates end point provides credential type and kind information, but WFJT end point does not provide that info for webhook credentials.  It would be nice to have.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n* AWX install method:  docker for mac\r\n* Ansible version:  2.10\r\n* Operating System: Mojave\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGenerate a workflow JT with a webhook credential.  Go to api gui for that WFJT\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCredential type and credential kind info would be provided.\r\n##### ACTUAL RESULTS\r\n\r\n Credential type and credential kind are not provided at that end point when all the other info for the template is provided.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIn the inventory there are different usernames and passwords stored encrypted for the connections. In the job template a vault credential is provided to decrypt at the job execution. This is not possible for Ad Hoc command. You can only use credential from the kind `Machine`. \r\n\r\nIt would be good to use other credentials types e.g. `Vault` for the Ad Hoc commands, if no key authentication is possible. Command for CLI would be `ansible -m command all -a 'ls /root' --ask-vault-pass`"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nAdd webhook support for [Gitea](https://gitea.io/en-us/)\r\n\r\n##### SUMMARY\r\nIn addition to webhooks for Gitlab and Github, support the Gitea [Webhook](https://docs.gitea.io/en-us/webhooks/) format\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\n![Screenshot_2020-02-05 Ansible Tower templates editWorkflowJobTemplate workflowMaker(2)](https://user-images.githubusercontent.com/1191411/73853830-c8f02480-4831-11ea-9301-eca918a4b709.png)\r\n\r\nCurrent behavior is for node to display the Job Template name. Job Template can be generic enough to be used with different parameters. The current behavior leads to unclear workflow meaning.\r\n\r\nFor example in the above use case the \"Create Github Branch\" as a survey spec with a string where one can specify a repository. With current behavior the Workflow Visuzalizer offer 4 times the same representation. It would benefit user to be able to label node with value they want. In the case above we could have specified in the label the repository we are talking about, making the intent and lecture of the workflow straight forward."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n- Unable to log in to the Tower UI with dummy logging aggregate configuration.\r\n- Unable to log in to tower UI with non-working external logging configuration.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.6.2-1\r\n* AWX install method: linux\r\n* Ansible version:  2.9.1\r\n* Operating System: RHEL 7.7\r\n* Web Browser: Chrome and Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n- Login to ansible tower with superuser/admin user\r\n- Go to `Settings` -> `System` -> `LOGGING`\r\n- Add dummy configuration as follows:\r\n  * LOGGING AGGREGATOR - example.com\r\n  * LOGGING AGGREGATOR - 4000\r\n  * LOGGING AGGREGATOR TYPE - logstash\r\n  * LOGGING AGGREGATOR PROTOCOL - TCP\r\n\r\n- Save the settings (do not test as these are dummy configuration, the test will fail!)\r\n- Tick `ENABLE EXTERNAL LOGGING`\r\n- Save the settings again.\r\n- Logout\r\n- Try logging into ansible tower from another browser or incognito/private mode\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLogin to tower UI should work\r\n\r\n##### ACTUAL RESULTS\r\n\r\nUnable to log in to the ansible tower, noticed below error in `/var/log/tower/tower.log`\r\n~~~\r\n2020-02-05 09:53:21,096 INFO     awx.api.generics User admin logged in from 125.16.200.50\r\n2020-02-05 09:53:37,919 ERROR    awx.main.utils.handlers Error sending message from TCPHandler: 110 Connection timed out\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/utils/handlers.py\", line 228, in _send\r\n    sok.connect((self._get_host(hostname_only=True), self.port or 0))\r\nTimeoutError: [Errno 110] Connection timed out\r\n2020-02-05 09:53:37,924 WARNING  awx.main.commands.run_callback_receiver scaling up worker pid:8566\r\n2020-02-05 09:55:45,151 ERROR    awx.main.utils.handlers Error sending message from TCPHandler: 110 Connection timed out\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/utils/handlers.py\", line 228, in _send\r\n    sok.connect((self._get_host(hostname_only=True), self.port or 0))\r\nTimeoutError: [Errno 110] Connection timed out\r\n2020-02-05 09:55:45,155 WARNING  awx.main.commands.run_callback_receiver scaling up worker pid:8697\r\n~~~\r\n\r\nWe could not pass the login screen. \r\n\r\n![login-screen](https://user-images.githubusercontent.com/11195635/73833601-3dc25f00-4830-11ea-942a-10bf062490ce.png)\r\n\r\nAfter 2-3mins, we see \"Invalid username and/or password. Please try again.\" error even when the credentials are correct.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nChanging `LOG_AGGREGATOR_ENABLED` to `False` might solve the issue but we can't find a way to it, because the UI is not available and API calls are also not working.\r\n\r\nI was using logstash for external logging and one day the logstash was down and came across this issue, \r\nthat is the reason I used dummy information to reproduce this issue."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nUpgraded AWX from 7.0.0 to 9.1.1. \r\nOn previous release I was able to manage Openstack environment using AWX.\r\nIn 9.1.1 inventories in AWX using Openstack as inventory source fails to enumerate/parse.\r\nAlso observed other Openstack specific problems: ansible module os_server behaviour is no longer idempotent - fails in a playbook run if server already exists.\r\n\r\n##### ENVIRONMENT\r\n* AWX 9.1.1\r\n* AWX install method: docker on linux \r\n* Ansible version: 2.8.5\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Chrome Version 79.0.3945.130\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nProvisioned fresh host for AWX install.\r\nDownloaded and Installed AWX 7.0.0 from source https://github.com/ansible/awx/archive/7.0.0.zip\r\n`ansible-playbook -i inventory install.yml`\r\n\r\nAdded valid Openstack credential.\r\nCreated new inventory with source type set to Openstack. Used created credential.\r\nInventory is imported as expected from Openstack\r\n\r\nUpgrade to AWX 9.1.1\r\n\r\n```\r\ndocker rm -f awx_task\r\ndocker rm -f awx_web\r\ndocker rm -f awx_rabbitmq\r\ndocker rm -f awx_memcached\r\ngit clone https://github.com/ansible/awx.git\r\ncd awx/installer\r\nansible-playbook -i inventory install.yml\r\n```\r\nRepeat steps to add inventory \r\nAdd valid Openstack credential.\r\nCreate new inventory with source type set to Openstack. Used created credential.\r\nInventory fails to import.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nExpected same behaviour as with previous versions of AWX\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\nOpenstack Inventories fail to import in AWX 9.1.1\r\nOpenstack Ansible module _os_server_ behaviour is no longer idempotent. If server exists, _os_server_ task in playbook fails instead of returning OK\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\n**Output of inventory import job from AWX** \r\n\r\n```\r\n    4.133 INFO     Updating inventory 2: devzero.edu-openstack-inventory\r\n    5.050 INFO     Reading Ansible inventory source: /tmp/awx_1_xcdosmqu/openstack.yml\r\n    5.057 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    5.057 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    5.057 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 8, in <module>\r\n    sys.exit(manage())\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/__init__.py\", line 152, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1158, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1048, in handle\r\n    venv_path=venv_path, verbosity=self.verbosity).load()\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 215, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 198, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nansible-inventory 2.8.5\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible-inventory\r\n  python version = 3.6.8 (default, Oct  7 2019, 17:58:22) [GCC 8.2.1 20180905 (Red Hat 8.2.1-3)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n [WARNING]:  * Failed to parse /tmp/awx_1_xcdosmqu/openstack.yml with auto\r\nplugin: 'id'\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 268, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/auto.py\", line 58, in parse\r\n    plugin.parse(inventory, loader, path, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/openstack.py\", line 207, in parse\r\n    expand=expand_hostvars, fail_on_cloud_config=fail_on_errors)\r\n  File \"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/inventory.py\", line 68, in list_hosts\r\n    all_projects=all_projects):\r\n  File \"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/_compute.py\", line 346, in list_servers\r\n    bare=bare)\r\n  File \"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/_compute.py\", line 367, in _list_servers\r\n    for server in servers\r\n  File \"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/_compute.py\", line 367, in <listcomp>\r\n    for server in servers\r\n  File \"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/_compute.py\", line 570, in _expand_server\r\n    return meta.get_hostvars_from_server(self, server)\r\n  File \"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/meta.py\", line 487, in get_hostvars_from_server\r\n    flavor_id = server['flavor']['id']\r\n [WARNING]: Unable to parse /tmp/awx_1_xcdosmqu/openstack.yml as an inventory\r\nsource\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n```\r\n**Output of os_server playbook** \r\n\r\n```\r\n{\r\n    \"module_stdout\": \"\",\r\n    \"module_stderr\": \"Traceback (most recent call last):\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1580866261.3807242-193074254864696/AnsiballZ_os_server.py\\\", line 114, in <module>\\n    _ansiballz_main()\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1580866261.3807242-193074254864696/AnsiballZ_os_server.py\\\", line 106, in _ansiballz_main\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1580866261.3807242-193074254864696/AnsiballZ_os_server.py\\\", line 49, in invoke_module\\n    imp.load_module('__main__', mod, module, MOD_DESC)\\n  File \\\"/usr/lib64/python3.6/imp.py\\\", line 235, in load_module\\n    return load_source(name, filename, file)\\n  File \\\"/usr/lib64/python3.6/imp.py\\\", line 170, in load_source\\n    module = _exec(spec, sys.modules[name])\\n  File \\\"<frozen importlib._bootstrap>\\\", line 618, in _exec\\n  File \\\"<frozen importlib._bootstrap_external>\\\", line 678, in exec_module\\n  File \\\"<frozen importlib._bootstrap>\\\", line 219, in _call_with_frames_removed\\n  File \\\"/tmp/ansible_os_server_payload_o8lamfm8/__main__.py\\\", line 753, in <module>\\n  File \\\"/tmp/ansible_os_server_payload_o8lamfm8/__main__.py\\\", line 743, in main\\n  File \\\"/tmp/ansible_os_server_payload_o8lamfm8/__main__.py\\\", line 669, in _get_server_state\\n  File \\\"/tmp/ansible_os_server_payload_o8lamfm8/__main__.py\\\", line 417, in _exit_hostvars\\n  File \\\"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/_compute.py\\\", line 1889, in get_openstack_vars\\n    return meta.get_hostvars_from_server(self, server)\\n  File \\\"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/meta.py\\\", line 487, in get_hostvars_from_server\\n    flavor_id = server['flavor']['id']\\nKeyError: 'id'\\n\",\r\n    \"exception\": \"Traceback (most recent call last):\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1580866261.3807242-193074254864696/AnsiballZ_os_server.py\\\", line 114, in <module>\\n    _ansiballz_main()\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1580866261.3807242-193074254864696/AnsiballZ_os_server.py\\\", line 106, in _ansiballz_main\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1580866261.3807242-193074254864696/AnsiballZ_os_server.py\\\", line 49, in invoke_module\\n    imp.load_module('__main__', mod, module, MOD_DESC)\\n  File \\\"/usr/lib64/python3.6/imp.py\\\", line 235, in load_module\\n    return load_source(name, filename, file)\\n  File \\\"/usr/lib64/python3.6/imp.py\\\", line 170, in load_source\\n    module = _exec(spec, sys.modules[name])\\n  File \\\"<frozen importlib._bootstrap>\\\", line 618, in _exec\\n  File \\\"<frozen importlib._bootstrap_external>\\\", line 678, in exec_module\\n  File \\\"<frozen importlib._bootstrap>\\\", line 219, in _call_with_frames_removed\\n  File \\\"/tmp/ansible_os_server_payload_o8lamfm8/__main__.py\\\", line 753, in <module>\\n  File \\\"/tmp/ansible_os_server_payload_o8lamfm8/__main__.py\\\", line 743, in main\\n  File \\\"/tmp/ansible_os_server_payload_o8lamfm8/__main__.py\\\", line 669, in _get_server_state\\n  File \\\"/tmp/ansible_os_server_payload_o8lamfm8/__main__.py\\\", line 417, in _exit_hostvars\\n  File \\\"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/_compute.py\\\", line 1889, in get_openstack_vars\\n    return meta.get_hostvars_from_server(self, server)\\n  File \\\"/var/lib/awx/venv/ansible/lib/python3.6/site-packages/openstack/cloud/meta.py\\\", line 487, in get_hostvars_from_server\\n    flavor_id = server['flavor']['id']\\nKeyError: 'id'\\n\",\r\n    \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\",\r\n    \"rc\": 1,\r\n    \"_ansible_no_log\": false,\r\n    \"changed\": false\r\n}\r\n\r\n```"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIn Ansible Tower 3.5.x and later versions, when users are added to a team, there is no UI component/option to set users as team admin. However, calling API could still assign users with team admin roles (POST /api/v2/users/id/roles/). \r\n\r\nIs there any option to assign user with team admin role via UI? Is the team admin role deprecated?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.5.1\r\n* AWX install method: High Availability Multi-Machine Cluster\r\n* Ansible version:  2.7.5\r\n* Operating System: RHEL\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Login to Ansible Tower as system admin\r\n2. Goes to Team pages\r\n3. Select a team and open Team details\r\n4. In the User tab, click the button 'Add User' to add a new user into the team\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWhen adding the user, it should be an option to add a user with the team admin role.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo option to add a user with the team admin role\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIn the official user guide of Ansible Tower 3.5.x and later versions ([https://docs.ansible.com/ansible-tower/latest/html/userguide/teams.html#add-a-user](https://docs.ansible.com/ansible-tower/latest/html/userguide/teams.html#add-a-user)), the example picture doesn't show there is an option to add a user with team admin roles. \r\n\r\nHowever, in earlier docs ([https://docs.ansible.com/ansible-tower/3.4.1/html/userguide/teams.html#add-a-user](https://docs.ansible.com/ansible-tower/3.4.1/html/userguide/teams.html#add-a-user)), the example picture still had that option\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIt would be great if individual users could mark some items (such as templates) as favorite, so they wouldn't need to repetitively look for them in template list. Probably applicable for other items than templates as well (inventories, projects)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nHaving a template linked with a project NOT marked for update on launch.\r\n\r\nIf this project have the file ``roles/requirements.yml`` it [is forced](https://github.com/ansible/awx/blob/42c45367a0f70156f9272df57e2aacd36e5935c3/awx/main/tasks.py#L1795) to run the update playbook.\r\n\r\nIn f64d0dde5 were introduced some tags to only do the roles install, avoiding having to update the project (because it is marked not to).\r\n\r\nAt this point, only the [block](https://github.com/ansible/awx/blob/42c45367a0f70156f9272df57e2aacd36e5935c3/awx/playbooks/project_update.yml#L132) to run ``ansible-galaxy`` will be executed, reading the file ``PROJECT_PATH/roles/requirements.yml`` and installing the roles in ``JOB_PRIVATE_DATA_DIR/requirements_roles``.\r\n\r\nThe update job is scheduled.\r\n\r\nThe [run() method](https://github.com/ansible/awx/blob/42c45367a0f70156f9272df57e2aacd36e5935c3/awx/main/tasks.py#L1251) calls the [pre_run_hook() of the RunProjectUpdate task](https://github.com/ansible/awx/blob/42c45367a0f70156f9272df57e2aacd36e5935c3/awx/main/tasks.py#L2204) which tries to adquire a lock for the project folder:\r\n\r\n```python\r\nclass RunProjectUpdate(BaseTask):\r\n    ...\r\n    def pre_run_hook(self, instance, private_data_dir):\r\n        ...\r\n        self.acquire_lock(instance)\r\n```\r\n\r\nThis lock will be a file like ``/var/lib/awx/projects/_1__project_foo205016.lock``, avoiding changes in the project dir while some project update job is running.\r\n\r\nBut this case is not going to modify the project path, only download roles in the tempdir, so I think the lock is unnecessary.\r\n\r\nThe [file pointed](https://github.com/ansible/awx/blob/42c45367a0f70156f9272df57e2aacd36e5935c3/awx/playbooks/project_update.yml#L141) by ``ansible-galaxy`` should be the copy of ``requirements.yml`` in the tempdir, avoding race conditions when the project is updated.\r\n\r\nI am not sure if the copy of the project folder to the tempdir is done after or before the execution of the ``project_update.yml`` playbook.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate project with a roles/requirements.yml file.\r\n\r\nMark the project as not be updated on launch.\r\n\r\nCreate a template linked to that project.\r\n\r\nRun several jobs of that template.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJobs should run concurrently.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nJobs are run sequentially because they are stuck trying to get the lock to run the ``project_update.yml`` template.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: All\r\n* OS version: RHEL\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1. Configure LDAPS in AWX LDAP auth configuration\r\n2. On the server, add all cacerts and intermediaries in `/etc/pki/ca-trust/source/anchors`\r\n3. Update the trust store with: `update-ca-trust`\r\n4. Attempt to authenticate into AWX/Tower\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nLDAPS authentication is successful\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n```\r\n(Can't contact LDAP server\", 'info': 'error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed (unable to get local issuer certificate)'},))\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWorkaround\r\nAdd the django-ldap opt configuration to the AWX/Tower API with a PATCH to `/api/v2/settings/ldap/`\r\n```\r\n{\r\n    \"AUTH_LDAP_1_CONNECTION_OPTIONS\": {\r\n        \"OPT_X_TLS_REQUIRE_CERT\": true,\r\n        \"OPT_X_TLS_CACERTFILE\": \"/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\",\r\n        \"OPT_NETWORK_TIMEOUT\": 30,\r\n        \"OPT_REFERRALS\": 0\r\n    }\r\n}\r\n```\r\n*NOTE: For `OPT_X_TLS_CACERTFILE`, you can set a path to any other cacert bundle. This file needs to be readable by the awx user.\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - Installer\r\n\r\n##### SUMMARY\r\nIn my playbooks I use the command\r\n\r\n```\r\nwhich python\r\n````\r\n\r\nto check, where the python interpreter resides on the machine. In current AWX container (`awx_task`) the `which` command is missing. After adding it manually I checked again and found, that `which` cannot find any `python` binary within the standart $PATH. I need to symlink `/usr/bin/python2.7` to `/usr/bin/python` additionally.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9\r\n* Operating System: CentOS\r\n* Web Browser: n/a\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nInstall AWX and run a playbook containing:\r\n\r\n```\r\n- name: Detect python path\r\n  command: which python\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAnsible finds python in one of the $PATH directories\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n\"msg\": \"Child start failed: [Errno 2] No such file or directory. Command was: /usr/bin/python -c \\\"import codecs,os,sys;_=codecs.decode;exec(_(_(\\\\\\\"[OMITTED]\\\\\\\".encode(),\\\\\\\"base64\\\\\\\"),\\\\\\\"zip\\\\\\\"))\\\"\",\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nn/a\r\n"},{"labels":["api",null,null,null],"text":"Every `conf.settings.__getattr__()` **everywhere** in **every** AWX process incurs a memcached round trip lookup.  This is fine for some use cases (within most HTTP requests), but for things like callback event processing where throughput is very high, these domain socket reads really add up (see: https://github.com/ansible/awx/pull/5762)\r\n\r\nAs an extension to this, every `logger.info()` (or `debug()`, or `error()` or etc...) in AWX's logging implementation does per-log-line `settings.__getattr__()` lookups to determine external logging settings *every time we log a message* (so, it's not usual to do 10+ memcached round trips per log line).\r\n\r\nI'd like to investigate some new ideas for managing in-process setting caching that involve less per-process overhead, especially for the callback receiver, and I'd like to rethink our current approach of cache-based \"pull on demand\"."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\nAdd proxy configuration at project level for SCM.\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nIt could be useful in order to ease the SCM proxy configuration and also in order to support organizations having different proxies."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n\r\nWhen adding jobs to Workflows would be great to add/edit/select the inventory to each step. \r\n\r\nSo if i have a playbook that i can run on 20 inventories i don't have to first create 20 jobs and add them in the workflow, i can just have one job template and add it with the inventory i need 20 times. "},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen trying to change a regular inventory into a \"smart\" inventory, the `PUT` and `PATCH` both error out (as they should), but the error message is not very informative.  Please see screenshots below for both PUT and PATCH errors:\r\n\r\n<img width=\"1048\" alt=\"PUTNotAllowed\" src=\"https://user-images.githubusercontent.com/28930622/72933561-f3b98380-3d2f-11ea-9269-7320367cabb3.png\">\r\n\r\n<img width=\"1033\" alt=\"PATCHNotAllowed\" src=\"https://user-images.githubusercontent.com/28930622/72933566-f6b47400-3d2f-11ea-8540-147b2da53dc8.png\">\r\n\r\nIt would be nice if the error was something more along the lines of `'You cannot turn a regular inventory into a \"smart\" inventory.'`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n* AWX install method: docker for mac\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nNavigate to a pre-existing _regular_ inventory endpoint via `api/v2/inventories/[id]`, then try to `PUT` or `PATCH` to try to make it into a \"smart\" inventory:\r\n\r\n```\r\n{\r\n    \"name\": \"[inventory_name]\",\r\n    \"description\": \"\",\r\n    \"organization\": [inventory_id],\r\n    \"kind\": \"smart\",\r\n    \"host_filter\": null,\r\n    \"variables\": \"\",\r\n    \"insights_credential\": null\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAn error message that tells the user that a regular inventory can't be turned into a smart inventory.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n{\r\n    \"detail\": \"Method \\\"PATCH\\\" not allowed.\"\r\n}\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAllow the user to define the field in the JSON response to be used for the username and password values.  This is a unique scenario to object types that do not map to the standard Content and UserName fields (like a cloud service).  For example, I want the value of Content for the password and the value of AWSAccessKeyID as the username from the below:\r\n\r\n```\r\n{\r\n  \"Content\": \"****************************************\",\r\n  \"Name\": \"Cloud Service-svc-cyberark-np1\",\r\n  \"CreationMethod\": \"PVWA\",\r\n  \"SequenceID\": \"1\",\r\n  \"LastTask\": \"VerifyTask\",\r\n  \"CPMStatus\": \"success\",\r\n  \"Folder\": \"Root\",\r\n  \"Safe\": \"Ansible_Tower_Test\",\r\n  \"LastSuccessVerification\": \"1579694399\",\r\n  \"AWSAccessKeyID\": \"AKIA****************\",\r\n  \"DeviceType\": \"Cloud Service\",\r\n  \"RetriesCount\": \"-1\",\r\n  \"LastSuccessChange\": \"1579558784\",\r\n  \"UserName\": \"svc-cyberark\",\r\n  \"PasswordChangeInProcess\": \"False\"\r\n}\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nCurrently the only way to assign a team to a credential not in their Org is to temporarily assign that credential to the Org to which the team belongs, then remove the Org after adding a team. \r\nIt would be beneficial to allow superusers and org admins(assuming they've got permissions to both orgs) the ability to assign a team to a credential owned by a different organization.\r\n"},{"labels":["api",null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWe have a bearer token credential type that is used for the container group feature.\r\n\r\nThere does not appear to be a reason it cannot be used for general playbook runs.\r\n\r\nThe `k8s` ansible module accepts `K8S_AUTH_HOST` and `K8S_AUTH_API_KEY` env vars. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nImplementation of Ansible's vmware_vm_inventory plugin.\r\n\r\nI have noticed there is an 'Implement me' here: https://github.com/ansible/awx/blob/6d075b8874e7a352596b7b23caea1ce96db237b9/awx/main/models/inventory.py#L2234\r\n\r\nIs there any in-progress plans to implement this plugin?\r\n\r\nI've been using the existing inventory script and have found issues with support for grouping by tags and it is quite slow for large inventories. vmware_vm_inventory has work in progress to improve performance (https://github.com/ansible/ansible/issues/56786) and includes tagging functionality already.\r\n\r\nI'd be willing to have a look at this myself but didn't want to double up on any WIP."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\nMachine credentials are not available in environment variables during execution of a job template.\r\n\r\n##### SUMMARY\r\nCurrently, all credential types expose their details in environment variables during execution of play's in a job template, except for machine credentials. However, there is a common workflow that would greatly benefit from them. This is the workflow of creating a VM using ansible in VMware, Azure, Google Cloud, etc. Each of these 'clouds' have some way of specifying an initial (admin) user to be created inside the VM. It would be great if we can then specify the username and password from a machine credential to these cloud modules so we can, in later job templates use the same credential to execute plays inside these VM's.\r\n\r\nThis is currently not possible. The only workaround I found was to put the same details of the machine credential in a vault and put the vault credential on the job template that creates the VM, exposing the vault and thus the details in the play.\r\n\r\nI propose to make the machine credentials available as environment varaibles during execution of the playbook of the job template to solve this. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThe schema change job has been failing with this error:\r\n\r\n```\r\n                                \"# Ignore differences in whitespace with -b\",\r\n                                \"diff -u -b reference-schema.json schema.json\",\r\n                                \"make: diff: Command not found\",\r\n                                \"make: *** [Makefile:672: detect-schema-change] Error 127\",\r\n                                \"command terminated with exit code 2\"\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nThis check runs on all PRs...need to fix how the container is built to include `diff`"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAWX v9.1.1 is running ansible v2.8.5 while v2.9.4 has been released.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.5\r\n* Operating System: Ubuntu 18\r\n* Web Browser: Unrelated\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI installed AWX using the install steps for docker.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected to get the latest ansible version.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nGot an old ansible version.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI need a newer version of Ansible because i'm using the `aws_caller_info` module because the `aws_caller_facts` module is deprecated in favor of the `aws_caller_info` module."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAWX ships analytics from every node in a cluster due to the fact that it is run as a celery beat task and celery beat runs on every node in a cluster.    This causes duplicate data to be processed by Automation Analytics.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nBuild a cluster.  Configure automation analytics.   Look at logging on each node.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nOnly one node should ship analytics. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nAll nodes ship analytics. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nawx cli schedules create cannot create schedule if the user is of type Normal User with required permissions on the object or even with Organization admin role. Currently the user needs to be a System Administrator type to create the schedule. From the UI the Normal User with permission can create the schedule. \r\n\r\nPOST at the /api/v2/schedules/ endpoint is only available for the user with System Administrator type which is the endpoint used by awx schedules create command. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: Tower 3.6.2\r\n* AWX install method: Tower 3.6.2 cluster installed with online installer\r\n* Ansible version:  2.9.1\r\n* Operating System: RHEL 8\r\n* Web Browser: Chrome 79\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Create a normal user:\r\n* Assign permission to a job template or set the user role as Organization admin.\r\n* Try to create the schedule for the job template using awx cli.\r\n\r\n```\r\nawx --conf.host https://tower.ishwar.io --conf.username test --conf.password 'PASSWORD' schedules create --name=test --unified_job_template=111 --rrule=\"DTSTART;TZID=America/New_York:20180208T221500 RRULE:FREQ=MONTHLY;INTERVAL=1;BYDAY=TH;BYSETPOS=3\" -vvv\r\n```\r\n* Change the user type to system administrator and rerun the command. \r\n\r\n##### EXPECTED RESULTS\r\n\r\n```\r\nDEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): tower.ishwar.io:443\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/ HTTP/1.1\" 200 188\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/\" elapsed: 0:00:00.208793\r\nDEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.api.ApiV2'> by url: /api/v2/\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/v2/ HTTP/1.1\" 200 1688\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/v2/\" elapsed: 0:00:00.047443\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/ HTTP/1.1\" 200 188\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/\" elapsed: 0:00:00.052170\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"POST /api/login/ HTTP/1.1\" 302 0\r\nDEBUG:awxkit.api.client:\"POST https://tower.ishwar.io/api/login/\" elapsed: 0:00:00.247407\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/ HTTP/1.1\" 200 188\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/\" elapsed: 0:00:00.080558\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/ HTTP/1.1\" 200 188\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/\" elapsed: 0:00:00.084587\r\nDEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"OPTIONS /api/v2/schedules/ HTTP/1.1\" 200 13449\r\nDEBUG:awxkit.api.client:\"OPTIONS https://tower.ishwar.io/api/v2/schedules/\" elapsed: 0:00:00.101736\r\nDEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"OPTIONS /api/v2/schedules/1/ HTTP/1.1\" 200 7915\r\nDEBUG:awxkit.api.client:\"OPTIONS https://tower.ishwar.io/api/v2/schedules/1/\" elapsed: 0:00:00.120726\r\nawx: unrecognized arguments: -vvv\r\nDEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"POST /api/v2/schedules/ HTTP/1.1\" 201 1552\r\nDEBUG:awxkit.api.client:\"POST https://tower.ishwar.io/api/v2/schedules/\" elapsed: 0:00:00.156802\r\nDEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/\r\n{\r\n     \"rrule\": \"DTSTART;TZID=America/New_York:20180208T221500 RRULE:FREQ=MONTHLY;INTERVAL=1;BYDAY=TH;BYSETPOS=3\",\r\n     \"id\": 14,\r\n     \"type\": \"schedule\",\r\n     \"url\": \"/api/v2/schedules/14/\",\r\n     \"summary_fields\": {\r\n          \"unified_job_template\": {\r\n               \"id\": 111,\r\n               \"name\": \"test-schedule\",\r\n               \"description\": \"\",\r\n               \"unified_job_type\": \"job\"\r\n          },\r\n          \"created_by\": {\r\n               \"id\": 121,\r\n               \"username\": \"test\",\r\n               \"first_name\": \"test\",\r\n               \"last_name\": \"test\"\r\n          },\r\n          \"modified_by\": {\r\n               \"id\": 121,\r\n               \"username\": \"test\",\r\n               \"first_name\": \"test\",\r\n               \"last_name\": \"test\"\r\n          },\r\n          \"user_capabilities\": {\r\n               \"edit\": true,\r\n               \"delete\": true\r\n          },\r\n          \"inventory\": {\r\n               \"id\": 29,\r\n               \"name\": \"Demo Inventory\",\r\n               \"description\": \"\",\r\n               \"has_active_failures\": false,\r\n               \"total_hosts\": 1,\r\n               \"hosts_with_active_failures\": 0,\r\n               \"total_groups\": 0,\r\n               \"groups_with_active_failures\": 0,\r\n               \"has_inventory_sources\": false,\r\n               \"total_inventory_sources\": 0,\r\n               \"inventory_sources_with_failures\": 0,\r\n               \"organization_id\": 1,\r\n               \"kind\": \"\",\r\n               \"insights_credential_id\": null\r\n          }\r\n     },\r\n     \"created\": \"2020-01-21T07:31:19.312383Z\",\r\n     \"modified\": \"2020-01-21T07:31:19.312398Z\",\r\n     \"name\": \"test\",\r\n     \"description\": \"\",\r\n     \"extra_data\": {},\r\n     \"inventory\": null,\r\n     \"scm_branch\": null,\r\n     \"job_type\": null,\r\n     \"job_tags\": null,\r\n     \"skip_tags\": null,\r\n     \"limit\": null,\r\n     \"diff_mode\": null,\r\n     \"verbosity\": null,\r\n     \"unified_job_template\": 111,\r\n     \"enabled\": true,\r\n     \"dtstart\": \"2018-02-16T03:15:00Z\",\r\n     \"dtend\": null,\r\n     \"next_run\": \"2020-02-21T03:15:00Z\",\r\n     \"timezone\": \"America/New_York\",\r\n     \"until\": \"\"\r\n}\r\n\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nDEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): tower.ishwar.io:443\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/ HTTP/1.1\" 200 188\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/\" elapsed: 0:00:00.173558\r\nDEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.api.ApiV2'> by url: /api/v2/\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/v2/ HTTP/1.1\" 200 1688\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/v2/\" elapsed: 0:00:00.046141\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/ HTTP/1.1\" 200 188\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/\" elapsed: 0:00:00.050566\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"POST /api/login/ HTTP/1.1\" 302 0\r\nDEBUG:awxkit.api.client:\"POST https://tower.ishwar.io/api/login/\" elapsed: 0:00:00.247518\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/ HTTP/1.1\" 200 188\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/\" elapsed: 0:00:00.088723\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"GET /api/ HTTP/1.1\" 200 188\r\nDEBUG:awxkit.api.client:\"GET https://tower.ishwar.io/api/\" elapsed: 0:00:00.081436\r\nDEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"OPTIONS /api/v2/schedules/ HTTP/1.1\" 200 11598\r\nDEBUG:awxkit.api.client:\"OPTIONS https://tower.ishwar.io/api/v2/schedules/\" elapsed: 0:00:00.088985\r\nDEBUG:awxkit.api.registry:Retrieved <class 'awxkit.api.pages.schedules.Schedules'> by url: /api/v2/schedules/\r\nDEBUG:urllib3.connectionpool:https://tower.ishwar.io:443 \"OPTIONS /api/v2/schedules/1/ HTTP/1.1\" 200 6065\r\nDEBUG:awxkit.api.client:\"OPTIONS https://tower.ishwar.io/api/v2/schedules/1/\" elapsed: 0:00:00.112443\r\nusage: awx schedules [-h] action ...\r\n\r\npositional arguments:\r\n  action\r\n    list\r\n    get\r\n    modify\r\n    delete\r\n\r\noptional arguments:\r\n  -h, --help  show this help message and exit\r\n\r\nawx schedules: argument action: invalid choice: 'create' (choose from 'list', 'get', 'modify', 'delete')\r\n```"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n- Calculate job success/failure based on collective host status in playbook run\r\n- Create a check box in job template UI to mark \"partial failures\"\r\n- Input pane to set number of hosts as an upper limit required to fail for determining \"Failed\" or \"Partially Failed\" job status"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAllow for users with admin on a job template to select from a predetermined list of instance groups. This would allow for the reuse of job templates and reduce the need for redundant job templates."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAWX ships analytics bundle multiple times per upload window. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.10.0.dev0 \r\n* Operating System: Red Hat Enterprise Linux Server release 7.7 (Maipo) \r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a clustered environment.   Enable debug logging.  Wait for an upload window (*/6 hour)\r\n\r\n> tail -n 10000 -f tower.log | grep 'shipping analytics file'\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA single bundle upload.\r\n\r\n-bash-4.2$ tail -n 10000 -f tower.log | grep 'shipping analytics file'\r\n2020-01-20 18:00:00,875 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180000+0000.tar.gz\r\n\r\n##### ACTUAL RESULTS\r\n\r\nMultiple bundles are uploaded with the same data.    It seems to be uploading every minute for an hour ever 4 hours.   It is sending 60 times more uploads than required. \r\n\r\n> -bash-4.2$ tail -n 10000 -f tower.log | grep 'shipping analytics file'\r\n> 2020-01-20 18:00:00,875 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180000+0000.tar.gz\r\n> 2020-01-20 18:01:00,568 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180100+0000.tar.gz\r\n> 2020-01-20 18:02:00,673 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180200+0000.tar.gz\r\n> 2020-01-20 18:03:00,575 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180300+0000.tar.gz\r\n> 2020-01-20 18:04:00,689 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180400+0000.tar.gz\r\n> 2020-01-20 18:05:00,549 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180500+0000.tar.gz\r\n> 2020-01-20 18:06:00,681 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180600+0000.tar.gz\r\n> 2020-01-20 18:07:00,567 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180700+0000.tar.gz\r\n> 2020-01-20 18:08:00,587 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180800+0000.tar.gz\r\n> 2020-01-20 18:09:00,683 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-180900+0000.tar.gz\r\n> 2020-01-20 18:10:00,614 DEBUG    awx.main.analytics shipping analytics file: /tmp/2afc1cba-4f00-4346-bb8b-a0a70c65aec1_2020-01-20-181000+0000.tar.gz\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe are using AWX 9.1.1\r\nWe defined a project named : DEPLOY_DEV\r\nfor this project, we allowed branch override, and we have not specified any branch.\r\n\r\nWe defined a job template : DEPLOY_DEV_AUTO\r\nthis job template ask for branch on launch, which will point to the branch SCM where we have our playbook and our inventory.\r\n\r\nWe defined an invenotry named: INVENTORY_DEV\r\nthis inventory is supposed to point to the same branch SCM as job template on run.\r\n\r\nExpected Behaviour : \r\nWhen we launch a job based on job template DEPLOY_DEV_AUTO and specify branch \"V1\" , DEPLOY_DEV and INVENTORY_DEV should be synchronized with branch \"V1\", then the job is launched\r\n\r\nActual Behaviour : \r\nWhen we launch a job based on job template DEPLOY_DEV_AUTO and specify branch \"V1\" , DEPLOY_DEV is synchronized with branch \"V1\",INVENTORY_DEV is synchronized with \"master\" (since the field branch in project is empty) . it fails, which is normal since it's looking for inventory in master branch.\r\nWe don't want to put anything in branch field for project since we have a new branch for every job, so a new inventory and a new playbook.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.1\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nAfter removing variables from the original SCM project they will still be present in the inventory variables.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 9.1.0\r\n* AWX install method: rpm\r\n* Ansible version:  2.9.2\r\n* Operating System: Centos 7,7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate an SCM project, create an inventory sourced in that project (update options for the source: overwrite, overwrite variables, update on project update are checked).\r\n\r\nDefine few variables in group_vars/all.yml file.\r\nupdate the project, sync the inventory. Variable is in the Details pane, under Variables. \r\n\r\nDelete one variable from group_vars/all.yml file in the SCM.\r\nUpdate the project, sync the inventory. \r\n\r\n##### EXPECTED RESULTS\r\n\r\nVariable is not defined anymore. Should not be in Details pane, under Variables.\r\nAny play run against the playbook should not have access to the variable.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nVariable is still there in Details pane, under Variables.\r\nAny play run against the playbook still has access to the variable.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCustomer would like the ability to limit the amount of manually launched jobs or forks, similar to the limit of scheduled jobs. "},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nErrors resulting in failed Tower services should be discernible in the UI. Currently both playbook failures and failures as a result of AWX/Tower service failures both show a red circle with a white exclamation mark.\r\n\r\nA different visual cue or indicator for playbook vs service failures would help administrators prioritize which issues to look into first. We would also like to see specific failures outlined in the cues that are discernible from a top down level.\r\n\r\nFor example, jobs failed as a result of a project update, inventory update, or service failure should all have different visual cues on the UI. From the \"jobs\" page, you could then see if the job failed based on one of those three categories by looking at the status marker rather than having to click into each job to verify."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\nThe `started` field for ~running jobs~ **edit:** newly launched jobs  is `null`. This field is needed in order to compute and show an accurate playbook run time while the job is running.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n500 server error when deleting token. First observed when QE test `tests.api.auth.test_application_tokens.TestApplicationTokens.test_delete_token[True]` failed. From the stack trace; this is the problem area https://github.com/ansible/awx/blob/devel/awx/main/models/oauth.py#L124\r\n\r\nI'm not sure why there is an exists check right before the save(). If it's to prevent a race condition, it only narrows the window. A delete can still happen between the exists and the save.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\ntower.log\r\n```\r\n2020-01-10 16:51:08,402 ERROR    django.request Internal Server Error: /api/v2/tokens/5/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 115, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 113, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n    return func(*args, **kwds)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/transaction.py\", line 284, in __exit__\r\n    connection.set_autocommit(True)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 410, in set_autocommit\r\n    self.run_and_clear_commit_hooks()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 636, in run_and_clear_commit_hooks\r\n    func()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/models/oauth.py\", line 124, in <lambda>\r\n    connection.on_commit(lambda: self.save(update_fields=['last_used']))\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/models/oauth.py\", line 134, in save\r\n    super(OAuth2AccessToken, self).save(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/base.py\", line 741, in save\r\n    force_update=force_update, update_fields=update_fields)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/base.py\", line 779, in save_base\r\n    force_update, using, update_fields,\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/base.py\", line 855, in _save_table\r\n    raise DatabaseError(\"Save with update_fields did not affect any rows.\")\r\ndjango.db.utils.DatabaseError: Save with update_fields did not affect any rows.\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nRight now the recipient of notifications is set on the notification template, and can not be modified at launch time. \r\n\r\nInstead, make it so that the: \r\n- notification recipient can be set on launch, perhaps w/ default\r\n- Consider for email letting it be \"user who launched job\" as we have emails associated w/ users"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nJob remains in pending, In the log I see a lot of \"awx.main.tasks Not running scheduler, another task holds lock\" \r\n\r\nThere are some closed issues regarding this one, but didn't find any solution.\r\n\r\nRandomly AWX get stuck where all jobs remain in \"pending\"\r\n\r\nIn the logs I see \r\n`task_1       | 2020-01-09 16:08:59,344 DEBUG    awx.main.dispatch task a1c42d7f-17b2-4590-b013-b82f76105f0c starting awx.main.scheduler.tasks.run_task_manager(*[])\r\ntask_1       | 2020-01-09 16:08:59,347 DEBUG    awx.main.scheduler Running Tower task manager.\r\ntask_1       | 2020-01-09 16:08:59,359 DEBUG    awx.main.scheduler Not running scheduler, another task holds lock\r\ntask_1       | 2020-01-09 16:08:59,360 DEBUG    awx.main.dispatch task a1c42d7f-17b2-4590-b013-b82f76105f0c is finished`\r\n\r\nAfter a lot of time (this time 16min) it suddenly starts to execute the task\r\n\r\n`task_1       | 2020-01-09 16:24:19,814 DEBUG    awx.main.dispatch task b832fea9-c31f-4cfb-8ce3-fda16a1ac5cb starting awx.main.scheduler.tasks.run_task_manager(*[])\r\ntask_1       | 2020-01-09 16:24:19,816 DEBUG    awx.main.scheduler Running Tower task manager.\r\ntask_1       | 2020-01-09 16:24:19,827 DEBUG    awx.main.scheduler Not running scheduler, another task holds lock\r\ntask_1       | 2020-01-09 16:24:19,828 DEBUG    awx.main.dispatch task b832fea9-c31f-4cfb-8ce3-fda16a1ac5cb is finished\r\ntask_1       | 2020-01-09 16:24:38,979 DEBUG    awx.main.dispatch publish awx.main.tasks.cluster_node_heartbeat(aacec6cc-b438-4cb7-b3f8-2a9ba0b3f399, queue=awx)\r\ntask_1       | [2020-01-09 16:24:38,979: DEBUG/Process-1] publish awx.main.tasks.cluster_node_heartbeat(aacec6cc-b438-4cb7-b3f8-2a9ba0b3f399, queue=awx)\r\nrabbitmq_1   | 2020-01-09 16:24:38.989 [info] <0.3775.0> accepting AMQP connection <0.3775.0> (172.19.0.5:48346 -> 172.19.0.3:5672)\r\nrabbitmq_1   | 2020-01-09 16:24:38.991 [info] <0.3775.0> connection <0.3775.0> (172.19.0.5:48346 -> 172.19.0.3:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\nrabbitmq_1   | 2020-01-09 16:24:38.996 [info] <0.3775.0> closing AMQP connection <0.3775.0> (172.19.0.5:48346 -> 172.19.0.3:5672, vhost: 'awx', user: 'guest')\r\ntask_1       | 2020-01-09 16:24:39,003 DEBUG    awx.main.dispatch delivered aacec6cc-b438-4cb7-b3f8-2a9ba0b3f399 to worker[178] qsize 0\r\ntask_1       | 2020-01-09 16:24:39,005 DEBUG    awx.main.dispatch task aacec6cc-b438-4cb7-b3f8-2a9ba0b3f399 starting awx.main.tasks.cluster_node_heartbeat(*[])\r\ntask_1       | 2020-01-09 16:24:39,008 DEBUG    awx.main.tasks Cluster node heartbeat task.\r\ntask_1       | 2020-01-09 16:24:39,020 DEBUG    awx.main.dispatch task aacec6cc-b438-4cb7-b3f8-2a9ba0b3f399 is finished\r\ntask_1       | 2020-01-09 16:24:39,090 DEBUG    awx.main.dispatch publish awx.main.tasks.awx_k8s_reaper(e33c3d96-163b-487f-8101-00dd80f101a7, queue=awx)\r\ntask_1       | [2020-01-09 16:24:39,090: DEBUG/Process-1] publish awx.main.tasks.awx_k8s_reaper(e33c3d96-163b-487f-8101-00dd80f101a7, queue=awx)\r\nrabbitmq_1   | 2020-01-09 16:24:39.100 [info] <0.3788.0> accepting AMQP connection <0.3788.0> (172.19.0.5:48350 -> 172.19.0.3:5672)\r\nrabbitmq_1   | 2020-01-09 16:24:39.102 [info] <0.3788.0> connection <0.3788.0> (172.19.0.5:48350 -> 172.19.0.3:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\nrabbitmq_1   | 2020-01-09 16:24:39.104 [info] <0.3788.0> closing AMQP connection <0.3788.0> (172.19.0.5:48350 -> 172.19.0.3:5672, vhost: 'awx', user: 'guest')\r\ntask_1       | 2020-01-09 16:24:39,105 DEBUG    awx.main.dispatch delivered e33c3d96-163b-487f-8101-00dd80f101a7 to worker[178] qsize 0\r\ntask_1       | 2020-01-09 16:24:39,108 DEBUG    awx.main.dispatch task e33c3d96-163b-487f-8101-00dd80f101a7 starting awx.main.tasks.awx_k8s_reaper(*[])\r\ntask_1       | 2020-01-09 16:24:39,117 DEBUG    awx.main.dispatch task e33c3d96-163b-487f-8101-00dd80f101a7 is finished\r\ntask_1       | 2020-01-09 16:24:39,344 DEBUG    awx.main.dispatch publish awx.main.tasks.awx_periodic_scheduler(97554fd6-f2c2-4b5f-a25d-bf09743b9105, queue=awx_private_queue)\r\ntask_1       | [2020-01-09 16:24:39,344: DEBUG/Process-1] publish awx.main.tasks.awx_periodic_scheduler(97554fd6-f2c2-4b5f-a25d-bf09743b9105, queue=awx_private_queue)\r\nrabbitmq_1   | 2020-01-09 16:24:39.354 [info] <0.3801.0> accepting AMQP connection <0.3801.0> (172.19.0.5:48354 -> 172.19.0.3:5672)\r\nrabbitmq_1   | 2020-01-09 16:24:39.356 [info] <0.3801.0> connection <0.3801.0> (172.19.0.5:48354 -> 172.19.0.3:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\ntask_1       | 2020-01-09 16:24:39,359 DEBUG    awx.main.dispatch delivered 97554fd6-f2c2-4b5f-a25d-bf09743b9105 to worker[178] qsize 0\r\nrabbitmq_1   | 2020-01-09 16:24:39.359 [info] <0.3801.0> closing AMQP connection <0.3801.0> (172.19.0.5:48354 -> 172.19.0.3:5672, vhost: 'awx', user: 'guest')\r\ntask_1       | 2020-01-09 16:24:39,361 DEBUG    awx.main.dispatch task 97554fd6-f2c2-4b5f-a25d-bf09743b9105 starting awx.main.tasks.awx_periodic_scheduler(*[])\r\ntask_1       | 2020-01-09 16:24:39,377 DEBUG    awx.main.tasks Starting periodic scheduler\r\ntask_1       | 2020-01-09 16:24:39,380 DEBUG    awx.main.tasks Last scheduler run was: 2020-01-09 16:05:39.310989+00:00\r\ntask_1       | 2020-01-09 16:24:39,390 DEBUG    awx.main.dispatch task 97554fd6-f2c2-4b5f-a25d-bf09743b9105 is finished`\r\n\r\nIs there a way to know which other task blocks the scheduler?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.1.0\r\n* AWX install method: docker on linux\r\n* Operating System: Centos 7\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n![image](https://user-images.githubusercontent.com/7514801/71848879-e6dd3480-308d-11ea-9e3f-19445d404986.png)\r\n\r\n##### ENVIRONMENT\r\n\r\n- Tower version: 3.6.2\r\n- AWX install method: yolo #8062: Instance URL - https://ec2-54-85-222-225.compute-1.amazonaws.com\r\n- Ansible version: 2.10.0.dev0\r\n- Operating System: Mac Mojave 10.14.6\r\n- Web Browser: Version 79.0.3945.88 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Click **Templates**\r\n2. Select **[+]** > **Job Template**\r\n3. In **Job Type** field, select **Scan**\r\n\r\n##### EXPECTED RESULTS\r\nOnly see two options from the **Job Type** field: **Run** and **Check** only.\r\n\r\n##### ACTUAL RESULTS\r\nSee **Job Type** field contains: **Run**, **Check**, and **Scan**.\r\n\r\n##### ADDITIONAL INFORMATION\r\nScan jobs are no longer supported starting with Ansible Tower 3.2.\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nUsing ansible_inventory_sources variables results in a temporary/dynamic inventory name using awx.\r\n\r\nThe inventory is sourced from git repository and it is not dynamic.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.2\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nansible_inventory_sources should show real inventory name\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nansible_inventory_sources example shows: \"/tmp/awx_56459_fhk7j_ol/tmpqg5ea3af\"\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nIf running an environment with a large record count under `main_jobevents`, performing maintenance tasks to this table can be delayed due to long running auto-vacuum to the table.\r\n\r\nThis feature request would like to address one of the following:\r\n- A better tuned postgres configuration that handles this table more efficiently\r\n- An alternative solution to make dealing with jobevents more efficient"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n  - Feature Idea\r\n \r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n  - UI\r\n \r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt would be pretty useful if there was a link/button on the template UI that would actually display the contents of said playbook. I find myself looking at a template that I want/need to run and trying to remember what was exactly in the guts of the playbook, and then having to log into git/enter MFA/find the playbook or role, etc.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.6.0\r\n* AWX install method: n/a\r\n* Ansible version:  2.9.2\r\n* Operating System: n/a\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nA dialog that pops up that displays the local contents of the SCM component in question should quasi easy to implement. If displaying the contents of a playbook is a security risk, than a button that opens said playbook in git would also be great. Obviously, that would be more of a challenge since many different SCMs exist, and not all of them are as user friendlt as git.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIf the data metric has multiple entries like:\r\n```\r\nawx_instance_capacity{hostname=\"some-domain-tower1.com.example.com\",instance_uuid=\"b5c9e65f-f75a-421f-8c14-23405d25fc41\"} 54.0\r\nawx_instance_capacity{hostname=\"some-domain-isolated1.com.example.com\",instance_uuid=\"48d53859-9d1c-431c-9c44-7d08322188e9\"} 55.0\r\nawx_instance_capacity{hostname=\"some-domain-tower2.com.example.com\",instance_uuid=\"066e3aa8-9e9b-4833-bfe6-ecaff4fd7d83\"} 54.0\r\nawx_instance_capacity{hostname=\"some-domain-tower3.com.example.com\",instance_uuid=\"16eacc57-f876-498a-885f-1c1fe193f2df\"} 54.0\r\nawx_instance_capacity{hostname=\"some-domain-tower4.com.example.com\",instance_uuid=\"6bf06e69-9cc2-49e9-bde0-a00648024f48\"} 54.0\r\n```\r\n\r\ne.g. we are reporting the `awx_instance_capacity` for mutliple instances, then when we do a GET with `ContentType` as `application/json` we only get the last value:\r\n```\r\n    \"awx_instance_capacity\": {\r\n        \"labels\": {\r\n            \"hostname\": \"some-domain-tower4.com.example.com\",\r\n            \"instance_uuid\": \"6bf06e69-9cc2-49e9-bde0-a00648024f48\"\r\n        },\r\n        \"value\": 54.0\r\n    },\r\n```\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: tower built from devel\r\n* Ansible version:  X.Y.Z not relevant\r\n* Operating System: rhel 7 (probably not relevant)\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate a tower cluster w/ at least 2 nodes\r\n\r\n##### EXPECTED RESULTS\r\nExpect that we get lists in json of `awx_instance_capacity`, `awx_instance_cpu`, `awx_instance_memory`, `awx_instance_info`, `awx_instance_consumed_capacity`, and `awx_remaining_capacity`\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\n\r\nOnly get one value for each key\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nWill need to do some kind of custom rendering when request asked for `application/json`\r\nCreated this bug as a defect for this feature: https://github.com/ansible/awx/issues/5292#issuecomment-568538976"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nUsing two completely separate satellite sources with the same \"Organization\" but different \"Locations\"  results in AWX only importing some, but not all,  of the hosts into a cumulative inventory.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1.0\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.8.5\r\n* Operating System: RHEL 7\r\n* Web Browser: Chrome 79.0.3945.88 \r\n* Red Hat Satellite 6.6\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n1. Inventories - > Add -> Enter Name ->Save -> Sources -> Add first Satellite server with creds using \"Red Hat Satellite 6\" for source-> Save\r\n2. Inventories -> Select previously created inventory -> Sources -> Add -> Add 2nd Satellite server into source -> Save\r\n3. Select Created Inventory -> Sources -> Click Sync All\r\n\r\n\"Overwrite, Overwrite Variables, or Update on Launch did not change results.\r\n\r\n##### EXPECTED RESULTS\r\nExpected a total of 350 hosts in Inventory.  \r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nTotal number of hosts ingested was 180.   Cumulative RH Satellite sources results in only a partial number of hosts in the inventory.   If two separate inventories are used each utilizing a separate Satellite server, the correct number of hosts are ingested in the inventory. \r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nWhen launching a job template with fact cache enabled concurrently (200-400 jobs), AWX will fetch retrieve the entire inventory of host facts, for each jobs and stores them into AWX file system and memcached.  This becomes problematic when each hosts in the inventory has a larger facts cached on the database.\r\n\r\nFor the main_host table size of 300MB,  we see repeatability the following queries made to the database by running SQL Profiler\r\n\r\n![image](https://user-images.githubusercontent.com/16950383/71367375-dea3d600-2572-11ea-99f7-f02194c14ddc.png)\r\n\r\nCode:\r\n\r\nhttps://github.com/ansible/awx/blob/c6dc69c68b9bb3a3dfcdced9b6f774039451c97f/awx/main/tasks.py#L1252-L1256\r\n\r\n\r\nhttps://github.com/ansible/awx/blob/c6dc69c68b9bb3a3dfcdced9b6f774039451c97f/awx/main/models/jobs.py#L780-L802\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 5.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8\r\n* Operating System: RHEL 7\r\n* Web Browser: Chrome/ Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. create a medium-ish inventory ( 2000 hosts)\r\n2. populate each host with 50KB of  ansible_facts data ( we can just postgres sql to do this)\r\n3. create a job template and enable concurrent jobs and enable fact facting\r\n4. launch 200-400 jobs\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob response time  should be clustered and within less than 5 seconds. this is without fact caching enable:\r\n\r\n![image](https://user-images.githubusercontent.com/16950383/71367621-9c2ec900-2573-11ea-8752-e573f36f8e8c.png)\r\n\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\njobs should be executed quick but response time for a job is a stepper function not to mention about 300MB x 200 = 6GB ansible_facts of data transferred. Note a lot of jobs was harakiri-ed  if the response took longer than 120second. \r\n\r\n![image](https://user-images.githubusercontent.com/16950383/71367564-76a1bf80-2573-11ea-85fa-c03b4c307577.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nidentify changes from highlevel\r\n\r\n##### SUMMARY\r\nwe are new to AWX - we think it would make sense for the template/job indicator to show yellow instead of green when there is a change and to show green when there are no changes and red when job fails unless I am missing something -?\r\n![image](https://user-images.githubusercontent.com/20629911/71320790-48ce5500-2465-11ea-86e9-0a4ab2f03307.png)\r\nor maybe green + yellow when there is a change.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\nI want to create a dynamic openstack inventory. When I use a custom script as an inventory source it works as expected. But when the same script is sourced from GIT as a project, the following error occurs\r\n\r\n    2.578 INFO     Updating inventory 9: CNI-UNDERCLOUD\r\n    3.096 DEBUG    Using base command: python /usr/bin/ansible-inventory -i /tmp/awx_158_36ca2aqh/project/openstack.py --playbook-dir /tmp/awx_158_36ca2aqh/project -vvvvv\r\n    3.096 INFO     Reading Ansible inventory source: /tmp/awx_158_36ca2aqh/project/openstack.py\r\n    3.098 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    3.098 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    3.098 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 11, in <module>\r\n    load_entry_point('awx==9.0.1.0', 'console_scripts', 'awx-manage')()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 158, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1153, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1043, in handle\r\n    venv_path=venv_path, verbosity=self.verbosity).load()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 214, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 197, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nansible-inventory 2.8.5\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = ['/var/lib/awx/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python3.6/site-packages/ansible\r\n  executable location = /usr/bin/ansible-inventory\r\n  python version = 3.6.8 (default, Oct  7 2019, 17:58:22) [GCC 8.2.1 20180905 (Red Hat 8.2.1-3)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nhost_list declined parsing /tmp/awx_158_36ca2aqh/project/openstack.py as it did not pass it's verify_file() method\r\nauto declined parsing /tmp/awx_158_36ca2aqh/project/openstack.py as it did not pass it's verify_file() method\r\nyaml declined parsing /tmp/awx_158_36ca2aqh/project/openstack.py as it did not pass it's verify_file() method\r\ntoml declined parsing /tmp/awx_158_36ca2aqh/project/openstack.py as it did not pass it's verify_file() method\r\n [WARNING]:  * Failed to parse /tmp/awx_158_36ca2aqh/project/openstack.py with\r\nscript plugin: Inventory script (/tmp/awx_158_36ca2aqh/project/openstack.py)\r\nhad an execution error: Traceback (most recent call last):   File\r\n\"/tmp/awx_158_36ca2aqh/project/openstack.py\", line 64, in <module>     import\r\nopenstack as sdk   File \"/tmp/awx_158_36ca2aqh/project/openstack.py\", line 65,\r\nin <module>     from openstack.cloud import inventory as sdk_inventory\r\nModuleNotFoundError: No module named 'openstack.cloud'; 'openstack' is not a\r\npackage\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 268, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/script.py\", line 161, in parse\r\n    raise AnsibleParserError(to_native(e))\r\n [WARNING]:  * Failed to parse /tmp/awx_158_36ca2aqh/project/openstack.py with\r\nini plugin: /tmp/awx_158_36ca2aqh/project/openstack.py:54: Expected key=value\r\nhost variable assignment, got: argparse\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 268, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/ini.py\", line 138, in parse\r\n    raise AnsibleParserError(e)\r\n [WARNING]: Unable to parse /tmp/awx_158_36ca2aqh/project/openstack.py as an\r\ninventory source\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUpgrading from 9.0.1 to 9.1.0 broke the upgrade \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1 to 9.1.0\r\n* AWX install method: k8s\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUpgrade from 9.0.1 to 9.1.0 using the ansible-playbook installer.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\npsycopg2.errors.UndefinedColumn: column main_projectupdate.job_tags does not exist\r\nLINE 1: ...e\".\"project_id\", \"main_projectupdate\".\"job_type\", \"main_proj...\r\n                                                             ^\r\nHINT:  Perhaps you meant to reference the column \"main_projectupdate.job_type\".\r\n\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/dispatch/worker/task.py\", line 86, in perform_work\r\n    result = self.run_callable(body)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/dispatch/worker/task.py\", line 62, in run_callable\r\n    return _call(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/scheduler/tasks.py\", line 19, in run_task_manager\r\n    TaskManager().schedule()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/scheduler/task_manager.py\", line 643, in schedule\r\n    self._schedule()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/scheduler/task_manager.py\", line 605, in _schedule\r\n    all_sorted_tasks = self.get_tasks()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/scheduler/task_manager.py\", line 69, in get_tasks\r\n    project_updates = [p for p in ProjectUpdate.objects.filter(status__in=status_list, job_type='check').prefetch_related('instance_group')]\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/query.py\", line 274, in __iter__\r\n    self._fetch_all()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/query.py\", line 1242, in _fetch_all\r\n    self._result_cache = list(self._iterable_class(self))\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/polymorphic/query.py\", line 56, in _polymorphic_iterator\r\n    o = next(base_iter)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/query.py\", line 55, in __iter__\r\n    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/sql/compiler.py\", line 1100, in execute_sql\r\n    cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/utils.py\", line 67, in execute\r\n    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/utils.py\", line 76, in _execute_with_wrappers\r\n    return executor(sql, params, many, context)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/utils.py\", line 89, in __exit__\r\n    raise dj_exc_value.with_traceback(traceback) from exc_value\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/utils.py\", line 84, in _execute\r\n    return self.cursor.execute(sql, params)\r\ndjango.db.utils.ProgrammingError: column main_projectupdate.job_tags does not exist\r\nLINE 1: ...e\".\"project_id\", \"main_projectupdate\".\"job_type\", \"main_proj...\r\n```\r\n##### EXPECTED RESULTS\r\n\r\nUpgrade to finish successfully and without an issue. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nSystem broke. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nOur organizations, teams and users are mapped from LDAP. I would expect that a organization admin is allowed to grant organization permission to other LDAP users. But that's not possible. The organization admin can only manage non-LDAP users.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.2\r\n* Operating System: Debian 9\r\n* Web Browser: Firefox 70\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd LDAP as authentication method and add an organization mapping, e.g.\r\n\r\n```\r\n{\r\n \"org1\": {\r\n  \"users\": [\r\n   \"cn=org1,ou=departments,ou=company,ou=Groups,ou=example,dc=coml\"\r\n  ],\r\n  \"remove_users\": true,\r\n  \"remove_admins\": false,\r\n  \"admins\": false\r\n },\r\n  ...\r\n```\r\nAssign one user of the org1 organization as org-admin. Then login with that user and try to grant permissions to an other user of the same organization. You won't be able to choose the user in the permissions dialog. Instead it says \"You do not have permission to manage this user\"\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe org-admin is able to grant permission to other LDAP users which are member of their organization.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\"You do not have permission to manage this user\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![awx_grant_org_permissions_error](https://user-images.githubusercontent.com/51952982/71006147-2cd55700-20e5-11ea-8234-61344a615585.jpg)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCache the roles directory based on requirements.yml to expedite jobs with larger repositories.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nProposal to eliminate the need to do a query on every job event save to obtain the database id of the host it is operating on.\r\n\r\nThis logic would be replaced:\r\n\r\nhttps://github.com/ansible/awx/blob/112f89660b40c7eeafb9cd4bdbb4837525913f8b/awx/main/models/events.py#L354-L367\r\n\r\nThe host id can be obtained in the script data if using these parameters `/api/v2/inventories/45/script/?towervars=1&hostvars=1`, example:\r\n\r\n```json\r\n    \"_meta\": {\r\n        \"hostvars\": {\r\n            \"change_of_vars\": {\r\n                \"dynamic_2019_10_29_15_23_48.194654\": \"host_static_value\",\r\n                \"static_key\": \"host_dynamic_2019_10_29_15_28_08.940019\",\r\n                \"dynamic_2019_10_29_15_24_26.098715\": \"host_static_value\",\r\n                \"dynamic_2019_10_29_15_28_08.940019\": \"host_static_value\",\r\n                \"remote_tower_enabled\": \"true\",\r\n                \"remote_tower_id\": 370\r\n            },\r\n            \"moover-2019_10_29_15_28_08.940019\": {\r\n                \"static_var\": \"static_value\",\r\n                \"remote_tower_enabled\": \"true\",\r\n                \"remote_tower_id\": 373\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n```\r\n\r\nThis proposal is to apply those parameters to the normal pre-job-run inventory script generation. Then when saving events, obtain `remote_tower_id` from hostvars. This will have to be done in ansible-runner. That will need to be added into the event data, then discovered in the event saving code, and used instead of the query to obtain the host id.\r\n\r\nRelated to or maybe part of #4209 #5443. This can be done and tested separately before the main feature work. Ping @chrismeyersfsu"},{"labels":["api"],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWould like to use API to add user(s) permissions on a workflow job(s).\r\nUnable to find documentation about it or maybe it's not possible. \r\nAlso searched on **Issues** but unable to find similar open/closed issue.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.8.5\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nRelying on documentation provided at https://docs.ansible.com/ansible-tower/latest/html/towerapi/\r\nI'm unable to find a proper API call to add user(s) permissions on a workflow job(s).\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nTo be aware if it's possible but not documented.\r\nTo be aware if it's not possible at all.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nN/A\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nAt UI we are able to add/edit user and permissions on a workflow template:\r\n![image](https://user-images.githubusercontent.com/53036263/70905039-c70ca080-1ffa-11ea-9a37-7c253c86b790.png)\r\n\r\nWould like to achieve that using API."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer an user's request, they're wondering if it's possible to blacklist/whitelist users who are authenticating via SAML. Could this be implemented by specifying an attribute to lookup in the response?"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nWhen playing insights-client role in a tower, I hit this error\r\nTraceback (most recent call last): File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py\", line 1255, in run self.pre_run_hook(self.instance, private_data_dir) File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py\", line 1846, in pre_run_hook job.project.scm_type, job_revision File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/tasks.py\", line 2246, in make_local_copy copy_tree(project_path, destination_folder) \r\nFile \"/opt/rh/rh-python36/root/usr/lib64/python3.6/distutils/dir_util.py\", line 159, in copy_tree verbose=verbose, dry_run=dry_run)) \r\nFile \"/opt/rh/rh-python36/root/usr/lib64/python3.6/distutils/dir_util.py\", line 159, in copy_tree verbose=verbose, dry_run=dry_run)) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/distutils/dir_util.py\", line 159, in copy_tree verbose=verbose, dry_run=dry_run)) [Previous line repeated 121 more times] File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/distutils/dir_util.py\", line 163, in copy_tree dry_run=dry_run) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/distutils/file_util.py\", line 105, in copy_file \"can't copy '%s': doesn't exist or not a regular file\" % src) distutils.errors.DistutilsFileError: can't copy '/var/lib/awx/projects/linux/manual/roles/redhatinsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/roles/RedHatInsights.insights-client/tests/example-insights-client-playbook.yml': doesn't exist or not a regular file\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Tower 3.6\r\n* Operating System: Linux\r\n\r\n##### STEPS TO REPRODUCE\r\nInstall the insights-client role on the tower and run a job to play it.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe role can be played.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe role can't be played.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe issue is caused by a symlink on this file.\r\n\r\nhttps://github.com/RedHatInsights/insights-client-role/blob/master/tests/roles/RedHatInsights.insights-client\r\n\r\nI think the issue is caused by this line.\r\n\r\nhttps://github.com/ansible/awx/blob/devel/awx/main/tasks.py#L2218\r\nIt should call copy_tree like this:\r\ncopy_tree(project_path, destination_folder, preserve_symlinks=1)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nOur initial implementation of webhooks will launch a job for every single event that is caught. For example, enabling webhook events from Pull Request updates will send events for: \r\n\r\n> `assigned`, `unassigned`, `review_requested`, `review_request_removed`, `labeled`, `unlabeled`, `opened`, `edited`, `closed`, `ready_for_review`, `locked`, `unlocked`, `or reopened`. \r\n\r\nThis may sometimes be the desired behavior, however there seems to be a use case for a feature that augments the behavior in opinionated ways to play nicely as a CI check in GitHub or GitLab.\r\n\r\nAt a high level, a job should only launch when a pull request is opened or the code has changed. We may also need a whitelist of labels to respond to if we wish to keep our `mergeit` behavior."},{"labels":["api",null,null,null],"text":"1. create an Oauth token for a user\r\n2. delete the Oauth token using itself as the Bearer\r\n`curl -k -H 'Authorization: Bearer r8jwGD25D9rIDQ6F1lqcRwrejR9gR7' -X DELETE https://localhost/api/v2/tokens/21/`\r\n3. Observe HTTP 500"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nProxying from an email where group mappings were not working properly:\r\n....\r\nLooks like the culprit was the group dn had a space after the \"cn=\" in the team mapping for the team that wasn't working correctly\r\ni.e. \"cn= groupname,ou=group,dc=example,dc=com\"\r\n\r\nThe syntax check doesn't complain about the space, so looks like that's how it slipped through\r\n...\r\n\r\nAssuming a leading space is invalid, we should catch this.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nReplace our clustered implementation of RabbitMQ with something that is easier to understand and operate (and that matches AWX's needs better).\r\n\r\nAWX currently makes extensive use of clustered RabbitMQ:\r\n\r\n1.  As a form of direct topic-based RPC for dispatching jobs (e.g., playbook runs) to underlying AWX instances.  This process involves a periodic scheduler that wakes up, finds work to do, picks an available node with capacity, and places a message on its queue, which is treated as a sort of per-instance \"task queue\" ala https://python-rq.org or https://docs.celeryproject.org/en/stable/.  Certain special messages (which generally are used to perform internal housekeeping tasks in AWX) are \"broadcast\" to all nodes instead of following a direct RPC topology.\r\n\r\n2.  As a buffer for processing job output (Ansible callback events/stdout) via AWX's \"callback receiver\" process running on each AWX instance.\r\n\r\n3.  As a backend for AWX's websocket support for in-browser streaming stdout and live job status updates.  Our websocket implementation is based on a custom AMQP-specific ASGI backend which we wrote and maintain, https://github.com/ansible/asgi_amqp/.  As time has marched on, and the upstream [channels](https://channels.readthedocs.io) library has *drastically* [changed its architecture](https://channels.readthedocs.io/en/latest/one-to-two.html) in anticipation of native async support in python3, it has become an increased maintenance burden for us to continue to support a custom backend specific to AMQP (especially when it appears that pretty much everybody upstream that uses Channels is just using Redis).\r\n\r\nWhen we originally designed this system years ago, we optimized as heavily as possible for data integrity and safety.  But in the scenarios described above, the data we manage under this system is largely ephemeral.  In the most extreme cases, it doesn't persist beyond the lifetime of a running playbook.  In other words, if a node running a playbook were to suddenly go offline, we can't really recover from that sort of scenario *anyways* without re-running the playbook.  Similarly, if messages are lost in flight in _rare_ circumstances, you can always just relaunch a playbook.  \r\n\r\nWe're paying a heavy cost for this cluster-wide data mirroring/replication.  Historically, we've heard from many of our users that:\r\n\r\n - RabbitMQ clustering doesn't work well in environments unless cluster peers have **very** low latency.  In fact, this is a limitation called out repeatedly in RabbitMQ's clustering documentation.  It's an aspect of RabbitMQ clustering that we knew about when we chose it years ago, but it's turned out to be much more painful than we anticipated.\r\n\r\n - Especially in environments with unreliable networks, RabbitMQ can be very difficult to administer and troubleshoot.  In particular, we regularly have users that report network partitioning scenarios that require manual intervention via manual erlang and/or RabbitMQ-specific remediation.\r\n\r\n- When cluster nodes disappear for prolonged periods of time (hours, days), we've seen many situations where RabbitMQ clustering just isn't able to recover on its own, which causes a myriad of issues when the node returns.  Detecting and remediating this often leads to service outages.\r\n\r\n- The firewall/security group requirements for inter-node replication is a common source of confusion for users, and failing to do it properly can result in situations where adding a node to an existing cluster fails and results in an unanticipated cluster-wide outage.\r\n\r\nWhat we've come to realize is that this architecture is likely not worth the operational and architectural cost we're paying.\r\n\r\nLong-term, we'd prefer to move to a model that does not require a control plane that relies on a clustered message bus, but instead one where members of the control plane can largely drop off with minimal effect beyond lowered total execution capacity.  RabbitMQ clustering explicitly is not reliable across AZs, and especially not regions, and while newer topologies we're considering don't absolve of this entirely, our goal is to move AWX to a model which is much more forgiving of low-latency networks in general.\r\n\r\nIn the next major version of AWX, we'd like to investigate replacing RabbitMQ with a combination of features provided by Redis (a new dependency) and Postgres itself.  This would most likely look something like this:\r\n\r\n- Dispatching tasks is still treated as “direct RPC”. In other words, when the task manager runs, it picks one cluster node with capacity, and assigns it as the “execution node”. Dispatcher processes running on every node listen for “tasks” via PostgreSQL channel notification support (https://www.postgresql.org/docs/10/sql-notify.html)\r\n\r\n- Events emitted from playbooks are no longer sent to a distributed message queue (previously RabbitMQ), but instead a local redis running on each node. Callback receivers on each node listen for events on that node and persist them into the database.\r\n\r\n- When an event is persisted to the database by the callback receiver, it also is broadcasted to all cluster peers via ASGI. In this way, if a playbook runs on Node A, users connected to Daphne on Nodes B, C, and D will receive a broadcast of these events and see the output in their browser tabs.\r\n\r\nLonger term, introducing Redis would potentially allow us to *also* lose our dependence on memcached (so in other words, we might be able to swap out *two* dependencies, and replace them with one single new dependency)."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIn https://github.com/ansible/awx/pull/5407 we are updating Django REST framework.\r\n\r\nBut in doing that, we are setting this to a old / deprecated kind of class\r\n\r\nhttps://github.com/ansible/awx/blob/e70c7ab458b46402e182bf1b66517021f7482394/awx/api/swagger.py#L10\r\n\r\n```python\r\n    'DEFAULT_SCHEMA_CLASS': 'rest_framework.schemas.AutoSchema',\r\n```\r\n\r\nWe actually have our own `AutoSchema` class, which we conditionally inject into our views.\r\n\r\nhttps://github.com/ansible/awx/blob/e70c7ab458b46402e182bf1b66517021f7482394/awx/api/swagger.py#L27-L58\r\n\r\nCompare...\r\n\r\nDRF now wants to use `rest_framework.schemas.openapi.AutoSchema` by default:\r\n\r\nhttps://www.django-rest-framework.org/api-guide/schemas/\r\n\r\nhttps://github.com/encode/django-rest-framework/blob/7c3477dcdae558b40acfa116ed08eeb5700818eb/rest_framework/schemas/coreapi.py#L336\r\n\r\nSo our auto schema class is very specifically written for the old DRF schema class, and then takes it and does swagger stuff. There's a new class which already does swagger stuff. We should switch to that one, rewriting our custom class so that we have to maintain less of the logic ourselves.\r\n\r\nExactly how much we need to do is unclear.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nPlaybooks stored in hidden directories do not show up in the interface.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.5\r\n* Operating System: Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPlace a playbook in a directory that starts with `.`. It won't show up in the Playbook select widget.\r\nExample structure:\r\n\r\n```\r\ntest-root.yml\r\n.hidden/test-hidden.yml\r\nnothidden/test-nothidden.yml\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBe able to select all 3 of the playbooks from the example above.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOnly `test-root.yml` and `nothidden/test-nothidden.yml` are showing up in the interface.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\nCustom email notification for workflow approval/deny doesnt work\r\n\r\n##### SUMMARY\r\nCustom email notification for workflow approval/deny doesnt work. It sends a blank email with no subject and body.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.8.5\r\n* Operating System: RHEL 7.6\r\n* Web Browser: Google Chrome 78\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1.) Create an Email Notification\r\n2.) Enable the custom notification\r\n3.) Create a workflow with approval node in it. \r\n4.) Enable all the 4 options for notification on workflow (APPROVAL, START, SUCCESS, FAILURE)\r\n5.) Run the workflow.\r\n\r\n##### EXPECTED RESULTS\r\nWhile workflow waits for approval to be approved/denied. It should send a notification email with details.\r\n\r\n\r\n##### ACTUAL RESULTS\r\nIt send an blank email with blank subject and body\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nExtremely strange behavior is observed in event stdout for a task that runs an ansible-playbook command\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.9\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a job using this playbook\r\n\r\nhttps://github.com/AlanCoding/test-playbooks/blob/nested/nested_debug.yml\r\n\r\nview the stdout for the only task in the playbook\r\n\r\n##### EXPECTED RESULTS\r\n\r\nsame as CLI results\r\n\r\n```\r\n    \"delta\": \"0:00:01.160476\",\r\n    \"end\": \"2019-11-21 20:00:57.208672\",\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"ansible-playbook -i localhost, debug.yml\",\r\n            \"_uses_shell\": false,\r\n            \"argv\": null,\r\n            \"chdir\": null,\r\n            \"creates\": null,\r\n            \"executable\": null,\r\n            \"removes\": null,\r\n            \"stdin\": null,\r\n            \"stdin_add_newline\": true,\r\n            \"strip_empty_ends\": true,\r\n            \"warn\": true\r\n        }\r\n    },\r\n    \"rc\": 0,\r\n    \"start\": \"2019-11-21 20:00:56.048196\",\r\n    \"stderr\": \"\",\r\n    \"stderr_lines\": [],\r\n    \"stdout\": \"\\nPLAY [all] *********************************************************************\\n\\nTASK [debug] *******************************************************************\\nok: [localhost] => {\\n    \\\"msg\\\": \\\"hello\\\"\\n}\\n\\nPLAY RECAP *********************************************************************\\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \",\r\n    \"stdout_lines\": [\r\n        \"\",\r\n        \"PLAY [all] *********************************************************************\",\r\n        \"\",\r\n        \"TASK [debug] *******************************************************************\",\r\n        \"ok: [localhost] => {\",\r\n        \"    \\\"msg\\\": \\\"hello\\\"\",\r\n        \"}\",\r\n        \"\",\r\n        \"PLAY RECAP *********************************************************************\",\r\n        \"localhost                  : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \"\r\n    ]\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP ******************************************************************************************************************************************************************\r\nlocalhost                  : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n\r\n\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<img width=\"1397\" alt=\"Screen Shot 2019-11-21 at 8 07 48 PM\" src=\"https://user-images.githubusercontent.com/1385596/69389635-9d31b980-0c9a-11ea-8c97-c24092aaa013.png\">\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nleaky environment stuff from ansible-runner, just wanted to get a concrete test case established here.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\nRight now we cannot filter the instance groups list based on `is_containerized`\r\n\r\ne.g. when I do `https://127.0.0.1:8043/api/v2/instance_groups/?is_containerized=false` I get this error:\r\n```\r\nHTTP 400 Bad Request\r\nAllow: GET, POST, HEAD, OPTIONS\r\nContent-Type: application/json\r\nVary: Accept\r\nX-API-Node: awx\r\nX-API-Query-Count: 0\r\nX-API-Query-Time: 0.000s\r\nX-API-Time: 0.011s\r\n\r\n{\r\n    \"detail\": \"InstanceGroup has no field named 'is_containerized'\"\r\n}\r\n```\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAllow API clients to filter results of `GET` to `api/v2/instance_groups` based upon the `is_containerized` field.\r\n\r\n@appuk noticed this"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n \r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI have a playbook that has a task like this\r\n  ` - template:\r\n        src: ../files/kfhost.j2\r\n        dest: /app/bin/kafka/server.properties\r\n        owner: kafka\r\n        group: kafka\r\n        mode: 0755\r\n   `\r\nthe jinga file has a line like this\r\n`broker.id={{ play_hosts.index(inventory_hostname)+1 }}`\r\n\r\nI have an inventory file like this\r\n\r\n[all]\r\nserver1\r\nserver2\r\nserver3\r\n\r\nwhen i run this playbook from command line, \r\nserver1 gets broker.id=1, server2 gets broker.id=2 and server3 gets broker.id=3 as expected and always\r\n\r\nwhen i run the same playbook in tower, sometimes\r\nserver1 gets broker.id=2 and server2 gets broker.id=1\r\n\r\njust fyi. there are a few tasks before this as well but very simple tasks that just do set_fact.\r\n\r\nthe mismatch in order never happens when i run the playbook from ansbile-playbook command line\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8\r\n* AWX install method: openshift\r\n* Ansible version:  2.6.4\r\n* Operating System: linux\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nDescription shows the task i am trying to run. you can create a playbook with similar task and inga file.\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\ni would like the behavior to be the same when i run the playbook from command line \r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nthe order as explained seems to be mismatched when running the playbook in tower\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThe Jobs page currently lists all Job executions but you're unable to see which particular extra variables a Job was executed with. For instance, imagine you have a deployment Job that's just called `Deployment` but there's also a survey associated with the Job that allows users to specify which application they want to deploy.\r\n\r\nIt would be nice to see which application was deployed in the list of Jobs but currently you'd only see:\r\n\r\n- `Deployment`\r\n- `Deployment`\r\n- `Deployment`\r\n- `Deployment`\r\n- `Deployment`\r\n\r\nbut that's not super useful. It would be nice to be able to choose extra variables that'd be displayed on this list. It'd then look like this:\r\n\r\n- `Deployment (app_name: \"a\")`\r\n- `Deployment (app_name: \"b\")`\r\n- `Deployment (app_name: \"c\")`\r\n- `Deployment (app_name: \"d\")`\r\n- `Deployment (app_name: \"e\")`\r\n\r\nI think it'd be fairly easy to implement but also very useful."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWe have a case in that the customer is using inventories sourced from projects. He is trying to update the inventory from the remote repo on the template launch. We shared with him the KCS below to clarify how to do that.\r\n\r\nhttps://access.redhat.com/solutions/3805061\r\n\r\nHe followed the steps successfully, but he wants to suggest the idea of add an option that allow to pull the latest remote version of the inventory project from the remote git server on each use of the inventory. \r\n"},{"labels":["api",null,null],"text":"<img width=\"931\" alt=\"image\" src=\"https://user-images.githubusercontent.com/214912/68881287-dd150180-06da-11ea-9a14-fdef299b8906.png\">\r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"/awx_devel/awx/main/scheduler/kubernetes.py\", line 55, in list_active_jobs\r\n    for pod in pm.kube_api.list_namespaced_pod(\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/utils/functional.py\", line 80, in __get__\r\n    res = instance.__dict__[self.name] = self.func(instance)\r\n  File \"/awx_devel/awx/main/scheduler/kubernetes.py\", line 91, in kube_api\r\n    config_dict=self.kube_config\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/utils/functional.py\", line 80, in __get__\r\n    res = instance.__dict__[self.name] = self.func(instance)\r\n  File \"/awx_devel/awx/main/scheduler/kubernetes.py\", line 83, in kube_config\r\n    return generate_tmp_kube_config(self.credential, self.namespace)\r\n  File \"/awx_devel/awx/main/scheduler/kubernetes.py\", line 178, in generate_tmp_kube_config\r\n    credential.get_input('ssl_ca_cert').encode() # encode to bytes\r\n  File \"/awx_devel/awx/main/models/credential/__init__.py\", line 288, in get_input\r\n    raise AttributeError\r\nAttributeError\r\n```"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nWhile trying to make use of our initial webhook implementation, I am struggling with getting GitHub's events to do the Expected Thing™ in AWX.\r\n\r\nThere is the option to \"Send me everything.\" or \"Let me select individual events.\", but unfortunately the latter option does not behave intuitively in a(t least one) key way: Checking \"Pull requests\" will send you events for:\r\n\r\n> Pull request opened, closed, reopened, edited, assigned, unassigned, review requested, review request removed, labeled, unlabeled, synchronized, ready for review, locked, or unlocked.\r\n\r\nNote the absence of \"comment\" here. In order to receive a webhook when someone comments on a Pull request, you must select \"Issue comments\". This would mean we launch a job for every comment, whether or not it is on an Issue or Pull request. Ouch.\r\n\r\nThe more I explore this feature, it seems to me that we need some type of pre-launch filtering to allow AWX (or the user via configuration?) to decide whether or not we launch a job for any given event. It would be great to be able to check \"Send me everything\" and have AWX be smart enough to launch a job or ignore it, as I don't think the example I've provided here will be the only scenario where we need this type of functionality."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nFeature request for flagging users as superusers and auditors in SAML integration, similar to LDAP implementation. \r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\nHello, \r\napparently there is no possibility to authenticate to AWX via LDAP in multi domain environment when the same account exists in more than 1 domain. \r\nexample we have :\r\ndomain1/awx_admin\r\ndomain2/awx_admin\r\n\r\nunfortunately for some specific reasons we need to have some users having multiple accounts in more than 1 domain\r\nAny plans to improve this in future release ?\r\ncheers\r\nMarek\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nThe User-Agent header is set on each request to inform the server about what type of client it is communicating with.  In this case, we are not yet setting User-Agent for analytics upload requests yet.  \r\n\r\nWe should do, and it should look something like the following:\r\n\r\n```\r\nUser-Agent: AnsibleTower/3.6.0}\r\n```\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nOur `/api/v2/metrics` shows statistics on running jobs, but not *where* they are running. It would be useful to have the data from `/api/v2/instances` merged into it, so the user can have a more clear perspective on what's going on across the cluster.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer an user's request, they would like the addition of an \"Use\" role on an organizational level. The organizational \"Use\" role should give access to all of the resources within the configured organization."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nDue to the way that it uses cgroups, it doesn't work in containers (nested cgroups with different Linux versions) We need to solve this in a proper manner.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate two vault creds with the same description.  Try to assign both to a job template in UI and save\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt works!\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIt doesn't work, api has failure\r\n\r\n---\r\n\r\n@AlexSCorey has more info"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI have some playbooks with roles, something like this:\r\n\r\n- hosts: all\r\n  remote_user: root\r\n  roles:\r\n    - common-apps\r\n    - users\r\n\r\nif i run this playbook from the web interface, the playbook just completes without executing the roles and the job is marked as successfully completed\r\n- it was working fine prior to version 8.0.0\r\n\r\nif i run the same playbook from the celery pod, it executes correctly the roles.\r\n\r\nNote: Roles and playbook are on a submodule\r\nI've attache 2 screenshots of the same playbook executed from the GUI and from the celery pod.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1\r\n* AWX install method: kubernetes\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n![Screenshot at Nov 05 16-31-20](https://user-images.githubusercontent.com/23634711/68221611-f8e91b00-ffe9-11e9-9b36-1b2e2a8e2071.png)\r\n![Screenshot at Nov 05 16-32-46](https://user-images.githubusercontent.com/23634711/68221624-fdadcf00-ffe9-11e9-80c7-b8f21113522a.png)\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nI'll use Job Templates as an example because that resource probably has the most related resources hanging off of it where this would be helpful.\r\n\r\nScenario:  Edit a job template and add 5 new instance groups.  Right now, the UI has to make 6 different REST calls to achieve this.  The first is a GET request on the instance groups to get the latest list of instance groups to compare our current list against.  After that, 5 POST requests (one for each changed IG).\r\n\r\nWhat we're asking for is the ability to make a single request (PUT?) to `/api/v2/job_templates/:id/instance_groups` with an array of id's to completely overwrite the list of related resources.  \r\n\r\nI've used instance groups as an example but the hope is that this pattern can be applied to other related resources as well.\r\n\r\nNote: the expectation is that the existing associate/disassociate pattern for related resources will remain intact.  This solution would be an alternative to that pattern whereby a consumer of the API could provide a definitive list of related id's.\r\n\r\nSomething that we'll have to think about is error handling.  If a consumer of the API attempts to pass an ID that does not exist or that they don't have access to: What's the expected behavior?  We may already have a pattern for this type of thing :shrug:\r\n\r\nAs far as usage in the UI the expectation here would be this would be used in ui_next and not the existing AWX UI.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen a python inventory script within a project attempts to update it fails with the error: \r\n`([Errno 2] No such file or directory`\r\nIt appears that when the script is run the environment expects /usr/bin/python to exist and this is missing in AWX 9.0.0 & 9.0.1\r\nCreating a symlink within the awx_task container allows this to run successfully.\r\n```ln --symbolic /usr/bin/python3 /usr/bin/python; ```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1\r\n* AWX install method: docker on linuxr\r\n* Ansible version:  2.8.5\r\n* Operating System: Centos 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd a project which contains an executable python inventory script.\r\nAdd an inventory.\r\nAdd an inventory source with \"Sourced from a Project\" type, using the added project and select the python script as the inventory file.\r\nSave & sync the inventory source\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSync to complete and hosts to become available in the inventory.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nReceived the following error:\r\n```\r\n[WARNING]:  * Failed to parse\r\n/tmp/awx_11903_lqb82efj/project/inventories/scripts/hosts.py with script\r\nplugin: problem running\r\n/tmp/awx_11903_lqb82efj/project/inventories/scripts/hosts.py --list ([Errno\r\n2] No such file or directory:\r\n'/tmp/awx_11903_lqb82efj/project/inventories/scripts/hosts.py':\r\n'/tmp/awx_11903_lqb82efj/project/inventories/scripts/hosts.py')\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nConfirmed that the script file existed in the location during the inventory update.\r\nWhen repeatedly running the following within the awx_task container when the update job was running the same error occurred \r\n`find /tmp -name hosts.py -exec () \\;`\r\nThis lead me to determine that it was an issue with python. \r\nRunning \"python\" within the awx_task failed as /usr/bin/python does not exist. \r\nI confirmed this existed in a previous version.\r\nAdding it back in via symlink fixed the issue."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.5\r\n* Operating System: Ubuntu Server 18.04\r\n* Web Browser: Chrome on Windows 10\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1. Define a project, inventory, and template in the normal manner.\r\n2. Define a machine credential to enable access to any machine to run the template against. Ensure that the password has the \"£\" symbol as the first character.\r\n3. Run the template against an appropriate machine (i.e. credentials match).\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nAWX runs the Ansible playbook successfully against the remote machine.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nAWX reports the following in the Job pane:\r\n```\r\nSSH password: ERROR! Unexpected Exception, this is probably a bug: 'ascii' codec can't decode byte 0xc2 in position 0: ordinal not in range(128).\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThis used to work fine in AWX 6.1.0. We upgraded to 9.0.0 yesterday afternoon and this immediately ceased to work - it seems like support for credentials that don't contain 7-bit ASCII characters is broken.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAfter upgrading I am unable to sync my inventory from satellite.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.5\r\n* Operating System: RHEL 7.7\r\n* Web Browser: Chrome 78.0.3904.87\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nClicked refresh for \"Red Hat Satellite 6\" source.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected the inventory to be refreshed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nGot an error: \r\nHTTPS request is being made. Adding certificate verification is strongly\r\nadvised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-\r\nwarnings   InsecureRequestWarning) Traceback (most recent call last):   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/foreman.py\", line 462, in <module>\r\nsys.exit(not ForemanInventory().run())   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/foreman.py\", line 456, in run\r\nself.get_inventory()   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/foreman.py\", line 404, in get_inventory\r\nself.update_cache()   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/foreman.py\", line 352, in update_cache\r\nself.facts[dns_name] = self._get_facts(host)   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/foreman.py\", line 244, in _get_facts     ret =\r\nself._get_facts_by_id(host['id'])   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/foreman.py\", line 221, in _get_facts_by_id\r\nreturn self._get_json(url)   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/foreman.py\", line 186, in _get_json\r\nret.raise_for_status()   File \"/var/lib/awx/venv/ansible/lib/python3.6/site-\r\npackages/requests/models.py\", line 940, in raise_for_status     raise\r\nHTTPError(http_error_msg, response=self) requests.exceptions.HTTPError: 500\r\nServer Error: Internal Server Error for url: https://<satellite-server>/api/v2/hosts/840/facts?per_page=250&page=1\r\n\r\n\r\nFile \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 268, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/script.py\", line 161, in parse\r\n    raise AnsibleParserError(to_native(e))\r\n [WARNING]: Unable to parse /var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/foreman.py as an inventory source\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThe awx-pf interface for hosts exposes recent jobs in a sparkline (like templates) but the one piece of information that we're missing is the job `type`.  The `type` is important because it allows us to navigate directly to the correct output page for the job in question without having to make an extra request.\r\n\r\nI tried this chunk:\r\n\r\n```\r\n        d.setdefault('recent_jobs', [{\r\n            'id': j.job.id,\r\n            'name': j.job.job_template.name if j.job.job_template is not None else \"\",\r\n            'status': j.job.status,\r\n            'finished': j.job.finished,\r\n            'type': j.job.get_real_instance_class()._meta.verbose_name.replace(' ', '_')\r\n        } for j in obj.job_host_summaries.select_related('job__job_template').order_by('-created')[:5]])\r\n```\r\n\r\nin `def get_summary_fields(self, obj):` in the `HostSerializer` but wasn't sure if that was performant or correct.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI've compiled the AWX application using the installer. When I run `docker logs -f awx_task`, I perpetually get the following error\r\n\r\n```\r\n2019-11-01 23:35:18,178 INFO spawned: 'channels-worker' with pid 3598\r\n2019-11-01 23:35:19,180 INFO success: channels-worker entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2019-11-01 23:35:20,443 - INFO - runworker - Using single-threaded worker.\r\n2019-11-01 23:35:20,443 - INFO - runworker - Running worker against channel layer default (asgi_amqp.core.AMQPChannelLayer)\r\n2019-11-01 23:35:20,444 - INFO - worker - Listening on channels websocket.connect, websocket.disconnect, websocket.receive\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 11, in <module>\r\n    load_entry_point('awx==6.1.0', 'console_scripts', 'awx-manage')()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 142, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 364, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/channels/management/commands/runworker.py\", line 83, in handle\r\n    worker.run()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/channels/worker.py\", line 87, in run\r\n    channel, content = self.channel_layer.receive_many(channels, block=True)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/asgiref/base_layer.py\", line 43, in receive_many\r\n    return self.receive(channels, block)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/asgi_amqp/core.py\", line 102, in receive\r\n    self._init_thread()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/asgi_amqp/core.py\", line 62, in _init_thread\r\n    self.tdata.connection = kombu.Connection(self.url)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/kombu/connection.py\", line 189, in __init__\r\n    url_params = parse_url(hostname)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/kombu/utils/url.py\", line 47, in parse_url\r\n    scheme, host, port, user, password, path, query = _parse_url(url)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/kombu/utils/url.py\", line 81, in url_to_parts\r\n    parts.port,\r\n  File \"/usr/lib64/python3.6/urllib/parse.py\", line 169, in port\r\n    port = int(port, 10)\r\nValueError: invalid literal for int() with base 10: 'ds'\r\n2019-11-01 23:35:20,720 INFO exited: channels-worker (exit status 1; not expected)\r\n```\r\n\r\nAny idea what's going on? Am I missing an environment variable?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.9.0\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1. I updated the inventory file, changing the following parameters:\r\n  - Commented out `dockerhub_base=ansible`\r\n  - Changed `postgres_data_dir` to `/opt/awx-psql-data`\r\n  - Changed `ssl_certificate` to `/etc/awx-ssl/awx-bundled-key.crt`\r\n  - Changed docker registry information\r\n  - Changed all passwords\r\n  - Changed `awx_official` to `true`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nI expected the `awx_task` and `awx_web` containers to start running.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nThe `awx_task` container displays the error above continuously.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThe same issue happens on AWX 7.0.0."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n- Feature Request\r\n\r\n##### SUMMARY\r\nRestore commit 885841caeaea0f7c86d39d6e7a66b960124289c2 to add support for BitBucket webhooks, since Server edition supports signed payloads and Cloud edition suggests IP Whitelists ([manage webhooks](https://confluence.atlassian.com/bitbucket/manage-webhooks-735643732.html) and [ip whitelist](https://confluence.atlassian.com/bitbucket/what-are-the-bitbucket-cloud-ip-addresses-i-should-use-to-configure-my-corporate-firewall-343343385.html))\r\n\r\n@jbradberry "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen AWX is deployed on OKD, it seems like its nginx web server can't start due to permissions denied error on port 80.\r\nThe StatefulSet-dedicated pod is still marked as running, yet you cannot reach the login mask through the route as OpenShift returns the \"Application not available\" error.\r\nI attached the log of awx-web container where you can see the error.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 9.0.0\r\n* AWX install method: openshift 3.11\r\n* Ansible version:  2.8.5\r\n* Operating System: CentOS 7.7\r\n* Web Browser: Firefox 70.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Install AWX 9.0.0 on OKD 3.11\r\n2. Try to reach the WebUI via route.\r\n\r\n##### EXPECTED RESULTS\r\nReach the login screen.\r\n\r\n##### ACTUAL RESULTS\r\nOKD returns the error \"Application is not available\".\r\n\r\n##### ADDITIONAL INFORMATION\r\n[awx-0.log](https://pastebin.com/JP0DVp7c)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI have an enviroment with Git 2FA based on 3rd party issued cookie. Usually I am updating my .gitconfig file to place a right path to cookie there, but in awx_task 8.0.0 it does not work\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 8.0.0\r\n* AWX install method: docker on linux\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Write a section in .gitconfig as\r\n\r\n```\r\n[http \"http://example.org\"]\r\ncookieFile = /tmp/cookie.txt\r\n```\r\n\r\n2. start GIT_TRACE_CURL=1 git clone\r\n\r\n\r\n##### EXPECTED RESULTS\r\nI am expecting to see cookies inside curl request\r\n\r\n##### ACTUAL RESULTS\r\nOutput contain no cookies in curl request\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\ncurl version inside container 7.29.0, which reportedly having cookies processing issues\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nHi, \r\n\r\nI am not sure if this is the right forum . I am trying to deploy awx-postgresql pod using helm chart stable/postgresql by setting up a local repo since the K8 cluster we are using does not have access to the open source docker hub to pull the bitnami Images.\r\n\r\nHave changed the docker image and repository location in the Charts/values.yaml downloaded from stable/postgresql and ran the helm install to see if the changes are working and I see the error below .  Please let me know if any one is aware of the error below.\r\n\r\nError: render error in \"postgresql/templates/statefulset.yaml\": template: postgresql/templates/statefulset.yaml:50:4: executing \"postgresql/templates/statefulset.yaml\" at <include \"postgresql.imagePullSecrets\" .>: error calling include: template: postgresql/templates/_helpers.tpl:276:48: executing \"postgresql.imagePullSecrets\" at <.Values.metrics.image.pullSecrets>: nil pointer evaluating interface {}.image\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: Kubernetes\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\nhelm install --dry-run --debug ./postgresql\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWhen the insights integration for AWX was written, plans were a thing, and the insights API and UI were very different.\r\n\r\nWe should walkthrough what is currently available and make something better.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n(I expect subtasks will live off of here.)\r\n\r\n##### SUMMARY\r\n\r\nAnsible is moving to collections. Collections have dependencies. Dependencies complicate providing coherent execution of playbooks. We have historically hidden this complexity for cloud modules, but it seeps in occasionally (especially with Azure), and we leave custom venv creation entirely to our users. This is complicated by the fact that the AWX operator is often not the playbook author. Our users aren’t venv and pip experts; we need to make things easier for them where we can.\r\n\r\nHence, AWX needs to expand to provision and manage execution environments, including how they get to execution nodes.\r\n\r\n**What is an execution environment?**\r\n\r\nAn execution environment definition consists of:\r\n- an ansible version\r\n- a python version (defaults to system python)\r\n- a tiny set of required python libraries\r\n- zero or more collections (optional, see below). This could be sourced from the requirements present in a playbook repo\r\n- python dependencies of those collections\r\n\r\nThe concept of specifying a set of collections for an environment is to resolve and install their dependencies. The collections themselves are not required to be in the environment (and arguably should not be.)\r\n\r\nAn execution environment is built from this definition. This will likely be a container image.\r\n\r\n**What should we provide to users?**\r\n\r\n1. Create a standardized definition of an execution environment. Given our ecosystem and the cloud world at large, I sense… YAML.\r\n2. Create a tool, that given this definition, creates an execution environment as a container image. It would do so by reading any provided collections, extracting the dependency information, and then creating the environment in a container image.\r\n- it should warn/error on dependency issues\r\n- it should warn/error if the collections do not claim compatibility with the provided Ansible version\r\n3. Add execution environments as first-order objects in AWX\r\n4. Read environment definitions from SCM as needed\r\n5. Manage how execution environments get on execution nodes. This is likely via container pull.\r\n6. Replace the existing ‘virtual environment’ construct with this\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nCurrently, external logging is done in-process in a logging.logger handler, even for event processing.\r\n\r\nThis causes many assorted problems:\r\n- when threads and forks are involved, deadlocks ensue due to CPython bugs\r\n- logging directly impacts event processing (and therefore anything to do with job output)\r\n- logging is difficult to debug\r\n- ~some users have reported that occasionally, duplicate events are sent~ (never mind, they had Splunk misconfigured)\r\n\r\nWe should move to a different model where logs are not shipped in-process, so that any issues with logging do not affect the stability and reliability of AWX itself.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nCorollary of #5153 and #4809\r\n\r\nRethink the way we manage the dependency graph. This hurts us at a large volume of jobs and cross project/inv dependencies\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nhttps://github.com/ansible/awx/issues/4809, but for project updates.\r\n\r\nSince playbook runs get their own fresh checkout (and could be on another branch anyway), this should be doable."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nEnable users to have a distributed network of execution nodes, where the only requirement is that the nodes have ansible-runner, ansible, and [receptor](https://github.com/project-receptor/receptor) installed. This node can then self register or be registered to the receptor network of which AWX control plane nodes will be receptor controllers (or able to dispatch work via a receptor controller).\r\n\r\nThis should be extended to be the only way jobs are executed - when a task is assigned to a node to be done, it should be done through that mechanism; there shouldn't be a separate way of running jobs.\r\n\r\nThis may mean replacing way work is dispatched to container groups as well, but that may be punted (not critical to ship this feature for all other nodes).\r\n\r\nAcceptance criteria:\r\n-----------------------------\r\n\r\n- [ ] In the case that the execution node can reach Tower via the receptor network, it should be able to self register.\r\n- [ ] If because of network topology only Tower can reach out to the execution node via the receptor network, then Tower should be able to find/register the execution node.\r\n- [ ] only requirement of execution nodes are ansible-runner, ansible, and receptor and ability to receive network traffic from at least one receptor controller\r\n- [ ] no downtime required when adding execution nodes\r\n- [ ] connections w/ receptor are all TCP\r\n- [ ] Right now our isolated node delivery time failure is 30 seconds, we will have similar resilience\r\n- [ ] If job gets received and started but we lose node during execution, will have to do same thing we do today as far as marking it as failed because job no longer found running\r\n- [ ] Each receptor can it manage multiple jobs at once, we should be able to dispatch more than one job at a time to an execution node\r\n- [ ] Currently there is nothing built into receptor/runner that would prevent us from OOMing the system, but we need to implement something (capacity check of some kind) because currently we do this w/ isolated heartbeat + dispatcher\r\n\r\nQuestions to be answered:\r\n---------------------------------------\r\n- [ ] Multiple receptors can cohabitate on same system, can an execution node get registered several times under each of these receptors?\r\n\r\nAdditional notes:\r\n------------------------\r\nReceptor does not fork, hands off work to plugin that may fork\r\nPlugin COULD be written in way that never gave control back to runner, which would force serial execution.\r\nRunner plugin is written in such a way that should allow multiple calls to runner plugin, e.g. parallel job."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nFollowon of https://github.com/ansible/awx/issues/5149 (and its predecessors).\r\n\r\nGiven the ability to expose a custom inventory plugin via a collection for use as an inventory source, we should allow configuring a generic custom inventory source where the configuration data is merely \"a plugin configuration file\".\r\n\r\nFrom a related (duplicate) issue filed by @AlanCoding:\r\n\r\nRight now, there is no way to use an inventory plugin-style YAML configuration aside from checking it into source control. We have had several inquiries related to this, so this is proposed as a solution to resolve all of those use cases.\r\n\r\nThings we can say this feature would necessary need to have:\r\n\r\n - form elements\r\n   - Place to select a credential or multiple credentials\r\n   - Place to enter YAML content of the inventory plugin (no JSON)\r\n   - (unclear) filename may or may not need to be independently specified, the only known stubborn exception that could require this is [VMWare](https://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/inventory/vmware_vm_inventory.py#L278)\r\n   - any other shared elements with whatever type of resource it is (like NAME)\r\n - The YAML content will be required to have `plugin: foo` as a top-level entry\r\n - The form will enforce that supported types use a credential of its corresponding type\r\n   - possible additional feature - allow custom types to claim an inventory plugin namespace\r\n - Inventory updates already use plugins, this will do very little different, just using the config that the user gives\r\n - A \"convert to plugin\" button on existing inventory sources that work with plugins\r\n   - this will start the user out with a configuration that gives compatibility with existing behavior, which they can then modify at will\r\n\r\nQuestions still remain. Will this be another type, similar to inventory scripts? Or will it be another option for `source` of an inventory source? Will there be any way for the user to alter ansible.cfg options, like the group name conversion?"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nFollowon of https://github.com/ansible/awx/issues/3776.\r\n\r\nOnce collections can be exposed in some way (imagine handwaving here), however they are exposed needs to work such that an custom inventory plugin can be sourced from a collection (as opposed to requiring it be in source control only).\r\n\r\n\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\ntower-cli has send/receive, for exporting subsets of AWX assets for import into another AWX instance. This is commonly used as a mechanism of \"promoting\" automation from a dev instance to a production instance.\r\n\r\nIt dumps full json structure, including dereferincing linked inventories/projects/etc by name, instead of ID, for portability.\r\n\r\nWe should figure out a way to handle this natively in AWX and/or its CLI.\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nMacOS Catalina users might be impacted by increased requirements for ca certs. If the user does not provide a cert at installtime, our tower-packaging playbook will generate a CA Cert which does not meet the requirements here https://support.apple.com/en-us/HT210176.\r\n\r\nThis means that all fresh installs of ansible tower after July 1st will generate a CA Cert which blocks macOS Catalina Users from accessing the Web app with Chrome.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Any version of tower without a ssl cert passed at install-time\r\n* Operating System: macOS Catalina (only)\r\n* Web Browser: Chrome any (only chrome)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nDeploy tower without providing a SSL cert.\r\nFrom a macOS Catalina + Chrome browser, attempt to access tower's UI\r\n\r\n##### EXPECTED RESULTS\r\n\r\nStandard Self Signed Cert errors and the ability to proceed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nStandard Self Signed Cert errors and no ability to proceed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nBased on the research and troubleshooting done within this ticket: https://github.com/ansible/awx/issues/5122"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nIn small environments (one node setups) a job may increase the maximum capacity in terms of forks which might crash the system.\r\nTherefore I suggest a  global options (maybe per instance) which sets a limit for the number of forks per job. If a job increases this limit it should be prevented from running or saving the job template should result in an error.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe \"HashiCorp Vault Secret Lookup\" and \"Hashicorp Vault Signed SSH\" Credential Types provide both a test option which check if the parameters are working. In both cases the running the test case requires sysadmin permissions.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.11\r\n* Operating System: Debian 9\r\n* Web Browser: Firefox 69\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLogin to AWX as non-sysadmin user. In the AWX Webinterface go to \"Credentials\" and create a new Credential of Type \"HashiCorp Vault Secret Lookup\". Fill in \"Server Url\", \"token\" and if necessary CA Certificate. Then open the \"Test external credential\" form by clicking the \"Test\" Buttion. Fill in \"path to secret\" and \"key name\" then click \"run\". The Test will fail.\r\n\r\nIf you run the same steps as sysadmin user, then the test will succeed.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA user which is allowed to create a credential of type \"Hashicorp Vault Secret Lookup\" should be allowed to run the test.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNon-sysadmin users are not allowed to test \"HashiCorp Vault Secret Lookup\" Credentials.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThe azure keyvault credentials plugin found here:\r\nawx/awx/main/credential_plugins/azure_kv.py \r\n\r\nIs hard coded to use the azure commercial cloud vault URL: \r\n```\r\ndef auth_callback(server, resource, scope):\r\n        credentials = ServicePrincipalCredentials(\r\n            url = url,\r\n            client_id = kwargs['client'],\r\n            secret = kwargs['secret'],\r\n            tenant = kwargs['tenant'],\r\n            resource = \"https://vault.azure.net\",\r\n        )\r\n```\r\nIt would be great to either have a second plugin for azure government or a field in the plugin to select AzureCloud or AzureUSGovernment similar to the credential type \"Microsoft Azure Resource Manager\"  \r\n\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIf I want delete a schedule I get an error, no matter if I use the GUI or the API.\r\nOther schedules can be deleted, only this one can't.\r\nIt's possible to change the schedule with PATCH and PUT, only DELETE isn't possible.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.4\r\n* Operating System: Windows\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nDelete the schedule. (GUI or API)\r\n`DELETE /api/v2/schedules/22/\r\n`\r\n\r\n##### EXPECTED RESULTS\r\nDeleting the schedule.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nERROR!\r\nCall to /api/v2/schedules/22/ failed. DELETE returned: 500 A server error has occurred.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n194.97.51.12 - - [29/Oct/2019:13:18:51 +0000] \"OPTIONS /api/v2/workflow_job_templates/ HTTP/1.1\" 200 11822 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\"\r\n[pid: 390|app: 0|req: 24/8580] 194.97.51.12 () {50 vars in 2498 bytes} [Tue Oct 29 13:18:51 2019] OPTIONS /api/v2/workflow_job_templates/ => generated 11822 bytes in 210 msecs (HTTP/1.1 200) 10 headers in 404 bytes (1 switches on core 0)\r\n194.97.51.12 - - [29/Oct/2019:13:18:52 +0000] \"OPTIONS /api/v2/job_templates/ HTTP/1.1\" 200 21596 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\"\r\n[pid: 341|app: 0|req: 298/8581] 194.97.51.12 () {50 vars in 2480 bytes} [Tue Oct 29 13:18:51 2019] OPTIONS /api/v2/job_templates/ => generated 21596 bytes in 540 msecs (HTTP/1.1 200) 10 headers in 404 bytes (1 switches on core 0)\r\n[pid: 334|app: 0|req: 455/8582] 194.97.51.12 () {50 vars in 2613 bytes} [Tue Oct 29 13:18:51 2019] GET /api/v2/unified_job_templates/?page_size=20&order_by=name&type=workflow_job_template,job_template => generated 73122 bytes in 661 msecs (HTTP/1.1 200) 8 headers in 233 bytes (1 switches on core 0)\r\n194.97.51.12 - - [29/Oct/2019:13:18:52 +0000] \"GET /api/v2/unified_job_templates/?page_size=20&order_by=name&type=workflow_job_template,job_template HTTP/1.1\" 200 73122 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\"\r\n194.97.51.12 - - [29/Oct/2019:13:18:52 +0000] \"OPTIONS /api/v2/unified_job_templates/ HTTP/1.1\" 200 9178 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\"\r\n[pid: 373|app: 0|req: 153/8583] 194.97.51.12 () {56 vars in 2621 bytes} [Tue Oct 29 13:18:52 2019] OPTIONS /api/v2/unified_job_templates/ => generated 9178 bytes in 67 msecs (HTTP/1.1 200) 8 headers in 232 bytes (1 switches on core 0)\r\n194.97.51.12 - - [29/Oct/2019:13:18:55 +0000] \"OPTIONS /api/v2/unified_jobs/ HTTP/1.1\" 200 10288 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\"\r\n[pid: 390|app: 0|req: 25/8584] 194.97.51.12 () {56 vars in 2602 bytes} [Tue Oct 29 13:18:55 2019] OPTIONS /api/v2/unified_jobs/ => generated 10288 bytes in 75 msecs (HTTP/1.1 200) 8 headers in 233 bytes (1 switches on core 0)\r\n[pid: 312|app: 0|req: 654/8585] 194.97.51.12 () {50 vars in 2592 bytes} [Tue Oct 29 13:18:55 2019] GET /api/v2/schedules/?page_size=20&order_by=unified_job_template__polymorphic_ctype__model => generated 20134 bytes in 164 msecs (HTTP/1.1 200) 8 headers in 239 bytes (1 switches on core 0)\r\n194.97.51.12 - - [29/Oct/2019:13:18:55 +0000] \"GET /api/v2/schedules/?page_size=20&order_by=unified_job_template__polymorphic_ctype__model HTTP/1.1\" 200 20134 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\"\r\n194.97.51.12 - - [29/Oct/2019:13:18:55 +0000] \"OPTIONS /api/v2/schedules/ HTTP/1.1\" 200 13197 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\"\r\n[pid: 373|app: 0|req: 154/8586] 194.97.51.12 () {56 vars in 2596 bytes} [Tue Oct 29 13:18:55 2019] OPTIONS /api/v2/schedules/ => generated 13197 bytes in 94 msecs (HTTP/1.1 200) 8 headers in 239 bytes (1 switches on core 0)\r\n194.97.51.12 - - [29/Oct/2019:13:18:55 +0000] \"OPTIONS /api/v2/schedules/ HTTP/1.1\" 200 13197 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\"\r\n[pid: 334|app: 0|req: 456/8587] 194.97.51.12 () {56 vars in 2596 bytes} [Tue Oct 29 13:18:55 2019] OPTIONS /api/v2/schedules/ => generated 13197 bytes in 97 msecs (HTTP/1.1 200) 8 headers in 239 bytes (1 switches on core 0)\r\nRESULT 2\r\nOKREADY\r\n[pid: 390|app: 0|req: 26/8588] 194.97.51.12 () {34 vars in 439 bytes} [Tue Oct 29 13:19:02 2019] GET /api/v2/ping/ => generated 330 bytes in 47 msecs (HTTP/1.1 200) 8 headers in 231 bytes (1 switches on core 0)\r\n194.97.51.12 - - [29/Oct/2019:13:19:02 +0000] \"GET /api/v2/ping/ HTTP/1.1\" 200 330 \"-\" \"check_http/v2.2 (monitoring-plugins 2.2)\" \"-\"\r\n2019-10-29 13:19:05,855 ERROR    django.request Internal Server Error: /api/v2/schedules/22/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\n    return self.connection.commit()\r\npsycopg2.IntegrityError: update or delete on table \"main_schedule\" violates foreign key constraint \"main_unifiedjob_schedule_id_766ca767_fk_main_schedule_id\" on table \"main_unifiedjob\"\r\nDETAIL:  Key (id)=(22) is still referenced from table \"main_unifiedjob\".\r\n\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 115, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 113, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n    return func(*args, **kwds)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/transaction.py\", line 240, in __exit__\r\n    connection.commit()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 262, in commit\r\n    self._commit()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\n    return self.connection.commit()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/utils.py\", line 89, in __exit__\r\n    raise dj_exc_value.with_traceback(traceback) from exc_value\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\n    return self.connection.commit()\r\ndjango.db.utils.IntegrityError: update or delete on table \"main_schedule\" violates foreign key constraint \"main_unifiedjob_schedule_id_766ca767_fk_main_schedule_id\" on table \"main_unifiedjob\"\r\nDETAIL:  Key (id)=(22) is still referenced from table \"main_unifiedjob\".\r\n\r\n2019-10-29 13:19:05,855 ERROR    django.request Internal Server Error: /api/v2/schedules/22/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\n    return self.connection.commit()\r\npsycopg2.IntegrityError: update or delete on table \"main_schedule\" violates foreign key constraint \"main_unifiedjob_schedule_id_766ca767_fk_main_schedule_id\" on table \"main_unifiedjob\"\r\nDETAIL:  Key (id)=(22) is still referenced from table \"main_unifiedjob\".\r\n\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 115, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 113, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n    return func(*args, **kwds)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/transaction.py\", line 240, in __exit__\r\n    connection.commit()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 262, in commit\r\n    self._commit()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\n    return self.connection.commit()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/utils.py\", line 89, in __exit__\r\n    raise dj_exc_value.with_traceback(traceback) from exc_value\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\n    return self.connection.commit()\r\ndjango.db.utils.IntegrityError: update or delete on table \"main_schedule\" violates foreign key constraint \"main_unifiedjob_schedule_id_766ca767_fk_main_schedule_id\" on table \"main_unifiedjob\"\r\nDETAIL:  Key (id)=(22) is still referenced from table \"main_unifiedjob\".\r\n\r\n[pid: 373|app: 0|req: 155/8589] 194.97.51.12 () {54 vars in 2591 bytes} [Tue Oct 29 13:19:05 2019] DELETE /api/v2/schedules/22/ => generated 41 bytes in 100 msecs (HTTP/1.1 500) 5 headers in 185 bytes (1 switches on core 0)\r\n194.97.51.12 - - [29/Oct/2019:13:19:05 +0000] \"DELETE /api/v2/schedules/22/ HTTP/1.1\" 500 41 \"https://awx.freenet-group.de/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36\" \"-\""},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nFor one of our SLIs (service level indicators) we should measure how much data has been lost due to networking errors or processing errors.\r\n\r\nWe'll need some data from tower to measure this:\r\n* Counts of event, unified_job, and job_template tables\r\n\r\nThey would need to be added to the bundle along with the span of time that they cover.  This should go back much further than the current bundle so that the count overlaps bundles.  \r\n\r\n##### Additional Notes\r\n\r\n* Exclude job updates from job counts\r\n* Set the count to go back 7 days for starters"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI am trying to run an AWX workflow template made up of 3 simple templates.  The first template completes with \"Success\" and the workflow moves on to the second template.  The second template completes with \"Success\", briefly, then throws the following error in the job pane on the left:\r\n\r\nError\r\nSTARTED\r\n10/25/2019 9:25:44 AM\r\nFINISHED\r\n10/25/2019 9:29:40 AM\r\nERROR DETAILS\r\nTraceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf' During handling of the above exception, another exception occurred: Traceback (most recent call last): File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/awx/main/tasks.py\", line 1346, in run res = ansible_runner.interface.run(**params) File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/interface.py\", line 178, in run r.run() File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 262, in run _delete() File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 258, in _delete res = _delete(retries=retries - 1) File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 258, in _delete res = _delete(retries=retries - 1) File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 258, in _delete res = _delete(retries=retries - 1) [Previous line repeated 11 more times] File \"/opt/rh/rh-python36/root/usr/lib/python3.6/site-packages/ansible_runner/runner.py\", line 253, in _delete shutil.rmtree(self.config.process_isolation_path_actual) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 480, in rmtree _rmtree_safe_fd(fd, path, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 418, in _rmtree_safe_fd _rmtree_safe_fd(dirfd, fullname, onerror) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 422, in _rmtree_safe_fd onerror(os.rmdir, fullname, sys.exc_info()) File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/shutil.py\", line 420, in _rmtree_safe_fd os.rmdir(name, dir_fd=topfd) OSError: [Errno 16] Device or resource busy: 'awx_9_a_i576bf'\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0.599-1\r\n* AWX install method: AWX rpm\r\n* Ansible version:  2.8.5\r\n* Operating System: CentOS 7.5\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a workflow with multiple templates connected by success relationships and run\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAfter seeing the ansible run succeed, I would expect the workflow to move on the next template instead of throwing an error\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAnsible run succeeds, then workflow errors out"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\n\r\nRequest to expose the backup/restore playbooks from the Tower UI. "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe OPTIONS for job_templates is not self-consistent for the field `webhook_service`.\r\n\r\nThis breaks the `tower-cli send` command, assuming the data comes from the receive command. A hack is in progress for this, but it would be better to change behavior from API moving forward.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 8.0.0\r\n* AWX install method: N/A\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nOf particular interest here is the sequence of `tower-cli receive`, saving that to a file, and using it in `tower-cli send`.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nData given from the API is consistent with OPTIONS\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOPTIONS for job_templates gives\r\n\r\n```json\r\n            \"webhook_service\": {\r\n                \"type\": \"choice\",\r\n                \"label\": \"Webhook service\",\r\n                \"help_text\": \"Service that webhook requests will be accepted from\",\r\n                \"filterable\": true,\r\n                \"choices\": [\r\n                    [\r\n                        \"github\",\r\n                        \"GitHub\"\r\n                    ],\r\n                    [\r\n                        \"gitlab\",\r\n                        \"GitLab\"\r\n                    ]\r\n                ]\r\n```\r\n\r\nThe receive command always gives `webhook_credential` in the asset data because it has no default. Without a default, it cannot be determined if the field has been set.\r\n\r\nThe send command gives\r\n\r\n```\r\nJOB TEMPLATE [SRtest] ***************************************************************************************************************************************************************\r\nValue  is not a valid choice for option webhook_service for job_template SRtest. Options: ['github', 'GitHub', 'gitlab', 'GitLab']\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhttps://github.com/ansible/tower-cli/pull/741\r\n\r\nPing @jbradberry, @john-westcott-iv \r\n\r\nIn terms of CLI design in general, @ryanpetrello I find the ability to determine if a field has a non-default value is a powerful tool. This is one of the things I most like about the send/receive commands. I would even prefer that for compact representations of resources for human consumption.\r\n"},{"labels":["api",null,null,null,null],"text":"Add the ability to easily run re-tries of jobs through workflows rather than having to program those into playbooks."},{"labels":["api",null,null,null,null],"text":"Please add dynamic aggregation/population of workflow surveys with the required answers from child job templates of the workflow."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCustomer request:\r\n\r\nTower workflows are lacking a key feature of adding custom links. Today, user can only choose SUCCESS, FAILURE & ALWAYS. But there is no way to have custom defined links. Users want to define custom link name and build workflows using those links. If Job template output is 405, it should take branch A, if Job template output is 407, it should take branch B,  so on..."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\nCurrently, in certain scenarios jobs can end up getting funneled to Container Groups because they always **seem** to have capacity from the Tower side. Due to this naive concept of capacity, jobs may get less-than-optimally sent to the ContainerGroup where they may end up waiting on resources, while meanwhile resources are free'd up in other instance groups or container groups, leading to the job sitting in pending for longer than it needs to (or in worst case for a very saturated k8s cluster, failing due to time out waiting for resources, while there was other place it could have run).\r\n\r\nTo resolve this, we should do some kind of introspection to find out if the container group is \"full\" or if the job is schedulable. If so, we can redirect it to another instance group or wait until some other resource is available instead of dispatching it to the container group where it may very well time out and fail before running.\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nThis RFE replaces the bug report https://github.com/ansible/awx/issues/4990"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWhen specifying `ignore_unreachable: yes` in a playbook task, any hosts that were unreachable at the time show as `unreachable` and `skipped`, but not `failed`. \r\n\r\nHowever, when you look in the AWX host inventory view, hosts that were unreachable but didn't essentially fail show as failing:\r\n\r\n![image](https://user-images.githubusercontent.com/25699347/67393872-40df5b00-f571-11e9-8d0b-7c1566b1214d.png)\r\n\r\nIn the preceding example, CentOS1 was unreachable while CentOS2 was reachable. The playbook task had `ignore_unreachable: yes` included. The `PLAY RECAP` shows CentOS1 being unreachable and skipped, but not failed:\r\n\r\n~~~\r\nPLAY RECAP *********************************************************************\r\nCentOS1                    : ok=0    changed=0    unreachable=1    failed=0    skipped=1    rescued=0    ignored=0   \r\nCentOS2                    : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \r\n~~~\r\n\r\nOddly though, in `awx-manage shell_plus`, CentOS1 is showing active failures:\r\n\r\n~~~\r\n>>> r = Host.objects.filter(id=34)\r\n>>> for x in r:\r\n...     print(x.has_active_failures)\r\n... \r\nTrue\r\n~~~\r\n\r\nAs a test, I went into `psql` and manually updated `main_host` to change `has_active_failures` to `False`. After doing this, I verified the change via `awx-manage shell_plus` and re-ran the same job template.\r\n\r\n~~~\r\n>>> r = Host.objects.filter(id=34)\r\n>>> for x in r:\r\n...     print(x.has_active_failures)\r\n... \r\nFalse\r\n~~~\r\n\r\nAs I would expect, the job template was successful, however, CentOS1 was still marked as a failed node, even though no failures were reported in the `PLAY RECAP`.\r\n\r\nI verified the reversion via `awx-manage shell_plus`:\r\n\r\n~~~\r\n>>> r = Host.objects.filter(id=34)\r\n>>> for x in r:\r\n...     print(x.has_active_failures)\r\n... \r\nTrue\r\n~~~\r\n\r\nPer an user's request, they would like to see hosts that were marked `unreachable` and `skipped`, but not `failed` as successful in the AWX inventory host view."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhe have an internal dns with a domain like \"org.les800\"\r\nwhen i'm trying to set the base url of the tower host with something like \"tower.org.les800\", it fail with an error 400 and url not valid\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 8.0.0\r\n* AWX install method: MrMee rpm\r\n* Ansible version:  2.8.6\r\n* Operating System: CentOS 7.7\r\n* Web Browser: Chrome latest\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\ntry an url like http://tower.org.les800 in settings/system\r\n\r\n##### EXPECTED RESULTS\r\n\r\nurl for the base host set\r\n\r\n##### ACTUAL RESULTS\r\n\r\ngot url with the name of the server instead\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen creating an Openstack Credential, no field is provided to specify the region of the cluster. This results in Openstack using the default cluster. Additionally, specifying a region_name in the source variables section of the inventory source page does not work.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 8.0.0.0 (but tried with 7.0.0.0 too)\r\n* AWX install method: docker-compose using playbook\r\n* Ansible version:  2.8.2\r\n* Operating System: Ubuntu 18.10 w/ 4.18.0-25-generic\r\n* Web Browser: Chrome 77\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPart 1:\r\nGo to Credentials. Hit Green Plus. Select OpenStack as Credential Type\r\n\r\nPart 2: \r\nGo to Existing Inventory. Select Sources tab. Hit Green Plus. Fill in name, select Openstack as Source. In source Variables, include the following (I wanted to try everything):\r\n\r\n```\r\nclouds:\r\n  devstack:\r\n    region_name: ABC\r\n    region: ABC\r\n    auth:\r\n      region_name: ABC\r\n      region: ABC\r\nregion_name: ABC\r\nregion: ABC\r\n```\r\n \r\n##### EXPECTED RESULTS\r\n\r\nPart 1:\r\nA Region field should be present.\r\n\r\nPart 2:\r\nThe YML be added to the generated YML, and for data to be collected from the correct region, rather than the default\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPart 1:\r\nNo region field is present\r\n\r\nPart 2:\r\nThe Generated YML appears not to include the region_name key, but it does include any vars included under the `ansible:` key.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe example at https://github.com/ansible/ansible/blob/devel/contrib/inventory/openstack.yml does not include a region for Openstack, but the code at https://github.com/ansible/ansible/blob/devel/contrib/inventory/openstack_inventory.py does make references to a `region` variable.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently it seems not possible to change the awx **secret_key** (from installer/inventory) to be able to change the credential encryption key - or is it possible?\r\n\r\nWill this be supported in the future?"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently, only static tokens are allowed as the inputs to integrate Hashicorp Vault with AWX.  Customer wants the following:\r\n\r\nFor Approle:\r\nInput approle_id (which exists on the Hashicorp Vault side) in a Vault Signed SSH and Vault Secrets credential.  The resultant output of this will be the Secret Token being filled in and returned from the API call to Hashicorp Vault.\r\nDocs >>>>> https://www.vaultproject.io/docs/auth/approle.html\r\n\r\nFor AD/LDAP:\r\nInput username and password (AD/LDAP integration exists on the Hashicorp Vault side) in a Vault Signed SSH and Vault Secrets credential.  The resultant output of this will be the Secret Token being filled in and returned from the API call to Hashicorp Vault.\r\nDocs >>>>> https://www.vaultproject.io/docs/auth/ldap.html\r\n\r\nEach time the credential is used, this API call should be made and the secret token should be updated.  This will allow for short-lived TTLs on secret tokens and reduces the amount of manual effort to update secret tokens. \r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThe idea here is that we could replace this icon:\r\n\r\n<img width=\"1486\" alt=\"Screen Shot 2019-10-22 at 2 45 20 PM\" src=\"https://user-images.githubusercontent.com/9889020/67319233-a8969700-f4da-11e9-9d0b-1d00639840e4.png\">\r\n<img width=\"1487\" alt=\"Screen Shot 2019-10-22 at 2 45 26 PM\" src=\"https://user-images.githubusercontent.com/9889020/67319235-a8969700-f4da-11e9-9120-0973f779a8f9.png\">\r\n\r\nWith a sparkline of recent jobs (the same thing we show in the popover currently).  I don't think this will be possible without some API help though as we don't get this level of information from the API currently on the `inventories` endpoint.  We currently make an extra request when the user clicks on the circular status icon in order to fetch recent jobs.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWhen an inventory import is ran, the CLI option `--playbook-dir` is added to the `ansible-inventory` call with the directory that the inventory is in (or the directory itself if given a directory instead of a file).\r\n\r\nStarting in Ansible 2.9, users can specify a custom playbook directory via the config.\r\n\r\nhttps://github.com/ansible/ansible/blob/74f981688585ba611f4a625147068d20dc60cdb6/lib/ansible/config/base.yml#L1691-L1698\r\n\r\nIn order for this to be usable in AWX, we need to _not_ apply `--playbook-dir` if the config file has that `playbook_dir` setting.\r\n\r\nVery similar issue to https://github.com/ansible/awx/issues/5019, but slightly different with no API interface or UI changes.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen I am an Admin of a Job Template, I am unable to add labels to this job. I got a 403 (Forbidden) when I click on the save button\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.5\r\n* Operating System: CentOS 7.7.1908\r\n* Web Browser: Google Chrome Version 77.0.3865.120 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate an organisation -> then a team -> then a user \r\n![image](https://user-images.githubusercontent.com/14820052/67286332-7fc1d200-f4d9-11e9-96b0-967378ddf9df.png)\r\n\r\nAdd job template admin permission to the team (type organization) and other admin permissions.\r\n![image](https://user-images.githubusercontent.com/14820052/67284995-fad5b900-f4d6-11e9-835c-0767dcfce0f3.png)\r\n\r\nMy user is member of the SCM Team and the SCM Team is member of the organization SCMOPS and got the same permissions. I'm logged in with the last user who have the role \"ADMIN\" for the Job Template and have the team role \"JOB TEMPLATE ADMIN\"\r\n\r\nCreate a job template and try to add a labels then click save. Press F12 and check your browser console. You will see 403 (Forbidden) \"You do not have permission to perform this action\"\r\n\r\n![image](https://user-images.githubusercontent.com/14820052/67284688-5ce1ee80-f4d6-11e9-9da1-4d52c8270992.png)\r\n\r\n![image](https://user-images.githubusercontent.com/14820052/67284217-759dd480-f4d5-11e9-89d2-15293f3fd33e.png)\r\n\r\n![image](https://user-images.githubusercontent.com/14820052/67284404-cf9e9a00-f4d5-11e9-9430-302af2741d6c.png)\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nAll Job Template admin must be able to add labels on their Job Template as mentionned in the documentation here : https://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html#create-a-job-template\r\n\r\n> Members of the Organization can create labels on a Job Template if they have edit permissions (such as admin role).\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n![image](https://user-images.githubusercontent.com/14820052/67284217-759dd480-f4d5-11e9-89d2-15293f3fd33e.png)\r\n\r\n![image](https://user-images.githubusercontent.com/14820052/67284404-cf9e9a00-f4d5-11e9-9430-302af2741d6c.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThe only way to have this working is to add users to the organization too or only in the organization\r\n\r\n![image](https://user-images.githubusercontent.com/14820052/67286562-e6df8680-f4d9-11e9-8483-0ee9a41c02e1.png)\r\n\r\nAnother remark, we can remove label without any error but we can't add one.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIf I set the URL of AWX Template or Workflow (SURVEY added) to GitHub Webhook and execute it, a 500 error will occur.\r\n\r\n**Error Response Body**\r\n\r\n```\r\n{\"detail\":\"A server error has occurred.\"}\r\n```\r\n\r\nIf SURVEY is not added, no error will occur.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 8.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.6\r\n* Operating System: CentOS Linux release 7.7.1908 (Core)\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create of AWX Template(Workflow).\r\n2. Added SURVEY variable in Template(Workflow).\r\n3. Enable execution of Template(Workflow) via webhook.\r\n4. Set the template(Workflow) URL to the GitHub webhook.\r\n5. Push to GitHub repository.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI was expecting the Template to execute via webhook.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n500 Internal Server Error\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAwx deployment failing at task TASK [kubernetes : Apply Deployment]\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 8.0.0\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.8.4\r\n* Operating System: MacOS Catalina/ Ubuntu 16.04\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nrun the isntaller with ansible-playbook -i inventory install.yml\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\ndeployment failing - full log attached to this issue.\r\nversion 6.0.0 and 7.0.0 were running fine on the same platform.\r\n\r\nfrom httplib import HTTPConnection\\n    import sys\\n    import os\\n    import base64\\n    authsecret = base64.b64encode(os.getenv('RABBITMQ_USER') + ':' + os.getenv('RABBITMQ_PASSWORD'))\\n    conn=HTTPConnection('localhost:15672')\\n    conn.request('GET', '/api/healthchecks/node', headers={'Authorization': 'Basic %s' % authsecret})\\n    r1 = conn.getresponse()\\n    if r1.status != 200:\\n      sys.stderr.write('Received http error %i\\\\n' % (r1.status))\\n      sys.exit(1)\\n    body = r1.read()\\n    if body != '{\\\"status\\\":\\\"ok\\\"}':\\n      sys.stderr.write('Received body: %s' % body)\\n      sys.exit(2)\\n    sys.exit(0)\\n---\\napiVersion: v1\\nkind: Service\\nmetadata:\\n  name: awx-web-svc\\n  namespace: awx\\n  labels:\\n    name: awx-web-svc\\nspec:\\n  type: \\\"NodePort\\\"\\n  ports:\\n    - name: http\\n      port: 80\\n      targetPort: 8052\\n  selector:\\n    name: awx-web-deploy\\n---\\napiVersion: v1\\nkind: Service\\nmetadata:\\n  name: awx-rmq-mgmt\\n  namespace: awx\\n  labels:\\n    name: awx-rmq-mgmt\\nspec:\\n  type: ClusterIP\\n  ports:\\n    - name: rmqmgmt\\n      port: 15672\\n      targetPort: 15672\\n  selector:\\n    name: awx-web-deploy\\n---\\napiVersion: extensions/v1beta1\\nkind: Ingress\\nmetadata:\\n  name: awx-web-svc\\n  namespace: awx\\nspec:\\n  backend:\\n    serviceName: awx-web-svc\\n    servicePort: 80\\n\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2019-10-22 08:36:40.042215\", \"stderr\": \"error: error parsing STDIN: error converting YAML to JSON: yaml: line 25: could not find expected ':'\", \"stderr_lines\": [\"error: error parsing STDIN: error converting YAML to JSON: yaml: line 25: could not find expected ':'\"], \"stdout\": \"serviceaccount/awx unchanged\\nservice/rabbitmq created\\nconfigmap/rabbitmq-config created\\nrole.rbac.authorization.k8s.io/endpoint-reader unchanged\\nrolebinding.rbac.authorization.k8s.io/endpoint-reader unchanged\\nstatefulset.apps/awx created\", \"stdout_lines\": [\"serviceaccount/awx unchanged\", \"service/rabbitmq created\", \"configmap/rabbitmq-config created\", \"role.rbac.authorization.k8s.io/endpoint-reader unchanged\", \"rolebinding.rbac.authorization.k8s.io/endpoint-reader unchanged\", \"statefulset.apps/awx created\"]}\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n[awx8_error.log](https://github.com/ansible/awx/files/3755130/awx8_error.log)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea/Question\r\n\r\n##### SUMMARY\r\nIs there any way to currently specify extra environment variables for a job template? I can specify extra environment variables for all jobs under `Settings -> Jobs`, but I haven't been able to find any way of doing this only for a single job or job template. More specifically I would like to specify the `display_skipped_hosts`-setting for a single job template without affecting the rest of the jobs.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nBackground issue for https://github.com/ansible/awx/issues/5048.\r\n\r\nThe UI includes a \"Launched By\" tag to denote how something was launched.\r\nIt is propagated by some combination of:\r\n- created_by (for the launching user)\r\n- related schedule (for scheduled jobs)\r\n\r\nThis means you get the following:\r\n- JT launched manually: user who launched job\r\n- JT launched from schedule: schedule that launched job\r\n- JT launched from a workflow manually: user who launched workflow\r\n- Workflow launched manually: user who launched workflow\r\n- Workflow launched from schedule: schedule that launched workflow\r\n- JT launched from a workflow launched by a schedule: nothing!\r\n\r\nFor now, we're just not going to show the field in that final case, but we should propagate something via the API to give useful data here.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nUnable to sync with Git after updating to 7\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on Linux\r\n* Ansible version:  2.8.5\r\n* Operating System: RHEL 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nUse the web UI to configure Git Source Control credentials\r\nUse web UI to configure git repository under Projects\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nSuccessful download of Git repository\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nError message and failed download\r\n\r\n\"Cloning into '/var/lib/awx/projects/_8__playbook'...\",\r\n        \"fatal: unable to access 'https://$encrypted$:$encrypted$@server.localdomain/ansible-playbook/playbook.git/': Invalid file descriptor\"##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Request\r\n\r\n##### SUMMARY\r\n\r\nA user was wondering how AWX handles a change in LDAP Team Mapping (e.g. If the `is_superuser` mapping is removed, does AWX update the user objects?).\r\n\r\nI observed the following:\r\n\r\nIf the `LDAP User Flags by Group` is removed, pre-existing users in AWX do not update according to the changes made. \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1. Create a LDAP connection from AWX.\r\n2. Specify a `LDAP User Flags by Group` parameter.\r\n3. Login with a LDAP user and verify its creation within AWX.\r\n4. Verify the user has the proper permissions.\r\n5. Change the `LDAP User Flags by Group` to no longer reflect the user.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nI would expect the user object within AWX to update itself based on the LDAP mapping specified.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nIt looks like the user object has to be manually updated in order for the permissions to update. If `is_superuser` is granted to many users in a LDAP group and the mapping has to change, this could be an undesired behavior."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI have nested workflow templates, when I set Prompt on launch on child workflow template and set Inventory through \"Prompt\" in Workflow visualizer, then Launch is in Running state forever and Workflow job for child Workflow template doesn't exist (is probably deleted, because there is missing ID in list of Jobs)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Tower 3.5.0\r\n* AWX install method: AMI -  https://www.ansible.com/products/tower/trial - Tower in Amazon EC2\r\n* Ansible version:  2.8.0\r\n* Operating System: \r\n* Web Browser: Google Chrome 77.0.3865.120\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nChild Workflow template contains: \r\n- No inventory, Prompt on launch\r\n- Job Template with https://github.com/mkanoor/playbook/blob/master/hello_world.yml\r\n  - No inventory, Prompt on launch\r\n- Workflow Job Template Node with Inventory1 (added through \"Prompt\" button in Workflow visualizer)\r\n\r\nParent Workflow template contains:\r\n- No inventory\r\n- Child workflow\r\n  - (No inventory, Prompt on Launch)\r\n- Workflow Job Template Node with Inventory2  (added through \"Prompt\" button in Workflow visualizer)\r\n\r\n```\r\nParent Workflow (without Inventory)\r\n(Start) ==> (Inventory2 on Workflow Node) ==> [ \r\n      Child Workflow (without Inventory, Prompt on Launch) =>\r\n          (Start) ==> (Inventory1 on Workflow Node) ==> Job Template with Prompt on Launch  \r\n]\r\n```\r\n##### EXPECTED RESULTS\r\n\r\nJob Template should be successfully finished (I suppose with Inventory2?)\r\n\r\n##### ACTUAL RESULTS\r\n\r\nParent workflow job Status = Running forever\r\nChild workflow job doesn't exist (probably deleted, one ID in Jobs is missing)\r\nAPI:\r\n(the only node) in `api/workflow_jobs/<parent_workflow_id>/workflow_nodes` doesn't have `/summary_fields/job`, also `/related/job` doesn't exist. But there are `/summary_fields/inventory` and `/related/inventory`. Parent workflow doesn't have inventory\r\n\r\nIn another case that Parent workflow has inventory and workflow node doesn't have, then `/summary_fields/job` and `/related/job` links exist and point to child workflow.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nLooks filtering hosts by tags is not working with azure inventory\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHere's an example from this comment:\r\n\r\nhttps://github.com/ansible/awx/issues/3430#issuecomment-543753718\r\n\r\nThe data structure of tags has been observed to be a dict, so the logic we are using will not work with the template that is applied.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nthe [expectations](https://github.com/ansible/ansible/blob/devel/contrib/inventory/azure_rm.ini) are\r\n\r\n> Control which tags are included. Set tags to a comma separated list of keys or key:value pairs\r\n\r\nthose probably have to be handled separately.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nfilters all hosts out\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nFiling new issue from details in prior comment in issue\r\n"},{"labels":["api",null,null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIf you change the organization of the project, is shows changes in some roles, but not other roles.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nModify the organization of a project.\r\n\r\nCheck the activity stream.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1 entry that the organization of the project was changed. That permissions also change is implied.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n2 additional unexpected entries\r\n\r\n![Screen Shot 2019-10-18 at 11 21 04 AM](https://user-images.githubusercontent.com/1385596/67107013-a27e7e80-f199-11e9-8983-56ce9f00d5ef.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSome content of one of those unwanted entries\r\n\r\n```json\r\n{\r\n \"action\": \"disassociate\",\r\n \"object1\": \"project\",\r\n \"object1_pk\": 25,\r\n \"object2\": \"organization\",\r\n \"object2_pk\": 163,\r\n \"relationship\": \"awx.main.models.rbac.Role_parents\"\r\n}\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe `ssl_certificate` value is defined and uncommented in `inventory`, and it gets used correctly in the docker-compose.yml output file, but the awxweb container's `/etc/nginx/nginx.conf` file has no SSL declaration, resulting in HTTP access only.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.5\r\n* Operating System: CentOS 7.7.1908\r\n* Web Browser: Google Chrome Version 77.0.3865.120 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nEdit the inventory, removing the comment on ssl_certificate (line 63), and adding the path to the file containing my private key and certificate chain concatenated together. https://github.com/ansible/awx/blob/857683e54845262d197a14ac00227b4dbfbd10c1/installer/inventory#L63\r\n\r\nRun ansible-playbook -i inventory install.yml, the installation process succeeds.\r\nI get a functional AWX instance available at port 80. Trying to access the site over HTTPS results in an immediate failure.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expect the awxweb container to get my SSL certificate configuration and serve the site over HTTPS. \r\n\r\nThis should be the default behaviour because it's possible to configure it by using templating to override the `nginx.conf` in the official container by adding it in the docker-compose.yml file in the volume part.\r\n\r\n**It should be done like that :**\r\n\r\nhttps://github.com/ansible/awx/blob/857683e54845262d197a14ac00227b4dbfbd10c1/installer/roles/local_docker/templates/docker-compose.yml.j2#L22\r\n\r\n```yaml\r\nservices:\r\n\r\n  web:\r\n    image: ansible/awx_web:7.0.0\r\n   ...\r\n    volumes:\r\n      -...\r\n     {% if ssl_certificate is defined %}\r\n      - \"{{ docker_compose_dir }}/nginx.conf:/etc/nginx/nginx.conf:ro\"\r\n    {% endif %} \r\n    environment:\r\n      ...\r\n```\r\nand add in `local_docker\\tasks\\compose.yml` \r\nhttps://github.com/ansible/awx/blob/857683e54845262d197a14ac00227b4dbfbd10c1/installer/roles/local_docker/tasks/compose.yml#L7\r\n\r\n```yaml\r\n- name: Create Docker Compose Configuration\r\n  template:\r\n    src: \"{{ item }}.j2\"\r\n    dest: \"{{ docker_compose_dir }}/{{ item }}\"\r\n    mode: 0600\r\n  with_items:\r\n    - environment.sh\r\n    - credentials.py\r\n    - docker-compose.yml\r\n    - nginx.conf\r\n  register: awx_compose_config\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe awxweb container's `/etc/nginx/nginx.conf` has no SSL declaration. Here is the `nginx.conf` file inside the awxweb container:\r\n\r\n```bash\r\nbash-4.2# cat /etc/nginx/nginx.conf\r\n#user awx;\r\n\r\nworker_processes  1;\r\n\r\npid        /tmp/nginx.pid;\r\n\r\nevents {\r\n    worker_connections  1024;\r\n}\r\n\r\nhttp {\r\n    include       /etc/nginx/mime.types;\r\n    default_type  application/octet-stream;\r\n    server_tokens off;\r\n\r\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\r\n                      '$status $body_bytes_sent \"$http_referer\" '\r\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\r\n\r\n    access_log /dev/stdout main;\r\n\r\n    map $http_upgrade $connection_upgrade {\r\n        default upgrade;\r\n        ''      close;\r\n    }\r\n\r\n    sendfile        on;\r\n    #tcp_nopush     on;\r\n    #gzip  on;\r\n\r\n    upstream uwsgi {\r\n        server 127.0.0.1:8050;\r\n        }\r\n\r\n    upstream daphne {\r\n        server 127.0.0.1:8051;\r\n    }\r\n\r\n\r\n    server {\r\n                listen 8052 default_server;\r\n\r\n        # If you have a domain name, this is where to add it\r\n        server_name _;\r\n        keepalive_timeout 65;\r\n\r\n        # HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)\r\n        add_header Strict-Transport-Security max-age=15768000;\r\n        add_header Content-Security-Policy \"default-src 'self'; connect-src 'self' ws: wss:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' cdn.pendo.io; img-src 'self' data:; report-uri /csp-violation/\";\r\n        add_header X-Content-Security-Policy \"default-src 'self'; connect-src 'self' ws: wss:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' cdn.pendo.io; img-src 'self' data:; report-uri /csp-violation/\";\r\n\r\n        # Protect against click-jacking https://www.owasp.org/index.php/Testing_for_Clickjacking_(OTG-CLIENT-009)\r\n        add_header X-Frame-Options \"DENY\";\r\n\r\n        location /nginx_status {\r\n          stub_status on;\r\n          access_log off;\r\n          allow 127.0.0.1;\r\n          deny all;\r\n        }\r\n\r\n        location /static/ {\r\n            alias /var/lib/awx/public/static/;\r\n        }\r\n\r\n        location /favicon.ico { alias /var/lib/awx/public/static/favicon.ico; }\r\n\r\n        location /websocket {\r\n            # Pass request to the upstream alias\r\n            proxy_pass http://daphne;\r\n            # Require http version 1.1 to allow for upgrade requests\r\n            proxy_http_version 1.1;\r\n            # We want proxy_buffering off for proxying to websockets.\r\n            proxy_buffering off;\r\n            # http://en.wikipedia.org/wiki/X-Forwarded-For\r\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n            # enable this if you use HTTPS:\r\n            proxy_set_header X-Forwarded-Proto https;\r\n            # pass the Host: header from the client for the sake of redirects\r\n            proxy_set_header Host $http_host;\r\n            # We've set the Host header, so we don't need Nginx to muddle\r\n            # about with redirects\r\n            proxy_redirect off;\r\n            # Depending on the request value, set the Upgrade and\r\n            # connection headers\r\n            proxy_set_header Upgrade $http_upgrade;\r\n            proxy_set_header Connection $connection_upgrade;\r\n        }\r\n\r\n        location / {\r\n            # Add trailing / if missing\r\n            rewrite ^(.*)$http_host(.*[^/])$ $1$http_host$2/ permanent;\r\n            uwsgi_read_timeout 120s;\r\n            uwsgi_pass uwsgi;\r\n            include /etc/nginx/uwsgi_params;            proxy_set_header X-Forwarded-Port 443;\r\n        }\r\n    }\r\n}\r\n\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Create new loggers in order to improve output for reporting\r\n\r\n##### SUMMARY\r\n\r\n**Customer suggestion**\r\n\r\n- A new logger (eg: job_status) which send all information for a job summarized in one event with all necessary fields.\r\n\r\nAnother enhancement, more basic (in my point of view) is to implement useful fields in the job_event logger in the summarized field for all executed job :\r\n\r\n- Organization :\r\n  * Id\r\n  * Name\r\n\r\n- Job_Template:\r\n  * Name\r\n  * Id\r\n  * Limit (Host)\r\n\r\n- Project :\r\n  * Name\r\n  * Id\r\n\r\n- Inventory :\r\n  * Name\r\n  * Id\r\n\r\nWith all these fields, we could cross informations to build proper reports and dashboard related to Ansible Tower Organization and projects which is not possible today."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nCustomer would like to be able to view the IP address along with the username of the user logging into Tower. "},{"labels":["api",null,null],"text":"```shell\r\n$ awx notification_templates create --name \"Testing 123\" --organization Default --notification_type webhook --messages '{\"success\": \"500 error\"}' --notification_configuration '{\"url\": \"http://example.org\", \"headers\": {}}'\r\n```\r\n\r\n<img width=\"932\" alt=\"image\" src=\"https://user-images.githubusercontent.com/214912/67009102-e2ba0000-f0b8-11e9-9346-816dea7ffa02.png\">\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAs a follow up to [this discussion](https://github.com/ansible/awx/issues/3113#issuecomment-542775656), I think it makes sense to avoid having some kind of special logic to determine value for `--playbook-dir` option for inventory sources, when sourced from project, and simply allow users to put that value in relative to project root, same as you would do in cli. This is also consistent with how you can input a relative path for the inventory source file itself.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nToday we learned that AWX will schedule jobs after the initial schedule time. This happens when AWX isn't able to schedule any jobs (in our case no space left on device).\r\n\r\nWhat did happen exactly: Over the night we had scheduled jobs which should update some production systems. A few hours before the disk space was full so AWX stopped working, no jobs where scheduled. \r\n\r\nIn the morning we saw the problem and freed some disk space. But then AWX started all jobs which were scheduled for the night and so ansible did its job well on shutting down systems for upgrades.\r\n\r\nThe only thing we could have done to avoid this is to immediately cancel all jobs manual but this would still caused outage because the jobs starting very quickly. (which is good by the way)\r\n\r\nIs there any way to solve this issue or prevent that from happening? \r\nI did some testing if the tasks where in some of rabbitmq queue, then I could limit those with the TTL set. But thats not the case, AWX schedules jobs just 2 Hours later.\r\n\r\n \r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.2\r\n* Operating System: Redhat 7\r\n* Web Browser: Chrome on Mac\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSchedule a job over the next 15min. \r\nFill up disk space `dd if=/dev/zero of=/var/lib/wasteofspace .....`\r\nAWX is not scheduling anything.\r\n\r\nFree the space on the disk again after 20min and then your last schedule will run out of schedule.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo job schedule should be executed after the last schedule time.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAd hoc commands in the UI do not link to anything, but they should logically link to:\r\n\r\n - the ad hoc command itself\r\n - the inventory for the ad hoc command\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System: Mac OS\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun an ad hoc command\r\n\r\nfind this action via the \"all activity\" in the activity stream heartbeat icon link from the dashboard\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLinks\r\n\r\n##### ACTUAL RESULTS\r\n\r\nno links\r\n\r\n![Screen Shot 2019-10-14 at 2 06 56 PM](https://user-images.githubusercontent.com/1385596/66773120-53c8a000-ee8c-11e9-8745-3d56b298ce66.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAPI data for this entry:\r\n\r\n```json\r\n{\r\n    \"id\": 7361,\r\n    \"type\": \"activity_stream\",\r\n    \"url\": \"/api/v2/activity_stream/7361/\",\r\n    \"related\": {\r\n        \"actor\": \"/api/v2/users/1/\",\r\n        \"ad_hoc_command\": [\r\n            \"/api/v2/ad_hoc_commands/443/\"\r\n        ]\r\n    },\r\n    \"summary_fields\": {\r\n        \"ad_hoc_command\": [\r\n            {\r\n                \"id\": 443,\r\n                \"name\": \"ping\",\r\n                \"status\": \"successful\",\r\n                \"limit\": \"\"\r\n            }\r\n        ],\r\n        \"actor\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        }\r\n    },\r\n    \"timestamp\": \"2019-10-14T18:03:03.001087Z\",\r\n    \"operation\": \"create\",\r\n    \"changes\": {\r\n        \"job_type\": \"run\",\r\n        \"inventory\": \"Inventory - ShapeMedia돻-101\",\r\n        \"limit\": \"\",\r\n        \"credential\": \"Credential - StandMapﮈ-145\",\r\n        \"module_name\": \"ping\",\r\n        \"module_args\": \"\",\r\n        \"forks\": 0,\r\n        \"verbosity\": 0,\r\n        \"extra_vars\": \"\",\r\n        \"become_enabled\": false,\r\n        \"diff_mode\": false,\r\n        \"id\": 443\r\n    },\r\n    \"object1\": \"ad_hoc_command\",\r\n    \"object2\": \"\",\r\n    \"object_association\": \"\",\r\n    \"action_node\": \"awx\",\r\n    \"object_type\": \"\"\r\n}\r\n```\r\n\r\nYou can see the inventory info is missing, so the API will have to furnish this in order to link to the inventory.\r\n\r\nThe data needed to link to the ad hoc command, itself, is there.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI cannot see all the playbooks in /var/lib/awx/projects\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: Direct installation\r\n* Ansible version:  2.8.5\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI setup a root folder and inside that root folder made different directories with \r\n\r\nansible-galaxy init test-role-1 \r\n\r\nAnd then put my playbooks in there in tasks\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expected that all my playbooks would be visible\r\n\r\n##### ACTUAL RESULTS\r\n\r\nI only see the playbook inside test and test.yml Even If I copy that to other places and rename it I do not see it. It doesnt seem to be a syntax issue and I  also checked if it was permissions but they have the same as the test folder and the test.yml file\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPlease ask if you need additional information"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nSince Ansible offers a lot of flexibility in the way that projects can be set up, it would be great if the `project_update.yml` would be exposed for user customization.\r\n\r\nEDIT: As [stated](https://github.com/ansible/awx/issues/5000#issuecomment-541098848) `project_update.yml` is not the only place affected by this feature request.\r\n\r\nSome examples why this may be required:\r\n* We use an `Ansible` playbook which installs Ansible in various flavours (CLI, Dev workplace, AWX, ...). The `ansible.cfg` for each setup differs. Thus for a project to be set up it is required to run the `Ansible` play or at least use the Ansible `template` module to place the ansible.cfg in the right place (in case of AWX in the project root path).\r\n* `requirements.yml` may not be set up as required by AWX currently. In our case we have a requirements.yml in each `plays/<play>/requirements.yml`. ansible-galaxy should be executed to place the required roles into `plays/<play>/roles/`.\r\n* Custom plugin usage (mainly driven through ansible.cfg configuration)\r\n* ...\r\n\r\nAs it is currently, AWX forces users to (some examples):\r\n* place roles into `roles/requirements.yml`\r\n* no bootstrapping options to e.g. pull content, modules, ... (Addition of collections probably does help at this point)\r\n\r\nThere are so many ways to use Ansible. Forcing users to one way only disrupts usability.\r\n\r\nCurrently, we will probably move towards overriding the `project_update.yml` in `/var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/playbooks/project_update.yml` of the `awx_task` container.\r\nEDIT: Unfortunately `awx/main/tasks.py` contains further logic which makes above approach unfeasible.\r\n\r\nAny other way to achieve this? Any documentation on this I have missed?"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Presently, when following the documentation (https://github.com/ansible/awx/blob/devel/INSTALL.md#Kubernetes) to set up AWX in Kubernetes, there is a possibility of misconfiguration with respect to memory and cpu limits for the awx pods\r\n\r\n##### SUMMARY\r\n\r\n- According to the documentation linked above (https://github.com/ansible/awx/blob/devel/INSTALL.md#Kubernetes), to set up AWX in Kubernetes, one can quickly clone the repo and run the ansible installer playbook. \r\n- However,  looking at  https://github.com/ansible/awx/blob/devel/installer/roles/kubernetes/defaults/main.yml, it appears that while there are default memory and cpu requests set for the individual pods, there aren't any limits set by default.\r\nThis could lead to a potential problem where a user using a Kubernetes namespace with a  LimitRange object(https://kubernetes.io/docs/concepts/policy/limit-range/)  could see a 'Specified memory/cpu request greater than limit' error, because the LimitRange limit gets used for deployments with  no explicit limit configuration. In this case, even if the limitrange default limit values happen to be lower than the awx configured default requests ( such as web_mem_request, web_cpu_request, etc)  even if the actual max limit is higher. An example of a LimitRange spec is referenced below:\r\n\r\n----\r\n#### LimitRange\r\napiVersion: v1\r\nkind: LimitRange\r\nmetadata:\r\n  namespace: some-namespace\r\n  name: default-limits-per-container\r\nspec:\r\n  limits:\r\n  - max:\r\n      cpu: \"1.5\"\r\n      memory: \"6Gi\"\r\n\r\n    min:\r\n      cpu: \"50m\"\r\n      memory: \"20Mi\"\r\n\r\n    default:\r\n      cpu: \"250m\"\r\n      memory: \"512Mi\"\r\n\r\n    defaultRequest:\r\n      cpu: \"50m\"\r\n      memory: \"256Mi\"\r\n\r\n    type: Container\r\n---\r\n\r\nIn the example above, if the values for awx containers (specified in https://github.com/ansible/awx/blob/devel/installer/roles/kubernetes/defaults/main.yml )happen to be the following.\r\n\r\nweb_mem_request: 1\r\nweb_cpu_request: 500\r\n\r\ntask_mem_request: 2\r\ntask_cpu_request: 1500\r\n\r\nrabbitmq_mem_request: 2\r\nrabbitmq_cpu_request: 500\r\n\r\nmemcached_mem_request: 1\r\nmemcached_cpu_request: 500\r\n\r\nBecause there are no upper limits set,  the LimitRange object will set the default upperlimits which happen to be lower than the explicit request values and can.\r\nWhile the user can mitigate this quickly by adding the variables such as web_mem_limit and web_cpu_limit , it would be helpful if these were included in the default/main.yml configuration.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIf a job is sent to a container group, and there is no ResourceQuota specified, pods will be enqueued but potentially run into being `Unschedulable` and get stuck in \"Pending\" on the cluster.\r\n\r\nThen jobs either fail with timeout on tower side, or if we attempt to cancel the job, the job gets canceled on tower but never taken out of queue on the container group cluster.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate a working container group\r\nIt is easier to control the available resources if you create your own node pool @unlikelyzero can help with that. Create a node that only has 2 CPUs available.\r\n\r\nModify the pod_spec to look like this (but with the right namespace for your setup)\r\n```\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n namespace: YOURNAMESPACE\r\nspec:\r\n containers:\r\n   - image: ansible/ansible-runner\r\n     resources:\r\n       requests:\r\n         cpu: “2”\r\n     tty: true\r\n     stdin: true\r\n     imagePullPolicy: Always\r\n     args:\r\n       - sleep\r\n       - infinity\r\n nodeSelector:\r\n   YOURSELECTORFORYOURNODEPOOL\r\n```\r\n\r\nCreate a JT that sleeps for 30 seconds, enable simultaneous and assign the container group\r\nCreate a WFJT that has 10 nodes that should run simultaneously this JT, enable simultaneous\r\nLaunch the WFJT several times\r\n\r\nCancel some of the later launches after the pods appear as `pending` in the kubernetes cluster.\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nSlowly work through each job as resources are available.\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nSome jobs fail with timeout, canceled jobs never clean up their pods.\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n@one-t and @unlikelyzero and I found this while trying to investigate a related potential problem:\r\n\r\nWITH a container group in a cluster with no ResourceQuota defined\r\nWHEN a JT has regular tower instance groups + container group assigned (with preference for tower instance groups)\r\nWHEN all tower instance groups capacity is consumed\r\nTHEN....all subsequent jobs will get funneled to the container group, even if this exceeds its resource capacity and jobs will sit in pending for a long time even after regular tower instance groups have gotten capacity freed up.\r\n\r\nI think ^ is a real scenario, potentially more root cause of this bug itself...potentially we could check the pods that are in pending and see if they are Unschedulable and then un-assign them from the container group and re-dispatch them to other instance groups if available.\r\n\r\nThis is what a pod that is stuck in this Unschedulable state looks like:\r\n```\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  creationTimestamp: \"2019-10-09T20:37:42Z\"\r\n  name: job-181\r\n  namespace: default\r\n  resourceVersion: \"65442511\"\r\n  selfLink: /api/v1/namespaces/default/pods/job-181\r\n  uid: a47a0397-ead4-11e9-894a-42010a8e00ca\r\nspec:\r\n  containers:\r\n  - args:\r\n    - sleep\r\n    - infinity\r\n    image: ansible/ansible-runner\r\n    imagePullPolicy: Always\r\n    name: job-181\r\n    resources:\r\n      requests:\r\n        cpu: 2k\r\n    stdin: true\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    tty: true\r\n    volumeMounts:\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: default-token-dtdds\r\n      readOnly: true\r\n  dnsPolicy: ClusterFirst\r\n  nodeSelector:\r\n    cloud.google.com/gke-nodepool: pre-emptible-pool\r\n  priority: 0\r\n  restartPolicy: Always\r\n  schedulerName: default-scheduler\r\n  securityContext: {}\r\n  serviceAccount: default\r\n  serviceAccountName: default\r\n  terminationGracePeriodSeconds: 30\r\n  tolerations:\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/not-ready\r\n    operator: Exists\r\n    tolerationSeconds: 300\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/unreachable\r\n    operator: Exists\r\n    tolerationSeconds: 300\r\n  volumes:\r\n  - name: default-token-dtdds\r\n    secret:\r\n      defaultMode: 420\r\n      secretName: default-token-dtdds\r\nstatus:\r\n  conditions:\r\n  - lastProbeTime: \"2019-10-09T20:44:30Z\"\r\n    lastTransitionTime: \"2019-10-09T20:37:42Z\"\r\n    message: '0/5 nodes are available: 2 node(s) didn''t match node selector, 5 Insufficient\r\n      cpu.'\r\n    reason: Unschedulable\r\n    status: \"False\"\r\n    type: PodScheduled\r\n  phase: Pending\r\n  qosClass: Burstable\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nIn the current implementation of https://github.com/ansible/awx/pull/4589, you can change the \"fallback\" server in the file settings. But this isn't very accessible.\r\n\r\nThis issue is to add a toggle like \"Use Galaxy Fallback\", and it's it's checked, it will use the public galaxy in the server list at lower precedence than what's defined in the settings. If it is unchecked, it will _only_ use the server defined in the CTiT settings.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nSystem Auditor is unable to view Container Groups\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create Container Group\r\n2. Log in as System Auditor\r\n3. Attempt to view a container group\r\n\r\n##### EXPECTED RESULTS\r\nAble to view container group like an instance group\r\n\r\n##### ACTUAL RESULTS\r\nUnable to view container group\r\n\r\n##### ADDITIONAL INFORMATION\r\n![Screen Shot 2019-10-08 at 5 32 17 PM](https://user-images.githubusercontent.com/12446869/66435218-5c375b80-e9f2-11e9-8abb-0be7ba30ad30.png)\r\n\r\n"},{"labels":["api",null,null],"text":"see https://github.com/ansible/awx/pull/4716#discussion_r330187287"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nSeeing this traceback in logs of development container, still need to firm up exact reproduction steps. @ryanpetrello seemed to recognize traceback and probably knows what is up\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nRunning a workflow with a number of nodes in it, seeing some significant delay in jobs running in workflow and looked into logs to investigate. Can send more info about this workflow on request.\r\n\r\n\r\nSeeing this in logs:\r\n```\r\nawx_1        | 2019-10-04 16:26:53,567 ERROR    awx.main.commands.run_callback_receiver Callback Task Processor Raised Exception: TypeError(\"InventoryUpdateEvent() got an unexpected keyword argument 'workflow_job_id'\",)                   \r\nawx_1        | 2019-10-04 16:26:53,568 ERROR    awx.main.commands.run_callback_receiver Detail: Traceback (most recent call last):                                                                                                            \r\nawx_1        |   File \"/awx_devel/awx/main/dispatch/worker/callback.py\", line 107, in perform_work                                                                                                                                            \r\nawx_1        |     _save_event_data()                                                                                                                                                                                                         \r\nawx_1        |   File \"/awx_devel/awx/main/dispatch/worker/callback.py\", line 45, in _save_event_data                                                                                                                                         \r\nawx_1        |     cls.create_from_data(**body)                                                                                                                                                                                               \r\nawx_1        |   File \"/awx_devel/awx/main/models/events.py\", line 622, in create_from_data                                                                                                                                                   \r\nawx_1        |     event = cls.objects.create(**kwargs)                                                                                                                                                                                       \r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/models/manager.py\", line 82, in manager_method                                                                                                                       \r\nawx_1        |     return getattr(self.get_queryset(), name)(*args, **kwargs)                                                                                                                                                                 \r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/models/query.py\", line 420, in create                                                                                                                                \r\nawx_1        |     obj = self.model(**kwargs)                                                                                                                                                                                                 \r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/models/base.py\", line 501, in __init__                                                                                                                               \r\nawx_1        |     raise TypeError(\"%s() got an unexpected keyword argument '%s'\" % (cls.__name__, kwarg))                                                                                                                                    \r\nawx_1        | TypeError: InventoryUpdateEvent() got an unexpected keyword argument 'workflow_job_id'                                                                                                                                         \r\nawx_1        | 2019-10-04 16:26:53,570 ERROR    awx.main.commands.run_callback_receiver Callback Task Processor Raised Exception: TypeError(\"InventoryUpdateEvent() got an unexpected keyword argument 'workflow_job_id'\",) \r\n```\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nNo traceback, no lagging\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nSlow spawning of jobs in workflow"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAllow the `external_account` field to be filtered via the API. This will allow admins to filter out a list of local users vs external users inside of Tower."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nRelated: https://github.com/ansible/awx/issues/4907\r\n\r\nUsers should be able to choose a controller node/nodes for their container groups- this would cut down on the number of firewall exceptions they'd need to create to allow for containerized execution of jobs.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nThis is a known issue of #4189 that will be resolved in follow up PR.\r\n\r\nIf for some reason (Tower restart, network problems, etc) job pods get left running in the namespace provided by a ContainerGroup, there is currently no reaper to check on these jobs and clean them up. As a matter of due diligence, we should do this.\r\n\r\n@shanemcd and @ryanpetrello may want to flesh this out a bit more"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThis is a known issue of #4189 that will be resolved in follow up PR.\r\n\r\n_IF the user sets up the namespace that they use for the Container Group with a ResourceQuota_...\r\n\r\n@one-t has confirmed that when a Container Group has exceeded capacity (e.g. has met its ResourceQuota) , jobs will still be sent to it because of lack of capacity calculation for ContainerGroups. The jobs then  immediately fail becaues of a `403` response from kubernetes API instead of expected behavior of waiting to dispatch job until an instance group has capacity to run it.\r\n\r\nThis means in a Tower environment that is saturated with jobs such that all other resources available to a new job are out of capacity, the Container Group will still appear to have capacity even if it itself has also exceeded resource limits. This will cause the job and any future jobs dispatched to the CG to immediately fail until resources are freed up.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate a ResourceQuota in the namespace you use to set up a ContainerGroup\r\nAssociate the ContainerGroup with a JT\r\nLaunch more jobs that your ResourceQuota will allow\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nLater jobs will go into pending until resources are available\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nLater jobs fail immediately with `403` from kubernetes API\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n@one-t can provide more details about how to configure your namespace ResourceQuota"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThis is a known issue of #4189 that will be resolved in follow up PR.\r\n\r\nWhen a job deployed to a container group fails after the pod has been deployed from never being able to connect (no rsync on container for example) or from losing connection (pod prematurely exits/is killed) the job gets failure state \"failed\" instead of \"error\", although error is put in `result_traceback`.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1) create a Container Group but override container `args` to be `sleep 5` so it will exit too fast\r\n2) Create an job template with our test playbooks to run `sleep.yml` for 45 seconds\r\n3) Assign Container Group to JT\r\n4) launch job\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nJob fails with state `error` and get traceback\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nJob fails with state `failed` and traceback"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThis is a known issue of #4189 that will be resolved in follow up PR.\r\n\r\nCurrently with the feature if you run an `ad_hoc_command` that gets deployed to a ContainerGroup, the job will run in a pod on the cluster but the pod is never cleaned up after the job runs or is canceled.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1) create a working Container Group\r\n2) Create an organization\r\n3) Assign Container Group to organization as only instance group\r\n4) Create inventory + one host (localhost is fine)\r\n5) launch ad hoc command against host\r\n6) see that job is spawned and runs\r\n7) watch to see pod is never cleaned up\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nJob runs + is cleaned up\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nno clean up of pod\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThis also happens for canceled ad hoc commands\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThis is a known issue of https://github.com/ansible/awx/pull/4189 that will be resolved in follow up PR.\r\n\r\nInventory updates need to run on a Tower node, and this does happen even when \"deployed\" to a Container Group. The problem is, there is no way to figure out from API what tower node it was deployed to.\r\n\r\nThis is connected to the fact that there is no designated \"controller node\" for the Container Groups, solving that may help this.\r\n\r\nRegardless, currently if an inventory update is \"deployed\" to a container group it will show the container group on the inventory update, but no execution node or controller node, so it is unclear where the update actually ran.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1) create a working Container Group\r\n2) Create an organization\r\n3) Assign Container Group to organization as only instance group\r\n4) create inventory with inventory source OR create project\r\n5) launch inventory update or project update\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nOne of the Tower nodes is shown as execution node\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nNo execution node, only container group shown"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThis occurs when using CI container debug mode on a fresh install (see https://github.com/ansible/awx/tree/devel/awx/ui/test/e2e#ci-container-debugging) for details.\r\n\r\nEssentially, when the E2E suite begins, a call with the GET here: https://github.com/ansible/awx/blob/devel/awx/ui/client/src/login/authenticationServices/authentication.service.js#L143 which calls `/me`. \r\n\r\nFor some reason, in this scenario, and only on fresh runs of awx, this results in an exception thrown. So far, I've been unable to catch the error. Notable that sometimes it manifests itself on the api end with a 403 CSRF failure, and other times it just looks like a normal login, but the user is then immediately logged out thanks to exception handling in `https://github.com/ansible/awx/blob/9e778b24c72d474097e927326a4689f7c572681c/awx/ui/client/src/login/loginModal/loginModal.controller.js#L148`. \r\n\r\nI'd like an answer as to why this fails out, but haven't found one yet.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nBuild a totally fresh awx (fresh database, etc). \r\nRun the npm command here, and fill in your username and password values:\r\n \r\n```\r\ndocker-compose -f \"awx/ui/test/e2e/cluster/docker-compose.yml\" -f \"awx/ui/test/e2e/cluster/docker-compose.devel-override.yml\" -f \"awx/ui/test/e2e/cluster/docker-compose.debug-override.yml\" run -e AWX_E2E_CLUSTER_HOST=\"hub\" -e AWX_E2E_CLUSTER_PORT=\"4444\" -e AWX_E2E_URL=\"https://awx:8043\" -e AWX_E2E_USERNAME=\"username\" -e AWX_E2E_PASSWORD=\"password\" e2e --verbose\r\n```\r\nuse a VNC viewer like tigerVNC or similar, once the cluster_hub container starts, and visit localhost:5900 with it. password is the default value `secret`. If successful, you should see an ubuntu logo background as a default background for the viewer IF you're using tigerVNC.\r\n\r\nThe containers will take time to build, and roughly half the time, you will see the error manifest like this:\r\n\r\n![Screenshot from 2019-10-03 09-46-41](https://user-images.githubusercontent.com/19942822/66157402-bbabfa80-e5f1-11e9-9d40-43fdafa515f2.png)\r\n\r\n##### EXPECTED RESULTS\r\nLogin works\r\n\r\n##### ACTUAL RESULTS\r\nSee screenshot"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAdd pam2 support for secret management so that centrify secrets can be imported into the AWX/Tower DB via the centrify API.\r\n"},{"labels":["api",null,null],"text":"In the AWX API, there should be a field that includes the user that approved/denied the workflow execution.\r\n\r\n```\r\n<awx_hostname>/api/v2/workflow_approvals/<approval_job_id>\r\n```\r\nCurrently in this endpoint, there is an array called **summary_fields**, which contains the following objects:\r\n- workflow_job_template\r\n- workflow_job\r\n- workflow_approval_template\r\n- unified_job_template\r\n- *created_by*\r\n- user_capabilities\r\n- source_workflow_job\r\n\r\nI'd love to see a new field added called **approved_by**, which includes the `id`/`username` of the user that approved the workflow_job. Similar to the `created_by` field.\r\n\r\nThanks for your consideration :) and thanks for making AWX!"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Enhancement/Feature\r\n\r\n##### SUMMARY\r\nMore backstory here: https://github.com/ansible/awx/issues/2277\r\n\r\nOAuth2 Token Expiration times should have different default values for personal access tokens (PAT) and application tokens as they are used in different ways.  \r\n\r\nPersonal access tokens should be long-lived, if not infinite, as they don't have refresh tokens and are meant for personal integrations.  \r\n\r\nApplication tokens should be should lived (1 hour) by default, and should have a refresh token which expires by default 1 month after the expiration of the associated access token.  This will inherently be the more secure way to set up an app integration with tower.  \r\n\r\nRef: https://tools.ietf.org/html/rfc6749\r\n\r\nFor context, this is similar to how GitHub implemented PAT's and App tokens.  \r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n1. On creation, make PAT's live forever, no expiration.  (1000 years or no expiration if possible, like GitHub)\r\n2. Make sure the `ACCESS_TOKEN_EXPIRE_SECONDS` only applies to app tokens - use the same token model if possible\r\n3. Bump version of DOT to 1.2.0 if possible, now that Django 2.2.4 is being used by AWX\r\n4. We will want some tests for this."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nI have to setup my awx towers automated by scripts - while I was using tower-cli up to version 6.0.1....\r\nAs tower-cli has been replaced by the integrated awx cli (what makes sense IMHO), I am missing a backup/restore option. At least I was unable to find any documentation/parameter to do so.\r\n\r\nDid I miss something or is this not implemented yet and subject to be changed? And idea would be to execute all possible combinations of parameters to export the data and to import the relevant/filled ones.\r\n\r\nCheers and thanks,\r\nMatthias"},{"labels":["api",null,null],"text":"Now that https://github.com/ansible/awx/issues/1206 and https://github.com/ansible/awx/issues/79 are done, we need some final housekeeping to tie them together.\r\n\r\ncc @beeankha @jladdjr "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nIf using the UI to manage top level inventory variables having a large list of variables can cause performance issues across the network. In some cases the calls are generating 7.2 MB worth of data on every job launch prompt. \r\n\r\nThis data is already provided in the related section and is extraneous on the inventories/ endpoint"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nBe able to schedule jobs to run only for a certain time range. For example:\r\n\r\nRun JobA every 30 minutes between 9 AM to 5 PM EST, Monday through Friday. \r\n\r\nPotential workaround is to schedule a Tower job to enable/disable the schedule at the desired times."},{"labels":["api",null,null,null],"text":"\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAs of 7.0.0 we are no longer able to assign multiple vault credentials to a template.  This is a breaking change that will not allow us to upgrade AWX.  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.4\r\n* Operating System: RHEL 7.6\r\n* Web Browser: Safari, Chrome, FireFox.  Depends on my mood. \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n```\r\ncurl -X POST \\\r\n  https://myawx/api/v2/job_templates/24/credentials/ \\\r\n  -d '{\r\n    \"associate\": \"true\",\r\n    \"id\": 6\r\n}\r\n```\r\n\r\nagainst a template that already has a vault credential.  \r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n204.   An additional vault credential added.  \r\n\r\n##### ACTUAL RESULTS\r\n\r\n400:\r\n```\r\n {\r\n    \"error\": \"Cannot assign multiple Vault credentials.\"\r\n}\r\n```\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis worked in previous versions.  It seems like there have been a large amount of changes to the credential process and no changelog to speak of.  \r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nI've integrated the SML Authentication with AWX. It redirects to my IDP (I get 200 OK). Authenticate it there. And then redirects back to the http://localhost:8052/sso/complete/saml/ (here I get 302 Found) But after this, it redirects to the http://localhost:8052/sso/error/ (And here I get 301 Moved Permanently) and then to http://localhost:8052/#/login . I'm unable to login into the AWX by SAML. Please resolve the issue. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker for mac\r\n* Operating System: MacOS\r\n* Web Browser: Chrome, Brave, Safari\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nInstall AWX with following docker-compose file: \r\n```yaml\r\nversion: '3'\r\nservices:\r\n  postgres:\r\n    image: \"postgres:9.6\"\r\n    environment:\r\n      POSTGRES_USER: awx\r\n      POSTGRES_PASSWORD: awxpass\r\n      POSTGRES_DB: awx\r\n\r\n  rabbitmq:\r\n    image: \"rabbitmq:3\"\r\n    environment:\r\n      RABBITMQ_DEFAULT_VHOST: awx\r\n\r\n  memcached:\r\n    image: \"memcached:alpine\"\r\n\r\n  awx_web:\r\n    #image: \"geerlingguy/awx_web:latest\"\r\n    image: \"ansible/awx_web:latest\"\r\n    links:\r\n      - rabbitmq\r\n      - memcached\r\n      - postgres\r\n    ports:\r\n      - \"8052:8052\"\r\n    hostname: awxweb\r\n    user: root\r\n    environment:\r\n      SECRET_KEY: aabbcc\r\n      DATABASE_USER: awx\r\n      DATABASE_PASSWORD: awxpass\r\n      DATABASE_NAME: awx\r\n      DATABASE_PORT: 5432\r\n      DATABASE_HOST: postgres\r\n      RABBITMQ_USER: guest\r\n      RABBITMQ_PASSWORD: guest\r\n      RABBITMQ_HOST: rabbitmq\r\n      RABBITMQ_PORT: 5672\r\n      RABBITMQ_VHOST: awx\r\n      MEMCACHED_HOST: memcached\r\n      MEMCACHED_PORT: 11211\r\n    volumes:\r\n      - ./SECRET_KEY:/etc/tower/SECRET_KEY\r\n\r\n  awx_task:\r\n    #image: \"geerlingguy/awx_task:latest\"\r\n    image: \"ansible/awx_task:latest\"\r\n    links:\r\n      - rabbitmq\r\n      - memcached\r\n      - awx_web:awxweb\r\n      - postgres\r\n    hostname: awx\r\n    user: root\r\n    environment:\r\n      SECRET_KEY: aabbcc\r\n      DATABASE_USER: awx\r\n      DATABASE_PASSWORD: awxpass\r\n      DATABASE_NAME: awx\r\n      DATABASE_PORT: 5432\r\n      DATABASE_HOST: postgres\r\n      RABBITMQ_USER: guest\r\n      RABBITMQ_PASSWORD: guest\r\n      RABBITMQ_HOST: rabbitmq\r\n      RABBITMQ_PORT: 5672\r\n      RABBITMQ_VHOST: awx\r\n      MEMCACHED_HOST: memcached\r\n      MEMCACHED_PORT: 11211\r\n    volumes:\r\n      - ./SECRET_KEY:/etc/tower/SECRET_KEY\r\n```\r\nThen Navigate to Settings => Authentication > SAML\r\n\r\nAnd I had following configurations for IDP:\r\n```json\r\n{\r\n \"cas\": {\r\n  \"x509cert\": \"MIIDBzCCAe+gAwIBAgIJAP+Iolzz6C3mM....................................................\",\r\n  \"attr_last_name\": \"last_name\",\r\n  \"attr_username\": \"User.Username\",\r\n  \"entity_id\": \"http://cas.real-dev.de/saml/metadata\",\r\n  \"attr_email\": \"User.Email\",\r\n  \"attr_user_permanent_id\": \"User.Username\",\r\n  \"attr_first_name\": \"first_name\",\r\n  \"url\": \"http://cas.real-dev.de/saml/sso\"\r\n }\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt should login into the AWX after getting response from the IDP.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIt redirects to http://localhost:8052/#/login \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis is what I'm getting from SAML Tracer. \r\n\r\n**Sending Request to IDP**\r\n\r\n<img width=\"753\" alt=\"Screenshot 2019-09-24 at 17 32 59\" src=\"https://user-images.githubusercontent.com/22825645/65526533-87e61c00-def1-11e9-89e7-5eae4f1004c1.png\">\r\n<img width=\"751\" alt=\"Screenshot 2019-09-24 at 17 33 09\" src=\"https://user-images.githubusercontent.com/22825645/65526538-8ae10c80-def1-11e9-98b4-3787c4dcc940.png\">\r\n\r\n**Response of IDP**\r\n\r\n<img width=\"751\" alt=\"Screenshot 2019-09-24 at 17 35 24\" src=\"https://user-images.githubusercontent.com/22825645/65526666-c5e34000-def1-11e9-9688-54db282c28f2.png\">\r\n<img width=\"752\" alt=\"Screenshot 2019-09-24 at 17 35 35\" src=\"https://user-images.githubusercontent.com/22825645/65526673-c8459a00-def1-11e9-9c3c-972cb9d90db8.png\">\r\n<img width=\"767\" alt=\"Screenshot 2019-09-24 at 17 35 43\" src=\"https://user-images.githubusercontent.com/22825645/65526680-cb408a80-def1-11e9-9cc4-0879c7bb9ebb.png\">\r\n\r\n\r\n\r\nAnd here I'm getting **301 Moved Permanently**\r\n<img width=\"757\" alt=\"Screenshot 2019-09-24 at 17 36 47\" src=\"https://user-images.githubusercontent.com/22825645/65526798-f32fee00-def1-11e9-984b-c9e3b19c3ab4.png\">\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWe're running into a situation, wherein we have an inventory of a few thousand hosts. This inventory is dynamic, there is a source script for the inventory inside of a project. This inventory is configured to overwrite variables and hosts, as our infrastructure can change a lot during the day, and all the variables are delivered through this dynamic source. We, as an organization / team, often need to run orchestration across the entire fleet. Thousands of hosts. These jobs can often last many hours, ensuring fleet health as the job continues through.\r\n\r\nWhat we notice is that while such a job is executing, AWX will refuse to update that dynamic inventory. The inventory update job will remain pending while the original task continues.\r\n\r\nThis can be a pretty big problem for us, as our inventory can change throughout the day. New hosts can show up many times throughout the day, or be removed. Data about those hosts can change too, so we do want to have a fairly updated picture of inventory each time we launch a job.\r\n\r\nWhat we'd like to see is the ability to execute the inventory update job while a job that USES the inventory is running. This will allow us to configure our inventory with \"update on execution\", with a reasonable cache. It will allow new hosts to reliably use provisioning call backs to get jobs.\r\n\r\nThanks!"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nenvironment background \r\nansible version: 2.8.4\r\nawx version : 7.0 with external postgres rds \r\nsecrete management tool : Hashicorp Vault \r\n\r\n\r\nWe have HashiCorp Vault that provides SSH Signed key for Linux machines which is integrated and works fine in AWX too... however, in the same way, we would like to see Cloud Authentication credentials also to be generated from cloud secrete engines and fetched dynamically , which helps us to avoiding the AWS/Azure key rotation manual task... it's really become painful to maintain the EC2 IAM since we have more than 75+ accounts across multiple accounts...\r\n\r\nMore information how Vault generates short lived credentials for cloud providers : https://www.vaultproject.io/docs/auth/aws.html\r\n\r\n##### SUMMARY\r\n\r\nBelow attached sample snippet works for SSH Signed-key, in the same, we should have an option to talk to cloud secrete engines to generate a dynamic credentials...\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/41424639/65382455-633c4980-dd23-11e9-8c63-1abfc599fe26.png)\r\n\r\n\r\n\r\n\r\nRegards,\r\nSreenadh"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n1. create a credential\r\n2. use the lookup feature to populate assorted fields (username, password, ssh key, whatever)\r\n3. save\r\n4. copy the cred\r\n\r\nAll the fields that are lookups from a credential vault are blank (no configuration or value) in the copied credential.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: since whenever cred lookups were added\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\nCurrently unable to recreate, however, opening this for documentation purposes. If no one else sees it, we can close it as unreproducible.\r\n\r\n##### SUMMARY\r\nWitnessed this under a new AWX instance, still trying to see if I can get a recreate. Saw this on the branch for the [webhooks feature](https://github.com/ansible/awx/pull/4436).\r\n1. Create a Job template, enabled webhooks (don't think this is related to it). \r\n2. Make a normal user and put them on a team, then give that team execute permissions on the job template.\r\n3. Go between the admin and user accounts on the job template. \r\n\r\nAt some point, the Job Slicing field changed to 21 -- this is maybe notable because 21 is the number of rows queried when you print a Django queryset. \r\n\r\n\r\n##### ENVIRONMENT\r\n* Operating System: Fedora 30\r\n* Web Browser: Chrome"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI'm trying to set up a Machine credential. For SSH Private Key I'm sourcing it from an already configured HashiCorp Vault KV credential. I want the user to provide the passphrase at template launch so I check the box. When I do this I get an error stating that `cannot be set unless \"SSH Private Key\" is set`.\r\n\r\nI suspect this is just a by-product of a credential plugin. Sourcing the private data by way of a plugin makes the schema for Machine (ssh) credentials fail to validate.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.2\r\n* Operating System: Mac OSX\r\n* Web Browser: Safari\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n- Create a HashiCorp Vault KV credential\r\n- Open dialog to create another credential; a Machine credential\r\n- Click the search button for the SSH PRIVATE KEY dialog\r\n- Select previously created HashiCorp Vault KV credential and click next\r\n- Fill in data for secret path and key name and save\r\n- Check Prompt on launch for PRIVATE KEY PASSPHRASE\r\n- Click Save\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\nI expected to be able to source the private data from Vault and the passphrase from the user, ensuring no part of the combo is stored within AWX at rest.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\nAn error dialog appears below PRIVATE KEY PASSPHRASE and I cannot continue.\r\n\r\n![Screen Shot 2019-09-19 at 7 06 05 PM](https://user-images.githubusercontent.com/523287/65294183-b9866e00-db12-11e9-902f-8a3175dc92f7.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\n\r\n![vault-ssh-prompt](https://user-images.githubusercontent.com/523287/65294681-cc4d7280-db13-11e9-900c-bf769e649a30.gif)\r\n\r\n\r\n\r\n\r\n\r\ncc github/gtower#19\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen trying to POST to workflow_job_template_nodes using basic auth and/or token-auth AWX replies with 401 failure.\r\n\r\n`awx_web      | 2019-09-19 08:40:32,754 WARNING  awx.api.generics status 401 received by user AnonymousUser attempting to access /api/v2/workflow_job_template_nodes/ from XXX.XXX.XXX.XXX\r\nawx_web      | 2019-09-19 08:40:32,780 WARNING  django.request Bad Request: /api/v2/workflow_job_template_nodes/\r\nawx_web      | 2019-09-19 08:40:32,780 WARNING  django.request Bad Request: /api/v2/workflow_job_template_nodes/\r\nawx_web      | [pid: 153|app: 0|req: 57/208] XXX.XXX.XXX.XXX () {38 vars in 568 bytes} [Thu Sep 19 08:40:32 2019] POST /api/v2/workflow_job_template_nodes/ => generated 140 bytes in 74 msecs (HTTP/1.1 400) 8 headers in 246 bytes (1 switches on core 0)\r\nawx_web      | XXX.XXX.XXX.XXX - - [19/Sep/2019:08:40:32 +0000] \"POST /api/v2/workflow_job_template_nodes/ HTTP/1.1\" 400 140 \"-\" \"curl/7.54.0\" \"-\"`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6\r\n* Operating System: CentOS\r\n* Web Browser: Curl 7.54\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n0. nodes.json\r\n`{\r\n    {\r\n      \"type\": \"workflow_job_template_node\",\r\n        \"workflow_job_template\": {\r\n          \"id\": 1238,\r\n          \"name\": \"DNS WF\",\r\n          \"description\": \"\"\r\n        },\r\n        \"unified_job_template\": {\r\n          \"id\": 820,\r\n          \"name\": \"template-name\",\r\n          \"unified_job_type\": \"job\"\r\n        }\r\n      \"extra_data\": {},\r\n      \"inventory\": null,\r\n      \"scm_branch\": null,\r\n      \"job_type\": null,\r\n      \"job_tags\": \"\",\r\n      \"skip_tags\": null,\r\n      \"limit\": \"\",\r\n      \"diff_mode\": null,\r\n      \"verbosity\": null,\r\n      \"workflow_job_template\": 1238,\r\n      \"unified_job_template\": 820,\r\n      \"success_nodes\": [],\r\n      \"failure_nodes\": [],\r\n      \"always_nodes\": []\r\n    }\r\n}\r\n`\r\n1. `curl -vvv -f -H 'Authorization: Token XXXX' -u username:password -H 'Content-Type: application/json' -XPOST http://awxhost/api/v2/workflow_job_template_nodes/ -d @nodes.json`\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCreation of nodes for related workflow\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAuthorization failure.\r\n\r\nClient:\r\n```\r\n* The requested URL returned error: 400 Bad Request\r\n* stopped the pause stream!\r\n100   706    0     0  100   706      0   7887 --:--:-- --:--:-- --:--:--  7932\r\n* Closing connection 0\r\ncurl: (22) The requested URL returned error: 400 Bad Request\r\n```\r\n\r\nServer:\r\n``awx_web      | 2019-09-19 08:40:32,754 WARNING  awx.api.generics status 401 received by user AnonymousUser attempting to access /api/v2/workflow_job_template_nodes/ from XXX.XXX.XXX.XXX\r\nawx_web      | 2019-09-19 08:40:32,780 WARNING  django.request Bad Request: /api/v2/workflow_job_template_nodes/\r\nawx_web      | 2019-09-19 08:40:32,780 WARNING  django.request Bad Request: /api/v2/workflow_job_template_nodes/\r\nawx_web      | [pid: 153|app: 0|req: 57/208] XXX.XXX.XXX.XXX () {38 vars in 568 bytes} [Thu Sep 19 08:40:32 2019] POST /api/v2/workflow_job_template_nodes/ => generated 140 bytes in 74 msecs (HTTP/1.1 400) 8 headers in 246 bytes (1 switches on core 0)\r\nawx_web      | XXX.XXX.XXX.XXX - - [19/Sep/2019:08:40:32 +0000] \"POST /api/v2/workflow_job_template_nodes/ HTTP/1.1\" 400 140 \"-\" \"curl/7.54.0\" \"-\"``\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThe current behavior is, that a normal user can see all other users, even those who are not in the same team. For security reasons it would be better to limit the view to team members."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nRunning a template fails, with error message the role was not found:\r\n\r\n`ERROR! the role 'generic_loadbalancer' was not found in /tmp/awx_34_fl2ueiip/project/playbooks/roles:/tmp/awx_34_fl2ueiip/requirements_roles:/tmp/awx_34_fl2ueiip/project/playbooks\r\nThe error appears to be in '/tmp/awx_34_fl2ueiip/project/playbooks/generic_loadbalancer.yml': line 10, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\nThe offending line appears to be:\r\n  roles:\r\n    - { role: generic_loadbalancer }\r\n      ^ here\r\n`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.8.4, 2.7.16\r\n* Operating System:\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Deploy to Kubernetes using AWX 7.0.0 Images\r\n2. Create new Project, Inventory and Template\r\n3. Run Job Template\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPlaybook is successfully executed\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPlaybook cannot be executed as no roles can be found in the paths. However executing the code for project copy manually is working fine inside the pod. \r\nTracking the temporary directories with a watch inside the pod shows that the roles are actually copied to /tmp/awx_*/project/roles, but removed shortly afterwards.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.4\r\n* Operating System: Debian\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nTry to sync an inventory using \"Sourced from a Project\" source.\r\nThe job fails with no clear output. When visiting API I find the issue and pin it in specific job running before that\r\n\r\n##### EXPECTED RESULTS\r\n\r\nInventory sync to happen\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nA failed Task\r\n\r\n##### ADDITIONAL INFORMATION\r\nChecking the inventory_update job number 980 I find this error:\r\n\r\n```\r\n{\r\n    \"id\": 980,\r\n    \"type\": \"inventory_update\",\r\n    \"url\": \"/api/v2/inventory_updates/980/\",\r\n    \"related\": {\r\n        \"created_by\": \"/api/v2/users/1/\",\r\n        \"unified_job_template\": \"/api/v2/inventory_sources/28/\",\r\n        \"stdout\": \"/api/v2/inventory_updates/980/stdout/\",\r\n        \"inventory_source\": \"/api/v2/inventory_sources/28/\",\r\n        \"cancel\": \"/api/v2/inventory_updates/980/cancel/\",\r\n        \"notifications\": \"/api/v2/inventory_updates/980/notifications/\",\r\n        \"events\": \"/api/v2/inventory_updates/980/events/\",\r\n        \"source_project_update\": \"/api/v2/project_updates/981/\",\r\n        \"inventory\": \"/api/v2/inventories/4/\",\r\n        \"credentials\": \"/api/v2/inventory_updates/980/credentials/\",\r\n        \"source_project\": \"/api/v2/projects/24/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"inventory\": {\r\n            \"id\": 4,\r\n            \"name\": \"kubernetes\",\r\n            \"description\": \"\",\r\n            \"has_active_failures\": false,\r\n            \"total_hosts\": 0,\r\n            \"hosts_with_active_failures\": 0,\r\n            \"total_groups\": 0,\r\n            \"groups_with_active_failures\": 0,\r\n            \"has_inventory_sources\": true,\r\n            \"total_inventory_sources\": 1,\r\n            \"inventory_sources_with_failures\": 1,\r\n            \"organization_id\": 1,\r\n            \"kind\": \"\"\r\n        },\r\n        \"unified_job_template\": {\r\n            \"id\": 28,\r\n            \"name\": \"Update inventory\",\r\n            \"description\": \"\",\r\n            \"unified_job_type\": \"inventory_update\"\r\n        },\r\n        \"inventory_source\": {\r\n            \"source\": \"scm\",\r\n            \"last_updated\": \"2019-09-14T13:42:08.653158Z\",\r\n            \"status\": \"failed\"\r\n        },\r\n        \"instance_group\": {\r\n            \"name\": \"tower\",\r\n            \"id\": 1\r\n        },\r\n        \"created_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"user_capabilities\": {\r\n            \"delete\": true,\r\n            \"start\": true\r\n        },\r\n        \"credentials\": [],\r\n        \"source_project\": {\r\n            \"id\": 24,\r\n            \"name\": \"Kubernetes\",\r\n            \"description\": \"\",\r\n            \"status\": \"successful\",\r\n            \"scm_type\": \"git\"\r\n        }\r\n    },\r\n    \"created\": \"2019-09-14T13:36:34.515351Z\",\r\n    \"modified\": \"2019-09-14T13:36:34.714877Z\",\r\n    \"name\": \"kubernetes - Update inventory\",\r\n    \"description\": \"\",\r\n    \"source\": \"scm\",\r\n    \"source_path\": \"inventory\",\r\n    \"source_script\": null,\r\n    \"source_vars\": \"\",\r\n    \"credential\": null,\r\n    \"source_regions\": \"\",\r\n    \"instance_filters\": \"\",\r\n    \"group_by\": \"\",\r\n    \"overwrite\": false,\r\n    \"overwrite_vars\": false,\r\n    \"custom_virtualenv\": null,\r\n    \"timeout\": 0,\r\n    \"verbosity\": 1,\r\n    \"unified_job_template\": 28,\r\n    \"launch_type\": \"manual\",\r\n    \"status\": \"error\",\r\n    \"failed\": true,\r\n    \"started\": \"2019-09-14T13:36:34.822591Z\",\r\n    \"finished\": \"2019-09-14T13:36:40.780413Z\",\r\n    \"elapsed\": 0.0,\r\n    \"job_args\": \"\",\r\n    \"job_cwd\": \"\",\r\n    \"job_env\": {},\r\n    \"job_explanation\": \"Previous Task Failed: {\\\"job_type\\\": \\\"project_update\\\", \\\"job_name\\\": \\\"Kubernetes\\\", \\\"job_id\\\": \\\"981\\\"}\",\r\n    \"execution_node\": \"ansibleworker1\",\r\n    \"result_traceback\": \"Traceback (most recent call last):\\n  File \\\"/usr/local/lib/python3.7/dist-packages/awx-7.0.0-py3.7.egg/awx/main/tasks.py\\\", line 1174, in run\\n    self.pre_run_hook(self.instance, private_data_dir)\\n  File \\\"/usr/local/lib/python3.7/dist-packages/awx-7.0.0-py3.7.egg/awx/main/tasks.py\\\", line 2330, in pre_run_hook\\n    project_update_task().run(local_project_sync.id)\\n  File \\\"/usr/local/lib/python3.7/dist-packages/awx-7.0.0-py3.7.egg/awx/main/tasks.py\\\", line 685, in _wrapped\\n    return f(self, *args, **kwargs)\\n  File \\\"/usr/local/lib/python3.7/dist-packages/awx-7.0.0-py3.7.egg/awx/main/tasks.py\\\", line 1330, in run\\n    raise AwxTaskError.TaskError(self.instance, rc)\\nException: project_update 981 (failed) encountered an error (rc=2), please see task stdout for details.\\n\",\r\n    \"event_processing_finished\": true,\r\n    \"inventory\": 4,\r\n    \"inventory_source\": 28,\r\n    \"license_error\": false,\r\n    \"org_host_limit_error\": false,\r\n    \"source_project_update\": 981,\r\n    \"source_project\": 24\r\n}\r\n```\r\nfinding the Job 981, which never Appears in my UI I queried the API and:\r\n\r\n```\r\n{\r\n    \"id\": 981,\r\n    \"type\": \"project_update\",\r\n    \"url\": \"/api/v2/project_updates/981/\",\r\n    \"summary_fields\": {\r\n        \"project\": {\r\n            \"id\": 24,\r\n            \"name\": \"Kubernetes\",\r\n            \"description\": \"\",\r\n            \"status\": \"successful\",\r\n            \"scm_type\": \"git\"\r\n        },\r\n        \"credential\": {\r\n            \"id\": 4,\r\n            \"name\": \"**\",\r\n            \"description\": \"\",\r\n            \"kind\": \"scm\",\r\n            \"cloud\": false,\r\n            \"credential_type_id\": 2\r\n        },\r\n        \"unified_job_template\": {\r\n            \"id\": 24,\r\n            \"name\": \"Kubernetes\",\r\n            \"description\": \"\",\r\n            \"unified_job_type\": \"project_update\"\r\n        },\r\n        \"instance_group\": {\r\n            \"name\": \"tower\",\r\n            \"id\": 1\r\n        },\r\n        \"user_capabilities\": {\r\n            \"delete\": true,\r\n            \"start\": true\r\n        }\r\n    },\r\n    \"created\": \"2019-09-14T13:36:34.882981Z\",\r\n    \"modified\": \"2019-09-14T13:36:34.882989Z\",\r\n    \"name\": \"Kubernetes\",\r\n    \"description\": \"\",\r\n    \"local_path\": \"_24__kubernetes\",\r\n    \"scm_type\": \"git\",\r\n    \"scm_url\": \"*******\",\r\n    \"scm_branch\": \"\",\r\n    \"scm_refspec\": \"\",\r\n    \"scm_clean\": true,\r\n    \"scm_delete_on_update\": true,\r\n    \"credential\": 4,\r\n    \"timeout\": 0,\r\n    \"scm_revision\": \"a79609e829f4908c94008e52ba9a9f73e4450ab2\",\r\n    \"unified_job_template\": 24,\r\n    \"launch_type\": \"sync\",\r\n    \"status\": \"failed\",\r\n    \"failed\": true,\r\n    \"started\": \"2019-09-14T13:36:34.882822Z\",\r\n    \"finished\": \"2019-09-14T13:36:40.760367Z\",\r\n    \"elapsed\": 5.878,\r\n    \"job_explanation\": \"\",\r\n    \"execution_node\": \"ansibleworker1\",\r\n    \"result_traceback\": \"\",\r\n    \"event_processing_finished\": true,\r\n    \"project\": 24,\r\n    \"job_type\": \"run\",\r\n    \"host_status_counts\": {\r\n        \"failures\": 1\r\n    },\r\n    \"playbook_counts\": {\r\n        \"play_count\": 2,\r\n        \"task_count\": 15\r\n    }\r\n}\r\n```\r\n\r\nFinally the error on the Runbook:\r\n\r\n```\r\nIdentity added: /tmp/awx_981_u15xqles/artifacts/981/ssh_key_data ()\r\nNo config file found; using defaults\r\n\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [delete project directory before update] **********************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [update project using git] ************************************************\r\nok: [localhost, -> localhost] => {\"after\": \"a79609e829f4908c94008e52ba9a9f73e4450ab2\", \"before\": \"a79609e829f4908c94008e52ba9a9f73e4450ab2\", \"changed\": false, \"remote_url_changed\": false}\r\n\r\nTASK [Set the git repository version] ******************************************\r\nok: [localhost, -> localhost] => {\"ansible_facts\": {\"scm_version\": \"a79609e829f4908c94008e52ba9a9f73e4450ab2\"}, \"changed\": false}\r\n\r\nTASK [update project using hg] *************************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Set the hg repository version] *******************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [parse hg version string properly] ****************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [update project using svn] ************************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Set the svn repository version] ******************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [parse subversion version string properly] ********************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Ensure the project directory is present] *********************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Fetch Insights Playbook(s)] **********************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Save Insights Version] ***************************************************\r\nskipping: [localhost,] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [Repository Version] ******************************************************\r\nok: [localhost,] => {\r\n    \"msg\": \"Repository Version a79609e829f4908c94008e52ba9a9f73e4450ab2\"\r\n}\r\n\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [detect requirements.yml] *************************************************\r\nok: [localhost, -> localhost] => {\"changed\": false, \"stat\": {\"atime\": 1568468115.431545, \"attr_flags\": \"\", \"attributes\": [], \"block_size\": 512, \"blocks\": 9, \"charset\": \"us-ascii\", \"checksum\": \"78b666b9f4be6f267727d5e851e21569c251f2a7\", \"ctime\": 1568468115.419545, \"dev\": 173, \"device_type\": 0, \"executable\": false, \"exists\": true, \"gid\": 0, \"gr_name\": \"root\", \"inode\": 287311, \"isblk\": false, \"ischr\": false, \"isdir\": false, \"isfifo\": false, \"isgid\": false, \"islnk\": false, \"isreg\": true, \"issock\": false, \"isuid\": false, \"mimetype\": \"text/plain\", \"mode\": \"0644\", \"mtime\": 1568468115.419545, \"nlink\": 1, \"path\": \"/var/lib/awx/projects/_24__kubernetes/roles/requirements.yml\", \"pw_name\": \"root\", \"readable\": true, \"rgrp\": true, \"roth\": true, \"rusr\": true, \"size\": 258, \"uid\": 0, \"version\": null, \"wgrp\": false, \"woth\": false, \"writeable\": true, \"wusr\": true, \"xgrp\": false, \"xoth\": false, \"xusr\": false}}\r\n\r\nTASK [fetch galaxy roles from requirements.yml] ********************************\r\nfatal: [localhost,]: FAILED! => {\"msg\": \"The task includes an option with an undefined variable. The error was: 'roles_destination' is undefined\\\\n\\\\nThe error appears to be in '/usr/local/lib/python3.7/dist-packages/awx-7.0.0-py3.7.egg/awx/playbooks/project_update.yml': line 128, column 9, but may\\\\nbe elsewhere in the file depending on the exact syntax problem.\\\\n\\\\nThe offending line appears to be:\\\\n\\\\n\\\\n      - name: fetch galaxy roles from requirements.yml\\\\n        ^ here\\\\n\"}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost,                 : ok=4    changed=0    unreachable=0    failed=1    skipped=10   rescued=0    ignored=0   \r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAfter configuring Azure AD OAUTH2 and logging in, you will not be able to log in after the second time\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0(devel)\r\n* AWX install method: docker on linux\r\n* Operating System:CentOS7\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n・Configure Azure AD OAUTH2 settings\r\n・Log in once with AD authentication\r\n・Log out\r\n・I can't log in due to an error when I log in again\r\n・If you delete your account, you can log in only once\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNormal login\r\n\r\n##### ACTUAL RESULTS\r\nCan't login due to an error\r\n\r\n##### ADDITIONAL INFORMATION\r\n<img width=\"385\" alt=\"スクリーンショット 2019-09-13 23 52 39\" src=\"https://user-images.githubusercontent.com/1404766/64872819-cfafac80-d682-11e9-8bf7-1c8c8314cbb3.png\">\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAllow the `'` character in usernames inside of Tower. This is currently a limitation in the underlying django library: \r\n\r\nhttps://docs.djangoproject.com/en/1.11/ref/contrib/auth/"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n - Future Bug fix\r\n\r\n##### SUMMARY\r\nWe use inventory plugins for all the native inventory source types. These are vendored with Ansible core. These will move. The locations listed here may not be their final locations, but they will move somewhere:\r\n\r\n - aws_ec2: https://github.com/ansible-collections/ansible_collection_aws/blob/master/plugins/inventory/aws_ec2.py\r\n - gcp_compute: https://github.com/ansible-collections/ansible_collection_google/blob/master/plugins/inventory/gcp_compute.py\r\n - tower: https://github.com/ansible/awx/pull/4701\r\n\r\nOnce the migration to collection lands, the one we are using via our current logic will be deprecated. Then eventually removed.\r\n\r\nUnclear what the solution would look like:\r\n\r\n1. we could start vendoring inventory plugins like we did with scripts \r\n2. we run `ansible-galaxy collection install <>.<>.tower` before the update\r\n\r\nDepending on settings of the server, the namespace may need to be different things. With the implementation in https://github.com/ansible/awx/pull/4589, we would not properly have the information needed to do option 2."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nRelated to a specific comment in this PR: https://github.com/ansible/awx/pull/4657#discussion_r322938082\r\n\r\nThe `failure`, `success`, and `started` notification templates for Workflows _do not_ inherit from the Organization even though they should.  We have `approval` notifications inherit from the Org (per PR https://github.com/ansible/awx/pull/4657); the other notification types needs to be changed in order to send notifications for workflows when the notification templates are assigned at the Org level.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n#2701 added a \"Cleanup Expired OAuth 2 Tokens\" management job which runs the awx-manage `cleartokens` command. The [Django OAuth Toolkit docs](https://django-oauth-toolkit.readthedocs.io/en/latest/management_commands.html#cleartokens) for that command note\r\n\r\n> Refresh tokens need to expire before AccessTokens can be removed from the database. Using cleartokens without REFRESH_TOKEN_EXPIRE_SECONDS has limited effect.\r\n\r\nAWX currently does not have a default value for REFRESH_TOKEN_EXPIRE_SECONDS nor does it provide UI to set it, so the token clearing job pretty much always does nothing.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.4\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Firefox 69.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGo to Settings -> System and set a relatively low value for \"ACCESS TOKEN EXPIRATION\", e.g. 60.\r\n\r\nConfigure an Application to use the \"Authorization Code\" Grant type, and set \"Client Type\" to \"Confidential\".\r\n\r\nObtain a token using the steps in the [docs](https://docs.ansible.com/ansible-tower/latest/html/administration/oauth2_token_auth.html#application-using-authorization-code-grant-type), and wait for it to expire.\r\n\r\nRun the \"Cleanup Expired OAuth 2 Tokens\" management job\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe expired token should have been removed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe expired token is not removed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI created /etc/tower/conf.d/oauth-settings.py with the following contents\r\n```\r\nOAUTH2_PROVIDER[\"REFRESH_TOKEN_EXPIRE_SECONDS\"] = 60\r\n```\r\n\r\nand confirmed that running `awx-manage cleartokens` worked as expected. The presence of this setting breaks the entire settings UI though, so is not really a useable workaround.\r\n\r\nMy proposal is to add UI for the value of REFRESH_TOKEN_EXPIRE_SECONDS.\r\n\r\nAdding this setting has additional benefits: When using AWX with an LDAP server and the \"Allow external users to create OAuth2 tokens\" setting is enabled, tokens allow users to continue to access AWX even if their LDAP account is disabled as detailed in [this comment](https://github.com/ansible/awx/issues/2191#issuecomment-414710915) on #2191. Allowing AWX admins to specify an expiration time for refresh tokens would help mitigate that security risk by using relatively short-lived access and refresh tokens.\r\n\r\nIf there's interest in this I will try find the time to raise a PR."},{"labels":["api",null,null],"text":"```sql\r\nawx-dev=> SELECT COUNT(*) FROM main_unifiedjob;\r\n count\r\n--------\r\n 606596\r\n(1 row)\r\n```\r\n\r\n(on a poorly provisioned laptop with all services running in Docker containers)\r\n\r\nLogged in as an org admin and clicked back and forth between the dashboard and jobs list tabs:\r\n\r\nBefore:\r\n\r\n<img width=\"1279\" alt=\"image\" src=\"https://user-images.githubusercontent.com/214912/64664243-8cec9b00-d41c-11e9-82ac-080315a8063c.png\">\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\nWhen using a git repo with submodules (both relative submodule path and full path) AWX fails when running a job template that uses the git project.\r\n\r\n##### SUMMARY\r\nAWX tries to clone the local repo to ```/tmp``` with this command:\r\n```bash\r\ngit clone --branch=awx_local/<random_uid> --depth=1 --recursive --single-branch -v file:///var/lib/awx/projects/_7__My_Repo /tmp/awx_<random_dir>/project\r\n```\r\n\r\nWhen using full paths - the problem is that the git credential is not passed to clone the submodules.\r\n\r\nWhen using relative paths (for example ```../sub_repo``` or ```../sub_repo.git```) - AWX tries to clone the submodule from ```/var/lib/awx/projects/sub_repo``` which is also not working.\r\n\r\nThe problem is not with syncing the Project itself but with running a job template that uses this project.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: openshift\r\n* Ansible version:  2.7.5\r\n* Operating System:  Red Hat Enterprise Linux 7.6\r\n* Web Browser:  Tried on both Chrome and Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Create a project in awx that uses a git repo that contains submodules\r\n- Try to run a job that uses this project\r\n##### EXPECTED RESULTS\r\n\r\nJob should start normally\r\n\r\n##### ACTUAL RESULTS\r\n\r\nJob fails before even starting (Error details on the DETAILS section) \r\nSorry for no print screen, we are running on an On prem environment.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nOn prem environment\r\n"},{"labels":["api",null,null,null],"text":"##### SUMMARY\r\n\r\nI wanted to start a discussion about supporting `s390x`. I ported a version of AWX a while back to `s390x`, and it went pretty smooth. There were just a couple small tweaks that needed to be made to get the Docker images to build. \r\n\r\nHere are a couple of tweaks that were needed (These are off the top of my head, more might be needed):\r\n\r\n-\tTemplate out the base image pulls, CentOS to ClefOS\r\n-\tPoint the download for Tini to an updated version, I think v0.16.1 was the first build for `s390x`\r\n-\tSome lib C packages might need to be changed\r\n-\tIUS Repos will need to be changed/modified to alternative repo lists\r\n\r\nWould you guys be open to support `s390x`? \r\n\r\nI know a lot of the Dockerfiles are using templating to be dynamic. One possible solution would add a couple more dynamic parameters to allow for the changes that `s390x` needs. Thus, not changing the Dockerfiles for `x86` but still allowing `s390x` images to be built. \r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n1.  Create an OAuth2.0 token.\r\n2.  Run a request that results in an especially time consuming database transaction.  For example, to simulate a slow query, this code diff makes an HTTP GET request to `/api/` _very_ slow:\r\n\r\n```diff\r\ndiff --git a/awx/api/views/root.py b/awx/api/views/root.py\r\nindex 922041c8b..711907f8d 100644\r\n--- a/awx/api/views/root.py\r\n+++ b/awx/api/views/root.py\r\n@@ -50,6 +50,8 @@ class ApiRootView(APIView):\r\n     def get(self, request, format=None):\r\n         ''' List supported API versions '''\r\n\r\n+        for x in Instance.objects.raw('SELECT id, pg_sleep(30) FROM main_instance'):\r\n+            print(x)\r\n         v2 = reverse('api:api_v2_root_view', kwargs={'version': 'v2'})\r\n         data = OrderedDict()\r\n         data['description'] = _('AWX REST API')\r\n```\r\n\r\n```shell\r\n~curl -sk -H 'Authorization: Bearer TOKEN' 'https://awx.example.org/api/'\r\n```\r\n\r\n3.  Observe that step 2 takes 30 seconds.  During this time, an exclusive row lock is held on the row for that OAuth2.0 token:\r\n\r\n```sql\r\nSELECT t.relname,l.locktype,page,virtualtransaction,pid,mode,granted FROM pg_locks l, pg_stat_all_tables t WHERE l.relation=t.relid ORDER BY relation ASC;\r\nmain_oauth2accesstoken | relation |      | 5/99223            | 20896 | RowExclusiveLock | t\r\n```\r\n\r\n4.  Simultaneously, perform an HTTP request on a *different* unrelated API endpoint using the *same* OAuth2.0 token:\r\n\r\n```shell\r\n~curl -sk -H 'Authorization: Bearer TOKEN' 'https://awx.example.org/api/v2/settings/'\r\n```\r\n\r\nObserve the second request _does not_ complete until the first request completes.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n`awx ad_hoc_commands modify` does not make since because ad_hoc_commands are not re-runnable or editable\r\n\r\nThis is probably an OPTIONS problem"},{"labels":["api",null,null],"text":"tracking progress here.."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCreate an inventory, inside that inventory create a host with name \"foo\". Then create a group with name \"foo\".\r\n\r\nThis breaks playbooks.\r\n\r\nWe should prevent the creation of the group with name \"foo\" because a host by that name exists, and return a 400 error message with details in this case.\r\n\r\nRelated https://github.com/ansible/awx/issues/3384"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer an user's request, they would like to be able to specify their own conditions on acceptable survey answers (i.e. regular expressions). \r\n\r\nIn the customer's use case, they would like to validate an IP address in the survey answer. This could also extend out to other use cases (e.g. If a customer has a naming convention for assets, systems, etc., the user can populate information in order to verify the provided Answer is considered acceptable.)"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nAWX seems to read right ansible.cfg file but uses default _roles_path_ value.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.4\r\n* Operating System: Ubuntu 18.04\r\n\r\n##### STEPS TO REPRODUCE\r\nDirectory tree:\r\n\r\n├── ansible.cfg\r\n├── hosts\r\n├── inventory\r\n├── main.yml\r\n├── playbooks\r\n│   ├── consul\r\n│   │   ├── files\r\n│   │   ├── group_vars\r\n│   │   ├── host_vars\r\n│   │   ├── main.yml\r\n│   │   └── vars\r\n├── roles\r\n│   ├── brianshumate.consul\r\n...\r\n`# cat ansible.cfg`\r\n> [defaults]\r\n> roles_path = roles\r\n\r\nPlace roles directory inside project root.\r\nSet _roles_path = roles_ in ansible.cfg \r\nRun playbook which requires any role e.g.: _playbooks/consul/main.yml_\r\n\r\n##### EXPECTED RESULTS\r\n> Ansible Tower runs ansible-playbook from the root of the project directory, where it will then find the custom ansible.cfg file. An ansible.cfg anywhere else in the project will be ignored.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`Identity added: /tmp/awx_1162_3sgq_dhy/artifacts/1162/ssh_key_data (/tmp/awx_1162_3sgq_dhy/artifacts/1162/ssh_key_data)\r\nansible-playbook 2.8.4\r\n  config file = /tmp/awx_1162_3sgq_dhy/project/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Jun 20 2019, 20:27:34) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\nUsing /tmp/awx_1162_3sgq_dhy/project/ansible.cfg as config file\r\nhost_list declined parsing /tmp/awx_1162_3sgq_dhy/tmpmjfgzc8z as it did not pass it's verify_file() method\r\n...\r\nERROR! the role 'brianshumate.consul' was not found in /tmp/awx_1162_3sgq_dhy/project/playbooks/consul/roles:/tmp/awx_1162_3sgq_dhy/requirements_roles:/tmp/awx_1162_3sgq_dhy/project/playbooks/consul`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWorked in AWX 6.1.0 with ansible 2.8.2"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nColors in Ansible task outputs are not rendered in the UI.\r\n\r\nCommands that invoke Ansible commands (such as our project update playbook does) force use of colors.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nrun a job template with this playbook:\r\n\r\nhttps://github.com/AlanCoding/utility-playbooks/blob/master/color_outputs.yml\r\n\r\nClick on the task that runs the ansible config command. Click on the stdout tab.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nEither there are no colors, or the text is colored.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nMarkers indicating terminal colors, but no rendered.\r\n\r\n![Screen Shot 2019-09-06 at 10 32 39 AM](https://user-images.githubusercontent.com/1385596/64436632-c0cd6680-d092-11e9-9782-f4275d21e31c.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nOrdinarily, commands detect if it is in an interactive terminal and do not use colors when invoked in this context. But commands such as these show colors because:\r\n\r\nhttps://github.com/ansible/awx/blob/ffbce2611a9897909e1fe756cecf367dd91b2579/awx/settings/defaults.py#L583-L585\r\n\r\nAnsible core has cleaned up some of their output from `ansible-galaxy` commands in https://github.com/ansible/ansible/pull/61902 Thank you @jborean93 for doing that and @abadger for helping us to triage these issues.\r\n\r\nThis unwanted color syntax is user-facing (because they need this output to debug anything related to role installing), and the presence of these markings are entirely due to AWX. It must be solved here, cannot be solved in the Ansible core side."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen running a project update for a playbook which depends on roles defined in requirements.yml, the task job finishes successfully even if the roles are not successfully installed\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Tower 3.5.1\r\n* AWX install method: openshift\r\n* Ansible version:  2.8.2\r\n* Operating System: Fedora 30\r\n* Web Browser: Firefox 68\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Add a project containing a playbook and a requirements.yml file\r\n1.1 The role in the requirements.yml file is incorrect - e.g. missing meta/main.yml\r\n2. Run a project update\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe project update job fails\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe project update job succeeds due to an --ignore-errors flag in the ansible-galaxy command (I assume). Upon inspecting the TASK [fetch galaxy roles from requirements.yml] \r\n[tower_fail.log](https://github.com/ansible/awx/files/3578651/tower_fail.log)\r\noutput, one can see:\r\n\"stderr_lines\": [\r\n        \"\\u001b[1;35m [WARNING]: - comet was NOT installed successfully: this role does not appear\\u001b[0m\",\r\n        \"\\u001b[1;35mto have a meta/main.yml file.\\u001b[0m\",\r\n        \"\\u001b[1;35m\\u001b[0m\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n- added the whole task log to attachment\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nLogin with SAML fails after upgrade to `7.0.0` due to missing `saml_auditor_attr` in settings. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 7.0.0\r\n* AWX install method: openshift manual deployment\r\n* Ansible version:  2.8.4\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\nThis should be identical when using docker-compose, as our manual AWX OpenShift instance is more or less identical to the docker-compose version. \r\nHave a AWX instance running in OpenShift manually deployed. Upgrade to new version by pushing new images to ImageStream, let migrations run and deployment finish. \r\n\r\nAttempt to login with existing SAML login that utilizes the `SOCIAL_AUTH_SAML_ORGANIZATION_ATTR` setting. \r\n\r\n##### EXPECTED RESULTS\r\nAWX is updated to 7.0.0 and login still works as normal. \r\n\r\n##### ACTUAL RESULTS\r\nLogin failed with error `saml_auditor_attr` \r\n\r\n##### ADDITIONAL INFORMATION\r\nSeems related to this: https://github.com/ansible/awx/pull/3623\r\n\r\n##### WORKAROUND\r\nAdd the `saml_auditor_attr` with a value manually to the Database in table `conf_settings` in row `SOCIAL_AUTH_SAML_ORGANIZATION_ATTR`\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nProjects are not supposed to update to newer versions when a job is ran, unless the project is set to update on launch.\r\n\r\nThis appears to be happening when `scm_branch` of the project is blank, and new commits have been added to the repo.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\ncreate a new project with test-playbooks, then merge a PR to that repo, and re-run a job that uses the debug playbook from it.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nold version ran\r\n\r\n##### ACTUAL RESULTS\r\n\r\nnew version ran\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nfallout from project branch override\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer a customer's request, they would like to generate custom reports based on job template runs via the Tower UI. For example, when patching remote systems, they would like to generate a pie chart where it shows systems that were successful (`ok` in `PLAY RECAP`), systems that failed (`failed` in `PLAY RECAP`), and systems that were missed (`unreachable` in `PLAY RECAP`)."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen trying to manage an AWS Transit Gateway from AWX, the job fails with \"msg\": \"transit gateway module requires boto3 >= 1.9.52\"\r\nHowever if I run the same playbook from the same AWX host on the command line the job is successful.\r\nStrangely the first task in the playbook is succesfull. It uses the 'sts_assume_role' Ansible module to get an STS access token which I register and pass into the ec2_transit_gateway task. \r\nBoth Ansible modules \"sts_assume_role\" and \"ec2_transit_gateway\" use boto3.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.2\r\n* Operating System: Ubuntu 18.04.3\r\n* Web Browser: Chrome 76.0.3809.132\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRan the same playbook interactively on the command line\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSecond task in the playbook should've failed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nComplete playbook run was successful\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSanitised code:\r\n\r\n```\r\n---\r\n- name: Workflow to ultimately manage Transit Gateway in the XXX AWS Account\r\n  hosts: localhost\r\n  \r\n  tasks:\r\n\r\n  - name: Create variable for desired region\r\n    set_fact: \r\n      defined_region: us-east-1\r\n\r\n  - name: Assume role and obtain STS token\r\n    sts_assume_role:\r\n     region: \"{{ defined_region }}\"\r\n     role_arn: arn:aws:iam::123456789123:role/My-AWS-Automation-Role-Name\r\n     role_session_name: \"AWS-Automation-session\"\r\n    register: assumed_role\r\n\r\n  - name: Manage Transit Gateway for XXX AWS Account\r\n    ec2_transit_gateway:\r\n     aws_access_key: \"{{ assumed_role.sts_creds.access_key }}\"\r\n     aws_secret_key: \"{{ assumed_role.sts_creds.secret_key }}\"\r\n     security_token: \"{{ assumed_role.sts_creds.session_token }}\"\r\n     description: \"My Awesome TGW\"\r\n     state: present\r\n     #asn: \r\n     auto_associate: no\r\n     auto_attach: yes \r\n     auto_propagate: no\r\n     dns_support: yes\r\n     vpn_ecmp_support: yes\r\n     region: \"{{ defined_region }}\"\r\n     tags:\r\n      Name: my-awesome-tgw\r\n      module: ec2_transit_gateway\r\n      my-tag: heck-yeah\r\n\r\n\r\n\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nTrying to run ansible playbook to create aws eks cluster using aws_eks_cluster module, this I'm trying to run on latest version of awx i.e 6.1.0 having ansible version 2.8.2, this playbook works fine locally but on awx it gives error: \"msg\": \"aws_eks_cluster module requires botocore >= 1.10.32\"\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: kubernetes, and ubuntu server\r\n* Ansible version:  2.8.2\r\n* Operating System: ubuntu\r\n* Web Browser: crome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nTrying to run playbook via awx console\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt should create eks cluster on AWS platform\r\n \r\n##### ACTUAL RESULTS\r\n\r\n\"msg\": \"aws_eks_cluster module requires botocore >= 1.10.32\"\r\n\r\n##### ADDITIONAL INFORMATION\r\nusing aws_eks_cluster ansible module to create a cluster"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI changed `ANSIBLE_GATHER_TIMEOUT` in `EXTRA ENVIROMENT VARIABLES` via `/etc/tower/settings.py`, but `gather_timeout` is still in default value `10`.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.9\r\n* Operating System: Debian 9.8\r\n* Web Browser: Firefox 68.0.1 (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* I added line to end of file `/etc/tower/settings.py`.\r\n```\r\n[root@awxweb awx]# tail -n 1 /etc/tower/settings.py \r\nAWX_TASK_ENV['ANSIBLE_GATHER_TIMEOUT'] = 60\r\n```\r\n* I checked this change in webUI.\r\n![Screenshot(37)](https://user-images.githubusercontent.com/15999901/64098873-3f12cb80-cd68-11e9-8497-4e4691f0b20b.png)\r\n\r\n* But when I show debug info some job for `TASK [Gather facts]` (in webUI), I still see default value.\r\n![Screenshot(38)](https://user-images.githubusercontent.com/15999901/64099053-a6308000-cd68-11e9-8a49-69470610918b.png)\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nChange value `gather_timeout`.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`gather_timeout` ignore change.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAdd feature which integrates GitHub OAuth user objects in Tower with a corresponding SCM credential on login for seamless project integration into Tower."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer a customer's request, Project Admins should be able to configure which Python virtual environment is used within a Project. Currently, only System/Organization Administrators have this ability."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThis is an enhancement to the current implementation for workflow pause/approve. Currently, if an approval node times out, the upper counter does not update. If a workflow node timed out and completed, the end user goes to click the counter, but does not get any useful information.\r\n\r\nThere are two approaches to this:\r\n1) Update the notification to indicate that the workflow timed out, and persist it in the notifications list. This provides more information, but may cause a lot of noise in a complicated list.\r\n2) Simply update the counter so that the user does not see any \"ghost\" workflow pause/approval notifications. \r\n\r\nlink https://github.com/ansible/awx/issues/1206\r\n\r\ncc @mabashian @beeankha "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n \r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nForced role overwrite is currently dependent on the revision of the parent project. Updating the roles without modifying the parent project can result in stale roles being used for the job run. Setting project options \"update on launch + delete on update\" is a workaround for a single node install, but when running as a cluster only the execution node selected for the scm_update will install the updated roles within the cache timeout. This can cause an issue when running the jobs concurrently across multiple nodes. The other workaround here would be to update the requirements.yml file in the project with version info of the role so that there is a revision change on the project.\r\n\r\nSince it is not ideal to have a forced overwrite of roles in all use cases, it would be cool if we had the option per project to always use the `fetch galaxy roles from requirements.yml (forced update)` task for project updates. This would probably require a modification of the conditionals for the role update tasks in /awx/playbooks/project_update.yml and the introduction of a new variable (e.g. scm_force). \r\n\r\n\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - General Issue\r\n\r\n##### COMPONENT NAME\r\nAPI\r\nUI\r\n\r\n##### SUMMARY\r\nHi All,\r\n\r\nWe are trying to retrieve the password from Cyberark AIM Secret Lookup Credential Type by passing the AIM URL, Application ID and Object Query. While running the test its giving us 400 Response Code from Ansible Tower.\r\nWhereas, when we try to access the same API using POSTMAN with POST Method we are getting the successful response.\r\nNeed some suggestion, do we have dependencies for Ansible Tower to Cyberark integration. \r\nor any issue with Cred Module as we don't see POST Method for querying.\r\nANSIBLE CRED PLUGIN MODULE : https://github.com/ansible/awx/blob/c626f51dae09fb7770bc313f7d7f28e86ef2b9a3/awx/main/credential_plugins/aim.py\r\n\r\n\r\nENVIRONMENT\r\n* Ansible version:  \r\nansible 2.8.1\r\npython version = 2.7.5 \r\nAWX Version = Ansible 2.8.2"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUsing mulitple OpenStack inventories (single source^1 for each), the creation of a smart inventory to filter an inventory with all hosts (from OpenStack inventories) via AWX web ui only allows 101 hosts per smart inventory.\r\n\r\nIs this an intended cap? Cannot find any documentation on this.\r\n\r\n^1= What I mean by this is a single \"Inventory\" is made under Inventories. This \"Inventory\" has only one source under \"Sources\" and is a OpenStack source.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.4\r\n* Operating System: centos7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create two inventories with a single OpenStack source that when combined have over 101+ hosts.\r\n2. Create a smart inventory that would collect all hosts (over 101+) using the smart host filter.\r\n\r\n##### EXPECTED RESULTS\r\nSmart inventory collects all hosts.\r\n\r\n##### ACTUAL RESULTS\r\nSmart inventory collects only 101 hosts.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nTrying to run tower-type inventory sync (like when you use a different tower as an inventory source) fails with ansible@devel.\r\n\r\nNOTE: ansible 2.9 feature freeze is August 29 AFAIK.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* Ansible version:  devel\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate a tower inventory source, attempt to run inventory update\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nWorks\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file  [WARNING]:  * Failed to parse /tmp/awx_2789_hg1ql6mm/tower.yml with auto plugin: Invalid type for configuration option plugin_type: inventory plugin: tower setting: inventory_id : Invalid type provided for \"string\": 1513    File \"/usr/lib/python2.7/site-packages/ansible/inventory/manager.py\", line 280, in parse_source     plugin.parse(self._inventory, self._loader, source, cache=cache)   File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/auto.py\", line 58, in parse     plugin.parse(inventory, loader, path, cache=cache)   File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/tower.py\", line 150, in parse     self._read_config_data(path)   File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/__init__.py\", line 229, in _read_config_data     self.set_options(direct=config)   File \"/usr/lib/python2.7/site-packages/ansible/plugins/__init__.py\", line 75, in set_options     self._options = C.config.get_plugin_options(get_plugin_class(self), self._load_name, keys=task_keys, variables=var_options, direct=direct)   File \"/usr/lib/python2.7/site-packages/ansible/config/manager.py\", line 348, in get_plugin_options     options[option] = self.get_config_value(option, plugin_type=plugin_type, plugin_name=name, keys=keys, variables=variables, direct=direct)   File \"/usr/lib/python2.7/site-packages/ansible/config/manager.py\", line 409, in get_config_value     keys=keys, variables=variables, direct=direct)   File \"/usr/lib/python2.7/site-packages/ansible/config/manager.py\", line 502, in get_config_value_and_origin     (to_native(_get_entry(plugin_type, plugin_name, config)), to_native(e)))   [WARNING]: Unable to parse /tmp/awx_2789_hg1ql6mm/tower.yml as an inventory source  ERROR! No inventory was parsed, please check your configuration and options.  TIME WHEN STATUS WAS FOUND: 2019-08-23 14:45:34.907173 (UTC)\r\n```\r\n\r\n\r\nKey portion of this error:\r\n```\r\nInvalid type for configuration option plugin_type: inventory plugin: tower setting: inventory_id : Invalid type provided for \"string\": 1513    File \"/usr/lib/python2.7/site-packages/ansible/inventory/manager.py\", line 280, in parse_source     plugin.parse(self._inventory, self._loader, source, cache=cache)   \r\n```\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\n@AlanCoding you mentioned https://github.com/ansible/ansible/issues/59442"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAttempting to add an instance filter for `launch-time` in an EC2 source can be done similar to the following:\r\n\r\n`launch-time=2019-08*`\r\n\r\nThis will import all hosts with a launch time in August of 2019, as expected. However, if you want to filter all hosts launched after that:\r\n\r\n`launch-time=>2019-08*`\r\n\r\nThis will import 0 hosts. It seems any formatting with the greater than or less than conditionals will import 0 hosts. It would be helpful to be able to filter using these operators."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWhen the external authentication (LDAP/SAML/OAuth etc.) is enabled, there is a use-case to turn off the authentication for local users for security reason.\r\n\r\nIt would be great if there is a toggle switch to turn on/off authentication for local users. When the local auth is disabled, it is not able to log in via local users but Tower can use built-in admin user in backup/restore process.\r\n"},{"labels":["api",null,null,null,null],"text":"[This sleep](https://github.com/jladdjr/awx/commit/b0a89f03a418a1bdc717722cd15b3c507bf0cd42#commitcomment) got us in trouble [once](https://github.com/ansible/awx/issues/4536#issuecomment-523681467). Making an issue so I don't forget to follow-up on this.\r\n\r\nAlso creating an issue b/c we're not entirely sure what kind of fallout might happen if we pull this out. (My sense is that the worse case scenario would be that the notifications with a body - e.g. webhooks - may have incomplete job summary info, but maybe the scope is larger than that).\r\n\r\nMarking as bughancement.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nError handling for invalid form entry for Customized messages in NT isn't prescriptive or defensive. Example https://github.com/ansible/awx/issues/4539\r\n\r\n##### STEPS TO REPRODUCE\r\nRepro in https://github.com/ansible/awx/issues/4539\r\n\r\n##### EXPECTED RESULTS\r\nDefensive form entry to prevent bad input. OR\r\nPrescriptive feedback on how to correct bad form entry\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNondescript error message\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhttps://github.com/ansible/awx/issues/4539\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\nCurrently we have no way to ship ad-hoc command to the log aggregator \r\n/api/v2/ad_hoc_commands/\r\n\r\nWhen a user executes an ad-hoc command, a single activity_stream event is sent representing the creation of the command  but no other information is. None of the 'ad_hoc command events' available in the Tower API are sent.\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nThe actual behavior in a survey when we select elements in a list with multiple choices is to sort them alphabetically. It would be nice to have the possibility to sort them manually, by selecting them in the order we want for example.\r\n\r\nActual behavior :\r\n![1](https://user-images.githubusercontent.com/22099779/63435685-a5722280-c427-11e9-935c-8455341e3bed.png)\r\n\r\nDesired behavior :\r\n![2](https://user-images.githubusercontent.com/22099779/63435707-aefb8a80-c427-11e9-93aa-6e92fbce9dd7.PNG)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen a google compute engine credential is created with the json credential file, AWX is stripping some valuable lines. I need those, as I am using gcp_compute_disk module which also requires the service account file to be give as absolute path to the json and instead of giving the file path twice manually, I am using {{ lookup('env','GCP_SERVICE_ACCOUNT_FILE') }} to refer the absolute path to the json, but I am getting error that the lines about email and token_uri are missing.\r\nIn order to resolve that I was forced to create a custom credential type for uploading the json and use it without stripping.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.x.x\r\n* AWX install method: docker\r\n* Ansible version:  2.8.2\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Firefox, Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUpload a google json credential to awx and try to use the service_account_file: \"{{ lookup('env','GCP_SERVICE_ACCOUNT_FILE') }}\" when using the gcp_compute_disk module for example. Your AWX template must be pointed to the gce credential also.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nget the full json and take all needed lines\r\n\r\n##### ACTUAL RESULTS\r\n\r\ngets the json, but it seems the AWX module for gce credenials strips some lines and the file is usable by the gcp_compute_* ansible modules.\r\n\r\n##### ADDITIONAL INFORMATION\r\nNew credential type I've used to get around this is:\r\n\r\nInput configuration:\r\n`fields:\r\n  - id: gcp_credential_file\r\n    type: string\r\n    label: GCP Credential File (JSON)\r\n    secret: true\r\n    multiline: true`\r\n\r\nInjector configuration:\r\n`env:\r\n  GCP_SERVICE_ACCOUNT_FILE: '{{ tower.filename }}'\r\nfile:\r\n  template: '{{ gcp_credential_file }}'`\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWe have around 400 hosts in the inventory, however, the notification webhook endpoint receives notification about only around 40-50 hosts. (Sometimes it's working fine reporting all the hosts.)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0.0 (Same problem with 6.0.0.0)\r\n* AWX install method: docker on linux (official image from docker hub)\r\n* Ansible version:  2.8.2\r\n* Operating System: Centos7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n- Create a webhook notification\r\n- Start a job (or job-flow), enable notifications.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nReport from all the hosts in JSON format\r\n\r\n##### ACTUAL RESULTS\r\n\r\nMost of the times only partial host list in the report, sometimes full list. Differs in a job-flow, some jobs reporting about all hosts, some only about a few)\r\n\r\nWorkflow with 2 jobs:\r\nNumber of hosts, on which the job ran (reported in AWX): 438\r\nNumber of hosts reported on the webhook script: 53\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI also have the same problem with 6.0.0.0 and 6.1.0.0\r\nI tried with different users, with standalon jobs or woth flows, also with different playbooks, the problem looks pretty consistent.\r\n\r\n\r\nThx\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen a project includes a `roles/requirements.yaml` file it is not detected or processed:\r\n```\r\nTASK [detect requirements.yml] *************************************************\r\nok: [localhost, -> localhost] => {\"changed\": false, \"stat\": {\"exists\": false}}\r\n```\r\nIt looks like the task to detect the file looks specifically for `requirements.yml` and not also `requirements.yaml`.\r\n\r\nThis is contrary to the YAML offical extension: https://yaml.org/faq.html\r\n\r\n(Generally because both `.yaml` and `.yml` are in common usage, they should be considered interchangeable as different people like different things for their own reasons. I'd expect AWX/Tower to check and use a file with either extension, and throwing an error if it finds both)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.5.2\r\n* AWX install method: Tower\r\n* Ansible version:  2.8\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate an AWX/Tower role and specify requirements in `roles/requirements.yaml` and clone into a project\r\n\r\nrename to requirements.yml and it works.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expected that the roles specified in `requirements.yaml` would be installed\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe file `requirements.yaml` was ignored and roles were not installed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWe use Ansible Tower, but I think AWX has this issue too.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nCannot create a custom notification message with {{ job.extra_vars }} in message\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Attempt to create a custom notification Start Message with `{{ job.extra_vars }}` in the body\r\n\r\n##### EXPECTED RESULTS\r\nCan save and use NT\r\n\r\n##### ACTUAL RESULTS\r\n400 Error on Save\r\n\r\n##### ADDITIONAL INFORMATION\r\n![Screen Shot 2019-08-20 at 7 14 03 PM](https://user-images.githubusercontent.com/12446869/63390917-b155da00-c37e-11e9-8109-384e7758b70f.png)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUnable to a new line to Start, Success, and Failure Message for Customized Email Notification Types. \r\n\r\nNotes:\r\n\r\n- New lines can be added to Start, Success and Failure Message **Body** however.\r\n- Message, itself, can be modified as long as a new line is not added\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a working email notification\r\n2. Modify the notification's customizable messages by adding a new line to Start Message.\r\n3. Assign Notification to JT and launch JT.\r\nNote: Start Message not received.\r\n\r\n##### EXPECTED RESULTS\r\n1. Modified Start Message to be received.\r\n\r\n##### ACTUAL RESULTS\r\nNo start message received. If Job failed/succeeded, then the customized notification success/failure message is received.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis works\r\n![Screen Shot 2019-08-20 at 6 20 15 PM](https://user-images.githubusercontent.com/12446869/63388655-2cb38d80-c377-11e9-8aef-85ebe62db98e.png)\r\n\r\nThis doesn't\r\n![Screen Shot 2019-08-20 at 6 20 45 PM](https://user-images.githubusercontent.com/12446869/63388687-3f2dc700-c377-11e9-8a8b-9f1cce981d3a.png)\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nNotify on Job Start notifications can dramatically reduce the performance of a JT run. In the scenario:\r\n\r\nJT: multivault.yml\r\nNotifications: 26 Slack Notifications being triggered on launch and on success\r\nRuntime is **4:25**\r\nNote: the time between success messages is considerable (15 seconds). The time between success messages is less than a second\r\n\r\nJT: multivault.yml\r\nNotifications: Disabled\r\nRuntime is **0:03**\r\n\r\nJT: multivault.yml\r\nNotifications: Notification on success\r\nRuntime is **0:03**\r\n\r\nNote: this is occurs with Webhook notifications as well\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a generic JT\r\n2. Run to completion\r\n3. Create 26 Slack Notifications\r\n4. Add Notifications to JT on step 1 to start on Launch\r\n5. Run to completion\r\n\r\n##### EXPECTED RESULTS\r\nExpect JT runtimes to be similar and notifications to trigger async.\r\n\r\n##### ACTUAL RESULTS\r\nRuntime performance dramatically impacted\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n26 Notifications\r\n![Screen Shot 2019-08-20 at 3 19 12 PM](https://user-images.githubusercontent.com/12446869/63377316-e30a7900-c35d-11e9-9107-d5b2c6ff2aff.png)\r\n\r\nNo notifications\r\n![Screen Shot 2019-08-20 at 3 23 53 PM](https://user-images.githubusercontent.com/12446869/63377687-8e1b3280-c35e-11e9-879b-1caee736ada8.png)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nA JT with multiple notifications attached (for same event type - e.g. started), only uses one NT to generate all notifications\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create three Slack Notification, each with a different custom message\r\n2. Create a JT with all 3 Slack Notifications configured on start\r\n3. Launch JT\r\n\r\n##### EXPECTED RESULTS\r\nEach custom message should be delivered\r\n\r\n##### ACTUAL RESULTS\r\nOne custom message is delivered three times\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUnable to remove customized messages from notification template\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a Slack notification with customized notification messages.\r\n2. Edit Slack notification from step 1 and remove customized notification messages via toggle and save\r\nNote: 500 error\r\n\r\n##### EXPECTED RESULTS\r\n1. Default messages used and customize message toggle disabled\r\n\r\n##### ACTUAL RESULTS\r\nHTTP 500 from API\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<img width=\"1497\" alt=\"Screen Shot 2019-08-20 at 12 43 30 PM\" src=\"https://user-images.githubusercontent.com/12446869/63366604-222dcf80-c348-11e9-80b7-a53a717a4b9f.png\">\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIn Workflow Viz, cannot replace a missing JT in WFJT. The scenario being: a Workflow JT contained a JT and that JT was deleted and a user wants to replace the missing JT.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.0.0 (may go back further than 5.0.0\r\n* Web Browser: Firefox and Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a WFJT with JT A\r\n2. Delete JT A\r\n3. Navigate back to WFJT and attempt to replace missing JT node\r\nNote: cannot replace missing JT node\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA user should be able to replace a missing JT node on the WFViz\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo option available to select a new node to replace missing JT\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nHAR File\r\n[Archive 19-08-20 10-54-02.har.zip](https://github.com/ansible/awx/files/3521245/Archive.19-08-20.10-54-02.har.zip)\r\n\r\n<img width=\"1496\" alt=\"Screen Shot 2019-08-20 at 10 50 21 AM\" src=\"https://user-images.githubusercontent.com/12446869/63358170-99f3fe00-c338-11e9-9650-fc99713970e6.png\">\r\n\r\n```\r\nTypeError: $scope.nodeConfig.node.originalNodeObject.summary_fields.unified_job_template is undefined\r\nStack trace:\r\nsetupNodeForm/<@https://ec2-52-91-194-47.compute-1.amazonaws.com/static/js/app.ce6c9b917f2711539ae9.js:29:1209569\r\nprocessQueue@https://ec2-52-91-194-47.compute-1.amazonaws.com/static/js/vendor.0ea93a32277ab6533bcc.js:575:134656\r\nscheduleProcessQueue/<@https://ec2-52-91-194-47.compute-1.amazonaws.com/static/js/vendor.0ea93a32277ab6533bcc.js:575:135605\r\n$digest@https://ec2-52-91-194-47.compute-1.amazonaws.com/static/js/vendor.0ea93a32277ab6533bcc.js:575:146521\r\n$apply@https://ec2-52-91-194-47.compute-1.amazonaws.com/static/js/vendor.0ea93a32277ab6533bcc.js:575:149463\r\ndone@https://ec2-52-91-194-47.compute-1.amazonaws.com/static/js/vendor.0ea93a32277ab6533bcc.js:575:101267\r\ncompleteRequest@https://ec2-52-91-194-47.compute-1.amazonaws.com/static/js/vendor.0ea93a32277ab6533bcc.js:575:106296\r\ncreateHttpBackend/</xhr.onload@https://ec2-52-91-194-47.compute-1.amazonaws.com/static/js/vendor.0ea93a32277ab6533bcc.js:575:107075\r\nPossibly unhandled rejection: {}\r\n```\r\n\r\n"},{"labels":["api",null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUnable to convert a notification to webhook type. Note: this may affect more than just webhooks\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.0.0 (regression from older versions of AWX)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a notification (i.e. grafana notification).\r\n2. Save\r\n3. Edit notification type to webhook.\r\n4. Save\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSave without error\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError on save\r\n\r\n##### ADDITIONAL INFORMATION\r\n![Screen Shot 2019-08-20 at 9 02 42 AM](https://user-images.githubusercontent.com/12446869/63349981-86419b00-c32a-11e9-9eca-6429000d3d11.png)\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n \r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nI have a custom inventory script written in Python. \r\nEverytime time I run it from the GUI it is run 4 times instead of once only. \r\nWhen I run the script using Python it runs once only.\r\nI wrote a script that highlight the behaviour.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.0.0.0\r\n* AWX docker on linux\r\n* Ansible version:  2.8.1\r\n* Operating System: CentOS Linux release 7.6.1810\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1/ Create an inventory script in Python with the following lines :\r\n**#!/usr/bin/env python\r\nimport time\r\ndef fonction():\r\n    f.write(\"Il passe par la\\n\")\r\n    return\r\ndef main():\r\n    '''Main program'''\r\n    print 'rhel5_64Guest:'\r\n    print '  hosts: [server1, server2, server3]'\r\n    print 'vcenter:'\r\n    print '  children: [rhel5_64Guest]'\r\n    f.write(\"Debut ecriture\\n\")\r\n    fonction()\r\nif __name__ == \"__main__\":\r\n    f = open(\"output.txt\", \"a\")\r\n    main()\r\n    f.close()\r\n    time.sleep(30)**\r\n\r\n2/ Run this inventory\r\n\r\n3/ You see in output.txt file the following lines\r\n**sh-4.2$ pwd\r\n/tmp/awx_472_iro8nt09\r\nsh-4.2$ tail -f output.txt\r\nDebut ecriture\r\nIl passe par la\r\nDebut ecriture\r\nIl passe par la\r\nDebut ecriture\r\nIl passe par la\r\nDebut ecriture\r\nIl passe par la**\r\n\r\n##### EXPECTED RESULTS\r\n\r\n##### ACTUAL RESULTS\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nNo data is being uploaded to the analytics service.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.5.\r\n* AWX install method: \r\n* Ansible version:  2.8.0\r\n* Operating System: RHEL8\r\n* Web Browser:  N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nssh to awx machine\r\nsudo su - awx\r\nawx-manage gather_analytics --ship\r\n\r\n`/tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-181335+0000.tar.gz\r\nshipping analytics file: /tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-181335+0000.tar.gz\r\nNo GPG-verified eggs can be found\r\n['insights-client', '--payload', '/tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-181335+0000.tar.gz', '--content-type', 'application/vnd.redhat.tower.analytics+tgz'] failure:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/analytics/core.py\", line 132, in ship\r\n    output = smart_str(subprocess.check_output(cmd, timeout=60 * 5))\r\n  File \"/usr/lib64/python3.6/subprocess.py\", line 356, in check_output\r\n    **kwargs).stdout\r\n  File \"/usr/lib64/python3.6/subprocess.py\", line 438, in run\r\n    output=stdout, stderr=stderr)\r\nsubprocess.CalledProcessError: Command '['insights-client', '--payload', '/tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-181335+0000.tar.gz', '--content-type', 'application/vnd.redhat.tower.analytics+tgz']' returned non-zero exit status 1.\r\n`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n[root@ip-10-0-5-39 ~]# awx-manage gather_analytics --ship\r\n/tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-182009+0000.tar.gz\r\nshipping analytics file: /tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-182009+0000.tar.gz\r\nUploading Insights data.\r\nSuccessfully uploaded report for ip-10-0-5-39.ec2.internal.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`/tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-181335+0000.tar.gz\r\nshipping analytics file: /tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-181335+0000.tar.gz\r\nNo GPG-verified eggs can be found\r\n['insights-client', '--payload', '/tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-181335+0000.tar.gz', '--content-type', 'application/vnd.redhat.tower.analytics+tgz'] failure:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/analytics/core.py\", line 132, in ship\r\n    output = smart_str(subprocess.check_output(cmd, timeout=60 * 5))\r\n  File \"/usr/lib64/python3.6/subprocess.py\", line 356, in check_output\r\n    **kwargs).stdout\r\n  File \"/usr/lib64/python3.6/subprocess.py\", line 438, in run\r\n    output=stdout, stderr=stderr)\r\nsubprocess.CalledProcessError: Command '['insights-client', '--payload', '/tmp/844d6710-0867-4b6e-8495-7ce9f559627a_2019-08-19-181335+0000.tar.gz', '--content-type', 'application/vnd.redhat.tower.analytics+tgz']' returned non-zero exit status 1.\r\n`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nmso_schema_site_anp_epg_staticport - Dont have choice for path type of the static port as VPC\r\n\r\n##### ENVIRONMENT\r\n* Ansible version:  2.8.2\r\n* Operating System: RHEL 7\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThe current module dont have option to configure the EPG static port type as VPC. It has only one option as port, but cisco ACI has three options port, VPC and Direct Port channel.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe static port type should have choice as VPC\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe static port type has only port as option.\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIn certain cases, when no public IP is used on the VM (either the GCE project is using Google Cloud NAT or there is a VPN tunnel to the project and there is no need of public IPs) AWX is not getting the private IP of the instances as \"ansible_ssh_host\" and is unable to connect even if there is actual connection between the AWX node and the instance.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.x.x\r\n* AWX install method: docker\r\n* Ansible version:  2.8.1\r\n* Operating System: Ubuntu 18.04.2 LTS\r\n* Web Browser: Google Chorme / Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate an inventory with google compute project as a source. Create a VM without public IP address and then sync the inventory. After the sync check the host definition in the inventory for the created VM - there is no \"ansible_ssh_host\" variable get from Google in the host variables, so AWX/Ansible will not be able to connect as usually when there is no such variable, ansible is trying to resolve the hostname which will not be possible. And so connection is not possible.\r\n\r\n##### EXPECTED RESULTS\r\nWhen there is no Public IP address assigned to the instance, AWX to take the Private IP to be used as \"ansible_ssh_host\" as variable.\r\n\r\n##### ACTUAL RESULTS\r\nWhen there is no public IP address, there is no connectivity to the GCE instance.\r\n\r\n##### ADDITIONAL INFORMATION\r\nAfter some testing and debugging I found, that the problem is on line https://github.com/ansible/awx/blob/e08e70efb48779b31f300737b085b3f3053f3520/awx/main/models/inventory.py#L2367\r\nNow it is hardcoded to default only to the public IP address.\r\nI suggest changing the line to:\r\n`'ansible_ssh_host': 'networkInterfaces[0].accessConfigs[0].natIP | default(networkInterfaces[0].networkIP)'`\r\nThis way it will take the public IP if there is such assigned to the instance. If there's no public IP it will default to the private one, which is ALWAYS present.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen utilizing the UI, one can head to Settings/UI and upload an image file. This \"replaces\" the Image file on the login screen. One can also view this image in a \"data:url\" format at api/v2/settings/ui CUSTOM_LOGO: \"data:image/png;base64,Base64EncodedStringhere=\"\r\n\r\nAttempting the same via the API or tower-cli (example below) produces no \"error\" and updates the CUSTOM_LOGO attribute properly when viewed in the API, but doesn't actually \"take effect\" in that the logo is not actually changed at login.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: openshift\r\n* Ansible version:  Whatever comes built-in with 6.1.0's ansible virtualenv\r\n* Operating System: Openshift 3.11 running on RHEL 7.6\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nReproduce using the tower-cli:\r\n\r\n```\r\nwith open(\"/path/to/a/png/file.png, 'rb') as logofile:\r\n          logo_64_encode = base64.b64encode(logofile.read()).decode()\r\n          created_data_url = 'data:image/png;base64,{}'.format(logo_64_encode)\r\n\r\n# Placeholder: Setup AWX auth - however you do it since there's 10,000 ways\r\n\r\n# Set a bunch of other settings as examples - these all WORK FINE\r\n# Assuming you have some valid data in login_message and custom_venv_paths variables\r\nsettings_resource.modify('CUSTOM_LOGIN_INFO', login_message)\r\nsettings_resource.modify('CUSTOM_VENV_PATHS', json.dumps(custom_venv_paths))\r\n\r\n# Setup AWX Custom Logo using above data:url - this shows a successful return and updates CUSTOM_LOGO - but never displays\r\nsettings_resource.modify('CUSTOM_LOGO', created_data_url)\r\n\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nif the tower-cli call succeeded (no errors) an i can see the encoded data:url in CUSTOM_LOGO - i would expect a Custom Image to be displayed at the login prompt.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo image is displayed. Uploading the same image via the UI's \"browse\" option causes it to display immediately, same apparent data:url object written to CUSTOM_LOGO\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nN/A\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWould like to be able to create a new user account in AWX, without requiring a password. The goal here is to be able to create/pre-provision a user that is managed by an external service (LDAP), then when they log in for the first time, AWX will see they already have an account created, and simply authenticate them with LDAP and update their account details from LDAP."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n1. create an inventory source\r\n2. hook it up to an AWS account that will return ~2400 or so instances\r\n3. delete the source\r\n\r\nThis causes AWX to send three DELETE requests - to N/hosts, N/groups, and N:\r\n```\r\n/api/v2/inventory_sources/N/hosts:\r\nX-API-Time | 43.693s\r\nX-API-Total-Time | 57.284s\r\n```\r\n```\r\n/api/v2/inventory_sources/N/groups:\r\n504, killed due to request/response timeout, I assume:\r\nWed Aug 14 18:23:36 2019 - *** HARAKIRI ON WORKER 2 (pid: 741, try: 1) ***\r\nWed Aug 14 18:23:36 2019 - HARAKIRI !!! worker 2 status !!!\r\nWed Aug 14 18:23:36 2019 - HARAKIRI [core 0] 192.168.124.1 - DELETE /api/v2/inventory_sources/33/groups/ since 1565806895\r\nWed Aug 14 18:23:36 2019 - HARAKIRI !!! end of worker 2 status !!!\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current and prior\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nOn creating a Workflow template like below, we can able to pass the variable value from JT to WT: \r\n\r\nJob Template(passes the value of var1) >>On Success>> Nested Workflow(can use the value of var1)\r\n\r\nBut currently we cannot pass the variable value from WT to JT: \r\n\r\nNested Workflow(passes the value of var1) >>On Success>> Job Template(can use the value of var1)\r\n\r\nThe purpose of this RFE is to pass variable value from a nested WT to JT/WT.\r\n\r\n![wf](https://user-images.githubusercontent.com/53525271/63020258-435f6d80-bebb-11e9-95c2-34cffd1a56dd.png)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen setting an encrypted fact via Set_facts, a call back error is thrown.\r\nThis behaviour is not present on AWX 2.1.2.0 (We just upgraded)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: docker\r\n* Ansible version:  2.8.3\r\n* Operating System: Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n```---\r\n- hosts: localhost\r\n  gather_facts: yes\r\n  tasks:\r\n  - set_fact:\r\n      password: !vault |\r\n          $ANSIBLE_VAULT;1.1;AES256\r\n          38343532363661666437303861616639373964643366626266613233663631656430303136366366\r\n          3037663963356531623037663362353639316437333330380a633839343233396266353863343263\r\n          65373638613332626534373166373864623639363364306435346662656438346332313763323165\r\n          6464353231386336330a363837393937656635326536646434313864393162383831393336386235\r\n          3535\r\n  \r\n  - debug: msg=\"My password value is {{ password }}\"\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFor a callback error not to be thrown\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```PLAY [localhost] ***************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\n\r\nTASK [set_fact] ****************************************************************\r\n [WARNING]: Failure using method (v2_runner_on_ok) in callback plugin\r\n(<ansible.plugins.callback.awx_display.CallbackModule object at\r\n0x7fe7177839d0>): u'123456789' is not JSON serializable\r\n\r\nTASK [debug] *******************************************************************\r\nok: [localhost] => {\r\n    \"msg\": \"My password value is 123456789\"\r\n}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe string is decrypted correctly and the play will finish successfully\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAdd a new `.json` file to keep track of the version of each file in the collection tarball.  \r\n\r\n\r\n`manifest.json`\r\n```\r\n{\r\nconfig.json: 1.0\r\ncounts.json: 1.0\r\nquery_info.json: 1.0\r\ncred_type_counts.json: 1.0\r\ninventory_counts.json:1.0\r\njob_counts.json: 1.0\r\njobs.json: 2.0\r\norg_counts.json: 3.0\r\nprojects_by_scm_type.json:1.0 }\r\n```\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nIn the collection tarball, modify the unified_job table copy to include org name & id for jobs. This can be used by Automation Insights to produce visual representations of how many jobs are being run per org organized by type & status.  \r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\nGCE Dynamic Inventory should be able to use machineaccount to authenticate.\r\n\r\n\r\n##### SUMMARY\r\nGCE Dynamic Inventory should be able to use machineaccount to authenticate.\r\nRight now only serviceaccount can be used.\r\nhttps://github.com/ansible/awx/blob/6.1.0/awx/main/models/credential/injectors.py"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nSame Issue as #3214, only this time please handle groups also\r\n\r\nAWX is crunching through all groups with 10,000 queries for us. Before the job even starts for real. For 60 seconds.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI am creating a very simple 4 node workflow.  One of the Job Templates is auto-populated\r\n```\r\n    - name: CREATE RESTORE JOB TEMPLATE\r\n      tower_job_template:\r\n        name: \"Network-Restore\"\r\n        job_type: \"run\"\r\n        inventory: \"Workshop Inventory\"\r\n        project: \"Workshop Project\"\r\n        playbook: \"network_restore.yml\"\r\n        credential: \"Workshop Credential\"\r\n        survey_enabled: true\r\n        survey_spec: \"{{ lookup('template', '{{playbook_dir}}/templates/backup.j2') }}\"\r\n        tower_username: admin\r\n        tower_password: ansible\r\n        tower_host: \"https://{{ansible_fqdn}}\"\r\n        validate_certs: no\r\n```\r\n\r\nhere is the backup.j2 template referenced above for the survey_spec->\r\nhttps://github.com/network-automation/tower_workshop/blob/master/templates/backup.j2\r\n\r\n##### ENVIRONMENT\r\nTower 3.5.1\r\n\r\n##### STEPS TO REPRODUCE\r\nI am doing this exact exercise here: https://github.com/ansible/workshops/tree/devel/exercises/ansible_network/9-tower-workflow\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWould force me to choose a prompt during the selection process for the **Network-Restore** Job Template\r\n\r\n##### ACTUAL RESULTS\r\n![error message with no details](https://github.com/IPvSean/pictures_for_github/blob/master/error.png?raw=true)\r\n\r\n![undefined error](https://github.com/IPvSean/pictures_for_github/blob/master/undefined.png?raw=true)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nmore info coming"},{"labels":["api",null,null,null,null],"text":"The Hipchat service is no longer active and should be removed:\r\nhttps://www.atlassian.com/partnerships/slack/faq#faq-3ccc5a61-711b-4ef2-9ca2-3a34b2ec143b\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea (Bug?)\r\n\r\n![image](https://user-images.githubusercontent.com/4440360/62663228-8d7ca800-b92b-11e9-8eeb-accce0ec7eee.png)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\ninsights.py default url: /api/remediations/v1/remediations. this not expected.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.8.2\r\n* Operating System: Redhat\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nInstall awx 6.1.0 and ansible version 2.8.2\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected: url = '{}/r/insights/v3/maintenance?ansible=true'.format(insights_url)\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\"msg\": \"Expected /api/remediations/v1/remediations to return a status code of 200 but returned status code \\\"404\\\" instead with content \\\"<!doctype html>\\n<html>\\n<head>\\n    <title>Example Domain</title>\\n\\n    <meta charset=\\\"utf-8\\\" />\\n    <meta http-equiv=\\\"Content-type\\\" content=\\\"text/html; charset=utf-8\\\" />\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1\\\" />\\n    <style type=\\\"text/css\\\">\\n    body {\\n        background-color: #f0f0f2;\\n        margin: 0;\\n        padding: 0;\\n        font-family: \\\"Open Sans\\\", \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif;\\n        \\n    }\\n    div {\\n        width: 600px;\\n        margin: 5em auto;\\n        padding: 50px;\\n        background-color: #fff;\\n        border-radius: 1em;\\n    }\\n    a:link, a:visited {\\n        color: #38488f;\\n        text-decoration: none;\\n    }\\n    @media (max-width: 700px) {\\n        body {\\n            background-color: #fff;\\n        }\\n        div {\\n            width: auto;\\n            margin: 0 auto;\\n            border-radius: 0;\\n            padding: 1em;\\n        }\\n    }\\n    </style>    \\n</head>\\n\\n<body>\\n<div>\\n    <h1>Example Domain</h1>\\n    <p>This domain is established to be used for illustrative examples in documents. You may use this\\n    domain in examples without prior coordination or asking for permission.</p>\\n    <p><a href=\\\"http://www.iana.org/domains/example\\\">More information...</a></p>\\n</div>\\n</body>\\n</html>\\n\\\".\",\r\n    \"changed\": false\r\n}\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\ninsights.py has to update to correct insight url = '{}/r/insights/v3/maintenance?ansible=true'.format(insights_url), or provide option to use custom url.\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI want to send an email from AWX with some variables from the workflow_job I have just executed.\r\n\r\nIn the documentation of Ansible Tower, they said : (16.7 Launch a Job Template)\r\n\"Along with any extra variables set in the job template and survey, Tower automatically adds the following variables to the job environment\"\r\nAfter that, there is a list of variable like \"tower_workflow_job_id\" for example. (I have succeeded to use tower_workflow_id because it is automatically added by Tower)\r\n\r\nI want to retrieve workflow_job information about started and finished.\r\nIt seems they are not available automatically like tower_workflow_id. Is there a way to access thoses variables ? or to add it from Tower configuration ?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.1\r\n* Operating System: Ubuntu 16.04.6 LTS\r\n* Web Browser: Chrome - Version 75.0.3770.142 (Build officiel) (64 bits)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nI execute a workflow job and at the end the last job is to send an email (Jinja2 Template) from AWX with some variables :\r\n- tower_workflow_job_id or tower_workflow_job_name (working)\r\nBut I want to add the information that is present in the started and finished variables I see in the browser api : awx/api/v2/workflow_jobs/[JOB ID]/\r\n\r\n    \"started\": \"2019-08-06T12:18:30.191202Z\",\r\n    \"finished\": \"2019-08-06T12:18:59.440905Z\",\r\n\r\nI write the line in the jinja2 file like that but it is not working. \r\nTime : {{ tower_workflow_job_started }}\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nI expect to see the value of these variables. I also want to see it in a more readable format like the time in UTC+2 like that :\r\n\r\nStart time   ==> 14:18:30 2019-08-06\r\nFinish time ==> 14:18:59 2019-08-06\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\"msg\": \"The task includes an option with an undefined variable. The error was: 'tower_workflow_job_started' is undefined\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAWS credentials could support a role ARN and call STS Assume Role service to obtain temporary credentials.\r\nI know the STS Token allow me to do this from outside AWX, but this could be a feature.\r\n\r\nhttps://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently, utilization of capacity is taken as the lesser of the number of the hosts in the inventory, or the number of configured forks for the job template.  So if there are 5 hosts in an inventory and a template has 10 forks set, it will utilize 5+1 for the parent process, or in this case, a capacity of 6.\r\n\r\nThis calculation does not take limits into account.  So if a template has a limit set to allow it to act against 1 host, in the above scenario it will still utilize 6 units of capacity, instead of the correct limit of 2.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAllow hosts to be removed from an inventory when current jobs are being run against that inventory in the case where all jobs running have limits set and the host being removed is not in any of those limits.  \r\n\r\nCurrently if an inventory has 100 hosts, and a job is run against a single host, all 100 are locked out from being removed.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nSCM update has been marked as failed with the error `inventory_update failed for <INVENTORY NAME> - <INVENTORY SOURCE NAME> with ID <INVENTORY SYNC JOBID>` even if there is no error in the SCM update job.\r\n\r\nThis will happen when the `Inventory Update X` is launched and running and `Inventory Update Y` is failed while `Inventory Update X` is still running. This situation will occur when there is slow inventory source (vCenter with massive host entries for example).\r\n\r\nAlso, even if the project update is succeeded when I launch the Job Template, the job will be marked as failed after a project update for another Job Template has been failed. It should be marked as success since the project update for Job Template is succeeded.\r\n\r\nHere is the video for reproducing the issue:\r\n![tower](https://user-images.githubusercontent.com/4246532/62445287-d9e4ae00-b79a-11e9-85e5-19052564178e.gif)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n1. Create 2 Job Template as follows:\r\n```\r\nDemo Project\r\n        ┣ Test Job Template X\r\n        ┗ Test Job Template Y\r\n```\r\n\r\nTest Job Template X:\r\n![Screenshot from 2019-08-05 13-49-04](https://user-images.githubusercontent.com/4246532/62439763-0cd17680-b788-11e9-9830-ad2aab8174c1.png)\r\n\r\nTest Job Template Y:\r\n![Screenshot from 2019-08-05 13-49-12](https://user-images.githubusercontent.com/4246532/62439775-18bd3880-b788-11e9-9bfd-41226a466ffd.png)\r\n\r\n2. Create Inventories for Job Template X and Y with Custom Inventory Scripts to reproduce the issue.\r\n\r\nFor Test Job Template X:\r\n```\r\nTest Inventory X\r\n        ┗ Test Custom Inventory Source X\r\n                ┗ Test Custom Inventory X\r\n```\r\nHere is the Test Custom Inventory X to sleep 60sec then add hosts and groups:\r\n```\r\n#!/usr/bin/env python\r\n\r\nimport json\r\nimport sys\r\nimport time\r\n\r\n\r\nSLEEP = 60\r\n\r\ninv = {}\r\nargv = sys.argv\r\nopts = [o for o in argv if o.startswith('--')]\r\n\r\nif '--host' in opts:\r\n    pass\r\nelse:\r\n    inv = dict(_meta=dict(hostvars=dict()), all=dict(children=list()))\r\n    # dummy data\r\n    inv[\"groupA\"] = { \"hosts\": [\"test01\"], \"vars\": {} }\r\n    inv[\"groupB\"] = { \"hosts\": [\"test11\"], \"vars\": {} }\r\n    inv[\"_meta\"][\"hostvars\"] = { \"test01\": { \"ansible_connection\": \"local\" }, \"test11\": { \"ansible_connection\": \"local\" }}\r\n\r\ntime.sleep(SLEEP)\r\nprint(json.dumps(inv))\r\n\r\n#\r\n# [EOF]\r\n#\r\n```\r\n\r\nFor Test Job Template Y:\r\n```\r\nTest Inventory Y\r\n        ┗ Test Custom Inventory Source Y\r\n                ┗ Test Custom Inventory Y\r\n```\r\n\r\nHere is the Test Custom Inventory Y to sleep 30sec then failed on purpose:\r\n```\r\n#!/usr/bin/env python\r\n\r\nimport json\r\nimport sys\r\nimport time\r\n\r\n\r\nSLEEP = 30\r\n\r\ninv = {}\r\nargv = sys.argv\r\nopts = [o for o in argv if o.startswith('--')]\r\n\r\nif '--host' in opts:\r\n    pass\r\nelse:\r\n    inv = dict(_meta=dict(hostvars=dict()), all=dict(children=list()))\r\n    # dummy data\r\n    inv[\"groupA\"] = { \"hosts\": [\"test00\"], \"vars\": {} }\r\n    inv[\"groupB\"] = { \"hosts\": [\"test10\"], \"vars\": {} }\r\n    inv[\"_meta\"][\"hostvars\"] = { \"test00\": { \"ansible_connection\": \"local\" }, \"test10\": { \"ansible_connection\": \"local\" }}\r\n\r\ntime.sleep(SLEEP)\r\nraise ValueError(\"Testing for CustomInventoryScriptN\")\r\nprint(json.dumps(inv))\r\n\r\n#\r\n# [EOF]\r\n#\r\n```\r\n\r\n3. Launch `Job Template X` first then launch `Job Template Y` about 30 sec later.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nFor Job Template X, SCM Update, Inventory Update and Job Template are marked as success.\r\nFor Job Template Y, Inventory Update fails due to error but SCM update succeeded.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\nFor Job Template X, SCM Update and Inventory Update are marked as success but Job Template has been failed with `The project revision for this job template is unknown due to a failed update.` \r\n\r\nWhen I launch the `Job Template X`, I can see the project update is success. But after the `Inventory Update Y` has been failed, `Job Template X` and all of following Job Templates are failed with the following error:\r\n![Screenshot from 2019-08-05 14-45-56](https://user-images.githubusercontent.com/4246532/62441614-d4359b00-b78f-11e9-8149-c9c93f72ca07.png)\r\n\r\nPlease refer the video I posted on the SUMMARY section too. \r\n\r\nFor Job Template Y, Both of Inventory Update and SCM update fail.\r\n\r\nSCM Update has been finished without error but marked as failed with the following message:\r\n```\r\ninventory_update failed for Test Inventory Y - Test Custom Inventory Source Y with ID 35\r\n```\r\n![Screenshot from 2019-08-05 14-21-37](https://user-images.githubusercontent.com/4246532/62440767-7ce1fb80-b78c-11e9-982d-b2a154b5a058.png)\r\n\r\nI cannot see any issues in the process of SCM update.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nCurrently, if you attempt to modify an existing LDAP created resource (org/team), it will leave the existing resource and create a new one with the modified specs. We have a request to prevent all users from being able to manage these via the UI. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Enhancement\r\n\r\n##### SUMMARY\r\nTo address a concern from user(s) on the mailing list - we want to explicitly mention the Central Credential Provider service in the name of the lookup plugin and in its documentation to make it more clear that you need the central provider service component installed to your aim server in order to store secrets in it (and therefore use our secret lookup plugin with it)\r\n\r\n- Docs will call this out by referring to it as \"**5.1.1. CyberArk AIM Central Credential Provider Lookup**\"  in the docs. \r\n\r\n- will also also update the code so that the the credential type is called \"CyberArk AIM Central Credential Provider Lookup\" instead of \"CyberArk AIM Secret Lookup\". This would require a new screenshot, but would help cover the bases by making sure we mention both \"AIM\" and \"Central Credential Provider\" when referring to the integration.  \r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n`is_system_auditor` flag on ldap isnt working properly. When the ldap user logs in for the first time in AWX it doesnt assign the user as system auditor, it only creates it as a normal user. But if you re-login with the same ldap user, it assigns it as `system_auditor`.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1.) Have a `is_system_auditor` flag set on ldap configuration\r\n2.) Login with the user which is not there on AWX and with a matching query for `is_system_auditor`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nUser should get created as `system_auditor`\r\n\r\n##### ACTUAL RESULTS\r\n\r\nUser doesnt gets created as `system_auditor`. You have to re-login and then user gets assigned as system auditor. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNote: This looks like a regression related to a recent change in `django-auth-ldap`: https://github.com/django-auth-ldap/django-auth-ldap/commit/b777321fb486620f261e2ebbe28e508ca5a826eb"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* Ansible\r\n\r\n##### SUMMARY\r\nThe Job model's `notification_data` method omits the new ansible host summary fields added [here](https://github.com/ansible/ansible/pull/48418).\r\nhttps://github.com/ansible/awx/blob/c7bb0f10e10476e10df8a7e7b26732eb60958ca1/awx/main/models/jobs.py#L655-L661\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a job template\r\n1. Create an email notification template\r\n1. Configure the JT to trigger the e-mail notification on job success\r\n1. Run the job\r\n1. Once the job completes, look at the body of the e-mail notification that was sent\r\n\r\nThese steps can be accomplished with `akit` using the following commands:\r\n```python\r\njt = v2.job_templates.create(); host = jt.ds.inventory.add_host()\r\nnt = v2.notification_templates.create(notification_type='email')\r\njt.add_notification_template(nt, 'notification_templates_success')\r\njob = jt.launch().wait_until_completed()\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe e-mail notification will include a JSON dictionary with a number of fields describing the job run. The `hosts` section will list results for each host involved in the playbook run. Each host's results should include the `rescued` and `ignored` fields.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`rescued` and `ignored` fields are missing:\r\n\r\n![Screenshot 2019-08-19 12 35 57](https://user-images.githubusercontent.com/4440360/63293909-ef1f0980-c27d-11e9-9924-e0c1ad24822b.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe new host summary fields (rescued, ignored) were [added in Ansible 2.8](https://github.com/ansible/ansible/issues/31245) and adopted by awx [here](https://github.com/ansible/awx/issues/466) (and included in Tower 3.5)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n1.  Install a cluster with one or more isolated nodes.\r\n2.  Configure the periodic isolated cleanup so it happens more frequently:\r\n\r\n```python\r\nAWX_ISOLATED_PERIODIC_CHECK = 30\r\n```\r\n\r\n3.  Run _this_ script on the isolated node (as the `awx` user):\r\n\r\n```python\r\nimport os\r\nimport time\r\n\r\npath = '/tmp/awx_123456789_abc'\r\nos.mkdir(path)\r\nyesterday = time.time() - 86400\r\nos.utime(path, (yesterday, yesterday))\r\n```\r\n\r\n4.  The periodic capacity check for isolated nodes will fail with this traceback:\r\n\r\n![image](https://user-images.githubusercontent.com/214912/61903105-b9db0200-aef1-11e9-9408-5c2ab06e5027.png)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nIs it possible to have a standard method of calculation for slices in clustered environments?\r\n\r\nUsers may overbook Tower resources if they don't have the appropriate processing power or they're running intensive playbook operations and set a high slice count.\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAdd \"pending_jobs\" metric so you can spot if AWX is not processing jobs\r\n\r\nThere are metrics to show running jobs but nothing for pending jobs.\r\nWe sometimes see issues with our AWX instances which are usually spotted by a high number of pending jobs in the queue.\r\nIt would be good to add pending jobs as a metric so issues can be spotted earlier than reported."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWrong information sending to logstash.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0\r\n* AWX install method: rpm from https://copr-be.cloud.fedoraproject.org/results/mrmeee/ansible-awx/epel-7-x86_64/\r\n* Ansible version:  2.8.2\r\n* Operating System: rhel 7.6\r\n* Web Browser:\r\nELK: 7.2\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Connect awx to logstash.\r\n2. Perform any role which changes a file (task type is the template) and after runs a handler.\r\nI run the below playbook:\r\n\r\n- name: Configure the /etc/chrony.conf\r\n  template:\r\n    src: chrony.conf.j2\r\n    dest: /etc/chrony.conf\r\n    owner: root\r\n    group: root\r\n    mode: '0600'\r\n  notify:\r\n    - chrony restart\r\n\r\n\r\n##### EXPECTED RESULTS\r\nIn awx and logstash should be information about change of file ( changed: true)\r\n\r\n##### ACTUAL RESULTS\r\nIn awx information about change is CORRECT (changed: true)\r\nIn logstash information about change is WRONG (changed: false).\r\n\r\n##### ADDITIONAL INFORMATION\r\nI connected the awx to the logstash.\r\n\r\nFor instance, I deploy the /etc/chrony.conf file . In the jobs in the awx I see that there are two changes: replacing config file and performing chrony restart:\r\n![image](https://user-images.githubusercontent.com/53143930/61591289-453c5680-abc5-11e9-9d43-e02b219e874e.png)\r\n\r\nUnfortunately, awx send wrong informations to logstash, because in the row which indicates on changing the file configuration is set changed: false.\r\n\r\n![image](https://user-images.githubusercontent.com/53143930/61591309-b714a000-abc5-11e9-9604-3973693df2d7.png)\r\n\r\nI set default configuration of logstash and awx.\r\nIn version 5.x of awx is the same behaviour.\r\n\r\nBelow is the logstash configuration:\r\ninput {\r\n    http {\r\n        host => '0.0.0.0'\r\n        port => 20000\r\n        tags => 'awx'\r\n    }\r\n}\r\n\r\n\r\nfilter {\r\n    json {\r\n        source => \"message\"\r\n    }\r\n}\r\n\r\n\r\noutput {\r\n    elasticsearch {\r\n        hosts => [ 'localhost:9200' ]\r\n    }\r\n}"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nAdd a new `query_info.json` file to the tar that includes the timestamp of collection as well as any other relevant collection metadata.  \r\n\r\nPass a flag with the awx-manage command if manually run and include that in the `query_info.json`.  It may be useful to know if this is a scheduled collection or not.  \r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWith ansible 2.7 and before, AWX uses the vendored inventory script for azure.\r\nThis script includes null value keys, such as `public_ip` if there is no public ip on the host.\r\n\r\nThe ansible inventory plugin, which is used when ansible 2.8+ is installed in the ansible venv, however, drops these keys if there is a `null` value.\r\n\r\nBy ensuring that the same hostvars are always present (even if they have null value), we help to not break people's playbooks.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* Ansible version:  2.8+\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nRun azure inventory update against azure tenant that has a host with no public ip or other null value variables.\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\n`public_ip: null` in hostvars for host with no public ip\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\n`pubic_ip` not present in host vars for host with no public ip\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nWould like this solution to be general enough to work with any expected hostvar.\r\nRelated: https://github.com/ansible/awx/issues/4180"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nSetting ```pg_sslmode=require``` in ```installer/inventory``` triggers the task ```Update CA trust in awx_web container```, although it shouldn't.\r\nAs pointed out by the ```Table 32.1. SSL Mode Descriptions``` in the [official postgresql documentation](https://www.postgresql.org/docs/9.6/libpq-ssl.html), ```sslmode=require``` does not check the server certificate, unlike ```sslmode=verify-ca``` and ```sslmode=verify-full```.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.1.0 \r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.2\r\n* Operating System: Ubuntu eoan/Debian bullseye\r\n\r\n##### STEPS TO REPRODUCE\r\n- git checkout 6.1.0\r\n- sed -i 's|^.*pg_sslmode=.*$|pg_sslmode=require|g' installer/inventory\r\n- export awx_version=\"6.1.0\"\r\n- cd installer\r\n- ansible-playbook -i inventory install.yml\r\n\r\n##### EXPECTED RESULTS\r\nNo run of task ```Update CA trust in awx_web container```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n ____________________________________________________________\r\n< TASK [local_docker : Update CA trust in awx_web container] >\r\n ------------------------------------------------------------\r\n        \\   ^__^\r\n         \\  (oo)\\_______\r\n            (__)\\       )\\/\\\r\n                ||----w |\r\n                ||     ||\r\n\r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": [\"docker\", \"exec\", \"awx_web\", \"/usr/bin/update-ca-trust\"], \"delta\": \"0:00:06.094761\", \"end\": \"2019-07-18 23:01:19.550778\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2019-07-18 23:01:13.456017\", \"stderr\": \"Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?\", \"stderr_lines\": [\"Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n```\r\nDocker is running:\r\n```\r\n# systemctl status docker\r\n● docker.service - Docker Application Container Engine\r\n   Loaded: loaded (/lib/systemd/system/docker.service; enabled; vendor preset: enabled)\r\n   Active: active (running) since Fri 2019-07-19 11:01:20 CEST; 24min ago\r\n     Docs: https://docs.docker.com\r\n Main PID: 17241 (dockerd)\r\n    Tasks: 32\r\n   Memory: 65.0M\r\n   CGroup: /system.slice/docker.service\r\n           ├─17241 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock\r\n           └─17536 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 80 -container-ip 172.22.0.3 -container-port 8052\r\n\r\nJul 19 11:25:38 samsung5-ubuntu dockerd[17241]: time=\"2019-07-19T11:25:38.397926101+02:00\" level=debug msg=\"Name To resolve: rabbitmq.\"\r\nJul 19 11:25:38 samsung5-ubuntu dockerd[17241]: time=\"2019-07-19T11:25:38.397969780+02:00\" level=debug msg=\"[resolver] lookup for rabbitmq.: IP [172.22.0.2]\"\r\nJul 19 11:25:38 samsung5-ubuntu 099f23f6f455[17241]: 2019-07-19 09:25:38.398 [info] <0.2514.0> accepting AMQP connection <0.2514.0> (172.22.0.5:38880 -> 172.22.0.2:5672)\r\nJul 19 11:25:38 samsung5-ubuntu 099f23f6f455[17241]: 2019-07-19 09:25:38.400 [info] <0.2514.0> connection <0.2514.0> (172.22.0.5:38880 -> 172.22.0.2:5672): user 'guest' auth\r\nJul 19 11:25:38 samsung5-ubuntu 099f23f6f455[17241]: 2019-07-19 09:25:38.403 [info] <0.2514.0> closing AMQP connection <0.2514.0> (172.22.0.5:38880 -> 172.22.0.2:5672, vhost\r\nJul 19 11:25:38 samsung5-ubuntu c6f1205d2d63[17241]: 2019-07-19 09:25:38,403 DEBUG    awx.main.dispatch delivered fb949009-33f8-43ae-9c0b-9222da4c75f4 to worker[193] qsize 0\r\nJul 19 11:25:38 samsung5-ubuntu c6f1205d2d63[17241]: 2019-07-19 09:25:38,405 DEBUG    awx.main.dispatch task fb949009-33f8-43ae-9c0b-9222da4c75f4 starting awx.main.scheduler\r\nJul 19 11:25:38 samsung5-ubuntu c6f1205d2d63[17241]: 2019-07-19 09:25:38,407 DEBUG    awx.main.scheduler Running Tower task manager.\r\nJul 19 11:25:38 samsung5-ubuntu c6f1205d2d63[17241]: 2019-07-19 09:25:38,419 DEBUG    awx.main.scheduler Starting Scheduler\r\nJul 19 11:25:38 samsung5-ubuntu c6f1205d2d63[17241]: 2019-07-19 09:25:38,443 DEBUG    awx.main.dispatch task fb949009-33f8-43ae-9c0b-9222da4c75f4 is finished\r\n```\r\nThe issue most probably comes from the fact that ```ca_trust_dir``` has not been set in ```installer/inventory```, because it is not needed."},{"labels":["api"],"text":"**ISSUE TYPE**\r\nBug Report\r\n**COMPONENT NAME**\r\nAPI\r\n**SUMMARY**\r\nlaunch a  job with extra_vars but in ignored_fields, how do I launch a job with extra_vars I need?\r\n\r\n```\r\nPOST http://.../api/v2/job_templates/666/launch/\r\nData: {\"extra_vars\": \"{\\\"hello\\\":\\ \"hello world\\\"}\"}\r\n```\r\nResponse:\r\n```\r\n{\r\n...\r\n  \"ignored_fields\":{\r\n       \"hello\": \"hello world\"\r\n   }\r\n...  \r\n  \"extra_vars\": \"{}\"\r\n}\r\n```\r\nENVIRONMENT\r\nAWX version: 4.0.0.0\r\nAnsible version: 2.7.9\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI just make a fresh install of awx on rhel 7.6.\r\nI create credential to connect to my gitlab server\r\nI create a project to sync playbook from gitlab\r\njob failed with the following error\r\nfatal: Authentication failed for 'http://$encrypted$:$encrypted$@gitlab/ansible/galera-cluster.git\r\n\r\ncredentials are ok\r\nsync is ok on my awx 3.0.0 server; same credentials, same settings, same network\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.1\r\n* Operating System: RHEL 7.6\r\n* Web Browser: firefox 68\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\ncreate credentials to connect to gitlab server.\r\ncreate projects and run it\r\n\r\n##### EXPECTED RESULTS\r\n\r\njob succed\r\n\r\n##### ACTUAL RESULTS\r\n\r\nauthentication failed despite credentials are ok\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nbefore make a fresh install to reproduce the issue, I try to upgrade my awx server (3.0.0).\r\nsame result"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI have some scheduled jobs and workflows in the AWX instance, but over time they are stuck in pending. \r\n\r\nThe Workflow is running and at the last task before finishing and the logs provide this message:\r\n```\r\n2019-07-16 09:07:01,449 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(3058a95c-8670-4588-8440-8ff64ead7d48, queue=awx_private_queue)\r\n[2019-07-16 09:07:01,449: DEBUG/Process-1] publish awx.main.scheduler.tasks.run_task_manager(3058a95c-8670-4588-8440-8ff64ead7d48, queue=awx_private_queue)\r\n2019-07-16 09:07:01,465 DEBUG    awx.main.dispatch delivered 3058a95c-8670-4588-8440-8ff64ead7d48 to worker[12297] qsize 0\r\n2019-07-16 09:07:01,469 DEBUG    awx.main.dispatch task 3058a95c-8670-4588-8440-8ff64ead7d48 starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-07-16 09:07:01,472 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-07-16 09:07:01,483 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-07-16 09:07:01,534 DEBUG    awx.main.scheduler No nodes to spawn for workflow_job 3592 (running)\r\n2019-07-16 09:07:01,545 DEBUG    awx.main.dispatch task 3058a95c-8670-4588-8440-8ff64ead7d48 is finished)\r\n```\r\n\r\nAll other Jobs are running fine, except for this one workflow.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 5.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.1\r\n* Operating System: Rhel 7.6\r\n* Web Browser: Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nNot reproduceable, over time the workflow will eventually stuck.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n1. log in as a user\r\n2. remove the user via the API\r\n3. reload\r\n\r\n```\r\nawx_1        | 2019-07-16 21:07:30,594 ERROR    django.request Internal Server Error: /\r\nawx_1        | Traceback (most recent call last):\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\nawx_1        |     return self.connection.commit()\r\nawx_1        | psycopg2.IntegrityError: insert or update on table \"main_usersessionmembership\" violates foreign key constraint \"main_usersessionmembership_user_id_fe163c98_fk_auth_user_id\"\r\nawx_1        | DETAIL:  Key (user_id)=(2) is not present in table \"auth_user\".\r\nawx_1        | \r\nawx_1        | \r\nawx_1        | The above exception was the direct cause of the following exception:\r\nawx_1        | \r\nawx_1        | Traceback (most recent call last):\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 34, in inner\r\nawx_1        |     response = get_response(request)\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/utils/deprecation.py\", line 96, in __call__\r\nawx_1        |     response = self.process_response(request, response)\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/contrib/sessions/middleware.py\", line 58, in process_response\r\nawx_1        |     request.session.save()\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/contrib/sessions/backends/db.py\", line 87, in save\r\nawx_1        |     obj.save(force_insert=must_create, force_update=not must_create, using=using)\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/transaction.py\", line 240, in __exit__\r\nawx_1        |     connection.commit()\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 262, in commit\r\nawx_1        |     self._commit()\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\nawx_1        |     return self.connection.commit()\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/utils.py\", line 89, in __exit__\r\nawx_1        |     raise dj_exc_value.with_traceback(traceback) from exc_value\r\nawx_1        |   File \"/venv/awx/lib64/python3.6/site-packages/django/db/backends/base/base.py\", line 240, in _commit\r\nawx_1        |     return self.connection.commit()\r\nawx_1        | django.db.utils.IntegrityError: insert or update on table \"main_usersessionmembership\" violates foreign key constraint \"main_usersessionmembership_user_id_fe163c98_fk_auth_user_id\"\r\nawx_1        | DETAIL:  Key (user_id)=(2) is not present in table \"auth_user\".\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: curret devel head\r\n* AWX install method: docker-compose\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAlso happens with older releases. In that case, the traceback is:\r\n```\r\n2019-07-16 19:25:44,119 ERROR    django.request Internal Server Error: /\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 131, in get_response\r\n    response = middleware_method(request, response)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/contrib/sessions/middleware.py\", line 58, in process_response\r\n    request.session.save()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/contrib/sessions/backends/db.py\", line 87, in save\r\n    obj.save(force_insert=must_create, force_update=not must_create, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/base.py\", line 808, in save\r\n    force_update=force_update, update_fields=update_fields)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/base.py\", line 848, in save_base\r\n    update_fields=update_fields, raw=raw, using=using,\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/dispatch/dispatcher.py\", line 193, in send\r\n    for receiver in self._live_receivers(sender)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/dispatch/dispatcher.py\", line 193, in <listcomp>\r\n    for receiver in self._live_receivers(sender)\r\n  File \"/signals.py\", line 658, in save_user_session_membership\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/manager.py\", line 85, in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/db/models/query.py\", line 380, in get\r\n    self.model._meta.object_name\r\ndjango.contrib.auth.models.DoesNotExist: User matching query does not exist.\r\n```"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt would be a good idea to centralize the definition of virtual environments to execute job templates. This is a good idea to maintain the same packages into a venv between different Tower hosts to reduce error chance.\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAdd a built-in answer type for date and time that translates to a usable timestamp string for job runs"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nRight now, there is no way to use an inventory plugin-style YAML configuration aside from checking it into source control. We have had several inquiries related to this, so this is proposed as a solution to resolve all of those use cases.\r\n\r\nThings we can say this feature would necessary need to have:\r\n\r\n - form elements\r\n   - Place to select a credential or multiple credentials\r\n   - Place to enter YAML content of the inventory plugin (no JSON)\r\n   - (unclear) filename may or may not need to be independently specified, the only known stubborn exception that could require this is [VMWare](https://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/inventory/vmware_vm_inventory.py#L278)\r\n   - any other shared elements with whatever type of resource it is (like NAME)\r\n - The YAML content will be required to have `plugin: foo` as a top-level entry\r\n - The form will enforce that supported types use a credential of its corresponding type\r\n   - possible additional feature - allow custom types to claim an inventory plugin namespace\r\n - Inventory updates already use plugins, this will do very little different, just using the config that the user gives\r\n - A \"convert to plugin\" button on existing inventory sources that work with plugins\r\n   - this will start the user out with a configuration that gives compatibility with existing behavior, which they can then modify at will\r\n\r\nQuestions still remain. Will this be another type, similar to inventory scripts? Or will it be another option for `source` of an inventory source? Will there be any way for the user to alter ansible.cfg options, like the group name conversion?\r\n\r\nPing @wenottingham @ghjm"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAdd an option or setting for admins to require that users specify an end date on any scheduled job they setup."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nNode can't join to cluster after lost network connection to a postgres database.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\nBut bug still preset at 6.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Setup HA AWX cluster with 3+ nodes and external Postgres database\r\n2) Shutdown network on one of nodes and wait 120 sec(`grace_period`)\r\n3) Look at work nodes log, you will see, that node without network was removed from cluster:\r\n```\r\nJul  4 17:16:59 1.awx.node.dc2 dispatcher[207]: 2019-07-04 14:16:59,220 INFO     awx.main.tasks Host 1.awx.node.dc1 Automatically Deprovisioned.\r\n```\r\nAnd from postgres database:\r\n```\r\nawx=> SELECT id FROM main_instance;\r\n id\r\n-----\r\n 543\r\n 550\r\n(2 rows)\r\n```\r\n4) Fix network on node and look at it logs:\r\n```\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: 2019-07-04 14:20:39,433 ERROR    awx.main.dispatch failed to write inbound message\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: Traceback (most recent call last):\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/dispatch/pool.py\", line 388, in write\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: self.cleanup()\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/dispatch/pool.py\", line 373, in cleanup\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: reaper.reap(excluded_uuids=running_uuids)\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/dispatch/reaper.py\", line 35, in reap\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: me = instance or Instance.objects.me()\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/managers.py\", line 88, in me\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: raise RuntimeError(\"No instance found with the current cluster host id\")\r\nJul  4 17:20:39 1.awx.node.dc1 dispatcher[505]: RuntimeError: No instance found with the current cluster host id\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAfter restoring network connection to the database, node successfully rejoins to cluster.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNode never rejoin to cluster without instance restarting\r\n\r\n##### ADDITIONAL INFORMATION\r\nNode can't return to cluster, because it calls function `cleanup` from `pool.py` on each heartbeat.\r\n`cleanup` calls `reaper.reap()` and it fails,  because can't get instance id(awx delete node from database at reproduce step 3):\r\n```\r\nme = instance or Instance.objects.me()\r\n```\r\n\r\nI created a pull request, with probably fix: https://github.com/ansible/awx/pull/4268"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCurrently in AWX only System Admin/Org Admin can assign Instance Group but needs new role i.e. \"Instance Group Admin\" role and this role will help a user to assign existing instance group in a Job Template. "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nIf you use a certificate signed by non-official CA (or self-signed) for your HashiCorp Vault installation, you cannot use the credential plugin \"HashiCorp Vault Secret Lookup\".\r\nAdding the certificate to /etc/pki/ca-trust/ does not work, it still gets ignored.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 5.0.0\r\n* AWX install method: kubernetes (official image from dockerhub)\r\n* Ansible version: 2.8.1\r\n* Operating System: Fedora\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSet up a vault server with a self-signed (or signed by non-official CA) and try to use the credentials plugin.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBeing able to use the credentials plugin to lookup secrets in vault.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe following error appears:\r\n\r\n```\r\nHTTPSConnectionPool(host='vault.internal', port=8200): Max retries exceeded with url: /v1/secret/my-secret (Caused by SSLError(SSLError(\"bad handshake: Error([('SSL routines', 'tls_process_server_certificate', 'certificate verify failed')],)\",),))\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nCould probably be fixed, similar to the credential plugin 'awx/awx/main/credential_plugins/conjur.py', where you can add a CA certificate to validate against."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\nAzure Dynamic inventory import does not honour configuration of hostvar_expressions setting in azure_rm.py\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 6.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  Ansible 2.8.1 \r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nChange the ansible_host settings under hostvar_expressions to something other than defaults. Run dynamic inventory import. \r\n\r\n##### EXPECTED RESULTS\r\n\r\nInventory should import using the settings I specified \r\n\r\n##### ACTUAL RESULTS\r\n\r\nImport runs but the settings are not honored and the import is done using the original ansible_host settings\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nMy config\r\n\r\n> my_host_var:\r\n> \\# A statically-valued expression has to be both single and double-quoted, or use escaped quotes, since the outer\r\n> \\# layer of quotes will be consumed by YAML. Without the second set of quotes, it interprets 'staticvalue' as a\r\n>   \\# variable instead of a string literal.\r\n>   some_statically_valued_var: \"'staticvalue'\"\r\n>   \\# overrides the default ansible_host value with a custom Jinja2 expression, in this case, the first DNS hostname, or\r\n>   \\# if none are found, the first public IP address.\r\n>   ansible_host: (private_address) | first\r\n> \r\n\r\nOriginal config:\r\n\r\n> my_host_var:\r\n>   \\# A statically-valued expression has to be both single and double-quoted, or use escaped quotes, since the outer\r\n>   \\# layer of quotes will be consumed by YAML. Without the second set of quotes, it interprets 'staticvalue' as a\r\n>   \\# variable instead of a string literal.\r\n>   some_statically_valued_var: \"'staticvalue'\"\r\n>   \\# overrides the default ansible_host value with a custom Jinja2 expression, in this case, the first DNS hostname, or\r\n>   \\# if none are found, the first public IP address.\r\n>   ansible_host: (public_dns_hostnames + public_ip) | first\r\n> "},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\nAzure Dynamic Inventory import does not work if the VM does not have a Network Security Group assigned to the NIC\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 6.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  Ansible 2.8.1 \r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate Dynamic Iventory for Azure\r\nImport fails when no NSG is directly attached to the Network Interface Card of a VM. \r\n\r\n##### EXPECTED RESULTS\r\n\r\nInventory should still import even if there is no NSG attached to the NIC.  Attaching an NSG to a NIC is an optional configuration from an Azure point of view. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nImport failed. AWX errored stating security_group key was missing\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n`SEARCH\r\n    1.964 INFO     Updating inventory 2: azure\r\n    2.357 INFO     Reading Ansible inventory source: /tmp/awx_11_l8m7kgpr/azure_rm.yml\r\n    2.359 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    2.359 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    2.359 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python2.7/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 11, in <module>\r\n    load_entry_point('awx==6.0.0.0', 'console_scripts', 'awx-manage')()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 140, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1148, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1038, in handle\r\n    venv_path=venv_path, verbosity=self.verbosity).load()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 214, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 197, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nansible-inventory 2.8.1\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-inventory\r\n  python version = 2.7.5 (default, Jun 20 2019, 20:27:34) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n [WARNING]:  * Failed to parse /tmp/awx_11_l8m7kgpr/azure_rm.yml with auto\r\nplugin: No key or key resulted empty for security_group in host myAzureServer,\r\ninvalid entry\r\n  File \"/usr/lib/python2.7/site-packages/ansible/inventory/manager.py\", line 267, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/auto.py\", line 58, in parse\r\n    plugin.parse(inventory, loader, path, cache=cache)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/azure_rm.py\", line 265, in parse\r\n    self._get_hosts()\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/azure_rm.py\", line 346, in _get_hosts\r\n    self._add_host_to_keyed_groups(constructable_config_keyed_groups, h.hostvars, inventory_hostname, strict=constructable_config_strict)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/__init__.py\", line 442, in _add_host_to_keyed_groups\r\n    raise AnsibleParserError(\"No key or key resulted empty for %s in host %s, invalid entry\" % (keyed.get('key'), host))\r\n [WARNING]: Unable to parse /tmp/awx_11_l8m7kgpr/azure_rm.yml as an inventory\r\nsource\r\nERROR! No inventory was parsed, please check your configuration and options.`"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nA customer wants to use `Password Manager Pro` for its credential vault.\r\nhttps://www.manageengine.com/products/passwordmanagerpro/\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPer a customer's request, they would like to query the name of the Inventory utilized as a variable and use that variable in a playbook.\r\n\r\n~~~\r\n---\r\n- name: Test connectivity\r\n  hosts: all\r\n\r\n  tasks:\r\n    - name: Run hostname command\r\n      command: hostname\r\n    - name: Run Inventory Name\r\n      command: echo {{ inventory_name }}\r\n~~~"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nLDAP authentication against an LDAP server with a self-signed certificate, no longer works. It works if I comment out new code introduced in https://github.com/ansible/awx/commit/11b36982cd83b5571e3376d85af64d57f52d68c0\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.0.0\r\n* AWX install method: docker on linux (docker-compose)\r\n* Ansible version:  2.8.1\r\n* Operating System: rhel7\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHave a working LDAP auth config in awx 4.0.0 and 5.0.0, upgrade to 6.0.0 and try to log in.\r\n\r\nThese connection options works for 4.0.0 and 5.0.0:\r\n```\r\n# tower-cli setting get AUTH_LDAP_CONNECTION_OPTIONS -f json\r\n{\r\n  \"id\": \"AUTH_LDAP_CONNECTION_OPTIONS\",\r\n  \"value\": {\r\n    \"OPT_X_TLS_REQUIRE_CERT\": 0,\r\n    \"OPT_REFERRALS\": 0,\r\n    \"OPT_X_TLS_NEWCTX\": 0,\r\n    \"OPT_NETWORK_TIMEOUT\": 30\r\n  }\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpect authentication attempt against server with self-signed certificate to be successful, due to option OPT_X_TLS_REQUIRE_CERT.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAuthentication attempt fails, with message:\r\n2019-07-03 17:08:51,727 WARNING  django_auth_ldap Caught LDAPError while authenticating s10g: SERVER_DOWN({'desc': \"Can't contact LDAP server\", 'info': 'error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed (unable to get local issuer certificate)'},)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI added some logger statements into the new code introduced with commit 11b3698 such that the code in awx/sso/backends.py looks like this:\r\n```\r\n        logger.warn(\"connection_options1 contains: %s \" % self.CONNECTION_OPTIONS)\r\n        newctx_option = self.CONNECTION_OPTIONS.pop(ldap.OPT_X_TLS_NEWCTX, None)\r\n        self.CONNECTION_OPTIONS = OrderedDict(self.CONNECTION_OPTIONS)\r\n        logger.warn(\"connection_options2 contains: %s \" % self.CONNECTION_OPTIONS)\r\n        if newctx_option:\r\n            self.CONNECTION_OPTIONS[ldap.OPT_X_TLS_NEWCTX] = newctx_option\r\n            logger.warn(\"connection_options3 contains: %s \" % self.CONNECTION_OPTIONS)\r\n        logger.warn(\"connection_options4 contains: %s \" % self.CONNECTION_OPTIONS)\r\n```\r\n\r\nand now, awx_web's logfile shows me this (note missing \"24591: 0\"):\r\n```\r\n2019-07-03 17:08:51,422 WARNING  awx.sso.backends connection_options1 contains: {24582: 0, 8: 0, 24591: 0, 20485: 30}\r\n2019-07-03 17:08:51,426 WARNING  awx.sso.backends connection_options2 contains: OrderedDict([(24582, 0), (8, 0), (20485, 30)])\r\n2019-07-03 17:08:51,428 WARNING  awx.sso.backends connection_options4 contains: OrderedDict([(24582, 0), (8, 0), (20485, 30)])\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWith git projects currently, you can checkout a branch, tag, commit hash, or generally any ref that is listed under the git heads.\r\n\r\nIf you give a ref that is not a head, additional syntax is needed to clone it via the git module. For example:\r\n\r\n```yaml\r\n- hosts: all\r\n  gather_facts: false\r\n  connection: local\r\n  vars:\r\n    repo_dir: \"/tmp/foo_dir\"\r\n  tasks:\r\n    - name: update project using git\r\n      git:\r\n        dest: \"{{ repo_dir }}\"\r\n        repo: \"https://github.com/ansible/test-playbooks.git\"\r\n        version: \"pull/62/head\"\r\n        refspec: +refs/pull/62/head:refs/remotes/origin/pull/62/head  # works\r\n```\r\n\r\nAnother valid way:\r\n\r\n```yaml\r\n- hosts: all\r\n  gather_facts: false\r\n  connection: local\r\n  vars:\r\n    repo_dir: \"/tmp/foo_dir\"\r\n  tasks:\r\n    - name: update project using git\r\n      git:\r\n        dest: \"{{ repo_dir }}\"\r\n        repo: \"https://github.com/ansible/test-playbooks.git\"\r\n        refspec: refs/pull/62/head\r\n```\r\n\r\nThis means that the contract between AWX and Ansible changes, and it's probable that the contract with the user changes.\r\n\r\nNote that the dual parameters `refspec` and `version` are documented to exist so that you can clone a commit hash of a non-head ref. For example, say I have a PR with 5 commits, I want to clone the 3rd commit of the PR. This has to involve an additional `git fetch` command, which is what `refspec` allows you to do, and this is a use case we need to support (in part because the git module supports it).\r\n\r\nIt's still possible that we add this as an enhancement to the git module. Proposal for that:\r\n\r\n - when resolving the version, add additional `elif` block if it's not in branches or tags, only if it does not fit a valid SHA-1 hash\r\n - in this case, automatically add a `refspec` parameter\r\n - add `refs/` to the start of the refspec if it does not already have it\r\n\r\nThis issue is to replace https://github.com/ansible/ansible/issues/57497, because the module is still in compliance with its own documentation, so I'm closing that. The solution could be in either repo, but it the use case is AWX-centric.\r\n\r\nPart of features https://github.com/ansible/awx/issues/282 and https://github.com/ansible/awx/issues/2862"},{"labels":["api",null,null,null,null],"text":"This is for adding a basic ws module to the client:\r\n\r\n- global subscriptions / global states\r\n- view-specific / per-job subscriptions "},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - inventories management\r\n\r\n##### SUMMARY\r\nI'm not able to add hosts from openstack source\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 5.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.1\r\n* Operating System: Debian9\r\n* Web Browser: Chrome/Safari\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Add your openstack credentials to AWX and select type \"Openstack\" \r\n<img width=\"1422\" alt=\"Capture d’écran 2019-07-01 à 19 04 29\" src=\"https://user-images.githubusercontent.com/216474/60454053-1fa9d600-9c33-11e9-95ed-aaeec7197fce.png\">\r\n\r\n2. go to inventory and add an openstack inventory using these credentials\r\n<img width=\"1409\" alt=\"Capture d’écran 2019-07-01 à 19 04 43\" src=\"https://user-images.githubusercontent.com/216474/60454060-23d5f380-9c33-11e9-88d1-da34031944b4.png\">\r\n\r\n3. clic on \"start sync\" button\r\n\r\n##### EXPECTED RESULTS\r\n\r\nhosts from openstack must be integrated into awx\r\n\r\n##### ACTUAL RESULTS\r\n\r\n  ```\r\n  1.891 INFO     Updating inventory 7: openstack\r\n    2.278 DEBUG    Using base command: python /usr/bin/ansible-inventory -i /tmp/awx_168_p5pex3g_/openstack.yml --playbook-dir /tmp/awx_168_p5pex3g_ -vvvvv\r\n    2.278 INFO     Reading Ansible inventory source: /tmp/awx_168_p5pex3g_/openstack.yml\r\n    2.280 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    2.280 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    2.280 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python2.7/site-packages:\r\n    3.525 ERROR    ansible-inventory 2.8.1\r\n    3.526 ERROR      config file = /etc/ansible/ansible.cfg\r\n    3.526 ERROR      configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n    3.526 ERROR      ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n    3.526 ERROR      executable location = /usr/bin/ansible-inventory\r\n    3.526 ERROR      python version = 2.7.5 (default, Apr  9 2019, 14:30:50) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n    3.526 ERROR    Using /etc/ansible/ansible.cfg as config file\r\n    3.526 ERROR    setting up inventory plugins\r\n    3.526 ERROR    Parsed /tmp/awx_168_p5pex3g_/openstack.yml inventory source with auto plugin\r\n    3.527 DEBUG    Finished loading from source: /tmp/awx_168_p5pex3g_/openstack.yml\r\n    3.527 INFO     Processing JSON output...\r\n    3.527 DEBUG    Loaded group: all\r\n    3.528 INFO     Loaded 0 groups, 0 hosts\r\n    3.540 DEBUG    Inventory variables unmodified\r\n2019-07-01 16:50:22,371 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=7\r\n2019-07-01 16:50:22,482 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=7, in 0.101 seconds\r\n    3.661 INFO     Inventory import completed for openstack in 1.8s\r\n```\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nSome of the challenges we are seeing is the lack of support for AWS IAM Cross Account Roles for Dynamic Inventories as well as playbook credential management for operational tasks. Currently we manage 8 AWS Accounts and are going to grow to over 20 very shortly in the next year.  \r\n\r\nWe have AWS Accounts that share several project teams within the account. Due to the lack of support we have to create an IAM Access Key for each project for operational playbooks such as reboot/start/stop instance, etc. Due to our requirements for Key Rotation every 365 days (AWS recommends every 90) we are having to coordinate credential rotation consistently.  \r\n\r\nIt would be useful to have one master IAM key for Ansible Tower and then scope EC2 inventories and Playbooks to utilize the Role associated for a project. This would allow us to only have to rotate one credential per Ansible Tower per year.  \r\n\r\nThis has been brought up to the GitHub repo as we are not the only ones looking for this at an enterprise level: https://github.com/ansible/ansible/issues/24740  \r\n\r\n```What matthewapeters has raised, this is a blocker for enterprise users and given Ansible is now with RedHat who have enterprise customers this I would love to see being implemented. I keep coming across this for enterprise customers for more than 3 years now and was hoping this would have been resolved by now```\r\n--\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWe are pulling data from a mysql database to create an inventory. This script uses the mysql-connector to connect to the mysql database. We already have a custom venv mounted inside every container with all our needed python modules and we would also like to use this custom venv in our custom dynamic inventory scripts. This would allow us to not need to rebuild the awx task and web containers."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0+\r\n* AWX install method: any\r\n* Ansible version:  any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAWX's task dispatcher manages a pool of worker processes to execute playbooks in the background when jobs are launched.  Much like its predecessor, http://www.celeryproject.org, it forks *new* processes on demand as necessary to scale up when multiple jobs are running.\r\n\r\nWhen external logging is enabled and configured to send logs to an HTTP/HTTPS endpoint (e.g., logstash, splunk), every AWX python process maintains a pool of background threads that emit log lines asynchronously to the destination log aggregator.\r\n\r\ncpython (2.7 and 3.6) have a race condition _on fork_ which can cause a deadlock when this external logging mechanism is in use:\r\n\r\nhttps://bugs.python.org/issue37429\r\n\r\nDue to nature of this race condition, and the very small critical path of the underlying locking mechanism in cpython, it's very difficult to observe this bug, but in the reproductions I've seen, it happens when:\r\n\r\n1.  External logging is enabled, particularly at the `DEBUG` level.\r\n2. A number of simultaneous jobs are scheduled at _nearly_ the same time.\r\n3. The dispatcher scales up by forking several new worker processes.\r\n4.  Critically, this `os.fork()` occurs at nearly the same moment in time that one of the background threads is beginning to emit a log."},{"labels":["api",null,null],"text":"ISSUE TYPE\r\n - Bug Report\r\n\r\nSUMMARY\r\nAfter adding an Azure Dynamic Dynamic Plugin as source of an Inventory in AWX, when I start  sync process, it fails.  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 5.0.0.\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.1\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Chrome 75.0.3770.100\r\n\r\n##### STEPS TO REPRODUCE\r\n1) Add credentials (i.e. a Service principal) with proper permission on an Azure subscription\r\n2) Add Azure Resource Manager as source of an existing Inventory\r\n3) Assign Azure creds to the Dynamic Inventory\r\n4) Customize Source variables (i.e. retrieving all RGs)\r\n5) Click on Save button\r\n7) Click button that starts sync process\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSynchronize an Inventory with an Azure subscription, retrieving info on all VMs hosted on it\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSync process fails with the following error:\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/19493042/60284963-c1b08200-9904-11e9-87cb-94ff95b3b847.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nIt seems sync process is failing because it can't the \"azure_rm.yml\" file\r\nThis file should be in the awx-task container.\r\n\r\nSample of Source variable:\r\n\r\n![image](https://user-images.githubusercontent.com/19493042/60285010-e573c800-9904-11e9-815b-6d618877dc85.png)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWhen setting up SAML with AzureAD, if a user has too many group associations, the XML returned will contain a link to the claim in Azure rather than the list of attributes. For example:\r\n\r\n```<samlp:Response Destination=\"https://towerd.example.com/sso/complete/saml/\"\r\n    ID=\"_baf9ca3b-7d7a-4ea6-8c46-931e7bf52937\"\r\n    InResponseTo=\"ONELOGIN_8d309fe692d5d23d30f4cfdda273f83a51f3f522\"\r\n    IssueInstant=\"2019-06-27T14:22:29.455Z\" Version=\"2.0\"\r\n    xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\">\r\n    <Issuer xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\">https://sts.windows.net/22da2fa9-f8e7-4f8c-a588-a72b6896d459/</Issuer>\r\n    <samlp:Status><samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/></samlp:Status>\r\n    <Assertion ID=\"_46e11da4-49e6-4b93-871e-da560fdb0800\" IssueInstant=\"2019-06-27T14:22:29.440Z\"\r\n        Version=\"2.0\" xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\">\r\n        <Issuer>https://sts.windows.net/22da2fa9-f8e7-4f8c-a588-a72b6896d459/</Issuer>\r\n        <Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\">\r\n            <SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/>\r\n                <Reference URI=\"#_46e11da4-49e6-4b93-871e-da560fdb0800\">\r\n                    <Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/>\r\n                    <DigestValue>5WCFnC7CQLxYlqQfUMnUj7yZeIWXmIAskY4sYSJ7gpQ=</DigestValue>\r\n                </Reference>\r\n            </SignedInfo>\r\n            <SignatureValue>cOzei/SkrjcwhnWgJaWmrbY2OzJt+qn41/+4swj9zX+kGulbtChhBe+pNbWuC0E7eUPt+obqg2X667JAcAwnHSB077na84R1h1wZHZ7cDd7WMYueWjOpgSgyWA3a8KaRHekFjwtPp4favUdTKAmEsm31dHZ7ZI0OMSIrdtuNFWP8PK4vgqGrE/HUYUYW3sFL1uhQcqUlbDBJRPOLnwxUnaeoFtq7TQ9HLOgihpfTJApoguN05G8TbQV7TUcybGUrF2atlMUDW6ZJ9LSpl9SyrFCv423CIlqc3b3cVlbnM/VbgdBPQnv/hXe98+KizDY02/Hg8fONs9dPdj1iF2hxhA==</SignatureValue>\r\n            <KeyInfo>\r\n                <X509Data>\r\n                    <X509Certificate>MIIC8DCCAdigAwIBAgIQZILpTyw2/pJF+ooVgEus6jANBgkqhkiG9w0BAQsFADA0MTIwMAYDVQQDEylNaWNyb3NvZnQgQXp1cmUgRmVkZXJhdGVkIFNTTyBDZXJ0aWZpY2F0ZTAeFw0xOTA2MDMxNzU5MzBaFw0yMjA2MDMxNzU5MzBaMDQxMjAwBgNVBAMTKU1pY3Jvc29mdCBBenVyZSBGZWRlcmF0ZWQgU1NPIENlcnRpZmljYXRlMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqBC7JnxvCR+bJz7sX/1MSrwH/IHVHXjdGcSaWv928OZPIuuWfxnK7Nc5jMZFU1G4GQiP52pjiWCqsT+LlLZEGPU2Lwi8CZWg0F8TphV7pkE5gZ1Xdgy2UvWzqXj3GYn4gFHBEhTQ9uMAT8kXyNHbDjFzG+ZQhmY/g4zL6v3gUDity1J/6NfJP/o2j5Xx6ijCMEEz7euHOeEHxFnzv8Igu+eJ017fpM0wTOXUOdP/s9YTcXmPMtJKas4rIttXdjhUoCUq0XTP3p6Fop2KLLdZ7CJtW02NjgLeViKNirye0Ah4gif1AFAT3qWRBYwmqKprB148rvZHSucKPOs3PLKllwIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQAwV8kaT4y93Bx/wBmTXMtM9cidCIjZQU20YJTT6TlqPvhVnLAfyZP4sGVMS/GAngbylY3WTwKUKSFzYPMdS4LX1d8SPjj2/1StFmeOGdKi2YhTpI1rpL7hv6mMK6tKn/ix0OWnGQGD3lxv/6FLsSYhf+3zqkEw5xxCzgiSnZQjg0Wj/NnvCdb7VEJyKAI8I0XbP5XuyE3dIsqhxWhmls1e4A+OEIobvjK6R9Opi7naMmws5GqRonZkeKh04lNCpFxIn77c8VO2fJM8EAFcFudsepT1gfBEdQriTZjCYP9HttFQbAKP/uT81NbVLIbEWiVj3vLYAjpBWDTn8Fv+gEDU</X509Certificate>\r\n                </X509Data>\r\n            </KeyInfo>\r\n        </Signature>\r\n        <Subject>\r\n            <NameID Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\">admin@example.com</NameID>\r\n            <SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\"><SubjectConfirmationData InResponseTo=\"ONELOGIN_8d309fe692d5d23d30f4cfdda273f83a51f3f522\"\r\n                NotOnOrAfter=\"2019-06-27T14:27:29.440Z\" Recipient=\"https://towerd.example.com/sso/complete/saml/\"/></SubjectConfirmation>\r\n        </Subject>\r\n        <Conditions NotBefore=\"2019-06-27T14:17:29.440Z\" NotOnOrAfter=\"2019-06-27T15:22:29.440Z\">\r\n            <AudienceRestriction>\r\n                <Audience>https://towerd.example.com</Audience>\r\n            </AudienceRestriction>\r\n        </Conditions>\r\n        <AttributeStatement>\r\n            <Attribute Name=\"http://schemas.microsoft.com/identity/claims/tenantid\">\r\n                <AttributeValue>22da2fa9-f8e7-4f8c-a588-a72b6896d459</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.microsoft.com/identity/claims/objectidentifier\">\r\n                <AttributeValue>0669f6df-d1a7-4e41-93a2-74aa78792053</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.microsoft.com/identity/claims/displayname\">\r\n                <AttributeValue>Test (ADM), Admin W</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.microsoft.com/claims/groups.link\">\r\n                <AttributeValue>https://graph.windows.net/22da2fa9-f8e7-4f8c-a588-a72b6896d459/users/0669f6df-d1a7-4e41-93a2-74aa78792053/getMemberObjects</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.microsoft.com/identity/claims/identityprovider\">\r\n                <AttributeValue>https://sts.windows.net/22da2fa9-f8e7-4f8c-a588-a72b6896d459/</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.microsoft.com/claims/authnmethodsreferences\">\r\n                <AttributeValue>http://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/windows</AttributeValue>\r\n                <AttributeValue>http://schemas.microsoft.com/claims/multipleauthn</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\">\r\n                <AttributeValue>Tower_Admins</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.microsoft.com/ws/2008/06/identity/claims/wids\">\r\n                <AttributeValue>62e90394-69f5-4237-9190-012177145e10</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname\">\r\n                <AttributeValue>Admin</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname\">\r\n                <AttributeValue>Test (ADM)</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\">\r\n                <AttributeValue>admin@example.com</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\">\r\n                <AttributeValue>admin@example.com</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/memberOf\">\r\n                <AttributeValue>Tower_Admins</AttributeValue>\r\n            </Attribute>\r\n            <Attribute Name=\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/administrator-Of\">\r\n                <AttributeValue>Tower_Admins</AttributeValue>\r\n            </Attribute>\r\n        </AttributeStatement>\r\n        <AuthnStatement AuthnInstant=\"2019-06-27T14:21:20.160Z\"\r\n            SessionIndex=\"_46e11da4-49e6-4b93-871e-da560fdb0800\">\r\n            <AuthnContext>\r\n                <AuthnContextClassRef>urn:federation:authentication:windows</AuthnContextClassRef>\r\n            </AuthnContext>\r\n        </AuthnStatement>\r\n    </Assertion>\r\n</samlp:Response>\r\n```\r\n\r\nAWX/Tower will not follow the claim links in order to obtain the list of attributes."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nLooking through logs to debug another problem, I found a weird traceback.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nWhen `insights-client` is not installed on a machine, awx still tries to do things to communicate with it and ends up throwing tracebacks in the logs.\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nNo insights-client, no reporting metrics, no tracebacks\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nin `/var/log/tower.log`\r\n```\r\n2019-06-25 00:24:00,434 ERROR    awx.main.analytics Could not generate metric instance_info.json\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/analytics/core.py\", line 94, in gather\r\n    json.dump(func(last_run), f)\r\n  File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/json/__init__.py\", line 179, in dump\r\n    for chunk in iterable:\r\n  File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/json/encoder.py\", line 430, in _iterencode\r\n    yield from _iterencode_dict(o, _current_indent_level)\r\n  File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/json/encoder.py\", line 404, in _iterencode_dict\r\n    yield from chunks\r\n  File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/json/encoder.py\", line 404, in _iterencode_dict\r\n    yield from chunks\r\n  File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/json/encoder.py\", line 437, in _iterencode\r\n    o = _default(o)\r\n  File \"/opt/rh/rh-python36/root/usr/lib64/python3.6/json/encoder.py\", line 180, in default\r\n    o.__class__.__name__)\r\nTypeError: Object of type 'datetime' is not JSON serializable\r\n2019-06-25 00:24:00,469 ERROR    awx.main.analytics could not find insights-client on PATH\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n@rooftopcellist mentioned:\r\nhttps://github.com/ansible/awx/blob/devel/awx/main/analytics/core.py#L139\r\nawx/main/analytics/core.py:139\r\n\r\nand that he thought `CalledProcessError` _would_ have caught that..\r\n\r\n...looks like is not quite enough for this situation"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\nI would like to see that the machine credential is NOT an exception and also provide it's data to the playbook, for example using environment variables.\r\n\r\n##### SUMMARY\r\nExample use-case: Create a VM on a public cloud, ie Azure. Part of the VM creation is to specify a credential to be able to log-in into freshly created VM. It would be great if one could use the machine credential data for it, either the username/password or the prov esc user/pass or the ssh key info, depending on how the VM is created on the target cloud. After that, the same machine credential can then be used to run playbooks in this VM.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nPulling roles from galaxy does not work with subversion projects\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 5.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a new project as subversion from https://github.com/AlanCoding/ansible-roles-example\r\n\r\n![Screen Shot 2019-06-25 at 3 45 20 PM](https://user-images.githubusercontent.com/1385596/60128282-43b37600-9760-11e9-9781-5931027eedd7.png)\r\n\r\nInspect the update that it runs\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt detects the requirements file and does a galaxy update\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIt does not do these things\r\n\r\n![Screen Shot 2019-06-25 at 3 46 15 PM](https://user-images.githubusercontent.com/1385596/60128340-69407f80-9760-11e9-8d67-4bac8bf1e0ad.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIn more detail for that task we have\r\n\r\n```json\r\n{\r\n    \"stat\": {\r\n        \"exists\": false\r\n    },\r\n    \"_ansible_no_log\": false,\r\n    \"_ansible_delegated_vars\": {\r\n        \"ansible_host\": \"localhost\"\r\n    },\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"get_checksum\": true,\r\n            \"follow\": false,\r\n            \"checksum_algorithm\": \"sha1\",\r\n            \"path\": \"/projects/_4153__roles_checkout_svn_project_parkfault/roles/requirements.yml\",\r\n            \"get_mime\": true,\r\n            \"get_md5\": null,\r\n            \"get_attributes\": true\r\n        }\r\n    },\r\n    \"changed\": false\r\n}\r\n```\r\n\r\nNote that the file `/projects/_4153__roles_checkout_svn_project_parkfault/trunk/roles/requirements.yml` does exist, but `/projects/_4153__roles_checkout_svn_project_parkfault/roles/requirements.yml` does not exist.\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nFor workflow template and survey, a customer often wants to select PROD/DEV.\r\nI propose a new feature like `Environment` under `Organizations` to make a group for those PROD/DEV deployments.\r\n\r\n`Environment` has these materials:\r\n- credentials (for example, grouping credentials for each env [PROD_SSH, PROD_A, PROD_B] and [DEV_SSH, DEV_A, DEV_B])\r\n- extra variables\r\n- inventories\r\n- playbooks (like #526)\r\n\r\nThen the same workflow template and job template can be used and be switched easily between PROD and DEV.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nVMware updates do not work when inventory update is run in python3.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 6.0.0\r\n* AWX install method: RPM\r\n* Ansible version:  2.8\r\n* Operating System: RHEL8\r\n* Web Browser: n/a\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nIn a python3 ansible virtualenv, run VMWare inventory update\r\n\r\nOn RHEL8, AWX 6.0.0 uses a python3 venv by default.\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nWorks\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\n```\r\nTraceback (most recent call last):   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py\", line 772, in <module>\r\nprint(VMWareInventory().show())   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py\", line 145, in __init__\r\nself.do_api_calls_update_cache()   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py\", line 184, in\r\ndo_api_calls_update_cache     self.inventory =\r\nself.instances_to_inventory(self.get_instances())   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py\", line 351, in get_instances\r\nreturn self._get_instances(kwargs)   File\r\n\"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py\", line 393, in\r\n_get_instances     for instance in sorted(instances): TypeError: '<' not\r\nsupported between instances of 'vim.VirtualMachine' and 'vim.VirtualMachine'\r\n\r\n  File \"/usr/lib/python3.6/site-packages/ansible/inventory/manager.py\", line 267, in parse_source\r\n    plugin.parse(self._inventory, self._loader, source, cache=cache)\r\n  File \"/usr/lib/python3.6/site-packages/ansible/plugins/inventory/script.py\", line 161, in parse\r\n    raise AnsibleParserError(to_native(e))\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nUpstream bug: https://github.com/ansible/ansible/issues/46727\r\n\r\n@abadger says he could provide some guidance to fix PR that was put up but not merged because it does not work in python2 (needs to work for both python2 and 3)\r\n\r\nBasically we either need to fix the script we vendor or update to plugin to get past this.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAs of Ansible 2.8, Netbox has had a native inventory plugin. Including that as an available inventory source in AWX/Tower would be a welcome addition in the automation world as Netbox's popularity increases.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\nWe use AWX to create resources on a VmWare infrastructure. When we're creating a resource, if the Job is cancelled while it's running, the model \"breaks\" without human intervention.\r\n\r\n##### SUMMARY\r\nIs it possible to unauthorised an \"Execute\" profile to cancel a job ? It could be only done by an \"Admin\" profile on this Job.\r\n\r\nI would appreciate any help you can provide.\r\n"},{"labels":["api",null,null],"text":"##### SUMMARY\r\n1.  Create a normal user, `peon`, with \"admin\" access to a Job Template.\r\n2.  As that user, attempt to create a schedule for that Job Template, specifying `credentials`:\r\n\r\n```python\r\nbody = {\r\n    'inventory': 1,\r\n    'credentials': [1],\r\n    'name': 'Example',\r\n    'rrule': 'DTSTART:20151117T050000Z RRULE:FREQ=DAILY;INTERVAL=1;COUNT=1'\r\n}\r\nrequests.post(\r\n    'https://peon:peon@awx.example.org:8043/api/v2/job_templates/7/schedules/',\r\n    json=body\r\n)\r\n```\r\n\r\nAWX raises an uncaught exception:\r\n\r\n```python\r\n2019-06-21 20:31:01,747 ERROR    django.request Internal Server Error: /api/v2/job_templates/7/schedules/\r\nTraceback (most recent call last):\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n    return func(*args, **kwds)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"./awx/api/generics.py\", line 293, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 495, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 455, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 492, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/generics.py\", line 244, in post\r\n    return self.create(request, *args, **kwargs)\r\n  File \"./awx/api/generics.py\", line 570, in create\r\n    if not request.user.can_access(self.model, 'add', serializer.initial_data):\r\n  File \"./awx/main/access.py\", line 122, in check_user_access\r\n    result = access_method(*args, **kwargs)\r\n  File \"./awx/main/access.py\", line 162, in wrapper\r\n    return func(self, *args, **kwargs)\r\n  File \"./awx/main/access.py\", line 2445, in can_add\r\n    if not JobLaunchConfigAccess(self.user).can_add(data):\r\n  File \"./awx/main/access.py\", line 162, in wrapper\r\n    return func(self, *args, **kwargs)\r\n  File \"./awx/main/access.py\", line 1787, in can_add\r\n    cred_pks = [cred.pk for cred in data['credentials']]\r\n  File \"./awx/main/access.py\", line 1787, in <listcomp>\r\n    cred_pks = [cred.pk for cred in data['credentials']]\r\nAttributeError: 'int' object has no attribute 'pk'\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThe '/metrics/' API [does not support JSON format](https://github.com/ansible/awx/pull/3672/files).\r\n\r\nMetrics are returned as raw text, with comments and inconsistent formatting. This is different than most of the other API endpoints, that return easily consumable JSON.  We would prefer to interact with this API in a similar manner to the others, for example using [tower-cli](https://github.com/ansible/tower-cli) .  If JSON was supported, this would be relatively easy functionality to add.\r\n\r\nI've attempted to do this myself in a client (extending tower-cli), and I'm able to handle most of the metrics pretty easily.  When comments make clear what they are, and they have meaningful values.  For example this metric:\r\n```bash\r\n# HELP awx_organizations_total Number of organizations\r\n# TYPE awx_organizations_total gauge\r\nawx_organizations_total 28.0\r\n```\r\nTranslates to:\r\n```json\r\n  \"awx_organizations_total\": \"28.0\",\r\n```\r\n\r\nBut not all items are this straightforward.  I'm unsure how to handle this one for instance:\r\n```bash\r\n# HELP awx_instance_info Info about each node in a Tower system\r\n# TYPE awx_instance_info gauge\r\nawx_instance_info{enabled=\"True\",instance_uuid=\"f3c13b50-74c2-4f47-b847-f17a09c0d3c9\",last_isolated_check=\"None\",managed_by_policy=\"True\",version=\"3.5.0\"} 1.0\r\n```\r\nApplying the same logic to this metric produces odd results.  It seems like all the usable information in this case is in the key, and the value is meaningless?:\r\n```json\r\n\"awx_instance_info{enabled=\\\"True\\\",instance_uuid=\\\"4a0cab64-64fc-4a6f-88d7-2dae480ed71f\\\",last_isolated_check=\\\"None\\\",managed_by_policy=\\\"True\\\",version=\\\"3.5.0\\\"}\": \"1.0\",\r\n```\r\n\r\nThis representation seems more logical:\r\n```json\r\n\"awx_instance_info\": {\r\n  \"enabled\": \"True\",\r\n  \"instance_uuid\": \"4a0cab64-64fc-4a6f-88d7-2dae480ed71f\",\r\n  \"last_isolated_check\": \"None\",\r\n  \"managed_by_policy\": \"True\",\r\n  \"version\": \"3.5.0\"\r\n}\r\n\r\n```\r\n\r\nThis difference in format seems to be discussed [here](https://github.com/ansible/awx/issues/3781).\r\n\r\nI'm happy to assist with this if I can - I had planned on submitting a PR to tower_ci to handle this data, but this structure seems like something that should be defined by the API."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nOAuth 2 token authentication should be used instead of basic auth when integrating with the API.  We should disable basic auth by default.  \r\n\r\n```\r\nAUTH_BASIC_ENABLED = False\r\n```\r\n\r\nUsers can still enable this by changing the setting to True.  We need to ensure that for upgrades, the existing value is kept so there are no surprises for current users.  "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\nFeature bug\r\n\r\n##### SUMMARY\r\nAfter #3098 I've tested signed certificate login but it didn't worked. The signed certificate is not available when \"ssh-add\" command is called by \"anisble-runner\"\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 5.0.0\r\n* AWX install method: docker on linux\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Create a Machine Credential with private key and a signed certificate.\r\n* Try to run a job using this credential\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe SSH connection to the job must succeed\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe connection fails with \"connection denied\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAfter #3098 I've tested signed certificate login but it didn't worked. I checked the \"ssh-add\" command is invoked by \"ansible-runner\" with [\"artifacts_dir/ssh_key_data\" file](https://github.com/ansible/ansible-runner/blob/master/ansible_runner/runner_config.py#L167), but the signed certificates are stored to [\"private_data_dir/credential_%d-cert.pub\" file](https://github.com/ansible/awx/blob/devel/awx/main/tasks.py#L830).\r\nSince \"ssh-add\" looks for the certificate file from a file with the same name as the [private key plus \"-cert.pub\"](https://github.com/openssh/openssh-portable/blob/master/ssh-add.c#L336), the certificate file must be placed in the same directory as the private key and with the same name prefix.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nTwo problems:\r\n\r\n- Up until _very_ recently (like, moments ago), the `ovirt4.py` inventory script in Ansible (which we vendor in AWX) didn't work when run under python3 (meaning these inventory updates would fail in certain distributions that ship py3 by default, like RHEL8)\r\n\r\n- Due to a bug in the `ovirt4.py` inventory script, Inventory Syncs would fail if any VMs managed by the Ovirt/RHV manager were powered off.\r\n\r\n- In Ansible 2.8, the `ovirt` modules now require `>= ovirtsdk4 version 4.3.0` (see  https://github.com/ansible/awx/issues/4030, https://github.com/ansible/ansible/commit/bfc6a2a8d6342c7f36038c2216dc8f3e50a6244a)\r\n\r\nWe should:\r\n\r\n- Pull in the latest `ovirt4.py` script from Ansible 2.9dev (PR: https://github.com/ansible/awx/pull/4083)\r\n- Update the version of `ovirt-engine-sdk-python` in our `requirements.txt`"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\nThe standard cleanup job schedule clean ups jobs older than x days.\r\nWe have some maintenanance jobs which we want to cleanup every 10 days or something.\r\nSo I would be fine if you could specify job names with wildcards to cleanup\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.1\r\n* Operating System: Centos7\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nI don't know how to reproduce this issue since I don't know the root cause.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nHost variables normally show:\r\n\r\n> powerstate: \r\nresource_group: \r\nimage:\r\npublic_ip: \r\npublic_ip_name: \r\nansible_connection:\r\npublic_ip_id: >-\r\nid: \r\nos_disk:\r\nsecurity_group_id: \r\nvirtual_machine_size:\r\nwindows_auto_updates_enabled: \r\nmac_address: \r\ntype:\r\nlocation: \r\ntags:\r\npublic_ip_alloc_method: \r\nprovisioning_state: \r\nplan:\r\ncomputer_name: \r\nwindows_timezone: \r\nansible_host: \r\nname: \r\nwindows_rm: null\r\nfqdn: \r\nnetwork_interface_id: \r\nprivate_ip_alloc_method: \r\nsecurity_group: \r\nnetwork_interface: \r\nprivate_ip: \r\nprivate_ipv4_addresses:\r\npublic_dns_hostnames:\r\npublic_ipv4_addresses:\r\nresource_type: \r\nvmid: \r\nvmss: \r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nI have a host which only shows the following variables:\r\n\r\n> ansible_host: \r\ncomputer_name: \r\nid: \r\nimage: \r\nlocation: \r\nmac_address: \r\nname: \r\nnetwork_interface: \r\nnetwork_interface_id: \r\nos_disk:\r\nplan: \r\npowerstate: \r\nprivate_ip: \r\nprivate_ipv4_addresses:\r\nprovisioning_state: \r\npublic_dns_hostnames:\r\npublic_ip: \r\npublic_ip_id: \r\npublic_ip_name: \r\npublic_ipv4_addresses:\r\nresource_group: \r\nresource_type: \r\nsecurity_group: \r\nsecurity_group_id: \r\ntags:\r\ntype: \r\nvirtual_machine_size: \r\nvmid: \r\nvmss: \r\n\r\nSo for example public_ip_alloc_method and private_ip_alloc_method is missing. \r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nI've tried to delete the inventory and start again but same result. Other hosts show all variables. \r\nWe had no issue before version 4.0.0 with this host."},{"labels":["api",null,null,null],"text":"https://github.com/ansible/ansible/pull/47684/files Ansible 2.8 is adding a `v2_runner_on_start` event type. Pre Ansible 2.8 a single event is emitted, `playbook_on_task_start`, when a play begins. Then, an event of the form `runner_on_*` is emitted for _each_ host when it finishes the task. Now, for each `runner_on_*` finish event, there will be a corresponding `v2_runner_on_start` event.\r\n\r\nThis is especially helpful to identify tasks that are long-running for various reasons i.e. waiting for input, establishing an ssh connection, etc.\r\n\r\nAt a minimum we need to add the new event to our event list https://github.com/ansible/awx/blob/devel/awx/main/models/events.py#L102\r\n\r\nIdeally, we would relate the finish task event to the start task event via our uuid similar to how we relate events via parent_uuid. Note that this might need to be added at the Ansible Runner level but the field may need to be brought to the forefront in awx so that we can database index it."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhile verifying that job event children were properly linked to when https://github.com/ansible/awx/issues/3798 was fixed, I noticed that the parent was then not referenced by the children.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun the playbook:\r\n\r\nhttps://github.com/ansible/test-playbooks/blob/master/debug.yml\r\n\r\nand set `ansible_connection: local`\r\n\r\nDo this on an inventory with 500 hosts (roughly).\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe event:\r\n\r\n> Task Started (debug)\r\n\r\nis a parent of many other events.\r\n\r\nNavigate to /api/v2/job_events/<id of debug event>/children\r\n\r\nEXPECT that \r\nChildren have link to parent in their `related` fields\r\n\r\n##### ACTUAL RESULTS\r\nNo link to parent in `related` fields\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n@AlanCoding I only noticed this because of a comment in a test you wrote..."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\novirt.py dynamic inventory shipped with Tower 3.5.0.1 fails on inventory sync with RHV/Ovirt 4.3.\r\n\r\nThe problem related to inventory sync with ovirt 4.3 was fixed in this issue - https://github.com/ansible/ansible/pull/54338/\r\n\r\nBut this fix is not in the inventory script shipped with Tower.\r\n\r\n##### ENVIRONMENT\r\n\r\n* Tower Install - 3.5.0.1\r\n\r\n* AWX install method: linux\r\n* Ansible version:  2.8.0\r\n* Operating System: RHEL 7.6\r\n* Web Browser: Firefox 66.0.5\r\n\r\n* RHV 4.3.3.7-0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nExecute inventory sync with source \"Red Hat Virtualization\" using Tower 3.5.0.1 connected to RHV 4.3 environment.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nInventory sync completes without error.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSync fails with:\r\n\r\n [WARNING]:  * Failed to parse /var/lib/awx/venv/awx/lib64/python3.6/site- packages/awx/plugins/inventory/ovirt4.py with script plugin: Inventory script (/var/lib/awx/venv/awx/lib64/python3.6/site- packages/awx/plugins/inventory/ovirt4.py) had an execution error: Traceback (most recent call last):   File \"/var/lib/awx/venv/awx/lib64/python3.6/site- packages/awx/plugins/inventory/ovirt4.py\", line 262, in <module>     main() File \"/var/lib/awx/venv/awx/lib64/python3.6/site- packages/awx/plugins/inventory/ovirt4.py\", line 254, in main vm_name=args.host,   File \"/var/lib/awx/venv/awx/lib64/python3.6/site- packages/awx/plugins/inventory/ovirt4.py\", line 213, in get_data     vms[name] = get_dict_of_struct(connection, vm)   File \"/var/lib/awx/venv/awx/lib64/python3.6/site- packages/awx/plugins/inventory/ovirt4.py\", line 182, in get_dict_of_struct (stat.name, stat.values[0].datum) for stat in stats   File \"/var/lib/awx/venv/awx/lib64/python3.6/site- packages/awx/plugins/inventory/ovirt4.py\", line 182, in <genexpr> (stat.name, stat.values[0].datum) for stat in stats IndexError: list index out of range\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nManually adding the fix from https://github.com/ansible/ansible/pull/54338/ allows inventory sync to RHV 4.3 to work.\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI've set the base URL to https://awx.myurl.com but when I try to authenticate with Azure AD (which shows the https:// url in the callback url) it sends the callback url as http://\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.9\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Firefox and Vivaldi\r\n\r\n##### STEPS TO REPRODUCE\r\nSet AWX base URL to https://awx.myurl.com, create Azure AD app. Go to Settings > Authentication. See the callback URL as https://, save and logout. On the login page click Login with Azure and get the following error:\r\n\r\n```Sign in\r\n\r\nSorry, but we’re having trouble signing you in.\r\nAADSTS50011: The reply url specified in the request does not match the reply urls configured for the application: 'xxxxxxxxxxxx'. \r\n```\r\nThen looking at the actual url I see that it send the http:// url and not the https:// url\r\n\r\n##### EXPECTED RESULTS\r\n \r\nTo be logged in via Azure AD SSO\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWrong callback URL sent.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWhen syncing custom inventory scripts from Git, the script may not have the execution bit set (i.e. `chmod +x`).  \r\n\r\nUsers may run into this issue because of execution permissions:\r\n~~~\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\n[WARNING]:  * Failed to parse\r\n/var/lib/awx/projects/_6__github/scripts/custom_inv1.py with script plugin:\r\nproblem running /var/lib/awx/projects/_6__github/scripts/custom_inv1.py --list\r\n([Errno 13] Permission denied)\r\n~~~\r\n\r\nPer a customer's request, they thought it would be nice if a  `chmod +x` command were executed on custom inventory scripts being pulled down from Git."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nSee this video: https://petr.insw.cz/tmp/awx_bug.mov\r\n\r\nYou can see that there is a team existing - with 2 users, who are admins in their organization, but not AWX system admins. They are automatically also admins of the team.\r\n\r\nThen I open inventory belonging to completely different organization and using permission system I grant their TEAM use and read permissions.\r\n\r\nInstead the UI starts showing them as admins of inventory WITH NO option to remove them from there.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 5.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.1\r\n* Operating System: RedHat\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a new organization, add some users there. Create a new team in this organization.\r\n\r\nGrant any permissions to this new team on any inventory - they will become admins instead\r\n\r\n##### EXPECTED RESULTS\r\nI expect team permissions to be granted instead\r\n\r\n##### ACTUAL RESULTS\r\nUsers became \"non-team\" local admins of inventory - or it appear so in UI (not sure if they really have admin powers)\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis strange behaviour is happening since very early AWX versions, to be honest I think it was always broken, I reported this in past, but nobody cared. Hopefully this video will make clear what is wrong.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nMultiple \"Invalid Field\" responses for various SAML configuration parameters.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* PATCH to /api/v2/settings/saml\r\n```\r\n{\r\n\r\n    \"SOCIAL_AUTH_SAML_ORGANIZATION_ATTR\": {\r\n        \"saml_attr\": \"Orgs\",\r\n        \"saml_admin_attr\": \"Admins\"\r\n    },\r\n    \"SOCIAL_AUTH_SAML_TEAM_ATTR\": {\r\n        \"team_org_map\": [\r\n            {\r\n                \"organization\": \"Red Hat\",\r\n                \"team\": \"Marketing\"\r\n            },\r\n            {\r\n                \"organization\": \"Red Hat\",\r\n                \"team\": \"Human Resources\"\r\n            },\r\n            {\r\n                \"organization\": \"Red Hat\",\r\n                \"team\": \"Engineering\"\r\n            },\r\n            {\r\n                \"organization\": \"Ansible\",\r\n                \"team\": \"Engineering\"\r\n            },\r\n            {\r\n                \"organization\": \"Ansible\",\r\n                \"team\": \"Quality Engineering\"\r\n            },\r\n            {\r\n                \"organization\": \"Ansible\",\r\n                \"team\": \"Sales\"\r\n            }\r\n        ]\r\n    }\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* 200 \r\n\r\n##### ACTUAL RESULTS\r\n\r\n400 BAD Request\r\n```\r\n{\r\n    \"SOCIAL_AUTH_SAML_ORGANIZATION_ATTR\": {\r\n        \"saml_admin_attr\": [\r\n            \"Invalid field.\"\r\n        ],\r\n        \"saml_attr\": [\r\n            \"Invalid field.\"\r\n        ]\r\n    },\r\n    \"SOCIAL_AUTH_SAML_TEAM_ATTR\": {\r\n        \"team_org_map\": [\r\n            \"Invalid field.\"\r\n        ]\r\n    }\r\n}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPossibly due to Django + package upgrades.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWhen a very huge job output, I would like to see only `changed` and `failed` without `ok` tasks.\r\n\r\nIn the upper left of the box there is a `+` / `-` icon, how about `changed` button or icon like that?\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nInventories sourced from project SCM do not currently support vault credentials. When using inventory plugins with secrets within the yaml spec files, there is no way to cleanly decrypt the vaulted file to allow the plugin to run its course.\r\n\r\nCustom credentials are also not an option as AWX/Tower reserves all environment variables starting with `ANSIBLE_`, so there is no clear way to dynamically create a passwords file for vault from a custom credential."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAdd a prompt on launch option for username within machine credentials"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nAdd organization, team, and RBAC mapping to RADIUS/TACACS auth provider."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe UI is not showing content in the credential box in the UI for supported sources like gce\r\n\r\nThis seems to be because the API gives an empty dictionary where it should summarize that credential in `summary_fields`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nNavigate to a gce inventory source in the UI or API browser\r\n\r\nlook at the structure you get back\r\n\r\n##### EXPECTED RESULTS\r\n\r\ngce sources require a credential, so you probably had a credential, so it should be in summary_fields\r\n\r\n##### ACTUAL RESULTS\r\n\r\nnon-null `credential` field, but `credential` in summary fields is empty\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```json\r\n{\r\n    \"id\": 8,\r\n    \"type\": \"inventory_source\",\r\n    \"url\": \"/api/v2/inventory_sources/8/\",\r\n    \"related\": {\r\n        \"named_url\": \"/api/v2/inventory_sources/elijah_gce_inv++Inventory - FunnyGladય++Organization - TieSuckヿ/\",\r\n        \"created_by\": \"/api/v2/users/1/\",\r\n        \"modified_by\": \"/api/v2/users/1/\",\r\n        \"credential\": \"/api/v2/credentials/3/\",\r\n        \"last_job\": \"/api/v2/inventory_updates/2/\",\r\n        \"update\": \"/api/v2/inventory_sources/8/update/\",\r\n        \"inventory_updates\": \"/api/v2/inventory_sources/8/inventory_updates/\",\r\n        \"schedules\": \"/api/v2/inventory_sources/8/schedules/\",\r\n        \"activity_stream\": \"/api/v2/inventory_sources/8/activity_stream/\",\r\n        \"hosts\": \"/api/v2/inventory_sources/8/hosts/\",\r\n        \"groups\": \"/api/v2/inventory_sources/8/groups/\",\r\n        \"notification_templates_any\": \"/api/v2/inventory_sources/8/notification_templates_any/\",\r\n        \"notification_templates_success\": \"/api/v2/inventory_sources/8/notification_templates_success/\",\r\n        \"notification_templates_error\": \"/api/v2/inventory_sources/8/notification_templates_error/\",\r\n        \"inventory\": \"/api/v2/inventories/2/\",\r\n        \"last_update\": \"/api/v2/inventory_updates/2/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"inventory\": {\r\n            \"id\": 2,\r\n            \"name\": \"Inventory - FunnyGladય\",\r\n            \"description\": \"ShoppingArgumentReturnChildhoodBreathManyTraditionPostScreenWordଝ\",\r\n            \"has_active_failures\": false,\r\n            \"total_hosts\": 18,\r\n            \"hosts_with_active_failures\": 0,\r\n            \"total_groups\": 61,\r\n            \"groups_with_active_failures\": 0,\r\n            \"has_inventory_sources\": true,\r\n            \"total_inventory_sources\": 1,\r\n            \"inventory_sources_with_failures\": 0,\r\n            \"organization_id\": 3,\r\n            \"kind\": \"\"\r\n        },\r\n        \"credential\": {},\r\n        \"last_job\": {\r\n            \"id\": 2,\r\n            \"name\": \"Inventory - FunnyGladય - elijah_gce_inv\",\r\n            \"description\": \"HideEarthTonightHighlightIndustryConcentrateHighActionDumpFeed滆\",\r\n            \"finished\": \"2019-06-12T18:23:26.147879Z\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false,\r\n            \"license_error\": false\r\n        },\r\n        \"last_update\": {\r\n            \"id\": 2,\r\n            \"name\": \"Inventory - FunnyGladય - elijah_gce_inv\",\r\n            \"description\": \"HideEarthTonightHighlightIndustryConcentrateHighActionDumpFeed滆\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false,\r\n            \"license_error\": false\r\n        },\r\n        \"created_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"modified_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"user_capabilities\": {\r\n            \"edit\": true,\r\n            \"delete\": true,\r\n            \"start\": true,\r\n            \"schedule\": true\r\n        }\r\n    },\r\n    \"created\": \"2019-06-12T18:19:46.794703Z\",\r\n    \"modified\": \"2019-06-12T18:19:46.794712Z\",\r\n    \"name\": \"elijah_gce_inv\",\r\n    \"description\": \"HideEarthTonightHighlightIndustryConcentrateHighActionDumpFeed滆\",\r\n    \"source\": \"gce\",\r\n    \"source_path\": \"\",\r\n    \"source_script\": null,\r\n    \"source_vars\": \"\",\r\n    \"credential\": 3,\r\n    \"source_regions\": \"\",\r\n    \"instance_filters\": \"\",\r\n    \"group_by\": \"\",\r\n    \"overwrite\": false,\r\n    \"overwrite_vars\": false,\r\n    \"custom_virtualenv\": null,\r\n    \"timeout\": 0,\r\n    \"verbosity\": 1,\r\n    \"last_job_run\": \"2019-06-12T18:23:26.147879Z\",\r\n    \"last_job_failed\": false,\r\n    \"next_job_run\": null,\r\n    \"status\": \"successful\",\r\n    \"inventory\": 2,\r\n    \"update_on_launch\": false,\r\n    \"update_cache_timeout\": 0,\r\n    \"source_project\": null,\r\n    \"update_on_project_update\": false,\r\n    \"last_update_failed\": false,\r\n    \"last_updated\": \"2019-06-12T18:23:26.147879Z\"\r\n}\r\n```\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCurrently, a Credential has a `kind` field that maps to what used to be known as the `kind` on the CredentialType, but is now known as `namespace` on the CredentialType (whereas `kind` onthe CredentialType is something else).\r\n\r\nAdditionally, attempting to filter on credential.kind does not work/is broken.\r\n\r\nProposal:\r\n- [ ] Remove `kind` attribute from Credential\r\n- [ ] Add summary field of CredentialType to Credential\r\n     - [ ] Include `namespace` in this summary field\r\n- [ ] Add to any release notes that users that want to filter Credentials by what used to be known as `kind` should now use `Credential.summary_fields.credential_type.namespace` (or however that should actually be written in the query)\r\n\r\nAdditional work:\r\n- [ ] Update any calls in UI to use this new semantic"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen testing https://github.com/ansible/awx/issues/2891 I noticed that project updates do not show credential in the expanded list view.\r\n\r\n![Screenshot from 2019-06-06 16-50-04](https://user-images.githubusercontent.com/29239279/59066123-4ebf6880-887c-11e9-9c19-9da5fbd7ee74.png)\r\n\r\n1st item is project update with scm credential\r\n2nd item is inventory with credential\r\n3rd item is job from JT with credential.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* AWX install method: local docker on linux\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate a SCM credential\r\nCreate a project and use the SCM credential.\r\nRun an update\r\nGo to Jobs list view.\r\nClick on expanded list view.\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nShows credentials like other jobs\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nNot shown\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nI do want to note it IS shown on the project update itself.\r\n![Screenshot from 2019-06-06 17-01-00](https://user-images.githubusercontent.com/29239279/59066287-acec4b80-887c-11e9-883f-4cbd15aaa4b6.png)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\nRemove the `any` state from `unifiedjobtemplate_notification_templates` and `organization_notification_templates`. \r\n\r\n##### SUMMARY\r\nThe `any` state does not apply to _all_ states, it only applies to one of two _finished_ states (`success`/`error`).  This can be confusing.  \r\n\r\nRemoving the `any` state will enable the user to define what they mean by `any`, e.g., it's truly ALL of the states or it's only on `job finish` (the success/error/started states are additive, so they can select as many as they want).\r\n\r\nNote on backwards compatibility: After the related data migration has been applied, all of the `_any` relationships will automatically be turned into two relationships, one success and one error."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n/usr/bin/awx-manage inventory_import in a playbook fails \r\n\r\nCause: AWX 4.0.0 has pre-installed venv for Python3(AWX) and Python2(Ansible), but requires venv for Python3(Ansible). \r\n\r\nI have installed the venv for Python3(Ansible) and this fixes the problem but it should be pre-installed to enable std functionality. so I don't have to manually install on awx-task and awx-web images. \r\n\r\nI would like the venv for Python3(Ansible) pre-installed with the images.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method:docker on linux, \r\n* Ansible version:  2.7.9\r\n* Operating System: RHEL 7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nlocal_action: command /usr/bin/awx-manage inventory_import --source /tmp/Patching_Inventories_updates/\"{{ Inventory_Name }}\".txt --inventory-name \"{{ Inventory_Name }}\"\r\n\r\n##### EXPECTED RESULTS\r\n\r\ninventory is imported\r\n\r\n##### ACTUAL RESULTS\r\n\r\nInventory import fails.\r\nAfter I install the venv for Python3(Ansible) and select the ANSIBLE ENVIRONMENT in the Template, it works.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe insights `job_counts.json' are not being updated properly due to a default order_by(\"id\") on the UnifiedJob model, which django's ORM interprets as \"group_by id\".  We instead want to group by \"status\" here.    \r\n\r\n```\r\nIn [7]: dict(UnifiedJob.objects.values_list('status').annotate(Count('status')).order_by('id'))\r\nOut[7]: {'failed': 1, 'successful': 1}\r\n\r\nIn [6]: connection.queries\r\nOut[6]: \r\n[{'sql': 'SELECT \"main_unifiedjob\".\"status\", COUNT(\"main_unifiedjob\".\"status\") AS \"status__count\" FROM \"main_unifiedjob\" GROUP BY \"main_unifiedjob\".\"id\" ORDER BY \"main_unifiedjob\".\"id\" ASC',\r\n  'time': '0.005'}]\r\n\r\n```\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Run multiple jobs\r\n2. run awx-manage gather_analytics\r\n3. tar xfvz the analytics tar.gz\r\n4. `job_counts.json | python -m json.tool` should reflect the correct number of jobs in \"status\" and \"launch_type\".\r\n\r\n##### EXPECTED RESULTS\r\n\r\nShould show the correct number of jobs in \"status\" and \"launch_type\"\r\n\r\n```\r\n{\r\n    \"launch_type\": {\r\n        \"manual\": 44,\r\n        \"workflow\": 15\r\n    },\r\n    \"status\": {\r\n        \"failed\": 10,\r\n        \"successful\": 49\r\n    },\r\n    \"total_jobs\": 59\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\nCaps at 1: \r\n\r\n```\r\n{'launch_type': {'manual': 1},\r\n 'status': {'running': 1, 'successful': 1},\r\n 'total_jobs': 33}\r\n```\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\n1. start AWX\r\n2. run some jobs\r\n3. \r\n```\r\nbash-4.2$ find /tmp/ansible_runner_pi_*\r\n/tmp/ansible_runner_pi_30tzw1rd\r\n/tmp/ansible_runner_pi_30tzw1rd/tmpi1i_fzlu\r\n/tmp/ansible_runner_pi_30tzw1rd/tmp0f1ilw2p\r\n/tmp/ansible_runner_pi_30tzw1rd/tmp2ulnj3we\r\n/tmp/ansible_runner_pi_30tzw1rd/tmp2ulnj3we/awx_56_8yem_qjj\r\n/tmp/ansible_runner_pi_30tzw1rd/tmp2ulnj3we/.ansible\r\n/tmp/ansible_runner_pi_30tzw1rd/tmp2ulnj3we/.ansible/tmp\r\n/tmp/ansible_runner_pi_30tzw1rd/tmp8llrycho\r\n/tmp/ansible_runner_pi_30tzw1rd/tmpqtoj18nq\r\n/tmp/ansible_runner_pi_86d2289s\r\n/tmp/ansible_runner_pi_86d2289s/tmp18frpsw3\r\n/tmp/ansible_runner_pi_86d2289s/tmpomicqsjd\r\n/tmp/ansible_runner_pi_86d2289s/tmpx6cizphr\r\n/tmp/ansible_runner_pi_86d2289s/tmpx6cizphr/awx_55_v_wfspd3\r\n/tmp/ansible_runner_pi_86d2289s/tmpx6cizphr/.ansible\r\n/tmp/ansible_runner_pi_86d2289s/tmpx6cizphr/.ansible/tmp\r\n/tmp/ansible_runner_pi_86d2289s/tmppcu0cerh\r\n/tmp/ansible_runner_pi_86d2289s/tmpyu6aoyxd\r\n/tmp/ansible_runner_pi_912tri2k\r\n/tmp/ansible_runner_pi_912tri2k/tmppxn6_boj\r\n/tmp/ansible_runner_pi_912tri2k/tmp_l83bqj2\r\n/tmp/ansible_runner_pi_912tri2k/tmp_l83bqj2/_4__demo_project\r\n/tmp/ansible_runner_pi_912tri2k/tmpgbz5b15_\r\n/tmp/ansible_runner_pi_912tri2k/tmpgbz5b15_/awx_54_twtat2xa\r\n/tmp/ansible_runner_pi_912tri2k/tmpgbz5b15_/.ansible\r\n/tmp/ansible_runner_pi_912tri2k/tmpgbz5b15_/.ansible/tmp\r\n/tmp/ansible_runner_pi_912tri2k/tmpgbz5b15_/.ansible/tmp/ansible-tmp-1559750417.89-227469902888907\r\n/tmp/ansible_runner_pi_912tri2k/tmpgbz5b15_/.ansible/tmp/ansible-tmp-1559750417.89-227469902888907/AnsiballZ_setup.py\r\n/tmp/ansible_runner_pi_912tri2k/tmpj4aj_sxx\r\n/tmp/ansible_runner_pi_912tri2k/tmpaaauedm1\r\n...\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: head of devel\r\n* AWX install method: dev env\r\n* Ansible version:  2.8-ish\r\n* Operating System: F30 (host) CentOS 7 (container)\r\n* Web Browser: doesn't matter\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nsee above\r\n\r\n##### EXPECTED RESULTS\r\n\r\nno leftover crud in /tmp\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen using multiple vault credentials with a \"period\" (.) in the vault-id name AWX fails to find the matching vault to decrypt.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.4\r\n* Operating System: Centos\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUsing the same playbook [here](https://github.com/ansible/test-playbooks/blob/master/multivault.yml) , just change the vault id's to linux.first and linux.second\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPlaybook should work and able to decrypt the vars\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe first one succeeds, but the second one does not.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n- I will attach full logs from a failed and a successful run in AWX where all I did was change the names to not include a period\r\n- Using periods in the name works fine in Ansible CLI via ansible-playbook, so I believe the issue must be with AWX itself\r\n- alternate fix would be to disable the ability to enter a vault-id with a period in it (and whatever other chars cause this issue) from the api\r\n- below are the highlight of the issue.  You can see that although the vault is found it seems to truncate it and remove the period and anything following from the name.  (Note my example uses linux.common and linux.nonprod as the vault ids)\r\n\r\n\r\n```\r\n#### FIRST PASSWORD\r\nFound a vault_id (linux.nonprod) in the vaulttext\r\nFound a vault_id (linux.nonprod) in the vault text, but we do not have a associated secret (--vault-id)\r\nTrying to use vault secret=(<ansible.parsing.vault.PromptVaultSecret object at 0x7f957ee32110>) id=linux to decrypt None\r\nTrying secret <ansible.parsing.vault.PromptVaultSecret object at 0x7f957ee32110> for vault_id=linux\r\nDecrypt successful with secret=<ansible.parsing.vault.PromptVaultSecret object at 0x7f957ee32110> and vault_id=linux\r\n\r\n### second password\r\nFound a vault_id (linux.common) in the vaulttext\r\nFound a vault_id (linux.common) in the vault text, but we do not have a associated secret (--vault-id)\r\nTrying to use vault secret=(<ansible.parsing.vault.PromptVaultSecret object at 0x7f957ee32110>) id=linux to decrypt None\r\nTrying secret <ansible.parsing.vault.PromptVaultSecret object at 0x7f957ee32110> for vault_id=linux\r\nTried to use the vault secret (linux) to decrypt (None) but it failed. Error: HMAC verification failed: Signature did not match digest.\r\nTrying to use vault secret=(<ansible.parsing.vault.PromptVaultSecret object at 0x7f957ee32190>) id=linux to decrypt None\r\nTrying secret <ansible.parsing.vault.PromptVaultSecret object at 0x7f957ee32190> for vault_id=linux\r\nTried to use the vault secret (linux) to decrypt (None) but it failed. Error: HMAC verification failed: Signature did not match digest.\r\n```\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\n```class JobTemplate(UnifiedJobTemplate, JobOptions, SurveyJobTemplateMixin, ResourceMixin, CustomVirtualEnvMixin, RelatedJobsMixin):\r\n    '''\r\n    A job template is a reusable job definition for applying a project (with\r\n    playbook) to an inventory source with a given credential.\r\n    '''\r\n    FIELDS_TO_PRESERVE_AT_COPY = [\r\n        'labels', 'instance_groups', 'credentials', 'survey_spec'\r\n    ]\r\n    FIELDS_TO_DISCARD_AT_COPY = ['vault_credential', 'credential']\r\n    SOFT_UNIQUE_TOGETHER = [('polymorphic_ctype', 'name')]\r\n```\r\nIdeally, it would be unique across an org (or a project?)\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nWe need an option to give permission to team or user to be able to create a smart inventory from already existing inventory.\r\n\r\nNowadays we can assign only Inventory Admin role to the whole Organization, which gives permission to add/edit/delete all inventories in that Organization and we need users/teams to be able to add smart inventory, but not edit/delete current ones.\r\n\r\n##### Info\r\nAWX version: 4.0.0"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCurrently we can only use email(with regular expression) to map AD user with Org and Team when using Azure AD authentication method in Ansible Tower. The purpose of this RFE is to map AD user  using AD groups with Org and Team when using Azure AD method."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nConfusing UI if you cancel a job while it is still in \"pending\" state, caused by API behavior.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLaunch a job that is blocked by some other job, so it remains in \"pending\" (or send to an instance group with no capacity), and then cancel it.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nMostly null fields related to started, finished, etc.\r\n\r\nThe job never started and never finished.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe UI shows that the job finished, see 7844\r\n\r\n![Screen Shot 2019-06-03 at 8 50 50 AM](https://user-images.githubusercontent.com/1385596/58803296-12baa800-85dd-11e9-999f-a678ce860c2e.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nCaused by the API fields.\r\n\r\n```json\r\n    \"scm_type\": \"git\",\r\n    \"scm_url\": \"https://github.com/ansible/test-playbooks.git\",\r\n    \"scm_branch\": \"\",\r\n    \"scm_clean\": false,\r\n    \"scm_delete_on_update\": false,\r\n    \"credential\": null,\r\n    \"timeout\": 0,\r\n    \"unified_job_template\": 3838,\r\n    \"launch_type\": \"manual\",\r\n    \"status\": \"canceled\",\r\n    \"failed\": true,\r\n    \"started\": null,\r\n    \"finished\": \"2019-06-03T12:39:05.272329Z\",\r\n    \"elapsed\": 0.0,\r\n    \"job_args\": \"\",\r\n    \"job_cwd\": \"\",\r\n    \"job_env\": {},\r\n    \"job_explanation\": \"\",\r\n    \"execution_node\": \"\",\r\n    \"result_traceback\": \"\",\r\n    \"event_processing_finished\": true,\r\n    \"project\": 3838,\r\n    \"job_type\": \"check\",\r\n```\r\n\r\nExpectation is that the `finished` field should remain null.\r\n\r\nPreviously @ryanpetrello made the suggestion\r\n\r\n> Seems like if we really wanted to have accurate data, we'd want another column to record the \"canceled_on\" datestamp.\r\n\r\nThis issue also makes the argument for an independent field to track canceled time. (but we may prefer to track that as a separate enhancement)"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nRun an adhoc command that specifies a credential with a username pulled from e.g., HashiCorp Vault.  It **does** work for a Job Template:\r\n\r\n<img width=\"268\" alt=\"image\" src=\"https://user-images.githubusercontent.com/214912/58642049-78035600-82ca-11e9-9d3d-85e3df293870.png\">\r\n\r\n<img width=\"1090\" alt=\"image\" src=\"https://user-images.githubusercontent.com/214912/58642308-15f72080-82cb-11e9-9ec6-c8b8a1669f6b.png\">\r\n\r\n...but it doesn't work for adhoc:\r\n\r\n<img width=\"1279\" alt=\"image\" src=\"https://user-images.githubusercontent.com/214912/58642260-f9f37f00-82ca-11e9-973b-e8803a82e7f5.png\">\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: any\r\n* Ansible version:  any"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThis needs to be done, and the sooner the better\r\n\r\nhttps://github.com/ansible/awx/blob/34c3aaee3d96ed5286924ccf4c91e42a5bc055ad/requirements/requirements.in#L51-L52\r\n\r\nhttps://github.com/ansible/awx/blob/34c3aaee3d96ed5286924ccf4c91e42a5bc055ad/requirements/requirements_ansible.in#L53-L54"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nInclude the ability to check CLR and OCSP for integrations associated to AWX/Tower. For example, validate based on CLR when connecting to log aggregator endpoints."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nnow that browsers have universally adopted CORS, using the `implicit` grant type for obtaining OAuth 2 tokens is not recommended.  We should remove this grant type as an option for Applications.  \r\nhttps://oauth.net/2/grant-types/implicit/\r\n\r\nThe RFC has always advocated for using the Authorization code grant type over the implicit grant type anyways since the implicit grant type is less secure (it returns the token value in the redirect URL)\r\n\r\n\r\n\r\nThings to do:\r\n* remove grant type from application model\r\n* remove from awx docs\r\n* update function tests\r\n* update e2e tests (awx/ui/test/e2e/objects/applications.js)"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nCopy module in playbook not works\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2<\r\n* Operating System: el7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd a task in the playbook to copy a file from ansible awx controller into the remote machine.\r\nDisable job isolation (if required)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFile not found\r\n\r\n\"msg\": \"Could not find or access '/var/lib/awx/projects/_6__tenant/roles/rh/files/openstack.conf' on the Ansible Controller.\\nIf you are using a module and expect the file to exist on the remote, see the remote_src option\",\r\n    \"exception\": \"Traceback (most recent call last):\\n  File \\\"/var/lib/awx/venv/python3-ansible2.6.16-2152019/lib/python3.6/site-packages/ansible/plugins/action/copy.py\\\", line 442, in run\\n    source = self._find_needle('files', source)\\n  File \\\"/var/lib/awx/venv/python3-ansible2.6.16-2152019/lib/python3.6/site-packages/ansible/plugins/action/__init__.py\\\", line 1060, in _find_needle\\n    return self._loader.path_dwim_relative_stack(path_stack, dirname, needle)\\n  File \\\"/var/lib/awx/venv/python3-ansible2.6.16-2152019/lib/python3.6/site-packages/ansible/parsing/dataloader.py\\\", line 322, in path_dwim_relative_stack\\n    raise AnsibleFileNotFound(file_name=source, paths=[to_text(p) for p in search])\\nansible.errors.AnsibleFileNotFound: Could not find or access '/var/lib/awx/projects/_6__tenant/roles/rh/files/openstack.conf' on the Ansible Controller.\\nIf you are using a module and expect the file to exist on the remote, see the remote_src option\\n\",\r\n    \"_ansible_no_log\": false,\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe file must be copied into remote machine\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"EDIT: I have uncomment this line like it's said and relaunch install and I have the exact same issue\r\n`#project_data_dir=/var/lib/awx/projects`\r\n##### ISSUE TYPE\r\nCannot save project\r\n##### SUMMARY\r\n\r\nI have done what it is explained on issue 857 but it doesn't work\r\n\r\n##### ENVIRONMENT\r\n* Ubuntu bionic\r\n* AWX install method:  docker on linux\r\n* Ansible version: ansible 2.8.0\r\n* Operating System:  Ubuntu 18.04.2 LTS\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI have added line like said in issue reported : 857 but after reinstall web GUI doesn't work. \r\nI have added lines in local_docker/main.yml\r\n\r\n```\r\n- import_tasks: set_image.yml\r\n- import_tasks: compose.yml\r\n\r\n- name: Activate AWX Web Container\r\n  docker_container:\r\n    name: awx_web\r\n    state: started\r\n    restart_policy: unless-stopped\r\n    image: \"{{ awx_web_docker_actual_image }}\"\r\n    volumes: \"{{ project_data_dir }}:/var/lib/awx/projects:rw\"\r\n\r\n- name: Activate AWX Task Container\r\n  docker_container:\r\n    name: awx_task\r\n    state: started\r\n    restart_policy: unless-stopped\r\n    image: \"{{ awx_task_docker_actual_image }}\"\r\n    volumes: \"{{ project_data_dir }}:/var/lib/awx/projects:rw\"\r\n```\r\n\r\nWhen I comment line and reinstall it's work fine.\r\n\r\nI have added in inventory But I have still the issue.\r\n`project_data_dir=/opt/awx_projects `\r\n\r\n\r\nI can see folder created test folder in /opt/awx_projects  \r\n```\r\nls /opt/awx_projects/\r\n_6__demo_project145956  _6__demo_project145956.lock  test  test2\r\n```\r\nBut I cannot save the project after selected one When I click on save I have the issue : Failed to update project: 6. PUT status: 400\r\n\r\nI have change rigth to 777 for awx_project folder\r\n\r\n```\r\n/opt$ ls -lrt\r\ntotal 12\r\ndrwxr-xr-x 3 root root 4096 May 16 16:51 snow\r\ndrwx--x--x 4 root root 4096 May 17 16:38 containerd\r\ndrwxrwxrwx 6 root root 4096 May 21 17:04 awx_projects\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCreate manual project\r\n\r\n##### ACTUAL RESULTS\r\n\r\nMount volume and web GUI page not found\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nA strange folder tree appears once the roles are downloaded.. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.8.0\r\n* Operating System: Ubuntu eoan/Debian buster\r\n* Web Browser: chrome Version 74.0.3729.157 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n- Settings/Jobs/Enable Role Download: ON\r\n![Roles download enabled](https://user-images.githubusercontent.com/13176858/57763788-70588480-7702-11e9-96e7-818cf049374a.png)\r\n- create playbooks project:\r\n  + playbooks SCM type: git\r\n  + playbooks SCM URL: valid private URL (not hosted on ansible galaxy)\r\n  + playbooks SCM Update Options:\r\n    * Clean\r\n    * Delete on Update\r\n    * Update Revision on Launch\r\n  + playbooks git repository contains ```roles/requirements.yml```\r\n  ```\r\n  - src: <roles SCM private URL>\r\n    scm: git\r\n  ```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1) playbooks git repository cloned\r\n2) roles downloaded from ```<roles SCM private URL>```\r\n3) the folder tree of the downloaded roles should exactly match the folder tree of the roles within the repository:\r\n```\r\n├── roles/\r\n│   ├── role-name-1\r\n│   ├── role-name-2\r\n│   ├── ...\r\n│   └── requirements.yml\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n1) playbooks git repository cloned, including the file ```roles/requirements.yml```\r\n2) roles are downloaded\r\n3) the folder tree of the downloaded roles does not exactly match the folder tree of the roles within the repository:\r\n```\r\n├── roles\r\n│   ├── git-Roles ------------------> name of the parent folder hosting the git roles repository\r\n│   │   ├── git-Roles --------------> all roles are downloaded except the 'cgit' role\r\n│   │   │   ├── role-name-1\r\n│   │   │   ├── role-name-2\r\n│   │   │   ├── ...\r\n│   │   ├── handlers --------------> from the 'cgit' role\r\n│   │   │   └── main.yml\r\n│   │   ├── meta ------------------> from the 'cgit' role\r\n│   │   │   └── main.yml\r\n│   │   ├── README.md -------------> from the 'cgit' role\r\n│   │   ├── tasks -----------------> from the 'cgit' role\r\n│   │   │   └── main.yml\r\n│   │   ├── tests -----------------> from the 'cgit' role\r\n│   │   │   ├── inventory\r\n│   │   │   └── test.yml\r\n│   │   ├── .travis.yml -----------> from the 'cgit' role\r\n│   │   └── vars ------------------> from the 'cgit' role\r\n│   │       └── main.yml\r\n│   └── requirements.yml\r\n```\r\n\r\n##### SUGGESTION:\r\nThe roles should be cloned within ```<playbook-dir>/roles``` with ```\"git clone <roles SCM URL> .\"``` instead of ```\"git clone <roles SCM URL>\"```\r\n\r\n##### ADDITIONAL INFORMATION:\r\nPrivate git repositories are located on the host running the AWX containers\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONANT NAME\r\n - UI\r\n- API\r\n\r\n##### SUMMARY\r\nWhen using an inventory source script with smart inventory, hosts are not listed on the smart inventory.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1 (reproductible on 2.1.2 too)\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: Windows\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate one inventory with script as source.\r\nCreate one smart inventory with smart host filter name:'MYHOST'. (MYHOST is showing on the search results). Click Save.\r\nGo to HOSTS tab : MYHOST is not listed.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nMYHOST listed on the HOSTS tab.\r\n\r\n(Please note, that using a static inventory and localhost as host filter is working as expected)\r\n\r\n##### ACTUAL RESULTS\r\n\r\nMYHOST is not listed on the HOSTS tab.\r\nIs also not listed on API."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe gce credential injector generates a temporary json file in `GCE_CREDENTIALS_FILE_PATH` but that file is missing needed parameters and has a hard-coded values that are out-of-date\r\n\r\n##### ENVIRONMENT\r\n* Ansible version:  2.7.1\r\n* Operating System: Fedora 30\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Upload GCP credential file for your GCP service account (json format)\r\n2. Create job template with a playbook using one of the new gcp_ modules \r\n2. Run job template\r\n3. Error returned as modules need parameters not sent by temporary cred file created by gce injector:\r\n```ValueError: Service account info was not in the expected format, missing fields token_uri.```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTemporary GCP credential file in created AWX passes the required parameters to gcp_modules and job succeeds\r\n\r\n##### ACTUAL RESULTS\r\n\r\nJob template fails and cannot find the credential information\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe gce injector creates temporary file via `json.dump` containing credential parameters, here:\r\n\r\nhttps://github.com/ansible/awx/blob/f174902bb2d3815b3ec09541fae52a466d7f526c/awx/main/models/credential/injectors.py#L18-L41\r\n\r\nBut the fields created are missing the following keys that exist in current GCP service accounts credential files:\r\n\r\n- private_key_id\r\n- client_id\r\n- auth_uri\r\n- auth_provider_x509_cert_url\r\n- client_x509_cert_url\r\n\r\nAlso, it appears that the value that's hard-coded for `token_uri` has changed to `https://oauth2.googleapis.com/token`"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n1.  Install AWX with many schedules (100+) with this rrule:\r\n```\r\nIn [1]: Schedule.objects.filter(unified_job_template_id=5).count()\r\nOut[1]: 20\r\nIn [2]: Schedule.objects.filter(unified_job_template_id=5).first().rrule\r\nOut[2]: 'DTSTART;TZID=America/New_York:20190517T000000 RRULE:FREQ=HOURLY;INTERVAL=2;COUNT=5'\r\n```\r\n2.  Start the dispatcher manually with `awx-manage run_dispatcher`.\r\n3.  Observe that the jobs do not run until several minutes later.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nRight now, job templates have an implicit organization, based on the organization of its project (and sometimes inventory).\r\n\r\nAn `organization` field will be added directly to the job template. In a data migration, the JT's project's organization will be used for the default value. From then on, the JT organization will be used instead of the project organization for permissions considerations.\r\n\r\nThis issue should replace:\r\n\r\n - https://github.com/ansible/awx/issues/458 org admins cannot see jobs after related items are deleted\r\n - https://github.com/ansible/awx/issues/3432 job templates are globally unique, whereas they should be unique to each organization\r\n\r\nSome more speculative statements about changes which will come with this:\r\n\r\n - using projects and inventories in JTs from organizations other than the JT organization will be allowed (important question, ping @wenottingham)\r\n - since jobs inherit permissions rules from their job templates, it follows that the `organization` field should also be added to jobs, which is copied on launch. Permission rules will reference this organization\r\n - changing the organization of the JT may be allowed (but if it does, the organization of jobs from it will stay the same)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWe recently removed celery from awx, but we still use celerybeat.  Let's replace celerybeat with something more stable (https://github.com/celery/celery/issues/4777) and with more precision."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nFor debugging purposes, there should be an easy place to get all status transitions for a job, which nodes in the cluster performed the transition, and why.\r\n\r\nThis will cover what we have been relying on these log messages for:\r\n\r\nhttps://github.com/ansible/awx/blob/003ec64413bace1a41be117155a3864e9dbd3910/awx/main/scheduler/task_manager.py#L236\r\n\r\nhttps://github.com/ansible/awx/blob/003ec64413bace1a41be117155a3864e9dbd3910/awx/main/scheduler/task_manager.py#L242-L243\r\n\r\n(note: this message should contain more info, because the job type does not support isolation, it is being sent to the control IG, and some verbiage about this is needed for the user to understand what happened)\r\n\r\nhttps://github.com/ansible/awx/blob/003ec64413bace1a41be117155a3864e9dbd3910/awx/main/scheduler/task_manager.py#L248-L249\r\n\r\nhttps://github.com/ansible/awx/blob/003ec64413bace1a41be117155a3864e9dbd3910/awx/main/scheduler/task_manager.py#L254-L255\r\n\r\nhttps://github.com/ansible/awx/blob/003ec64413bace1a41be117155a3864e9dbd3910/awx/main/scheduler/task_manager.py#L298-L302\r\n\r\nhttps://github.com/ansible/awx/blob/003ec64413bace1a41be117155a3864e9dbd3910/awx/main/scheduler/task_manager.py#L312-L316\r\n\r\nhttps://github.com/ansible/awx/blob/003ec64413bace1a41be117155a3864e9dbd3910/awx/main/scheduler/task_manager.py#L181\r\n\r\nhttps://github.com/ansible/awx/blob/91968a09c8e98cef65667e7ea1743cc96047003e/awx/main/tasks.py#L517-L518\r\n\r\nThere are more than these.\r\n\r\nThe idea is to be able to see all such event details for a single job without having to fish through the logs on each node in the cluster."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n Currently the sliced portions of the job show as individual objects from the API which require extra queries to determine the overall sliced job result.\r\n\r\nProvide an API endpoint which displays the total number of hosts managed, succeeded, and failed in a sliced job.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nWhen running AWX behind a reverse proxy on a subdomain, the UI is broken due to wrong URL in links to static assets. The API is working okay.\r\nsee #631 but that not resolved me issue.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.9\r\n* Operating System: Ubuntu 18.04.2 LTS\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\nconfigure nginx with :\r\n```bash\r\n# locations.conf\r\n...\r\nlocation /awx/ {\r\n        proxy_pass http://awx_web_ip:80/;\r\n        proxy_http_version 1.1;\r\n        proxy_set_header   Host               $host;\r\n        proxy_set_header   X-Real-IP          $remote_addr;\r\n        proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;\r\n        proxy_set_header   X-Forwarded-Proto  $scheme;\r\n        proxy_set_header   Upgrade            $http_upgrade;\r\n        proxy_set_header   Connection         \"upgrade\";\r\n      }\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nlogin page an navigation work well\r\n\r\n##### ACTUAL RESULTS\r\nall assets are not loaded, references to static is write in \r\nheader to '/static/'\r\n\r\nsee index:\r\n```html\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n    <link rel=\"shortcut icon\" href=\"/static/assets/favicon.ico?v=4.0.0.0\" />\r\n    <script>\r\n        var $basePath = '/static/';\r\n        window.liveUpdates = \"True\" === \"False\" ? false : true;\r\n    </script>\r\n    \r\n        <link href=\"/static/css/vendor.8778ab7be905d20927b3.css\" rel=\"stylesheet\" />\r\n    \r\n        <link href=\"/static/css/app.bd927cc14dd2d4bf0c9a.css\" rel=\"stylesheet\" />\r\n    \r\n    \r\n        <script src=\"/static/js/vendor.8778ab7be905d20927b3.js\"></script>\r\n    \r\n        <script src=\"/static/js/app.bd927cc14dd2d4bf0c9a.js\"></script>\r\n    \r\n</head>\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nall works well if I put location / but I have many other website behind nginx.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nSome organizations would prefer to use CTR rather than CBC."},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI followed all the steps at https://github.com/ansible/awx/blob/devel/CONTRIBUTING.md and was able to set up the project locally. That much works.\r\nHowever, when I started to modify python code, to see the changes I have to restart the whole process (tools_awx_1). I went to the irc (which is not very active) and couldn't find a way to enable the development server. Refreshing changes manually is very slow, and I don't think that every contributor does it that way.\r\nI would like to have a little more information in the document about how to work and contribute to the project, because as it is, I would spend most of my time refreshing a server instead of making progress.\r\nI noticed that there is something that should be reloading the code on changes (see additional information).\r\nMaybe the code I am modifying is not running on uwsgi? (not familiar with the architecture yet, sorry). If the code needs to be refreshed on some async task runner (celery, maybe?), that is not happening.\r\nJust fyi, I am trying to change notifications a little: awx/notifications/slack_backend.py\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker for mac\r\n* Ansible version: 2.7.10\r\n* Operating System: Macos\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nFollow steps at https://github.com/ansible/awx/blob/devel/CONTRIBUTING.md to setup server. Then change awx/notifications/slack_backend.py (with the dev server running)\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nThe servers are reloaded, and the new code changes are reflected in the site.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nIt seems that uwsgi is reloaded, but code changes are still not reflected.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\n![image](https://user-images.githubusercontent.com/5531776/57316034-8343d700-70ba-11e9-8e00-3871bd8e37eb.png)"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nStrings look odd in their current format in activity streams when assigning a role to a resource, whether it is a project, inventory, credential, or job template.\r\n\r\nThe first string in the row here shows what I mean:\r\n> associated admin admin_role to machine-credential\r\nIn generic terms:\r\n> associated [user] [role name] to [resource]\r\n1. Is admin_role (the role name) supposed to be written out like the way it is in the screenshot?\r\n2. The phrasing is odd. This should be rephrased to something like:\r\n> associated [resource] [role name] with [user]\r\nWritten out, it would look like\r\n> associated machine-credential admin_role to admin\r\n![Screenshot from 2019-05-06 15-50-34](https://user-images.githubusercontent.com/19942822/57252376-f1848d00-7019-11e9-96ab-a70755683706.png)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n* AWX install method: docker on linux\r\n* Operating System: Fedora 30\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a resource, like a credential.\r\n2. Assign role to it.\r\n3. Visit the activity stream for the resource."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nRelated to https://github.com/ansible/awx/issues/3679\r\n\r\nWhen trying to reorder instance groups in a JT, Inventory, or Organization to select a \"default\", saving the reordered group appears to always reorder according to IG id. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.4\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create at least 2 instance groups in AWX\r\n2. Navigate to Organizations \r\n3. Remove the default (`tower`) from the list of IGs.\r\n4. Save\r\n5. Add the secondary IGs, and add `tower` _last_ so it appears as:\r\n```\r\nx test\r\nx new-test\r\nx tower\r\n```\r\n6. Save\r\n\r\n##### EXPECTED RESULTS\r\nOrder is maintained after the save\r\n\r\n##### ACTUAL RESULTS\r\n`tower` reverts to the first spot\r\n\r\n##### ADDITIONAL INFORMATION\r\nAppears to be coinciding with the IG id from the database:\r\n```\r\nawx=> select id, name from main_instancegroup;\r\n-[ RECORD 1 ]---\r\nid   | 1\r\nname | tower\r\n-[ RECORD 2 ]---\r\nid   | 2\r\nname | test\r\n-[ RECORD 3 ]---\r\nid   | 3\r\nname | new-test\r\n-[ RECORD 4 ]---\r\nid   | 4\r\nname | supertest\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n - Notification with type \"Webhook\" against https services with self-signed certificates will fail with error message:\r\n  ```awx.main.tasks Send Notification Failed (\"bad handshake: Error([('SSL routines', 'tls_process_server_certificate', 'certificate verify failed')],)\",)```\r\n\r\n - This PR will add an addiditonal checkbox to disable the verify process of ssl certificates within the send request.\r\n \r\n - Feature copied from other already existing notification types.\r\n\r\n##### ENVIRONMENT\r\n - AWX Version: [4.0.0](https://github.com/ansible/awx/tree/4.0.0)"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI am trying to login with SAML and although my user logs in successfully I am receiving 502 error. Same thing does not happen with other users.\r\n\r\nLogs Sample:\r\n```\r\n2019-05-06 09:11:40,603 INFO     awx.sso.views User **** logged in\r\n2019/05/06 09:11:40 [error] 136#0: *2704 upstream sent too big header while reading response header from upstream, client: 172.19.0.7, server: _, request: \"GET /sso/complete/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"*******\", referrer: \"*****\" [pid: 140|app: 0|req: 400/1218] 172.19.0.7 () {54 vars in 1863 bytes} [Mon May  6 09:11:40 2019] GET /sso/complete/ => generated 0 bytes in 92 msecs (HTTP/1.1 301) 10 headers in 5267 bytes (1 switches on core 0)\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.1\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Firefox, Chromium\r\n\r\n##### ADDITIONAL INFORMATION\r\nBased on Google search I am suspecting that  an increase in `proxy_buffer_size` is required to nginx configuration of awx_web, but I am opening the issue to be sure."},{"labels":["api",null,null,null,null],"text":"#Steps To Reproduce\r\nPrecondition: Organization with 2 member, 2 system admins and one of those system admins is given the member role.\r\n1. As a system admin, view the /organizations/N/users page. Note that 4 Users are shown in the 'Organization Users' view\r\n2. On the organization view, on the 'Org List Subpane' and note that the 'User Count' is 3.\r\n\r\n<img width=\"1167\" alt=\"screen shot 2018-04-13 at 11 01 46 am\" src=\"https://user-images.githubusercontent.com/12446869/38742866-a0712db4-3f0b-11e8-9296-ad710ad8c19a.png\">\r\n\r\nThis count is consistent with the Organization Detail API.\r\n\r\n#Expected Results\r\nThe expected behavior is that all users of an organization would be included in that count OR not shown as part of the org users list UNLESS they are a member of an org\r\n\r\n#Actual Results\r\nSystem admins are displayed on the 'Organization Users' view **in addition** to all other org members. They are indirect members but can also be direct members to an org. \r\nThe 'User Count' for the Org List Subpane only displays direct memberships. This is inconsistent.\r\n\r\n#Additional Information\r\nThis is also inconsistent with the System Admin View. All sysadmins are implicitly Org Admins but not listed. https://cl.ly/072s1O2V0Z0c\r\n"},{"labels":["api",null,null,null,null],"text":"As per https://github.com/ansible/tower/issues/2061#issuecomment-416343623 , https://github.com/ansible/tower/issues/2061#issuecomment-417378475, https://github.com/ansible/tower/issues/2061#issuecomment-417419818 opening remaining issue as separate ticket.\r\n\r\ni.e.\r\n\r\nPost second round of translations, tested this bug report with Japanese google-chrome.\r\n\r\nNow, most of the bullets (as listed in comment zero of this bug report) appear localized in Japanese, except for the following screen(s) (appear in English):\r\n\r\n\r\nand \r\n\r\nas per https://github.com/ansible/tower/issues/2061#issuecomment-401374808 , i request to re-consider the screenshots attached towards following bullets (as UI appears in English for the said screens):\r\n\r\n> (4) Tower Dashboard and interface -> Activity Stream window\r\n\r\n\r\n\r\n-> all Actions in EVENT column:\r\n\r\n![screenshot from 2018-06-28 12-04-03](https://user-images.githubusercontent.com/12151785/42093700-df154f36-7bca-11e8-8c87-ec5c66c6a20a.png)\r\n\r\n\r\n-> at the right side pagination, ITEMS  1 - 20 of 99 VIEW PER PAGE ( '**of**' needs to be gettext-ed):\r\n![screenshot from 2018-06-29 07-29-38](https://user-images.githubusercontent.com/12151785/42105085-b642ab2c-7bec-11e8-9c2d-eaa933cbfaaa.png)\r\n\r\n\r\n_Originally posted by @sshedmake in https://github.com/ansible/tower/issues/2061#issuecomment-416343623_\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen using Satellite 6 as a dynamic inventory, and with the source varibles set as the following.\r\n\r\n> satellite6_want_hostcollections: True\r\n> host_filters: not (host_collection=\"virt-who\" or host_collection=\"decomm\" or host_collection=\"unmanaged\")\r\n\r\nOnly 250 of my systems out of 1000 will be imported into the inventory.  If I don't set the want hostcollections and host_filters all 1000 systems are imported.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.3.2\r\n* Ansible version:  2.7.2\r\n* Operating System: RHEL 7.6\r\n* Web Browser: Chrome 71\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\nConfigure Satellite 6 as a dynamic inventory\r\nModify the source variables and add:\r\n> satellite6_want_hostcollections: True\r\n> host_filters: not (host_collection=\"virt-who\" or host_collection=\"decomm\" or host_collection=\"unmanaged\")\r\nRun the job to sync the dynamic inventory\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nAll systems are imported\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nOnly 250 systems are imported\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nI suspect it is from this in the foreman.py, because if I change the number to 1000 all my hosts are imported.\r\n\r\n```python\r\n   def _get_json(self, url, ignore_errors=None, params=None):\r\n        if params is None:\r\n            params = {}\r\n        params['per_page'] = 250\r\n\r\n        page = 1\r\n        results = []\r\n        s = self._get_session()\r\n        while True:\r\n            params['page'] = page\r\n            ret = s.get(url, params=params)\r\n            if ignore_errors and ret.status_code in ignore_errors:\r\n                break\r\n            ret.raise_for_status()\r\n            json = ret.json()\r\n            # /hosts/:id has not results key\r\n            if 'results' not in json:\r\n                return json\r\n            # Facts are returned as dict in results not list\r\n            if isinstance(json['results'], dict):\r\n                return json['results']\r\n            # List of all hosts is returned paginaged\r\n            results = results + json['results']\r\n            if len(results) >= json['subtotal']:\r\n                break\r\n            page += 1\r\n            if len(json['results']) == 0:\r\n                print(\"Did not make any progress during loop. \"\r\n                      \"expected %d got %d\" % (json['total'], len(results)),\r\n                      file=sys.stderr)\r\n                break\r\n        return results\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n@sivel has a perf callback plugin: https://github.com/ansible/ansible/pull/46346\r\n\r\nWe should integrate/merge this into ours to collect perf stats.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis is for collection only. Visualization would be other issues/initiatives.\r\n\r\nTasks:\r\n\r\n- [x] Collect perf stats data in `Runner.event_callback`\r\n- [x] Installer should create top-level cgroup\r\n- [x] .. and pass the name of the cgroup to runner\r\n- [x] perf stats flags should be surfaced in\r\n  - [x] Runner.run method\r\n  - [x] runner CLI flags\r\n  - [x] runner [settings file](https://github.com/ansible/ansible-runner/pull/225)\r\n- [x] Create system setting for enabling perf stats (then notify @kialam)\r\n- [x] Stats should show up in events from jobs that run on isolated nodes\r\n- [x] ansible-runner unit / integration tests\r\n  - [ ] .. configured to only run if using ansible 2.8 and able to access top-level cgroup\r\n- [x] Env vars set for perf stats should show up in JOB_ENV\r\n- [ ] Create dev docs in runner / awx\r\n- [ ] Once PR is up, sync up with @tvo318 to confirm cgcreate command and any other feature docs needed\r\n- [ ] Once we land on final name for job event field for stats, sync up with @rooftopcellist re: metrics"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nRefresh tokens aren't being cleaned up by the `cleartokens` command after being revoked.  \r\n\r\nThe `awx-manage cleartokens` command does not delete revoked refresh_tokens, letting them pile up in the database.  \r\n\r\n\r\nPossible Solutions\r\nA. Get a patch in for DOT 1.1.3 and see if they can release a patch release.  (this is fixed in 1.2.0, but that requires => django 2.0)\r\nB. Monkey-patch the clear_expired() method in DOT, which is called by `cleartokens`\r\n\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create an Application\r\n2. Create an Application token (api/v2/applications/1/tokens/)\r\n3. run `awx-manage revoke_oauth2_tokens`     (deletes access_token)\r\n4. run `awx-manage revoke_oauth2_tokens --all`   (deletes refresh_token)\r\n5. run `awx-manage cleartokens\r\n\r\n##### EXPECTED RESULTS\r\n\r\nexpired access_tokens and expired refresh_tokens should be deleted.  \r\n\r\n##### ACTUAL RESULTS\r\n\r\nrevoked refresh_tokens are not actually deleted.  (they are in DOT 1.2.0, but not in 1.1.3, which we use)\r\n\r\n"},{"labels":[null,"api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n\r\nMainly, we would like insights to be able to answer the question: \"Are there anomalies in automation time for certain hosts, or certain playbooks?\"\r\n\r\nThe performance plugin work @jladdjr has been working on will give us insight on how long each task runs for, which should be useful for this.  We need to identify only the data needed, and package it up with the rest of the analytics data.  \r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":[null,"api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe need to be able to determine if a request to the API is coming from the UI for analytics data.  \r\n\r\nThe UI may be able to add a flag/header with each request which can be checked by the API as a way of definitively knowing the request came from the UI and not an integration like tkit, etc.  \r\n\r\nOnce this is added, we should add the following queries to analytics collection:\r\n* Number of Jobs launched by UI/API \r\n* Maybe add a field to the Job named `launch_method`\r\n   + if so, add `launch_method` to the `main_unified_job` table copy.  \r\n"},{"labels":["api",null,null],"text":"We recently removed PyCrypto usage from apache-libcloud (https://github.com/apache/libcloud/commit/c462a6f1b4a3280cb03b0f1528996e1479186445), but we're waiting on a new release on PyPI (in the meantime, we've pinned to our own fork w/ the fix: https://github.com/ansible/awx/commit/b02d9ae282f8368a282efc69a1ef8d0918cee92d#diff-4579cfa0784627e7544dbb3eadca33fe)\r\n\r\nOnce a new apache-libcloud is out, let's remove our fork and pin to the new version."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThe page saying that AWX is upgrading is not showing when AWX is not upgrade. 500 error instead.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n```\r\nawx-manage migrate main <current migration number minus 1>\r\n```\r\n\r\nThis assumes that the last migration is reversible.\r\n\r\nThen visit some page.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA fancy page telling me that AWX is migrating\r\n\r\n##### ACTUAL RESULTS\r\n\r\nserver error\r\n\r\n```\r\nawx_1        | 13:53:33 uwsgi.1      | 2019-05-03 13:53:33,348 ERROR    django.request Internal Server Error: /favicon.ico/\r\nawx_1        | 13:53:33 uwsgi.1      | Traceback (most recent call last):\r\nawx_1        | 13:53:33 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 131, in get_response\r\nawx_1        | 13:53:33 uwsgi.1      |     response = middleware_method(request, response)\r\nawx_1        | 13:53:33 uwsgi.1      |   File \"./awx/main/middleware.py\", line 130, in process_response\r\nawx_1        | 13:53:33 uwsgi.1      |     if request.session and not request.session.is_empty() and not should_skip:\r\nawx_1        | 13:53:33 uwsgi.1      | AttributeError: 'WSGIRequest' object has no attribute 'session'\r\n\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nA user has Execute permission on a job_template. \r\nThis user is permitted to run a job_templates.\r\nThis user is not permitted to relaunch this job_templates.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: centos7\r\n* Web Browser: Chrome v63.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a user with Execute permission on a job_template. \r\n![Capture3](https://user-images.githubusercontent.com/26538843/57136134-1ecc0380-6dac-11e9-950d-f3e8e317d7e6.PNG)\r\n\r\n\r\nRun a template that failed\r\nrelaunch this template\r\n![Capture1](https://user-images.githubusercontent.com/26538843/57136159-32776a00-6dac-11e9-838a-b767144c4d1f.PNG)\r\n\r\na popup is displayed\r\n##### EXPECTED RESULTS\r\n\r\nThe job_template is supposed to be executed \r\n\r\n##### ACTUAL RESULTS\r\n\r\n![Capture2](https://user-images.githubusercontent.com/26538843/57136169-3dca9580-6dac-11e9-9f85-5dd91050e3f4.PNG)\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nNote: Not a regression. Has been like this for quite some time.\r\n\r\nClicking through the Failed Hosts on the Dashboard generates a strange query.\r\n\r\n- Pagesize is 25, not 20.\r\n- UI Renders Pagination toggle for 20 instead of 25.\r\n- Filter `has_active_failures:true` cannot be removed\r\n- Filter should be `has_active_failures__icontains`\r\n\r\n##### ENVIRONMENT\r\nAWX 2.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Generate 26+ Failed Hosts\r\n1. On Dashboard, select the Failed Hosts badge.\r\n\r\nNote: \r\n\r\n- Pagesize is 25, not 20.\r\n- UI Renders Pagination toggle for 20 instead of 25.\r\n- Filter `has_active_failures:true` cannot be removed\r\n- Filter should be `has_active_failures__icontains`\r\n\r\n##### EXPECTED RESULTS\r\n- Correct filter used.\r\n- Correct pagesize used\r\n\r\n##### ACTUAL RESULTS\r\n- Strange behavior with pagination\r\n- Unable to remove filter\r\n\r\n##### ADDITIONAL INFORMATION\r\n![failedhostsbadge](https://user-images.githubusercontent.com/12446869/57101403-24afdf00-6cef-11e9-9e25-4de2703fd8d9.gif)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nThere is supposed to be an accounting of job event children at `/api/v2/job_events/N/children/`, but this list is always coming up 0, even for an event `N` that clearly has its `uuid` field referenced by `parent_uuid` field on other events.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun the playbook:\r\n\r\nhttps://github.com/ansible/test-playbooks/blob/master/debug.yml\r\n\r\nand set `ansible_connection: local`\r\n\r\nDo this on an inventory with 500 hosts (roughly).\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe event:\r\n\r\n> Task Started (debug)\r\n\r\nis a parent of many other events. Proof:\r\n\r\nMy playbook_on_task_started event is at `/api/v2/job_events/17606/`, and it has `\"uuid\": \"0242ac12-0005-e7f4-73ba-0000000001ee\",`\r\n\r\nThus, I expect:\r\n\r\n - `/api/v2/job_events/17606/children/`\r\n - `/api/v2/job_events/?parent_uuid=0242ac12-0005-e7f4-73ba-0000000001ee`\r\n\r\nTo both have the same listings of job events.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`/api/v2/job_events/?parent_uuid=0242ac12-0005-e7f4-73ba-0000000001ee` has 975 events\r\n\r\nbut\r\n\r\n`/api/v2/job_events/17606/children/` has 0\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe children sublist should also be linked from the job event, but it is not.\r\n\r\nPing @jakemcdermott and @ryanpetrello \r\n"},{"labels":["api",null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nExpand and Collapse buttons are inert on Job Result Detail Page\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Run a job to completion\r\n2. On the Job Result Detail page, use the collapse expand buttons\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpand or collapse\r\n\r\n##### ACTUAL RESULTS\r\n\r\ninert action\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nSCIM allows social-auth users (SAML, etc.) to automatically be provisioned *and deprovisioned* when necessary, allowing for more secure usage of social auth.\r\n\r\ndjango lib here: https://github.com/15five/django-scim2\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUsing the API, a client can move a host from one inventory to another.\r\n\r\nThis leaves in place links to groups and inventory sources, pointing to the old inventory. This leaves the server in a very degenerate state.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate 2 inventories.\r\n\r\nInside the first inventory, create a host and a group, make the host a child of the group.\r\n\r\nGet the pk of the host and the pk of the second inventory\r\n\r\n```\r\nPOST\r\n/api/v2/inventories/<pk of second inventory>/hosts/\r\n{\"id\": <pk of host in first inventory>}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n400 you should not be able to do this action\r\n\r\nYou cannot perform this action as a PUT or PATCH on `/api/v2/hosts/<pk of host in first inventory>`\r\n\r\n##### ACTUAL RESULTS\r\n\r\n204 response code and host is now moved to 2nd inventory\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nEven though the host is in the 2nd inventory, it remains a child of the group in the 1st inventory. What will the inventory given to `ansible-playbook` look like? 🤷‍♂ \r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nCurrently `awx_system_info` and `awx_instance_info` metrics are returned as labels with values, which makes it difficult to query just the value of one key.  As a result, you can't query individual key's for their values in prometheus, for example: `awx_system_info{anisble_version}`.  This has already been fixed for licenses.  \r\n\r\nWe should make the rest of these individual metrics so that they can be individually queried.  i.e.: \"I am a customer who likes to see my Ansible version and tower version in Dashboard for Tower in Grafana\"\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nAllow creating and executing Roles (possibly via the ad-hoc interface) and via Workflows.\r\n\r\nWhere Roles are possibly sourced via Collections."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nAnsible Collections (see https://github.com/ansible/ansible/projects/30#card-13708579 and specifically https://github.com/ansible/ansible/pull/52194) are a means of gathering Ansible content beyond simple Roles that Galaxy supports today.\r\n\r\nOn the AWX side, we're likely to implement this at the Project level as it is most analagous to the Collection concept and would allow sourcing collections from a variety of different places.\r\n\r\nA major change that may need to be implemented here is adding multi-project support to Job Template definitions to bring in multiple collections for job execution. This will also require utilizing the directory isolation feature from `ansible-runner`. This is a tough one because the one hard-and-fast linkage for Job Templates is an association with a single project and playbook. It may be necessary to identify a Project as a `collection` specifically in order to treat it differently but this may make things more difficult to understand on the user side.\r\n\r\nThis may also necessitate having a specific organization tied to a job template rather than inferring it from an inventory/project.\r\n\r\nAlternatively we could consider a new Collections top level object, but there are a lot of overlapping similarities to Projects themselves.\r\n\r\nFor RBAC considerations, I don't see anything really beyond normal project permissions and the changes that may need to be made for multi-projects on job templates.\r\n\r\nWe've also heard in the past about being able to whitelist sources for this kind of content.\r\n\r\nIt's also possible that Collections could come from official places like just Ansible galaxy necessitating the building of new project source locations.\r\n\r\nSome other ideas:\r\nOrganization default collections,  used by job templates under the org.\r\nSelect job templates using the collection from the project admin interface\r\n\r\nRelated:\r\nhttps://github.com/ansible/awx/issues/282\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nFew improvements of https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py from a contributor of `sosreport` tool.\r\n\r\n##### ENVIRONMENT\r\nupstream code review\r\n\r\n##### STEPS TO REPRODUCE\r\nn.a., not much wrong in particular, rather code improvements suggestions.\r\n\r\n##### EXPECTED RESULTS\r\n- https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L8:\r\n   - `ansible --version` is already collected by `ansible` plugin (https://github.com/sosreport/sos/blob/master/sos/plugins/ansible.py#L29) - this call is redundant (until you call `sosreport -o tower` or `sosreport -n ansible`)\r\n- https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L26:\r\n   - `/etc/ansible` is already collected by `ansible` plugin (https://github.com/sosreport/sos/blob/master/sos/plugins/ansible.py#L25) - this collection is redundant and in very rare cases, it can be dangerous (see https://github.com/sosreport/sos/issues/1596)\r\n- https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L32-L34:\r\n  - these three log patterns are already collected by `logs` plugin - again, redundant and potentially dangerous duplicate collection\r\n- https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L50:\r\n  - is this still applicable? Are there systems with sosreport version *older* than 3.0 (that was released 5years ago)?\r\n- https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L53 and https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L71 : \r\n  - we stick to name plugins starting with capital letter ;-)\r\n- https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L59-L60:\r\n  - this can be shortened to `self.add_copy_spec(SOSREPORT_TOWER_DIRS)` as the method supports also lists as its argument. But you might want to stick on the current code in case more than 25MB data are expected to be collected altogether; *one* call of `add_copy_spec` collects files from newest to oldest and stops collecting after reaching 25MB limit (by default; it is configurable via `--log-size=..` or `--all-logs` options). So if e.g. each of three logdirs would have 10MB, one copyspec would skip some oldest file(s), while copyspec called for each logdir individually will collect everything.\r\n- https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L62-L63:\r\n  - like above, worth calling single `self.add_forbidden_path(SOSREPORT_FORBIDDEN_PATHS)` ; no catches here\r\n- https://github.com/ansible/awx/blob/devel/tools/sosreport/tower.py#L65-L66:\r\n  - like above, worth calling single `self.add_cmd_output(SOSREPORT_TOWER_COMMANDS)` ; no catches here\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n\r\nCurrently, if you have multiple inventory sources for an inventory, they are synced individually.\r\nThis leads to:\r\n- confusing (and potentially deadlock-y) behavior\r\n- a difference to how multiple inventory sources are used when you do it on the command line\r\n\r\nWe should move to not doing individual inventory source syncs. Instead, we should, when an inventory is synced, run a single `ansible-inventory` process passing all inventory sources.\r\n\r\nNote: this *will* be a behavior change that will change how inventory is computed. It will also change the mechanism such that \"overwrite\" and \"overwrite vars\" should not be used for individual sources.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nThe vault KV backend should validate the vault URL passed.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nenter \"host:1234\" for a vault server\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1) accepts it, uses it as http://host:1234/\r\n- or -\r\n2) throws an error on save\r\n\r\n##### ACTUAL RESULTS\r\n\r\nthrows error on use\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nAWX returns extraneous errors on bad input.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n##### STEPS TO REPRODUCE\r\n\r\nPOST https://awx/api/v2/credentials/\r\n\r\n```\r\n{\r\n  \"name\":  \"SSH key\", \r\n  \"organization\": 2,\r\n  \"credential_type\": 1,\r\n  \"inputs\": {\r\n         \"ssh_key_data\": \"thisisobviouslynotakey\", \r\n         \"ssh_key_unlock\": \"apassword\"\r\n  }\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n```\r\n{\r\n  \"inputs\": {\r\n     \"ssh_key_data\":\r\n         [\"Invalid certificate or key: ********...\"]\r\n   }\r\n}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n{\r\n  \"inputs\": {\r\n     \"ssh_key_data\":\r\n         [\"Invalid certificate or key: ********...\"],\r\n    \"ssh_key_unlock\":\r\n         [\"should not be set when SSH key is not encrypted.\"]\r\n   }\r\n}\r\n```\r\n\r\n "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen copying any credential not all fields are copied, for example the owner. See the additional information for an screenshot.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7\r\n* Operating System: Fedora 29\r\n* Web Browser: Chrome and Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCopy any credential of any type and see the owners column. The copied one won't have an owner.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nThe copied credential has the same owner or set the owner to the user that copied it.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nNo owners are set to the copied credential.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n![Screenshot from 2019-04-22 16-15-58](https://user-images.githubusercontent.com/48132/56526147-f1649780-6519-11e9-8c72-af009d1bad79.png)"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nVariable precedence configuration seems to not apply on ansible awx.\r\n\r\nThis is a useful behavior to implement inventory specializations for group variables of default group variables as defined in playbook.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.0\r\n* AWX install method: docker compose on linux\r\n* Ansible version:  2.7.6\r\n* Operating System: debian 9\r\n* Web Browser: firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate the following\r\n```\r\ninv-dev/\r\n  group_vars/\r\n    group1.yml\r\n  hosts\r\nsys\r\n  group_vars\r\n    group1.yml\r\n  playbook.yml\r\nansible.cfg\r\n```\r\ninv-dev/hosts\r\n```\r\n[group1]\r\ntest1\r\n```\r\n\r\ninv-dev/group_vars/group1.yml\r\n```\r\n---\r\n  new_var: \"inventory dev\"\r\n  inv_var: \"inv dev\"\r\n```\r\n\r\nsys/group_vars/group1.yml\r\n```\r\n---\r\n  new_var: \"playbook\"\r\n  pb_var: \"pb\"\r\n```\r\n\r\nsys/playbook.yml\r\n```\r\n---\r\n- name: test vars\r\n  hosts: group1\r\n  gather_facts: false\r\n  connection: local\r\n  tasks:\r\n  - name: show vars\r\n    debug:\r\n      msg: \"NEW: {{ new_var }}, PB: {{ pb_var }}, INV: {{ inv_var }}\"\r\n```\r\n\r\nansible.cfg\r\n```\r\n[defaults]\r\n;; CHANGE variables precedence,\r\n; Change precedence groups_plugins_inventory > group_plugins_play\r\n; https://docs.ansible.com/ansible/latest/reference_appendices/config.html#variable-precedence\r\n; Default\r\n; precedence = all_inventory, groups_inventory, all_plugins_inventory, all_plugins_play, groups_plugins_inventory, groups_plugins_play\r\nprecedence = all_inventory, groups_inventory, all_plugins_play, all_plugins_inventory, groups_plugins_play, groups_plugins_inventory \r\n```\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n##### EXPECTED RESULTS\r\nThis is the output of ansiple core command:\r\n\r\nansible-playbook -i inv-dev/ sys/playbook.yml\r\n```\r\n\r\nPLAY [test vars] ********************************************************************\r\n\r\nTASK [show vars] ********************************************************************\r\nok: [test1] => {\r\n    \"msg\": \"NEW: inventory dev, PB: pb, INV: inv dev\"\r\n}\r\n\r\nPLAY RECAP **************************************************************************\r\ntest1    : ok=1    changed=0    unreachable=0    failed=0   \r\n```\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nPLAYBOOK: playbook.yml *********************************************************\r\n1 plays in sys/playbook.yml\r\n\r\nPLAY [test vars] ***************************************************************\r\n\r\nTASK [show vars] ***************************************************************\r\nok: [test1] => {\r\n    \"msg\": \"NEW: playbook, PB: pb, INV: inv dev\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\ntest1    : ok=1    changed=0    unreachable=0    failed=0   \r\n```\r\n<!-- What actually happened? -->\r\n\r\nThe culprit is the line\r\n```\r\n\"msg\": \"NEW: playbook, \r\n```\r\n\r\nas it seems new_var kept the value of playbook group vars, despite that variable precedence was changed to favor inventory groups variables.\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nI am using privilege escalation (become_method=dzdo) in my playbook to run oracle commands to login to database. I have set dzdo permission to run particular command inside database server but when when i executed playbook ansible is not able to execute dzdo commands even though it has privilege to execute these commands.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: NA\r\n* AWX install method: NA\r\n* Ansible version:  2.7.5\r\n* Operating System: Linux\r\n* Web Browser: NA\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nBelow is playbook which i am using.\r\n\r\n---\r\n- name: Test Production Network Connection\r\n  hosts: all\r\n  gather_facts: false\r\n  \r\n  tasks:\r\n  - name: Print Hello message\r\n    debug:\r\n      msg: \"Entering Into Prod Network\" \r\n  \r\n  - name: list pmon output\r\n    shell: ps -ef | grep pmon\r\n    register: pmon\r\n    #become: yes\r\n    #become_user: oraacppp\r\n  - name: Privilege escalation\r\n    shell: echo exit | sqlplus / as sysdba\r\n    become: yes\r\n    become_user: oraacppp\r\n    environment:\r\n     ORACLE_HOME: \"/ora/product/dbms/11.2.0.4/dblib1\"\r\n     ORACLE_BASE: \"/ora\"\r\n     ORACLE_SID: TEST\r\n     TNS_ADMIN: \"/oracle/product/dbms/11.2.0.4/dblib1/network/admin\"\r\n     PATH: \"/ora/product/dbms/11.2.0.4/dblib1/bin:/ora/product/dbms/11.2.0.4/dblib1/OPatch:$PATH:/bin:/usr/bin::/usr/ccs/bin\"\r\n    register: sqlplus\r\n\r\n\r\nit is giving error in 2nd task name: Privilege escalation\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nplaybook should not throw any error it just login to database and logout.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\ni am getting below error (For Task 2 only)\r\n\r\n{\r\n    \"_ansible_parsed\": false,\r\n    \"_ansible_no_log\": false,\r\n    \"module_stderr\": \"Shared connection to dbserver.ana.com closed.\\r\\n\",\r\n    \"changed\": false,\r\n    \"module_stdout\": \"Sorry, user ABC is not allowed to execute '/bin/sh -c echo BECOME-SUCCESS-ngakodugvcjuytjsrqpgfahxrajdvaag; PATH='/ora/product/dbms/11.2.0.4/dblib1/bin:/ora/product/dbms/11.2.0.4/dblib1/OPatch:$PATH:/bin:/usr/bin::/usr/ccs/bin' ORACLE_SID=TEST TNS_ADMIN=/ora/product/dbms/11.2.0.4/dblib1/network/admin ORACLE_BASE=/ora ORACLE_HOME=/ora/product/dbms/11.2.0.4/dblib1 /usr/bin/python /tmp/ansible-tmp-155557rtt3951.28-210342729760200rtrt/command.py' as oraacppp on dbserver.ana.com.\\r\\n\",\r\n    \"failed\": true,\r\n    \"rc\": 1,\r\n    \"msg\": \"MODULE FAILURE\"\r\n}\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nI am suspecting issue with issue with dzdo commands with option -c /bin/sh which ansible couldnt do.\r\n\r\nI am login to database server with user \"ABC\" and then using privilege escalation to execute commands with user \"oraacppp\"\r\n\r\ndzdo access has been given to below command on db server\r\n\r\n/ora/product/dbms/11.2.0.4/dblib1/bin/sqlplus .* run as oraacppp\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nIn the Workflow Job Template Visualizer, we need to set prompt setting in advance when \"Prompt on Launch\" is enabled on Inventory for Job Template.\r\n\r\nBut those prompt setting will be ignored when specified Inventory setting on Workflow Job Template.\r\n\r\nI'm also reffering the issue: #1731 but I cannot see the similar request on there.\r\nIt would be great if we do not have to set prompt when \"prompt on launch\" setting is enabled."},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\n- Customer request\r\n\r\n- Customer would like to be able to set a \"Default\" IG for job template runs rather than individually specifying specific IGs to be available for job templates.\r\n- This would set a \"preferred\" IG for job template runs, and only get distributed to a different instance group if the default was at max capacity.\r\n- This comes from a job template being inadvertently launched against an isolated instance group, rather than a standard group. This caused the job template to fail.\r\n\r\n- An alternative solution to this would be to weight the instance groups so a job will only launch against an isolated node if either there is no remaining capacity at any other instance group, or it was intentionally specified."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nUsers with admin_role to a project do not have permission to see all the job templates that employ that project. Yet, organization auditor_role will get permission to view those templates.\r\n\r\nIf we were to add `auditor_role` to projects, then we would be able to surface this mechanism to users.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a project, grant userA `admin_role`, grant other users `use_role`\r\n\r\nHave those other users create new job templates with project\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpect userA to see job templates created with that project\r\n\r\n##### ACTUAL RESULTS\r\n\r\nuserA cannot see any job templates, or jobs.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhttps://github.com/ansible/awx/pull/3629 is my reason for filing this.\r\n\r\nCorresponding to this change, we should offer \"audit\" entry in `user_capabilities` for projects, avoiding extra legwork by the client to determine who can and cannot attach a notification template.\r\n\r\nIt would also make the permissions rules for Notification Templates more simply explainable. Auditor role will be necessary for the resource, `notification_admin_role` for the notification template, and if auditor role is not present for the resource, read role will suffice.\r\n\r\nPing @wenottingham @mabashian "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIs it possible to disable case sensitive for org / team mapping while the user is authenticated? \r\n\r\nThe email address needs to be exactly match. For example, once the user information has created after SSO and if the email address [ abc.def@test.com / ghi.jkl@test.com ] and mapping are like this, then it is failing to add that user under respective Org / Team. This is eventually getting difficult to manage when it has mapped with '**n**' number of users. We have to go and check what are the email address populated under User area in AWX, and update the exact mapping over here. \r\n\r\n```json\r\n{\r\n \"Test Org\": {\r\n  \"remove_admins\": true,\r\n  \"admins\": [\r\n   \"Abc.Def@test.com\"\r\n  ],\r\n  \"users\": [\r\n   \"Ghi.Jkl@test.com\"\r\n  ]\r\n }\r\n}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Create a smart inventory from another teams inventory\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCurrently we can not create a smart inventory from another teams inventory even though we have the ability to view it.  It would be nice if we could do this.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nThe PROJECT_ROOT should be configurable for each project.  This includes SCM TYPE Git as well.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n \r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.9\r\n* Operating System: Centos 7\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Go to Settings -> AUTHENTICATION.\r\n2. In the Sub Category drop-down, select LDAP.\r\n3.  In the LDAP Server URI field, attempt to add a URI that ends with a custom internal domain like: ldap://servername.cotoso.coto.so3:389\r\n4. Hit Save\r\n\r\n##### EXPECTED RESULTS\r\nIt should save the config\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError message stating: Failed to save settings. Returned status: 400\r\n\r\nThe field then display : **Enter a valid URL**\r\nBut the url is valid, for an internal domain.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n\r\nGiven a credential `/api/v2/credentials/N`, with v1 we used to be able to find the accurate type by querying `credential.kind` which could be `aws`.\r\n\r\nNow with v2, `credential.get_related('credential_type').kind` returns `cloud` and credential.get_related('credential_type').name` return `Amazon Web Services`. But there is no more way to retrieve `aws`.\r\n\r\nAs I understand it, we could checkt the namespace `aws` to see if the credentials are in there. But from the credentials we can't see the namspace. Which means, in order to find the proper kind, we need to loop over each namespace and check if our credential are in there. Which is iniefficient.\r\n\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n  * Create a `kind=aws` cred.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n  * Given the cred find a way to retrieve the `aws` string\r\n\r\n##### ACTUAL RESULTS\r\n\r\n  * Retrieve `Amazon Web Services`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n  * N/a\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\nWhen a project update triggered, all instances should update the playbooks. \r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nThe current situation is when a job started, the related instance will update the project which used my the job first and then start to finish the job events.\r\n\r\nIn my env, the project update will take 7-10 seconds which means every job will spend so much time on preparing.\r\n\r\nThis feature can shorten the run time of routine job.\r\n\r\nMy AWX version is 1.0.8.0."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Pulling ansible roles like https://github.com/geerlingguy/ansible-role-kubernetes\r\n   into a project and use in jobs is not possible.\r\n   \r\n   any idea how can i do that? \r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nOn the Dashboard, Inventory Sync failures can return null and will not render. Note: the API returns null on the request.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a new organization and a new user associated with that user\r\n2. Log in as that user and land on dashboard\r\nNote: the dashboard represents 0s for all single stat measurements.\r\n\r\nAPI request on /dashboard/ returns\r\n`inventories: {url: “/api/v2/inventories/“, total: 0, total_with_inventory_source: 0, job_failed: 0,…}\r\n*inventory_failed: null*\r\njob_failed: 0\r\ntotal: 0\r\ntotal_with_inventory_source: 0\r\nurl: “/api/v2/inventories/” (edited) `\r\n\r\n##### EXPECTED RESULTS\r\nA number is returned and represented\r\n\r\n##### ACTUAL RESULTS\r\nNo number is displayed (but it doesn't 'splode!)\r\n\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<img width=\"338\" alt=\"Screen Shot 2019-04-03 at 3 59 45 PM\" src=\"https://user-images.githubusercontent.com/12446869/55510297-f9709c00-562b-11e9-824c-7e657664041e.png\">\r\n\r\n<img width=\"1634\" alt=\"Screen Shot 2019-04-03 at 3 58 04 PM\" src=\"https://user-images.githubusercontent.com/12446869/55510326-0c836c00-562c-11e9-9428-12694701856f.png\">\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nThere is a need for an endpoint for failed hosts in a workflow job.  At the moment, only failed/successful job templates are tracked.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCurrently team read access is only accessible via the api and assignable the same way. Please allow for adding a team read permission assignment via the UI(to teams and users).\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nTower API issues proxy request to Insights. In each request it includes a User-Agent header that lets us know information about the requester (i.e. tower version, license type). That header is *not* included in the request to download the remediation playbooks.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Tower\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Run an insights project update in Tower\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* To find the insights request in the Insights Kibana instance\r\n\r\n##### ACTUAL RESULTS\r\n\r\n* User-Agent headers not found in the Kibana instance\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n* Ask @chrismeyersfsu to find the log in the kibana instance. Alternatively, if your feeling fancy, you can use a proxy server to observe the user-agent headers.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nSSO return error as \"**ERROR    social Your credentials aren't allowed**\" \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.9\r\n* Operating System: Linux\r\n* Web Browser: Chrome / Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nTry single sign on after configuring Azure AD authentication\r\n\r\n##### EXPECTED RESULTS\r\n\r\nUser should be able to login without any error\r\n\r\n##### ACTUAL RESULTS\r\nGetting error as \"**ERROR    social Your credentials aren't allowed**\" and it returns to login page again even though the authentication was successful. Following are the related logs,\r\n\r\n```\r\n2019-04-02 08:44:08,667 ERROR    social Your credentials aren't allowed.\r\n....\r\n2019-04-02 08:44:11,984 INFO     awx.api.generics status 401 received by user AnonymousUser attempting to access /api/v2/settings/all/ from X.X.X.X\r\n....\r\n2019-04-02 08:44:12,008 INFO     awx.api.generics status 401 received by user AnonymousUser attempting to access /api/v2/config/ from X.X.X.X\r\n ```\r\n\r\n##### ADDITIONAL INFORMATION\r\n#1800\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n- Bug Report\r\n\r\n \r\n##### COMPONENT NAME\r\n- API\r\n- UI\r\n\r\n \r\n##### SUMMARY\r\nWhen running AWX on K8s or a standalone docker host there is a constant memory increase seen on the awx-web container and after a certain amount of jobs run, or even page clicks, the uwsgi processes start to be killed due to the container hitting the resource limits set. These tie up with HTTP 500 and 502 errors.\r\n\r\n \r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2, 3.0.1 and 4.0.0\r\n* AWX install method: k8s,docker\r\n* Ansible version:  NA\r\n\r\n \r\n##### STEPS TO REPRODUCE\r\nMonitor awx-web container usage,\r\nuse top within container, press 'e' a couple of times to get memory in MB and keep an eye on the uwsgi processes then browse or run jobs. You'll see that the uwsgi processes just continue to consume more and more memory, eventually there will be logs showing that the uwsgi processes are being killed (probably due to OOM). This then returns 500/502 errors back to the user.\r\n\r\nIt seems when the awx web container first starts the pids allocated to the uwsgi processes are in the low hundreds, if the container has been up for a few weeks the pids are in the tens of thousands.\r\n\r\nIf no-one is logged on via the GUI then memory doesn't increase, but it doesn't reduce either.\r\n\r\nExample log when running in K8s and with AWX 4.0.0\r\n\r\n[pid: 130|app: 0|req: 1000/2342] <ip> () {48 vars in 2359 bytes} [Mon Mar 25 10:28:43 2019] GET /api/v2/job_templates/59/launch/ => generated 1020 bytes in 94 msecs (HTTP/1.1 200) 10 headers in 394 bytes (1 switches on core 0)\r\n...The work of process 130 is done. Seeya!\r\nworker 1 killed successfully (pid: 130)\r\nRespawned uWSGI worker 1 (new pid: 170)\r\nWSGI app 0 (mountpoint='') ready in 3 seconds on interpreter 0x10e2290 pid: 170 (default app)\r\n\r\nThe logs are different on AWX 2.1.2, it shows a signal 9 killing the process.\r\n\r\n\r\n##### EXPECTED RESULTS\r\nMemory is cleaned up and doesn't continue to rise after each page click or job is run.\r\n\r\n \r\n##### ACTUAL RESULTS\r\nMemory keeps increasing after every page click or every job run.\r\n\r\n \r\n##### ADDITIONAL INFORMATION\r\n\r\nNoticed a 151MB memory increase on the awx-web container within 30 mins. This was with just 1 user logged in and 22 new jobs - job ID at the start was 682 and was 704 after (including SCM and inventory updates).\r\n\r\nAt 14:15 (start) the memory consumed by awx-web was 997MB\r\n\r\nAt 14:45 (end) the memory consumed by awx-web was 1.148GB\r\n\r\nI've noticed on a fresh start of awx-web the uwsgi processes are using around 130MB each. My container has been up for a few days and has logged 704 runs and I see the top uwsgi process using 230MB (the others range from 177MB to 208MB)\r\n\r\nThis was seen on AWX 2.1.2, 3.0.1, and 4.0.0 on host K8s and standalone docker hosts. I've not tried earlier versions.\r\n\r\nThe memory even increases just when browsing around not running any jobs.\r\n\r\nFor the standalone docker host we have 32GB of RAM. \r\n\r\nFor the K8s hosts we've set resource limits matching those in your inventory files.\r\n\r\nFor K8s we are using HAProxy as an ingress service for SSL termination, for standalone docker we also front it with HAProxy for SSL termination."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nProject update output has some new warning messages related to inventory parsing\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.7.9\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a project update and view output\r\n\r\n##### EXPECTED RESULTS\r\n\r\nProject updates should run against localhost, and there should be no warning messages because the means of specifying localhost should conform to Ansible standards with no ambiguity.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIn the project update standard out:\r\n\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file\r\n/tmp/awx_5573_eg8rby8w/inventory/hosts did not meet host_list requirements, check plugin documentation if this is unexpected\r\n/tmp/awx_5573_eg8rby8w/inventory/hosts did not meet script requirements, check plugin documentation if this is unexpected\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nProbably related to ansible-runner integration.\r\n\r\nProject update `job_args` before ansible-runner:\r\n\r\n```\r\n\\\"ansible-playbook\\\", \\\"-i\\\", \\\"localhost,\\\", \\\"-v\\\", \\\"-e\\\", \\\"@/tmp/awx_13_dHXMtD/tmpbY95ZG\\\", \\\"project_update.yml\\\"\r\n```\r\n\r\nAfter:\r\n\r\n```\r\n\\\"ansible-playbook\\\", \\\"-v\\\", \\\"-i\\\", \\\"/tmp/awx_5573_eg8rby8w/inventory/hosts\\\", \\\"-e\\\", \\\"@/tmp/awx_5573_eg8rby8w/env/extravars\\\", \\\"project_update.yml\\\"\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nI've got an ansible playbook which makes use of the variable jboss_bind_iface to gather information based on the ansible facts E.g.: ansible_eth0.ipv4.address. I investigated deeper and it turns out that it has to do with unsafe variables, I'm gonna explain this in the additional information section.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1.0\r\n* AWX install method: docker on Linux\r\n* Ansible version:  2.7.9\r\n* Operating System: CentOS Linux release 7.6.1810 (Core)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nTask: \r\n\r\n- name: \"Set fact jboss_eap_bind_address\"\r\n  set_fact: jboss_eap_bind_address=\"{{ '{{ ' + 'ansible_' + jboss_bind_iface + '.ipv4.address' ' }}' }}\"\r\n\r\n- name: \"Debug fact\"\r\n  debug:\r\n    msg: \"Variable jboss_eap_bind_address is {{ jboss_eap_bind_address }} based on interface {{ jboss_bind_iface }}\"\r\n\r\n- name: \"Copy instance specific standalone-full-ha.xml\"\r\n  template:\r\n    src: \"standalone-full-ha.xml.j2\"\r\n    dest: \"/tmp/standalone-full-ha.xml\"\r\n\r\nJinja2 template (standalone-full-ha.xml.j2):\r\n\r\n<inet-address value=\"${jboss.bind.address.management:{{ jboss_eap_bind_address }}}\"/>\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nUsing ansible-playbook command works.\r\n\r\nPLAY [rd-iap1] **************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] ******************************************************************************************************************\r\nok: [172.16.4.16]\r\n\r\nTASK [install-jboss-eap : Create helper fact] *******************************************************************************************\r\nok: [172.16.4.16]\r\n\r\nTASK [install-jboss-eap : Set fact jboss_eap_bind_address] ******************************************************************************\r\nok: [172.16.4.16]\r\n\r\nTASK [install-jboss-eap : Debug fact] ***************************************************************************************************\r\nok: [172.16.4.16] => {\r\n    \"msg\": \"Variable jboss_eap_bind_address is 172.16.4.16 based on interface eth0\"\r\n}\r\n\r\nTASK [install-jboss-eap : Copy instance specific standalone-full-ha.xml] ****************************************************************\r\nchanged: [172.16.4.16]\r\n\r\nPLAY RECAP ******************************************************************************************************************************\r\n172.16.4.16                : ok=5    changed=1    unreachable=0    failed=0\r\n\r\nThe generated standalone-full-ha.xml file looks like this:\r\n<inet-address value=\"${jboss.bind.address.management:172.16.4.16}\"/>\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nUsing Ansible AWX does not work\r\n\r\nPLAY [172.16.4.16] *****************************************************************\r\n\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [172.16.4.16]\r\n\r\nTASK [install-jboss-eap : Create helper fact] **********************************\r\nok: [172.16.4.16]\r\n\r\nTASK [install-jboss-eap : Set fact jboss_eap_bind_address] *********************\r\nok: [172.16.4.16]\r\n\r\nTASK [install-jboss-eap : Debug fact] ******************************************\r\nok: [172.16.4.16] => {\r\n    \"msg\": \"Variable jboss_eap_bind_address is {{ ansible_eth0.ipv4.address }} based on interface eth0\"\r\n}\r\n\r\nTASK [install-jboss-eap : Copy instance specific standalone-full-ha.xml] *******\r\nchanged: [172.16.4.16]\r\n\r\nPLAY RECAP *********************************************************************\r\n172.16.4.16 : ok=5    changed=1    unreachable=0    failed=0   \r\n\r\nThe generated standalone-full-ha.xml file looks like this:\r\n<inet-address value=\"${jboss.bind.address.management:{{ ansible_eth0.ipv4.address }}}\"/>\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWhile generating the Ansible Extra Vars file it marks some variables as \"unsafe\" \r\n\r\n!unsafe 'awx_job_id': 310\r\n!unsafe 'awx_job_launch_type': !unsafe 'relaunch'\r\n!unsafe 'tower_job_id': 310\r\n!unsafe 'tower_job_launch_type': !unsafe 'relaunch'\r\n!unsafe 'awx_user_id': 1\r\n!unsafe 'awx_user_name': !unsafe 'admin'\r\n!unsafe 'awx_user_first_name': !unsafe 'Alexander'\r\n!unsafe 'awx_user_last_name': !unsafe 'Urbina'\r\n!unsafe 'tower_user_id': 1\r\n!unsafe 'tower_user_name': !unsafe 'admin'\r\n!unsafe 'tower_user_first_name': !unsafe 'Alexander'\r\n!unsafe 'tower_user_last_name': !unsafe 'Urbina'\r\n!unsafe 'awx_project_revision': !unsafe 'dd28f74d986b22dcaea8ea2eabecd2f985d4aefc'\r\n!unsafe 'tower_project_revision': !unsafe 'dd28f74d986b22dcaea8ea2eabecd2f985d4aefc'\r\n!unsafe 'awx_job_template_id': 8\r\n!unsafe 'awx_job_template_name': !unsafe 'JBoss_Configure_in_Provisioning'\r\n!unsafe 'tower_job_template_id': 8\r\n!unsafe 'tower_job_template_name': !unsafe 'JBoss_Configure_in_Provisioning'\r\n!unsafe 'console_enabled': !unsafe 'true'\r\n!unsafe 'jboss_bind_iface': !unsafe 'eth0'\r\n\r\nIf I remove the !unsafe in the value of the variable jboss_bind_iface like this: !unsafe 'jboss_bind_iface': 'eth0' and execute the playbook again works.\r\n\r\nIs there a way to explicitly mark a variable as safe while using AWX?\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI am trying to set and reference set_stats in a workflow. It does not appear that the variable is being set and am unable to reference variable in same and next playbook with the per_host parameter set.\r\n\r\nAm I miss understanding on how set_stats is suppose to work or is there a bug or installation issue?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0.17-1 back to 2.1.2.59-1\r\n* AWX install method: rpm install via awx-build/awx-dev\r\n* Ansible version:  2.7.6\r\n* Operating System: RHEL 7.6\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n  - name: yum update\r\n    yum:\r\n      name: '*'\r\n      state: latest\r\n    register: yum_update\r\n    when: (ansible_distribution_major_version >= \"6\")\r\n    \r\n  - debug:\r\n      msg: '{{ yum_update }}'\r\n    \r\n  - name: set stats\r\n    set_stats:\r\n      data:\r\n        patching_result: '{{ yum_update.changed }}'\r\n      per_host: yes\r\n\r\n\r\n  - debug:\r\n      msg: \"{{ patching_result }}\"\r\n\r\nSecond playbook:\r\n\r\nReference variable via a when statement.\r\n`when: (facter_is_virtual|bool  == true) and (patching_result == false)`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nUnable to reference variable in first or second playbook. Error is undefined variable. Also get the following warning in playbook that is setting the set_stats.\r\nCUSTOM STATS: ******************************************************************\r\n [WARNING]: Failure using method (v2_playbook_on_stats) in callback plugin\r\n(<display_callback.module.AWXDefaultCallbackModule object at 0x7f936ae682b0>):\r\n'<' not supported between instances of 'Host' and 'Host'\r\n\r\nOutput:\r\nTASK [set stats] ***************************************************************\r\ntask path: /var/lib/awx/projects/_6__rhel/fake_rhel_patching.yml:38\r\nok: [mmdadml04.dev.mig.corp] => {\"ansible_stats\": {\"aggregate\": true, \"data\": {\"patching_result\": false}, \"per_host\": true}, \"changed\": false}\r\nok: [mmpspkidxl04.mmi.mig.corp] => {\"ansible_stats\": {\"aggregate\": true, \"data\": {\"patching_result\": false}, \"per_host\": true}, \"changed\": false}\r\nTASK [debug] *******************************************************************\r\ntask path: /var/lib/awx/projects/_6__rhel/fake_rhel_patching.yml:45\r\nfatal: [mmdadml04.dev.mig.corp]: FAILED! => {\"msg\": \"The task includes an option with an undefined variable. The error was: 'patching_result' is undefined\\n\\nThe error appears to have been in '/var/lib/awx/projects/_6__rhel/fake_rhel_patching.yml': line 45, column 5, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n\\n  - debug:\\n    ^ here\\n\"}\r\nfatal: [mmpspkidxl04.mmi.mig.corp]: FAILED! => {\"msg\": \"The task includes an option with an undefined variable. The error was: 'patching_result' is undefined\\n\\nThe error appears to have been in '/var/lib/awx/projects/_6__rhel/fake_rhel_patching.yml': line 45, column 5, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n\\n  - debug:\\n    ^ here\\n\"}\r\nPLAY RECAP *********************************************************************\r\nmmdadml04.dev.mig.corp     : ok=8    changed=1    unreachable=0    failed=1   \r\nmmpspkidxl04.mmi.mig.corp  : ok=8    changed=1    unreachable=0    failed=1   \r\nCUSTOM STATS: ******************************************************************\r\n [WARNING]: Failure using method (v2_playbook_on_stats) in callback plugin\r\n(<display_callback.module.AWXDefaultCallbackModule object at 0x7f936ae682b0>):\r\n'<' not supported between instances of 'Host' and 'Host'\r\n\r\n\r\nCUSTOM STATS: ******************************************************************\r\n[WARNING]: Failure using method (v2_playbook_on_stats) in callback plugin\r\n(<display_callback.module.AWXDefaultCallbackModule object at 0x7ffb8f9602b0>):\r\n'<' not supported between instances of 'Host' and 'Host'\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nNote if only one host is in the inventory file, CUSTOM STATS shows properly but still unable to reference variable.\r\n\r\n\r\nCUSTOM STATS: ******************************************************************\r\n        mmdadml04.dev.mig.corp: { \"patching_result\": false}\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThere is a significant delay between the start of a job, and a finished project update.\r\nI got these timestamps from the api of the job & project_update:\r\n\r\njob\r\n> \"created\": \"2019-03-29T12:28:31.322996Z\"\r\n\r\nproject_update\r\n> \"created\": \"2019-03-29T12:28:32.423522Z\"\r\n> \"started\": \"2019-03-29T12:28:32.423164Z\",\r\n**> \"finished\": \"2019-03-29T12:29:27.247293Z\",**\r\n\r\njob_events\r\n> first event\r\n**> \"created\": \"2019-03-29T12:30:17.755991Z\"**\r\n> last event\r\n> \"modified\": \"2019-03-29T12:30:28.645966Z\",\r\n\r\nThere is a gap of 50s between the finished project_update and the first event of the job.\r\nWhere does this come from, I couldn't find anyhing in the container logs that could explain this.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: Debian\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nRun a job that triggers a project update.\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nJob gets created, project_update runs, job run starts faster after the project_update finishes.\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nThere is a 50s gap between the project_update finish time and the job's actual start time.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt is expected that the Openstack credential will provide to the environment `OS_CLIENT_CONFIG_FILE` pointing to a temporary file that has been written in the job's temporary directory.\r\n\r\nNote, this somewhat related to https://github.com/ansible/awx/issues/941\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate openstack credential\r\nCreate scm based inventory source for an inventory, could point to anything\r\nRun inventory update\r\nLook at `job_env`, obvserve no OS_CLIENT_CONFIG_FILE\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nOpenstack credential provides to job_env OS_CLIENT_CONFIG_FILE pointing to config file generated and laid down in temporary job directory\r\n\r\n##### ACTUAL RESULTS\r\nNot there\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis enables many different usages of the openstack credentials as OS_CLIENT_CONFIG is a standard way of providing credentials and other configuration options, including scm sourced plugin config files for inventory plugins."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe custom virtual environment path is mistaken for a hyperlink in API browser.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a custom virtual env directory\r\n\r\nApply this to a job template, and include a trailing slash, `/`\r\n\r\nLaunch a job from this JT\r\n\r\ngo to job detail view, inspect `job_env`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nprobably best behavior would be to give the virtualenv path without the trailing slash, for general clarity and consistency when consuming the API\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe trailing slash makes it a link\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAttempted fix was made at https://github.com/ansible/awx/pull/3026, but went stale. That link has screenshots.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.2\r\n* Operating System: Redhat\r\n* Web Browser: Google Chrome 73.0.3683.86 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nReplace \"/\" location in the default nginx configuration file by :\r\n\r\nlocation /app/ {\r\n            # Add trailing / if missing\r\n            rewrite ^(.*)/app/(.*[^/])$ $1/$2/ permanent;\r\n            uwsgi_read_timeout 120s;\r\n            uwsgi_pass uwsgi;\r\n            include /etc/nginx/uwsgi_params;            proxy_set_header X-Forwarded-Port 443;\r\n }\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe web UI should be working when run from the subpath /app\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe web UI does not load and get this line in the awx_web logs : \r\n\r\n**WARNING  django.request Not Found: /app/api**\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 4.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.9\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Fresh install AWX 4.0.0 (pull official container from docker hub)\r\n2. Configure an inventory using inventory source and source from project with script\r\n3. Execute sync\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSync should not fail\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<img width=\"1222\" alt=\"Screen Shot 2019-03-29 at 12 08 04 AM\" src=\"https://user-images.githubusercontent.com/10410660/55173562-dcb11000-51b6-11e9-82bd-5272abfad99a.png\">\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSame error when executing the command awx-manage inside the container itself.\r\n\r\n```\r\n[root@awxweb awx]# awx-manage --help\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 11, in <module>\r\n    load_entry_point('awx==4.0.0.0', 'console_scripts', 'awx-manage')()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 124, in manage\r\n    prepare_env()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 89, in prepare_env\r\n    if not settings.DEBUG: # pragma: no cover\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/conf/__init__.py\", line 56, in __getattr__\r\n    self._setup(name)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/conf/__init__.py\", line 41, in _setup\r\n    self._wrapped = Settings(settings_module)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/conf/__init__.py\", line 110, in __init__\r\n    mod = importlib.import_module(self.SETTINGS_MODULE)\r\n  File \"/usr/lib64/python3.6/importlib/__init__.py\", line 126, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 994, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 971, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 955, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 665, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 678, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/settings/production.py\", line 85, in <module>\r\n    include(settings_file, optional(settings_files), scope=locals())\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/split_settings/tools.py\", line 102, in include\r\n    exec(compile(to_compile.read(), included_file, 'exec'), scope)\r\nValueError: source code string cannot contain null bytes\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIn version 2.10, Ansible will implement a breaking change to group naming. Group names will be automatically renamed by default.\r\n\r\nAWX may need some sort of strategy to deal with this.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhttps://github.com/ansible/ansible/blob/d66f3de3dca5d23950c5889858f211da14bc4eb0/lib/ansible/config/base.yml#L1481-L1494\r\n\r\n(env: ANSIBLE_TRANSFORM_INVALID_GROUP_CHARS)\r\n\r\nThings that will break:\r\n\r\n - uses in `--limit`\r\n - references like `groups[\"foo\"]` in playbook namespace\r\n - vars plugins, like in `group_vars/` folder\r\n - accessing groups via named URL or API\r\n - things I didn't think of?\r\n\r\nAt least smart inventories are not a concern, because they don't enable groups.\r\n\r\nYou can not use the configure-tower-in-tower setting to do this.\r\n\r\nYou _can_ use `ansible.cfg` in your source control, but this would need to be adjacent to inventory (in the case of SCM inventory, an increasingly common complaint) and your playbook. Is this sufficient? This could argue in favor of the \"do nothing\" option. Ping @wenottingham "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nAnsible runner(AWX 1.0.6.49) reports incorrect errors while running playbook.\r\nUsually this are filter errors (even on ansible core filters).\r\n\r\nBut the actual error turns out to be in missing dependency in AWX filter/module in project(or in incorrect wrapping of this dependency).\r\n\r\nIn raw ansible run this is reported\r\n1. warning for filter plugins\r\n2. error for modules\r\n\r\nBut AWX silently skips the warnings/errors, runs the playbook and falls on first unrelated filter error in playbook.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.49\r\n* AWX install method: docker-compose on linux\r\n* Ansible version:  2.6.2\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a filter/module which imports some package (i.e. import ncclient  if it's not installed in awx_task image&container)\r\n2. Create playbook which uses some core filter\r\n3. AWX: the playbook will fail with unrelated error\r\n4. Raw ansible in container - playbook will run on filters and fail in module ImportErrors.\r\n\r\nI.e. in ansible awx_task container:\r\n```\r\n[root@awx <SCRUBED>]# ansible -m debug -a msg='{{ \"test\"|regex_search(\".\")  }}' localhost\r\n [WARNING]: Unable to parse /opt/awx/playbooks/<SCRUBED>/hosts as an inventory source\r\n\r\n [WARNING]: No inventory was parsed, only implicit localhost is available\r\n\r\n [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: ImportError: No module named ncclient\r\nlocalhost | FAILED! => {\r\n    \"msg\": \"Unexpected failure during module execution.\",\r\n    \"stdout\": \"\"\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nImport errors/filter load errors are reported.\r\nThere also might be a globally configured mechanism which will fail playbook if something cannot be loaded during run.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nConsequences of failed imports are shown in playbook runs.\r\n\r\nIn AWX task fails with no filter named <filter_name>\r\n```\r\nThe conditional check 'hosts_input|regex_search(' ') failed. The error was: template error while templating string: no filter named 'regex_search'\r\n```\r\n"},{"labels":["api",null,null,null,null],"text":"Hi guys.. \r\n\r\nSeems like some of the plugin scripts (cloudforms.py for one), are not python3 compatible.. (fails with ConfigParser not being able to import, due to rename to configparser).. \r\n\r\nAre these meant to be run in a python2 venv?\r\n\r\nRegards"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nUsage of sat6/foreman inventory plugin was not enabled with https://github.com/ansible/awx/pull/3266\r\n\r\nWe should work on this and enable it in the future\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nWe need to do more research about what differences there may be between script and plugin and get any fixes into ansible core before we can do this."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nUsage of vmware inventory plugin was not enabled with https://github.com/ansible/awx/pull/3266\r\n\r\nWe should work on getting this enabled in the future.\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nWe need to do more research about what differences there may be between script and plugin and get any fixes into ansible core before we can do this."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nUsage of azure plugin was not enabled with https://github.com/ansible/awx/pull/3266 because of this blocking issue in core: https://github.com/ansible/ansible/issues/54065\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThis is getting merged ASAP so at this point we only need to wait for that to land and then make a follow up PR to enable for 2.8+\r\n@AlanCoding "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nFollowon of: https://github.com/ansible/awx/pull/3320\r\n\r\nWe do not verify the custom venv used on launch is actually a currently configured custom venv.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: next (when 3320 is merged)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. set a custom venv path\r\n2. put some venvs in it\r\n3. assign those venvs to things\r\n4. remove the custom venv path\r\n5. launch something from step 3\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFails, due to the venv on the resource not being a current custom venv.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWorks, becuase it happens to still be a path that contains a venv\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInventory update standard out has duplicated content\r\n\r\n##### ENVIRONMENT\r\n* AWX version: right after ansible-runner merge\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate an inventory with an ec2 inventory source that has invalid aws credentials applied to it.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nfailure\r\n\r\n##### ACTUAL RESULTS\r\n\r\nfailure with this\r\n\r\n```\r\n    3.522 INFO     Updating inventory 2245: bad ec2\r\n    3.538 INFO     Reading Ansible inventory source: /awx_devel/awx/plugins/inventory/ec2.py\r\n    3.540 INFO     Using VIRTUAL_ENV: /venv/ansible\r\n    3.540 INFO     Using PATH: /venv/ansible/bin:/venv/awx/bin:/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    3.540 INFO     Using PYTHONPATH: /venv/ansible/lib/python2.7/site-packages:\r\n    6.071 ERROR    ansible-inventory failed (rc=1) with stdout:\r\n\r\nstderr:\r\n [WARNING]:  * Failed to parse /awx_devel/awx/plugins/inventory/ec2.py with\r\nscript plugin: Inventory script (/awx_devel/awx/plugins/inventory/ec2.py) had\r\nan execution error: ERROR: \"Authentication error retrieving ec2 inventory.  -\r\nAWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY environment vars found but may not\r\nbe correct  - No Boto config found at any expected location '/etc/boto.cfg,\r\n~/.boto, ~/.aws/credentials'\", while: getting EC2 instances\r\n\r\n [WARNING]: Unable to parse /awx_devel/awx/plugins/inventory/ec2.py as an\r\ninventory source\r\n\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx', 'console_scripts', 'awx-manage')()\r\n  File \"/awx_devel/awx/__init__.py\", line 140, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 1111, in handle\r\n    raise exc\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 1003, in handle\r\n    data = AnsibleInventoryLoader(source=source, is_custom=self.is_custom, venv_path=venv_path).load()\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 195, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 178, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\n\r\nstderr:\r\n [WARNING]:  * Failed to parse /awx_devel/awx/plugins/inventory/ec2.py with\r\nscript plugin: Inventory script (/awx_devel/awx/plugins/inventory/ec2.py) had\r\nan execution error: ERROR: \"Authentication error retrieving ec2 inventory.  -\r\nAWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY environment vars found but may not\r\nbe correct  - No Boto config found at any expected location '/etc/boto.cfg,\r\n~/.boto, ~/.aws/credentials'\", while: getting EC2 instances\r\n\r\n [WARNING]: Unable to parse /awx_devel/awx/plugins/inventory/ec2.py as an\r\ninventory source\r\n\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nduplicated error\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\ncc @kialam \r\nWhen a job template is launched, the sparkline on the dashboard  shows a green box blinking. When a split job template is launched, ideally it only shows the generated parent workflow job blinking on the sparkline. This is to avoid the sparkline being confusing for a large split job with several \"joblets\". \r\n\r\nWhen the number of hosts = 1, but the split > 1, it shows two boxes blinking on the sparkline, the one host joblet and the split job. This is the only time more than one box blinks when launching a split job, so it appears to be a missed edge case.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Operating System: Fedora\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nMake a job template with split = 2, and with an inventory with only one host. Launch the job. Visit the dashboard or another page with a sparkline that shows the status of the job.\r\n\r\n##### EXPECTED RESULTS\r\nOnly one blinking icon appears, linking to the parent workflow created for the job.\r\n\r\n##### ACTUAL RESULTS\r\nBoth the parent workflow blinking icon appears and the single \"joblet\" icon appears on the sparkline."},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nInventory plugins are configured via `.yml` or `.yaml` files. The UI hits the `api/v2/projects/<id>/inventories/` endpoint and this offers a filtered down list of files that could be used for inventories. While in the past it may have made sense to filter out yaml files, now it does not because that is how one uses inventory plugins.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate project with .yml inventory plugin config files.\r\nCreate an inventory source that uses the project as SCM source.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nThe inventory plugin config files show up when you make a scm sourced inventory source.\r\n\r\n##### ACTUAL RESULTS\r\nFiles did not show up in UI.\r\n\r\nWhile you can specify it via `source_path` on the inventory source with a POST to the API, this file not showing up in the list prevents users from specifying it through UI.\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n@AlanCoding says we need to clarify what we want to do.\r\nHypothetically we could only accept files that match the core distributed inventory plugins, but this would prevent users from using cusom plugins, which we want them to be able to do. Seems like we might have to just let `.yml` and `.yaml` files through."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI am using the splunk external logging. I have noticed, that the \"awx.analytics.job_events\" events get sent to Splunk HEC only for some of the hosts (containing their results) and not for all of them.\r\n\r\nExample, following job output in AWX UI:\r\n```\r\nTASK [Gathering Facts] ********************************************************* 14:03:49\r\nok: [host1]\r\nok: [host2]\r\nok: [host3]\r\nok: [host4]\r\nok: [host5]\r\n [WARNING]: flush_handlers task does not support when conditional\r\n```\r\n\r\nIn Splunk, I can do the following search:\r\n```\r\nindex=ansible sourcetype=ansible:awx_events logger_name=\"awx.analytics.job_events\" job=\"836\" task=\"Gathering facts\"\r\n```\r\n...and I find 4 events:\r\n- one with event=\"playbook_on_task_start\" which just says \"task has started\"\r\n- one with event=\"runner_on_ok\", stdout=\"OK: host3\"\r\n- one with event=\"runner_on_ok\", stdout=\"OK: host4\"\r\n- one with event=\"warning\", stdout=\"Warning: flush_handlers task does not support when conditional\"\r\n\r\nThis is just one example. I am having this behavior (missing runner_on_ok and also missing runner_on_failed events) for almost ALL tasks. This leads to totally wrong statistics. For example, in the play run above, all five hosts have failed at one task, but AWX only sent back errors for two of them (this time, host1 and host4).\r\n\r\nTo make sure it's not an issue with Splunk rejecting or losing messages, I have set up Charles Proxy and AWX to push all HTTP requests through Charles proxy. This way, I have been able to see every HTTP request issued by all AWX related docker containers. I have seen exactly the events shown up in Splunk, not more, and also no rejected requests or such.\r\n\r\nI have no clue what to do to analyze this further...\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: CentOS\r\n* Web Browser: Safari, Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nSet up External logging to splunk for loggers: awx, activity_stream, job_events, system_tracking\r\nstart a job containing at least 5 hosts and 5 tasks,\r\nview results in splunk\r\n\r\n##### EXPECTED RESULTS\r\nfor the above mentioned test case, a total of 5 events of type \"runner_on_ok\", one for each host, should be sent to Splunk.\r\n\r\n##### ACTUAL RESULTS\r\nmissing events, only some events are being received by Splunk\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n<!-- NOt able to create the schedule using awx REST API -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.0-92-gc79fe458c-4\r\n* AWX install method: docker container\r\n* Ansible version:  2.7.8\r\n* Operating System: centOS\r\n* Web Browser: Aany /POSTMAN\r\n\r\n##### STEPS TO REPRODUCE\r\nI am sending below body to create a schedule in AWX but I am not able to create\r\n{\r\n  \"description\": \"Kubernetes Monitor\",\r\n  \"enabled\": \"True\",\r\n  \"verbosity\": \"2\",\r\n  \"job_type\": \"run\",\r\n  \"unified_job_template\": \"8\",\r\n  \"inventory\": \"Kubernetes Monitor Inventory\",\r\n  \"rrule\": \"DTSTART:20500331T055000Z RRULE:FREQ=MINUTELY;INTERVAL=10;COUNT=5\",\r\n  \"name\": \"Kubernetes Monitor CAS Alert Nodes Job Template\"\r\n}\r\n\r\nResponse:\r\nI am getting below response instead.\r\n{\r\n    \"count\": 0,\r\n    \"next\": null,\r\n    \"previous\": null,\r\n    \"results\": []\r\n}\r\n\r\n\r\nam I making mistake somewhere ??"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInventory update events don't stream as update is running, only pile in one big blog around the time it finishes\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel, not released yet\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun an AWS inventory import, stare it as it completes in the UI\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSee standard out _content_, example lines:\r\n\r\n```\r\n    3.199 INFO     Using VIRTUAL_ENV: /venv/ansible\r\n```\r\n\r\n```\r\n   19.495 WARNING  loading into database...\r\n```\r\n\r\n```\r\n   22.483 WARNING  Inventory import completed for efef in 19.3s\r\n```\r\n\r\nYou can see clearly that it takes human-observable time frames to complete its work.\r\n\r\nI expect to be sitting on the page with the 1st and 2nd line examples here for some time before the 3rd one comes in.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe 1st and 2nd lines are delayed until fractions of seconds before the 3rd line\r\n\r\ndata for this example:\r\n\r\ninventory update:\r\n\r\n```json\r\n    \"launch_type\": \"manual\",\r\n    \"status\": \"successful\",\r\n    \"failed\": false,\r\n    \"started\": \"2019-03-22T20:17:15.711855Z\",\r\n    \"finished\": \"2019-03-22T20:17:40.982985Z\",\r\n    \"elapsed\": 25.271,\r\n    \"job_args\": \"[\\\"awx-manage\\\", \\\"inventory_import\\\", \\\"--inventory-id\\\", \\\"2204\\\", \\\"--venv\\\", \\\"/venv/ansible\\\", \\\"--enabled-var\\\", \\\"ec2_state\\\", \\\"--enabled-value\\\", \\\"running\\\", \\\"--group-filter\\\", \\\"^.+$\\\", \\\"--host-filter\\\", \\\"^.+$\\\", \\\"--exclude-empty-groups\\\", \\\"--instance-id-var\\\", \\\"ec2_id\\\", \\\"--source\\\", \\\"/awx_devel/awx/plugins/inventory/ec2.py\\\", \\\"-v1\\\", \\\"--traceback\\\"]\",\r\n    \"job_cwd\": \"/awx_devel/awx/plugins/inventory\",\r\n```\r\n\r\nJob event time stamps:\r\n\r\n```\r\n            \"created\": \"2019-03-22T20:17:40.878608Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.878624Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.871335Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.871349Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.841427Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.841464Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.828497Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.828514Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.776184Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.776205Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.749039Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.749068Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.730497Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.730517Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.741107Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.741126Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.678746Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.678762Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.636237Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.636274Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.611697Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.611716Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.518091Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.518367Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.470178Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.470194Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.430404Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.430420Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.446913Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.446930Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.400742Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.400768Z\",\r\n\r\n            \"created\": \"2019-03-22T20:17:40.368125Z\",\r\n            \"modified\": \"2019-03-22T20:17:40.368142Z\",\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nregression of https://github.com/ansible/awx/issues/1639, ping @chrismeyersfsu \r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWorkflow should allow to select survey question on the fly when that particular template is being started.\r\nCurrently survey question needs to be predefined/answered while creating a WF.  \r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWe use a Git repository where we commit playbooks in, this Git repo is defined as a project in AWX.\r\nJobs are launched, using this project.\r\nThe \"scm update options\" are all disabled in the project settings.\r\n\r\nOur flow compares the Git revision with the one of the AWX project, and triggers a project_update when it's different.\r\n\r\nWe noticed that when a job is running, the scm update remains in a pending state until the job is finished, and only starts after the job has finished.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.4\r\n* Operating System: Debian\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCommit a playbook to Git\r\nRun a project update\r\nRun a playbook job\r\nCommit another playbook to Git\r\nRun a project update\r\n\r\n##### EXPECTED RESULTS\r\n<!-- What did you expect to happen when running the steps above? -->\r\nThe 2nd project update is executed during the 1st playbook job execution\r\n\r\n##### ACTUAL RESULTS\r\n<!-- What actually happened? -->\r\nThe 2nd project update remains pending, until the 1st playbook job is finished\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nWhen running ansible-playbook outside of AWX, and changing the contents of a  role/playbook/... during this run, the playbook run is not affected by these changes.\r\nWhy does an SCM project update in AWX wait until a job is finished, I would think the project update wouldn't impact any running jobs?\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nBefore commit https://github.com/ansible/awx/commit/8b2fc26219afa37f59260db743b1c275d6c93a94 `chrismeyersfsu/runnerpy3 ` if either `psutil` or `python-memcached` were missing from the custom virtual venv, a friendly message was displayed\r\n\r\n  * `psutil is missing; /var/lib/awx/venv/ArtRippO4/bin/pip install psutil`\r\n  * `python-memcached is missing; /var/lib/awx/venv/ArtRippO4/bin/pip install python-memcached`\r\n\r\nThis message is now gone (as the callback where the message were displayed is gone), and now ` ERROR! Unexpected Exception, this is probably a bug: No module named psutil` is raised\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a custom virtual environment with `psutil` or `python-memcached` missing\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWe used to have a friendly error message\r\n\r\n##### ACTUAL RESULTS\r\n\r\nLess friendly error message"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nWhen user has USE permission on job template, it sees all jobs and thus job logging, survey data, etc, from all other users having access to this job template as well. This is seen as information leakage. Auditors and security officers do not like this. Users should see job info only for jobs it has permission to see. This includes his own jobs, and, though some RBAC control(s) jobs from other users.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.4.1\r\n* AWX install method: non-docker\r\n* Ansible version:  2.7.0\r\n* Operating System: RHEL7\r\n* Web Browser: Firefox 66\r\n\r\n##### STEPS TO REPRODUCE\r\nAs user1, create a JT and give USE permission to user2 and user3\r\nAs user1, run the JT\r\nAs user2, run the JT\r\nAs user3, run the JT\r\nAs user3, look at jobs\r\n\r\n##### EXPECTED RESULTS\r\nAs user1, I see only my own jobs\r\nAs user2, I see only my own jobs\r\nAs user3, I see only my own jobs\r\n\r\n##### ACTUAL RESULTS\r\nAs userx, I see jobs from user1, user2 and user3\r\n\r\n##### ADDITIONAL INFORMATION\r\nSometimes it would be usefull to see JOBS on JT ran by another user/team. No recommendation on how RBAC should be set up to allow that.\r\nFiles as a bug and not as a feature request on purpose."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nHello, I have written a playbook to create ALB on AWS. The playbook is working if i am executing it on directly on a Linux tty, but same playbook with AWX giving error as bellow. \r\n\r\nAWX is not taking both the subnets simultaneously, it s taking subnet id one by one. Please suggest me in order to resolve the issue.\r\n. \r\nTASK [Creating ALB] ************************************************************\r\ntask path: /var/lib/awx/projects/_225__sccoe_awx_dev/ELB_ALB/ELB_ALB-Playbook.yml:97\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: ClientError: An error occurred (ValidationError) when calling the CreateLoadBalancer operation: At least two subnets in two different Availability Zones must be specified\r\nfailed: [10.218.110.183] (item=subnet-8e471ea3) => {\"boto3_version\": \"1.5.20\", \"botocore_version\": \"1.8.34\", \"changed\": false, \"error\": {\"code\": \"ValidationError\", \"message\": \"At least two subnets in two different Availability Zones must be specified\", \"type\": \"Sender\"}, \"item\": \"subnet-8e471ea3\", \"msg\": \"An error occurred (ValidationError) when calling the CreateLoadBalancer operation: At least two subnets in two different Availability Zones must be specified\", \"response_metadata\": {\"http_headers\": {\"connection\": \"close\", \"content-length\": \"337\", \"content-type\": \"text/xml\", \"date\": \"Fri, 22 Mar 2019 06:23:55 GMT\", \"x-amzn-requestid\": \"121490cf-4c6b-11e9-b02c-3f673408bdd8\"}, \"http_status_code\": 400, \"request_id\": \"121490cf-4c6…\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: ClientError: An error occurred (ValidationError) when calling the CreateLoadBalancer operation: At least two subnets in two different Availability Zones must be specified\r\nfailed: [10.218.110.183] (item=subnet-a99049f1) => {\"boto3_version\": \"1.5.20\", \"botocore_version\": \"1.8.34\", \"changed\": false, \"error\": {\"code\": \"ValidationError\", \"message\": \"At least two subnets in two different Availability Zones must be specified\", \"type\": \"Sender\"}, \"item\": \"subnet-a99049f1\", \"msg\": \"An error occurred (ValidationError) when calling the CreateLoadBalancer operation: At least two subnets in two different Availability Zones must be specified\", \"response_metadata\": {\"http_headers\": {\"connection\": \"close\", \"content-length\": \"337\", \"content-type\": \"text/xml\", \"date\": \"Fri, 22 Mar 2019 06:24:00 GMT\", \"x-amzn-requestid\": \"14d7f6e3-4c6b-11e9-b188-978194d0c8e9\"}, \"http_status_code\": 400, \"request_id\": \"14d7f6e3-4c6…\r\n\r\n\r\n\r\n##### ENVIRONMENT\r\nTower CLI 3.2.1\r\nAPI v2\r\nAWX 2.0.1\r\nAnsible 2.7.1\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen external logger (like Splunk) is configured, it makes the live event performance be very slow.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Tower 3.4.2\r\n* Operating System:  RHEL 7.6\r\n* Web Browser: Chrome 73\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nA Tower customer reported this issue.\r\n\r\nWhen external logger (Splunk) is enabled, job output not displayed or very slow to be displayed in Web UI.  And sometimes external logging was failed, which may occur #2008 .\r\nAnd this external logger is disabled, the issue was resolved.\r\n\r\n\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\nBreaking out final acceptance criteria for aws_ec2 plugin because won't ship with first PR for https://github.com/ansible/awx/issues/171\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWe want parity when using Amazon EC2 inventory source between scripts and plugins for:\r\n- hostvars\r\n- default grouping + group names that are generated by it\r\n- group_by options _ group names that are generated by it\r\n- hostnames\r\n- source var config override options\r\n\r\nThe current known blockers are in the category of source vars (default is listed with key):\r\n- []  `'nested_groups': 'False',`\r\n- [] `'pattern_exclude': None,  # duplicated with instance filters`\r\n- [] `'pattern_include': None,  # duplicated with instance filters`\r\n- [] `'iam_role': None,` https://github.com/ansible/ansible/issues/54059\r\n- [] `'stack_filters': 'False',` # interacts with instance filters\r\n- [] `'vpc_destination_variable': 'ip_address'`\r\n- [ ] `'expand_csv_tags': 'False',`\r\n\r\nNo parity but we think we need to punt because it never worked in the first place:\r\n- `'destination_variable': 'public_dns_name',`\r\n- `'hostname_variable': None`\r\n\r\nNo parity because we enforce our own setting:\r\n\r\n- `'replace_dash_in_groups': 'True',`\r\n\r\n\r\nCurrent known DONE items (or are implemented by other features like group_by):\r\n- `'boto_profile': None`\r\n- `'group_by_ami_id': 'True',`\r\n- `'group_by_availability_zone': 'True',`\r\n- `'group_by_aws_account': 'False',`\r\n- `'group_by_instance_id': 'True',`\r\n- `'group_by_instance_state': 'False',`\r\n- `'group_by_instance_type': 'True',`\r\n- `'group_by_key_pair': 'True',`\r\n- `'group_by_platform': 'True',`\r\n- `'group_by_region': 'True',`\r\n- `'group_by_security_group': 'True',`\r\n- `'group_by_tag_keys': 'True',`\r\n- `'group_by_tag_none': 'True',`\r\n- `'group_by_vpc_id': 'True',`\r\n- `'regions': 'all',`  # duplicated with source regions\r\n- `'regions_exclude': 'us-gov-west-1, cn-north-1',`  # duplicated with source regions\r\n\r\nNo parity because plugin is only EC2 and we only ever supported use of EC2 script for EC2 even though it really did more than that:\r\n\r\n- `'group_by_route53_names': 'True',`\r\n- `'group_by_elasticache_cluster': 'True',`\r\n- `'group_by_elasticache_engine': 'True',`\r\n- `'group_by_elasticache_parameter_group': 'True',`\r\n- `'group_by_elasticache_replication_group': 'True',`\r\n- `'group_by_rds_engine': 'True',`\r\n- `'group_by_rds_parameter_group': 'True',`\r\n- `'route53': 'False'`  # was not supported in the group_by options\r\n- `'route53_excluded_zones': '',`\r\n- `'route53_hostnames': None,`\r\n- `'rds': 'False',`\r\n- `'all_elasticache_clusters': 'False',`\r\n- `'all_elasticache_nodes': 'False',`\r\n- `'all_elasticache_replication_groups': 'False',`\r\n- `'all_rds_instances': 'False',`\r\n- `'elasticache': 'True',`\r\n- `'eucalyptus': 'False',`\r\n- `'eucalyptus_host': None,`\r\n\r\n???? Don't know whats up with these\r\n\r\n- `'cache_max_age': '300',`\r\n- `'cache_path': '~/.ansible/tmp',`\r\n- `'all_instances': 'False',`\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nWill update with related issues if they arise for individual vars\\\r\n@AlanCoding , you know who you are"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nRight now, an inventory source type can only have one instance_id value.\r\n\r\nThis issue is to allow a list of values for instance_id, where it will find the identifier by looking at the first one, and the falling back to the 2nd, 3rd, etc.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe reason is that the inventory plugins have changed the keys for hostvars, including the ones we use for instance_ids.\r\n\r\nIf we ever allow the YAML inventory config to be customizable (and we should), then we need to anticipate the scenario where we get the instance ID by the new name but not the old name.\r\n\r\nConcretely...\r\n\r\n| Source   | old key | new key     |\r\n|----------|---------|-------------|\r\n| ec2      | ec2_id  | instance_id |\r\n| gce      | gce_id  | id          |\r\n| azure_rm | id      | id          |\r\n\r\nIn https://github.com/ansible/awx/pull/3266, we have a solution to create the old key via the `compose` options from the old key. That will work for now, but again, we want to allow user customizations. We don't want to constrain them. Solving this issue will allows us to allow the users to remove that variable translation.\r\n\r\nSo, not urgent, but definitely what we want long-term. Ping @kdelee @wenottingham "},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nEnable enhanced RBAC LDAP mapping for the drilled down org admin roles such as project admin, workflow admin, etc.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nRight now you can only specify inventory that you want a workflow to run with, there is no way to create a limit for subset of servers that workflow is going to run for\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nThe customer of Tower has multiple inventories that run the same playbook. They would like to boot a system from any inventory, and have it call back to Tower, and update it's corresponding inventory and provision based on userdata.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nRight now when you open permission tab, you often see mysterious users with some privileges and you have hard times understanding why they have them - it would be epic if UI told you the reason, like some ? icon which if you hovered on, displayed something like \"User is admin because they are admin of organization XX this item belongs to\".\r\n\r\nI am currently running into some weird privilege conditions which are probably bugs, and I am unable to determine why users have admin privileges on items they definitely shouldn't have. This would help.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n \r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nPlease allow the use of the same job template name across multiple organizations. This should allow for better use of multi tenant environments.\r\n\r\n##### ADDITIONAL INFORMATION\r\nCurrently the name field is unique across the entire Tower/AWX installation. \r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n - Ability to pass `limit`to `/api/v2/workflow_job_templates/{id}/launch/`, like we can when sending a post to `/api/v2/job_templates/{id}/launch/`\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI've noticed a couple similar, yet not quite identical requests come through before, specifically issues #[501](https://github.com/ansible/awx/issues/501) and [169](https://github.com/ansible/awx/issues/169). This request is specifically targeting the `limit` functionality, which does not appear to be addressed in those Issues\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n##### SUMMARY\r\n\r\nTrying to configure Dynamic Inventory in AWX against Azure environment\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.8\r\n* Operating System: CentOS7.4\r\n* Web Browser: Chrome 70.0.x\r\n* cURL: 7.63.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create Azure Credentials\r\n2. Create Inventory sourcing Azure Resource Manager\r\n3. Verify that Azure resources have been discovered\r\n4. Create variables in Inventory to contain settings (like in azure_rm.ini):\r\n\r\n{\r\n \"resource_groups\": \"mygroup1\",\r\n \"tags\": \"zookeepernodes, zookeeper_id: zkid\",\r\n \"group_by_resource_group\": yes,\r\n \"group_by_location\": yes,\r\n \"group_by_security_group\": yes,\r\n \"group_by_tag\": yes,\r\n \"use_private_ip\": yes,\r\n \"location\": \"eastus2\",\r\n \"include_powerstate\": yes\r\n}\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expected the inventory would be populated based on settings provided (narrowed down to Resource group: \"mygroup1\", which hosts defined in tag: \"zookeepernodes\"\r\n\r\nIf possible, can I pass bool ```use_private_ip``` to it ? \r\n\r\n##### ACTUAL RESULTS\r\n\r\nAWX is still displaying all hosts in the inventory as well as all groups!!!\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nnull"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nMake it possible to relaunch job with higher verbosity for debugging purposes. If job fails on few hosts and you need to see more verbose output this would be great thing."},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nI'm running into challenges getting AWX scaled up in Kubernetes to higher instance counts, specifically that it is overwhelming our PostgreSQL 9.6 external database with connections. Our target instance count is 16, and we're seeing PostgreSQL connection counts climbing the hundreds until we hit `max_connections`. With PostgreSQL being so heavy connection-wise, we're trying to keep the number of connections to a reasonable number.\r\n\r\nI've tried multiplexing connections via pgbouncer. In `session` pool mode there doesn't seem to be much change other than AWX creating more and more connections until they get queued instead of refused.\r\n\r\n In `transaction`pool mode the cluster heartbeat tasks intermittently fail due to the use of advisory locks, so it seems the usual methods of multiplexing connections are non-starters.\r\n\r\nI've also tried using persistent connections (`CONN_MAX_AGE: None`) and closing connections immediately (`CONN_MAX_AGE: 0`) in combination with session pool_mode, but I'm not coming across a configuration that prevents connections from continuing to grow and grow until they either queue or are refused. \r\n\r\nIs there any documentation or design guidance around scaling to higher instance counts for the PostgreSQL side of the equation?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2\r\n* AWX install method: kubernetes with external PGSQL db\r\n* Ansible version:  latest (multiple venvs)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure external PostgreSQL database, scale up number of AWX instances until PostgreSQL `max_connections` is reached. The connections are idle most of the time.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAWX re-uses one database connection per container when `CONN_MAX_AGE: None`, will close the connection when `CONN_MAX_AGE: 0` for re-use by the pool,  or can handle pgbouncer multiplexing in `transaction` pool mode. I would expect a max of 64 db connections for 16 instances * 4 containers per instance.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nFor 16 instances, and more connections were desired by AWX at the time of this query.\r\n```\r\nawx=# SELECT  * FROM\r\n(SELECT count(*) used, state FROM pg_stat_activity GROUP BY 2) q1,\r\n(SELECT setting::INT res_for_super FROM pg_settings WHERE name=$$superuser_reserved_connections$$) q2,\r\n(SELECT setting::INT max_conn FROM pg_settings WHERE name=$$max_connections$$) q3;\r\n used | state  | res_for_super | max_conn \r\n------+--------+---------------+----------\r\n    1 | active |             3 |      200\r\n  196 | idle   |             3 |      200\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nOn three instances, here is our current connection count:\r\n\r\n```\r\nawx=# SELECT  * FROM\r\n(SELECT count(*) used, state FROM pg_stat_activity GROUP BY 2) q1,\r\n(SELECT setting::INT res_for_super FROM pg_settings WHERE name=$$superuser_reserved_connections$$) q2,\r\n(SELECT setting::INT max_conn FROM pg_settings WHERE name=$$max_connections$$) q3;\r\n used | state  | res_for_super | max_conn \r\n------+--------+---------------+----------\r\n    1 | active |             3 |      100\r\n   31 | idle   |             3 |      100\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nError to login in AWX web UI.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: Debian 9\r\n* Web Browser: Firefox, Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nInstall AWX with Docker on Linux using playbook from git repository. All is fine. Configuration was successfully with awx-cli (organization, projects, inventories, job templates...).\r\nOpen awx web in a browser and enter credentials for the admin user.\r\n\r\n##### EXPECTED RESULTS\r\nI can login in AWX web application and see dashboard.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nI can not login. The web application returns that credentials are invalid.\r\nThe following error appear in the logs of the `awx_web` container :\r\n\r\n> Traceback (most recent call last):\r\n>   File \"/usr/lib64/python3.6/logging/__init__.py\", line 995, in emit\r\n>     stream.write(msg)\r\n> UnicodeEncodeError: 'ascii' codec can't encode character '\\xe9' in position 879: ordinal not in range(128)\r\n> \r\n> During handling of the above exception, another exception occurred:\r\n> Traceback (most recent call last):\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n>     response = get_response(request)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/wsgi.py\", line 71, in _legacy_get_response\r\n>     return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n>     response = self._get_response(request)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n>     response = self.process_exception_by_middleware(e, request)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n>     response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n>   File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n>     return func(*args, **kwds)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\n>     return self.dispatch(request, *args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n>     return bound_func(*args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/views/decorators/debug.py\", line 76, in sensitive_post_parameters_wrapper\r\n>     return view(request, *args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n>     return func.__get__(self, type(self))(*args2, **kwargs2)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n>     return bound_func(*args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/utils/decorators.py\", line 149, in _wrapped_view\r\n>     response = view_func(request, *args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n>     return func.__get__(self, type(self))(*args2, **kwargs2)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n>     return bound_func(*args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/views/decorators/cache.py\", line 57, in _wrapped_view_func\r\n>     response = view_func(request, *args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n>     return func.__get__(self, type(self))(*args2, **kwargs2)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/contrib/auth/views.py\", line 90, in dispatch\r\n>     return super(LoginView, self).dispatch(request, *args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/views/generic/base.py\", line 88, in dispatch\r\n>     return handler(request, *args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/api/generics.py\", line 83, in post\r\n>     ret = super(LoggedLoginView, self).post(request, *args, **kwargs)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/views/generic/edit.py\", line 182, in post\r\n>     if form.is_valid():\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/forms/forms.py\", line 183, in is_valid\r\n>     return self.is_bound and not self.errors\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/forms/forms.py\", line 175, in errors\r\n>     self.full_clean()\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/forms/forms.py\", line 385, in full_clean\r\n>     self._clean_form()\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/forms/forms.py\", line 412, in _clean_form\r\n>     cleaned_data = self.clean()\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/contrib/auth/forms.py\", line 187, in clean\r\n>     self.user_cache = authenticate(self.request, username=username, password=password)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/contrib/auth/__init__.py\", line 70, in authenticate\r\n>     user = _authenticate_with_backend(backend, backend_path, request, credentials)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/contrib/auth/__init__.py\", line 116, in _authenticate_with_backend\r\n>     return backend.authenticate(*args, **credentials)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/sso/backends.py\", line 88, in authenticate\r\n>     if self.settings.START_TLS and ldap.OPT_X_TLS_REQUIRE_CERT in self.settings.CONNECTION_OPTIONS:\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/sso/backends.py\", line 79, in _get_settings\r\n>     self._settings = LDAPSettings(self.settings_prefix)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/sso/backends.py\", line 49, in __init__\r\n>     super(LDAPSettings, self).__init__(prefix, defaults)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django_auth_ldap/backend.py\", line 994, in __init__\r\n>     value = getattr(django.conf.settings, prefix + name, default)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py\", line 542, in __getattr_without_cache__\r\n>     return getattr(self._wrapped, name)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py\", line 446, in __getattr__\r\n>     value = self._get_local(name)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/conf/settings.py\", line 432, in _get_local\r\n>     value, name, exc_info=True)\r\n>   File \"/usr/lib64/python3.6/logging/__init__.py\", line 1319, in warning\r\n>     self._log(WARNING, msg, args, **kwargs)\r\n>   File \"/usr/lib64/python3.6/logging/__init__.py\", line 1443, in _log\r\n>     self.handle(record)\r\n>   File \"/usr/lib64/python3.6/logging/__init__.py\", line 1453, in handle\r\n>     self.callHandlers(record)\r\n>   File \"/usr/lib64/python3.6/logging/__init__.py\", line 1515, in callHandlers\r\n>     hdlr.handle(record)\r\n>   File \"/usr/lib64/python3.6/logging/__init__.py\", line 864, in handle\r\n>     self.emit(record)\r\n>   File \"/usr/lib64/python3.6/logging/__init__.py\", line 999, in emit\r\n>     self.handleError(record)\r\n>   File \"/usr/lib64/python3.6/logging/__init__.py\", line 917, in handleError\r\n>     traceback.print_exception(t, v, tb, None, sys.stderr)\r\n>   File \"/usr/lib64/python3.6/traceback.py\", line 101, in print_exception\r\n>     print(line, file=file, end=\"\")\r\n> UnicodeEncodeError: 'ascii' codec can't encode character '\\xe9' in position 47: ordinal not in range(128)\r\n> \r\n\r\n##### ADDITIONAL INFORMATION\r\nAfter multiple tries, I found the problem origin. It occurs for browser configured with preferred display language defined to French (fr-FR). An error occurs when this header is present on the request :\r\n`Accept-Language | fr-FR,en-US;q=0.7,en;q=0.3`\r\nAll is fine if browser is configured for english language (en-US) and this header is present on the request :\r\n`Accept-Language | en-US,en;q=0.7,fr-FR;q=0.3`\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - I am unable to install AWX on kubernetes using https://github.com/ansible/awx\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\n\r\nPLAY [Build and deploy AWX] **********************************************************************************************************\r\n\r\nTASK [check_vars : include_tasks] ****************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [check_vars : include_tasks] ****************************************************************************************************\r\nincluded: /home/kube30/awx/installer/roles/check_vars/tasks/check_docker.yml for localhost\r\n\r\nTASK [check_vars : postgres_data_dir should be defined] ******************************************************************************\r\nok: [localhost] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [check_vars : host_port should be defined] **************************************************************************************\r\nok: [localhost] => {\r\n    \"changed\": false,\r\n    \"msg\": \"All assertions passed\"\r\n}\r\n\r\nTASK [image_build : Set global version if not provided] ******************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Verify awx-logos directory exists for official install] **********************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Copy logos for inclusion in sdist] *******************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Set sdist file name] *********************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : AWX Distribution] ************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stat distribution file] ******************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Clean distribution] **********************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build sdist builder image] ***************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build AWX distribution using container] **************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build AWX distribution locally] **********************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Set docker build base path] **************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Set awx_web image name] ******************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Set awx_task image name] *****************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Ensure directory exists] *****************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage sdist] *****************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Template web Dockerfile] *****************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Template task Dockerfile] ****************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage launch_awx] ************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage launch_awx_task] *******************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage nginx.conf] ************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage supervisor.conf] *******************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage supervisor_task.conf] **************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage settings.py] ***********************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage requirements] **********************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage config watcher] ********************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage Makefile] **************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage ansible repo] **********************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Stage ansible repo key] ******************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build base web image] ********************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Build base task image] *******************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Tag task and web images as latest] *******************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_build : Clean docker base directory] *************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Authenticate with Docker registry if registry password given] *****************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Remove web image] *************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Remove task image] ************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Tag and push web image to registry] *******************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Tag and push task image to registry] ******************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [image_push : Set full image path for Registry] *********************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : fail] *************************************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : include_tasks] ****************************************************************************************************\r\nskipping: [localhost] => (item=openshift_auth.yml)\r\nskipping: [localhost] => (item=openshift.yml)\r\n\r\nTASK [kubernetes : include_tasks] ****************************************************************************************************\r\nincluded: /home/kube30/awx/installer/roles/kubernetes/tasks/kubernetes_auth.yml for localhost\r\nincluded: /home/kube30/awx/installer/roles/kubernetes/tasks/kubernetes.yml for localhost\r\n\r\nTASK [kubernetes : Set the Kubernetes Context] ***************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Get Namespace Detail] *********************************************************************************************\r\nchanged: [localhost]\r\n\r\nTASK [kubernetes : Create AWX Kubernetes Project] ************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Set postgresql service name] **************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Use kubectl or oc] ************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : set_fact] *********************************************************************************************************\r\nok: [localhost]\r\n\r\nTASK [kubernetes : Record deployment size] *******************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": \"kubectl get sts awx -n awx -o=jsonpath='{.status.replicas}'\", \"delta\": \"0:00:00.100814\", \"end\": \"2019-03-12 12:21:13.486161\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2019-03-12 12:21:13.385347\", \"stderr\": \"Error from server (NotFound): statefulsets.apps \\\"awx\\\" not found\", \"stderr_lines\": [\"Error from server (NotFound): statefulsets.apps \\\"awx\\\" not found\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n...ignoring\r\n\r\nTASK [kubernetes : Set expected post-deployment Replicas value] **********************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Delete existing Deployment] ***************************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Get Postgres Service Detail] **************************************************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": \"kubectl describe svc awx-postgresql -n awx\", \"delta\": \"0:00:00.119227\", \"end\": \"2019-03-12 12:21:13.941072\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2019-03-12 12:21:13.821845\", \"stderr\": \"Error from server (NotFound): services \\\"awx-postgresql\\\" not found\", \"stderr_lines\": [\"Error from server (NotFound): services \\\"awx-postgresql\\\" not found\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n...ignoring\r\n\r\nTASK [kubernetes : Template PostgreSQL Deployment (OpenShift)] ***********************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Deploy and Activate Postgres (OpenShift)] *************************************************************************\r\nskipping: [localhost]\r\n\r\nTASK [kubernetes : Deploy and Activate Postgres (Kubernetes)] ************************************************************************\r\nfatal: [localhost]: FAILED! => {\"censored\": \"the output has been hidden due to the fact that 'no_log: true' was specified for this result\", \"changed\": true}\r\n        to retry, use: --limit @/home/kube30/awx/installer/install.retry\r\n\r\nPLAY RECAP ***************************************************************************************************************************\r\nlocalhost                  : ok=12   changed=4    unreachable=0    failed=1\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAllow ssh key management and jump host configuration. Currently its all via file system and have to be managed manually. It will be great if its something that can be done via UI.\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n##### SUMMARY\r\n\r\nTrying to list inventory using cURL + token but getting 401 error\r\n\r\n```curl: (22) The requested URL returned error: 401 Unauthorized```\r\n\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.8\r\n* Operating System: CentOS7.4\r\n* Web Browser: Chrome 70.0.x\r\n* cURL: 7.63.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Deploy AWX in Azure\r\n* Integrate with Azure AD\r\n* Change System Settings to ```Allow External Users To Create Oath2 Tokens```\r\n* Login to AWX using Azure AD credentials to confirm that it works\r\n* Log out and re-login with ```admin``` credentials\r\n* Create organization\r\n* Add newly-autocreated (Azure AD) user to organization\r\n* Assign permissions: \"project-admin\" to user (me)\r\n* Login as myself\r\n* Generate token\r\n* In terminal, export token (i.e., ```export token=XXXXXX```)\r\n\r\nTry to obtain inventories using cURL:\r\n```\r\ncurl -H \"Authorization:Token $token\" -f -k -H \"content-Type: application/json\" -X GET http://192.168.2.37/api/v2/inventories/  | jq .\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\ncurl: (22) The requested URL returned error: 401 Unauthorized\r\n\r\n```\r\n##### EXPECTED RESULTS\r\n\r\n* User is part of organization\r\n* User has ```project admin``` privileges\r\n* User using AWX-generated token\r\n* I expected an inventory list to be returned, but received 401 instead.\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n curl: (22) The requested URL returned error: 401 Unauthorized\r\n```"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n##### SUMMARY\r\nAzure Authentication integrated environment. Trying to authenticate to obtain token. Error: detail:\r\n\r\n```Authentication credentials were not provided. To establish a login session, visit /api/login/```\r\n\r\nI am referencing document - https://docs.ansible.com/ansible-tower/latest/html/administration/oauth2_token_auth.html#ag-use-oauth-pat\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.8\r\n* Operating System: CentOS7.4\r\n* Web Browser: Chrome 70.0.x\r\n* cURL: 7.63.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Deploy AWX in Azure\r\n* Integrate with Azure AD\r\n* Change System Settings to ```Allow External Users To Create Oath2 Tokens```\r\n* Login to AWX using Azure AD credentials to confirm that it works\r\n* Log out and re-login with ```admin``` credentials\r\n* Create organization\r\n* Add newly-autocreated (Azure AD) user to organization\r\n\r\nTry to login using Azure AD credentials using cURL:\r\n```\r\ncurl -ku <AzureAD UserName>:'<Azure AD Password>' -H \"Content-Type: application/json\" -X POST -d '{\"description\":\"Tower CLI\", \"application\":null, \"scope\":\"write\"}' http://192.168.2.37/api/v2/users/1/personal_tokens/ | jq .\r\n\r\n{\"detail\":\"Authentication credentials were not provided. To establish a login session, visit /api/login/.\"}% \r\n```\r\n##### EXPECTED RESULTS\r\n\r\nI expect a token to be returned\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n{\"detail\":\"Authentication credentials were not provided. To establish a login session, visit /api/login/.\"}% \r\n```\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nIf there is an ssh client config on `/etc/ssh/ssh_config.d/xxx.conf`, playbook will fail to run with the following error message `Bad owner or permissions on /etc/ssh/ssh_config.d/xxx.conf`\r\n\r\n##### ENVIRONMENT\r\n\r\n  * AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nNote: `openssh-clients >=7.3p` is required for the Include mechanism to exists\r\n\r\n* On the system\r\n\r\n```\r\n[root@spredzy-osp-rhel8 utils]# cat /etc/ssh/ssh_config\r\nInclude /etc/ssh/ssh_config.d/*.conf\r\n[root@spredzy-osp-rhel8 utils]# cat /etc/ssh/ssh_config.d/xxx.conf \r\nInclude /etc/crypto-policies/back-ends/openssh.config\r\n\r\nHost *\r\n        GSSAPIAuthentication yes\r\n[root@spredzy-osp-rhel8 utils]#\r\n```\r\n\r\n* In tower\r\n\r\n  * Have a project that uses git scm and a private github repo (might apply elsewhere to)\r\n  * Try to synchro the project\r\n\r\n##### EXPECTED RESULTS\r\n\r\n  - Project synchronizes\r\n\r\n##### ACTUAL RESULTS\r\n\r\n  - Project fails to synchronize\r\n\r\n```\r\ndentity added: /tmp/awx_380_2k9_fd8g/credential_147 (/tmp/awx_380_2k9_fd8g/credential_147)                                                                                                    \r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\n\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [delete project directory before update] **********************************\r\nskipping: [localhost] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\n\r\nTASK [check repo using git] ****************************************************\r\n\r\nskipping: [localhost] => {\"changed\": false, \"skip_reason\": \"Conditional result was False\"}\r\n\r\nTASK [update project using git] ************************************************\r\n\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": \"/usr/bin/git clone --origin origin '' /var/lib/awx/projects/_279__test\", \"msg\": \"Cloning into '/var/lib/awx/projects/_279__test'...\\\\nBad owner or permissions on /etc/ssh/ssh_config.d/05-redhat.conf\\\\r\\\\nfatal: Could not read from remote repository.\\\\n\\\\nPlease make sure you have the correct access rights\\\\nand the repository exists.\", \"rc\": 128, \"stderr\": \"Cloning into '/var/lib/awx/projects/_279__test'...\\\\nBad owner or permissions on /etc/ssh/ssh_config.d/05-redhat.conf\\\\r\\\\nfatal: Could not read from remote repository.\\\\n\\\\nPlease make sure you have the correct access rights\\\\nand the repository exists.\\\\n\", \"stderr_lines\": [\"Cloning into '/var/lib/awx/projects/_279__test'...\", \"Bad owner or permissions on /etc/ssh/ssh_config.d/05-redhat.conf\", \"fatal: Could not read from remote repository.\", \"\", \"Please make sure you have the correct access rights\", \"and the repository exists.\"], \"stdout\": \"\", \"stdout_lines\": []} \r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n  - N/A"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCurrently if we traverse to SETTINGS > SYSTEM we have a option `ORGANIZATION ADMINS CAN MANAGE USERS AND TEAMS` through which an Org Admin can manage both Users and Teams if turned On. But it'll be nice if we have two separate options `ORGANIZATION ADMINS CAN MANAGE USERS` and `ORGANIZATION ADMINS CAN MANAGE TEAMS` so that it'll easy to delegate permission to org Admin for user/team management."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nNotify the awx and tower user of new releases in the UI. If we notify users of awx and tower of our new releases within the UI:\r\n- We can encourage users to keep up with development\r\n- Increase general awareness of our new release cadence\r\n- Encourage users to migrate away from deprecated versions of Tower\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWe could do this through pendo guides or a navbar item. Maybe a notification bell?\r\nThis could double as a way to inform users that their version of tower is out of date or about to hit EOL.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAllow venv to be set on inventory source and use default of the ansible venv we ship.\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis is my idea to resolve a usability issue that has come to my attention. If users are using the Organization level VENV, we may put them at risk of breaking their inventory updates.\r\n\r\n* If they use ansible 2.3 in this venv, which we still allow in custom venvs, their inventory updates will be completely broken because we call `ansible-inventory` which does not exist in this version\r\n\r\n* They may be used to letting their jobs run in a special venv that they love but does not provide necessary dependencies that the inventory sources they rely on need. Their inventory updates may start blowing up/breaking and they be confused as to why it used to work, and it may not be obvious to them that NOW their inventory updates are happening in the venv set at the org level and they are missing dependencies\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nIdeally this would be same workflow as is present on Job Templates.\r\n![screenshot from 2019-03-07 14-18-06](https://user-images.githubusercontent.com/29239279/53982829-e37ec280-40e3-11e9-99dc-23dcffc487df.png)\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nSee https://github.com/ansible/ansible/pull/52748\r\n\r\nAnsible core is moving to a default behavior where group name characters which are not alphanumeric get automatically replaced with underscores.\r\n\r\nIn this world, we should not allow users to enter names with such characters.\r\n\r\nInventory sources, those should be covered by Ansible core behavior. Manually entered names should be validated.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWe have also hesitated to valid host names, even though many syntaxes will break playbooks. I figure I would throw that in here, but we can separate it.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nthe [tower_job_template](https://docs.ansible.com/ansible/latest/modules/tower_job_template_module.html) module today does not have the ability to use any credential type, and I need to be able to use AWS.\r\n\r\nI register the result from the tower_credential module and I register the result from the tower_job_template module to get the id for the credential and job template, I then use the URI module to associate the AWS module to the correct job template.  This works, but only works one time, if I re-run the Playbook the tower API is not happy, it doesn't see it already has a matching credential in there.  The full Playbook is [located here](https://gist.github.com/IPvSean/6074d7a77ee2e39cd180f6fb0be5b4a6)\r\n\r\n##### ADDITIONAL INFORMATION\r\ntask that will fail\r\n\r\n```\r\n    - name: ASSOCIATE AWS CREDENTIAL TO JOB TEMPLATE\r\n      uri:\r\n        url: \"https://{{host}}/api/v2/job_templates/{{create_first_job.id}}/credentials/\"\r\n        user: \"{{username}}\"\r\n        password: \"{{password}}\"\r\n        method: POST\r\n        validate_certs: False\r\n        force_basic_auth: yes\r\n        body_format: json\r\n        body: ' {\"id\": {{credential.id}}}'\r\n        status_code:\r\n          - 200\r\n          - 204\r\n```\r\n\r\nfirst time works!\r\n\r\n2nd time does this->\r\n```    error: Cannot assign multiple Amazon Web Services credentials.```\r\n\r\n\r\n\r\nrull error is here->\r\n```\r\nTASK [ASSOCIATE AWS CREDENTIAL TO JOB TEMPLATE] *****************************************************************************************************************************************\r\nfatal: [localhost]: FAILED! => changed=false\r\n  allow: GET, POST, HEAD, OPTIONS\r\n  connection: close\r\n  content: '{\"error\":\"Cannot assign multiple Amazon Web Services credentials.\"}'\r\n  content_language: en\r\n  content_length: '67'\r\n  content_type: application/json\r\n  date: Thu, 07 Mar 2019 15:27:45 GMT\r\n  json:\r\n    error: Cannot assign multiple Amazon Web Services credentials.\r\n  msg: 'Status code was 400 and not [200, 204]: HTTP Error 400: Bad Request'\r\n  redirected: false\r\n  server: nginx/1.12.2\r\n  status: 400\r\n  url: https://ansible.rhdemo.io/api/v2/job_templates/75/credentials/\r\n  vary: Accept, Accept-Language, Cookie\r\n  x_api_node: localhost\r\n  x_api_time: 0.083s\r\n  x_api_total_time: 0.101s\r\n\tto retry, use: --limit @/Users/sean/Documents/GitHub/IPvSean/linklight-local/provisioner/tests/setup_tower.retry\r\n```"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI have Azure PostgreSQL service which requires login as user@host, but roles in PostgresSQL are just \"user\" without \"@host\", which cause \"no such role error\" \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.8\r\n* Operating System: RHEL7\r\n* Web Browser: n/a\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate Azure Database for PostgreSQL , change variables in inventory, run install yml  and see the logs of awx_task\r\n\r\n##### EXPECTED RESULTS\r\nnot having an error \r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: ProgrammingError: role \"user@host\" does not exist\r\n127.0.0.1 | FAILED! => {\r\n    \"changed\": false,\r\n    \"msg\": \"Database query failed: role \\\"user@host\\\" does not exist\\n\"\r\n}\r\nOperations to perform:\r\n  Apply all migrations: auth, conf, contenttypes, main, oauth2_provider, sessions, sites, social_django, sso, taggit\r\n...\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nI want to use OAuth2 for launching jobs from the API. The documentation I'm following:\r\nhttps://github.com/ansible/awx/blob/devel/docs/auth/oauth.md\r\nhttps://github.com/ansible/awx/blob/devel/awx/api/templates/api/api_o_auth_authorization_root_view.md\r\nI have 2 issues with this:\r\n\r\nI created an application in ansible of authorization-code type. \r\nI send the /api/o/authorize call and I get back the code, but only if I am logged in and if I have an active session, I get this page where I need to authorize. I don't want to be logged in as an user to be able to use the API, but use the client-id and client-secret my application has to be authorized and get a token. This is the first issue. If I don't have an active session I get a message to call /api/login first. This seems more like the Implicit grant type of application.\r\n\r\nThe second issue is that after I click authorize on the above mentioned page, and I do a post call to the /api/o/token endpoint as per the documentation, i get a 405 Method not supported. Tried GET, it also throws 405.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.7.7\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create an application in AWX with authorization-code type\r\n2. Make a call to /o/authorize.\r\n3. Here you get a message to call /api/login if there is no active session or if there is, you get redirected to a page that asks you to authorize the call.\r\n4. Call /api/o/token and get a 405.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nStep number 3 should not occur. \r\nStep number 4 should return the access token.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nStep 3 occurs.\r\nStep 4 returns 405.\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n(not sure which is to blame)\r\n\r\n##### SUMMARY\r\nWhen changing a link from one type to another (ex. change always to on success) the api throws a 400 error on save.  It's unclear to me whether this is an issue with the UI code or with the API code.\r\n\r\n![workflow_link_error](https://user-images.githubusercontent.com/9889020/53828400-8cde8080-3f4b-11e9-8bbb-03d0b5e38b5c.gif)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest devel\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a workflow\r\nAdd some nodes in serial\r\nSave\r\nOpen Visualizer again\r\nChange one of the link types\r\nAttempt to save\r\n\r\n##### EXPECTED RESULTS\r\nSuccessful save\r\n\r\n##### ACTUAL RESULTS\r\n400 error from API\r\n\r\n```\r\nPOST https://127.0.0.1:3000/api/v2/workflow_job_template_nodes/3/success_nodes/ 400\r\nPossibly unhandled rejection: {\"data\":{\"Error\":\"Relationship not allowed.\"},\"status\":400,\"config\":{...bunch of stuff in here}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\n\r\nErreur parsing scm-project-imported yml inventory.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: Debian 9.8\r\n* Web Browser: Firefox 65.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Create a git repo with a yml inventory\r\n- Create a project from a git repo\r\n- Create an inventory\r\n- Source the inventory from the project\r\n- Create a job template using this inventory\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nEnter passphrase for /tmp/awx_20_1hyd0bnn/credential_4: \r\nIdentity added: /tmp/awx_20_1hyd0bnn/credential_4 (awx@awx1)\r\nSSH password: \r\n [WARNING]:  * Failed to parse /tmp/awx_20_1hyd0bnn/tmpekssw087 with yaml\r\nplugin: Syntax Error while loading YAML.   did not find expected key  The error\r\nappears to have been in '/tmp/awx_20_1hyd0bnn/tmpekssw087': line 3, column 89,\r\nbut may be elsewhere in the file depending on the exact syntax problem.  The\r\noffending line appears to be:  # -*- coding: utf-8 -*- print('{\"all\": {\"vars\":\r\n{\"ansible_python_interpreter\": \"/usr/bin/python3\"}, \"hosts\": []}, \" [... my whole inventory here, redacted for readability and privacy...]\"}}}}')\r\n^ here We could be wrong, but this one looks like it might be an issue with\r\nunbalanced quotes.  If starting a value with a quote, make sure the line ends\r\nwith the same set of quotes.  For instance this arbitrary example:      foo:\r\n\"bad\" \"wolf\"  Could be written as:      foo: '\"bad\" \"wolf\"'\r\n\r\n [WARNING]: Unable to parse /tmp/awx_20_1hyd0bnn/tmpekssw087 as an inventory\r\nsource\r\n\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe problem looks like the inventory was stored as a python script printing the inventory, and is parsed using a yaml parser.\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nTrying to filter nested model such as Role under Organization would return \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.6.3\r\n* Operating System: Mac OS\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nTry performing the following API call:\r\n```\r\nhttp://localhost/api/v2/organizations/1/object_roles/?name=Execute\r\n```\r\n##### EXPECTED RESULTS\r\n\r\nA list that only contains the role by the name Execute is to be returned\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe following error (error code 400):\r\n```\r\n{\r\n    \"detail\": \"Role has no field named 'name'\"\r\n}\r\n```\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nI would like to know (be notified) when a new job is started. This feature is important because normally there are more than 1 user, and knowing what is happening with relevant projects is a topic of interest."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen using the API to create a job template, a HTTP 500 error is thrown if you provide a string (rather than an int) for params such as `credential`, `inventory`, or `project`. This worked without issue in 2.1.2 (and earlier versions).\r\n\r\nI was able to work around this by jumping through a few small hoops, but it's an unexpected regression, and it's handled poorly. Even if it's expected that AWX would reject a request when you use strings for int params, it should return a better error message, even if it's just `400 Bad Request`.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPerform a POST request to `api/v2/job_templates/` with a body like:\r\n\r\n```\r\n{\r\n  \"credential\": \"3\", \r\n  \"inventory\": \"2\", \r\n  \"job_type\": \"run\", \r\n  \"name\": \"test\", \r\n  \"playbook\": \"main.yml\", \r\n  \"project\": \"6\"\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nEverything is happy.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe AWX API returns HTTP 500. Additionally, the following traceback is shown in the logs:\r\n\r\n```\r\n2019-03-01 13:12:09,346 ERROR    django.request Internal Server Error: /api/v2/job_templates/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/wsgi.py\", line 71, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\n    return func(*args, **kwds)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/api/generics.py\", line 324, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/api/views/__init__.py\", line 2195, in post\r\n    ret = super(JobTemplateList, self).post(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/generics.py\", line 244, in post\r\n    return self.create(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/mixins.py\", line 20, in create\r\n    serializer.is_valid(raise_exception=True)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/serializers.py\", line 236, in is_valid\r\n    self._validated_data = self.run_validation(self.initial_data)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/api/serializers.py\", line 552, in run_validation\r\n    return super(BaseSerializer, self).run_validation(data)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/serializers.py\", line 435, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/serializers.py\", line 465, in to_internal_value\r\n    validated_value = field.run_validation(primitive_value)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/fields.py\", line 524, in run_validation\r\n    self.run_validators(value)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/rest_framework/fields.py\", line 538, in run_validators\r\n    validator(value)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/validators.py\", line 325, in __call__\r\n    if self.compare(cleaned, self.limit_value):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/validators.py\", line 358, in compare\r\n    return a < b\r\nTypeError: '<' not supported between instances of 'str' and 'int'\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nN/A\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCan I create a playbook through the web page other than pulling from git or reading from local?\r\n\r\n##### ADDITIONAL INFORMATION\r\nI am new to ansible and ansible tower. I cannot find the page to create playbook on the web. Is that already possible ? Or this function is just not necessary?\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API (probably)\r\n - UI (yes)\r\n\r\n##### SUMMARY\r\nCurrently, we display this type of information on the job details panel:\r\n\r\n![job_error_details](https://user-images.githubusercontent.com/9753817/53586211-aea7c400-3b55-11e9-9fb0-ac8ea6529cdd.png)\r\n\r\nThis can be hard to read. It would be better if we represented these errors and tracebacks as if they were job output instead.\r\n\r\n##### ADDITIONAL INFORMATION\r\nA job can fail, stop running, or unexpectedly not start for a variety of reasons. In the API, we send this information using several different fields depending on context:\r\n\r\n- `job.license_error` (bool):\r\nto indicate a license error of some kind\r\n- `job.org_host_limit_error` (string):\r\nto indicate an error due to hitting the host limit for an organization (see [#3174](https://github.com/ansible/awx/pull/3174/files#diff-a000eec9bcdc95dd30b2269e9e3d4c76R239))\r\n- `job.result_traceback` (string):\r\nfor issues that caused a traceback prior to a job run.\r\n- `job.job_explanation` ([sometimes a string](https://github.com/ansible/awx/blob/devel/awx/main/models/unified_jobs.py#L1228), sometimes a [part-string, part-stringified-json-hybrid](https://github.com/ansible/awx/blob/devel/awx/main/tests/unit/models/test_inventory.py#L35) that needs to be [split and parsed.](https://github.com/ansible/awx/blob/devel/awx/ui/client/features/output/details.component.js#L396-#L401)):\r\nfor other occurrences, like failed inventory syncs.\r\n\r\nThe work here would probably entail:\r\n- API side, see if it's feasible to represent this information in the job details in a more consolidated or consistent way. This isn't strictly necessary - All of the information is technically there, but it could be helpful for the ui changes that would follow.\r\n- Remove code that shows this information from [the job details panel component](https://github.com/ansible/awx/blob/devel/awx/ui/client/features/output/details.component.js)\r\n- Add a function to the [top-level job output controller](https://github.com/ansible/awx/blob/devel/awx/ui/client/features/output/index.controller.js) that knows how to take information from these fields when it exists (e.g: `resource.model.get('result_traceback')` and generate a 'fake' job event, complete with ansi stdout fields, counters, etc, which can be pushed into the `render` service and displayed as if it were job output. \r\n - Use this function on initialization for finished jobs and also with our `sync` function that we invoke when jobs finish running.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nTraceback:\r\n\r\n```\r\nawx_1        | 18:58:54 uwsgi.1      | 2019-02-27 18:58:54,069 ERROR    django.request Internal Server Error: /api/v2/instance_groups/1/instances/\r\nawx_1        | 18:58:54 uwsgi.1      | Traceback (most recent call last):\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\nawx_1        | 18:58:54 uwsgi.1      |     response = get_response(request)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"./awx/wsgi.py\", line 72, in _legacy_get_response\r\nawx_1        | 18:58:54 uwsgi.1      |     return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\nawx_1        | 18:58:54 uwsgi.1      |     response = self._get_response(request)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\nawx_1        | 18:58:54 uwsgi.1      |     response = self.process_exception_by_middleware(e, request)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\nawx_1        | 18:58:54 uwsgi.1      |     response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\nawx_1        | 18:58:54 uwsgi.1      |     return func(*args, **kwds)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\nawx_1        | 18:58:54 uwsgi.1      |     return view_func(*args, **kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\nawx_1        | 18:58:54 uwsgi.1      |     return self.dispatch(request, *args, **kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"./awx/api/generics.py\", line 334, in dispatch\r\nawx_1        | 18:58:54 uwsgi.1      |     return super(APIView, self).dispatch(request, *args, **kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 494, in dispatch\r\nawx_1        | 18:58:54 uwsgi.1      |     response = self.handle_exception(exc)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\nawx_1        | 18:58:54 uwsgi.1      |     self.raise_uncaught_exception(exc)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 491, in dispatch\r\nawx_1        | 18:58:54 uwsgi.1      |     response = handler(request, *args, **kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 505, in options\r\nawx_1        | 18:58:54 uwsgi.1      |     data = self.metadata_class().determine_metadata(request, self)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"./awx/api/metadata.py\", line 198, in determine_metadata\r\nawx_1        | 18:58:54 uwsgi.1      |     metadata = super(Metadata, self).determine_metadata(request, view)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/metadata.py\", line 69, in determine_metadata\r\nawx_1        | 18:58:54 uwsgi.1      |     actions = self.determine_actions(request, view)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"./awx/api/metadata.py\", line 256, in determine_actions\r\nawx_1        | 18:58:54 uwsgi.1      |     for field in actions[method]:\r\nawx_1        | 18:58:54 uwsgi.1      | RuntimeError: OrderedDict mutated during iteration\r\nawx_1        | 18:58:54 uwsgi.1      | 2019-02-27 18:58:54,069 ERROR    django.request Internal Server Error: /api/v2/instance_groups/1/instances/\r\nawx_1        | 18:58:54 uwsgi.1      | Traceback (most recent call last):\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\nawx_1        | 18:58:54 uwsgi.1      |     response = get_response(request)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"./awx/wsgi.py\", line 72, in _legacy_get_response\r\nawx_1        | 18:58:54 uwsgi.1      |     return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\nawx_1        | 18:58:54 uwsgi.1      |     response = self._get_response(request)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\nawx_1        | 18:58:54 uwsgi.1      |     response = self.process_exception_by_middleware(e, request)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\nawx_1        | 18:58:54 uwsgi.1      |     response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/usr/lib64/python3.6/contextlib.py\", line 52, in inner\r\nawx_1        | 18:58:54 uwsgi.1      |     return func(*args, **kwds)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\nawx_1        | 18:58:54 uwsgi.1      |     return view_func(*args, **kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/django/views/generic/base.py\", line 68, in view\r\nawx_1        | 18:58:54 uwsgi.1      |     return self.dispatch(request, *args, **kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"./awx/api/generics.py\", line 334, in dispatch\r\nawx_1        | 18:58:54 uwsgi.1      |     return super(APIView, self).dispatch(request, *args, **kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 494, in dispatch\r\nawx_1        | 18:58:54 uwsgi.1      |     response = self.handle_exception(exc)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\nawx_1        | 18:58:54 uwsgi.1      |     self.raise_uncaught_exception(exc)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 491, in dispatch\r\nawx_1        | 18:58:54 uwsgi.1      |     response = handler(request, *args, **kwargs)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/views.py\", line 505, in options\r\nawx_1        | 18:58:54 uwsgi.1      |     data = self.metadata_class().determine_metadata(request, self)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"./awx/api/metadata.py\", line 198, in determine_metadata\r\nawx_1        | 18:58:54 uwsgi.1      |     metadata = super(Metadata, self).determine_metadata(request, view)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"/venv/awx/lib64/python3.6/site-packages/rest_framework/metadata.py\", line 69, in determine_metadata\r\nawx_1        | 18:58:54 uwsgi.1      |     actions = self.determine_actions(request, view)\r\nawx_1        | 18:58:54 uwsgi.1      |   File \"./awx/api/metadata.py\", line 256, in determine_actions\r\nawx_1        | 18:58:54 uwsgi.1      |     for field in actions[method]:\r\nawx_1        | 18:58:54 uwsgi.1      | RuntimeError: OrderedDict mutated during iteration\r\nawx_1        | 18:58:54 uwsgi.1      | 172.18.0.1 OPTIONS /api/v2/instance_groups/1/instances/ - HTTP/1.1 500\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\nMake an OPTIONS request on `api/v2/instance_groups/:id/instances`\r\nSee error\r\n\r\n##### EXPECTED RESULTS\r\n200 response\r\n\r\n##### ACTUAL RESULTS\r\n500 response\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n##### SUMMARY\r\nzuul API checks occasionally fail, but work on `recheck`.\r\nhttps://ansible.softwarefactory-project.io/logs/94/3294/29dbcc15fa8553f86e7e144e3b9358e1c92ee4c6/check/tox-awx-api/104ab12/ara-report/\r\n\r\n```Starting tools_rabbitmq_1  ... \u001b[32mdone\u001b[0m\r\n\u001b[1B\u001b[2A\u001b[2K\r\nStarting tools_postgres_1  ... \u001b[32mdone\u001b[0m\r\n\u001b[2BError response from daemon: driver failed programming external connectivity on endpoint tools_awx_run_2 (e376f233645ebed9390535ecb8d2a68bb76635fb554d464faa9eeb321f80c997): Bind for 0.0.0.0:8888 failed: port is already allocated\r\nException TypeError: \"'NoneType' object is not callable\" in <function _removeHandlerRef at 0x7fcdb7df7ed8> ignored\r\nmake: *** [docker-compose-runtest] Error 1\r\nERROR: InvocationError for command '/usr/bin/make docker-compose-runtest' (exited with code 2)\r\n```\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUnknown exactly -- the PR zuul check that was run is here: \r\nhttps://github.com/ansible/awx/pull/3294\r\n\r\n##### EXPECTED RESULTS\r\n\r\nchecks pass the first time.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nchecks pass the second time with no changes.\r\n\r\ncc @chrismeyersfsu @rooftopcellist"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nI have set AWX_TASK_ENV['GIT_SSL_NO_VERIFY'] = 'True' in /etc/tower/settings.py and generally am able to update from git scm but randomly see jobs fail due to -\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": [\"/usr/bin/git\", \"fetch\", \"origin\"], \"msg\": \"Failed to download remote objects and refs:  fatal: unable to access 'https://$encrypted$:$encrypted$@172.28.1.164/wss-networking/ansible.git/': Peer's Certificate issuer is not recognized.\\n\"}\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: unbuntu \r\n* Web Browser: firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nproblem is random\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSCM should update regardless of ssl certificate\r\n\r\n##### ACTUAL RESULTS\r\n\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": [\"/usr/bin/git\", \"fetch\", \"origin\"], \"msg\": \"Failed to download remote objects and refs:  fatal: unable to access 'https://$encrypted$:$encrypted$@172.28.1.164/wss-networking/ansible.git/': Peer's Certificate issuer is not recognized.\\n\"}\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API \r\n\r\n##### SUMMARY\r\nWhen we run tower-cli command to create Survey it's showing the command has completed but when we route to API endpoint to see created Survey, there is no Survey created.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.4.1\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.7.5\r\n* Operating System: RHEL 7\r\n* Web Browser: Mozilla Firefox and Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1.) Create a Survey on the existing Job template for multiple choice question using following tower-cli command :\r\n\r\ntower-cli job_template modify --name 'Job-Template-Name' --survey-spec '{\"spec\": [{\"question_name\": \"abc\", \"min\": 0, \"default\": \"choice1\", \"max\": 0, \"required\": true, \"choices\":\"choice1nchoice2nchoice3\", \"new_question\": true, \"question_description\": \"\", \"variable\": \"my_vare\", \"type\": \"multi\"}], \"description\": \"anything\", \"name\": \"creatingsurvey\"}' --survey-enabled=true \r\n\r\n2.) Go to the Following API endpoint or Ansible Tower to confirm that Survey is created or not : \r\n\r\nhttps://tower.example.com/api/v2/job_templates/<Job-template-id>/survey_spec/\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSurvey should be created\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo Survey has been created.\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n \r\n##### SUMMARY\r\nFor Job Template X, Admin on JT + Notification Admin on Org couldn't able to assgin Notification for that JT. According to this #2949 , notification tab is missing in JT for Org Admin but he can able to assign notify templates via API. But Admin on JT + Notification Admin on Org couldn't able to assign it via API and throws `You don't have permission to do that (HTTP 403).` error.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Create a Normal User 'Y'\r\n- Give him Notification Admin on Org Level and Admin role for a JT 'X'\r\n- Now, login as user 'Y' \r\n- In UI, he can't assign notify templates for JT 'X' as the notification tab will be missing on UI and it's a known issue #2949 \r\n- Try to assign notification for JT 'X' via API\r\n\r\n##### EXPECTED RESULTS\r\nNotification assigned to JT 'X'\r\n\r\n##### ACTUAL RESULTS\r\nFailed with `You don't have permission to do that (HTTP 403).` error.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nTrying to use a template from a custom credential creates the file, but the host cannot find it when its called. \r\n\r\nTo help debug I've created the following volume between the awx container and host: /tmp:/tmp \r\n\r\nDoing so verified that the files are indeed being created, however they tend to disappear right before they're needed.  \r\n\r\nI also moved the call for the credential to the top of the playbook, but that did not help. For context, I need this the custom config files to be inserted into a docker container.\r\n\r\nUsing environment variables instead of a template file works, but due to the amount of variables, would be far from ideal.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux (compose)\r\n* Ansible version:  Whichever came with 3.0.1\r\n* Operating System: Amazon Linux 2\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate a custom credential with a file template and environment variable. Read the environment variable for the filepath and attempt an operation on the file. The file may not ever exist on the host.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nA template file named with a random string of characters given an environment variable name contains injected credentials from the tower vault.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n`FAILED! => {\"changed\": true, \"cmd\": [\"mv\", \"/tmp/awx_742_3end_ueu/tmphrdq9cfp\", \"/var/lib/ansible_python_container/GOOGLE_APPLICATION_CREDENTIALS\"], \"delta\": \"0:00:00.003292\", \"end\": \"2019-02-22 23:10:41.957345\", \"msg\": \"non-zero return code\", \"rc\": 1, \"start\": \"2019-02-22 23:10:41.954053\", \"stderr\": \"mv: cannot stat ‘/tmp/awx_742_3end_ueu/tmphrdq9cfp’: No such file or directory\", \"stderr_lines\": [\"mv: cannot stat ‘/tmp/awx_742_3end_ueu/tmphrdq9cfp’: No such file or directory\"], \"stdout\": \"\", \"stdout_lines\": []}`\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nExample Injector Configuration:\r\n`env:\r\n  GOOGLE_APPLICATION_CREDENTIALS: '{{ tower.filename.gsuite }}'\r\nextra_vars:\r\n  google_application_credentials: '{{ tower.filename.gsuite }}'\r\nfile:\r\n  template.gsuite: |\r\n    {\r\n      \"AUTH_PROVIDER_X509_CERT_URL\": \"{{ auth_provider_x509_cert_url }}\"\r\n      \"AUTH_URI\": \"{{ auth_uri }}\"\r\n      \"CLIENT_EMAIL\": \"{{ client_email }}\"\r\n      \"CLIENT_ID\": \"{{ client_id }}\"\r\n      \"CLIENT_X509_CERT_URL\": \"{{ client_x509_cert_url }}\"\r\n      \"PRIVATE_KEY\": \"{{ private_key }}\"\r\n      \"PRIVATE_KEY_ID\": \"{{ private_key_id }}\"\r\n      \"PROJECT_ID\": \"{{ project_id }}\"\r\n      \"TOKEN_URI\": \"{{ token_uri }}\"\r\n      \"TYPE\": \"{{ type }}\"\r\n    }\r\n`"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nRequest for adding a cancel all jobs in a template feature. This because we once had to cancel over 20k jobs due to some misconfiguration and cancelling them one by one takes a lot of time, even with a script. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWhen using RUN COMMAND (ad-hoc) on the inventory, we cannot specify the Instance Group like Job Template. It would be great if it can be specified.\r\n\r\n##### ADDITIONAL INFORMATION\r\nI confirmed AWX 3.0.1.0 cannot specify the Instance Group.\r\n![awx_screenshot](https://user-images.githubusercontent.com/4246532/53213513-9551d400-368c-11e9-974b-fc1c81ebb4d1.jpg)\r\n\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nIt would be cool if AWX could be configured to prevent launching of tasks for example if 90% of RAM is actively being used by instance where AWX runs. Right now it's not connected to OS resources in any way, which requires very inefficient setup (in peaks AWX uses about 15GB RAM, but most of time about 5GB, yet we had to add 16GB to VM where it run just to avoid swap-death of peaks).\r\n\r\nIn simple words: check instance resources before launching a job - if there is too much RAM / CPU used, keep job pending until resources are available."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nPlaybook running from AWX UI fails, but running ansible-playbook inside awx_celery with the same play works. My playbook is looking like this:\r\n\r\n`---\r\n- hosts: 127.0.0.1\r\n  connection: local\r\n  tasks:\r\n    - name: Import inventory   \r\n      shell: \"awx-manage inventory_import --source=hosts --inventory-name=bwin --overwrite\"\r\n      args:\r\n        chdir: /var/lib/awx/shared`\r\n\r\nIf I do docker exec -it awx_celery /bin/bash, then cd /var/lib/awx/projects/_14__awx and run here ansible-playbook awx-inv-sync.yml, it works.\r\nIf I go to the AWX UI and run a job that uses this playbook this is what i get:\r\n\r\nPlaybook output:\r\n`TASK [Import inventory] ********************************************************\r\ntask path: /var/lib/awx/projects/_14__awx/plays/awx-inventory-sync.yml:13\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: awx\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~awx && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /var/lib/awx/.ansible/tmp/ansible-tmp-1550598400.14-158561699519226 `\" && echo ansible-tmp-1550598400.14-158561699519226=\"` echo /var/lib/awx/.ansible/tmp/ansible-tmp-1550598400.14-158561699519226 `\" ) && sleep 0'\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/commands/command.py\r\n<127.0.0.1> PUT /var/lib/awx/.ansible/tmp/ansible-local-3Krrd2O/tmpw6Iqa5 TO /var/lib/awx/.ansible/tmp/ansible-tmp-1550598400.14-158561699519226/AnsiballZ_command.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /var/lib/awx/.ansible/tmp/ansible-tmp-1550598400.14-158561699519226/ /var/lib/awx/.ansible/tmp/ansible-tmp-1550598400.14-158561699519226/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python2 /var/lib/awx/.ansible/tmp/ansible-tmp-1550598400.14-158561699519226/AnsiballZ_command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c 'rm -f -r /var/lib/awx/.ansible/tmp/ansible-tmp-1550598400.14-158561699519226/ > /dev/null 2>&1 && sleep 0'\r\nfatal: [127.0.0.1]: FAILED! => {\r\n    \"changed\": true, \r\n    \"cmd\": \"awx-manage inventory_import --source=/var/lib/awx/shared/hosts --inventory-name=bwin --overwrite\", \r\n    \"delta\": \"0:00:00.125621\", \r\n    \"end\": \"2019-02-19 17:46:40.547984\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"awx-manage inventory_import --source=/var/lib/awx/shared/hosts --inventory-name=bwin --overwrite\", \r\n            \"_uses_shell\": true, \r\n            \"argv\": null, \r\n            \"chdir\": null, \r\n            \"creates\": null, \r\n            \"executable\": \"/bin/bash\", \r\n            \"removes\": null, \r\n            \"stdin\": null, \r\n            \"warn\": true\r\n        }\r\n    }, \r\n    \"msg\": \"non-zero return code\", \r\n    \"rc\": 1, \r\n    \"start\": \"2019-02-19 17:46:40.422363\",`\r\n\r\nStderr:\r\n\r\n`Traceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 4, in <module>\r\n    import re\r\n  File \"/usr/lib64/python3.6/re.py\", line 142, in <module>\r\n    class RegexFlag(enum.IntFlag):\r\nAttributeError: module 'enum' has no attribute 'IntFlag'`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.7\r\n* Operating System: CentOS 7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Have a inventory file somewhere in awx_celery and use a playbook that will use awx_manage to import it to awx (example in my summary above)\r\n2. Run the playbook from AWX UI\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPlay should work and inventory should be imported\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPlay fails with the errors mentioned above. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWhat is weird to me is that there is a python 3.6 lib related error. From what I knowm awx 3 uses python 3 but ansible should still be using 2.7. So somehow the libs get mixed up?\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAllow the mapping of multiple attributes (saml_attr) in SOCIAL_AUTH_SAML_TEAM_ATTR to support team mapping for Orgs that have the same Team names.\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nCurrently only one attribute can be mapped  which will add users to the same team name in multiple organizations:\r\n\r\nFor Example:\r\n```\r\n\"SOCIAL_AUTH_SAML_TEAM_ATTR\": {\r\n        \"saml_attr\": \"roles\",\r\n        \"remove\": true,\r\n        \"team_org_map\": [\r\n            {\r\n                \"organization\": \"Org1\",\r\n                \"team\": \"developer\"\r\n            },\r\n            {\r\n                \"organization\": \"Org1\",\r\n                \"team\": \"auditor\"\r\n            },\r\n            {\r\n                \"organization\": \"Org2\",\r\n                \"team\": \"developer\"\r\n            },\r\n            {\r\n                \"organization\": \"Org2\",\r\n                \"team\": \"auditor\"\r\n            }\r\n        ]\r\n    }\r\n}\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nUsing workflow job template, user wants to pass secret values with set_stats, but `artifacts` and `extra_vars` are not able to mask those values.\r\nFor the security reason, users want to mask these variables from the `artifacts` and `extra_vars` in the UI / API if necessary.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n1. Create a workflow job template: JOB1(test1.yml) --\"RUN: on succee\" --> JOB2(test2.yml)\r\n2. We will see `SECRET VALUE` as a plain text in `artifacts` of JOB1 and `extra_vars` in JOB2 as well, even if we use no_log: True in both of playbooks\r\n\r\n- test1.yml\r\n\r\n```\r\n---\r\n- hosts: localhost\r\n  no_log: True\r\n\r\n  tasks:\r\n    - set_stats:\r\n        data:\r\n          message: \"SECRET VALUE\"\r\n```\r\n\r\n- test2.yml\r\n\r\n```\r\n---\r\n- hosts: localhost\r\n  no_log: True\r\n\r\n  tasks:\r\n    - debug:\r\n        msg: \"{{ message }}\"\r\n```"},{"labels":["api"],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI am trying to monitor a job through the awx api. To accomplish this I (every 500ms)\r\nget the job status from jobs/{jobId}/\r\ncall jobs/{jobId}/stdout?format=json\r\nOnce both calls complete, I inspect job.failed, if true I output the message from stdout in red, else green.\r\nProblem: A situation occurs where job.failed is false and job.status is 'running', but the stdout contains an error. This error is output in green as a status update.\r\n\r\nAs the job is 'running' it is polled again. And this time job.failed will be true.\r\nIs there any way to synchronize stdout and job status?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2\r\n* AWX install method: unknown\r\n* Ansible version:  unknown\r\n* Operating System: Windows 10\r\n* Web Browser: Chrome\r\n\r\nAWX environment is not owned by me, so am unsure of these details.\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nAs in summary\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nCan fetch stdout and status at the same time.\r\n\r\n##### ACTUAL RESULTS\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n\r\nAfter upgrading from 2.1.2 to 3.0.1 I'm getting `UnboundLocalError` on all my custom filter plugins. All the errors have a message similar to the one below:\r\n\r\n```json\r\n{\r\n    \"msg\": \"Unexpected failure during module execution.\",\r\n    \"exception\": \"Traceback (most recent call last):\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/executor/task_executor.py\\\", line 140, in run\\n    res = self._execute()\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/executor/task_executor.py\\\", line 539, in _execute\\n    self._task.post_validate(templar=templar)\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/playbook/task.py\\\", line 267, in post_validate\\n    super(Task, self).post_validate(templar)\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/playbook/base.py\\\", line 364, in post_validate\\n    value = templar.template(getattr(self, name))\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/template/__init__.py\\\", line 540, in template\\n    disable_lookups=disable_lookups,\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/template/__init__.py\\\", line 495, in template\\n    disable_lookups=disable_lookups,\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/template/__init__.py\\\", line 712, in do_template\\n    myenv.filters.update(self._get_filters(myenv.filters))\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/template/__init__.py\\\", line 328, in _get_filters\\n    for fp in self._filter_loader.all():\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/plugins/loader.py\\\", line 569, in all\\n    plugins = [p for p in super(Jinja2Loader, self).all(*args, **kwargs)]\\n  File \\\"/usr/lib/python2.7/site-packages/ansible/plugins/loader.py\\\", line 493, in all\\n    self._module_cache[path] = module\\nUnboundLocalError: local variable 'module' referenced before assignment\\n\",\r\n    \"_ansible_no_log\": false,\r\n    \"stdout\": \"\"\r\n}\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: Centos 7.6\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a playbook that include custom filter plugins\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe playbook should ran successfully\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPlaybooks fail with `UnboundLocalError` on every taks that use the custom filter.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n \r\n\r\n##### SUMMARY\r\nVMware vcenter inventory fails if **max_object_level** is greater than 1\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.7\r\n* Operating System: Oracle Linux 7\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a new inventory source of type \"VMware vCenter\"\r\nIn SOURCE VARIABLES add only\r\n`max_object_level: 2`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSuccessful run of inventory sync\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSync fails with\r\n_[WARNING]: Unable to parse /var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py as an inventory source_\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nFull output from jobs view\r\n\r\n\r\n\r\n>     2.141 INFO     Updating inventory 2: vcenter\r\n>     2.154 DEBUG    Using base command: /usr/bin/ansible-inventory -i /var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py\r\n>     2.154 INFO     Reading Ansible inventory source: /var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py\r\n>     2.157 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n>     2.157 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n>     2.157 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python2.7/site-packages:\r\n>   Traceback (most recent call last):\r\n>   File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 11, in <module>\r\n>     load_entry_point('awx==3.0.1', 'console_scripts', 'awx-manage')()\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 140, in manage\r\n>     execute_from_command_line(sys.argv)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line utility.execute()\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 356, in execute self.fetch_command(subcommand).run_from_argv(self.argv)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 283, in run_from_argv self.execute(*args, **cmd_options)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 330, in execute\r\n>     output = self.handle(*args, **options)\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1049, in handle\r\n>     raise exc\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 949, in handle\r\n>     data = AnsibleInventoryLoader(source=source, is_custom=self.is_custom, venv_path=venv_path).load()\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 195, in load\r\n>     return self.command_to_json(base_args + ['--list'])\r\n>   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 178, in command_to_json\r\n>     self.method, proc.returncode, stdout, stderr))\r\n> RuntimeError: ansible-inventory failed (rc=1) with stdout:\r\n> stderr:\r\n>  [WARNING]:  * Failed to parse /var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py with script plugin:\r\n> Inventory script (/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py) had an execution error:\r\n> Traceback (most recent call last):   File\r\n> \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py\", line 779, in <module>\r\n> print(VMWareInventory().show())   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py\", line 145, in\r\n> __init__     self.do_api_calls_update_cache()   File\r\n> \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py\", line 184, in\r\n> do_api_calls_update_cache     self.inventory =\r\n> self.instances_to_inventory(self.get_instances())   File\r\n> \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py\", line 507, in\r\n> instances_to_inventory     keylist = map(lambda x: x.strip(),\r\n> tv['value'].split(',')) AttributeError: 'dict' object has no attribute 'split'\r\n>  [WARNING]: Unable to parse /var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/vmware_inventory.py as an inventory source\r\n> ERROR! No inventory was parsed, please check your configuration and options.\r\n\r\nI have successfully run this manually from within the awx_tasks docker container by first copying the generated config file during a sync from /tmp/awx_xxx_xxxxxx to /tmp/vmware.ini\r\n\r\nand using it with this commandline.\r\n`VMWARE_INI_PATH=/tmp/vmware.ini /var/lib/awx/venv/awx/lib/python3.6/site-packages/awx/plugins/inventory/vmware_inventory.py --list`\r\n\r\nReason for upping the max_object_level is that I use the option groupby_custom_field but that information is not obtained with a max_object_level of 1. \r\n\r\nI have also tried getting the latest version of vmware_inventory.py from ansible project and replacing the one in awx_tasks continer. but same result.\r\n"},{"labels":["api",null,null,null],"text":"https://github.com/ansible/product-docs/blame/91b1e17f4b4bd4bacfabaa22791803699b9dfc52/administration/source/logging.rst <-- Introduced the notion of `job_status` but that logger doesn't actually exist (and never did exist in code). We should remove `job_status` from the tower docs and from the awx/docs https://github.com/ansible/awx/blob/devel/docs/logging_integration.md"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n1.  Create an inventory w/ 10k hosts:\r\n\r\n```python\r\n~ awx-manage shell_plus\r\nv = 'ansible_connection: local'\r\nfor i in range(10000): Host(inventory_id=1, name='Host {}'.format(i), variables=v).save()\r\n```\r\n\r\n2.  Launch a simple (fast) job pointed at that inventory with a host limit set to one host (e.g., `localhost`)\r\n3.  The job takes up to a minute to start printing stdout.\r\n\r\n![image](https://user-images.githubusercontent.com/214912/52650728-cd049300-2eb8-11e9-9148-faf859f99f03.png)\r\n\r\n![giphy](https://user-images.githubusercontent.com/214912/52650770-de4d9f80-2eb8-11e9-9f9d-0f93557d1ad4.gif)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.3.0+\r\n* AWX install method: any\r\n* Ansible version:  any\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIf a playbook which generates artifacts is launched as a SJT, artifacts are not displayed. If that SJT is converted to a JT and relaunched, the artifacts are still not displayed. Not until that playbook is launched from the Template view are artifacts generated by the playbook.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.2\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Add a playbook which generates artifacts (like https://github.com/ansible/test-playbooks) as a SJT\r\n2. Launch SJT\r\n3. Convert SJT to a JT\r\n4. Relaunch job from step 2.\r\nNote: No artifacts generated / displayed.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1. Artifacts generated or warning that they may not be displayed in some circumstances.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n1. No artifacts generated / displayed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAfter A SJT has been converted to a JT and relaunched:\r\n<img width=\"1481\" alt=\"screen shot 2019-02-11 at 6 27 29 pm\" src=\"https://user-images.githubusercontent.com/12446869/52660124-fc24ff80-2ecc-11e9-93f9-8d84d07844fe.png\">\r\n\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nUnexpected smart inventory query appears when smart inventory query with 3 or more `and` used for ansible facts. For a system with a large smart inventory this results in slow job event processing.\r\n\r\n##### ENVIRONMENT\r\n* Tower 3.4.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nFor slowness of job event processing:\r\n* Create an inventory with at least 3,000 hosts\r\n* Create 60 smart inventories that matches a fraction of those hosts, say 300.\r\n* use a host_filter with at least 3 and's ie. `ansible_facts__ansible_distribution=CentOS and ansible_facts__ansible_distribution=CentOS and ansible_facts__ansible_distribution=CentOS`\r\n* Run a playbook against any of the smart inventories.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* Shortly after ansible job finishes, stdout shows in the UI\r\n\r\n##### ACTUAL RESULTS\r\n\r\n* job events take a _long_ time to be processed (> 500 ms per event). This is observable in the UI/API\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhttps://gist.github.com/chrismeyersfsu/f0a5e6109cc134a533c7e9d0b2ba5cb4 <-- can be used to log all queries issued in tower along with a stack trace.\r\n\r\n`SELECT \"main_host\".\"id\", \"main_host\".\"created\", \"main_host\".\"modified\", \"main_host\".\"description\", \"main_host\".\"created_by_id\", \"main_host\".\"modified_by_id\", \"main_host\".\"name\", \"main_host\".\"inventory_id\", \"main_host\".\"enabled\", \"main_host\".\"instance_id\", \"main_host\".\"variables\", \"main_host\".\"last_job_id\", \"main_host\".\"last_job_host_summary_id\", \"main_host\".\"has_active_failures\", \"main_host\".\"has_inventory_sources\", \"main_host\".\"ansible_facts\", \"main_host\".\"ansible_facts_modified\", \"main_host\".\"insights_system_id\" FROM \"main_host\" WHERE (\"main_host\".\"ansible_facts\" @> '{\"ansible_local\": {\"ansible_distribution\": \"CentOS\"}' AND \"main_host\".\"ansible_facts\" @> '{\"ansible_local\": {\"ansible_distribution\": \"CentOS\"}}') ORDER BY \"main_host\".\"name\" ASC` <-- This is the offending query. We should NOT generate a query of this type if things are working correctly.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\ntry to run in localhost using awx in ubuntu machine alaways get this message no such file or directory.\r\n\r\nchanged\": false, \"cmd\": \"apt-get update\", \"msg\": \"[Errno 2] No such file or directory\", \"rc\": 2}\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.0.0 \r\n* AWX install method: docker on linux(ubuntu)\r\n* Ansible version: 2.7.6\r\n* Operating System: ubuntu 18.04\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nTried to install lamp stack using awx through ansible playbook,from last 3 days im getting this same error.\r\n\r\nplease help me on this ,im stuck at this.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt should install packages from apt module ,but its not happening.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": \"apt-get update\", \"msg\": \"[Errno 2] No such file or directory\", \"rc\": 2}\r\n\r\n##### ADDITIONAL INFORMATION\r\nIdentity added: /tmp/awx_170_v16asb5k/credential_3 (/tmp/awx_170_v16asb5k/credential_3)\r\nPLAY [localhost] ***************************************************************\r\nTASK [Gathering Facts] *********************************************************\r\nok: [localhost]\r\nTASK [install lamp stack] ******************************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": \"apt-get update\", \"msg\": \"[Errno 2] No such file or directory\", \"rc\": 2}\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1   \r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nhttps://github.com/ansible/awx/commit/d4c3c089df5b49c69430b23953dc000d4a56d8cb re:introduced the use of six that has been removed by https://github.com/ansible/awx/pull/3070/commits/daeeaf413a58af68c663eac051cd8b0776697b02\r\n\r\nThis leads to:\r\n\r\n```\r\n2019-02-10 11:40:25,316 ERROR    awx.main.tasks Error spawning scheduled job.\r\nTraceback (most recent call last):\r\n  File \"/tasks.py\", line 471, in awx_periodic_scheduler\r\nNameError: name 'six' is not defined\r\n```\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 3.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n  - N/A\r\n\r\n##### EXPECTED RESULTS\r\n\r\n  - It works as previously\r\n\r\n##### ACTUAL RESULTS\r\n\r\n  - It fails with aforementioned error\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n  - N/A"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - task runner\r\n \r\n\r\n##### SUMMARY\r\nWhen left, or after a job completes, the web UI and API become unresponsive and any more scheduled tasks will not run until the dispatcher process is restarted.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.0 (issue seen since 2.0)\r\n* AWX install method: docker on linux\r\n* Ansible version:  Included with docker image\r\n* Operating System: RHEL7\r\n* Web Browser: Safari/Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLet UI sit or launch a job. Refresh page or browse to any other party of the UI (i.e. Jobs to the Dashboard)\r\n\r\nRequest will time out with a  504 error.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWould expect scheduled tasks to run and be able to browse the UI.\r\n\r\n##### ACTUAL RESULTS\r\n504 error from nginx\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nawx_web logs the following before before and then during a request. While the OKREADY messages before the error are occurring, the web browser is waiting for a response. \r\n```\r\nOKREADY\r\nRESULT 2\r\nOKREADY\r\nRESULT 2\r\nOKREADY\r\n2019/02/07 20:09:37 [error] 702#0: *22 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 172.17.0.5, server: _, request: \"POST /api/login/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx_web.example.com\", referrer: \"https://awx_web.example.com/\"\r\n172.17.0.5 - - [07/Feb/2019:20:09:37 +0000] \"POST /api/login/ HTTP/1.1\" 504 183 \"https://awx_web.example.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15\" \"10.150.29.86\"\r\nThu Feb  7 20:09:37 2019 - *** HARAKIRI ON WORKER 1 (pid: 703, try: 1) ***\r\nThu Feb  7 20:09:37 2019 - HARAKIRI !!! worker 1 status !!!\r\nThu Feb  7 20:09:37 2019 - HARAKIRI [core 0] 172.17.0.5 - POST /api/login/ since 1549570057\r\nThu Feb  7 20:09:37 2019 - HARAKIRI !!! end of worker 1 status !!!\r\nDAMN ! worker 1 (pid: 703) died, killed by signal 9 :( trying respawn ...\r\nRespawned uWSGI worker 1 (new pid: 732)\r\nRESULT 2\r\nOKREADY\r\nRESULT 2\r\nOKREADY\r\nRESULT 2\r\nOKREADY\r\n```\r\n\r\nawx_task at this time is also simply logging out \r\n```\r\nRESULT 2\r\nOKREADY\r\n```\r\n\r\nafter restarting the `dispatcher` process in awx_task, the following is logged, and usually a job will fire off\r\n\r\n```\r\n2019-02-08 15:07:57,312 INFO waiting for dispatcher to stop\r\n2019-02-08 15:07:57,312 DEBUG    awx.main.dispatch received SIGTERM, stopping\r\n2019-02-08 15:07:57,470 WARNING  awx.main.tasks Normal shutdown signal for instance awx_task, removed self from capacity pool.\r\n2019-02-08 15:07:57,476 DEBUG    awx.main.dispatch received SIGTERM, stopping\r\n[2019-02-07 20:34:11,246: DEBUG/Process-1] publish awx.main.tasks.awx_periodic_scheduler(9cee14c2-8da1-4082-81a3-9f49c7ae7d73, queue=awx_private_queue)\r\n[2019-02-08 15:07:57,549: CRITICAL/Process-1] beat raised exception <class 'ValueError'>: ValueError('invalid operation on closed shelf',)\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/shelve.py\", line 111, in __getitem__\r\n    value = self.cache[key]\r\nKeyError: 'entries'\r\nDuring handling of the above exception, another exception occurred:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/apps/beat.py\", line 109, in start_scheduler\r\n    service.start()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/beat.py\", line 588, in start\r\n    interval = self.scheduler.tick()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/run_dispatcher.py\", line 57, in tick\r\n    return super(AWXScheduler, self).tick(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/beat.py\", line 291, in tick\r\n    not self.schedules_equal(self.old_schedulers, self.schedule)):\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/beat.py\", line 536, in get_schedule\r\n    return self._store[str('entries')]\r\n  File \"/usr/lib64/python3.6/shelve.py\", line 113, in __getitem__\r\n    f = BytesIO(self.dict[key.encode(self.keyencoding)])\r\n  File \"/usr/lib64/python3.6/shelve.py\", line 70, in closed\r\n    raise ValueError('invalid operation on closed shelf')\r\nValueError: invalid operation on closed shelf\r\n[2019-02-08 15:07:57,550: WARNING/Process-1] Process Process-1:\r\n[2019-02-08 15:07:57,550: WARNING/Process-1] Traceback (most recent call last):\r\n[2019-02-08 15:07:57,550: WARNING/Process-1] File \"/usr/lib64/python3.6/shelve.py\", line 111, in __getitem__\r\n    value = self.cache[key]\r\n[2019-02-08 15:07:57,550: WARNING/Process-1] KeyError: 'entries'\r\n[2019-02-08 15:07:57,550: WARNING/Process-1] During handling of the above exception, another exception occurred:\r\n[2019-02-08 15:07:57,550: WARNING/Process-1] Traceback (most recent call last):\r\n[2019-02-08 15:07:57,550: WARNING/Process-1] File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 258, in _bootstrap\r\n    self.run()\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/usr/lib64/python3.6/multiprocessing/process.py\", line 93, in run\r\n    self._target(*self._args, **self._kwargs)\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/run_dispatcher.py\", line 99, in beat\r\n    schedule=sched_file, scheduler_cls=AWXScheduler\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/apps/beat.py\", line 81, in run\r\n    self.start_scheduler()\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/apps/beat.py\", line 109, in start_scheduler\r\n    service.start()\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/beat.py\", line 588, in start\r\n    interval = self.scheduler.tick()\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/run_dispatcher.py\", line 57, in tick\r\n    return super(AWXScheduler, self).tick(*args, **kwargs)\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/beat.py\", line 291, in tick\r\n    not self.schedules_equal(self.old_schedulers, self.schedule)):\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/celery/beat.py\", line 536, in get_schedule\r\n    return self._store[str('entries')]\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/usr/lib64/python3.6/shelve.py\", line 113, in __getitem__\r\n    f = BytesIO(self.dict[key.encode(self.keyencoding)])\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] File \"/usr/lib64/python3.6/shelve.py\", line 70, in closed\r\n    raise ValueError('invalid operation on closed shelf')\r\n[2019-02-08 15:07:57,551: WARNING/Process-1] ValueError: invalid operation on closed shelf\r\n2019-02-08 15:07:59,312 INFO waiting for dispatcher to stop\r\n2019-02-08 15:07:59,503 DEBUG    awx.main.dispatch received SIGTERM, stopping\r\n2019-02-08 15:07:59,527 DEBUG    awx.main.dispatch received SIGTERM, stopping\r\n2019-02-08 15:07:59,545 WARNING  awx.main.tasks Normal shutdown signal for instance awx_task, removed self from capacity pool.\r\n2019-02-08 15:07:59,552 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:07:59,644 INFO     awx.main.scheduler Spawning jobs for workflow_job 63865 (running)\r\n2019-02-08 15:07:59,663 DEBUG    awx.main.dispatch delivered 0242ac12-0004-1165-cc86-00000000000c to worker[166] qsize 0\r\n2019-02-08 15:07:59,665 DEBUG    awx.main.dispatch delivered a3f49d90-02a4-4c09-9d18-f0b3ccb4e025 to worker[167] qsize 0\r\n2019-02-08 15:07:59,667 DEBUG    awx.main.dispatch delivered 0242ac12-0004-1165-cc86-00000000000d to worker[167] qsize 0\r\n2019-02-08 15:07:59,668 DEBUG    awx.main.dispatch delivered e60d2685-5a2d-4013-96ca-be658a2c729a to worker[168] qsize 0\r\n2019-02-08 15:07:59,669 DEBUG    awx.main.dispatch delivered ca5053a4-fb0f-4e53-bcd5-a516c7736977 to worker[169] qsize 0\r\n2019-02-08 15:07:59,671 DEBUG    awx.main.dispatch delivered 262ff769-bbc9-4ad8-a977-12144ebab57c to worker[167] qsize 1\r\n2019-02-08 15:07:59,700 INFO     awx.main.scheduler Spawned inventory_update 63870 (new) in workflow_job 63865 (running) for node 5182\r\n2019-02-08 15:07:59,731 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=8\r\n2019-02-08 15:07:59,757 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=8, in 0.024 seconds\r\n2019-02-08 15:07:59,795 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(3369e2ff-0c31-47ec-bfc3-e80886c55a77, queue=awx_private_queue)\r\n2019-02-08 15:07:59,809 DEBUG    awx.main.dispatch task d9ed6945-a6d6-4e6f-bff3-9890eac11197 is finished\r\n2019-02-08 15:07:59,848 WARNING  awx.main.tasks Normal shutdown signal for instance awx_task, removed self from capacity pool.\r\n2019-02-08 15:07:59,853 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=5\r\n2019-02-08 15:07:59,866 WARNING  awx.main.tasks Normal shutdown signal for instance awx_task, removed self from capacity pool.\r\n2019-02-08 15:07:59,875 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:07:59,893 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=5, in 0.037 seconds\r\n2019-02-08 15:07:59,894 DEBUG    awx.main.dispatch task 4ea98ff3-3779-4f7e-bf6d-9a04cbbbc2ee is finished\r\n2019-02-08 15:07:59,953 DEBUG    awx.main.dispatch task e60d2685-5a2d-4013-96ca-be658a2c729a is finished\r\n2019-02-08 15:07:59,958 DEBUG    awx.main.dispatch task 6fd78338-8002-4852-a187-b97a7c6537e4 is finished\r\n2019-02-08 15:07:59,990 DEBUG    awx.main.dispatch task a3f49d90-02a4-4c09-9d18-f0b3ccb4e025 is finished\r\n2019-02-08 15:07:59,991 DEBUG    awx.main.scheduler No nodes to spawn for workflow_job 63865 (running)\r\nRESULT 2\r\nOKREADY\r\n2019-02-08 15:08:00,019 DEBUG    awx.main.scheduler Skipping group tower, remaining_capacity 0 <= 0\r\n2019-02-08 15:08:00,021 DEBUG    awx.main.scheduler inventory_update 63870 (pending) couldn't be scheduled on graph, waiting for next cycle\r\n2019-02-08 15:08:00,026 DEBUG    awx.main.dispatch task d196ae5f-4e82-43ed-bdb9-22c8cc8ef2cb is finished\r\n2019-02-08 15:08:00,092 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=5\r\n2019-02-08 15:08:00,133 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=5, in 0.040 seconds\r\n2019-02-08 15:08:00,134 DEBUG    awx.main.dispatch task ca5053a4-fb0f-4e53-bcd5-a516c7736977 is finished\r\n2019-02-08 15:08:01,312 INFO waiting for dispatcher to stop\r\n2019-02-08 15:08:02,312 WARN killing 'dispatcher' (164) with SIGKILL\r\n2019-02-08 15:08:02,326 INFO stopped: dispatcher (terminated by SIGKILL)\r\n2019-02-08 15:08:02,330 INFO spawned: 'dispatcher' with pid 424\r\n2019-02-08 15:08:03,177 DEBUG    awx.main.dispatch task 0242ac12-0004-1165-cc86-00000000000c is finished\r\n2019-02-08 15:08:03,268 DEBUG    awx.main.dispatch task 0242ac12-0004-1165-cc86-00000000000d is finished\r\n2019-02-08 15:08:03,270 INFO     awx.main.commands.run_callback_receiver Event processing is finished for Job 63869, sending notifications\r\n2019-02-08 15:08:03,270 INFO     awx.main.commands.run_callback_receiver Event processing is finished for Job 63869, sending notifications\r\n2019-02-08 15:08:03,571 DEBUG    awx.main.dispatch task 262ff769-bbc9-4ad8-a977-12144ebab57c is finished\r\n2019-02-08 15:08:03,572 INFO success: dispatcher entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)\r\n2019-02-08 15:08:19,708 WARNING  awx.main.dispatch scaling up worker pid:430\r\n2019-02-08 15:08:19,721 WARNING  awx.main.dispatch scaling up worker pid:431\r\n2019-02-08 15:08:19,732 WARNING  awx.main.dispatch scaling up worker pid:432\r\n2019-02-08 15:08:19,746 WARNING  awx.main.dispatch scaling up worker pid:433\r\n2019-02-08 15:08:19,750 INFO     awx.main.tasks Syncing Schedules\r\n2019-02-08 15:08:21,057 DEBUG    awx.main.tasks Waited 0.0008141994476318359 seconds to obtain lock name: cluster_policy_lock\r\n2019-02-08 15:08:21,066 INFO     awx.main.tasks Total non-isolated instances:2 available for policy: 2\r\n2019-02-08 15:08:21,068 INFO     awx.main.tasks Policy percentage, adding Instances [12, 13] to Group tower\r\n2019-02-08 15:08:21,069 INFO     awx.main.tasks Cluster policy no-op finished in 0.010084867477416992 seconds\r\n2019-02-08 15:08:21,070 DEBUG    awx.main.tasks Cluster node heartbeat task.\r\n2019-02-08 15:08:21,076 WARNING  awx.main.tasks Rejoining the cluster as instance awx_task.\r\n2019-02-08 15:08:21,109 DEBUG    awx.main.dispatch listening on ['awx_private_queue [direct]', 'awx_task [direct]', 'tower_broadcast_all_awx_task [fanout]']\r\n2019-02-08 15:08:21,115 DEBUG    awx.main.dispatch delivered 9cee14c2-8da1-4082-81a3-9f49c7ae7d73 to worker[431] qsize 0\r\n2019-02-08 15:08:21,119 DEBUG    awx.main.dispatch delivered 3369e2ff-0c31-47ec-bfc3-e80886c55a77 to worker[433] qsize 0\r\n2019-02-08 15:08:21,119 DEBUG    awx.main.dispatch task 9cee14c2-8da1-4082-81a3-9f49c7ae7d73 starting awx.main.tasks.awx_periodic_scheduler(*[])\r\n2019-02-08 15:08:21,123 DEBUG    awx.main.dispatch task 3369e2ff-0c31-47ec-bfc3-e80886c55a77 starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:08:21,126 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-02-08 15:08:24,161 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(e0b22d49-6e7c-4cee-af94-7f1ad63a2dfe, queue=awx_private_queue)\r\n[2019-02-08 15:08:24,161: DEBUG/Process-1] publish awx.main.scheduler.tasks.run_task_manager(e0b22d49-6e7c-4cee-af94-7f1ad63a2dfe, queue=awx_private_queue)\r\n2019-02-08 15:08:24,183 DEBUG    awx.main.dispatch delivered e0b22d49-6e7c-4cee-af94-7f1ad63a2dfe to worker[430] qsize 0\r\n2019-02-08 15:08:24,187 DEBUG    awx.main.dispatch task e0b22d49-6e7c-4cee-af94-7f1ad63a2dfe starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:08:24,190 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-02-08 15:08:31,254 DEBUG    awx.main.tasks Last scheduler run was: 2019-02-07 20:33:41.266641+00:00\r\n2019-02-08 15:08:31,269 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:08:31,275 DEBUG    awx.main.dispatch task 9cee14c2-8da1-4082-81a3-9f49c7ae7d73 is finished\r\n2019-02-08 15:08:31,359 DEBUG    awx.main.scheduler Not running scheduler, another task holds lock\r\n2019-02-08 15:08:31,361 DEBUG    awx.main.dispatch task e0b22d49-6e7c-4cee-af94-7f1ad63a2dfe is finished\r\n2019-02-08 15:08:31,406 DEBUG    awx.main.scheduler No nodes to spawn for workflow_job 63865 (running)\r\n2019-02-08 15:08:31,445 DEBUG    awx.main.scheduler Starting inventory_update 63870 (pending) in group tower instance awx_task (remaining_capacity=622)\r\n2019-02-08 15:08:31,451 INFO     awx.main.scheduler Submitting inventory_update 63870 (waiting) to <instance group, instance> <1,awx_task>.\r\n2019-02-08 15:08:31,479 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=8\r\n2019-02-08 15:08:31,504 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=8, in 0.024 seconds\r\n2019-02-08 15:08:31,505 DEBUG    awx.main.scheduler inventory_update 63870 (waiting) consumed 1 capacity units from tower with prior total of 0\r\n2019-02-08 15:08:31,672 DEBUG    awx.main.dispatch publish awx.main.tasks.RunInventoryUpdate(9decc789-3cc7-4d58-84cc-140f264ebe1e, queue=awx_task)\r\n2019-02-08 15:08:31,683 DEBUG    awx.main.dispatch task 3369e2ff-0c31-47ec-bfc3-e80886c55a77 is finished\r\n2019-02-08 15:08:31,683 DEBUG    awx.main.dispatch delivered 9decc789-3cc7-4d58-84cc-140f264ebe1e to worker[431] qsize 0\r\n2019-02-08 15:08:31,685 DEBUG    awx.main.dispatch task 9decc789-3cc7-4d58-84cc-140f264ebe1e starting awx.main.tasks.RunInventoryUpdate(*[63870])\r\n2019-02-08 15:08:31,872 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=8\r\n2019-02-08 15:08:31,903 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=8, in 0.029 seconds\r\n2019-02-08 15:08:34,134 DEBUG    awx.main.dispatch publish awx.main.tasks.awx_periodic_scheduler(bab5d7e5-a6db-4f70-9587-e197fa7a9634, queue=awx_private_queue)\r\n[2019-02-08 15:08:34,134: DEBUG/Process-1] publish awx.main.tasks.awx_periodic_scheduler(bab5d7e5-a6db-4f70-9587-e197fa7a9634, queue=awx_private_queue)\r\n2019-02-08 15:08:34,151 DEBUG    awx.main.dispatch delivered bab5d7e5-a6db-4f70-9587-e197fa7a9634 to worker[430] qsize 0\r\n2019-02-08 15:08:34,154 DEBUG    awx.main.dispatch task bab5d7e5-a6db-4f70-9587-e197fa7a9634 starting awx.main.tasks.awx_periodic_scheduler(*[])\r\n2019-02-08 15:08:34,434 DEBUG    awx.main.tasks Last scheduler run was: 2019-02-08 15:08:21.123043+00:00\r\n2019-02-08 15:08:34,451 DEBUG    awx.main.dispatch task bab5d7e5-a6db-4f70-9587-e197fa7a9634 is finished\r\n2019-02-08 15:08:44,147 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(b59297a5-4ed5-462f-bb74-d8bcc3009d99, queue=awx_private_queue)\r\n[2019-02-08 15:08:44,147: DEBUG/Process-1] publish awx.main.scheduler.tasks.run_task_manager(b59297a5-4ed5-462f-bb74-d8bcc3009d99, queue=awx_private_queue)\r\n2019-02-08 15:08:44,166 DEBUG    awx.main.dispatch delivered b59297a5-4ed5-462f-bb74-d8bcc3009d99 to worker[432] qsize 0\r\n2019-02-08 15:08:44,170 DEBUG    awx.main.dispatch task b59297a5-4ed5-462f-bb74-d8bcc3009d99 starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:08:44,173 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-02-08 15:08:57,702 DEBUG    awx.main.dispatch delivered fbd06fd6-4744-474f-b0d6-17f1a205333e to worker[168] qsize 0\r\n2019-02-08 15:08:57,704 DEBUG    awx.main.dispatch delivered d6aa8e42-e923-4d68-809a-46224b2184a4 to worker[169] qsize 0\r\n2019-02-08 15:08:57,708 DEBUG    awx.main.dispatch delivered 1cb9fbfa-fc17-48ba-bc77-412f0c650d29 to worker[166] qsize 0\r\n2019-02-08 15:08:57,710 DEBUG    awx.main.dispatch delivered 6dd59efe-1af0-44a9-a613-f104029a70a1 to worker[167] qsize 0\r\n2019-02-08 15:08:57,712 DEBUG    awx.main.dispatch delivered 00f66968-545b-4573-8630-ee94b47fbf5a to worker[168] qsize 0\r\n2019-02-08 15:09:01,530 DEBUG    awx.main.dispatch delivered 722dafbd-c9a7-47a3-ad06-c59ee70e7ba6 to worker[169] qsize 0\r\nRESULT 2\r\nOKREADY\r\n2019-02-08 15:09:02,690 DEBUG    awx.main.dispatch delivered 9a1a27a0-7397-4715-8b20-85585e31b09a to worker[166] qsize 0\r\n2019-02-08 15:09:04,145 DEBUG    awx.main.dispatch publish awx.main.tasks.cluster_node_heartbeat(0a432265-380a-4b2c-bfff-f2a3016a3505, queue=awx_task)\r\n[2019-02-08 15:09:04,145: DEBUG/Process-1] publish awx.main.tasks.cluster_node_heartbeat(0a432265-380a-4b2c-bfff-f2a3016a3505, queue=awx_task)\r\n2019-02-08 15:09:04,159 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(fe69335c-d329-45c0-bbd9-03bbad81bc41, queue=awx_private_queue)\r\n[2019-02-08 15:09:04,159: DEBUG/Process-1] publish awx.main.scheduler.tasks.run_task_manager(fe69335c-d329-45c0-bbd9-03bbad81bc41, queue=awx_private_queue)\r\n2019-02-08 15:09:04,171 DEBUG    awx.main.dispatch publish awx.main.tasks.awx_periodic_scheduler(54385422-892c-432e-98f8-89cbf6a9f8ba, queue=awx_private_queue)\r\n2019-02-08 15:09:04,171 DEBUG    awx.main.dispatch delivered 0a432265-380a-4b2c-bfff-f2a3016a3505 to worker[430] qsize 0\r\n[2019-02-08 15:09:04,171: DEBUG/Process-1] publish awx.main.tasks.awx_periodic_scheduler(54385422-892c-432e-98f8-89cbf6a9f8ba, queue=awx_private_queue)\r\n2019-02-08 15:09:04,175 DEBUG    awx.main.dispatch task 0a432265-380a-4b2c-bfff-f2a3016a3505 starting awx.main.tasks.cluster_node_heartbeat(*[])\r\n2019-02-08 15:09:04,175 DEBUG    awx.main.dispatch delivered fe69335c-d329-45c0-bbd9-03bbad81bc41 to worker[433] qsize 0\r\n2019-02-08 15:09:04,177 DEBUG    awx.main.dispatch task fe69335c-d329-45c0-bbd9-03bbad81bc41 starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:09:04,179 DEBUG    awx.main.tasks Cluster node heartbeat task.\r\n2019-02-08 15:09:04,179 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-02-08 15:09:04,186 WARNING  awx.main.dispatch scaling up worker pid:463\r\n2019-02-08 15:09:04,191 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:09:04,191 DEBUG    awx.main.dispatch delivered 54385422-892c-432e-98f8-89cbf6a9f8ba to worker[463] qsize 0\r\n2019-02-08 15:09:04,193 DEBUG    awx.main.dispatch task 54385422-892c-432e-98f8-89cbf6a9f8ba starting awx.main.tasks.awx_periodic_scheduler(*[])\r\n2019-02-08 15:09:04,286 DEBUG    awx.main.scheduler No nodes to spawn for workflow_job 63865 (running)\r\n2019-02-08 15:09:04,296 DEBUG    awx.main.dispatch task b59297a5-4ed5-462f-bb74-d8bcc3009d99 is finished\r\n2019-02-08 15:09:04,563 DEBUG    awx.main.dispatch task fbd06fd6-4744-474f-b0d6-17f1a205333e is finished\r\n2019-02-08 15:09:04,580 DEBUG    awx.main.dispatch task d6aa8e42-e923-4d68-809a-46224b2184a4 is finished\r\n2019-02-08 15:09:04,595 DEBUG    awx.main.dispatch task 1cb9fbfa-fc17-48ba-bc77-412f0c650d29 is finished\r\n2019-02-08 15:09:04,609 DEBUG    awx.main.dispatch task 6dd59efe-1af0-44a9-a613-f104029a70a1 is finished\r\n2019-02-08 15:09:09,095 DEBUG    awx.main.dispatch delivered c0158b75-f4e3-405a-b374-7bb6cc4e411b to worker[167] qsize 0\r\n2019-02-08 15:09:09,396 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:09:09,401 DEBUG    awx.main.tasks Last scheduler run was: 2019-02-08 15:08:34.157153+00:00\r\n2019-02-08 15:09:09,407 DEBUG    awx.main.dispatch task 0a432265-380a-4b2c-bfff-f2a3016a3505 is finished\r\n2019-02-08 15:09:09,414 DEBUG    awx.main.dispatch task 54385422-892c-432e-98f8-89cbf6a9f8ba is finished\r\n2019-02-08 15:09:09,449 DEBUG    awx.main.dispatch task 00f66968-545b-4573-8630-ee94b47fbf5a is finished\r\n2019-02-08 15:09:09,452 DEBUG    awx.main.dispatch task 9a1a27a0-7397-4715-8b20-85585e31b09a is finished\r\n2019-02-08 15:09:09,455 DEBUG    awx.main.dispatch task 722dafbd-c9a7-47a3-ad06-c59ee70e7ba6 is finished\r\n2019-02-08 15:09:09,456 DEBUG    awx.main.dispatch task c0158b75-f4e3-405a-b374-7bb6cc4e411b is finished\r\n2019-02-08 15:09:09,484 DEBUG    awx.main.scheduler No nodes to spawn for workflow_job 63865 (running)\r\n2019-02-08 15:09:09,497 DEBUG    awx.main.dispatch task fe69335c-d329-45c0-bbd9-03bbad81bc41 is finished\r\n2019-02-08 15:09:10,221 DEBUG    awx.main.dispatch delivered 5eae50a6-ce8e-4f5e-a086-6a3e053c97f7 to worker[168] qsize 0\r\n2019-02-08 15:09:10,265 DEBUG    awx.main.dispatch delivered 8aef29ae-d9ea-4dbc-8e1c-5b637934ef53 to worker[169] qsize 0\r\n2019-02-08 15:09:10,623 INFO     awx.main.tasks inventory_update 63870 (running) finished running, producing 10 events.\r\n2019-02-08 15:09:10,623 DEBUG    awx.main.dispatch delivered f472746b-1e73-4559-a562-75bac5384c19 to worker[166] qsize 0\r\n2019-02-08 15:09:10,626 INFO     awx.main.commands.run_callback_receiver Event processing is finished for Job 63870, sending notifications\r\n2019-02-08 15:09:10,626 INFO     awx.main.commands.run_callback_receiver Event processing is finished for Job 63870, sending notifications\r\n2019-02-08 15:09:10,672 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=8\r\n2019-02-08 15:09:10,692 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=8, in 0.019 seconds\r\n2019-02-08 15:09:10,703 DEBUG    awx.main.dispatch task 9decc789-3cc7-4d58-84cc-140f264ebe1e starting awx.main.tasks.handle_work_success(*[])\r\n2019-02-08 15:09:10,707 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(c7e8d580-99f8-4bca-abd5-5fe84cd89d0e, queue=awx_private_queue)\r\n2019-02-08 15:09:10,718 DEBUG    awx.main.dispatch task 9decc789-3cc7-4d58-84cc-140f264ebe1e is finished\r\n2019-02-08 15:09:10,718 DEBUG    awx.main.dispatch delivered c7e8d580-99f8-4bca-abd5-5fe84cd89d0e to worker[430] qsize 0\r\n2019-02-08 15:09:10,721 DEBUG    awx.main.dispatch task c7e8d580-99f8-4bca-abd5-5fe84cd89d0e starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:09:10,722 DEBUG    awx.main.scheduler Running Tower task manager.\r\nRESULT 2\r\nOKREADY\r\n2019-02-08 15:09:02,690 DEBUG    awx.main.dispatch delivered 9a1a27a0-7397-4715-8b20-85585e31b09a to worker[166] qsize 0\r\n2019-02-08 15:09:04,145 DEBUG    awx.main.dispatch publish awx.main.tasks.cluster_node_heartbeat(0a432265-380a-4b2c-bfff-f2a3016a3505, queue=frankenstein)\r\n[2019-02-08 15:09:04,145: DEBUG/Process-1] publish awx.main.tasks.cluster_node_heartbeat(0a432265-380a-4b2c-bfff-f2a3016a3505, queue=frankenstein)\r\n2019-02-08 15:09:04,159 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(fe69335c-d329-45c0-bbd9-03bbad81bc41, queue=awx_private_queue)\r\n[2019-02-08 15:09:04,159: DEBUG/Process-1] publish awx.main.scheduler.tasks.run_task_manager(fe69335c-d329-45c0-bbd9-03bbad81bc41, queue=awx_private_queue)\r\n2019-02-08 15:09:04,171 DEBUG    awx.main.dispatch publish awx.main.tasks.awx_periodic_scheduler(54385422-892c-432e-98f8-89cbf6a9f8ba, queue=awx_private_queue)\r\n2019-02-08 15:09:04,171 DEBUG    awx.main.dispatch delivered 0a432265-380a-4b2c-bfff-f2a3016a3505 to worker[430] qsize 0\r\n[2019-02-08 15:09:04,171: DEBUG/Process-1] publish awx.main.tasks.awx_periodic_scheduler(54385422-892c-432e-98f8-89cbf6a9f8ba, queue=awx_private_queue)\r\n2019-02-08 15:09:04,175 DEBUG    awx.main.dispatch task 0a432265-380a-4b2c-bfff-f2a3016a3505 starting awx.main.tasks.cluster_node_heartbeat(*[])\r\n2019-02-08 15:09:04,175 DEBUG    awx.main.dispatch delivered fe69335c-d329-45c0-bbd9-03bbad81bc41 to worker[433] qsize 0\r\n2019-02-08 15:09:04,177 DEBUG    awx.main.dispatch task fe69335c-d329-45c0-bbd9-03bbad81bc41 starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:09:04,179 DEBUG    awx.main.tasks Cluster node heartbeat task.\r\n2019-02-08 15:09:04,179 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-02-08 15:09:04,186 WARNING  awx.main.dispatch scaling up worker pid:463\r\n2019-02-08 15:09:04,191 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:09:04,191 DEBUG    awx.main.dispatch delivered 54385422-892c-432e-98f8-89cbf6a9f8ba to worker[463] qsize 0\r\n2019-02-08 15:09:04,193 DEBUG    awx.main.dispatch task 54385422-892c-432e-98f8-89cbf6a9f8ba starting awx.main.tasks.awx_periodic_scheduler(*[])\r\n2019-02-08 15:09:04,286 DEBUG    awx.main.scheduler No nodes to spawn for workflow_job 63865 (running)\r\n2019-02-08 15:09:04,296 DEBUG    awx.main.dispatch task b59297a5-4ed5-462f-bb74-d8bcc3009d99 is finished\r\n2019-02-08 15:09:04,563 DEBUG    awx.main.dispatch task fbd06fd6-4744-474f-b0d6-17f1a205333e is finished\r\n2019-02-08 15:09:04,580 DEBUG    awx.main.dispatch task d6aa8e42-e923-4d68-809a-46224b2184a4 is finished\r\n2019-02-08 15:09:04,595 DEBUG    awx.main.dispatch task 1cb9fbfa-fc17-48ba-bc77-412f0c650d29 is finished\r\n2019-02-08 15:09:04,609 DEBUG    awx.main.dispatch task 6dd59efe-1af0-44a9-a613-f104029a70a1 is finished\r\n2019-02-08 15:09:09,095 DEBUG    awx.main.dispatch delivered c0158b75-f4e3-405a-b374-7bb6cc4e411b to worker[167] qsize 0\r\n2019-02-08 15:09:09,396 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:09:09,401 DEBUG    awx.main.tasks Last scheduler run was: 2019-02-08 15:08:34.157153+00:00\r\n2019-02-08 15:09:09,407 DEBUG    awx.main.dispatch task 0a432265-380a-4b2c-bfff-f2a3016a3505 is finished\r\n2019-02-08 15:09:09,414 DEBUG    awx.main.dispatch task 54385422-892c-432e-98f8-89cbf6a9f8ba is finished\r\n2019-02-08 15:09:09,449 DEBUG    awx.main.dispatch task 00f66968-545b-4573-8630-ee94b47fbf5a is finished\r\n2019-02-08 15:09:09,452 DEBUG    awx.main.dispatch task 9a1a27a0-7397-4715-8b20-85585e31b09a is finished\r\n2019-02-08 15:09:09,455 DEBUG    awx.main.dispatch task 722dafbd-c9a7-47a3-ad06-c59ee70e7ba6 is finished\r\n2019-02-08 15:09:09,456 DEBUG    awx.main.dispatch task c0158b75-f4e3-405a-b374-7bb6cc4e411b is finished\r\n2019-02-08 15:09:09,484 DEBUG    awx.main.scheduler No nodes to spawn for workflow_job 63865 (running)\r\n2019-02-08 15:09:09,497 DEBUG    awx.main.dispatch task fe69335c-d329-45c0-bbd9-03bbad81bc41 is finished\r\n2019-02-08 15:09:10,221 DEBUG    awx.main.dispatch delivered 5eae50a6-ce8e-4f5e-a086-6a3e053c97f7 to worker[168] qsize 0\r\n2019-02-08 15:09:10,265 DEBUG    awx.main.dispatch delivered 8aef29ae-d9ea-4dbc-8e1c-5b637934ef53 to worker[169] qsize 0\r\n2019-02-08 15:09:10,623 INFO     awx.main.tasks inventory_update 63870 (running) finished running, producing 10 events.\r\n2019-02-08 15:09:10,623 DEBUG    awx.main.dispatch delivered f472746b-1e73-4559-a562-75bac5384c19 to worker[166] qsize 0\r\n2019-02-08 15:09:10,626 INFO     awx.main.commands.run_callback_receiver Event processing is finished for Job 63870, sending notifications\r\n2019-02-08 15:09:10,626 INFO     awx.main.commands.run_callback_receiver Event processing is finished for Job 63870, sending notifications\r\n2019-02-08 15:09:10,672 DEBUG    awx.main.models.inventory Going to update inventory computed fields, pk=8\r\n2019-02-08 15:09:10,692 DEBUG    awx.main.models.inventory Finished updating inventory computed fields, pk=8, in 0.019 seconds\r\n2019-02-08 15:09:10,703 DEBUG    awx.main.dispatch task 9decc789-3cc7-4d58-84cc-140f264ebe1e starting awx.main.tasks.handle_work_success(*[])\r\n2019-02-08 15:09:10,707 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(c7e8d580-99f8-4bca-abd5-5fe84cd89d0e, queue=awx_private_queue)\r\n2019-02-08 15:09:10,718 DEBUG    awx.main.dispatch task 9decc789-3cc7-4d58-84cc-140f264ebe1e is finished\r\n2019-02-08 15:09:10,718 DEBUG    awx.main.dispatch delivered c7e8d580-99f8-4bca-abd5-5fe84cd89d0e to worker[430] qsize 0\r\n2019-02-08 15:09:10,721 DEBUG    awx.main.dispatch task c7e8d580-99f8-4bca-abd5-5fe84cd89d0e starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:09:10,722 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-02-08 15:09:24,170 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(dc1b62e1-02ef-43a3-b6fb-1091494aa901, queue=awx_private_queue)\r\n[2019-02-08 15:09:24,170: DEBUG/Process-1] publish awx.main.scheduler.tasks.run_task_manager(dc1b62e1-02ef-43a3-b6fb-1091494aa901, queue=awx_private_queue)\r\n2019-02-08 15:09:24,184 DEBUG    awx.main.dispatch delivered dc1b62e1-02ef-43a3-b6fb-1091494aa901 to worker[433] qsize 0\r\n2019-02-08 15:09:24,188 DEBUG    awx.main.dispatch task dc1b62e1-02ef-43a3-b6fb-1091494aa901 starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:09:24,190 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-02-08 15:09:29,458 DEBUG    awx.main.dispatch task 5eae50a6-ce8e-4f5e-a086-6a3e053c97f7 is finished\r\n2019-02-08 15:09:29,475 DEBUG    awx.main.dispatch task 8aef29ae-d9ea-4dbc-8e1c-5b637934ef53 is finished\r\n2019-02-08 15:09:29,603 DEBUG    awx.main.dispatch task f472746b-1e73-4559-a562-75bac5384c19 is finished\r\n2019-02-08 15:09:29,741 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:09:29,860 INFO     awx.main.scheduler Marking workflow_job 63865 (running) as successful.\r\n2019-02-08 15:09:29,862 DEBUG    awx.main.scheduler Transitioning workflow_job 63865 (running) to successful status.\r\n2019-02-08 15:09:29,935 DEBUG    awx.main.scheduler Removed workflow_job 63865 (successful) from job spawning consideration.\r\n2019-02-08 15:09:30,127 DEBUG    awx.main.dispatch task c7e8d580-99f8-4bca-abd5-5fe84cd89d0e is finished\r\n2019-02-08 15:09:34,172 DEBUG    awx.main.dispatch publish awx.main.tasks.awx_periodic_scheduler(006f1486-7ad6-46b8-9aa5-f7c71f6a874e, queue=awx_private_queue)\r\n[2019-02-08 15:09:34,172: DEBUG/Process-1] publish awx.main.tasks.awx_periodic_scheduler(006f1486-7ad6-46b8-9aa5-f7c71f6a874e, queue=awx_private_queue)\r\n2019-02-08 15:09:34,193 DEBUG    awx.main.dispatch delivered 006f1486-7ad6-46b8-9aa5-f7c71f6a874e to worker[430] qsize 0\r\n2019-02-08 15:09:34,195 DEBUG    awx.main.dispatch task 006f1486-7ad6-46b8-9aa5-f7c71f6a874e starting awx.main.tasks.awx_periodic_scheduler(*[])\r\n2019-02-08 15:09:39,399 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:09:39,421 DEBUG    awx.main.dispatch task dc1b62e1-02ef-43a3-b6fb-1091494aa901 is finished\r\n2019-02-08 15:09:44,170 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(60c4bf91-c2ad-4ff7-b130-66991ab249b4, queue=awx_private_queue)\r\n[2019-02-08 15:09:44,170: DEBUG/Process-1] publish awx.main.scheduler.tasks.run_task_manager(60c4bf91-c2ad-4ff7-b130-66991ab249b4, queue=awx_private_queue)\r\n2019-02-08 15:09:44,187 DEBUG    awx.main.dispatch delivered 60c4bf91-c2ad-4ff7-b130-66991ab249b4 to worker[433] qsize 0\r\n2019-02-08 15:09:44,189 DEBUG    awx.main.dispatch task 60c4bf91-c2ad-4ff7-b130-66991ab249b4 starting awx.main.scheduler.tasks.run_task_manager(*[])\r\n2019-02-08 15:09:44,192 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2019-02-08 15:09:49,694 DEBUG    awx.main.tasks Last scheduler run was: 2019-02-08 15:09:04.195727+00:00\r\n2019-02-08 15:09:49,708 DEBUG    awx.main.dispatch task 006f1486-7ad6-46b8-9aa5-f7c71f6a874e is finished\r\n2019-02-08 15:09:59,742 DEBUG    awx.main.scheduler Starting Scheduler\r\n2019-02-08 15:09:59,766 DEBUG    awx.main.dispatch task 60c4bf91-c2ad-4ff7-b130-66991ab249b4 is finished\r\nRESULT 2\r\nOKREADY\r\n2019-02-08 15:10:04,181 DEBUG    awx.main.dispatch publish awx.main.scheduler.tasks.run_task_manager(15dd8493-55c4-4818-9254-78ad498f68ac, queue=awx_private_queue)\r\nRESULT 2\r\nOKREADY\r\n```\r\n\r\nat this point, the ui is again unavailable, the browser is hanging and \r\n```\r\nRESULT 2\r\nOKREADY\r\nRESULT 2\r\nOKREADY\r\nRESULT 2\r\nOKREADY\r\nRESULT 2\r\nOKREADY\r\n172.17.0.5 - - [08/Feb/2019:15:12:56 +0000] \"GET / HTTP/1.1\" 504 183 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15\" \"10.116.105.134\"\r\n2019/02/08 15:12:56 [error] 702#0: *85 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 172.17.0.5, server: _, request: \"GET / HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx_web.example.com\"\r\n172.17.0.5 - - [08/Feb/2019:15:12:56 +0000] \"GET /api/ HTTP/1.1\" 504 183 \"https://awx_web.example.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15\" \"10.116.105.134\"\r\n2019/02/08 15:12:56 [error] 702#0: *87 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 172.17.0.5, server: _, request: \"GET /api/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx_web.example.com\", referrer: \"https://awx_web.example.com/\"\r\n2019/02/08 15:12:56 [error] 702#0: *89 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 172.17.0.5, server: _, request: \"GET /api/v2/auth/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx_web.example.com\", referrer: \"https://awx_web.example.com/\"\r\n172.17.0.5 - - [08/Feb/2019:15:12:56 +0000] \"GET /api/v2/auth/ HTTP/1.1\" 504 183 \"https://awx_web.example.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15\" \"10.116.105.134\"\r\nFri Feb  8 15:12:57 2019 - *** HARAKIRI ON WORKER 1 (pid: 772, try: 1) ***\r\nFri Feb  8 15:12:57 2019 - HARAKIRI !!! worker 1 status !!!\r\nFri Feb  8 15:12:57 2019 - HARAKIRI [core 0] 172.17.0.5 - GET / since 1549638656\r\nFri Feb  8 15:12:57 2019 - HARAKIRI !!! end of worker 1 status !!!\r\nFri Feb  8 15:12:57 2019 - *** HARAKIRI ON WORKER 2 (pid: 757, try: 1) ***\r\nFri Feb  8 15:12:57 2019 - HARAKIRI !!! worker 2 status !!!\r\nFri Feb  8 15:12:57 2019 - HARAKIRI [core 0] 172.17.0.5 - GET /api/v2/auth/ since 1549638656\r\nFri Feb  8 15:12:57 2019 - HARAKIRI !!! end of worker 2 status !!!\r\nFri Feb  8 15:12:57 2019 - *** HARAKIRI ON WORKER 5 (pid: 773, try: 1) ***\r\nFri Feb  8 15:12:57 2019 - HARAKIRI !!! worker 5 status !!!\r\nFri Feb  8 15:12:57 2019 - HARAKIRI [core 0] 172.17.0.5 - GET /api/ since 1549638656\r\nFri Feb  8 15:12:57 2019 - HARAKIRI !!! end of worker 5 status !!!\r\nDAMN ! worker 2 (pid: 757) died, killed by signal 9 :( trying respawn ...\r\nRespawned uWSGI worker 2 (new pid: 782)\r\nDAMN ! worker 1 (pid: 772) died, killed by signal 9 :( trying respawn ...\r\nRespawned uWSGI worker 1 (new pid: 783)\r\nDAMN ! worker 5 (pid: 773) died, killed by signal 9 :( trying respawn ...\r\nRespawned uWSGI worker 5 (new pid: 784)\r\nRESULT 2\r\nOKREADY\r\n```\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nPython 3 in latest awx_task:3.0.0 docker image\r\n\r\n##### SUMMARY\r\nGCE Inventory sync fails\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.0.0\r\n* AWX install method: docker standalone\r\n* Operating System: Debian 8\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nTry to sync GCE inventory\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSynced fine\r\n\r\n##### ACTUAL RESULTS\r\n\r\nFails with:\r\n\r\n```\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\n [WARNING]:  * Failed to parse /var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/gce.py with script plugin: Inventory script\r\n(/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/gce.py) had an execution error: Traceback (most\r\nrecent call last):   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/gce.py\", line 508, in <module>\r\nGceInventory()   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/gce.py\", line 170, in __init__     self.driver =\r\nself.get_gce_driver()   File \"/var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/gce.py\", line 318, in get_gce_driver     gce =\r\nget_driver(Provider.GCE)(*args, **kwargs)   File\r\n\"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/libcloud/compute/drivers/gce.py\", line 1795, in __init__\r\nsuper(GCENodeDriver, self).__init__(user_id, key, **kwargs)   File\r\n\"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/libcloud/common/base.py\", line 975, in __init__     self.connection =\r\nself.connectionCls(*args, **conn_kwargs)   File\r\n\"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/libcloud/compute/drivers/gce.py\", line 99, in __init__\r\ncredential_file=credential_file, **kwargs)   File\r\n\"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/libcloud/common/google.py\", line 767, in __init__     user_id, key,\r\nauth_type, credential_file, scopes, **kwargs)   File\r\n\"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/libcloud/common/google.py\", line 653, in __init__     self.user_id,\r\nself.key, self.scopes, **kwargs)   File\r\n\"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/libcloud/common/google.py\", line 486, in __init__     raise\r\nGoogleAuthError('PyCrypto library required for '\r\nlibcloud.common.google.GoogleAuthError: 'PyCrypto library required for Service\r\nAccount Authentication.'\r\n [WARNING]: Unable to parse /var/lib/awx/venv/awx/lib64/python3.6/site-\r\npackages/awx/plugins/inventory/gce.py as an inventory source\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME \r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nWhen I run playbook with long log output, the lines order is getting wrong and it is not usable.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2.0\r\n* AWX install method:  docker on linux\r\n* Ansible version: 2.7.4\r\n* Operating System: Windows 2008 R2 but see this on more windows sytems\r\n* Web Browser: Mozilla Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRunning a playbook with loops gies incorrect logging. Used strategy host_pinned\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI should be able to see the lines in correct orderr\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe order of the lines is corrupted and it is not usable\r\n\r\n##### ADDITIONAL INFORMATION\r\nLoop code used:\r\n````\r\n- name: Start Windows Updates\r\n  include_tasks: wsus-install.yml\r\n  loop:\r\n    - 1\r\n    - 2\r\n    - 3\r\n    - 4\r\n    - 5\r\n  loop_control:\r\n    loop_var: outer_item\r\n\r\n wsus-install.yml\r\n- name: Check for missing updates Loop {{ outer_item }}.\r\n  win_updates: state=searched\r\n  register: update_count\r\n#- debug: var=update_count\r\n- name: WSUS - Detect Now\r\n  win_shell: wuauclt.exe /detectnow /reportnow\r\n  args:\r\n    executable: cmd\r\n````\r\n\r\n\r\n![](https://i.imgur.com/CTatp2L.png)\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - CLI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n AWX returns error when  creating a job_template using tower-cli, if credentials used are of type VMware vCenter\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2.0\r\n* AWX install method: docker on CentOS\r\n* Ansible version:  ansible 2.7.4\r\n*  python version = 2.7.15rc1 (default, Nov 12 2018, 14:31:15) [GCC 7.3.0]\r\n* Tower CLI 3.3.0\r\n* Operating System: Ubuntu 18.04.1 LTS\r\n* Web Browser: Not aplicable\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n - Create a valid VMware vCenter credential\r\n - run tower-cli job_template create using created credential \r\n\r\n##### EXPECTED RESULTS\r\n \r\n<!-- What did you expect to happen when running the steps above? -->\r\n A new job_template created suing VMware vCenter credential.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n tower-cli returns error:\r\n```\r\nError: The Tower server claims it was sent a bad request.\r\n\r\nPOST http://<server>/api/v2/job_templates/\r\nParams: None\r\nData: {\"job_type\": \"run\", \"playbook\": \"playbooks/vmware-deploy/create_vm_awx_demo.yml\", \"survey_enabled\": false, \"inventory\": 2, \"become_enabled\": false, \"credential\": 3, \"name\": \"teste_vcenter_1\", \"project\": 30}\r\n\r\nResponse: {\"credential\":[\"You must provide an SSH credential.\"]}\r\n\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\ntower-cli return code: 40\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nCustomer request: For users to know about what the playbook is doing in a job template like a advanced description/documentation field where it will show the detail information about job template. \r\nExample, a description of all available tags in a template\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\nCreate Export Ability from AWX for Usage Statistics\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n Ability to export from AWX for Usage Statistics. Is there any option to export data from AWX to any other source? Example: Export list of job's executed by a user to Excel or CSV.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nWe see there is an option to view the usage, we need to if there is an option to export it."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nGCE imported hosts should have an instance id\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.3.0\r\n* AWX install method: all\r\n* Ansible version:  >=2.5?\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPerform an import with a gce inventory source\r\n\r\nInspect `instance_id` of a host that was imported.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA long, uuid-ish, kind of string\r\n\r\n##### ACTUAL RESULTS\r\n\r\nBlank string\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe inventory plugin makes the host name configurable:\r\n\r\nhttps://docs.ansible.com/ansible/latest/plugins/inventory/gcp_compute.html\r\n\r\n> A list of options that describe the ordering for which hostnames should be assigned. Currently supported hostnames are 'public_ip', 'private_ip', or 'name'.\r\n\r\nA configurable host name goes with an unset instance_id like oil and water go together. It is bad news. Any import will changed settings will lose referential integrity, duplicate hosts, and there will be no way to get it back short of a database restore.\r\n\r\nhttps://github.com/ansible/awx/blob/e23fb31a4a18c264e9509ba325ecf1372d60b87a/awx/settings/defaults.py#L809\r\n\r\nInstead of `None`, this should probably be \"id\", from a quick glance into hostvars.<sup>[citation needed]</sup>\r\n\r\nThis necessitates a migration. Instance IDs have never been applied to a previously-existing type to my knowledge.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bughancement Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nSince inventory updates now use the custom venv set at the organization level, we should fail more gracefully if the custom venv provided does not provide necessary elements such as `ansible-inventory` that did not exist in anisble 2.3 or prior versions.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* AWX install method: docker on linux\r\n* Ansible version:  custom venv using ansible 2.3\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nProvide a custom venv with ansible 2.3 or prior versions\r\nAttempt to run an inventory update\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nTell me that my ancient ansible version does not support inventory updates in tower\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n```\r\nstdout:\r\n    6.399 INFO     Updating inventory 239: Inventory - StaffSalary\\ufffd\r\n    6.438 INFO     Reading Ansible inventory source: /awx_devel/awx/plugins/inventory/openstack_inventory.py                                                                                                      \r\n    6.439 INFO     Using VIRTUAL_ENV: /venv/python2_ansible23/\r\n    6.439 INFO     Using PATH: /venv/python2_ansible23/bin:/venv/awx/bin:/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    6.439 INFO     Using PYTHONPATH: /venv/python2_ansible23/lib/python2.7/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx', 'console_scripts', 'awx-manage')()\r\n  File \"/awx_devel/awx/__init__.py\", line 150, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 1049, in handle\r\n    raise exc\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 949, in handle\r\n    data = AnsibleInventoryLoader(source=source, is_custom=self.is_custom, venv_path=venv_path).load()\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 194, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 171, in command_to_json\r\n    self.method, proc.returncode, raw_stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\n\r\nstderr:\r\nERROR! Ansible sub-program not implemented: ansible-inventory\r\n```\r\nWhich would be confusing if you did not understand the implementation details of how inventory updates work now that we use the organization level venv.\r\n\r\nInattentive users many not even realize that the selection of the venv on the org level would change behavior at the the inventory update layer, as this did not use to happen.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\naffects work on adoption of inventory plugins that @AlanCoding and @jladdjr are working on, but would happen in `devel` currently as well"},{"labels":["api",null],"text":"##### Feature request\r\n\r\nWe would like to request interactive workflows.\r\n\r\n Our company's workflow would be to run a playbook in check mode with the --diff long-switch to show operators what would change in the configuration. Once the job finished, we would like to prompt the operator an inputfield (eg. survey) where they can opt whether to continue or not. The operator reviews changes, and if selects continue, the same jobtemplate is run in run mode, to commit changes.\r\n\r\nThe interactivity beats scheduling, as it needs human interaction. Our idea is to have two types of workflows: interactive(non-schedulable) and non-interactive(schedulable). These properties would be mutually exclusive.\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - awx/main/models ?\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe would like to have interactive workflows for operators. The intention is the have breaks, more human control in automation.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe graph below shows a possible scenario: the operator gives the answer to the chooser playbook which fails/succeeds and the appropriate playbooks runs: commiting or interrupting.\r\n\r\n<pre>\r\n                                                         __________________________\r\n                                                        |                          |\r\n                                                        | Job template on success  |\r\n                                   prompt here         /|__________________________| \r\n _______      ___________________  |  ____________    / \r\n|       |    |                   | | |            |  /\r\n| Start |----| some job template |-+-| chooser.yml|-+\r\n|_______|    |___________________|   |____________|  \\\r\n                                                      \\  __________________________\r\n                                                       \\|                          |\r\n                                                        | Job template on interrupt|\r\n                                                        |__________________________|\r\n</pre>              \r\nThis is just an idea, any implementation is welcome."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\nbug report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nInventory sync does not work anymore\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 3.0.0.0\r\n* AWX install method: docker (geerlingguy/ansible-role-awx update from awx 2.1.0 to 3.0.0.0)\r\n* Ansible version: 2.7.6\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAttempt to resync inventory using oVirt source (ovirt4.py)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nsuccessful sync (green cloud)\r\n\r\n##### ACTUAL RESULTS\r\n\r\nfailed sync (red cloud)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n    1.571 INFO     Updating inventory 5: at_dc_ovirt_vm\r\n    1.589 DEBUG    Using base command: /usr/bin/ansible-inventory -i /var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/ovirt4.py\r\n    1.589 INFO     Reading Ansible inventory source: /var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/ovirt4.py\r\n    1.590 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/ansible\r\n    1.590 INFO     Using PATH: /var/lib/awx/venv/ansible/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    1.590 INFO     Using PYTHONPATH: /var/lib/awx/venv/ansible/lib/python2.7/site-packages:\r\n  171.737 DEBUG    Finished loading from source: /var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/ovirt4.py\r\n  171.737 INFO     Processing JSON output...\r\n  171.737 DEBUG    Loaded group: all\r\n  171.740 DEBUG    Loaded group: affinity_group_LB-10\r\n  171.741 DEBUG    Adding child group affinity_group_LB-10 to parent all\r\n  171.742 DEBUG    Loaded host: lb11\r\n  171.743 DEBUG    Adding host lb11 to group affinity_group_LB-10\r\n  171.745 DEBUG    Loaded host: lb12\r\n  171.745 DEBUG    Adding host lb12 to group affinity_group_LB-10\r\n  171.745 DEBUG    Adding child group affinity_group_LB-10 to parent all\r\n  171.745 DEBUG    Loaded group: affinity_group_LB-20\r\n  171.745 DEBUG    Adding child group affinity_group_LB-20 to parent all\r\n  171.746 DEBUG    Loaded host: lb21\r\n  171.746 DEBUG    Adding host lb21 to group affinity_group_LB-20\r\n  171.746 DEBUG    Loaded host: lb22\r\n  171.746 DEBUG    Adding host lb22 to group affinity_group_LB-20\r\n  171.746 DEBUG    Adding child group affinity_group_LB-20 to parent all\r\n  171.746 DEBUG    Loaded group: affinity_group_LB-30\r\n  171.746 DEBUG    Adding child group affinity_group_LB-30 to parent all\r\n  171.746 DEBUG    Loaded host: lb31\r\n  \r\n ----snip snip-----\r\n \r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 11, in <module>\r\n    load_entry_point('awx==3.0.0.0', 'console_scripts', 'awx-manage')()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 150, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1030, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 975, in handle\r\n    self.load_into_database()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 824, in load_into_database\r\n    self._delete_hosts()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 413, in _delete_hosts\r\n    instance_ids = all_instance_ids[offset:(offset + self._batch_size)]\r\nTypeError: 'dict_keys' object is not subscriptable\r\n```"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nRight now, custom venvs live in `/var/lib/awx/venv` alongside the system `awx` and `ansible` venvs.\r\n\r\nWhen building a deployment that has multiple custom venvs, you need to:\r\n- build them all into the container image\r\n- volume mount each one individually in `/var/lib/awx/venv` (presumably, haven not tested)\r\n\r\nIt may be useful to have a specific, configurable, location to search for custom venvs. In this case, a deployment could have a specific volume/mount that contains all of their venvs.\r\n\r\nComplication: the path-specific-ness of venvs may imply that the user's choice here affects how they build the venv. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nUI mentioned merely because if this is a setting, it would need exposed in settings."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n \r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n \r\n##### SUMMARY\r\nCSRF token errors causing users to log out and log back in. Duplicate of closed issue #2537. Reinstalled and reinitialized server from scratch, still having the same error using Github authentication. \r\n\r\nIt seems to only be happening when the site automatically logs you out.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.4\r\n* Operating System: OSX High Sierra\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n- Log into AWX\r\n- Navigate to any form with an associated POST action, EG a job template\r\n- Click the button to perform an API Post (click run)\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n- Action is performed (job is started) \r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n- Modal Window pops up stating that your CSRF token is missing or invalid \r\n- User logs out, clears the browser cache/cookies\r\n- User logs back in, everything works as expected\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThis started happening with the upgrade to 2.0.0, it didn't happen in the previous version we ran (1.0.3).\r\nThe database is from a former Tower installation, that was re-used for AWX.  \r\n\"Wiping the database and starting from scratch\" isn't an option.  \r\n\r\n<img width=\"601\" alt=\"screen shot 2018-10-26 at 10 20 34 am\" src=\"https://user-images.githubusercontent.com/3720321/47574533-cb18c300-d90d-11e8-99d9-059a34a8919a.png\">\r\n<img width=\"554\" alt=\"screen shot 2018-10-26 at 10 20 43 am\" src=\"https://user-images.githubusercontent.com/3720321/47574534-cb18c300-d90d-11e8-8714-8e89b0b51d3c.png\">"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nRequest for the schedule name variable when used in a workflow.  There is no 'tower_schedule_name' or 'workflow_schedule_name' variable that can be referenced when a workflow is launched by a schedule.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe Ansible openstack inventory script was renamed.\r\n\r\nThis is an outline of things that need to happen in order to avoid updating to the renamed script.\r\n\r\nThe inventory plugin will replace the script\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nOur current os-client-config dependency comes from the `shade` library. Both are needed for the current inventory script.\r\n\r\n`os-client-config==1.29.0`\r\n\r\nIf you dig, you will find that the `openstack` import was introduced going from `1.30.0` --> `1.31.0`\r\n\r\nhttps://github.com/openstack/os-client-config/commit/5c2eae8f8242332aff59d18b45a7d17f01524aaa\r\n\r\nIf that import is present, it conflicts with the _local_ file named `openstack.py`, and will break openstack inventory updates.\r\n\r\n```\r\n  File \"/awx_devel/awx/plugins/inventory/openstack.py\", line 66, in <module>\r\n    import os_client_config\r\n  File \"/venv/python2_ansible24/lib/python2.7/site-packages/os_client_config/__init__.py\", line 19, in <module>\r\n    from os_client_config import cloud_config\r\n  File \"/venv/python2_ansible24/lib/python2.7/site-packages/os_client_config/cloud_config.py\", line 17, in <module>\r\n    from openstack import _log\r\n  File \"/awx_devel/awx/plugins/inventory/openstack.py\", line 67, in <module>\r\n    import shade\r\n  File \"/venv/python2_ansible24/lib/python2.7/site-packages/shade/__init__.py\", line 24, in <module>\r\n    from shade.openstackcloud import OpenStackCloud\r\n  File \"/venv/python2_ansible24/lib/python2.7/site-packages/shade/openstackcloud.py\", line 24, in <module>\r\n    import os_client_config.defaults\r\n  File \"/venv/python2_ansible24/lib/python2.7/site-packages/os_client_config/defaults.py\", line 17, in <module>\r\n    from openstack.config import defaults\r\nImportError: No module named config\r\n```\r\n\r\nNote, if it had successfully imported, it could have been thrown in an infinite import loop.\r\n\r\nThis proposal is to pin as a top-level requirement\r\n\r\n`os-client-config<=1.30.0`\r\n\r\nThen we will have to deal with any patches needed for the script in a manual cherry-pick like process, if any such patches are needed.\r\n\r\nthe current script:\r\n\r\nhttps://github.com/ansible/ansible/blob/devel/contrib/inventory/openstack_inventory.py\r\n\r\nOur version, now diverging, of the script:\r\n\r\nhttps://github.com/ansible/awx/blob/devel/awx/plugins/inventory/openstack.py"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nI couldn't setup a project with using my custom inventory plugin. Can you please describe or document, how could I use custom inventory plugin. Using dynamic inventory script is simple and straightforward, but not inventory plugins.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nPushing job events into the database, in the callback receiver, is slow when a smart inventory is used. \r\n\r\n**Note:** Pushing events into rabbit is fast, pulling events from rabbit is fast. Events end up queued in run_callback_receiver subprocesses. It's nice to see that > 40k events can sit in our callback receiver waiting to be pushed into the database, no problem.\r\n\r\n##### ENVIRONMENT\r\n* Tower 3.4.1\r\n\r\n##### STEPS TO REPRODUCE\r\n* Create an inventory with at least 3,000 hosts\r\n* Create 60 smart inventories that matches a fraction of those hosts, say 300.\r\n* Run a playbook against any of the smart inventories.\r\n\r\n##### EXPECTED RESULTS\r\n* Shortly after ansible job finishes, stdout shows in the UI\r\n\r\n##### ACTUAL RESULTS\r\n* job events take a *long* time to be processed (> 500 ms per event). This is observable in the UI/API\r\n\r\n##### ADDITIONAL INFORMATION\r\n* Postgres queries taking =>~ 500 ms. Confirmed they are issued from callback receiver via strace.\r\n`SELECT \"main_host\".\"id\", \"main_host\".\"created\", \"main_host\".\"modified\", \"main_host\".\"description\", \"main_host\".\"created_by_id\", \"main_host\".\"modified_by_id\", \"main_host\".\"name\", \"main_host\".\"inventory_id\", \"main_host\".\"enabled\", \"main_host\".\"instance_id\", \"main_host\".\"variables\", \"main_host\".\"last_job_id\", \"main_host\".\"last_job_host_summary_id\", \"main_host\".\"has_active_failures\", \"main_host\".\"has_inventory_sources\", \"main_host\".\"ansible_facts\", \"main_host\".\"ansible_facts_modified\", \"main_host\".\"insights_system_id\" FROM \"main_host\" WHERE (\"main_host\".\"ansible_facts\" @> '{\"ansible_local\": {\"node\": {\"build\": \"beta\"}}}' AND \"main_host\".\"ansible_facts\" @> '{\"ansible_local\": {\"node\": {\"department\": \"engineering\"}}}') ORDER BY \"main_host\".\"name\" ASC`"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - The Insights tab in Tower doesn't use the proxy configuration set through AWX_TASK_ENV. Adding it to the supervisord.conf works. \r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWe need a general approach for proxy configuration in Tower. Currently adding it to the supervisord.conf works for UI elements of Tower like the Insights Tab.\r\n\r\nFor example:\r\n~~~\r\n[supervisord]\r\nenvironment=http_proxy=http://172.31.22.144:8080,HTTP_PROXY=http://172.31.22.144:8080,https_proxy=http://172.31.22.144:8080,HTTPS_PROXY=http://172.31.22.144:8080,no_proxy=127.0.0.1,NO_PROXY=127.0.0.1\r\n~~~\r\n\r\nAlso related #3072 #2818 \r\n\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nAWX should shows appropriate error message when using the SAML authentication.\r\nIf non-existent value passed to the SAML attribute like `attr_email`, `list index out of range` error shows on login page when the user login to the tower.\r\n\r\nThat error message is difficult to understand what is the cause of the issue, so it would be great if the AWX will shows `email address not found` or any appropriate error message.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIt would be great, if it would be possible to control displaying 'ok' task/host results in a task (`display_ok_hosts`).\r\n\r\nhttps://docs.ansible.com/ansible/latest/plugins/callback/counter_enabled.html"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n`NOTIFICATIONS` needs HTTP/HTTPS proxy settings for each notification type\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nFrom support team.\r\nCustomer wants to specify `http_proxy`, `https_proxy` and `no_proxy` settings from `NOTIFICATIONS > CREATE NOTIFICATION TEMPLATE` UI.  They use the proxy settings only for notification.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n##### SUMMARY\r\nI'm trying to use in AWX defined credentials in a git command within my playbooks. I thought there's a way to use an environment var for that.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2\r\n* AWX install method: openshift\r\n* Ansible version: 2.7.6\r\n* Operating System: RHEL 7\r\n* Web Browser: Latest Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n-\r\n\r\n##### EXPECTED RESULTS\r\n\r\n-\r\n\r\n##### ACTUAL RESULTS\r\n\r\n-\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n-\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n\r\n##### SUMMARY\r\nAWX sending internal server error when trying to create a smart inventory via API. \r\n\r\nUsing curl to update the API:\r\n`\r\ncurl -u user:password -ksXPOST https://host/api/v2/inventories/ -d @test -H \"Content-Type: application/json\"\r\n`\r\nwith below payload:\r\n`\r\n{\r\n\"name\": \"Nonprod15\",\r\n\"description\": \"Nonprod15\",\r\n\"organization\": 92,\r\n\"kind\": \"smart\",\r\n\"host_filter\": \"groups__name=nonprod15-(nonprod15-a-1)master\",\r\n\"variables\": \"\",\r\n\"insights_credential\": null\r\n}\r\n`\r\n\r\nGetting the error:\r\n`\r\n{\"host_filter\":[\"Invalid query groups__name=nonprod15-(nonprod15-a-1)master\"]}\r\n`\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0\r\n* Operating System: OSX\r\n* Web Browser: curl\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nTry to update the API as per description above\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected to create smart inventory as per definition\r\n\r\n##### ACTUAL RESULTS\r\n\r\nServer error with error mentioned in the description\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI can create smart inventory with any other groups that doesn't contain parentheses.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nCustomer are using Ansible Tower in multi-tenant env. Different teams are using tower and teams are doing some time mistakes and deleting some stuff which they don't want to.  They are reaching out to admins to see if they can restore those items. Is there a way to provide some kinds of recycle bin which is managed by admins only.  Anyone who deletes any kind of asset goes to recycle bin but can be restored by admins on demand.  There can be limits on number of days or items which can be stored in recycle bin.  But having this feature is a good management feature in multi-tenant env.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\nWith #3039 we have custom virtual environments working with inventory updates, but it is not eminently clear from the inventory update view what venv was used at the time.\r\n\r\nWe should add the venv detail to the inventory update view like it is available for jobs <insert example here>\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nProvide same info provided on jobs regarding environment used to execute inventory update\r\n\r\n##### ADDITIONAL INFORMATION\r\nWould help when diagnosing problems that are ansible version dependent (using plugin or script for inventory update?) like:\r\n\r\n```\r\n    6.772 INFO     Updating inventory 132: Inventory - PlayFeed孧\r\n    6.799 INFO     Reading Ansible inventory source: /tmp/awx_523_2casc_vc/gcp_compute.yml\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx', 'console_scripts', 'awx-manage')()\r\n  File \"/awx_devel/awx/__init__.py\", line 150, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 1021, in handle\r\n    raise exc\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 921, in handle\r\n    data = AnsibleInventoryLoader(source=source, is_custom=self.is_custom).load()\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 170, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/awx_devel/awx/main/management/commands/inventory_import.py\", line 153, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\n [WARNING]:  * Failed to parse /tmp/awx_523_2casc_vc/gcp_compute.yml with\r\ngcp_compute plugin: [{u'domain': u'global', u'message': u\"Invalid value for\r\nfield 'zone': 'all'. Unknown zone.\", u'reason': u'invalid'}]\r\n [WARNING]: Unable to parse /tmp/awx_523_2casc_vc/gcp_compute.yml as an\r\ninventory source\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n```\r\n"},{"labels":["api",null,null,null],"text":"AWX 3.0.0.\r\nRunning in Docker.\r\n\r\nTrying to create a custom venv:\r\n```\r\nyum -y install python36-devel gcc\r\npython3.6 -m venv /var/lib/awx/venv/my-custom-venv\r\nsource /var/lib/awx/venv/my-custom-venv/bin/activate\r\npip install docker python-memcached psutil ansible boto3 boto\r\n```\r\n\r\nRunning Inventory sync and gettting:\r\n```\r\n1.570 INFO     Updating inventory 3: roman cluster\r\n    1.584 INFO     Reading Ansible inventory source: /var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/ec2.py\r\n    1.586 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/my-custom-venv/\r\n    1.586 INFO     Using PATH: /var/lib/awx/venv/my-custom-venv/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    1.586 INFO     Using PYTHONPATH: /var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 11, in <module>\r\n    load_entry_point('awx==3.0.0.0', 'console_scripts', 'awx-manage')()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 150, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1030, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 930, in handle\r\n    data = AnsibleInventoryLoader(source=source, is_custom=self.is_custom, venv_path=venv_path).load()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 176, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 159, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/ansible-inventory\", line 67, in <module>\r\n    import ansible.constants as C\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/ansible/constants.py\", line 17, in <module>\r\n    from ansible.config.manager import ConfigManager, ensure_type, get_ini_config_value\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/ansible/config/manager.py\", line 16, in <module>\r\n    from yaml import load as yaml_load\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/yaml/__init__.py\", line 284\r\n    class YAMLObject(metaclass=YAMLObjectMetaclass):\r\n                              ^\r\nSyntaxError: invalid syntax\r\n```\r\n\r\nTrying to fix this manually by removing `metaclass=`.\r\nGetting another error:\r\n```\r\n  2.215 INFO     Updating inventory 3: roman cluster\r\n    2.237 INFO     Reading Ansible inventory source: /var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/plugins/inventory/ec2.py\r\n    2.238 INFO     Using VIRTUAL_ENV: /var/lib/awx/venv/my-custom-venv/\r\n    2.238 INFO     Using PATH: /var/lib/awx/venv/my-custom-venv/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/var/lib/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n    2.238 INFO     Using PYTHONPATH: /var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages:\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/bin/awx-manage\", line 11, in <module>\r\n    load_entry_point('awx==3.0.0.0', 'console_scripts', 'awx-manage')()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/__init__.py\", line 150, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 1030, in handle\r\n    raise exc\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 930, in handle\r\n    data = AnsibleInventoryLoader(source=source, is_custom=self.is_custom, venv_path=venv_path).load()\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 176, in load\r\n    return self.command_to_json(base_args + ['--list'])\r\n  File \"/var/lib/awx/venv/awx/lib64/python3.6/site-packages/awx/main/management/commands/inventory_import.py\", line 159, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/ansible-inventory\", line 67, in <module>\r\n    import ansible.constants as C\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/ansible/constants.py\", line 17, in <module>\r\n    from ansible.config.manager import ConfigManager, ensure_type, get_ini_config_value\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/ansible/config/manager.py\", line 16, in <module>\r\n    from yaml import load as yaml_load\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/yaml/__init__.py\", line 8, in <module>\r\n    from .loader import *\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/yaml/loader.py\", line 4, in <module>\r\n    from .reader import *\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/yaml/reader.py\", line 45, in <module>\r\n    class Reader(object):\r\n  File \"/var/lib/awx/venv/my-custom-venv/lib/python3.6/site-packages/yaml/reader.py\", line 137, in Reader\r\n    NON_PRINTABLE = re.compile('[^\\x09\\x0A\\x0D\\x20-\\x7E\\x85\\xA0-\\uD7FF\\uE000-\\uFFFD]')\r\n  File \"/usr/lib64/python2.7/re.py\", line 190, in compile\r\n    return _compile(pattern, flags)\r\n  File \"/usr/lib64/python2.7/re.py\", line 242, in _compile\r\n    raise error, v # invalid expression\r\nsre_constants.error: bad character range\r\n```\r\n\r\nFor some reason it takes 2.7 file while using 3.6 venv. Checked venv itself, it correctly imports \"re\" from the right file but AWX is messing with libs.\r\n\r\nThanks,\r\nRoman"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWith https://github.com/ansible/awx/pull/3039 we have custom virtual environments working with inventory updates.\r\n\r\nHowever, this only uses the related inventory's organization's custom virtualenvironment. We should consider implementing sourcing from:\r\n\r\n - [definitely] SCM inventory source's `source_project`\r\n - [unsure] a field on inventory sources itself\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCurrently, if you have two jobs in a Workflow converging in one with RUN condition \"On success\", Tower runs the job if one of the previous one finishes successfully and not if both finish successfully. It would be great if you could set a RUN condition like \"Run this convergent job just if these previous jobs finish successfully\".\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWorkflow example: \r\n![wfjt](https://user-images.githubusercontent.com/33290633/51599678-85fe3000-1f00-11e9-93a4-9432a6b38bf5.png)\r\n\r\nIn the example provided, \"Job Template 1\" and \"Job Template 2\" are set  with RUN condition \"On success\", but Tower runs \"Job Tempate 3\" if one of the previous jobs finishes successfully and not if both finish successfully."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n- UI\r\n\r\n##### SUMMARY\r\nI used command ansible-playbook to run a job succcessfully,but it can't be successful by used awx.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.5\r\n* Operating System:  CentOS7.2\r\n* Web Browser:  chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nI installed awx for test,then created a project directory and a file main.yml:\r\n---\r\n- hosts: all\r\n  gather_facts: no\r\n \r\n  tasks:\r\n  - name: Check the date on the server.\r\n    command: date\r\n  - name: Check the ip on the server.\r\n    command: ifconfig\r\nThen I used this file to created a template in AWX web.Like this:\r\n![image](https://user-images.githubusercontent.com/33978065/51468944-10cd1680-1dab-11e9-8f63-6b5b033f0851.png)\r\n\r\nAnd I run it.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expected that it would return the result that the command exec.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nActually,it return a failed result.these are details:\r\n\r\n```\r\nansible-playbook 2.7.4\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Oct 30 2018, 23:45:53) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nSSH password: \r\nsetting up inventory plugins\r\n/tmp/awx_11_0ZOCpN/tmp9Jfyfi did not meet host_list requirements, check plugin documentation if this is unexpected\r\nParsed /tmp/awx_11_0ZOCpN/tmp9Jfyfi inventory source with script plugin\r\nLoading callback plugin awx_display of type stdout, v2.0 from /usr/lib/python2.7/site-packages/awx/lib/awx_display_callback/module.pyc\r\n\r\nPLAYBOOK: main.yml *************************************************************\r\n1 plays in main.yml\r\n\r\nPLAY [all] *********************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [Check the date on the server.] *******************************************\r\ntask path: /var/lib/awx/projects/test-project/main.yml:6\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.16.4.130> SSH: EXEC sshpass -d10 ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o User=root -o ConnectTimeout=10 -o ControlPath=/tmp/awx_11_0ZOCpN/cp/d49a596a85 172.16.4.130 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: root\r\n<172.16.4.129> SSH: EXEC sshpass -d12 ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o User=root -o ConnectTimeout=10 -o ControlPath=/tmp/awx_11_0ZOCpN/cp/3b50fdc1e0 172.16.4.129 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<172.16.4.130> (255, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug1: Control socket \"/tmp/awx_11_0ZOCpN/cp/d49a596a85\" does not exist\r\ndebug2: resolving \"172.16.4.130\" port 22\r\ndebug2: ssh_connect_direct: needpriv 0\r\ndebug1: Connecting to 172.16.4.130 [172.16.4.130] port 22.\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: fd 3 clearing O_NONBLOCK\r\ndebug1: Connection established.\r\ndebug3: timeout: 9996 ms remain after connect\r\ndebug1: permanently_set_uid: 0/0\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519 type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\r\ndebug1: Enabling compatibility mode for protocol 2.0\r\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\r\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_6.2\r\ndebug1: match: OpenSSH_6.2 pat OpenSSH* compat 0x04000000\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: Authenticating to 172.16.4.130:22 as \\\\'root\\\\'\r\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.130\r\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\r\ndebug3: send packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT sent\r\ndebug3: receive packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT received\r\ndebug2: local client KEXINIT proposal\r\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\r\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\r\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: compression ctos: zlib@openssh.com,zlib,none\r\ndebug2: compression stoc: zlib@openssh.com,zlib,none\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug2: peer server KEXINIT proposal\r\ndebug2: KEX algorithms: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\r\ndebug2: host key algorithms: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256\r\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: MACs ctos: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: MACs stoc: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: compression ctos: none,zlib@openssh.com\r\ndebug2: compression stoc: none,zlib@openssh.com\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug1: kex: algorithm: ecdh-sha2-nistp256\r\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\r\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug3: send packet: type 30\r\ndebug1: sending SSH2_MSG_KEX_ECDH_INIT\r\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\r\ndebug3: receive packet: type 31\r\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:ea4rLTu1cR1Mmsc94B1EomwEW+2v2KC+o4mYZderk9g\r\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.130\r\ndebug1: Host \\\\'172.16.4.130\\\\' is known and matches the ECDSA host key.\r\ndebug1: Found key in /root/.ssh/known_hosts:1\r\ndebug3: send packet: type 21\r\ndebug2: set_newkeys: mode 1\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: SSH2_MSG_NEWKEYS sent\r\ndebug1: expecting SSH2_MSG_NEWKEYS\r\ndebug3: receive packet: type 21\r\ndebug1: SSH2_MSG_NEWKEYS received\r\ndebug2: set_newkeys: mode 0\r\ndebug1: rekey after 4294967296 blocks\r\ndebug2: key: /root/.ssh/id_rsa ((nil))\r\ndebug2: key: /root/.ssh/id_dsa ((nil))\r\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\r\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\r\ndebug3: send packet: type 5\r\ndebug3: receive packet: type 6\r\ndebug2: service_accept: ssh-userauth\r\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 51\r\ndebug1: Authentications that can continue: publickey,password,keyboard-interactive\r\ndebug3: start over, passed a different list publickey,password,keyboard-interactive\r\ndebug3: preferred gssapi-keyex,gssapi-with-mic,publickey,keyboard-interactive,password\r\ndebug3: authmethod_lookup publickey\r\ndebug3: remaining preferred: keyboard-interactive,password\r\ndebug3: authmethod_is_enabled publickey\r\ndebug1: Next authentication method: publickey\r\ndebug1: Trying private key: /root/.ssh/id_rsa\r\ndebug3: no such identity: /root/.ssh/id_rsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_dsa\r\ndebug3: no such identity: /root/.ssh/id_dsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_ecdsa\r\ndebug3: no such identity: /root/.ssh/id_ecdsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_ed25519\r\ndebug3: no such identity: /root/.ssh/id_ed25519: No such file or directory\r\ndebug2: we did not send a packet, disable method\r\ndebug3: authmethod_lookup keyboard-interactive\r\ndebug3: remaining preferred: password\r\ndebug3: authmethod_is_enabled keyboard-interactive\r\ndebug1: Next authentication method: keyboard-interactive\r\ndebug2: userauth_kbdint\r\ndebug3: send packet: type 50\r\ndebug2: we sent a keyboard-interactive packet, wait for reply\r\ndebug3: receive packet: type 60\r\ndebug2: input_userauth_info_req\r\ndebug2: input_userauth_info_req: num_prompts 1\r\ndebug3: send packet: type 61\r\ndebug3: receive packet: type 60\r\ndebug2: input_userauth_info_req\r\ndebug2: input_userauth_info_req: num_prompts 0\r\ndebug3: send packet: type 61\r\ndebug3: receive packet: type 52\r\ndebug1: Enabling compression at level 6.\r\ndebug1: Authentication succeeded (keyboard-interactive).\r\nAuthenticated to 172.16.4.130 ([172.16.4.130]:22).\r\ndebug1: setting up multiplex master socket\r\ndebug3: muxserver_listen: temporary control path /tmp/awx_11_0ZOCpN/cp/d49a596a85.jWwwhywCYwCvYDFZ\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug1: channel 0: new [/tmp/awx_11_0ZOCpN/cp/d49a596a85]\r\ndebug3: muxserver_listen: mux listener channel 0 fd 4\r\ndebug2: fd 3 setting TCP_NODELAY\r\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\r\ndebug1: control_persist_detach: backgrounding master process\r\ndebug2: control_persist_detach: background process is 606\r\nControl socket connect(/tmp/awx_11_0ZOCpN/cp/d49a596a85): Connection refused\r\nFailed to connect to new control master\r\ndebug1: forking to background\r\ndebug1: Entering interactive session.\r\ndebug1: pledge: id\r\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\r\n')\r\nfatal: [172.16.4.130]: UNREACHABLE! => {\r\n    \"changed\": false, \r\n    \"msg\": \"Failed to connect to the host via ssh: OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug1: Control socket \\\\\"/tmp/awx_11_0ZOCpN/cp/d49a596a85\\\\\" does not exist\r\ndebug2: resolving \\\\\"172.16.4.130\\\\\" port 22\r\ndebug2: ssh_connect_direct: needpriv 0\r\ndebug1: Connecting to 172.16.4.130 [172.16.4.130] port 22.\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: fd 3 clearing O_NONBLOCK\r\ndebug1: Connection established.\r\ndebug3: timeout: 9996 ms remain after connect\r\ndebug1: permanently_set_uid: 0/0\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519 type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\r\ndebug1: Enabling compatibility mode for protocol 2.0\r\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\r\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_6.2\r\ndebug1: match: OpenSSH_6.2 pat OpenSSH* compat 0x04000000\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: Authenticating to 172.16.4.130:22 as 'root'\r\ndebug3: hostkeys_foreach: reading file \\\\\"/root/.ssh/known_hosts\\\\\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.130\r\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\r\ndebug3: send packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT sent\r\ndebug3: receive packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT received\r\ndebug2: local client KEXINIT proposal\r\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\r\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\r\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: compression ctos: zlib@openssh.com,zlib,none\r\ndebug2: compression stoc: zlib@openssh.com,zlib,none\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug2: peer server KEXINIT proposal\r\ndebug2: KEX algorithms: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\r\ndebug2: host key algorithms: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256\r\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: MACs ctos: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: MACs stoc: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: compression ctos: none,zlib@openssh.com\r\ndebug2: compression stoc: none,zlib@openssh.com\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug1: kex: algorithm: ecdh-sha2-nistp256\r\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\r\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug3: send packet: type 30\r\ndebug1: sending SSH2_MSG_KEX_ECDH_INIT\r\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\r\ndebug3: receive packet: type 31\r\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:ea4rLTu1cR1Mmsc94B1EomwEW+2v2KC+o4mYZderk9g\r\ndebug3: hostkeys_foreach: reading file \\\\\"/root/.ssh/known_hosts\\\\\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.130\r\ndebug1: Host '172.16.4.130' is known and matches the ECDSA host key.\r\ndebug1: Found key in /root/.ssh/known_hosts:1\r\ndebug3: send packet: type 21\r\ndebug2: set_newkeys: mode 1\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: SSH2_MSG_NEWKEYS sent\r\ndebug1: expecting SSH2_MSG_NEWKEYS\r\ndebug3: receive packet: type 21\r\ndebug1: SSH2_MSG_NEWKEYS received\r\ndebug2: set_newkeys: mode 0\r\ndebug1: rekey after 4294967296 blocks\r\ndebug2: key: /root/.ssh/id_rsa ((nil))\r\ndebug2: key: /root/.ssh/id_dsa ((nil))\r\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\r\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\r\ndebug3: send packet: type 5\r\ndebug3: receive packet: type 6\r\ndebug2: service_accept: ssh-userauth\r\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 51\r\ndebug1: Authentications that can continue: publickey,password,keyboard-interactive\r\ndebug3: start over, passed a different list publickey,password,keyboard-interactive\r\ndebug3: preferred gssapi-keyex,gssapi-with-mic,publickey,keyboard-interactive,password\r\ndebug3: authmethod_lookup publickey\r\ndebug3: remaining preferred: keyboard-interactive,password\r\ndebug3: authmethod_is_enabled publickey\r\ndebug1: Next authentication method: publickey\r\ndebug1: Trying private key: /root/.ssh/id_rsa\r\ndebug3: no such identity: /root/.ssh/id_rsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_dsa\r\ndebug3: no such identity: /root/.ssh/id_dsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_ecdsa\r\ndebug3: no such identity: /root/.ssh/id_ecdsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_ed25519\r\ndebug3: no such identity: /root/.ssh/id_ed25519: No such file or directory\r\ndebug2: we did not send a packet, disable method\r\ndebug3: authmethod_lookup keyboard-interactive\r\ndebug3: remaining preferred: password\r\ndebug3: authmethod_is_enabled keyboard-interactive\r\ndebug1: Next authentication method: keyboard-interactive\r\ndebug2: userauth_kbdint\r\ndebug3: send packet: type 50\r\ndebug2: we sent a keyboard-interactive packet, wait for reply\r\ndebug3: receive packet: type 60\r\ndebug2: input_userauth_info_req\r\ndebug2: input_userauth_info_req: num_prompts 1\r\ndebug3: send packet: type 61\r\ndebug3: receive packet: type 60\r\ndebug2: input_userauth_info_req\r\ndebug2: input_userauth_info_req: num_prompts 0\r\ndebug3: send packet: type 61\r\ndebug3: receive packet: type 52\r\ndebug1: Enabling compression at level 6.\r\ndebug1: Authentication succeeded (keyboard-interactive).\r\nAuthenticated to 172.16.4.130 ([172.16.4.130]:22).\r\ndebug1: setting up multiplex master socket\r\ndebug3: muxserver_listen: temporary control path /tmp/awx_11_0ZOCpN/cp/d49a596a85.jWwwhywCYwCvYDFZ\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug1: channel 0: new [/tmp/awx_11_0ZOCpN/cp/d49a596a85]\r\ndebug3: muxserver_listen: mux listener channel 0 fd 4\r\ndebug2: fd 3 setting TCP_NODELAY\r\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\r\ndebug1: control_persist_detach: backgrounding master process\r\ndebug2: control_persist_detach: background process is 606\r\nControl socket connect(/tmp/awx_11_0ZOCpN/cp/d49a596a85): Connection refused\r\nFailed to connect to new control master\r\ndebug1: forking to background\r\ndebug1: Entering interactive session.\r\ndebug1: pledge: id\r\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\r\n\", \r\n    \"unreachable\": true\r\n}\r\n<172.16.4.129> (255, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug1: Control socket \"/tmp/awx_11_0ZOCpN/cp/3b50fdc1e0\" does not exist\r\ndebug2: resolving \"172.16.4.129\" port 22\r\ndebug2: ssh_connect_direct: needpriv 0\r\ndebug1: Connecting to 172.16.4.129 [172.16.4.129] port 22.\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: fd 3 clearing O_NONBLOCK\r\ndebug1: Connection established.\r\ndebug3: timeout: 9997 ms remain after connect\r\ndebug1: permanently_set_uid: 0/0\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519 type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\r\ndebug1: Enabling compatibility mode for protocol 2.0\r\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\r\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_6.2\r\ndebug1: match: OpenSSH_6.2 pat OpenSSH* compat 0x04000000\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: Authenticating to 172.16.4.129:22 as \\\\'root\\\\'\r\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:2\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.129\r\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\r\ndebug3: send packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT sent\r\ndebug3: receive packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT received\r\ndebug2: local client KEXINIT proposal\r\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\r\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\r\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: compression ctos: zlib@openssh.com,zlib,none\r\ndebug2: compression stoc: zlib@openssh.com,zlib,none\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug2: peer server KEXINIT proposal\r\ndebug2: KEX algorithms: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\r\ndebug2: host key algorithms: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256\r\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: MACs ctos: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: MACs stoc: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: compression ctos: none,zlib@openssh.com\r\ndebug2: compression stoc: none,zlib@openssh.com\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug1: kex: algorithm: ecdh-sha2-nistp256\r\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\r\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug3: send packet: type 30\r\ndebug1: sending SSH2_MSG_KEX_ECDH_INIT\r\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\r\ndebug3: receive packet: type 31\r\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:q7XwShpHt5sGBtWrDPUPgES0hRq7jKwkTe11HehQJ4g\r\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:2\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.129\r\ndebug1: Host \\\\'172.16.4.129\\\\' is known and matches the ECDSA host key.\r\ndebug1: Found key in /root/.ssh/known_hosts:2\r\ndebug3: send packet: type 21\r\ndebug2: set_newkeys: mode 1\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: SSH2_MSG_NEWKEYS sent\r\ndebug1: expecting SSH2_MSG_NEWKEYS\r\ndebug3: receive packet: type 21\r\ndebug1: SSH2_MSG_NEWKEYS received\r\ndebug2: set_newkeys: mode 0\r\ndebug1: rekey after 4294967296 blocks\r\ndebug2: key: /root/.ssh/id_rsa ((nil))\r\ndebug2: key: /root/.ssh/id_dsa ((nil))\r\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\r\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\r\ndebug3: send packet: type 5\r\ndebug3: receive packet: type 6\r\ndebug2: service_accept: ssh-userauth\r\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 51\r\ndebug1: Authentications that can continue: publickey,keyboard-interactive\r\ndebug3: start over, passed a different list publickey,keyboard-interactive\r\ndebug3: preferred gssapi-keyex,gssapi-with-mic,publickey,keyboard-interactive,password\r\ndebug3: authmethod_lookup publickey\r\ndebug3: remaining preferred: keyboard-interactive,password\r\ndebug3: authmethod_is_enabled publickey\r\ndebug1: Next authentication method: publickey\r\ndebug1: Trying private key: /root/.ssh/id_rsa\r\ndebug3: no such identity: /root/.ssh/id_rsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_dsa\r\ndebug3: no such identity: /root/.ssh/id_dsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_ecdsa\r\ndebug3: no such identity: /root/.ssh/id_ecdsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_ed25519\r\ndebug3: no such identity: /root/.ssh/id_ed25519: No such file or directory\r\ndebug2: we did not send a packet, disable method\r\ndebug3: authmethod_lookup keyboard-interactive\r\ndebug3: remaining preferred: password\r\ndebug3: authmethod_is_enabled keyboard-interactive\r\ndebug1: Next authentication method: keyboard-interactive\r\ndebug2: userauth_kbdint\r\ndebug3: send packet: type 50\r\ndebug2: we sent a keyboard-interactive packet, wait for reply\r\ndebug3: receive packet: type 60\r\ndebug2: input_userauth_info_req\r\ndebug2: input_userauth_info_req: num_prompts 1\r\ndebug3: send packet: type 61\r\ndebug3: receive packet: type 60\r\ndebug2: input_userauth_info_req\r\ndebug2: input_userauth_info_req: num_prompts 0\r\ndebug3: send packet: type 61\r\ndebug3: receive packet: type 52\r\ndebug1: Enabling compression at level 6.\r\ndebug1: Authentication succeeded (keyboard-interactive).\r\nAuthenticated to 172.16.4.129 ([172.16.4.129]:22).\r\ndebug1: setting up multiplex master socket\r\ndebug3: muxserver_listen: temporary control path /tmp/awx_11_0ZOCpN/cp/3b50fdc1e0.7axh67xKjZjstbSs\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug1: channel 0: new [/tmp/awx_11_0ZOCpN/cp/3b50fdc1e0]\r\ndebug3: muxserver_listen: mux listener channel 0 fd 4\r\ndebug2: fd 3 setting TCP_NODELAY\r\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\r\ndebug1: control_persist_detach: backgrounding master process\r\ndebug2: control_persist_detach: background process is 610\r\nControl socket connect(/tmp/awx_11_0ZOCpN/cp/3b50fdc1e0): Connection refused\r\nFailed to connect to new control master\r\ndebug1: forking to background\r\ndebug1: Entering interactive session.\r\ndebug1: pledge: id\r\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\r\n')\r\nfatal: [172.16.4.129]: UNREACHABLE! => {\r\n    \"changed\": false, \r\n    \"msg\": \"Failed to connect to the host via ssh: OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug1: Control socket \\\\\"/tmp/awx_11_0ZOCpN/cp/3b50fdc1e0\\\\\" does not exist\r\ndebug2: resolving \\\\\"172.16.4.129\\\\\" port 22\r\ndebug2: ssh_connect_direct: needpriv 0\r\ndebug1: Connecting to 172.16.4.129 [172.16.4.129] port 22.\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: fd 3 clearing O_NONBLOCK\r\ndebug1: Connection established.\r\ndebug3: timeout: 9997 ms remain after connect\r\ndebug1: permanently_set_uid: 0/0\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519 type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\r\ndebug1: Enabling compatibility mode for protocol 2.0\r\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\r\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_6.2\r\ndebug1: match: OpenSSH_6.2 pat OpenSSH* compat 0x04000000\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: Authenticating to 172.16.4.129:22 as 'root'\r\ndebug3: hostkeys_foreach: reading file \\\\\"/root/.ssh/known_hosts\\\\\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:2\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.129\r\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\r\ndebug3: send packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT sent\r\ndebug3: receive packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT received\r\ndebug2: local client KEXINIT proposal\r\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\r\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\r\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: compression ctos: zlib@openssh.com,zlib,none\r\ndebug2: compression stoc: zlib@openssh.com,zlib,none\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug2: peer server KEXINIT proposal\r\ndebug2: KEX algorithms: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\r\ndebug2: host key algorithms: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256\r\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: MACs ctos: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: MACs stoc: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: compression ctos: none,zlib@openssh.com\r\ndebug2: compression stoc: none,zlib@openssh.com\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug1: kex: algorithm: ecdh-sha2-nistp256\r\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\r\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug3: send packet: type 30\r\ndebug1: sending SSH2_MSG_KEX_ECDH_INIT\r\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\r\ndebug3: receive packet: type 31\r\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:q7XwShpHt5sGBtWrDPUPgES0hRq7jKwkTe11HehQJ4g\r\ndebug3: hostkeys_foreach: reading file \\\\\"/root/.ssh/known_hosts\\\\\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:2\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.129\r\ndebug1: Host '172.16.4.129' is known and matches the ECDSA host key.\r\ndebug1: Found key in /root/.ssh/known_hosts:2\r\ndebug3: send packet: type 21\r\ndebug2: set_newkeys: mode 1\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: SSH2_MSG_NEWKEYS sent\r\ndebug1: expecting SSH2_MSG_NEWKEYS\r\ndebug3: receive packet: type 21\r\ndebug1: SSH2_MSG_NEWKEYS received\r\ndebug2: set_newkeys: mode 0\r\ndebug1: rekey after 4294967296 blocks\r\ndebug2: key: /root/.ssh/id_rsa ((nil))\r\ndebug2: key: /root/.ssh/id_dsa ((nil))\r\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\r\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\r\ndebug3: send packet: type 5\r\ndebug3: receive packet: type 6\r\ndebug2: service_accept: ssh-userauth\r\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 51\r\ndebug1: Authentications that can continue: publickey,keyboard-interactive\r\ndebug3: start over, passed a different list publickey,keyboard-interactive\r\ndebug3: preferred gssapi-keyex,gssapi-with-mic,publickey,keyboard-interactive,password\r\ndebug3: authmethod_lookup publickey\r\ndebug3: remaining preferred: keyboard-interactive,password\r\ndebug3: authmethod_is_enabled publickey\r\ndebug1: Next authentication method: publickey\r\ndebug1: Trying private key: /root/.ssh/id_rsa\r\ndebug3: no such identity: /root/.ssh/id_rsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_dsa\r\ndebug3: no such identity: /root/.ssh/id_dsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_ecdsa\r\ndebug3: no such identity: /root/.ssh/id_ecdsa: No such file or directory\r\ndebug1: Trying private key: /root/.ssh/id_ed25519\r\ndebug3: no such identity: /root/.ssh/id_ed25519: No such file or directory\r\ndebug2: we did not send a packet, disable method\r\ndebug3: authmethod_lookup keyboard-interactive\r\ndebug3: remaining preferred: password\r\ndebug3: authmethod_is_enabled keyboard-interactive\r\ndebug1: Next authentication method: keyboard-interactive\r\ndebug2: userauth_kbdint\r\ndebug3: send packet: type 50\r\ndebug2: we sent a keyboard-interactive packet, wait for reply\r\ndebug3: receive packet: type 60\r\ndebug2: input_userauth_info_req\r\ndebug2: input_userauth_info_req: num_prompts 1\r\ndebug3: send packet: type 61\r\ndebug3: receive packet: type 60\r\ndebug2: input_userauth_info_req\r\ndebug2: input_userauth_info_req: num_prompts 0\r\ndebug3: send packet: type 61\r\ndebug3: receive packet: type 52\r\ndebug1: Enabling compression at level 6.\r\ndebug1: Authentication succeeded (keyboard-interactive).\r\nAuthenticated to 172.16.4.129 ([172.16.4.129]:22).\r\ndebug1: setting up multiplex master socket\r\ndebug3: muxserver_listen: temporary control path /tmp/awx_11_0ZOCpN/cp/3b50fdc1e0.7axh67xKjZjstbSs\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug1: channel 0: new [/tmp/awx_11_0ZOCpN/cp/3b50fdc1e0]\r\ndebug3: muxserver_listen: mux listener channel 0 fd 4\r\ndebug2: fd 3 setting TCP_NODELAY\r\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\r\ndebug1: control_persist_detach: backgrounding master process\r\ndebug2: control_persist_detach: background process is 610\r\nControl socket connect(/tmp/awx_11_0ZOCpN/cp/3b50fdc1e0): Connection refused\r\nFailed to connect to new control master\r\ndebug1: forking to background\r\ndebug1: Entering interactive session.\r\ndebug1: pledge: id\r\ndebug2: set_control_persist_exit_time: schedule exit in 60 seconds\r\n\", \r\n    \"unreachable\": true\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\n172.16.4.129               : ok=0    changed=0    unreachable=1    failed=0   \r\n172.16.4.130               : ok=0    changed=0    unreachable=1    failed=0   \r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nBut I can run it by use command \"ansible-playbook /var/lib/awx/projects/test-project/main.yml -vvvv\r\n\"\r\nthat's the result:\r\n\r\nansible-playbook 2.7.5\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Oct 30 2018, 23:45:53) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\n/etc/ansible/hosts did not meet host_list requirements, check plugin documentation if this is unexpected\r\n/etc/ansible/hosts did not meet script requirements, check plugin documentation if this is unexpected\r\nParsed /etc/ansible/hosts inventory source with ini plugin\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python2.7/site-packages/ansible/plugins/callback/default.pyc\r\n\r\nPLAYBOOK: main.yml *************************************************************\r\n1 plays in /var/lib/awx/projects/test-project/main.yml\r\n\r\nPLAY [all] *********************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [Check the date on the server.] *******************************************\r\ntask path: /var/lib/awx/projects/test-project/main.yml:6\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.129 '/bin/sh -c '\"'\"'echo ~ && sleep 0'\"'\"''\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.130 '/bin/sh -c '\"'\"'echo ~ && sleep 0'\"'\"''\r\n<172.16.4.129> (0, '/root\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug1: Control socket \"/dev/shm/172.16.4.129-root\" does not exist\r\ndebug2: resolving \"172.16.4.129\" port 22\r\ndebug2: ssh_connect_direct: needpriv 0\r\ndebug1: Connecting to 172.16.4.129 [172.16.4.129] port 22.\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: fd 3 clearing O_NONBLOCK\r\ndebug1: Connection established.\r\ndebug3: timeout: 9990 ms remain after connect\r\ndebug1: permanently_set_uid: 0/0\r\ndebug1: identity file /root/.ssh/id_rsa type 1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519 type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\r\ndebug1: Enabling compatibility mode for protocol 2.0\r\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\r\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_6.2\r\ndebug1: match: OpenSSH_6.2 pat OpenSSH* compat 0x04000000\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: Authenticating to 172.16.4.129:22 as \\'root\\'\r\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.129\r\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\r\ndebug3: send packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT sent\r\ndebug3: receive packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT received\r\ndebug2: local client KEXINIT proposal\r\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\r\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\r\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: compression ctos: zlib@openssh.com,zlib,none\r\ndebug2: compression stoc: zlib@openssh.com,zlib,none\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug2: peer server KEXINIT proposal\r\ndebug2: KEX algorithms: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\r\ndebug2: host key algorithms: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256\r\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: MACs ctos: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: MACs stoc: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: compression ctos: none,zlib@openssh.com\r\ndebug2: compression stoc: none,zlib@openssh.com\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug1: kex: algorithm: ecdh-sha2-nistp256\r\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\r\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug3: send packet: type 30\r\ndebug1: sending SSH2_MSG_KEX_ECDH_INIT\r\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\r\ndebug3: receive packet: type 31\r\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:q7XwShpHt5sGBtWrDPUPgES0hRq7jKwkTe11HehQJ4g\r\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.129\r\ndebug1: Host \\'172.16.4.129\\' is known and matches the ECDSA host key.\r\ndebug1: Found key in /root/.ssh/known_hosts:1\r\ndebug3: send packet: type 21\r\ndebug2: set_newkeys: mode 1\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: SSH2_MSG_NEWKEYS sent\r\ndebug1: expecting SSH2_MSG_NEWKEYS\r\ndebug3: receive packet: type 21\r\ndebug1: SSH2_MSG_NEWKEYS received\r\ndebug2: set_newkeys: mode 0\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: pubkey_prepare: ssh_get_authentication_socket: No such file or directory\r\ndebug2: key: /root/.ssh/id_rsa (0x7f37b977e490)\r\ndebug2: key: /root/.ssh/id_dsa ((nil))\r\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\r\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\r\ndebug3: send packet: type 5\r\ndebug3: receive packet: type 6\r\ndebug2: service_accept: ssh-userauth\r\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 51\r\ndebug1: Authentications that can continue: publickey,keyboard-interactive\r\ndebug3: start over, passed a different list publickey,keyboard-interactive\r\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\r\ndebug3: authmethod_lookup publickey\r\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\r\ndebug3: authmethod_is_enabled publickey\r\ndebug1: Next authentication method: publickey\r\ndebug1: Offering RSA public key: /root/.ssh/id_rsa\r\ndebug3: send_pubkey_test\r\ndebug3: send packet: type 50\r\ndebug2: we sent a publickey packet, wait for reply\r\ndebug3: receive packet: type 60\r\ndebug1: Server accepts key: pkalg ssh-rsa blen 279\r\ndebug2: input_userauth_pk_ok: fp SHA256:LYCw+4D/hw0RLGD0BGCR4osgkfri9+Mni+fqXlqR8V4\r\ndebug3: sign_and_send_pubkey: RSA SHA256:LYCw+4D/hw0RLGD0BGCR4osgkfri9+Mni+fqXlqR8V4\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 52\r\ndebug1: Enabling compression at level 6.\r\ndebug1: Authentication succeeded (publickey).\r\nAuthenticated to 172.16.4.129 ([172.16.4.129]:22).\r\ndebug1: setting up multiplex master socket\r\ndebug3: muxserver_listen: temporary control path /dev/shm/172.16.4.129-root.CfL8MkXMBH9wo4rT\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug1: channel 0: new [/dev/shm/172.16.4.129-root]\r\ndebug3: muxserver_listen: mux listener channel 0 fd 4\r\ndebug2: fd 3 setting TCP_NODELAY\r\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\r\ndebug1: control_persist_detach: backgrounding master process\r\ndebug2: control_persist_detach: background process is 74754\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug1: forking to background\r\ndebug1: Entering interactive session.\r\ndebug1: pledge: id\r\ndebug2: set_control_persist_exit_time: schedule exit in 1800 seconds\r\ndebug1: multiplexing control connection\r\ndebug2: fd 5 setting O_NONBLOCK\r\ndebug3: fd 5 is O_NONBLOCK\r\ndebug1: channel 1: new [mux-control]\r\ndebug3: channel_post_mux_listener: new mux channel 1 fd 5\r\ndebug3: mux_master_read_cb: channel 1: hello sent\r\ndebug2: set_control_persist_exit_time: cancel scheduled exit\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\r\ndebug2: process_mux_master_hello: channel 1 slave version 4\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\r\ndebug2: process_mux_alive_check: channel 1: alive check\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 123\r\ndebug2: process_mux_new_session: channel 1: request tty 0, X 0, agent 0, subsys 0, term \"xterm-256color\", cmd \"/bin/sh -c \\'echo ~ && sleep 0\\'\", env 2\r\ndebug3: process_mux_new_session: got fds stdin 6, stdout 7, stderr 8\r\ndebug2: fd 7 setting O_NONBLOCK\r\ndebug2: fd 8 setting O_NONBLOCK\r\ndebug1: channel 2: new [client-session]\r\ndebug2: process_mux_new_session: channel_new: 2 linked to control channel 1\r\ndebug2: channel 2: send open\r\ndebug3: send packet: type 90\r\ndebug3: receive packet: type 91\r\ndebug2: callback start\r\ndebug2: client_session2_setup: id 2\r\ndebug1: Sending environment.\r\ndebug1: Sending env XMODIFIERS = @im=ibus\r\ndebug2: channel 2: request env confirm 0\r\ndebug3: send packet: type 98\r\ndebug1: Sending env LANG = en_US.UTF-8\r\ndebug2: channel 2: request env confirm 0\r\ndebug3: send packet: type 98\r\ndebug1: Sending command: /bin/sh -c \\'echo ~ && sleep 0\\'\r\ndebug2: channel 2: request exec confirm 1\r\ndebug3: send packet: type 98\r\ndebug3: mux_session_confirm: sending success reply\r\ndebug2: callback done\r\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug2: channel 2: rcvd adjust 2097152\r\ndebug3: receive packet: type 99\r\ndebug2: channel_input_status_confirm: type 99 id 2\r\ndebug2: exec request accepted on channel 2\r\ndebug3: receive packet: type 98\r\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\r\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\r\ndebug3: receive packet: type 98\r\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\r\ndebug2: channel 2: rcvd eow\r\ndebug2: channel 2: close_read\r\ndebug2: channel 2: input open -> closed\r\ndebug3: receive packet: type 96\r\ndebug2: channel 2: rcvd eof\r\ndebug2: channel 2: output open -> drain\r\ndebug2: channel 2: obuf empty\r\ndebug2: channel 2: close_write\r\ndebug2: channel 2: output drain -> closed\r\ndebug3: receive packet: type 97\r\ndebug2: channel 2: rcvd close\r\ndebug3: channel 2: will not send data after close\r\ndebug2: channel 2: send close\r\ndebug3: send packet: type 97\r\ndebug2: channel 2: is dead\r\ndebug2: channel 2: gc: notify user\r\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\r\ndebug2: channel 1: rcvd close\r\ndebug2: channel 1: output open -> drain\r\ndebug2: channel 1: close_read\r\ndebug2: channel 1: input open -> closed\r\ndebug2: channel 2: gc: user detached\r\ndebug2: channel 2: is dead\r\ndebug2: channel 2: garbage collecting\r\ndebug1: channel 2: free: client-session, nchannels 3\r\ndebug3: channel 2: status: The following connections are open:\r\n  #1 mux-control (t16 r-1 i3/0 o1/16 fd 5/5 cc -1)\r\n  #2 client-session (t4 r0 i3/0 o3/0 fd -1/-1 cc -1)\r\n\r\ndebug2: channel 1: obuf empty\r\ndebug2: channel 1: close_write\r\ndebug2: channel 1: output drain -> closed\r\ndebug2: channel 1: is dead (local)\r\ndebug2: channel 1: gc: notify user\r\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\r\ndebug2: channel 1: gc: user detached\r\ndebug2: channel 1: is dead (local)\r\ndebug2: channel 1: garbage collecting\r\ndebug1: channel 1: free: mux-control, nchannels 2\r\ndebug3: channel 1: status: The following connections are open:\r\n  #1 mux-control (t16 r-1 i3/0 o3/0 fd 5/5 cc -1)\r\n\r\ndebug2: set_control_persist_exit_time: schedule exit in 1800 seconds\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.129 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676 `\" && echo ansible-tmp-1548067233.38-82499174386676=\"` echo /root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676 `\" ) && sleep 0'\"'\"''\r\n<172.16.4.130> (0, '/root\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug1: Control socket \"/dev/shm/172.16.4.130-root\" does not exist\r\ndebug2: resolving \"172.16.4.130\" port 22\r\ndebug2: ssh_connect_direct: needpriv 0\r\ndebug1: Connecting to 172.16.4.130 [172.16.4.130] port 22.\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: fd 3 clearing O_NONBLOCK\r\ndebug1: Connection established.\r\ndebug3: timeout: 9995 ms remain after connect\r\ndebug1: permanently_set_uid: 0/0\r\ndebug1: identity file /root/.ssh/id_rsa type 1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519 type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\r\ndebug1: Enabling compatibility mode for protocol 2.0\r\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\r\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_6.2\r\ndebug1: match: OpenSSH_6.2 pat OpenSSH* compat 0x04000000\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug1: Authenticating to 172.16.4.130:22 as \\'root\\'\r\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:2\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.130\r\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\r\ndebug3: send packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT sent\r\ndebug3: receive packet: type 20\r\ndebug1: SSH2_MSG_KEXINIT received\r\ndebug2: local client KEXINIT proposal\r\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\r\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\r\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\r\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\r\ndebug2: compression ctos: zlib@openssh.com,zlib,none\r\ndebug2: compression stoc: zlib@openssh.com,zlib,none\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug2: peer server KEXINIT proposal\r\ndebug2: KEX algorithms: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\r\ndebug2: host key algorithms: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256\r\ndebug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se\r\ndebug2: MACs ctos: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: MACs stoc: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96\r\ndebug2: compression ctos: none,zlib@openssh.com\r\ndebug2: compression stoc: none,zlib@openssh.com\r\ndebug2: languages ctos: \r\ndebug2: languages stoc: \r\ndebug2: first_kex_follows 0 \r\ndebug2: reserved 0 \r\ndebug1: kex: algorithm: ecdh-sha2-nistp256\r\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\r\ndebug1: kex: server->client cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: client->server cipher: aes128-ctr MAC: umac-64-etm@openssh.com compression: zlib@openssh.com\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug1: kex: ecdh-sha2-nistp256 need=16 dh_need=16\r\ndebug3: send packet: type 30\r\ndebug1: sending SSH2_MSG_KEX_ECDH_INIT\r\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\r\ndebug3: receive packet: type 31\r\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:ea4rLTu1cR1Mmsc94B1EomwEW+2v2KC+o4mYZderk9g\r\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\r\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:2\r\ndebug3: load_hostkeys: loaded 1 keys from 172.16.4.130\r\ndebug1: Host \\'172.16.4.130\\' is known and matches the ECDSA host key.\r\ndebug1: Found key in /root/.ssh/known_hosts:2\r\ndebug3: send packet: type 21\r\ndebug2: set_newkeys: mode 1\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: SSH2_MSG_NEWKEYS sent\r\ndebug1: expecting SSH2_MSG_NEWKEYS\r\ndebug3: receive packet: type 21\r\ndebug1: SSH2_MSG_NEWKEYS received\r\ndebug2: set_newkeys: mode 0\r\ndebug1: rekey after 4294967296 blocks\r\ndebug1: pubkey_prepare: ssh_get_authentication_socket: No such file or directory\r\ndebug2: key: /root/.ssh/id_rsa (0x7f448ce45490)\r\ndebug2: key: /root/.ssh/id_dsa ((nil))\r\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\r\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\r\ndebug3: send packet: type 5\r\ndebug3: receive packet: type 6\r\ndebug2: service_accept: ssh-userauth\r\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 51\r\ndebug1: Authentications that can continue: publickey,password,keyboard-interactive\r\ndebug3: start over, passed a different list publickey,password,keyboard-interactive\r\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\r\ndebug3: authmethod_lookup publickey\r\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\r\ndebug3: authmethod_is_enabled publickey\r\ndebug1: Next authentication method: publickey\r\ndebug1: Offering RSA public key: /root/.ssh/id_rsa\r\ndebug3: send_pubkey_test\r\ndebug3: send packet: type 50\r\ndebug2: we sent a publickey packet, wait for reply\r\ndebug3: receive packet: type 60\r\ndebug1: Server accepts key: pkalg ssh-rsa blen 279\r\ndebug2: input_userauth_pk_ok: fp SHA256:LYCw+4D/hw0RLGD0BGCR4osgkfri9+Mni+fqXlqR8V4\r\ndebug3: sign_and_send_pubkey: RSA SHA256:LYCw+4D/hw0RLGD0BGCR4osgkfri9+Mni+fqXlqR8V4\r\ndebug3: send packet: type 50\r\ndebug3: receive packet: type 52\r\ndebug1: Enabling compression at level 6.\r\ndebug1: Authentication succeeded (publickey).\r\nAuthenticated to 172.16.4.130 ([172.16.4.130]:22).\r\ndebug1: setting up multiplex master socket\r\ndebug3: muxserver_listen: temporary control path /dev/shm/172.16.4.130-root.bogKWqA8sD6ykk6A\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug3: fd 4 is O_NONBLOCK\r\ndebug1: channel 0: new [/dev/shm/172.16.4.130-root]\r\ndebug3: muxserver_listen: mux listener channel 0 fd 4\r\ndebug2: fd 3 setting TCP_NODELAY\r\ndebug3: ssh_packet_set_tos: set IP_TOS 0x08\r\ndebug1: control_persist_detach: backgrounding master process\r\ndebug2: control_persist_detach: background process is 74757\r\ndebug2: fd 4 setting O_NONBLOCK\r\ndebug1: forking to background\r\ndebug1: Entering interactive session.\r\ndebug1: pledge: id\r\ndebug2: set_control_persist_exit_time: schedule exit in 1800 seconds\r\ndebug1: multiplexing control connection\r\ndebug2: fd 5 setting O_NONBLOCK\r\ndebug3: fd 5 is O_NONBLOCK\r\ndebug1: channel 1: new [mux-control]\r\ndebug3: channel_post_mux_listener: new mux channel 1 fd 5\r\ndebug3: mux_master_read_cb: channel 1: hello sent\r\ndebug2: set_control_persist_exit_time: cancel scheduled exit\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x00000001 len 4\r\ndebug2: process_mux_master_hello: channel 1 slave version 4\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000004 len 4\r\ndebug2: process_mux_alive_check: channel 1: alive check\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug3: mux_master_read_cb: channel 1 packet type 0x10000002 len 123\r\ndebug2: process_mux_new_session: channel 1: request tty 0, X 0, agent 0, subsys 0, term \"xterm-256color\", cmd \"/bin/sh -c \\'echo ~ && sleep 0\\'\", env 2\r\ndebug3: process_mux_new_session: got fds stdin 6, stdout 7, stderr 8\r\ndebug2: fd 7 setting O_NONBLOCK\r\ndebug2: fd 8 setting O_NONBLOCK\r\ndebug1: channel 2: new [client-session]\r\ndebug2: process_mux_new_session: channel_new: 2 linked to control channel 1\r\ndebug2: channel 2: send open\r\ndebug3: send packet: type 90\r\ndebug3: receive packet: type 91\r\ndebug2: callback start\r\ndebug2: client_session2_setup: id 2\r\ndebug1: Sending environment.\r\ndebug1: Sending env XMODIFIERS = @im=ibus\r\ndebug2: channel 2: request env confirm 0\r\ndebug3: send packet: type 98\r\ndebug1: Sending env LANG = en_US.UTF-8\r\ndebug2: channel 2: request env confirm 0\r\ndebug3: send packet: type 98\r\ndebug1: Sending command: /bin/sh -c \\'echo ~ && sleep 0\\'\r\ndebug2: channel 2: request exec confirm 1\r\ndebug3: send packet: type 98\r\ndebug3: mux_session_confirm: sending success reply\r\ndebug2: callback done\r\ndebug2: channel 2: open confirm rwindow 0 rmax 32768\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug2: channel 2: rcvd adjust 2097152\r\ndebug3: receive packet: type 99\r\ndebug2: channel_input_status_confirm: type 99 id 2\r\ndebug2: exec request accepted on channel 2\r\ndebug3: receive packet: type 98\r\ndebug1: client_input_channel_req: channel 2 rtype exit-status reply 0\r\ndebug3: mux_exit_message: channel 2: exit message, exitval 0\r\ndebug3: receive packet: type 98\r\ndebug1: client_input_channel_req: channel 2 rtype eow@openssh.com reply 0\r\ndebug2: channel 2: rcvd eow\r\ndebug2: channel 2: close_read\r\ndebug2: channel 2: input open -> closed\r\ndebug3: receive packet: type 96\r\ndebug2: channel 2: rcvd eof\r\ndebug2: channel 2: output open -> drain\r\ndebug2: channel 2: obuf empty\r\ndebug2: channel 2: close_write\r\ndebug2: channel 2: output drain -> closed\r\ndebug3: receive packet: type 97\r\ndebug2: channel 2: rcvd close\r\ndebug3: channel 2: will not send data after close\r\ndebug2: channel 2: send close\r\ndebug3: send packet: type 97\r\ndebug2: channel 2: is dead\r\ndebug2: channel 2: gc: notify user\r\ndebug3: mux_master_session_cleanup_cb: entering for channel 2\r\ndebug2: channel 1: rcvd close\r\ndebug2: channel 1: output open -> drain\r\ndebug2: channel 1: close_read\r\ndebug2: channel 1: input open -> closed\r\ndebug2: channel 2: gc: user detached\r\ndebug2: channel 2: is dead\r\ndebug2: channel 2: garbage collecting\r\ndebug1: channel 2: free: client-session, nchannels 3\r\ndebug3: channel 2: status: The following connections are open:\r\n  #1 mux-control (t16 r-1 i3/0 o1/16 fd 5/5 cc -1)\r\n  #2 client-session (t4 r0 i3/0 o3/0 fd -1/-1 cc -1)\r\n\r\ndebug2: channel 1: obuf empty\r\ndebug2: channel 1: close_write\r\ndebug2: channel 1: output drain -> closed\r\ndebug2: channel 1: is dead (local)\r\ndebug2: channel 1: gc: notify user\r\ndebug3: mux_master_control_cleanup_cb: entering for channel 1\r\ndebug2: channel 1: gc: user detached\r\ndebug2: channel 1: is dead (local)\r\ndebug2: channel 1: garbage collecting\r\ndebug1: channel 1: free: mux-control, nchannels 2\r\ndebug3: channel 1: status: The following connections are open:\r\n  #1 mux-control (t16 r-1 i3/0 o3/0 fd 5/5 cc -1)\r\n\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\ndebug2: set_control_persist_exit_time: schedule exit in 1800 seconds\r\n')\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.130 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720 `\" && echo ansible-tmp-1548067233.39-20078654649720=\"` echo /root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720 `\" ) && sleep 0'\"'\"''\r\n<172.16.4.129> (0, 'ansible-tmp-1548067233.38-82499174386676=/root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.130> (0, 'ansible-tmp-1548067233.39-20078654649720=/root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/commands/command.py\r\n<172.16.4.129> PUT /root/.ansible/tmp/ansible-local-747411QlIIY/tmp1e1052 TO /root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676/AnsiballZ_command.py\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/commands/command.py\r\n<172.16.4.130> PUT /root/.ansible/tmp/ansible-local-747411QlIIY/tmp_Z_XLz TO /root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720/AnsiballZ_command.py\r\n<172.16.4.129> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r '[172.16.4.129]'\r\n<172.16.4.130> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r '[172.16.4.130]'\r\n<172.16.4.130> (0, 'sftp> put /root/.ansible/tmp/ansible-local-747411QlIIY/tmp_Z_XLz /root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720/AnsiballZ_command.py\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug2: Remote version: 3\r\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\r\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\r\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\r\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\r\ndebug3: Sent message fd 5 T:16 I:1\r\ndebug3: SSH_FXP_REALPATH . -> /root size 0\r\ndebug3: Looking up /root/.ansible/tmp/ansible-local-747411QlIIY/tmp_Z_XLz\r\ndebug3: Sent message fd 5 T:17 I:2\r\ndebug3: Received stat reply T:101 I:2\r\ndebug1: Couldn\\'t stat remote file: No such file or directory\r\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720/AnsiballZ_command.py\r\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 4 32768 bytes at 0\r\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\r\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:8597\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 5 32768 bytes at 32768\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 6 8597 bytes at 65536\r\ndebug3: Sent message SSH2_FXP_CLOSE I:4\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.130 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720/ /root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<172.16.4.129> (0, 'sftp> put /root/.ansible/tmp/ansible-local-747411QlIIY/tmp1e1052 /root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676/AnsiballZ_command.py\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug2: Remote version: 3\r\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\r\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\r\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\r\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\r\ndebug3: Sent message fd 5 T:16 I:1\r\ndebug3: SSH_FXP_REALPATH . -> /root size 0\r\ndebug3: Looking up /root/.ansible/tmp/ansible-local-747411QlIIY/tmp1e1052\r\ndebug3: Sent message fd 5 T:17 I:2\r\ndebug3: Received stat reply T:101 I:2\r\ndebug1: Couldn\\'t stat remote file: No such file or directory\r\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676/AnsiballZ_command.py\r\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 4 32768 bytes at 0\r\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\r\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:8597\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 5 32768 bytes at 32768\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 6 8597 bytes at 65536\r\ndebug3: Sent message SSH2_FXP_CLOSE I:4\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.129 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676/ /root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<172.16.4.130> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r -tt 172.16.4.130 '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<172.16.4.129> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r -tt 172.16.4.129 '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<172.16.4.130> (0, '\r\n{\"changed\": true, \"end\": \"2019-01-21 18:29:48.226512\", \"stdout\": \"Mon Jan 21 18:29:48 CST 2019\", \"cmd\": [\"date\"], \"rc\": 0, \"start\": \"2019-01-21 18:29:48.122441\", \"stderr\": \"\", \"delta\": \"0:00:00.104071\", \"invocation\": {\"module_args\": {\"warn\": true, \"executable\": null, \"_uses_shell\": false, \"_raw_params\": \"date\", \"removes\": null, \"argv\": null, \"creates\": null, \"chdir\": null, \"stdin\": null}}}\r\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\nShared connection to 172.16.4.130 closed.\r\n')\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.130 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1548067233.39-20078654649720/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<172.16.4.129> (0, '\r\n{\"changed\": true, \"end\": \"2019-01-21 18:18:11.812206\", \"stdout\": \"Mon Jan 21 18:18:11 CST 2019\", \"cmd\": [\"date\"], \"rc\": 0, \"start\": \"2019-01-21 18:18:11.700396\", \"stderr\": \"\", \"delta\": \"0:00:00.111810\", \"invocation\": {\"module_args\": {\"warn\": true, \"executable\": null, \"_uses_shell\": false, \"_raw_params\": \"date\", \"removes\": null, \"argv\": null, \"creates\": null, \"chdir\": null, \"stdin\": null}}}\r\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\nShared connection to 172.16.4.129 closed.\r\n')\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.129 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1548067233.38-82499174386676/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<172.16.4.130> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\nchanged: [172.16.4.130] => {\r\n    \"changed\": true, \r\n    \"cmd\": [\r\n        \"date\"\r\n    ], \r\n    \"delta\": \"0:00:00.104071\", \r\n    \"end\": \"2019-01-21 18:29:48.226512\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"date\", \r\n            \"_uses_shell\": false, \r\n            \"argv\": null, \r\n            \"chdir\": null, \r\n            \"creates\": null, \r\n            \"executable\": null, \r\n            \"removes\": null, \r\n            \"stdin\": null, \r\n            \"warn\": true\r\n        }\r\n    }, \r\n    \"rc\": 0, \r\n    \"start\": \"2019-01-21 18:29:48.122441\", \r\n    \"stderr\": \"\", \r\n    \"stderr_lines\": [], \r\n    \"stdout\": \"Mon Jan 21 18:29:48 CST 2019\", \r\n    \"stdout_lines\": [\r\n        \"Mon Jan 21 18:29:48 CST 2019\"\r\n    ]\r\n}\r\n<172.16.4.129> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\nchanged: [172.16.4.129] => {\r\n    \"changed\": true, \r\n    \"cmd\": [\r\n        \"date\"\r\n    ], \r\n    \"delta\": \"0:00:00.111810\", \r\n    \"end\": \"2019-01-21 18:18:11.812206\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"date\", \r\n            \"_uses_shell\": false, \r\n            \"argv\": null, \r\n            \"chdir\": null, \r\n            \"creates\": null, \r\n            \"executable\": null, \r\n            \"removes\": null, \r\n            \"stdin\": null, \r\n            \"warn\": true\r\n        }\r\n    }, \r\n    \"rc\": 0, \r\n    \"start\": \"2019-01-21 18:18:11.700396\", \r\n    \"stderr\": \"\", \r\n    \"stderr_lines\": [], \r\n    \"stdout\": \"Mon Jan 21 18:18:11 CST 2019\", \r\n    \"stdout_lines\": [\r\n        \"Mon Jan 21 18:18:11 CST 2019\"\r\n    ]\r\n}\r\n\r\nTASK [Check the eth0 ip on the server.] ****************************************\r\ntask path: /var/lib/awx/projects/test-project/main.yml:8\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.129 '/bin/sh -c '\"'\"'echo ~ && sleep 0'\"'\"''\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.130 '/bin/sh -c '\"'\"'echo ~ && sleep 0'\"'\"''\r\n<172.16.4.130> (0, '/root\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.130 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642 `\" && echo ansible-tmp-1548067236.03-221660387159642=\"` echo /root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642 `\" ) && sleep 0'\"'\"''\r\n<172.16.4.129> (0, '/root\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.129 '/bin/sh -c '\"'\"'( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736 `\" && echo ansible-tmp-1548067236.02-264025423958736=\"` echo /root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736 `\" ) && sleep 0'\"'\"''\r\n<172.16.4.130> (0, 'ansible-tmp-1548067236.03-221660387159642=/root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/commands/command.py\r\n<172.16.4.130> PUT /root/.ansible/tmp/ansible-local-747411QlIIY/tmpM73Drh TO /root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642/AnsiballZ_command.py\r\n<172.16.4.130> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r '[172.16.4.130]'\r\n<172.16.4.129> (0, 'ansible-tmp-1548067236.02-264025423958736=/root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/commands/command.py\r\n<172.16.4.129> PUT /root/.ansible/tmp/ansible-local-747411QlIIY/tmpFTSSgt TO /root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736/AnsiballZ_command.py\r\n<172.16.4.129> SSH: EXEC sftp -b - -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r '[172.16.4.129]'\r\n<172.16.4.130> (0, 'sftp> put /root/.ansible/tmp/ansible-local-747411QlIIY/tmpM73Drh /root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642/AnsiballZ_command.py\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug2: Remote version: 3\r\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\r\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\r\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\r\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\r\ndebug3: Sent message fd 5 T:16 I:1\r\ndebug3: SSH_FXP_REALPATH . -> /root size 0\r\ndebug3: Looking up /root/.ansible/tmp/ansible-local-747411QlIIY/tmpM73Drh\r\ndebug3: Sent message fd 5 T:17 I:2\r\ndebug3: Received stat reply T:101 I:2\r\ndebug1: Couldn\\'t stat remote file: No such file or directory\r\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642/AnsiballZ_command.py\r\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 4 32768 bytes at 0\r\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\r\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:8602\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 5 32768 bytes at 32768\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 6 8602 bytes at 65536\r\ndebug3: Sent message SSH2_FXP_CLOSE I:4\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.130 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642/ /root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<172.16.4.129> (0, 'sftp> put /root/.ansible/tmp/ansible-local-747411QlIIY/tmpFTSSgt /root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736/AnsiballZ_command.py\\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug2: Remote version: 3\r\ndebug2: Server supports extension \"posix-rename@openssh.com\" revision 1\r\ndebug2: Server supports extension \"statvfs@openssh.com\" revision 2\r\ndebug2: Server supports extension \"fstatvfs@openssh.com\" revision 2\r\ndebug2: Server supports extension \"hardlink@openssh.com\" revision 1\r\ndebug3: Sent message fd 5 T:16 I:1\r\ndebug3: SSH_FXP_REALPATH . -> /root size 0\r\ndebug3: Looking up /root/.ansible/tmp/ansible-local-747411QlIIY/tmpFTSSgt\r\ndebug3: Sent message fd 5 T:17 I:2\r\ndebug3: Received stat reply T:101 I:2\r\ndebug1: Couldn\\'t stat remote file: No such file or directory\r\ndebug3: Sent message SSH2_FXP_OPEN I:3 P:/root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736/AnsiballZ_command.py\r\ndebug3: Sent message SSH2_FXP_WRITE I:4 O:0 S:32768\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 4 32768 bytes at 0\r\ndebug3: Sent message SSH2_FXP_WRITE I:5 O:32768 S:32768\r\ndebug3: Sent message SSH2_FXP_WRITE I:6 O:65536 S:8602\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 5 32768 bytes at 32768\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: In write loop, ack for 6 8602 bytes at 65536\r\ndebug3: Sent message SSH2_FXP_CLOSE I:4\r\ndebug3: SSH2_FXP_STATUS 0\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.129 '/bin/sh -c '\"'\"'chmod u+x /root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736/ /root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<172.16.4.130> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r -tt 172.16.4.130 '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<172.16.4.129> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r -tt 172.16.4.129 '/bin/sh -c '\"'\"'/usr/bin/python /root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736/AnsiballZ_command.py && sleep 0'\"'\"''\r\n<172.16.4.130> (0, '\r\n{\"changed\": true, \"end\": \"2019-01-21 18:29:49.560277\", \"stdout\": \"eth3      Link encap:Ethernet  HWaddr 00:50:56:83:4F:2E  \\\\n          inet addr:172.16.4.130  Bcast:172.16.7.255  Mask:255.255.252.0\\\\n          inet6 addr: fe80::250:56ff:fe83:4f2e/64 Scope:Link\\\\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\\\\n          RX packets:18714348 errors:0 dropped:2031 overruns:0 frame:0\\\\n          TX packets:13115590 errors:0 dropped:0 overruns:0 carrier:0\\\\n          collisions:0 txqueuelen:1000 \\\\n          RX bytes:4573037052 (4361.1 Mb)  TX bytes:11061666215 (10549.2 Mb)\\\\n\\\\neth4      Link encap:Ethernet  HWaddr 00:50:56:83:D9:6B  \\\\n          inet addr:172.16.5.104  Bcast:172.16.5.255  Mask:255.255.255.0\\\\n          inet6 addr: fe80::250:56ff:fe83:d96b/64 Scope:Link\\\\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\\\\n          RX packets:5267598 errors:0 dropped:2027 overruns:0 frame:0\\\\n          TX packets:8 errors:0 dropped:0 overruns:0 carrier:0\\\\n          collisions:0 txqueuelen:1000 \\\\n          RX bytes:397393294 (378.9 Mb)  TX bytes:648 (648.0 b)\\\\n\\\\nlo        Link encap:Local Loopback  \\\\n          inet addr:127.0.0.1  Mask:255.0.0.0\\\\n          inet6 addr: ::1/128 Scope:Host\\\\n          UP LOOPBACK RUNNING  MTU:16436  Metric:1\\\\n          RX packets:5690 errors:0 dropped:0 overruns:0 frame:0\\\\n          TX packets:5690 errors:0 dropped:0 overruns:0 carrier:0\\\\n          collisions:0 txqueuelen:0 \\\\n          RX bytes:476172 (465.0 Kb)  TX bytes:476172 (465.0 Kb)\", \"cmd\": [\"ifconfig\"], \"rc\": 0, \"start\": \"2019-01-21 18:29:49.452460\", \"stderr\": \"\", \"delta\": \"0:00:00.107817\", \"invocation\": {\"module_args\": {\"warn\": true, \"executable\": null, \"_uses_shell\": false, \"_raw_params\": \"ifconfig\", \"removes\": null, \"argv\": null, \"creates\": null, \"chdir\": null, \"stdin\": null}}}\r\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\nShared connection to 172.16.4.130 closed.\r\n')\r\n<172.16.4.130> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.130> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.130 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1548067236.03-221660387159642/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<172.16.4.129> (0, '\r\n{\"changed\": true, \"end\": \"2019-01-21 18:18:13.134439\", \"stdout\": \"eth2      Link encap:Ethernet  HWaddr 00:50:56:83:37:98  \\\\n          inet addr:172.16.4.129  Bcast:172.16.7.255  Mask:255.255.252.0\\\\n          inet6 addr: fe80::250:56ff:fe83:3798/64 Scope:Link\\\\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\\\\n          RX packets:5990051 errors:0 dropped:1912 overruns:0 frame:0\\\\n          TX packets:721150 errors:0 dropped:0 overruns:0 carrier:0\\\\n          collisions:0 txqueuelen:1000 \\\\n          RX bytes:537594282 (512.6 Mb)  TX bytes:663362003 (632.6 Mb)\\\\n\\\\nlo        Link encap:Local Loopback  \\\\n          inet addr:127.0.0.1  Mask:255.0.0.0\\\\n          inet6 addr: ::1/128 Scope:Host\\\\n          UP LOOPBACK RUNNING  MTU:16436  Metric:1\\\\n          RX packets:3838 errors:0 dropped:0 overruns:0 frame:0\\\\n          TX packets:3838 errors:0 dropped:0 overruns:0 carrier:0\\\\n          collisions:0 txqueuelen:0 \\\\n          RX bytes:322448 (314.8 Kb)  TX bytes:322448 (314.8 Kb)\", \"cmd\": [\"ifconfig\"], \"rc\": 0, \"start\": \"2019-01-21 18:18:13.024443\", \"stderr\": \"\", \"delta\": \"0:00:00.109996\", \"invocation\": {\"module_args\": {\"warn\": true, \"executable\": null, \"_uses_shell\": false, \"_raw_params\": \"ifconfig\", \"removes\": null, \"argv\": null, \"creates\": null, \"chdir\": null, \"stdin\": null}}}\r\n', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\nShared connection to 172.16.4.129 closed.\r\n')\r\n<172.16.4.129> ESTABLISH SSH CONNECTION FOR USER: None\r\n<172.16.4.129> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o ControlPath=/dev/shm/%h-%r 172.16.4.129 '/bin/sh -c '\"'\"'rm -f -r /root/.ansible/tmp/ansible-tmp-1548067236.02-264025423958736/ > /dev/null 2>&1 && sleep 0'\"'\"''\r\n<172.16.4.130> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74759\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\nchanged: [172.16.4.130] => {\r\n    \"changed\": true, \r\n    \"cmd\": [\r\n        \"ifconfig\"\r\n    ], \r\n    \"delta\": \"0:00:00.107817\", \r\n    \"end\": \"2019-01-21 18:29:49.560277\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"ifconfig\", \r\n            \"_uses_shell\": false, \r\n            \"argv\": null, \r\n            \"chdir\": null, \r\n            \"creates\": null, \r\n            \"executable\": null, \r\n            \"removes\": null, \r\n            \"stdin\": null, \r\n            \"warn\": true\r\n        }\r\n    }, \r\n    \"rc\": 0, \r\n    \"start\": \"2019-01-21 18:29:49.452460\", \r\n    \"stderr\": \"\", \r\n    \"stderr_lines\": [], \r\n    \"stdout\": \"eth3      Link encap:Ethernet  HWaddr 00:50:56:83:4F:2E  \\n          inet addr:172.16.4.130  Bcast:172.16.7.255  Mask:255.255.252.0\\n          inet6 addr: fe80::250:56ff:fe83:4f2e/64 Scope:Link\\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\\n          RX packets:18714348 errors:0 dropped:2031 overruns:0 frame:0\\n          TX packets:13115590 errors:0 dropped:0 overruns:0 carrier:0\\n          collisions:0 txqueuelen:1000 \\n          RX bytes:4573037052 (4361.1 Mb)  TX bytes:11061666215 (10549.2 Mb)\\n\\neth4      Link encap:Ethernet  HWaddr 00:50:56:83:D9:6B  \\n          inet addr:172.16.5.104  Bcast:172.16.5.255  Mask:255.255.255.0\\n          inet6 addr: fe80::250:56ff:fe83:d96b/64 Scope:Link\\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\\n          RX packets:5267598 errors:0 dropped:2027 overruns:0 frame:0\\n          TX packets:8 errors:0 dropped:0 overruns:0 carrier:0\\n          collisions:0 txqueuelen:1000 \\n          RX bytes:397393294 (378.9 Mb)  TX bytes:648 (648.0 b)\\n\\nlo        Link encap:Local Loopback  \\n          inet addr:127.0.0.1  Mask:255.0.0.0\\n          inet6 addr: ::1/128 Scope:Host\\n          UP LOOPBACK RUNNING  MTU:16436  Metric:1\\n          RX packets:5690 errors:0 dropped:0 overruns:0 frame:0\\n          TX packets:5690 errors:0 dropped:0 overruns:0 carrier:0\\n          collisions:0 txqueuelen:0 \\n          RX bytes:476172 (465.0 Kb)  TX bytes:476172 (465.0 Kb)\", \r\n    \"stdout_lines\": [\r\n        \"eth3      Link encap:Ethernet  HWaddr 00:50:56:83:4F:2E  \", \r\n        \"          inet addr:172.16.4.130  Bcast:172.16.7.255  Mask:255.255.252.0\", \r\n        \"          inet6 addr: fe80::250:56ff:fe83:4f2e/64 Scope:Link\", \r\n        \"          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\", \r\n        \"          RX packets:18714348 errors:0 dropped:2031 overruns:0 frame:0\", \r\n        \"          TX packets:13115590 errors:0 dropped:0 overruns:0 carrier:0\", \r\n        \"          collisions:0 txqueuelen:1000 \", \r\n        \"          RX bytes:4573037052 (4361.1 Mb)  TX bytes:11061666215 (10549.2 Mb)\", \r\n        \"\", \r\n        \"eth4      Link encap:Ethernet  HWaddr 00:50:56:83:D9:6B  \", \r\n        \"          inet addr:172.16.5.104  Bcast:172.16.5.255  Mask:255.255.255.0\", \r\n        \"          inet6 addr: fe80::250:56ff:fe83:d96b/64 Scope:Link\", \r\n        \"          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\", \r\n        \"          RX packets:5267598 errors:0 dropped:2027 overruns:0 frame:0\", \r\n        \"          TX packets:8 errors:0 dropped:0 overruns:0 carrier:0\", \r\n        \"          collisions:0 txqueuelen:1000 \", \r\n        \"          RX bytes:397393294 (378.9 Mb)  TX bytes:648 (648.0 b)\", \r\n        \"\", \r\n        \"lo        Link encap:Local Loopback  \", \r\n        \"          inet addr:127.0.0.1  Mask:255.0.0.0\", \r\n        \"          inet6 addr: ::1/128 Scope:Host\", \r\n        \"          UP LOOPBACK RUNNING  MTU:16436  Metric:1\", \r\n        \"          RX packets:5690 errors:0 dropped:0 overruns:0 frame:0\", \r\n        \"          TX packets:5690 errors:0 dropped:0 overruns:0 carrier:0\", \r\n        \"          collisions:0 txqueuelen:0 \", \r\n        \"          RX bytes:476172 (465.0 Kb)  TX bytes:476172 (465.0 Kb)\"\r\n    ]\r\n}\r\n<172.16.4.129> (0, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data /etc/ssh/ssh_config\r\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\r\ndebug1: auto-mux: Trying existing master\r\ndebug2: fd 3 setting O_NONBLOCK\r\ndebug2: mux_client_hello_exchange: master version 4\r\ndebug3: mux_client_forwards: request forwardings: 0 local, 0 remote\r\ndebug3: mux_client_request_session: entering\r\ndebug3: mux_client_request_alive: entering\r\ndebug3: mux_client_request_alive: done pid = 74756\r\ndebug3: mux_client_request_session: session request sent\r\ndebug1: mux_client_request_session: master session id: 2\r\ndebug3: mux_client_read_packet: read header failed: Broken pipe\r\ndebug2: Received exit status from master 0\r\n')\r\nchanged: [172.16.4.129] => {\r\n    \"changed\": true, \r\n    \"cmd\": [\r\n        \"ifconfig\"\r\n    ], \r\n    \"delta\": \"0:00:00.109996\", \r\n    \"end\": \"2019-01-21 18:18:13.134439\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"ifconfig\", \r\n            \"_uses_shell\": false, \r\n            \"argv\": null, \r\n            \"chdir\": null, \r\n            \"creates\": null, \r\n            \"executable\": null, \r\n            \"removes\": null, \r\n            \"stdin\": null, \r\n            \"warn\": true\r\n        }\r\n    }, \r\n    \"rc\": 0, \r\n    \"start\": \"2019-01-21 18:18:13.024443\", \r\n    \"stderr\": \"\", \r\n    \"stderr_lines\": [], \r\n    \"stdout\": \"eth2      Link encap:Ethernet  HWaddr 00:50:56:83:37:98  \\n          inet addr:172.16.4.129  Bcast:172.16.7.255  Mask:255.255.252.0\\n          inet6 addr: fe80::250:56ff:fe83:3798/64 Scope:Link\\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\\n          RX packets:5990051 errors:0 dropped:1912 overruns:0 frame:0\\n          TX packets:721150 errors:0 dropped:0 overruns:0 carrier:0\\n          collisions:0 txqueuelen:1000 \\n          RX bytes:537594282 (512.6 Mb)  TX bytes:663362003 (632.6 Mb)\\n\\nlo        Link encap:Local Loopback  \\n          inet addr:127.0.0.1  Mask:255.0.0.0\\n          inet6 addr: ::1/128 Scope:Host\\n          UP LOOPBACK RUNNING  MTU:16436  Metric:1\\n          RX packets:3838 errors:0 dropped:0 overruns:0 frame:0\\n          TX packets:3838 errors:0 dropped:0 overruns:0 carrier:0\\n          collisions:0 txqueuelen:0 \\n          RX bytes:322448 (314.8 Kb)  TX bytes:322448 (314.8 Kb)\", \r\n    \"stdout_lines\": [\r\n        \"eth2      Link encap:Ethernet  HWaddr 00:50:56:83:37:98  \", \r\n        \"          inet addr:172.16.4.129  Bcast:172.16.7.255  Mask:255.255.252.0\", \r\n        \"          inet6 addr: fe80::250:56ff:fe83:3798/64 Scope:Link\", \r\n        \"          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\", \r\n        \"          RX packets:5990051 errors:0 dropped:1912 overruns:0 frame:0\", \r\n        \"          TX packets:721150 errors:0 dropped:0 overruns:0 carrier:0\", \r\n        \"          collisions:0 txqueuelen:1000 \", \r\n        \"          RX bytes:537594282 (512.6 Mb)  TX bytes:663362003 (632.6 Mb)\", \r\n        \"\", \r\n        \"lo        Link encap:Local Loopback  \", \r\n        \"          inet addr:127.0.0.1  Mask:255.0.0.0\", \r\n        \"          inet6 addr: ::1/128 Scope:Host\", \r\n        \"          UP LOOPBACK RUNNING  MTU:16436  Metric:1\", \r\n        \"          RX packets:3838 errors:0 dropped:0 overruns:0 frame:0\", \r\n        \"          TX packets:3838 errors:0 dropped:0 overruns:0 carrier:0\", \r\n        \"          collisions:0 txqueuelen:0 \", \r\n        \"          RX bytes:322448 (314.8 Kb)  TX bytes:322448 (314.8 Kb)\"\r\n    ]\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP *********************************************************************\r\n172.16.4.129               : ok=2    changed=2    unreachable=0    failed=0   \r\n172.16.4.130               : ok=2    changed=2    unreachable=0    failed=0   \r\n```\r\nwhat is the difference of them?\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nIt would be nice to change the body message of notification zone in awx, by default it sends a JSON which if u had some password on it, someone is free to watch"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n(I'm sorry but I wanted to request the additional description in API guide but I don't choose a type for the guide.\r\nSo I register it as Feature Idea. \r\nPlease let me know if you have to make a different type.)\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n- There is no description of the parameter (paramater : dark)\r\nIs it only an unreachable state?\r\nOr can it include other state?\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n- URL : https://docs.ansible.com/ansible-tower/latest/html/towerapi/api_ref.html#/Jobs/Jobs_jobs_job_host_summaries_list\r\n- API : /api/v2/jobs/{id}/job_host_summaries/\r\n- parameter : dark"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\n`/api/v2` has been available for quite a while, and `/api/v1` has been deprecated for quite a while as well.\r\n\r\n`/api/v1` should eventually be removed (as it's complicating some credential work).\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nSimilar to #1756, but in a simpler way.\r\n\r\nFeature that will allow to schedule a job after completion of other scheduled job.\r\nMany jobs can be scheduled after a certain job is completed. Scheduling can be done starting at some time.\r\n\r\nWill help gluing many scheduled \"environment dependent\" workflows/jobs together .\r\n\r\nBenefits are\r\n - No need for making of one big workflow in Workflow Editor with every prompt\r\n - Workflows are still \"building blocks\" but with scheduling capability to arrange them\r\n - User/Operator decides what to schedule without changing existing workflow or making a new ones\r\n\r\n\r\n\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently it's possible to run simultaneously different jobs on single device which may cause problems.\r\n\r\nThis feature will forbid execution of 1 or more job on a single host/inventory.\r\n* When inventory is specified whole inventory should locked for execution for execution of other jobs\r\n* When hosts are specified separate hosts from inventory should be locked for execution of other jobs\r\n\r\nWould also be great to see execution locks in UI.\r\n\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nWe are triggering many concurrent jobs via a job template in AWX, using the API.  The job template includes a webhook notification to post the results back to the application that triggers the jobs.\r\nHowever, some jobs' webhook notifications don't fire, despite the job completing (successfully or otherwise).  There is nothing obvious in the awx-task logs indicating a failure to send notifications for the jobs that do not send.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.2.0\r\n* AWX install method: Kubernetes install via Ansible installer\r\n* Ansible version:  2.7.4\r\n* Operating System: CentOS Linux release 7.6.1810 (Core)  (Container)\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1.  Set up an https webhook notification on a job template, to send job results to some listener.\r\n2.  Launch many jobs via the API endpoint \"api/v2/job_templates/<templateid>/launch\"\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAll jobs send notifications of their result, whether success or failure.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNot all jobs send notifications of their result.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIn the cases where no notifications are sent, the /jobs/<jobid>/notifications API endpoint contains no notifications, but this may just be because none were sent, i.e. this is not the cause, but an effect of the problem.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Inventory\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nThis request was sort of posted under #2952, but was not properly described by the original poster (the RedHat support person who was trying to address my support case).  I'm reposting it here for clarity.\r\n\r\nHosts added to an inventory in Ansible Tower are automatically sorted by hostname.  When the order of the hosts matters (such as when using the order: keyword), this is a problem. Contrast this to Ansible Core where hosts in inventory files exist in the order specified by the author of the inventory.\r\n\r\nAs such, this enhancement request is to allow Ansible Tower inventories to have hosts listed in the order specified by the user. This would involve an option to disable the automatic sorting and perhaps a way to allow the user to drag hosts to reorder them within the inventory.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nHere is a specific use case to help explain the need for this enhancement:\r\n\r\nWe have a set of servers; let's call them hq1, hq2, dr1, and dr2. They run proprietary software and the high availability (HA) works such that the flow of replication is hq1 -> hq2 -> dr1 -> dr2. In order to perform some maintenance operations, the HA needs to be disabled in reverse order (dr2, dr1, hq2, h1); this is where I want to use a play with `order: reverse_inventory`. The maintenance can then be performed on all hosts. Finally, HA needs to be enabled in forward order (hq1, hq2, dr1, dr2); this is where I want to use a play with `order: inventory` (the default).\r\n\r\nWhen I create the inventory in Tower, the hosts get lexically ordered as dr1, dr2, hq1, hq2, which prevents the playbook from working as intended.\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n \r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThe ability to remove a user that was created by the Org admin by the same user should be possible if the user only belongs to the Org to which the admin has permissions.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n* AWX install method: installer\r\n* Ansible version:  2.7.5\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Use Org administrator to create a user\r\n2. Attempt to delete same user\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\nAble to delete the user just created. \r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nUnable to delete newly created user.\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nI have workflow template with 9 job templates (JT), it has failed at JT-6. So I clicked on details on failed JT-6 due to a timeout in executing a task, so I relaunch the JT-6 by going into details and click relaunch button. It was successful after relaunch, however Ansible did not resume the workflow even after the failed JT-6’s successful completion after rerun.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.4\r\n* Operating System: Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a workflow template with more than 2 job templates and some extra variables in Survey\r\n2. Have a failure condition in JT-2 on purpose\r\n3. Launch the workflow template\r\n4. Once JT-2 is failed,\r\n5. Remove the failure condition from the playbook, so that when it be played next time it should run fine\r\n6. Click on details on failed JT-2 from the workflow\r\n7. Relaunch the JT-2 by clickin on launch button\r\n8. JT-2 is successful now\r\n9. Navigate back to the Workflow status page\r\n10. Workflow still shows the JT-2 in failed state in Red colour, it wouldnt turn into Green\r\n11. And workflow would not resume to execute the remianing JTs in the wokflow.\r\n\r\n##### EXPECTED RESULTS\r\nWorkflow should resume and complete all the JTs after rerunning the failed JT-2 successfully.\r\n\r\n##### ACTUAL RESULTS\r\nWorkflow gets stuck even after successful completion of a failed JT-2 upon rerun\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis workflow is for application deployment, which consists of multiple steps, so i have created a JT for each task to identify which step failed. All these JTs are coded to run on a single host.\r\nAnd the target host is a Windows Server 2012 R2\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThe setting `SCHEDULE_MAX_JOBS` is ignored for WFTJs but works correctly for JTs.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel branch\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  N/A\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThe Job Template model implements usage of the `SCHEDULE_MAX_JOBS`\r\n\r\nhttps://github.com/ansible/awx/blob/d57fc998d5b5c6744595bc768aba6ec8861bb5b5/awx/main/models/jobs.py#L454-L459\r\n\r\nhowever the same isn't true for Workflows\r\n\r\nhttps://github.com/ansible/awx/blob/d57fc998d5b5c6744595bc768aba6ec8861bb5b5/awx/main/models/workflow.py#L408-L410\r\n\r\n##### EXPECTED RESULTS\r\n\r\n`SCHEDULE_MAX_JOBS` working for Workflow Job Templates same as it's working for Job Templates.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`SCHEDULE_MAX_JOBS` is ignored for Workflow Job Templates.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation/Issue\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAll the nodes of the received workflow is showing additional entries called extra_data with 2 variables. There is no survey or extra variables in associated nodes. Survey only exist at workflow level and that survey does not have these 2 variables. Any idea where this data could be coming from ?\r\n\r\nSample Below\r\n\r\n \"workflow_nodes\": [\r\n        {\r\n          \"name\": \"node0\", \r\n          \"unified_job_type\": \"job\", \r\n          \"success_nodes\": [\r\n            \"node4\"\r\n          ], \r\n          \"failure_nodes\": [], \r\n          \"unified_job_name\": \"Checkout_Feature_ATLAS-Automated-Service\", \r\n          **\"extra_data\": {\r\n            \"srcUsername\": \"admin\", \r\n            \"srcAtlasIP\": \"A.B.C.D\"\r\n          },** \r\n          \"always_nodes\": []\r\n        }, \r\n\r\n##### ENVIRONMENT\r\n* Tower CLI 3.3.0\r\n* API v2\r\n* Ansible Tower 3.3.3\r\n* Ansible 2.7.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\ntower-cli receive --workflow Project_Backup_Workflow\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nDo not expect extra_data to exist in received json.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen using the slack notifier, if a color is defined, the notification will fail with an error from the slack APIs saying \"not_in_channel\".\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.7.4\r\n* AWX install method: docker on linux\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a slack notification (including the bot user as directed by the AWX/Tower docs).  Then create a slack notification and add #f00 to the \"Notification Color\" field.\r\n\r\n##### EXPECTED RESULTS\r\nA message to be sent to the channel with the defined color.\r\n\r\n##### ACTUAL RESULTS\r\nNotification fails with \"not_in_channel\" error.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nGoogle will be shutting down the G+ OAuth APIs, which AWX uses for Google authentication, on March 7 2019. Information on its replacement can be found here: https://developers.google.com/identity/\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.x\r\n* Operating System: EL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nN/A\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nN/A\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nN/A\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAdd the ability to allow job template authors full admin to a created job template. This would include the ability for the job template author to add use/admin access to any job template they authored. Not just team members.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nA team member can currently share their playbook with a team, but not specific users.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCurrently it appears if a Job Template has a job type of check, it cannot be overridden when using the callback API. Because of this to actually have the template run from a callback job type must be set to run. I'd like to be able to keep the Job Template set to check in AWX but override it with run when calling the API.\r\n\r\n##### ADDITIONAL INFORMATION\r\nI've attempted to add job_type: run to the POST json and extra_vars, doesn't look like it did the trick. Setting the Job Template job type to run in AWX results in the job running as one would expect."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nNew installation, trying to get https/SSL connection working...I am not sure why AWX only permits http connection in particular when it involves username/password credentials.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.4\r\n* Operating System: Red Hat Enterprise Linux 7.6\r\n* Web Browser: Chrome 71, Firefox 60.4, Internet Explorer 11\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWent inside the ansible/awx_web container to try to modified the nginx.conf to reflect port 443 instead of 8052, this resulted in the webserver to stop working.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nswitching from 8052 to 443 should allow the nginx web-server to run in port 443 instead of 80 redirect to 8052, this is not intended outcomes. I am expecting that port 80 will be redirected to 443, considering we want only 443 traffic to be use for AWX in its entirety. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe results reflected nginx to stop working.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis is a clean install of AWX running the latest 2.1.1.0 as of the time of this writting. Please advise on the best approach to get the connectivity to ONLY allow https traffic."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n1. Slice by number of hosts or percentage of hosts, rather than by number of slices\r\n1. Select multiple inventories, and slice by inventory\r\n1. Prompt on launch for slicing/slice parameter\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIn working on https://github.com/ansible/awx/pull/2938 we on the UI team realized that it would be tremendously convenient for the job type to be present in job status socket messages.  It's particularly useful for the workflow results view where we need to build a static DETAILS link that would take the user out to the details of that particular job.  In the past, we've looked at the node's unified_job_type to do this but with the introduction of sjt's this is no longer enough information.  To get around this for now we've added a static redirect route which performs a GET request on the unified job and then redirects the user to the correct output view.  This solution could be removed if type were present in the message since we could use that to generate the link.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\nFeature idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nFailing to fill a required field in the UI for creating applications should show a more useful error than just kicking back the API error. Here's a screenshot of the current behavior if you try to use the Authorization code option then don't fill in a field.\r\n\r\n![screenshot from 2018-12-12 09-42-43](https://user-images.githubusercontent.com/19942822/50095942-8e1dce00-01e4-11e9-96c1-ed01a3c14963.png)\r\n"},{"labels":["api",null,null,null],"text":"Amazon inventories don't support new AWS region.\r\nCould you please add EU West 3 region ((EU) Paris) in available fields when defining a inventory source ?"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - Installer\r\n\r\n##### SUMMARY\r\n![image](https://user-images.githubusercontent.com/214912/50008534-7c3cf080-ff82-11e8-8017-1b22f636df99.png)\r\n\r\n\r\nFor these durable queues, we need to mirror them using a policy like this one:\r\n\r\n`rabbitmqctl set_policy ha-all \\\".*\\\" '{\\\"ha-mode\\\":\\\"all\\\", \\\"ha-sync-mode\\\":\\\"automatic\\\"}' -p awx\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n* AWX install method: openshift, minishift"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCustomer wants to make limitation that certain jobs to only run at certain times of the day so they don't affect other operations like a large scale job execution.\r\nCurrently, when users create a schedule, there is no features to limit the execution date and time range for job templates.\r\n\r\nIf it is possible, It would be nice if we make limitations the setting range for following sections in the CREATE SCHEDULE page(TEMPLATES > My_JOB_TEMPLATE > SCHEDULES   CREATE SCHEDULE):\r\n- START DATE\r\n- START TIME (HH24:MM:SS)\r\n- LOCAL TIME ZONE\r\n- REPEAT FREQUENCY\r\n\r\n##### ADDITIONAL INFORMATION\r\nNone"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n\r\nCurrently AWX does not have anyway of associating credentials with a inventory host, only with an inventory (in a job template). \r\n\r\nIt is very common for each host to require unique credentials. But awx assumes that all hosts use the same credentials.\r\n\r\n## User story\r\n\r\n> As a awx user, I would like to be able to associate a credential with a host, as each of my servers that I want to manage with ansible uses a unique username and password.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nHaving an AWS dynamic inventory configured with\r\n\r\n  - multiple inventory sources pointing to distinct AWS accounts\r\n  - set `overwrite: true`\r\n  - set `overwrite_vars: true`\r\n  - set `update_on_launch: null`\r\n\r\nCan result when updating all sources at once in a deadlock. For example when the update of all inventory source is triggered via `launch_type: callback`.\r\n\r\n```\r\ndjango.db.utils.OperationalError: deadlock detected\r\nDETAIL:  Process 19431 waits for ShareLock on transaction 142021; blocked by process 19438.\r\nProcess 19438 waits for ShareLock on transaction 142022; blocked by process 19431.\r\nHINT:  See server log for query details.\r\nCONTEXT:  while deleting tuple (0,20) in relation \"main_group_parents\"\r\n```\r\n##### ENVIRONMENT\r\n* AWX version: 2.x\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  N/A\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure AWS dynamic inventory with\r\n\r\n  - multiple inventory sources pointing to distinct AWS accounts\r\n  - set `overwrite: true`\r\n  - set `overwrite_vars: true`\r\n  - set `update_on_launch: null`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo deadlocks and successful updates from all inventory sources.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nDeadlock during update of random inventory source in such inventory.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWe updated the foreman.py script and got https://github.com/ansible/ansible/pull/34169\r\nAccording to docs, I get to override vars in `foreman.ini` by providing them in extra vars on source with `satellite6_` prepended to front of var: https://docs.ansible.com/ansible-tower/latest/html/userguide/inventories.html#red-hat-satellite-6 \r\n\r\nIf I provide `satellite6_want_ssh_ansible_host: True` I see NO effect and DO NOT see the expected:\r\n```\r\n\"ansible_ssh_host\": \"192.168.0.101\",\r\n```\r\nin the vars related to host in inventory\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel @ 271bd10b475312d586951d5ccd4a3a61b0d26824\r\n* AWX install method:  docker on linux\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nRun sync with satellite source with `satellite6_want_ssh_ansible_host: True`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nGet the following value in my vars for host:\r\n ```\r\n\"ansible_ssh_host\": \"192.168.0.101\",\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nNo effect, same as not passing it.\r\n\r\n##### ADDITIONAL INFORMATION\r\nContact me for reproducer satellite"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n - Core\r\n\r\n##### SUMMARY\r\nWhen running a playbook that uses the vmware_guest Ansible module to create Virtual Machines the Web UI stdout is blank as well as the the API shows no activity for that job. The job runs indefinitely and cannot be killed through the web. When running the playbook on the awx_task container command line Ansible raises an exception.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.4\r\n* Operating System: Ubuntu 18.04.1 LTS running Docker\r\n* Web Browser: Chrome 70.0.3538.77\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWeb UI\r\nRun the playbook in the additional information section with all variables filled out (We use tower's survey function) and launch the job. The playbook uses localhost.\r\n\r\nTask container\r\nsource venv/ansible/bin/activate\r\nansible-playbook playbook.yml\r\nFill out the prompts\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe playbook should run and reach out to our vcenter server and create a new Virtual Machine\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWeb UI/API\r\nNo output and the job cannot be canceled\r\n\r\nTask Container\r\n```\r\nPLAY [localhost] ***************************************************************************************************************************************************************************************************************************************************************\r\n\r\nTASK [Create virtual machine from template] ************************************************************************************************************************************************************************************************************************************\r\nAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: AttributeError: 'PyVmomiHelper' object has no attribute 'module'\r\nfatal: [localhost -> localhost]: FAILED! => {\"changed\": false, \"module_stderr\": \"Traceback (most recent call last):\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1544629992.04-214556431882032/AnsiballZ_vmware_guest.py\\\", line 113, in <module>\\n    _ansiballz_main()\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1544629992.04-214556431882032/AnsiballZ_vmware_guest.py\\\", line 105, in _ansiballz_main\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\n  File \\\"/root/.ansible/tmp/ansible-tmp-1544629992.04-214556431882032/AnsiballZ_vmware_guest.py\\\", line 48, in invoke_module\\n    imp.load_module('__main__', mod, module, MOD_DESC)\\n  File \\\"/tmp/ansible_vmware_guest_payload_zozjLJ/__main__.py\\\", line 2396, in <module>\\n  File \\\"/tmp/ansible_vmware_guest_payload_zozjLJ/__main__.py\\\", line 2322, in main\\n  File \\\"/tmp/ansible_vmware_guest_payload_zozjLJ/__main__.py\\\", line 798, in __init__\\n  File \\\"/tmp/ansible_vmware_guest_payload_zozjLJ/ansible_vmware_guest_payload.zip/ansible/module_utils/vmware.py\\\", line 777, in __init__\\nAttributeError: 'PyVmomiHelper' object has no attribute 'module'\\n\", \"module_stdout\": \"\", \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\", \"rc\": 1}\r\n\tto retry, use: --limit @/var/lib/awx/test.retry\r\n\r\nPLAY RECAP *********************************************************************************************************************************************************************************************************************************************************************\r\nlocalhost                  : ok=0    changed=0    unreachable=0    failed=1\r\n``` \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nHere is a stripped down version of the playbook we are running\r\n\r\n```\r\n---\r\n- hosts: localhost\r\n  gather_facts: no\r\n\r\n  vars_prompt:\r\n    - name: vcenter_hostname\r\n      prompt: \"vCenter Host\"\r\n      private: no\r\n\r\n    - name: vcenter_username\r\n      prompt: \"vCenter Username\"\r\n      private: no\r\n\r\n    - name: vcenter_password\r\n      prompt: \"vCenter Password\"\r\n      private: yes\r\n\r\n    - name: vm_name\r\n      prompt: \"Virtual Machine Name\"\r\n      private: no\r\n\r\n    - name: vm_template\r\n      prompt: \"Virtul Machine Template\"\r\n      private: no\r\n\r\n    - name: vm_folder\r\n      prompt: \"Virtual Machine Location Folder (sys.inf, sys.qa, datayard.local, sys.svc)\"\r\n      private: no\r\n\r\n    - name: vm_memory\r\n      prompt: \"Virtual Machine Memory\"\r\n      private: no\r\n\r\n    - name: vm_cpus\r\n      prompt: \"Virtual Machine CPU(s)\"\r\n      private: no\r\n\r\n    - name: vm_datastore\r\n      prompt: \"Virtual Machine Datastore\"\r\n      private: no\r\n\r\n    - name: vm_disksize\r\n      prompt: \"Virtual Machine Disk Size (GB)\"\r\n      private: no\r\n\r\n    - name: vm_network\r\n      prompt: \"Virtual Machine Primary Network\"\r\n      private: no\r\n\r\n    - name: vm_billingid\r\n      prompt: \"Billing ID\"\r\n      private: no\r\n\r\n  tasks:\r\n    - name: Create virtual machine from template\r\n      vmware_guest:\r\n          hostname: \"{{ vcenter_hostname }}\"\r\n          username: \"{{ vcenter_username }}\"\r\n          password: \"{{ vcenter_password }}\"\r\n          validate_certs: no\r\n          datacenter: Redacted\r\n          esxi_hostname: Redacted\r\n          folder: /Redacted/vm/{{ vm_folder }}\r\n          name: \"{{ vm_name }}\"\r\n          state: poweredon\r\n          template: \"{{ vm_template }}\"\r\n          customvalues: [\r\n            {\r\n              \"key\": \"BillingID\",\r\n              \"value\": \"{{ vm_billingid }}\"\r\n            }\r\n          ]\r\n          disk:\r\n          - size_gb: \"{{ vm_disksize }}\"\r\n            type: thin\r\n            datastore: '[{{ vm_datastore }}]'\r\n          hardware:\r\n            memory_mb: \"{{ vm_memory }}\"\r\n            num_cpus: \"{{ vm_cpus }}\"\r\n            num_cpu_cores_per_socket: 1\r\n            scsi: paravirtual\r\n          networks:\r\n            - name: \"{{ vm_network }}\"\r\n              type: dhcp\r\n              start_connected: true\r\n          wait_for_ip_address: yes\r\n      delegate_to: localhost\r\n```\r\n\r\nThis playbook is working on a couple different systems, I've created a fresh ubuntu install with ansible 2.7.4, python 2.7.12, and pyvmomi 6.7.1 and experience no errors.\r\n\r\nTo experience this issue you do not need an active vcenter server, you'll get the error even if you put incorrect information in the variables \r\n\r\npyvmomi version on awx is 6.5, we've tried upgrading this as well just as a test then reverted.\r\n\r\nAny help would be greatly appreciated.\r\nThanks!"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInstance filters help text claims that it only applies to EC2 sources. The code disagrees.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nOPTIONS for inventory source or inventory update, field `instance_filters`\r\n\r\n##### ACTUAL RESULTS\r\n\r\nhelp text gives\r\n\r\n> Comma-separated list of filter expressions (EC2 only). Hosts are imported when ANY of the filters match.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAllowed for VMWare & tower types\r\n\r\nhttps://github.com/ansible/awx/blob/271bd10b475312d586951d5ccd4a3a61b0d26824/awx/main/models/inventory.py#L1370-L1371\r\n\r\nused for both\r\n\r\nhttps://github.com/ansible/awx/blob/271bd10b475312d586951d5ccd4a3a61b0d26824/awx/main/tasks.py#L1898-L1899\r\n\r\nhttps://github.com/ansible/awx/blob/271bd10b475312d586951d5ccd4a3a61b0d26824/awx/main/tasks.py#L2069\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWhen viewing/editing an inventory script, there should be a tab that links to the sources where that inventory script is used.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWhile playbooks should live in source control and not be edited from AWX, it could be useful to *view* them, especially when trying to determine what playbook a job template should use just from a filename.\r\n\r\nLikely has some conflict with https://github.com/ansible/awx/issues/282.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n- API \r\n- UI\r\n\r\n##### SUMMARY\r\nWhen facts caching is enabled on a template, module search path is overwritten at runtime.\r\nJobs from this template won't run with the module search path set from parameter \"library\" in /etc/ansible/ansible.cfg, but with \"/usr/lib/python2.7/site-packages/awx/plugins/library\"\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.4\r\n* Operating System: RHEL 7\r\n* Web Browser: Firefox Quantum 63.0.3\r\n\r\n##### STEPS TO REPRODUCE\r\n- Set 'library' parameter to '/usr/share/my_modules' in /etc/ansible/ansible.cfg\r\n- Create a custom module and put it in /usr/share/my_modules\r\n- Create a template with parameters below : \r\n  - run playbook using the custom module\r\n  - set verbosity to 'more verbose' (only to display the value assigned to the module search path) \r\n  - enable facts caching \r\n\r\n##### EXPECTED RESULTS\r\n- configured module search path = [u'/usr/share/my_modules']\r\n- job using custom module run fine\r\n\r\n##### ACTUAL RESULTS\r\n- configured module search path = [u'/usr/lib/python2.7/site-packages/awx/plugins/library']\r\n- job failed with message : ERROR! no action detected in task. This often indicates a misspelled module name, or incorrect module path. [...]"},{"labels":["api"],"text":"##### ISSUE TYPE\r\nPass tower_user_* / awx_user_* to the dynamic inventory update, like we do for normal job template, so that those can be used in a custom script if needed.\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nPass tower_user_* / awx_user_* to the dynamic inventory update, like we do for normal job template, so that those can be used in the custom script if needed. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nwe currently pass those as job args for a normal job run and thus those can be used in playbook. Similarly it will be useful to pass those to inventory update as well and can be used in custom inventory scripts.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nThe variables tower_user* / awx_user* does not appear as part of ```hostvars[inventory_hostname]``` when the JT is launch from workflow over workflow.\r\n\r\n1. workflow --> workflow --> jt (not ok)\r\n2. workflow --> jt (ok)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.1\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a playbook to debug ```hostvars[inventory_hostname]```\r\n2. Configure a JT with the above playbook\r\n3. Create a workflow which contains the above JT\r\n4. Create another workflow which contains the above workflow\r\n5. Launch and examine the JT output logs.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nYou should see the tower_user* and awx_user* variables\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```hostvars[inventory_hostname]``` does not contain the tower_user* and awx_user* variables\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nSJT creates number of jobs as per the slicing count for the limited hosts.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: X.Y.Z\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.1\r\n* Operating System: CentOS\r\n* Web Browser: Google Chrome(Latest)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nCreate a Inventory with multiple hosts\r\nCreate a SJT with multiple slices and select the above created Inventory\r\nNow, Limit the SJT for one of the hosts from the provided Inventory\r\nLaunch the SJT\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nOnly one job is created for the limited hosts even if the Job Slicing value is >1.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nMultiple jobs are created for the limited hosts as per the Job Slicing count.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nEven if multiple jobs are created, only one succeeds rest everything fails with `ERROR! Specified hosts and/or --limit does not match any hosts`.\r\n![sjt-2](https://user-images.githubusercontent.com/21008429/49691050-47830080-fb60-11e8-8536-864926d6c108.png)\r\n![sjt-3](https://user-images.githubusercontent.com/21008429/49691051-4a7df100-fb60-11e8-820b-fa706104cdfc.png)\r\n\r\n![sjt-1](https://user-images.githubusercontent.com/21008429/49691047-3f2ac580-fb60-11e8-9060-9c802a72bcb4.png)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nInventory updates in the UI only show the credential if you click on the detail view, this is unlike what jobs do.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate an inventory source with a credential.\r\n\r\nSync it.\r\n\r\nView JOBS page in UI.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nShows credential like how jobs do.\r\n\r\n![screen shot 2018-12-07 at 3 26 10 pm](https://user-images.githubusercontent.com/1385596/49671002-74d29000-fa34-11e8-956d-985b863bfda1.png)\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\nDoes not show the credential:\r\n\r\n![screen shot 2018-12-07 at 3 23 32 pm](https://user-images.githubusercontent.com/1385596/49670962-4e145980-fa34-11e8-94ea-3365df4c3ba0.png)\r\n\r\nSame inventory update in detail view:\r\n\r\n![screen shot 2018-12-07 at 3 23 39 pm](https://user-images.githubusercontent.com/1385596/49670972-55d3fe00-fa34-11e8-8684-58ff6b05f1b2.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System: Ubuntu Bash on window 10\r\n* Web Browser:\r\nEage\r\n##### STEPS TO REPRODUCE\r\n\r\nrun commond -\r\n\r\n make ui-devel\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nsuccessful build and file should be generated in ui/static \r\n\r\n##### ACTUAL RESULTS\r\n\r\nnpm --unsafe-perm --prefix awx/ui install --no-save awx/ui\r\nWARN engine puppeteer@1.11.0: wanted: {\"node\":\">=6.4.0\"} (current: {\"node\":\"4.2.6\",\"npm\":\"3.5.2\"})\r\nWARN engine https-proxy-agent@2.2.1: wanted: {\"node\":\">= 4.5.0\"} (current: {\"node\":\"4.2.6\",\"npm\":\"3.5.2\"})\r\n\r\n> puppeteer@1.11.0 install /mnt/c/srv/python/awx_poc/awx/awx/ui/node_modules/puppeteer\r\n> node install.js\r\n\r\n/mnt/c/srv/python/awx_poc/awx/awx/ui/node_modules/puppeteer/install.js:78\r\n  return Promise.all([...cleanupOldVersions, generateProtocolTypesIfNecessary(true /* updated */)]);\r\n                      ^^^\r\n\r\nSyntaxError: Unexpected token ...\r\n    at exports.runInThisContext (vm.js:53:16)\r\n    at Module._compile (module.js:374:25)\r\n    at Object.Module._extensions..js (module.js:417:10)\r\n    at Module.load (module.js:344:32)\r\n    at Function.Module._load (module.js:301:12)\r\n    at Function.Module.runMain (module.js:442:10)\r\n    at startup (node.js:136:18)\r\n    at node.js:966:3\r\nnpm WARN optional Skipping failed optional dependency /chokidar/fsevents:\r\nnpm WARN notsup Not compatible with your operating system or architecture: fsevents@1.2.4\r\nnpm WARN optional Skipping failed optional dependency /nunjucks/chokidar/fsevents:\r\nnpm WARN notsup Not compatible with your operating system or architecture: fsevents@1.2.4\r\nnpm WARN optional Skipping failed optional dependency /watchpack/chokidar/fsevents:\r\nnpm WARN notsup Not compatible with your operating system or architecture: fsevents@1.2.4\r\nnpm WARN optional Skipping failed optional dependency /webpack-dev-server/chokidar/fsevents:\r\nnpm WARN notsup Not compatible with your operating system or architecture: fsevents@1.2.4\r\nnpm WARN ajv-keywords@2.1.1 requires a peer of ajv@^5.0.0 but none was installed.\r\nnpm WARN awx@1.0.0 No license field.\r\nnpm ERR! Linux 4.4.0-43-Microsoft\r\nnpm ERR! argv \"/usr/bin/nodejs\" \"/usr/bin/npm\" \"--unsafe-perm\" \"--prefix\" \"awx/ui\" \"install\" \"--no-save\" \"awx/ui\"\r\nnpm ERR! node v4.2.6\r\nnpm ERR! npm  v3.5.2\r\nnpm ERR! code ELIFECYCLE\r\n\r\nnpm ERR! puppeteer@1.11.0 install: `node install.js`\r\nnpm ERR! Exit status 1\r\nnpm ERR!\r\nnpm ERR! Failed at the puppeteer@1.11.0 install script 'node install.js'.\r\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\r\nnpm ERR! If you do, this is most likely a problem with the puppeteer package,\r\nnpm ERR! not with npm itself.\r\nnpm ERR! Tell the author that this fails on your system:\r\nnpm ERR!     node install.js\r\nnpm ERR! You can get information on how to open an issue for this project with:\r\nnpm ERR!     npm bugs puppeteer\r\nnpm ERR! Or if that isn't available, you can get their info via:\r\nnpm ERR!     npm owner ls puppeteer\r\nnpm ERR! There is likely additional logging output above.\r\n\r\nnpm ERR! Please include the following file with any support request:\r\nnpm ERR!     /mnt/c/srv/python/awx_poc/awx/npm-debug.log\r\nMakefile:470: recipe for target 'awx/ui/.deps_built' failed\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n \r\nproblem with  puppeteer\r\n\r\nand I remove puppeteer then its run successful."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nVersioning problem - tokens cause server errors in `/api/v1/activity_stream/` or similar\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a token\r\n\r\n##### EXPECTED RESULTS\r\n\r\nView activity stream for that action in v1\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n2018-12-06 02:02:22,963 ERROR    django.request Internal Server Error: /api/v1/activity_stream/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/lib/python2.7/site-packages/awx/wsgi.py\", line 71, in _legacy_get_response\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/lib/python2.7/site-packages/awx/api/generics.py\", line 327, in dispatch\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 45, in list\r\n    return self.get_paginated_response(serializer.data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 742, in data\r\n    ret = super(ListSerializer, self).data\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 262, in data\r\n    self._data = self.to_representation(self.instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 660, in to_representation\r\n    self.child.to_representation(item) for item in iterable\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 504, in to_representation\r\n    ret[field.field_name] = field.to_representation(attribute)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 1816, in to_representation\r\n    return method(value)\r\n  File \"/lib/python2.7/site-packages/awx/api/serializers.py\", line 338, in _get_related\r\n  File \"/lib/python2.7/site-packages/awx/api/serializers.py\", line 4958, in get_related\r\n  File \"/lib/python2.7/site-packages/awx/api/serializers.py\", line 621, in reverse\r\n  File \"/lib/python2.7/site-packages/awx/api/versioning.py\", line 52, in reverse\r\n  File \"/lib/python2.7/site-packages/awx/api/versioning.py\", line 23, in drf_reverse\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/reverse.py\", line 63, in _reverse\r\n    url = django_reverse(viewname, args=args, kwargs=kwargs, **extra)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/urls/base.py\", line 91, in reverse\r\n    return force_text(iri_to_uri(resolver._reverse_with_prefix(view, prefix, *args, **kwargs)))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/urls/resolvers.py\", line 497, in _reverse_with_prefix\r\n    raise NoReverseMatch(msg)\r\nNoReverseMatch: Reverse for 'o_auth2_token_detail' with keyword arguments '{'pk': 1L, u'version': u'v1'}' not found. 1 pattern(s) tried: [u'api/(?P<version>(v2))/tokens/(?P<pk>[0-9]+)/$']\r\n```\r\n\r\nToken exists, but does not exist in v1\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Able to use an alternate version of python to setup a custom virtualenv.  \r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWe are using the HPE Oneview ansible modules (https://github.com/HewlettPackard/oneview-ansible) which require python 2.7.9 or higher.  The default python version in the AWX container (centos 7) is python 2.7.5.  \r\n\r\nSo to use the Oneview modules I installed Python 2.7.13 from Software Collections (https://wiki.centos.org/AdditionalResources/Repositories/SCL) inside the awx_task and awx_web containers.  This installs to /opt/rh/python27.  To enable this python you have to run:  \r\n\r\nsource /opt/rh/python27/enable\r\n\r\nNow I can setup my virtualenv for the HPE Oneview modules.  \r\n\r\nI've done this in both containers (task/web) and it accepts the virtualenv and displays it as a choice for my templates in AWX.  Once I try to run a job though I get symbol errors and it errors out.  As far as I can tell it's because AWX is not able to \"enable\" the newer version of python before running the job from the virtualenv.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nHere's the steps I have done and the things I've done to try and make it work.  \r\n\r\nThese steps are done in both the awx_task and awx_web containers.\r\n\r\nFirst install python 2.7.13:  \r\n\r\nyum install scl-utils which\r\nyum install centos-release-scl\r\nyum clean all\r\nyum install scl-utils-build python27.x86_64\r\nvi /etc/yum.repos.d/CentOS-SCLo-scl.repo (disable repo)\r\nvi /etc/yum.repos.d/CentOS-SCLo-scl-rh.repo (disable repo)\r\nyum clean all\r\n\r\nNow enable the new python version so that 2.7.13 is added to your PATH before the older OS python:\r\n\r\nsource /opt/rh/python27/enable\r\n\r\nwhich python (/opt/rh/python27/root/usr/bin/python)\r\npython -V (Python 2.7.13)\r\n\r\nNow create the virtualenv:  \r\n\r\ncd /var/lib/awx/venv\r\nmkdir oneview_ansible265\r\nwhich virtualenv (/opt/rh/python27/root/usr/bin/virtualenv)\r\nvirtualenv /var/lib/awx/venv/oneview_ansible265\r\ncd oneview_ansible265\r\nsource bin/activate\r\nwhich python (/var/lib/awx/venv/oneview_ansible265/bin/python)\r\npython -V (Python 2.7.13)\r\n\r\nNow install ansible and friends and also the HPE Oneview modules\r\n\r\nwhich pip (/var/lib/awx/venv/oneview_ansible265/bin/pip)\r\npip install --upgrade pip\r\npip install --upgrade setuptools\r\npip install ansible==2.6.5\r\npip install hpOneView==4.7.0\r\npip install pyvmomi==6.7.1\r\npip install orionsdk==0.0.6\r\n\r\nOkay now everything is installed. Repeat on the web container.  \r\n\r\nNow in AWX I can select this custom_virtualenvs from the template page.  \r\n\r\nWhen I run a job though, I get these symbol errors:  \r\n\r\nIdentity added: /tmp/awx_586_VnMs4j/credential_3 (/tmp/awx_586_VnMs4j/credential_3)\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/oneview_ansible265/bin/ansible-playbook\", line 67, in <module>\r\n    import ansible.constants as C\r\n  File \"/var/lib/awx/venv/oneview_ansible265/lib/python2.7/site-packages/ansible/constants.py\", line 11, in <module>\r\n    from jinja2 import Template\r\n  File \"/var/lib/awx/venv/oneview_ansible265/lib/python2.7/site-packages/jinja2/__init__.py\", line 41, in <module>\r\n    from jinja2.bccache import BytecodeCache, FileSystemBytecodeCache, \\\\\r\n  File \"/var/lib/awx/venv/oneview_ansible265/lib/python2.7/site-packages/jinja2/bccache.py\", line 23, in <module>\r\n    import tempfile\r\n  File \"/var/lib/awx/venv/oneview_ansible265/lib64/python2.7/tempfile.py\", line 32, in <module>\r\n    import io as _io\r\n  File \"/var/lib/awx/venv/oneview_ansible265/lib64/python2.7/io.py\", line 51, in <module>\r\n    import _io\r\nImportError: /var/lib/awx/venv/oneview_ansible265/lib64/python2.7/lib-dynload/_io.so: undefined symbol: _PyErr_ReplaceException\r\n\r\nIf I login to the docker container I can do this:  \r\n\r\ndocker exec -it awx_task bash\r\n\r\nThen...\r\n\r\ncd venv/oneview_ansible265\r\nsource bin/activate\r\ncd ../../projects/_10__my_project\r\nansible-playbook playbooks/site.yml\r\nwhich python (/var/lib/awx/venv/oneview_ansible265/bin/python)\r\npython -V (Python 2.7.5)\r\n\r\nIt's still trying to use the OS python v2.7.5...not the new Software Collections python installed in /opt.  \r\n\r\nI get the same symbol errors.  \r\n\r\nIf I enable the new python version from Software Collections first though, it works properly (from inside the container anyway...not from AWX).  Logout and back in.\r\n\r\nexit\r\ndocker exec -it awx_task bash\r\nsource /opt/rh/python27/enable \r\ncd venv/oneview_ansible265/\r\nsource bin/activate\r\ncd ../../projects/_10__my_project\r\nwhich python (/var/lib/awx/venv/oneview_ansible265/bin/python)\r\npython -V (Python 2.7.13)\r\n\r\nNow it's using the new python and playbooks will run.  But this doesn't seem to be happening when AWX uses the virtualenv.  \r\n\r\nIs there some way to get AWX to 'enable' the new python in /opt before it tries to use the virtualenv?  \r\n\r\nI've tried to add the extra-var\r\n\r\nansible_python_interpreter: /var/lib/awx/venv/oneview_ansible265/bin/python2\r\n\r\nto the template but it doesn't seem to help.  \r\n\r\nI also wasn't sure how AWX was enabling the virtualenvs either.  Normally from the bash shell you run\r\n\r\nsource bin/activate\r\n\r\nSo I added this line to the top of that script\r\n\r\nsource /opt/rh/python27/enable\r\n\r\nin hopes that AWX is also running 'source bin/activate'.  But this doesn't seem to help either.  There's also activate.csh and activate.fish but neither of those shells are installed in the container so I don't think they are used.  I also added this line to the activate_this.py script in case AWX was calling it:  \r\n\r\nos.system('source /opt/rh/python27/enable')\r\n\r\nbut again, it doesn't seem to help.  \r\n\r\nAny ideas on how we can use newer versions of python with virtualenvs in AWX?  \r\n\r\nThanks.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nWhen I trigger the sqlplus to update the database in AWX, it throughs the error as below\r\n\r\nsqlplus: command not found\", \r\n\r\n\r\nchanged: [127.0.0.1] => {\r\n    \"changed\": true, \r\n    \"cmd\": \"sh Integration_TEST.sh get_server CHG111111 India Test_Sys Test\", \r\n    \"delta\": \"0:00:00.602746\", \r\n    \"end\": \"2018-12-04 12:24:55.878897\", \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"sh Integration_TEST.sh get_server CHG11111 India Test_Sys Test\", \r\n            \"_uses_shell\": true, \r\n            \"argv\": null, \r\n            \"chdir\": null, \r\n            \"creates\": null, \r\n            \"executable\": null, \r\n            \"removes\": null, \r\n            \"stdin\": null, \r\n            \"warn\": true\r\n        }\r\n    }, \r\n    \"rc\": 0, \r\n    \"start\": \"2018-12-04 12:24:55.276151\", \r\n    \"stderr\": \"Integration_TEST.sh: line 55: sqlplus: command not found\", \r\n    \"stderr_lines\": [\r\n\r\n##### ENVIRONMENT\r\nAWX version: 2.1.0\r\nAWX install method: docker\r\nAnsible version: 2.7.1\r\nOperating System: Redhat\r\nWeb Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nExecute the playbook again from AWX\r\nRe-Run the sqlplus command. Error as below\r\n\r\nsqlplus: command not found\", \r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThere will be a Django 2.2 LTS in approximately April 2019. At some point after that date, we should move to using it.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis work will be done in at least 3 pieces:\r\n\r\n- [x] Upgrade Django REST Framework\r\n- [x] ~~Remove django-jsonfield and jsonbfield in favor of Django's built-in JSONField~~\r\n- [x] Upgrade Django\r\n  - [x] #2075 Increase the size of the `User` first and last name fields"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Request\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI (?)\r\n\r\n##### SUMMARY\r\n\r\nAWX should support webhooks such that events in a webhookable SCM system such as Github can:\r\n- force a project update\r\n- launch a job template/workflow\r\n\r\nThis should, at a minimum, support:\r\n- GitHub\r\n- Gitlab\r\n- Bitbucket\r\nwith pluggability to support other SCM platforms.\r\n\r\nThis should track items such as:\r\n- repository\r\n- user who made the change\r\n- PR/change request/etc\r\n- whether it's a PR, update to a PR, or a merge\r\n- probably some other things\r\n\r\n##### ENVIRONMENT\r\n* AWX version: whatever\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nProbably will require some crossover with #282 "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nPre-run project syncs are not supposed to ordinarily make changes to the project they use.\r\n\r\nThus, a failure in a project sync should not cause the project to be marked failed, just as how it does not update its last update link usually.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a JT and sigkill the process while the project sync is running\r\n\r\n##### EXPECTED RESULTS\r\n\r\nProject not marked as failed\r\n\r\n##### ACTUAL RESULTS\r\n\r\nproject marked as failed\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCurrently, We are not sending the following fields to the \"awx.analytics.activity_stream\" logger:\r\n\r\n - Start and End time of job.\r\n - Status of the job. \r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nDeleting a WFJT node that has answers to password-type question creates activity stream entries that contain the encrypted form of the value\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a JT with a survey with a password question\r\n\r\nadd the JT to a WFJT\r\n\r\nclick the PROMPT button to answer the survey\r\n\r\nprovide an answer to password-type question\r\n\r\ndelete the node\r\n\r\nview activity stream\r\n\r\n##### EXPECTED RESULTS\r\n\r\nshows up as just \"$encrypted$\"\r\n\r\n##### ACTUAL RESULTS\r\n\r\nshows up as \"$encrypted$\" followed by encrypted stuff.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWe cannot set HTTP/HTTPS proxy to configure logging aggregator.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nI set proxy settings to below configuration files, but it doesn't go well.\r\n\r\n- /etc/profile.d/proxy.sh\r\n- /var/lib/awx/.bashrc\r\n- /etc/supervisord.d/tower.ini (we use Ansible Tower 3.3.1)\r\n\r\nAlso I push the \"Test\" button, UI shows an error.\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nNormally, I can specify the host filter to exclude the specific host in API as below:\r\n```\r\n http://<AWX_URL>/api/v2/hosts/?not__name__icontains=test\r\n```\r\nBut when I created the smart inventory, we cannot specify the `not.name.icontains:test` filter.\r\nIs it the normal behavior of smart inventory? Is there any way to exclude the specific host on smart inventory?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1. Register hosts like \"test1\", \"test2\" and \"test3\".\r\n2. Create smart inventory and open smart host filter.\r\n3. set `not.name.icontains:test3` but it shows `No records matched your search..`\r\n\r\n##### EXPECTED RESULTS\r\n\"test1\" and \"test2\" will appear on smart inventory.\r\n\r\n##### ACTUAL RESULTS\r\nNo records matched.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf a workflow contains job nodes that have inventory nodes downstream of it (always connection makes it easy to reproduce), then the task manager will hang and all jobs will stop running.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - Create a workflow\r\n - add a node that does `set_stats`\r\n - add an inventory update to always nodes of that node\r\n\r\n##### EXPECTED RESULTS\r\n\r\nruns\r\n\r\n##### ACTUAL RESULTS\r\n\r\nstops running half-way through\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRe-filing from reports in conversation in older issue\r\n\r\nhttps://github.com/ansible/awx/issues/2642#issuecomment-441990894\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCannot use Amazon AWS / EC2 credential to take actions with modules in Ansible\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nCreate an AWS credential with all fields filled out, all valid data.\r\n\r\nRun the playbook\r\n\r\n```yaml\r\n\r\n---\r\n- name: Test use of credentials with cloud module, taken from Ansible docs\r\n  hosts: localhost\r\n  connection: local\r\n  gather_facts: False\r\n\r\n  tasks:\r\n\r\n    - name: Provision a set of instances (credential_type=aws)\r\n      ec2:\r\n         state: \"{{ state | default('absent') }}\"\r\n         instance_ids: [\"8ut0o26a1g\"]  # should not match anything\r\n      tags:\r\n\r\n```\r\n\r\nExpected: successful, not changed\r\n\r\nActual:\r\n\r\n> Either region or ec2_url must be specified\r\n\r\nThis issue is to add a parameter to the AWS credentials so that it can be used with the modules without additional hacking."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nUsers with the job template admin role are unable to change the \"timeout\" value at the job template endpoint. \r\n\r\n##### ENVIRONMENT\r\n* Tower version: 3.3\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a user with job template admin permission\r\n2. Navigate to /api/v2/job_templates/N\r\n3. Attempt to patch the timeout value\r\n\r\n##### EXPECTED RESULTS\r\nAble to change the timeout value\r\n\r\n##### ACTUAL RESULTS\r\nPermissions error:\r\n```{\r\n    \"detail\": \"You do not have permission to perform this action.\"\r\n}```\r\n"},{"labels":["api",null],"text":"##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nJust after job start I have below output on AWX webpage \r\n\r\n1 [WARNING]: Failure using method (v2_playbook_on_play_start) in callback plugin\r\n2 (<awx_display_callback.module.AWXDefaultCallbackModule object at\r\n3 0x7f240235b090>): 'NoneType' object has no attribute 'strip'\r\n4\r\n5 skipping: no hosts matched\r\n6\r\n7 PLAY RECAP *****************************************************************   14:17:14\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.5\r\n* Operating System: CentOS Linux release 7.5.1804 (Core)\r\n* Web Browser: Few different versions the same result\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nJust when I run \"Job Template\" i have described error on screen. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"**ISSUE TYPE**\r\n- Request for Enhancement\r\n\r\n**COMPONENT NAME**\r\n- UI\r\n- API\r\n\r\n**SUMMARY**\r\n\r\nIt's not possible in the latest awx version to have the _Prompt on Launch_ checkbox for the Instance Groups selection in the Template definition screen.\r\n\r\nThis today forces the user to have the same template replicated as many times the number of Instance Groups available in the scenario since it's not possible to spacify it via survey at launch. When you have isolated nodes working on different VLANs this is very annoying.\r\n\r\n\r\n![screenshot from 2018-11-22 11-35-10](https://user-images.githubusercontent.com/17081949/48906875-2b941500-ee66-11e8-965f-a26280bbc41d.png)\r\n\r\n![154289775867143533](https://user-images.githubusercontent.com/17081949/48909298-2c7c7500-ee6d-11e8-9abd-226b3338d049.gif)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nLooks like the logic in the UI (and probably the API) isn't fully equipped to deal with multiple connections between two nodes.\r\n\r\nFor instance\r\n\r\n```\r\nA ----- (success) ---->\r\n   \\-----(failure)----> B\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd node to WFJT in UI\r\n\r\nAdd another node as a success node.\r\n\r\nGo to API, root node. Go to failure nodes and POST `{\"id\": N}` of the 2nd node.\r\n\r\nView this in the UI\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAPI should give a 400 in this case\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAccepted, but not rendered.\r\n\r\n<img width=\"1009\" alt=\"screen shot 2018-11-21 at 1 57 01 pm\" src=\"https://user-images.githubusercontent.com/1385596/48862995-eacccb00-ed95-11e8-98ce-9c80733f5c84.png\">\r\n\r\nOnly 1 connection type is rendered.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAll task names printed as \"*TASK [Gathering Facts]*\" on second and further host in play.\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.7.1\r\n* Operating System:\r\n* Web Browser: Safari, Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a job against inventory containing 2 or more hosts. \r\nOn first host in play task names displayed correctly. On second and further host in play all task names displayed as \"TASK [Gathering Facts] ********************************************************\"\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTask names displayed correctly as they named in playbook\r\n\r\n##### ACTUAL RESULTS\r\n\r\nExample contains playbook output on first host and head of output of the second host in play:\r\n\r\n```\r\nTASK [clean_up_temp : clean up  local temporary working directory] *************\r\nTuesday 20 November 2018  19:59:39 +0000 (0:00:00.083)       0:05:23.199 ****** \r\nchanged: [staging-sa-02 -> localhost]\r\n\r\nTASK [clean_up_temp : clean up local temporary working directory that was used for load extra vars role] ***\r\nTuesday 20 November 2018  19:59:40 +0000 (0:00:00.180)       0:05:23.379 ****** \r\nchanged: [staging-sa-02 -> localhost]\r\n\r\nTASK [clean_up_temp : clean up old fig and start files from instance] **********\r\nTuesday 20 November 2018  19:59:40 +0000 (0:00:00.183)       0:05:23.562 ****** \r\nchanged: [staging-sa-02]\r\n\r\nRUNNING HANDLER [make_local_working_temp_dir : Cleanup temp] *******************\r\nTuesday 20 November 2018  19:59:40 +0000 (0:00:00.250)       0:05:23.813 ****** \r\nok: [staging-sa-02 -> localhost]\r\n\r\nPLAY [deploy docker containers] ************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nTuesday 20 November 2018  19:59:40 +0000 (0:00:00.337)       0:05:24.151 ****** \r\nok: [staging-sa-01]\r\nTuesday 20 November 2018  19:59:44 +0000 (0:00:03.533)       0:05:27.684 ****** \r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [staging-sa-01] => {\r\n    \"changed\": false, \r\n    \"msg\": \"All assertions passed\"\r\n}\r\nTuesday 20 November 2018  19:59:44 +0000 (0:00:00.106)       0:05:27.791 ****** \r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [staging-sa-01] => {\r\n    \"changed\": false, \r\n    \"msg\": \"All assertions passed\"\r\n}\r\nTuesday 20 November 2018  19:59:44 +0000 (0:00:00.111)       0:05:27.902 ****** \r\n\r\nTASK [Gathering Facts] *********************************************************\r\nskipping: [staging-sa-01]\r\nTuesday 20 November 2018  19:59:44 +0000 (0:00:00.077)       0:05:27.980 ****** \r\n\r\nTASK [Gathering Facts] *********************************************************\r\nskipping: [staging-sa-01]\r\nTuesday 20 November 2018  19:59:44 +0000 (0:00:00.079)       0:05:28.059 ****** \r\n\r\nTASK [Gathering Facts] *********************************************************\r\nskipping: [staging-sa-01]\r\nTuesday 20 November 2018  19:59:44 +0000 (0:00:00.078)       0:05:28.138 ****** \r\n```\r\n##### ADDITIONAL INFORMATION\r\n\r\nResult is the same when using WEB UI, tower-cli or /api/v2/job/<number>/stdout. We have two AWX clusters and result is the same in both.\r\nWith and without fact caching enabled.\r\nIt doesn't depend on how much output produces a job. It's the same on \"long\" plays or relatively short. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWorkflow job failure connections take a long time to run.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a workflow with a long chain of failure nodes.\r\n\r\nFor purposes of illustrations, make these nodes call the workflow itself, so that it fails right away\r\n\r\n![screen shot 2018-11-20 at 2 46 17 pm](https://user-images.githubusercontent.com/1385596/48798755-54d06c00-ecd3-11e8-8739-261ceff72260.png)\r\n\r\nRun this\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe entire workflow should finish in under 5 seconds.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nTakes about 2 minutes in example\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI think this is addressed by hooks added in https://github.com/ansible/awx/pull/2729\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf you try to copy a credential with a really long name you get a 500 error\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. create aws credential with name \"awsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsawsaw\"\r\n2. click the copy button in the ui next to the credential.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCopied credential is created\r\n\r\n##### ACTUAL RESULTS\r\n\r\n500 error\r\n\r\n```\r\nTraceback:  \r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\" in inner\r\n  41.             response = get_response(request)\r\n\r\nFile \"./awx/wsgi.py\" in _legacy_get_response\r\n  71.         return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\" in _legacy_get_response\r\n  249.             response = self._get_response(request)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\" in _get_response\r\n  187.                 response = self.process_exception_by_middleware(e, request)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\" in _get_response\r\n  185.                 response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\" in inner\r\n  185.                     return func(*args, **kwargs)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\" in wrapped_view\r\n  58.         return view_func(*args, **kwargs)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\" in view\r\n  68.             return self.dispatch(request, *args, **kwargs)\r\n\r\nFile \"./awx/api/generics.py\" in dispatch\r\n  328.         return super(APIView, self).dispatch(request, *args, **kwargs)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\" in dispatch\r\n  494.             response = self.handle_exception(exc)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\" in handle_exception\r\n  454.             self.raise_uncaught_exception(exc)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\" in dispatch\r\n  491.             response = handler(request, *args, **kwargs)\r\n\r\nFile \"./awx/api/generics.py\" in post\r\n  974.             copy_name=serializer.validated_data.get('name', '')\r\n\r\nFile \"./awx/api/generics.py\" in copy_model_obj\r\n  918.         new_obj = model.objects.create(**create_kwargs)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\" in manager_method\r\n  85.                 return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\" in create\r\n  394.         obj.save(force_insert=True, using=self.db)\r\n\r\nFile \"./awx/main/models/credential/__init__.py\" in save\r\n  383.         super(Credential, self).save(*args, **kwargs)\r\n\r\nFile \"./awx/main/models/base.py\" in save\r\n  198.         super(PasswordFieldsModel, self).save(*args, **kwargs)\r\n\r\nFile \"./awx/main/models/base.py\" in save\r\n  316.         super(PrimordialModel, self).save(*args, **kwargs)\r\n\r\nFile \"./awx/main/models/base.py\" in save\r\n  164.         super(CreatedModifiedModel, self).save(*args, **kwargs)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\" in save\r\n  808.                        force_update=force_update, update_fields=update_fields)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\" in save_base\r\n  838.             updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\" in _save_table\r\n  924.             result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\" in _do_insert\r\n  963.                                using=using, raw=raw)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\" in manager_method\r\n  85.                 return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\" in _insert\r\n  1079.         return query.get_compiler(using=using).execute_sql(return_id)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\" in execute_sql\r\n  1112.                 cursor.execute(sql, params)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\" in execute\r\n  79.             return super(CursorDebugWrapper, self).execute(sql, params)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\" in execute\r\n  64.                 return self.cursor.execute(sql, params)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/utils.py\" in __exit__\r\n  94.                 six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n\r\nFile \"/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\" in execute\r\n  64.                 return self.cursor.execute(sql, params)\r\n\r\nException Type: DataError at /api/v2/credentials/5/copy/\r\nException Value: value too long for type character varying(512)\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n[background]\r\n\r\nA change happened recently (I still don't know the source of it) that caused activity stream entries to be produced for creation of inventory updates. (i.e. the action of updating an inventory)\r\n\r\n[bug]\r\n\r\nThese entries are not hooked up to show and link the related inventory update.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: any\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUpdate an inventory\r\n\r\nview activity stream\r\n\r\n##### EXPECTED RESULTS\r\n\r\nno unlinked entries\r\n\r\n##### ACTUAL RESULTS\r\n\r\nUI:\r\n\r\n![screen shot 2018-11-18 at 11 43 11 am](https://user-images.githubusercontent.com/1385596/48675480-42b1ca80-eb27-11e8-90f7-0d453f3d69de.png)\r\n\r\nneeds link to inventory update\r\n\r\nAPI:\r\n\r\n```json\r\n{\r\n    \"id\": 15580,\r\n    \"type\": \"activity_stream\",\r\n    \"url\": \"/api/v2/activity_stream/15580/\",\r\n    \"related\": {\r\n        \"actor\": \"/api/v2/users/1/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"actor\": {\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\",\r\n            \"id\": 1\r\n        }\r\n    },\r\n    \"timestamp\": \"2018-11-18T16:42:51.662086Z\",\r\n    \"operation\": \"create\",\r\n    \"changes\": {\r\n        \"cancel_flag\": false,\r\n        \"job_args\": \"\",\r\n        \"emitted_events\": 0,\r\n        \"source_regions\": \"\",\r\n        \"job_explanation\": \"\",\r\n        \"license_error\": false,\r\n        \"source_project_update\": null,\r\n        \"start_args\": \"hidden\",\r\n        \"celery_task_id\": \"\",\r\n        \"id\": 1085,\r\n        \"overwrite\": false,\r\n        \"controller_node\": \"\",\r\n        \"source_vars\": \"\",\r\n        \"modified_by\": \"admin\",\r\n        \"job_cwd\": \"\",\r\n        \"old_pk\": null,\r\n        \"instance_filters\": \"\",\r\n        \"created_by\": \"admin\",\r\n        \"failed\": false,\r\n        \"source_script\": \"Inventory Script - BellChampionshipẍ-39\",\r\n        \"group_by\": \"\",\r\n        \"inventory\": \"Inventory - TalkCommunication箣-812\",\r\n        \"unifiedjob_ptr\": \"2018-11-18 16:42:51.643909+00:00-1085-new\",\r\n        \"status\": \"new\",\r\n        \"description\": \"\",\r\n        \"overwrite_vars\": false,\r\n        \"schedule\": null,\r\n        \"started\": null,\r\n        \"elapsed\": \"0.0\",\r\n        \"finished\": null,\r\n        \"job_env\": \"{}\",\r\n        \"execution_node\": \"\",\r\n        \"polymorphic_ctype\": \"inventory update\",\r\n        \"inventory_source\": \"custom-group-P7bvTsFAey (Inventory - TalkCommunication箣 - 775)-775\",\r\n        \"name\": \"Inventory - TalkCommunication箣 - custom-group-P7bvTsFAey (Inventory - TalkCommunication箣 - 775)\",\r\n        \"created\": \"2018-11-18 16:42:51.643909+00:00\",\r\n        \"result_traceback\": \"\",\r\n        \"verbosity\": 1,\r\n        \"instance_group\": null,\r\n        \"source_path\": \"\",\r\n        \"modified\": \"2018-11-18 16:42:51.653447+00:00\",\r\n        \"unified_job_template\": \"custom-group-P7bvTsFAey (Inventory - TalkCommunication箣 - 775)-775\",\r\n        \"source\": \"custom\",\r\n        \"timeout\": 0,\r\n        \"launch_type\": \"manual\"\r\n    },\r\n    \"object1\": \"inventory_update\",\r\n    \"object2\": \"\",\r\n    \"object_association\": \"\"\r\n}\r\n```\r\n\r\nno related inventory update\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nA field for this exists in the models, so there's no schema change to make it work\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nParent WFJT Surveys apply extra_vars to child JTs, SJTs, and WFJTs in inconsistent ways.\r\n- Child SJTs inherit Parent WFJT Surveys as extra_vars even if Child SJT has extra_var prompting disabled. Each slice inherits the surveys as extra_vars.\r\n- Child JTs inherit Parent WFJT Surveys as extra_vars even if Child SJT has extra_var prompting disabled.\r\n- Child WFJTs do not inherit Parent WFJT Surveys as extra_vars. \"Grandchildren\" do not inherit the extra_vars even if the extra_var prompt setting is enabled.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.4.0-workflow-inventory\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a JT with extra_var prompting enabled. \"JT A\"\r\n1. Create a JT with extra_var prompting disabled. \"JT B\"\r\n1. Create a WFJT which contains both JT A and JT B. \"Sub WFJT\"\r\n1. Create a WFJT which contains Sub WFJT, JT A, JT B. \"Overall WFJT\"\r\n1. Modify \"Overall WFJT\" such that it contains survey values including a default value.\r\n1. Run \"Overall WFJT\" and specify survey extra_vars or use default survey extra_vars.\r\n\r\nNote: Sub WFJT and the grandchildren JT A and JT B are the only Jobs executed without inheriting the survey extra_vars.\r\n\r\n##### EXPECTED RESULTS\r\n1. extra_var survey prompting should be observed in the same way regardless of Job Type.\r\n1. extra_var surveys prompts should only apply to Jobs which have enabled extra_var prompting.\r\n\r\n##### ACTUAL RESULTS\r\nInconsistent application of extra_vars as surveys\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nCurrently, once a user's session is expired it hangs around in the db indefinitely, or until the admin runs `awx-manage clearsessions` manually.  \r\n\r\nThis should default to clearing expired sessions once a week.  Additionally, expired OAuth2 access tokens should also be cleared out.  \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis schedule could be added here: https://github.com/ansible/awx/blob/devel/awx/settings/defaults.py#L464\r\n\r\nAnd the related tasks would have to be written in `tasks.py`.  \r\n\r\n\r\nFor cleaning up revoked oauth2 tokens, call this: https://github.com/jazzband/django-oauth-toolkit/blob/5b51da74019046ef4c8c81c9975db029a2113d52/oauth2_provider/models.py\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nSee the below screenshot, make a workflow template that looks like this, where DELETED Is a deleted template that was previously there. When run, it goes indefinitely.\r\n\r\n![screenshot from 2018-11-15 14-56-52](https://user-images.githubusercontent.com/19942822/48578187-fd06bf00-e8e6-11e8-8933-303618bdf776.png)\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: `workflow-convergence` branch\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.0\r\n* Operating System: Fedora 28\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nImitate the screenshotted workflow above and run it. It stalls indefinitely."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### SUMMARY\r\nI have a playbook that works fine locally but when I put it in tower, it tells me a file doesn't exist, but it does. I added the path to \"expose to isolated jobs\" and I even tried turning off \"enable job isolation\" in tower but it still fails with same error. I assume its a permission thing, but I tried adding a few different things to my playbook including doing it all as root and still got the same result. That the file doesn't exist.  In tower I run my job template against localhost and I delegate to the node that has the tool installed that I need ran.\r\n\r\nI reached out in ansible slack channel and the guy who helped me told me it was a bug so that is why I'm opening this.\r\n\r\nI also thought maybe its tied to the mail module I'm trying to use.\r\n\r\n##### ENVIRONMENT\r\nAnsible Tower 3.2.1\r\nAnsible version: ansible 2.4.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nrun my playbook in ansible tower\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI get an email with my results and csv files attached that I create in my ansible playbook\r\n\r\n##### ACTUAL RESULTS\r\n\r\nLocally - it works\r\nTower - it says file doesn't exist.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nEXAMPLE OF MY PLAYBOOK (edited and shortened)\r\n\r\n- name: run cipa on the node that has it installed and get details on prod\r\n  delegate_to: '{{ delegate_host }}'\r\n  environment:\r\n    http_proxy: '{{ http_proxy_host }}'\r\n    https_proxy: '{{ https_proxy_host }}'\r\n  shell: cipa --no-border -H host, host, host, host, host -d ipa.domain.com -W '{{ dm_pw_prod }}' > /tmp/output_prod.csv\r\n  register: cipa_output_prod_detailed\r\n  tags: run_cipa_prod_detailed\r\n\r\n- name: run cipa on the node that has it installed and get short details on prod\r\n  delegate_to: '{{ delegate_host }}'\r\n  environment:\r\n    http_proxy: '{{ http_proxy_host }}'\r\n    https_proxy: '{{ https_proxy_host }}'\r\n  shell: cipa -n -H host, host, host, host, host -d ipa.domain.com -W '{{ dm_pw_prod }}'\r\n  failed_when: false\r\n  no_log: true\r\n  register: cipa_output_prod_short\r\n  tags: run_cipa_prod_short\r\n\r\n\r\n- name: email if fail is detected\r\n  delegate_to: '{{ delegate_host }}'\r\n  environment:\r\n    http_proxy: '{{ http_proxy_host }}'\r\n    https_proxy: '{{ https_proxy_host }}'\r\n  mail:\r\n    host: smtp.blah.com\r\n    port: 587\r\n    to: Lauren Santiago <lsantiag@blah.com>\r\n    from: noreply@blah.com\r\n    subject: IPA Consistency Report Detected Fails\r\n    body: |\r\n      PROD: \"{{ cipa_output_prod_short.stdout }}\"\r\n      Please see attached csv file for more details\r\n    attach:\r\n      - /tmp/output_prod.csv\r\n    secure: never\r\n  when: \"'CRITICAL' in cipa_output_prod_short.stdout\"\r\n  tags: email_fail\r\n\r\nError from tower looks like:\r\n\r\n{\r\n    \"_ansible_parsed\": true,\r\n    \"exception\": \"Traceback (most recent call last):\\n  File \\\"/tmp/ansible_eDhaVG/ansible_module_mail.py\\\", line 355, in main\\n    fp = open(file, 'rb')\\nIOError: [Errno 2] No such file or directory: \\\"['output_prod.csv',\\\"\\n\",\r\n    \"_ansible_no_log\": false,\r\n    \"_ansible_delegated_vars\": {\r\n        \"ansible_delegated_host\": \"blah@blah.com\",\r\n        \"ansible_host\": \"blah@blah.com\"\r\n    },\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"body\": \"Dev: \\\"CRITICAL - 15/17 checks passed\\\"\\nQA: \\\"WARNING - 16/17 checks passed\\\"\\nSTAGE: \\\"CRITICAL - 15/17 checks passed\\\"\\nPROD: \\\"CRITICAL - 13/17 checks passed\\\"\\nPlease see attached csv files for more details\\n\",\r\n            \"username\": null,\r\n            \"from\": \"noreply@blah.com\",\r\n            \"sender\": \"noreply@blah.com\",\r\n            \"to\": \"Lauren Santiago <lsantiag@blah.com>\",\r\n            \"cc\": null,\r\n            \"charset\": \"us-ascii\",\r\n            \"subject\": \"IPA Consistency Report Detected Fails\",\r\n            \"bcc\": null,\r\n            \"port\": 587,\r\n            \"headers\": null,\r\n            \"host\": \"smtp.blah.com\",\r\n            \"timeout\": 20,\r\n            \"subtype\": \"plain\",\r\n            \"password\": null,\r\n            \"attach\": \"['output_dev.csv', 'output_qa.csv', 'output_stage.csv', 'output_prod.csv']\",\r\n            \"secure\": \"never\"\r\n        }\r\n    },\r\n    \"rc\": 1,\r\n    \"msg\": \"Failed to send mail: can't attach file ['output_dev.csv',: [Errno 2] No such file or directory: \\\"['output_dev.csv',\\\"\"\r\n}\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAllow mapping of SAML attributes to map to team and organization names that do not match attribute_value.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nFor example,\r\n\r\nWhen mapping users with SAML attribute \"ansibleOrganizations\" and mapping attribute_value \"developer-unix-org\" to the organization \"Unix Developers\"\r\n```json\r\n{\r\n    \"saml_attr\": \"ansibleOrganizations\",\r\n    \"saml_admin_attr\": \"ansibleOrganizationAdmins\",\r\n    \"remove\": true,\r\n    \"remove_admins\": true,\r\n    \"org_map\": [\r\n    {\r\n        \"organization\": \"developer-unix-org\",\r\n        \"org_alias\": \"Unix Developers\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nWhen mapping users with SAML attribute \"ansibleGroups\" and mapping attribute_value \"unix-adms\" to the team \"Unix Administrators\":\r\n```json\r\n{\r\n    \"saml_attr\": \"ansibleGroups\",\r\n    \"remove\": true,\r\n    \"team_org_map\": [\r\n    {\r\n        \"team\": \"unix-adms\",\r\n        \"organization\": \"Default\",\r\n        \"team_alias\": \"Unix Administrators\"\r\n    }\r\n  ]\r\n}\r\n```"},{"labels":["api"],"text":"VMware: Missing Customvalue in inventories\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nMissing Customvalue in inventories hosts details.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.1\r\n* Operating System: Red Hat Enterprise Linux Server release 7.5 (Maipo)\r\n* Web Browser: Chrome 70.0.3538.102(Official Build) (64 bit)\r\n```\r\n# docker exec -it awx_task ansible --version\r\nansible 2.7.1\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Jul 13 2018, 13:06:57) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\n```\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n1. Add a new VMware Inventory item\r\n1. Create a new Inventory Source\r\n1. Add new Source Variables and include a properties YAML dictionary:\r\n    ```\r\n    ---\r\n    validate_certs: False\r\n    groupby_custom_field: True\r\n    properties:\r\n      prop01: name\r\n      prop02: guest.ipAddress\r\n      prop03: guest.guestId\r\n      prop04: customvalue\r\n    ```\r\n1. Start a new inventory scan\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n```\r\n<snip>\r\ncustomvalue:\r\n  - value: staging\r\n    key: 46\r\n  - value: sogi\r\n    key: 47\r\n<snip>\r\nsummary:\r\n  customvalue:\r\n    - value: staging\r\n      key: 46\r\n    - value: sogi\r\n      key: 47\r\n<snip>\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n1. Show Hosts Details\r\n\r\n- INVENTORIES/test/HOSTS/mikami_ansible_XXXXXXXX-XXXX-4XXX-8XXX-XXXXXXXXXXXX  \r\n    - HOST NAME: mikami_ansible_XXXXXXXX-XXXX-4XXX-8XXX-XXXXXXXXXXXX  \r\n    - VARIABLES: \r\n    ```\r\n    resourcepool:\r\n      _moId: resgroup-8\r\n      name: Resources\r\n    alarmactionsenabled: true\r\n    configissue: []\r\n    tag: []\r\n    <snip>\r\n    customvalue: []    <-----*** result empty ***\r\n    permission: []\r\n    parentvapp: null\r\n    recenttask: []\r\n    availablefield: []\r\n    overallstatus: green\r\n    ansible_host: 10.128.32.100\r\n    guest:\r\n      hostname: mikamiansible\r\n      toolsversionstatus: guestToolsUnmanaged\r\n      generationinfo: []\r\n      disk: []\r\n      guestoperationsready: true\r\n      guestfullname: CentOS 7 (64-bit)\r\n      toolsversion: '10309'\r\n      appstate: none\r\n      guestfamily: linuxGuest\r\n      toolsrunningstatus: guestToolsRunning\r\n      toolsversionstatus2: guestToolsUnmanaged\r\n      guestid: centos7_64Guest\r\n      net: []\r\n      appheartbeatstatus: appStatusGray\r\n      guestkernelcrashed: false\r\n      dynamictype: null\r\n      screen: {}\r\n      dynamicproperty: []\r\n      toolsstatus: toolsOk\r\n      powerpolicy: null\r\n      ipaddress: 10.128.32.100\r\n      gueststate: running\r\n      toolsinstalltype: guestToolsTypeOpenVMTools\r\n      interactiveguestoperationsready: false\r\n      ipstack: []\r\n      gueststatechangesupported: true\r\n      toolsupdatestatus: null\r\n    guestheartbeatstatus: green\r\n    name: mikami_ansible\r\n    rootsnapshot: []\r\n    configstatus: green\r\n    value: []\r\n    summary:\r\n      customvalue: []     <-----*** result empty ***\r\n      guest: {}\r\n      dynamictype: null\r\n      config: {}\r\n      dynamicproperty: []\r\n      storage: {}\r\n      vm: {}\r\n      quickstats: {}\r\n      runtime: {}\r\n      overallstatus: green\r\n    capability:\r\n    <snip>\r\n    ```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\n$ cat vmware_inventory.ini | grep -v \"^#\" | grep -v \"^$\"\r\n```\r\n[vmware]\r\nserver = <vcenter>\r\nusername = <username>\r\npassword = <password>\r\nvalidate_certs = False\r\ncache_max_age = 0\r\ngroupby_custom_field = True\r\n[properties]\r\nprop01=name\r\nprop02=guest.ipAddress\r\nprop03=guest.guestId\r\nprop04=customValue\r\n```\r\n$ ./vmware_inventory.py\r\n```\r\n{\r\n  \"all\": {\r\n    \"hosts\": [\r\n      \"XXXXXXXX-XXXX-4XXX-8XXX-XXXXXXXXXXXX\"\r\n    ]\r\n  },\r\n  \"_meta\": {\r\n    \"hostvars\": {\r\n      \"XXXXXXXX-XXXX-4XXX-8XXX-XXXXXXXXXXXX\": {\r\n        \"customvalue\": [\r\n          {\r\n            \"value\": \"staging\",\r\n            \"key\": 46\r\n          },\r\n          {\r\n            \"value\": \"sogi\",\r\n            \"key\": 47\r\n          }\r\n        ],\r\n        \"name\": \"mikami_ansible\",\r\n        \"ansible_uuid\": \"XXXXXXXX-XXXX-4XXX-8XXX-XXXXXXXXXXXX\",\r\n        \"guest\": {\r\n          \"guestid\": \"centos7_64Guest\",\r\n          \"ipaddress\": \"10.128.32.100\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"vmware_tag_Department_sogi\": {\r\n    \"hosts\": [\r\n      \"XXXXXXXX-XXXX-4XXX-8XXX-XXXXXXXXXXXX\"\r\n    ]\r\n  },\r\n  \"centos7_64Guest\": {\r\n    \"hosts\": [\r\n      \"XXXXXXXX-XXXX-4XXX-8XXX-XXXXXXXXXXXX\"\r\n    ]\r\n  },\r\n  \"vmware_tag_Environment_staging\": {\r\n    \"hosts\": [\r\n      \"XXXXXXXX-XXXX-4XXX-8XXX-XXXXXXXXXXXX\"\r\n    ]\r\n  }\r\n}\r\n```\r\n![awx_cav](https://user-images.githubusercontent.com/12627100/48471241-ccffe300-e836-11e8-9a5d-1667967a03af.png)\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\nBug we ran into during development, just filing to document it for posterity in case it comes up again.\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: `workflow-convergence` feature branch\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nHave a convergence node with multiple parents.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nAll parent jobs should finish before convergence node job starts (or parent node is marked DNR).\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nFirst triggering job to complete starts convergence node job.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nFixed during development with\r\ne11a90c5c89b3b3781f366ada111854a83366f82\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report -- for WIP feature branch\r\n\r\nMostly documenting for posterity in case this comes back to bite us\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: `workflow-convergence` feature branch\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n```\r\n\r\n\r\n       +-----------------+                                                    +--------------+\r\n       |    successful JT|                         S                          |              |\r\n       |                 +---------------------------------------------------->   anything   |\r\n       |                 |                                                    |+---->        |\r\n       +---------------+-+                                                    +|-------------+\r\n                       |                                                       |\r\n                       |                                                      F|\r\n                       |                                                       |\r\n                       |                                             +---------|-+\r\n                      S|                                      F      |         | |\r\n                       |    +---------------------------++----------->   anything|\r\n                       |    |                           ||           |           |\r\n                       |    |                           ||           +-----------+\r\n                       |    |          Successful JT    |+\r\n                       +--->|                           |\r\n                            |                           |\r\n                            +---------------------------+\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\nRoot node runs. Successful JT runs. Failure child gets marked DNR, convergence node runs\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nRoot node runs. Successful JT runs. Failure child never gets marked DNR, convergence node never runs, WF hangs in \"running\" state and never completes.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nFixed by https://github.com/ansible/awx/commit/147e8db9b491617170c79ee9f2334c6ecce87de5"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWe use a custom script to import the inventory. The problem is that empty ansible groups are imported as `group` AND as `host`.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.1\r\n* Operating System: Redhat\r\n* Web Browser: Crome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Set `CUSTOM_EXCLUDE_EMPTY_GROUPS = False` in `/etc/tower/settings.py` \r\n- Create a inventory file (ini)\r\n```\r\n[group-empty]\r\n# None yet\r\n\r\n[group-full]\r\nhost-1\r\n```\r\n- Create a inventory (from custom script)\r\n- Source Script:\r\n```\r\n#!/bin/bash\r\nANSIBLE_INVENTORY_EXPORT=false ANSIBLE_CONFIG=/etc/ansible/ansible.cfg ANSIBLE_INVENTORY_ENABLED=ini,yaml,host_list,script,auto ansible-inventory -i /var/lib/awx/projects/io-ansible/prod --list --vault-password-file=/var/lib/awx/projects/io-ansible/vault_password.txt'\r\n```\r\n- Run the inventory import job\r\n\r\n##### EXPECTED RESULTS\r\n\r\n`group-empty` is imported as an empty group.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`group-empty` is listed as group as well as an host (as host that belongs to the group). That causes issues during ansible playbook runs.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nLooks similar to this issue:\r\nhttps://github.com/ansible/awx/issues/1966\r\n\r\nBut setting only the flag does not work. If we add a sed command to add an empty host array, the import works as expected:\r\n\r\n```\r\n#!/bin/bash\r\nANSIBLE_INVENTORY_EXPORT=false ANSIBLE_CONFIG=/etc/ansible/ansible.cfg ANSIBLE_INVENTORY_ENABLED=ini,yaml,host_list,script,auto ansible-inventory -i /var/lib/awx/projects/io-ansible/prod --list --vault-password-file=/var/lib/awx/projects/io-ansible/vault_password.txt | sed -E 's/\\{\\}/\\{\\\"hosts\\\": \\[\\]\\}/g'\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nOne step would be to disable sync:ing of host facts which we don't use.\r\nUnfortunately it looks like it's hardcoded to be enabled:\r\nhttps://github.com/ansible/awx/blob/devel/awx/main/tasks.py#L1929\r\n\r\nSo it would be nice to have asatellite6_want_facts parameter that could be set, similar to satellite6_want_hostcollections.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Security Feature Request\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIn multi-tenant/multi-project environments, multiple administrators might have access to the same awx/tower host. The Inventory Script functionality is a known method of executing code and is used by awx-core for inventory management (per #ansible-awx freenode irc).\r\n\r\nIt would be helpful for more secure environments to differentiate between internal/core inventory scripts and user-provided scripts for the purpose of being able to disable the later.\r\n\r\nA simple configuration 'allow_user_inventory_scripts' would be optimal (setting to False would prevent submitting/copying inventory scripts or using them within Inventories (\"Custom Script\").\r\nThis should hold true for UI or API usage.\r\n\r\n##### ADDITIONAL INFORMATION\r\nTested and confirmed in Tower 3.3.1 and AWX 2.1.0."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n- API\r\n\r\n##### SUMMARY\r\nSummary fields are not searchable using the filters provided in AWX/Tower.\r\n\r\nFor example, when a user has a long list of permissions, it may be helpful for admins to be able to search permissions on a user by name, or type rather than just ID. At this time, this is not filterable:\r\n```\r\n \"summary_fields\": {\r\n                \"type\": \"object\",\r\n                \"label\": \"Summary fields\",\r\n                \"help_text\": \"Data structure with name/description for related resources.\",\r\n                \"filterable\": false\r\n```\r\n##### ADDITIONAL INFORMATION\r\nThis could potentially get lumped into https://github.com/ansible/awx/issues/402\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n \r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen we click on Organizations, we can see multiple organizations. Each Organization shows 6 items - Users, Teams, Inventory, Project, Admin & Job Templates.\r\n\r\nExpecting Workflow Template as a item in the organization.\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - Installer\r\n\r\n##### SUMMARY\r\nBy default, the logging driver is ```json-file``` and destroying a container will also remove logs. \r\nChanging it to ```journald``` for instance would allow us to access the logs of destroyed containers, on top of everything that is already possible with the default logging driver. In particular, the ```docker logs``` command remains available with ```journald``` (and only that one).\r\nThis feature can be made **optional** in ```installer/inventory``` with an option within the ```[all:vars]``` section:\r\n```\r\nlogging_driver=journald\r\n```\r\nThe user could even choose another logging driver such as ```syslog``` or ```splunk``` (the whole list of supported logging drivers is available [here](https://docs.docker.com/config/containers/logging/configure/#supported-logging-drivers)), if the user is notified somewhere that the ```docker logs``` command does NOT remain available for any other logging driver than ```journald```.\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis feature is enabled in the ```docker-compose.yml``` file for ```journald``` for instance with:\r\n```\r\n  web:\r\n    logging:\r\n        driver: journald\r\n...\r\n  task:\r\n    logging:\r\n        driver: journald\r\n...\r\n  rabbitmq:\r\n    logging:\r\n        driver: journald\r\n...\r\n  memcached:\r\n    logging:\r\n        driver: journald\r\n...\r\n  postgres:\r\n    logging:\r\n        driver: journald\r\n...\r\n```\r\nThe last entry depends on whether postgresql server is internal or external."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIf we set timeout to the job template and launch it and when it failed with the timeout error, we can confirm the cause of this from the `job_explanation` value from the Jobs API endpoint, but there is no way to confirm it from log files.\r\nAlso even if we use logging aggregation, there is no information about this timeout error and It would be ideal to more easily identify the cause of job failure are currently being acted upon.\r\n\r\nIt would be ideal to more easily identify the cause of job failure are currently being acted upon from Tower's local logs and external logging aggregation system.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI think it would be better if we can add an `rc` for these jobs, Or we can append `job_explanation` to the logs that we export to the external logging aggregators."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n(possibly feature request)\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nThe user activity stream does not show *User Type* changes from \"Normal User\" <-> \"System Auditor\".\r\n\r\nChanges from \"[Normal User|System Auditor]\" <-> \"System Administrator\" are present in the activity log\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.7.1\r\n* Operating System: Macos\r\n* Web Browser: Chrome\r\n\r\nAlso present in Ansible Tower 3.3.1 on RHEL7\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Browse to a user account where *User Type* is a \"Normal User\"\r\n* Change *User Type* to \"System Auditor\" and save\r\n* Browse to activity stream for user\r\n\r\n##### EXPECTED RESULTS\r\n\r\nChange in *User Type* from \"Normal User\" -> \"System Auditor\" is shown in activity stream\r\n\r\n##### ACTUAL RESULTS\r\n\r\nChange in *User Type* is not shown in activity stream\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nAnsible is implementing become plugins here: https://github.com/ansible/ansible/pull/38861\r\n\r\nAWX should be able to support this. (We should probably drop the hardcoded list).\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nIn the Workflow Result Viewer, real-time events of WFs in WFs are out of order. In the simplest case, the \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.4.0\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThe simplest case:\r\n1. Create a WF-in-WF scenario with chatty_tasks\r\n⋅⋅1. `WFJT A` which contains chatty_tasks JT\r\n⋅⋅1. `WFJT B` which contains 3 chained `WFJT A` jobs\r\n1. Run `WFJT B` and note that WF job events return out of order. i.e. The second `WFJT A` can appear to complete before the first.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWFJT results to come back in the order they are executed and finished\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWFJT B \"finishes\" before WFJT A chained A -> B\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<img width=\"1540\" alt=\"screen shot 2018-11-06 at 9 52 56 am\" src=\"https://user-images.githubusercontent.com/12446869/48072125-d2f82300-e1a9-11e8-868a-7cae337291ba.png\">\r\n\r\n\r\n![outtaorder](https://user-images.githubusercontent.com/12446869/48072036-b22fcd80-e1a9-11e8-8113-3aa9ef667de9.gif)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAnsible-inventory fails due to missing modules.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n* AWX install method: docker on Linux\r\n* Ansible version:  2.7.1\r\n* Operating System: CentOS \r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create new Inventory\r\n2. Create Source\r\n3. Select \"Sourced from a Project as source\"\r\n4. Choose a inventory file (YAML file) out of your GIT repo\r\n5. Sync\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt should import the hosts listed in the inventory file.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe job fails due to missing ansible modules. See below error log for more details.\r\n##### ADDITIONAL INFORMATION\r\n\r\nError log:\r\n```\r\n    1.543 INFO     Updating inventory 2: Loadbalancer\r\n    1.562 INFO     Reading Ansible inventory source: /var/lib/awx/projects/_6__ccloud_git/ansible/inventory/eu-de-1\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx==2.0.1', 'console_scripts', 'awx-manage')()\r\n  File \"/usr/lib/python2.7/site-packages/awx/__init__.py\", line 116, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 994, in handle\r\n    self.is_custom)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 245, in load_inventory_source\r\n    is_custom=is_custom).load()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 180, in load\r\n    data = self.command_to_json(base_args + ['--list'])\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 163, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\nstderr:\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/ansible-inventory\", line 40, in <module>\r\n    from ansible.errors import AnsibleError, AnsibleOptionsError, AnsibleParserError\r\nImportError: No module named errors\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nClicking the + sign and adding team-wide permissions doesn't update the user permissions at all, or at least it does so inconsistently. \r\n\r\n![screenshot from 2018-11-05 16-12-20](https://user-images.githubusercontent.com/19942822/48027019-a4c90380-e115-11e8-8cfe-cf1db5089a40.png)\r\n\r\ncalls to /roles return a 204 no content, always, regardless of success or failure. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.1-225-g895a567ed\r\n* AWX install method: docker compose on fedora\r\n* Ansible version:  2.7\r\n* Operating System: fedora\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate an org, put a team inside of it. Create a user, and put that user inside the team as well.\r\n\r\nGo to Organizations from the left nav > click your org > go to the permissions tab and open the modal for adding permissions.\r\n\r\nClick the teams tab for team-wide permissions, and attempt to add Read (or any) permission to the whole team.\r\n\r\n##### EXPECTED RESULTS\r\nThe user, inside of the team, is updated on the list with read permissions.\r\n\r\n##### ACTUAL RESULTS\r\nThe user list of permissions is not updated."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nError:\r\n\r\n> You cannot grant private credential access to another user\r\n\r\nhappens on disassociation as well as association\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn the UI, create a new private credential as a non-superuser\r\n\r\nattempt to remove your own permission to this thing\r\n\r\n##### EXPECTED RESULTS\r\n\r\nerror message that makes sense\r\n\r\n##### ACTUAL RESULTS\r\n\r\n> You cannot grant private credential access to another user\r\n\r\nIn API response\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nwill file UI issue as a separate issue.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nUser with admin role to job template gets the UI stuck if they try to add a new label.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a fresh user\r\n\r\n - make user admin to the JT\r\n   - this implies not giving them any permission to the JT's project or inventory, or the organization thereof\r\n - add a label to the JT in the UI\r\n - click the save button\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNot an infinite working gear\r\n\r\n##### ACTUAL RESULTS\r\n\r\nInfinite working gear\r\n\r\n![screen shot 2018-11-05 at 3 23 17 pm](https://user-images.githubusercontent.com/1385596/48024728-629cc380-e10f-11e8-81f2-eba64366d8e6.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAPI gives 403 for the POST to `/api/v2/job_template/N/labels/`. This might be an API bug, but it's apparently an unhandled case for the UI, which makes me say _this_ is a UI bug.\r\n\r\nI'll look, but the label permissions are probably related to organization of the labels...\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAdd check box to skip vaulted variables and variable files when importing inventory into AWX using an SCM inventory or similar\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nAdd option to select ANSIBLE ENVIRONMENT for ad-hoc commands in Tower/AWX\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nJob templates with job tags do not appear to be running correctly. What I mean by this is specificially:\r\n\r\n1) The std out field for these jobs is empty:\r\n<img width=\"963\" alt=\"screen shot 2018-11-05 at 11 00 09 am\" src=\"https://user-images.githubusercontent.com/2293210/48009572-03788800-e0ea-11e8-90c0-6f43fb71b4d3.png\">\r\n\r\n2) The job is not being listed under the Inventory > Hosts > host x > Completed jobs list.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a JT.\r\n2. Assign a job tag to that JT.\r\n3. Launch JT.\r\n4. Observe the std out area and check against the host completed jobs list.\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nI expect the std out area to show the messages of the JT and the host completed jobs list to display the JT.\r\n##### ACTUAL RESULTS\r\nNo std out messages are shown and the JT is not listed in the completed jobs list.\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nfor list view, searches should include the playbook in places to look\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nExample of URL expected to work:\r\n\r\n`/api/v2/unified_job_templates/?page_size=20&order_by=name&type=workflow_job_template,job_template&job_template__search=debug.yml`\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nSince survey answers are now encrypted inside of their entry, we do not need the corresponding survey_passwords field to track which values should be redacted\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nSince upgrading to AWX 2.1.0, coming from 2.0.0 the inventory is not working like it should. It should include all group vars where the host is part of, but it only includes the one that it directly configured in.\r\n\r\n> group vars are located inside `group_vars/*.yml`\r\n\r\nExample hosts file:\r\n\r\n```yaml\r\n[parent:children]  <--- this variables are not showing\r\nchild_1\r\n\r\n[child_1]    <--- this variables are showing \r\nhost_1      <--- this variables are showing\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.1.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.1\r\n* Operating System: Centos 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nFirst configure an inventory that sources from git repo in AWX and use that inventory in AWX and CLI. \r\n\r\nExample:\r\n\r\n```bash\r\n# Using Tower inventory \r\n$ ansible-inventory -i /tmp/tower_inventory.yml --host child_1\r\n{\r\n    \"maintenance_reboot\": \"no\", \r\n    \"remote_tower_enabled\": \"true\", \r\n    \"remote_tower_id\": 1366\r\n}\r\n\r\n# Using Normal inventory \r\n$ ansible-inventory -i ../inventory/production/ --host child_1 \r\n{\r\n    \"env\": \"prod\", \r\n    \"environment\": \"production\", \r\n    \"maintenance_ansible_post_reboot_task\": \"\", \r\n    \"maintenance_ansible_post_update_task\": \"\", \r\n    \"maintenance_ansible_pre_reboot_task\": \"\", \r\n    \"maintenance_ansible_pre_update_task\": \"\", \r\n    \"maintenance_ansible_task\": \"generic\", \r\n    \"maintenance_interval\": \"weekly\", \r\n    \"maintenance_reboot\": false, \r\n    \"maintenance_serial\": false, \r\n    \"maintenance_strategy\": \"manual\", \r\n    \"maintenance_weekday\": \"tuesday\", \r\n    \"maintenance_window\": \"night\", \r\n    \"sysid_documentation\": \"none specified\", \r\n    \"sysid_environment\": \"{{ environment }}\", \r\n    \"sysid_primary_contact\": \"Operations\"\r\n}\r\n\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe above command should give the same output (except the remote_tower variables)\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSee STEPS TO REPRODUCE\r\n\r\n##### ADDITIONAL INFORMATION\r\n-"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n \r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nIn some cases long run jobs may hang on specific hosts and it would be ideal to more easily identify which hosts are currently being acted upon. \r\n\r\n##### ADDITIONAL INFORMATION\r\nCurrently the only way to debug problem hosts is to go to the command line and check for processes which are still active with hosts.\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCan't search with unicode\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate an inventory\r\n\r\nName it \r\n\r\n> 뜓\r\n\r\nSearch activity stream and inventory list for this inventory\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSearches get hits.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n0 results\r\n\r\nlots of details to report here...\r\n\r\n - `/api/v2/inventories/?name=뜓`  1 result (good)\r\n - `/api/v2/inventories/?search=뜓` 1 result (good)\r\n - `/api/v2/activity_stream/?search=ub713`  > 1 result (umm...)\r\n - `/api/v2/activity_stream/?search=뜓`  0 result (bad)\r\n - `/api/v2/activity_stream/?changes__icontains=뜓` 0 result (bad)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIn shell\r\n\r\n```\r\nIn [1]: Inventory.objects.filter(name=u'\\ub713')\r\nOut[1]: <QuerySet [<Inventory: 뜓-581>]>\r\n\r\nIn [2]: ActivityStream.objects.filter(changes__icontains=u'\\ub713')\r\nOut[2]: <QuerySet []>\r\n\r\nIn [14]: ActivityStream.objects.filter(changes__icontains='\\ub713').count()\r\nOut[14]: 56\r\n\r\nIn [15]: ActivityStream.objects.filter(changes__icontains=u'\\ub713').count()\r\nOut[15]: 0\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nThere are a number of places in our settings configuration where the user is required to enter properly formatted JSON, python data structures (lists, dictionaries), or combinations thereof.\r\n\r\nIdeally, we would have a cleaner settings paradigm that allows for easier user entry and constructs properly-formatted data structures to pack to the backend.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nSchedules can have an end-by date, or an \"end after 20 runs\" configuration.\r\n\r\nIt may be useful to have a process (management job?) that automatically deletes all \"expired\" schedules.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nNew outh2 token which generating from /api/o/token cannot apply new expiry seconds setting\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.3.1 (latest version which released on 25/Oct/2018)\r\n* AWX install method: Linux (Centos 7)\r\n* Ansible version:  2.7.1\r\n* Operating System: Windows 10\r\n* Web Browser: Chrome\r\n\r\n* Authentication setting (From api/v2/settings/):\r\n{\r\n    \"SESSION_COOKIE_AGE\": 1800,\r\n    \"SESSIONS_PER_USER\": -1,\r\n    \"AUTH_BASIC_ENABLED\": true,\r\n    \"OAUTH2_PROVIDER\": {\r\n        **\"ACCESS_TOKEN_EXPIRE_SECONDS\": 86400,**\r\n        \"AUTHORIZATION_CODE_EXPIRE_SECONDS\": 1800\r\n    },\r\n    \"ALLOW_OAUTH2_FOR_EXTERNAL_USERS\": false,\r\n    \"AUTHENTICATION_BACKENDS\": [\r\n        \"awx.sso.backends.TACACSPlusBackend\",\r\n        \"django.contrib.auth.backends.ModelBackend\"\r\n    ],\r\n    \"SOCIAL_AUTH_ORGANIZATION_MAP\": null,\r\n    \"SOCIAL_AUTH_TEAM_MAP\": null,\r\n    \"SOCIAL_AUTH_USER_FIELDS\": null\r\n}\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create application and copy client id and client secret.\r\n2. Request new OAuth2 token by postman / curl with login credential (normal user), client id and secret\r\n3. A token will be generated if API call successful\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nNew OAuth2 token should be expired after 1 day\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNew OAuth2 token still remain the old setting as default one, which will expire after **1000 YEARS!**\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n![new_token_time](https://user-images.githubusercontent.com/22712192/47777964-cd758580-dd30-11e8-8e72-ed10dd391e91.png)\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nIf a SLT is converted to a regular job type, it cannot be relaunched from the Workflow Job view without error\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.4.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a SJT with multiple slices\r\n2. Run Job\r\n3. Convert SJT to single JT\r\n4. Attempt to re-launch SJT from Workflow view\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1. Run JT or error message\r\n\r\n##### ACTUAL RESULTS\r\n\r\nInert button\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nXHR POST failed loading /api/v2/workflow_jobs/312/relaunch/\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nwhen using AWS as a inventory source , only EC2 instances with public IP addresses are imported\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.1\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.7.1\r\n* Operating System: Centos7\r\n* Web Browser: Chrome\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIt would be nice if job templates and workflow job templates could specify a \"resource lock\"\r\n\r\nEx.\r\nI have 10 jobs that can do operations on one F5 pool. \r\nI only want one of those to be able to run at a time. \r\nI can create a \"resource lock\" and assign it to each job. \r\nWhen any job runs, it grabs the lock and the other jobs have to wait."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n \r\n\r\n##### SUMMARY\r\n**os_server create task will fail if the scheduler_hints parameter is defined**\r\n\r\nI am trying to create an instance in openstack(Queens) and it used to work fine until I added scheduler_hints parameter to define anti_affinity group.\r\nAfter that, I got the error below:\r\n    \"msg\": \"BadRequestException: Unknown error\"\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.0\r\n* Operating System: Centos 7.4\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nadd a new task into your playbook to provision new instance in openstack with scheduler_hints parameter:\r\n  os_server:\r\n    name: \"{{ instance_name }}\"\r\n    boot_volume: \"{{ instance_boot_volume  }}\"\r\n    cloud: \"{{ cloud }}\"\r\n    scheduler_hints:\r\n      group: \"{{group_uid}}\"\r\n    key_name: \"{{ key_name }}\"\r\n    meta:\r\n      hostname: \"{{ instance_name }}\"\r\n      groups: \"{{ instance.0 | json_query(query_meta) }}\"\r\n    availability_zone: nova\r\n    nics: \"net-id=MYNETID\"\r\n    flavor: \"m4.xlarge\"\r\n    auto_ip: yes\r\n    security_groups: default\r\n    verify: false\r\n\r\n##### EXPECTED RESULTS\r\nAn instance should be created\r\n\r\n##### ACTUAL RESULTS\r\n\r\n{\r\n    \"_ansible_parsed\": true,\r\n    \"exception\": \"WARNING: The below traceback may *not* be related to the actual failure.\\n  File \\\"/tmp/ansible_os_server_payload__8xXz9/__main__.py\\\", line 734, in main\\n    _create_server(module, cloud)\\n  File \\\"/tmp/ansible_os_server_payload__8xXz9/__main__.py\\\", line 524, in _create_server\\n    **bootkwargs\\n  File \\\"<decorator-gen-30>\\\", line 2, in create_server\\n  File \\\"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/openstack/cloud/_utils.py\\\", line 374, in func_wrapper\\n    return func(*args, **kwargs)\\n  File \\\"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/openstack/cloud/openstackcloud.py\\\", line 6763, in create_server\\n    self.compute.post(endpoint, json={'server': kwargs}))\\n  File \\\"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/openstack/_adapter.py\\\", line 95, in _json_response\\n    exceptions.raise_from_response(response, error_message=error_message)\\n  File \\\"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/openstack/exceptions.py\\\", line 205, in raise_from_response\\n    http_status=http_status, request_id=request_id\\n\",\r\n    \"_ansible_no_log\": false,\r\n    \"changed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"auth_type\": null,\r\n            \"availability_zone\": \"nova\",\r\n            \"image\": null,\r\n            \"image_exclude\": \"(deprecated)\",\r\n            \"flavor_include\": null,\r\n            \"cacert\": null,\r\n            \"meta\": {\r\n                \"hostname\": \"worker1\",\r\n                \"groups\": \"freeipaclient\"\r\n            },\r\n            \"flavor\": \"c5.large\",\r\n            \"security_groups\": [\r\n                \"default\"\r\n            ],\r\n            \"scheduler_hints\": {\r\n                \"group\": \"56559db3-9c84-4596-8ea7-03ebc316fb87\"\r\n            },\r\n            \"boot_from_volume\": false,\r\n            \"userdata\": null,\r\n            \"network\": null,\r\n            \"nics\": [\r\n                \"net-id=bc27fc27-65b9-4cb3-a749-f0a8ed7743fc\"\r\n            ],\r\n            \"floating_ips\": null,\r\n            \"flavor_ram\": null,\r\n            \"volume_size\": false,\r\n            \"state\": \"present\",\r\n            \"auto_ip\": true,\r\n            \"config_drive\": false,\r\n            \"region_name\": null,\r\n            \"key_name\": \"os-ansible\",\r\n            \"api_timeout\": null,\r\n            \"auth\": null,\r\n            \"boot_volume\": \"worker1_volume1\",\r\n            \"key\": null,\r\n            \"interface\": \"public\",\r\n            \"terminate_volume\": false,\r\n            \"wait\": true,\r\n            \"name\": \"worker1\",\r\n            \"timeout\": 180,\r\n            \"delete_fip\": false,\r\n            \"cert\": null,\r\n            \"volumes\": [],\r\n            \"verify\": false,\r\n            \"floating_ip_pools\": null,\r\n            \"reuse_ips\": true\r\n        }\r\n    },\r\n    \"msg\": \"BadRequestException: Unknown error\",\r\n    \"extra_data\": null\r\n}\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"See: https://github.com/ansible/ansible/pull/47684\r\n\r\nTargeting Ansible 2.8 we'll need to at least add the shell of support for it."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n- UI\r\n\r\n##### SUMMARY\r\nFor some users (it seems like only Chrome on OSX) that they're required to clear their cache every time \r\nthey log in to the UI, otherwise they get complaints of CSRF tokens not being valid on post requests.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.0\r\n* AWX install method: Docker\r\n* Ansible version:  2.3.2\r\n* Server Operating System: Ubuntu 16.04 \r\n* Client Operating System: OSX High Sierra\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n- Log into AWX\r\n- Navigate to any form with an associated POST action, EG a job template\r\n- Click the button to perform an API Post (click run)\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n- Action is performed (job is started) \r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n- Modal Window pops up stating that your CSRF token is missing or invalid \r\n- User logs out, clears the browser cache/cookies\r\n- User logs back in, everything works as expected\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThis started happening with the upgrade to 2.0.0, it didn't happen in the previous version we ran (1.0.3).\r\nThe database is from a former Tower installation, that was re-used for AWX.  \r\n\"Wiping the database and starting from scratch\" isn't an option.  \r\n\r\n<img width=\"601\" alt=\"screen shot 2018-10-26 at 10 20 34 am\" src=\"https://user-images.githubusercontent.com/3720321/47574533-cb18c300-d90d-11e8-99d9-059a34a8919a.png\">\r\n<img width=\"554\" alt=\"screen shot 2018-10-26 at 10 20 43 am\" src=\"https://user-images.githubusercontent.com/3720321/47574534-cb18c300-d90d-11e8-8714-8e89b0b51d3c.png\">"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\ncreating NT makes 2 entries where a user would probably prefer 1\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate notification template with some private data\r\n\r\nview activity stream\r\n\r\n##### EXPECTED RESULTS\r\n\r\njust a creation entry\r\n\r\n##### ACTUAL RESULTS\r\n\r\nsome examples, including a copy action\r\n\r\n<img width=\"1221\" alt=\"screen shot 2018-10-26 at 9 14 58 am\" src=\"https://user-images.githubusercontent.com/1385596/47568718-db29a600-d8ff-11e8-967d-415c47472233.png\">\r\n\r\nAs you click on one of the 2nd entries in UI:\r\n\r\n```json\r\n{\r\n \"notification_configuration\": [\r\n  \"{\\\"username\\\": \\\"fooooooo\\\", \\\"sender\\\": \\\"asdf@invalid.com\\\", \\\"recipients\\\": [\\\"foo@invaid.com\\\"], \\\"use_tls\\\": false, \\\"host\\\": \\\"foo.invalid\\\", \\\"use_ssl\\\": false, \\\"password\\\": \\\"\\\", \\\"port\\\": 8888}\",\r\n  \"{\\\"username\\\": \\\"fooooooo\\\", \\\"sender\\\": \\\"asdf@invalid.com\\\", \\\"recipients\\\": [\\\"foo@invaid.com\\\"], \\\"use_tls\\\": false, \\\"host\\\": \\\"foo.invalid\\\", \\\"use_ssl\\\": false, \\\"password\\\": \\\"$encrypted$\\\", \\\"port\\\": 8888}\"\r\n ]\r\n}\r\n```\r\n\r\nBetter to not create this entry\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nKinda related https://github.com/ansible/awx/issues/1500\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\nPlaybooks\r\n\r\nhttps://github.com/ansible/awx/blob/9bca937fadc110fbde19571cc1341c02032d0a7a/awx/playbooks/project_update.yml#L151\r\n\r\n##### SUMMARY\r\nSupport Mazer for role restores.\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis appears to be the new standard, ansible documentation recommends Mazer. \r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI (?)\r\n\r\n##### SUMMARY\r\nIn the actual UI, the \"organizations\" field is mandatory, and when you create a user, the user is then associated with the organization requested. However, when making a direct POST, we can't get the organization to associate with the user -- the user is successfully created, but then is not linked to any organizations.\r\n\r\n##### ENVIRONMENT\r\n____________________________ \r\n<  AWX 2.0.1-165-g695c7ade8  >\r\nAnsible 2.7.0 \r\n* Operating System: Fedora\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUse this POST, which was copied from a successful call from the UI to make a user: \r\n```{email: \"null@ansible.ccom\"\r\nfirst_name: \"A\"\r\nis_superuser: false\r\nis_system_auditor: false\r\nlast_name: \"a\"\r\norganization: 1\r\npassword: \"a\"\r\npassword_confirm: \"a\"\r\nuser_type: {type: \"normal\", label: \"Normal User\"}\r\nusername: \"aaaaa\"}\r\n```\r\n##### EXPECTED RESULTS\r\n\r\nThe user is associated with the \"Default\" org.\r\n##### ACTUAL RESULTS\r\nThe user is not associated with any orgs."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Enhancement\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently, when adding a new user (and across other form fields where character maximums are only passively reinforced), you can flood the text field with characters, but then an error message appears after creating the user fails: \r\n![screenshot from 2018-10-25 09-36-07](https://user-images.githubusercontent.com/19942822/47504499-5cb70080-d83a-11e8-83f0-0ee5771ba7cf.png)\r\n\r\nIt would be good to either:\r\n\r\n1. Show this message automatically when the character count goes past the limit on these fields\r\nor\r\n2. restrict the character count inside the box, preventing the user from typing past that limit at all.\r\n\r\nIn my opinion, option 1 is clearer to the user. "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Need the ability to create a smart inventory based on regular expression\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nA common practice is to use a standardized hostname for nodes in an inventory. A regular expression can be used against some attribute (like inventory_hostname) to have dynamically created groups. A use case would be for bootstrapping of a node. \r\n\r\nConsider the following workflow:\r\n- An admin could provision a node 'devweb01'\r\n- The node is added to Ansible Tower's inventory through the dynamic inventory\r\n- The node is automatically added to the group development_webservers because it matches the regular expression associated with that group\r\n- Ansible configures the node with appropriate roles and variable due to its presence in the development_webservers group \r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n- The current UI makes it difficult to track variables set on GROUPS in an INVENTORY. It would be helpful if groups were presented as a tree to visualize group and subgroup relationships.\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n Ansible Tower allows the user to create groups and associate groups with other groups from the UI. It is difficult to track down a nodes variables when it belongs to multiple groups. For example if I have a group called 'linux' and multiple sub-groups below that with overriding variables it is difficult to tell which groups are subgroups of 'linux' which would inherit any variable set on the 'linux' group. A current workaround is to put the parent names in the name of the group( ie linux_webservers). This becomes even more challenging at more than 2 levels of groups.\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIf an inventory update emits an incredibly long single line (>1000 characters), then the API & UI will show a \"...\" character. This is fine for the overall standard out page, but it turns out there's no way to obtain the hidden text in the \"...\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nJob events will show full standard out in the detail view (but not the list view)\r\n\r\nInventory update events have no detail view. The API part of this can probably be resolved by adding it.\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nFor current version, if we need to launch a job with limit option, we can set the limit on ui or pass limit param to API, but we don't limit that `You must fillout the limit option, otherwise this job template could NOT be launched`.\r\n\r\nFor security reason, I think it's indeed needed.\r\nThanks.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAWX 1.0.7.2\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nWhen you import roles into AWX, you need to run the playbook that calls each role. The result is that every roles output is displayed in the stdout window.\r\n\r\nIt would be great if we could take all roles under the `roles:` heading and split them into Workflows. This would provide a more user friendly experience and make troubleshooting much easier.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nIf we look at the role deployment file:\r\n~~~\r\n- hosts: status_up \r\n  become: True\r\n  become_method: sudo\r\n  vars_files:\r\n    - base_config/vars/main.yml\r\n    - ntp_clients/vars/main.yml\r\n    - snmp_hosts/vars/main.yml\r\n    - zabbix_clients/vars/main.yml\r\n\r\n  roles:\r\n    - foreman_clients\r\n    - base_config\r\n    - ntp_clients\r\n    - snmp_hosts\r\n    - zabbix_clients\r\n~~~\r\n\r\nWe can see that this playbook calls the roles specified under `roles:`\r\n\r\nIf I manually break them up into individual playbooks, I'm able to create a workflow within AWX that looks much better:\r\n![image](https://user-images.githubusercontent.com/5205987/47397302-02526d00-d772-11e8-8b93-3bb87a16b8a9.png)\r\n\r\n\r\nIf we could provide the user with an option to do this within the UI. I believe it would improve user experience with AWX."},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Error dynamic inventory parsing.\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nI'm basically following the steps mentioned in ansible servicenow integration official repo to integrate servicenow and get hosts from CMDB. I have all the dependencies installed ( python-configparser) and my ansible version is 2.7.0 and my tower version is 3.3.0 . I have the now.ini file in my /etc/ansible directory and also my now.py script. I have pasted the contents of now.py in my custom script contents in tower. Created an inventory and used the custom script in sources. I have all the credentials set up and also enabled .ini, script plugins in ansible.cfg file . When i'm trying to sync the inventory I'm facing the below error.  Could anyone please help me out with resolving this problem?\r\nPlease find the error below\r\n[WARNING]:  * Failed to parse /tmp/awx_69_rRSdgQ/tmpZkM0LD with script plugin:\r\nInventory script (/tmp/awx_69_rRSdgQ/tmpZkM0LD) had an execution error:\r\nTraceback (most recent call last):   File \"/tmp/awx_69_rRSdgQ/tmpZkM0LD\", line\r\n321, in <module>     main(sys.argv)   File \"/tmp/awx_69_rRSdgQ/tmpZkM0LD\", line\r\n316, in main     inventory.generate()   File \"/tmp/awx_69_rRSdgQ/tmpZkM0LD\",\r\nline 205, in generate     content = self._invoke('GET', path, None)   File\r\n\"/tmp/awx_69_rRSdgQ/tmpZkM0LD\", line 155, in _invoke     'http': self.proxy,\r\n'https': self.proxy})   File \"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/requests/sessions.py\", line 535, in get     return self.request('GET',\r\nurl, **kwargs)   File \"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/requests/sessions.py\", line 522, in request     resp = self.send(prep,\r\n**send_kwargs)   File \"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/requests/sessions.py\", line 642, in send     r = adapter.send(request,\r\n**kwargs)   File \"/var/lib/awx/venv/ansible/lib/python2.7/site-\r\npackages/requests/adapters.py\", line 503, in send     raise ConnectionError(e,\r\nrequest=request) requests.exceptions.ConnectionError:\r\nHTTPSConnectionPool(host='none', port=443): Max retries exceeded with url: //ap\r\ni/now/table/cmdb_ci_server?sysparm_exclude_reference_link=true&sysparm_display_\r\nvalue=true&sysparm_fields=sys_class_name,fqdn,ip_address,name,host_name (Caused\r\nby NewConnectionError('<requests.packages.urllib3.connection.VerifiedHTTPSConne\r\nction object at 0x7f9fc37e23d0>: Failed to establish a new connection: [Errno\r\n-2] Name or service not known',))\r\n [WARNING]: Unable to parse /tmp/awx_69_rRSdgQ/tmpZkM0LD as an inventory source\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nLink to the now.py file.\r\nhttps://github.com/ServiceNowITOM/ansible-sn-inventory/blob/master/now.py\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI am attempting to setup a provisioning callback. The message being returned is \"No matching host could be found!\"\r\n\r\nI have verified the host was added to the dynamic inventory and has a fact foreman.ip: [correct ip address]\r\n\r\nThe hostname can not be resolved using a reverse DNS lookup. What other methods does AWX use to lookup a host by the requesting IP?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.7.0\r\n* Operating System: RHEL 7.5\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1) I setup an inventory and verified it would update.\r\n    I also set Overwrite, and Update on Launch.\r\n2) Verified remote host is available in the inventory. Also, found host's IP address in the following facts:\r\n  - foreman.ip\r\n  - foreman_facts.discovery_bootip\r\n  - foreman_facts.ipaddress_ens32\r\n  - foreman_facts.discovery_ip_cidr\r\n  - foreman_facts.nmprimary_ip4_address\r\n  - foreman_facts.ipaddress\r\n3) Created project and verified it would update from git.\r\n   I also set Clean, and Update Revision on Launch\r\n4) Created template and verified I could execute it on remote host via the AWX UI.\r\n   I also set Allow Provisioning Callbacks\r\n\r\n5) On remote host execute 'curl -k -s -vv --data \"host_config_key=4d27ec88782b2010cee8ae19f5977199\" https://[server running AWX]/api/v2/job_templates/15/callback/\r\n\r\n\r\n##### EXPECTED RESULTS\r\nI expected the job template to be kicked off and run my provisioning playbook against the calling host.\r\n\r\n##### ACTUAL RESULTS\r\nAfter updating the dynamic inventory I receive the error \"No matching host could be found!\"\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nTrying to follow https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md, I cannot make the PATCH request to create a new environment.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.23\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.5\r\n* Operating System: CentOS 7\r\n* Web Browser: Safari / Postman\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Followed the aforementioned documentation in a shell into the awx_task container\r\n- Istalled gcc and python-devel along the way to satisfy dependencies\r\n- Installed `pyvmomi` and `netapp-lib` with pip\r\n\r\nOn the credential part, I created a new application \"API Access\"\r\n\r\n![image](https://user-images.githubusercontent.com/182035/47264321-d71f1200-d514-11e8-99ef-69b1304090ec.png)\r\n\r\nas well as a new token for `admin`\r\n\r\n![image](https://user-images.githubusercontent.com/182035/47264326-fb7aee80-d514-11e8-9a06-cb365d14bd90.png)\r\n\r\nI can now query the configuration :\r\n\r\n![image](https://user-images.githubusercontent.com/182035/47264333-1f3e3480-d515-11e8-8875-ee95795f1522.png)\r\n\r\nbut I cannot `PATCH` the new environment :\r\n\r\n![image](https://user-images.githubusercontent.com/182035/47264359-b4d9c400-d515-11e8-96c0-2a63806275ac.png)\r\n\r\n```\r\nOct 21 09:44:41 ansible journal: 2018-10-21 07:44:41,314 DEBUG    awx.api.authentication User admin performed a PATCH to /api/v2/organizations/1/ through the API using OAuth token 1.\r\nOct 21 09:44:41 ansible journal: 2018-10-21 07:44:41,319 WARNING  awx.api.generics status 403 received by user admin attempting to access /api/v2/organizations/1/ from 10.0.1.122\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI should be granted permission\r\n\r\n##### ACTUAL RESULTS\r\n\r\nI got permission denied"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\nThe option of updating the project when a project based inventory is manually synced (added or otherwise). \r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nThe current functionality allows for project change -> update inventory, but when adding a new inventory (or updating it), the the sync fails until the project is otherwise updated. Adding the option allows for the add inventory -> update project (to see the actual inventory). This is probably mostly useful adding new project sources inventories and wanting to make sure they are pulled in correctly before using them in a job. Reduces the manual step/process (remembering) to update the project first before validating the newly added project sources inventory\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIf a WFJT contains a SJT, the SJT detail view cannot be opened from the context of the WFJT view\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.1\r\n* Operating System: MacOS\r\n* Web Browser: Firefox 62.0.3\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a SJT with multiple slices\r\n2. Create a WFJT which contains the SJT from step 1\r\n3. Run the WFJT and attempt to click on the SJT Detail view link\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAble to view the SJT Detail\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError 404 Modal\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![wfjt-sjt](https://user-images.githubusercontent.com/12446869/47057567-4e5c4b00-d18f-11e8-8f9d-cd58187cfae2.gif)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - Job Execution\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThe AWX Web and Task containers come configured with an ansible virtualenv in the container. Adding any python modules through pip to this virtualenv are not picked up during a job run unless `ansible_python_interpreter: /var/lib/awx/venv/ansible/bin/python` is set.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.1\r\n* AWX install method: Kubernetes\r\n* Ansible version:  2.6.4\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nBuild a custom task container, adding a module such as OpenShift to the default ansible virtualenv environment.\r\n\r\nExecute a job template that uses the `k8s` or `oc` modules.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nJob to be executed with the default Ansible virtualenv.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nJob runs with the system python in the container, which does not know where the modules are installed."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nCurrently, if you want to drain a cluster, you need to:\r\n- disable instances\r\n- wait for jobs to drain\r\n- hope new ones don't get submitted\r\n- once done, shut it down (for upgrades, etc.)\r\n\r\nIdeally, there is a \"one-stop\" option for draining a cluster, that *also* involves not letting new jobs be submitted in the interim.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nBe able to convert user authentication method from UI after migrating the user that is authenticating via AD/LDAP from old AWX instance to new AWX instance.\r\n\r\n- when you sync a user that is authenticating via AD/LDAP using tower-cli from one instance to another and that user don't exists on the destination instance the user will be sync but created as local user with default password. We need a feature that could convert that user back to authenticating via AD/LDAP without deleting it so that there permission on the other assets are retained.\r\n\r\n- create something like a drop down field in the user details section (like the USER TYPE drop down) to choose the AUTHENTICATION TYPE either local or the current external authentication that is configured in AWX.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAdditional field in (e.g. AUTHENTICATION TYPE):\r\n\r\n![screen shot 2018-10-16 at 3 41 06 pm](https://user-images.githubusercontent.com/10410660/47000078-04a53d80-d15a-11e8-812c-1478b810e5b3.png)\r\n"},{"labels":["api",null,null,null],"text":"To reproduce, set this form value to valid json in the settings/auth form and save:\r\n\r\n<img width=\"295\" alt=\"screen shot 2018-10-15 at 6 11 19 pm\" src=\"https://user-images.githubusercontent.com/1342624/46981326-d403cc00-d0a5-11e8-800b-2fe1c296028f.png\">\r\n\r\n### Expected\r\n* A more details error message\r\n\r\n### Actual\r\n* Error message that makes the user thing the json dict they sent somehow contains unicode.\r\n`\"Expected a dictionary of items but got type \\\"unicode\\\".\"`\r\n\r\n<img width=\"1075\" alt=\"screen shot 2018-10-15 at 6 11 27 pm\" src=\"https://user-images.githubusercontent.com/1342624/46981389-1927fe00-d0a6-11e8-9544-f6f91717e58a.png\">\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nMetadata:\r\n- name: Client Certificate (feel free to come up with something better)\r\n- description: A client certificate and its corresponding private key\r\n\r\ninputs:\r\n```\r\n {\r\n                \"fields\": [\r\n                    {\r\n                        \"label\": \"Client Certificate\",\r\n                        \"secret\": true,\r\n                        \"multiline\": true,\r\n                        \"help_text\": \"Paste the contents of the client certificate\",\r\n                        \"type\": \"string\",\r\n                        \"id\": \"client_cert\"\r\n                    },\r\n                    {\r\n                        \"label\": \"Private Key\",\r\n                        \"secret\": true,\r\n                        \"multiline\": true,\r\n                        \"help_text\": \"Paste the contents of the private key for the certificate\",\r\n                        \"type\": \"string\",\r\n                        \"id\": \"priv_key\"\r\n                    }\r\n                ],\r\n                \"required\": [\r\n                    \"client_cert\",\r\n                    \"priv_key\"\r\n                ]\r\n},\r\n                \"fields\": [\r\n                    {\r\n                        \"label\": \"Private Key\",\r\n                        \"secret\": true,\r\n                        \"multiline\": true,\r\n                        \"help_text\": \"Paste the contents of the private key for the certificate\",\r\n                        \"type\": \"string\",\r\n                        \"id\": \"priv_key\"\r\n                    }\r\n                ],\r\n                \"required\": [\r\n                    \"priv_key\"\r\n                ]\r\n            },\r\n```\r\n\r\ninjector:\r\n```\r\n                \"file\": {\r\n                    \"template.cert\": \"{{ client_cert }}\"\r\n                    \"template.key\": \"{{ priv_key }}\"\r\n                },\r\n                \"env\": {\r\n                    \"CLIENT_CERTIFICATE\": \"{{ tower.filename.cert }}\"\r\n                    \"CLIENT_KEY\": \"{{ tower.filename.key }}\"\r\n                }\r\n}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInside of the job serialization, mark these files for eventual removal:\r\n\r\n```json\r\n            \"ask_diff_mode_on_launch\": false,\r\n            \"ask_variables_on_launch\": false,\r\n            \"ask_limit_on_launch\": false,\r\n            \"ask_tags_on_launch\": false,\r\n            \"ask_skip_tags_on_launch\": false,\r\n            \"ask_job_type_on_launch\": false,\r\n            \"ask_verbosity_on_launch\": false,\r\n            \"ask_inventory_on_launch\": false,\r\n            \"ask_credential_on_launch\": false,\r\n```\r\n\r\n(9 fields)\r\n\r\nThe implementation of these looks like:\r\n\r\nhttps://github.com/ansible/awx/blob/5910b8c5627d46ad52a41801c6998322973c650e/awx/main/models/jobs.py#L548-L552\r\n\r\nI believe there is a good case to say that these don't provide any real value. They just add confusion.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\njob serialization in list:\r\n\r\nhttps://gist.github.com/AlanCoding/f0ac97a46c6388285d26e47894f97279\r\n\r\nIt takes 88 lines for the job's serialization, so 9 lines, about 10% isn't nothing.\r\n\r\n@ryanpetrello since these have been around for a while, I think there's a good case to mark them as deprecated, but still wait until API v3 to actually remove them. Interested in your thoughts on that."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAdd functionality to manage a predefined list of inventories in a job template.  This would limit the inventories in which a job template can be executed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIn a organization/group with a large number of inventories which cannot be more limited by RBAC, this feature would help to speed up the \"inventory selection\" process during the execution as well as avoid possible mistakes caused by selecting the wrong inventory.\r\n\r\nThe execution of a job template (even with the option ask for inventory when executed) becomes difficult to manage and causes to easily make an mistakes (as executing a job template in wrong set of hosts).\r\n\r\n(Customer request)"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nCreated a survey to pass variables (pkg name and state) into a playbook that will install packages using yum but doesn't work - it doesn't install.\r\n\r\nBut if I write another playbook with the values (pkg name and state) hardcoded that package installs.\r\n\r\n \r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.2\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.6.2\r\n* Operating System: CentOS Linux release 7.4.1708 (Core)\r\n* Web Browser: Version 69.0.3497.100 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Create a Job Template\r\n- Add a survey for two variables: \r\n  -- p_module (text)  - for the package name \r\n  -- p_state (multi-choice) - for the state (latest, installed, ...)\r\n\r\n- Create a playbook, like this:\r\n\r\n-------------- Playbook ---------------\r\n- hosts: hostA\r\n  tasks:\r\n  - name: install \"{{ p_module }}\"\r\n    yum:\r\n        name: \"{{ p_module }}\"\r\n        state: \"{{ p_state }}\"\r\n\r\n\r\n- Run\r\n\r\nNote: I have used notation name=var with the same results.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPackage installed\r\n\r\n##### ACTUAL RESULTS\r\nUsing previous playbook with Survey to  install \"htop\" package and looking at the /var/log/message of destination machine (hostA):\r\n\r\n------------ LOG hostA --------------------\r\nOct 11 12:11:04 localhost systemd: Starting Session 321 of user root.\r\nOct 11 12:11:05 localhost ansible-setup: Invoked with filter=* gather_subset=['all'] fact_path=/etc/ansible/facts.d gather_timeout=10\r\nOct 11 12:11:06 localhost ansible-yum: Invoked with allow_downgrade=False name=['htop'] bugfix=False list=None disable_gpg_check=False conf_file=None install_repoquery=True validate_certs=True state=installed disablerepo=None update_cache=False disable_plugin=[] enablerepo=None exclude=None security=False update_only=False enable_plugin=[] installroot=/ skip_broken=False\r\nOct 11 12:12:13 localhost systemd-logind: Removed session 321.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nUsing the following playbook to install  the same package, works fine.\r\n\r\n--------------- Playbook ---------------\r\n- hosts: hotaA\r\n  tasks:\r\n  - name: Install htop\r\n    yum: \r\n        name: htop \r\n        state: latest\r\n\r\n------------ LOG hostA --------------------\r\nOct  11 12:42:38 localhost systemd-logind: New session 224 of user root\r\nOct  11 12:42:50 localhost ansible-yum: Invoked with allow_downgrade=False name=['htop'] bugfix=False list=None disable_gpg_check=False conf_file=None install_repoquery=True validate_certs=True state=latest disablerepo=None update_cache=False disable_plugin=[] enablerepo=None exclude=None security=False update_only=False enable_plugin=[] installroot=/ skip_broken=False\r\nOct  11 12:42:50 localhost ansible-yum: Invoked with allow_downgrade=False name=['htop'] bugfix=False list=None disable_gpg_check=False conf_file=None install_repoquery=True validate_certs=True state=latest disablerepo=None update_cache=False disable_plugin=[] enablerepo=None exclude=None security=False update_only=False enable_plugin=[] installroot=/ skip_broken=False\r\nOct  11 12:43:08 localhost yum[31123]: Installed: htop-2.2.0-1.el7.x86_64\r\nOct  11 12:44:16 localhost systemd-logind: Removed session 224.\r\n\r\n\r\nThe difference is that the second one calls YUM to install\r\nOct  11 12:43:08 localhost yum[31123]: Installed: htop-2.2.0-1.el7.x86_64\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWe notice that, every day or so, we're having to bounce our AWX instance for it to run scheduled jobs again.\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6\r\n* Operating System:  Scientific Linux 7\r\n* Web Browser:  Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\nStart AWX using following compose file (passwords masked obviously)\r\n```\r\nversion: '3'\r\nservices:\r\n\r\n  web:\r\n    image: ansible/awx_web:2.0.0\r\n    ports:\r\n      - \"8052:8052\"\r\n    hostname: awxweb\r\n    user: root\r\n    restart: unless-stopped\r\n    volumes:\r\n      - \"/var/lib/awx/projects:/var/lib/awx/projects:rw\"\r\n    environment:\r\n      http_proxy:\r\n      https_proxy:\r\n      no_proxy:\r\n      SECRET_KEY: xxxxxxxx\r\n      DATABASE_NAME: awx\r\n      DATABASE_USER: awx\r\n      DATABASE_PASSWORD: xxx\r\n      DATABASE_PORT: 5432\r\n      DATABASE_HOST: postgres\r\n      RABBITMQ_USER: guest\r\n      RABBITMQ_PASSWORD: xxx\r\n      RABBITMQ_HOST: rabbitmq\r\n      RABBITMQ_PORT: 5672\r\n      RABBITMQ_VHOST: awx\r\n      MEMCACHED_HOST: memcached\r\n      MEMCACHED_PORT: 11211\r\n      AWX_ADMIN_USER: xxx\r\n      AWX_ADMIN_PASSWORD: xxx\r\n      LDAPTLS_REQCERT: \"never\"\r\n    command: /bin/sh -c '/bin/curl https://releases.hashicorp.com/envconsul/0.7.3/envconsul_0.7.3_linux_amd64.tgz --output envconsul_0.7.3_linux_amd64.tgz && /bin/tar zxvfp envconsul_0.7.3_linux_amd64.tgz -C /usr/bin/ && /bin/yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo && /bin/yum -y install docker-ce && /bin/pip install --upgrade pip && /bin/pip install github3.py docker docker-compose && /usr/bin/launch_awx.sh'\r\n\r\n  task:\r\n    image: ansible/awx_task:2.0.0\r\n    depends_on:\r\n      - web\r\n    hostname: awx\r\n    user: root\r\n    restart: unless-stopped\r\n    volumes:\r\n      - \"/var/lib/awx/projects:/var/lib/awx/projects:rw\"\r\n    environment:\r\n      http_proxy:\r\n      https_proxy:\r\n      no_proxy:\r\n      SECRET_KEY: xxxxxxxx\r\n      DATABASE_NAME: awx\r\n      DATABASE_USER: awx\r\n      DATABASE_PASSWORD: xxx\r\n      DATABASE_PORT: 5432\r\n      DATABASE_HOST: postgres\r\n      RABBITMQ_USER: guest\r\n      RABBITMQ_PASSWORD: xxx\r\n      RABBITMQ_HOST: rabbitmq\r\n      RABBITMQ_PORT: 5672\r\n      RABBITMQ_VHOST: awx\r\n      MEMCACHED_HOST: memcached\r\n      MEMCACHED_PORT: 11211\r\n      AWX_ADMIN_USER: xxx\r\n      AWX_ADMIN_PASSWORD: xxx\r\n      LDAPTLS_REQCERT: \"never\"\r\n    command: /bin/sh -c '/bin/curl https://releases.hashicorp.com/envconsul/0.7.3/envconsul_0.7.3_linux_amd64.tgz --output envconsul_0.7.3_linux_amd64.tgz && /bin/tar zxvfp envconsul_0.7.3_linux_amd64.tgz -C /usr/bin/ && /bin/yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo && /bin/yum -y install docker-ce && /bin/pip install --upgrade pip && /bin/pip install github3.py docker docker-compose && /usr/bin/launch_awx_task.sh'\r\n\r\n  rabbitmq:\r\n    image: ansible/awx_rabbitmq:latest\r\n    restart: unless-stopped\r\n    environment:\r\n      RABBITMQ_DEFAULT_VHOST: awx\r\n      RABBITMQ_ERLANG_COOKIE: cookiemonster\r\n\r\n  memcached:\r\n    image: memcached:alpine\r\n    restart: unless-stopped\r\n\r\n  postgres:\r\n    image: postgres:10-alpine\r\n    restart: unless-stopped\r\n    hostname: postgres\r\n    volumes:\r\n      - \"/var/lib/postgresql/data:/var/lib/postgresql/data\"\r\n    environment:\r\n      POSTGRES_USER: awx\r\n      POSTGRES_PASSWORD: xxx\r\n      POSTGRES_DB: awx\r\n    command: -c 'max_connections=4096' -c 'shared_buffers=1024MB'\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\nAWX just keeps running and reliably runs Scheduled Tasks that are configured over multiple days of runs.\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\nIt runs for about a day or two before stopping dead and we have to restart all containers\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nContainer logs attached.\r\n[awx.logs.zip](https://github.com/ansible/awx/files/2469546/awx.logs.zip)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIn some cases, we have slowdown due to waiting for the next run of the task manager, particularly with workflows. This should be sped up by adding some special cases to have the task manager reschedule itself once its work is finished.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nImpacts https://github.com/ansible/awx/issues/2252\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAM\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nUser should be able to click on a link to navigate to the original job if they are on the page for a relaunched job.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nneeds the API to show the information, and then the UI to display it.\r\n\r\nI suggest that this field should be a foreign key on the UnifiedJob model, but turn off the DB index for this field: https://code.djangoproject.com/ticket/13730"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI cannot send test notification to our mattermost server but real notifications works fine.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 2.0.0\r\n* AWX install method: docker on linux (but doesn't matter)\r\n* Ansible version:  2.6.5\r\n* Operating System: Linux Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Create incoming webhook in your mattermost server (we use Mattermost 5.0.0)\r\n2) Create notifier in the AWX->Notifications\r\n3) Open Browser Console\r\n4) Click on the bell on the page of notifications (test notification)\r\n5) See logs in the console and logs in docker (docker logs --tail=100 22 awx_web)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNotification can be sent by AWX server and can be correctly received by Mattermost server (it has two versions of API).\r\n\r\n##### ACTUAL RESULTS\r\n\r\nConsole results:\r\n{detail: \"A server error has occurred.\"}\r\n\r\n`docker logs --tail=100 awx_web` results:\r\n\r\n```\r\n2018-10-10 12:51:09,194 ERROR    django.request Internal Server Error: /api/v2/notification_templates/1/test/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 71, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 328, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views/__init__.py\", line 4734, in post\r\n    connection.on_commit(lambda: send_notifications.delay([notification.id]))\r\nNameError: global name 'connection' is not defined\r\n2018-10-10 12:51:09,194 ERROR    django.request Internal Server Error: /api/v2/notification_templates/1/test/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 71, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 328, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views/__init__.py\", line 4734, in post\r\n    connection.on_commit(lambda: send_notifications.delay([notification.id]))\r\nNameError: global name 'connection' is not defined\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIf we see the code, we will see that variable 'connection' is really undefined.\r\n\r\n```\r\nclass NotificationTemplateTest(GenericAPIView):\r\n    '''Test a Notification Template'''\r\n\r\n    view_name = _('Notification Template Test')\r\n    model = NotificationTemplate\r\n    obj_permission_type = 'start'\r\n    serializer_class = EmptySerializer\r\n\r\n    def post(self, request, *args, **kwargs):\r\n        obj = self.get_object()\r\n        notification = obj.generate_notification(\"Tower Notification Test {} {}\".format(obj.id, settings.TOWER_URL_BASE),\r\n                                                 {\"body\": \"Ansible Tower Test Notification {} {}\".format(obj.id, settings.TOWER_URL_BASE)})\r\n        if not notification:\r\n            return Response({}, status=status.HTTP_400_BAD_REQUEST)\r\n        else:\r\n            connection.on_commit(lambda: send_notifications.delay([notification.id]))\r\n            data = OrderedDict()\r\n            data['notification'] = notification.id\r\n            data.update(NotificationSerializer(notification, context=self.get_serializer_context()).to_representation(notification))\r\n            headers = {'Location': notification.get_absolute_url(request=request)}\r\n            return Response(data,\r\n                            headers=headers,\r\n                            status=status.HTTP_202_ACCEPTED)\r\n```\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - The ability to install Tower in an IPv6 only infrastructure.\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nOur organization is running out of IPv4 network addresses and has made the commitment to be IPv6 only.  We depend on Ansible and need the ability for Tower to run in an IPv6 only environment."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nA schedule that provides a limit does not report the value of the limit in the activity stream in the entry for creation of the schedule. Subsequent edits of the limit field do report it.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a schedule that provides `limit` for a JT  of \"foobar\"\r\n\r\nnow change it to \"barfoo\"\r\n\r\nNow view activity stream\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1. Entry for schedule creation containing \"foobar\"\r\n2. Entry for schedule modification \"foobar\" -> \"barfoo\"\r\n\r\n##### ACTUAL RESULTS\r\n\r\nnumber 2 is ✅ , in UI:\r\n\r\n```json\r\n{\r\n \"extra_data\": [\r\n  \"{}\",\r\n  \"\"\r\n ],\r\n \"limit\": [\r\n  \"foobar\",\r\n  \"barfoo\"\r\n ]\r\n}\r\n```\r\n\r\nnumber 1 is ❌ , the entry for creation exists, but does not report \"foobar\"\r\n\r\n```json\r\n{\r\n \"description\": \"every day for 1 time\",\r\n \"enabled\": true,\r\n \"extra_data\": \"{}\",\r\n \"id\": 4,\r\n \"inventory\": null,\r\n \"name\": \"asdffdsfe\",\r\n \"rrule\": \"DTSTART;TZID=America/New_York:20181010T000000 RRULE:FREQ=DAILY;INTERVAL=1;COUNT=1\",\r\n \"unified_job_template\": \"JobTemplate - DetailArt爩-397\"\r\n}\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nReported modification of `extra_data` there could be argued to be another minor bug.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently, there is not possible to enable `Update on Launch` and `Update on Project Change` for a SCM-based inventory even disabling `Update Revision on Launch` for the SCM project.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nToday, you can not create projects folder inside /var/lib/awx/projects/ automatically via UI. First somebody has to manually create it and then only he can come back and create project on Tower. It would be more convenient if project folder in server is automatically created either by using name of the project or using custom input from user.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nCustomer request."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAWX has many fields that contain variables, and is editable by the user. There's no fundamental difference in the type for any of these, but yet, they behave differently.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHere's a unit test to haphazardly create a table of what works and doesn't work:\r\n\r\n```python\r\n@pytest.mark.django_db\r\ndef test_vars_consistency(patch, inventory, job_template, project, wfjt_node, admin_user):\r\n    d = {'foo': 'bar'}\r\n    job_template.project = project\r\n    job_template.ask_variables_on_launch = True\r\n    job_template.ask_inventory_on_launch = True\r\n    job_template.inventory = inventory\r\n    job_template.playbook = 'helloworld.yml'\r\n    job_template.save()\r\n    for kind, vars in (('dict', d), ('json_str', json.dumps(d)), ('yaml_str', 'foo: bar')):\r\n        print ''\r\n        print ' testing kind: ' + str(kind)\r\n        for res, fd in ((inventory, 'variables'), (job_template, 'extra_vars'), (wfjt_node, 'extra_data')):\r\n            print ' field: ' + str(fd)\r\n            try:\r\n                patch(\r\n                    url=res.get_absolute_url(),\r\n                    data={fd: vars},\r\n                    user=admin_user,\r\n                    expect=200\r\n                )\r\n                print ' worked '\r\n            except Exception as e:\r\n                print ' did not work ' + str(e)\r\n    assert False\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAll fields accept all forms of passing the variables in.\r\n\r\n##### ACTUAL RESULTS\r\n\r\ntable from those results\r\n\r\n| field \\ accepts           | plain dict | JSON string | YAML string |\r\n|---------------------------|------------|-------------|-------------|\r\n| inventory (variables)     | ❌          | ✅           | ✅           |\r\n| job template (extra_vars) | ❌          | ✅           | ✅           |\r\n| WFJT nodes (extra_data)   | ✅          | ✅           | ✅           |\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAlso, job template `extra_vars` will preserve comments, while none of the others will.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nDelete the project that a JT uses and then try to edit the JT\r\n\r\nerror message returned is\r\n\r\n> {'project': [\"Job types 'run' and 'check' must have assigned a project.\"]}\r\n\r\nBut if you check OPTIONS\r\n\r\n```json\r\n            \"job_type\": {\r\n                \"type\": \"choice\",\r\n                \"required\": false,\r\n                \"label\": \"Job type\",\r\n                \"filterable\": true,\r\n                \"default\": \"run\",\r\n                \"choices\": [\r\n                    [\r\n                        \"run\",\r\n                        \"Run\"\r\n                    ],\r\n                    [\r\n                        \"check\",\r\n                        \"Check\"\r\n                    ]\r\n                ]\r\n            },\r\n```\r\n\r\nThere are only 2 types.\r\n\r\nThe error message is old and needs to be updated to reflect the current options.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\ndetails in summary\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI set up a Git repo under my work email with one .yml file as a playbook.  Set up a new project named 'Test Repo' in AWX.  That file named createfile.yml shows up when I try to create a new job template using that project.  However, any new files added to the Git repo are not showing up in AWX.  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.4\r\n* Operating System: Centos 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- Please describe exactly how to reproduce the problem. -->\r\n\r\nGo to Project > Test Repo > Get latest SCM revision.  The latest revision number then shows up for 'Test Repo' but any new files added to the repo do not appear.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\nAny new files added to repo display in drop down box for Playbook in job template.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\nOnly original file named createfile.yml is shown.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n504 Gateway Time-out on provisioning callback when integrated with Satellite 6.2\r\n\r\n##### ENVIRONMENT\r\n* AWX version:  1.0.8.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.4\r\n* Operating System: RHEL 7.5\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n1) Integrate AWX with Satellite with a dynamic inventory\r\n\r\n    Credential: \tThe credential you created for Satellite Server.\r\n    Overwrite: \tSelected\r\n    Upgrade on Launch: \tSelected\r\n    Cache Timeout: \t90\r\n\r\n    NB: Inventory syncronization take some minutes to finish!\r\n\r\n2) Create a template for provisioning job and enable callback\r\n\r\n3) Call the callback from a machine in the Satellite that is still not been syncronized as host in the Satellite inventory\r\n    /usr/bin/curl -k -s --data \"host_config_key=xxxxxxxxxxxxxxx\" https://awxhost/api/v2/job_templates/16/callback/\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe execution of the provisioning job after inventory resync.\r\n\r\n##### ACTUAL RESULTS\r\nThe inventory resync finishes fine but the provisioning job doesn't work. On the machine callin the callback after 120s we get:\r\n`\t<html>\r\n\t<head><title>504 Gateway Time-out</title></head>\r\n\t<body bgcolor=\"white\">\r\n\t<center><h1>504 Gateway Time-out</h1></center>\r\n\t<hr><center>nginx/1.12.2</center>\r\n\t</body>\r\n\t</html>`\r\n\r\n##### ADDITIONAL INFORMATION\r\nLooking at the log the problem seems to be related to the harakiri timeout:\r\n\r\n\r\nct  3 13:25:55 itasz0 journal: [2018-10-03 11:25:55,410: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\nOct  3 13:25:55 itasz0 journal: [2018-10-03 11:25:55,412: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->543e9a7d-427a-4fd4-be56-3ff9610d627c\r\nOct  3 13:25:55 itasz0 journal: [2018-10-03 11:25:55,413: DEBUG/Beat] beat: Waking up in 15.61 seconds.\r\nOct  3 13:25:55 itasz0 journal: [2018-10-03 11:25:55,418: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[543e9a7d-427a-4fd4-be56-3ff9610d627c] expires:[2018-10-03 11:26:15.411588+00:00]\r\nOct  3 13:25:55 itasz0 journal: [2018-10-03 11:25:55,418: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'543e9a7d-427a-4fd4-be56-3ff9610d627c', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:26:15.411588+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'543e9a7d-427a-4fd4-be56-3ff9610d627c', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'543e9a7d-427a-4fd4-be56-3ff9610d627c', u'headers': {}}) kwargs:{})\r\nOct  3 13:25:55 itasz0 journal: [2018-10-03 11:25:55,421: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[543e9a7d-427a-4fd4-be56-3ff9610d627c] pid:253\r\nOct  3 13:25:55 itasz0 journal: 2018-10-03 11:25:55,442 DEBUG    awx.main.scheduler Running Tower task manager.\r\nOct  3 13:25:55 itasz0 journal: 2018-10-03 11:25:55,457 DEBUG    awx.main.scheduler Starting Scheduler\r\nOct  3 13:25:55 itasz0 journal: [2018-10-03 11:25:55,507: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[543e9a7d-427a-4fd4-be56-3ff9610d627c] succeeded in 0.0869208549848s: None\r\nOct  3 13:25:57 itasz0 journal: 2018-10-03 11:25:57,985 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\nOct  3 13:25:58 itasz0 journal: 2018-10-03 11:25:58,011 DEBUG    awx.main.models.inventory Finished updating inventory computed fields\r\nOct  3 13:25:58 itasz0 journal: 2018-10-03 11:25:58.035 [info] <0.6793.6> accepting AMQP connection <0.6793.6> (172.17.0.5:48994 -> 172.17.0.4:5672)\r\nOct  3 13:25:58 itasz0 journal: 2018-10-03 11:25:58.041 [info] <0.6793.6> connection <0.6793.6> (172.17.0.5:48994 -> 172.17.0.4:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\nOct  3 13:25:58 itasz0 journal: [2018-10-03 11:25:58,049: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_job_launch[6f766022-d12d-4d86-8ce2-40f6d9b52f77]\r\nOct  3 13:25:58 itasz0 journal: [2018-10-03 11:25:58,049: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.scheduler.tasks.run_job_launch', u'6f766022-d12d-4d86-8ce2-40f6d9b52f77', [39], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [39], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': None, u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_job_launch', u'callbacks': None, u'correlation_id': u'6f766022-d12d-4d86-8ce2-40f6d9b52f77', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'71bb69d4-e51b-3154-a936-0c6b3d35b47a', u'id': u'6f766022-d12d-4d86-8ce2-40f6d9b52f77', u'headers': {}}) kwargs:{})\r\nOct  3 13:25:58 itasz0 journal: [2018-10-03 11:25:58,054: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_job_launch[6f766022-d12d-4d86-8ce2-40f6d9b52f77] pid:252\r\nOct  3 13:25:58 itasz0 journal: 2018-10-03 11:25:58.059 [info] <0.6793.6> closing AMQP connection <0.6793.6> (172.17.0.5:48994 -> 172.17.0.4:5672, vhost: 'awx', user: 'guest')\r\nOct  3 13:25:58 itasz0 journal: 2018-10-03 11:25:58,081 DEBUG    awx.main.scheduler Starting Scheduler\r\nOct  3 13:25:58 itasz0 journal: 2018-10-03 11:25:58,084 DEBUG    awx.main.scheduler Failing inconsistent running jobs.\r\nOct  3 13:25:58 itasz0 journal: 2018-10-03 11:25:58.141 [info] <0.6807.6> accepting AMQP connection <0.6807.6> (172.17.0.6:57140 -> 172.17.0.4:5672)\r\nOct  3 13:25:58 itasz0 journal: [2018-10-03 11:25:58,151: DEBUG/Worker-3] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@74fb39f734bc', u'platform': u'Erlang/OTP 20.1.7', u'version': u'3.7.4'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']\r\nOct  3 13:25:58 itasz0 journal: 2018-10-03 11:25:58.157 [info] <0.6807.6> connection <0.6807.6> (172.17.0.6:57140 -> 172.17.0.4:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\nOct  3 13:25:58 itasz0 journal: [2018-10-03 11:25:58,157: DEBUG/Worker-3] Open OK!\r\nOct  3 13:25:58 itasz0 journal: [2018-10-03 11:25:58,157: DEBUG/Worker-3] using channel_id: 1\r\nOct  3 13:25:58 itasz0 journal: [2018-10-03 11:25:58,159: DEBUG/Worker-3] Channel open\r\nOct  3 13:25:58 itasz0 journal: [2018-10-03 11:25:58,177: DEBUG/MainProcess] pidbox received method dump_active(safe=False) [reply_to:{u'routing_key': u'd8021da0-8d22-3de2-9bc4-21e6914f45e0', u'exchange': u'reply.celery.pidbox'} ticket:01d73179-1fd3-4c60-9c5b-0e7f8c1008f8]\r\nOct  3 13:25:58 itasz0 journal: [pid: 137|app: 0|req: 77/296] 172.17.0.7 () {50 vars in 2696 bytes} [Wed Oct  3 11:25:58 2018] GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all => generated 1091 bytes in 194 msecs (HTTP/1.1 200) 10 headers in 375 bytes (1 switches on core 0)\r\n**Oct  3 13:25:58 itasz0 journal: 172.17.0.7 - - [03/Oct/2018:11:25:58 +0000] \"GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all HTTP/1.1\" 200 1091 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\" \"172.26.7.15\"\r\nOct  3 13:25:58 itasz0 journal: 172.26.7.15 - - [03/Oct/2018:11:25:58 +0000] \"GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all HTTP/1.1\" 200 1091 \"https://itasz0.intra.infotn.it/\"** \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\"\r\nOct  3 13:25:58 itasz0 journal: 172.17.0.7 - - [03/Oct/2018:11:25:58 +0000] \"GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync HTTP/1.1\" 200 43875 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\" \"172.26.7.15\"\r\nOct  3 13:25:58 itasz0 journal: 172.26.7.15 - - [03/Oct/2018:11:25:58 +0000] \"GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync HTTP/1.1\" 200 43875 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\"\r\nOct  3 13:25:58 itasz0 journal: [pid: 134|app: 0|req: 45/297] 172.17.0.7 () {50 vars in 2734 bytes} [Wed Oct  3 11:25:58 2018] GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync => generated 43875 bytes in 889 msecs (HTTP/1.1 200) 10 headers in 376 bytes (1 switches on core 0)\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,193: DEBUG/Worker-3] Closed channel #1\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59.200 [info] <0.6807.6> closing AMQP connection <0.6807.6> (172.17.0.6:57140 -> 172.17.0.4:5672, vhost: 'awx', user: 'guest')\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59,295 DEBUG    awx.main.scheduler Starting inventory_update 39 (pending) in group tower instance awx (remaining_capacity=17)\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59,324 INFO     awx.main.scheduler Submitting inventory_update 39 (waiting) to <instance group, instance> <1,awx>.\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59,367 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,367: DEBUG/Worker-3] Going to update inventory computed fields\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59,395 DEBUG    awx.main.models.inventory Finished updating inventory computed fields\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,395: DEBUG/Worker-3] Finished updating inventory computed fields\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59,398 DEBUG    awx.main.scheduler inventory_update 39 (waiting) consumed 1 capacity units from tower with prior total of 0\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59.499 [info] <0.6827.6> accepting AMQP connection <0.6827.6> (172.17.0.6:57146 -> 172.17.0.4:5672)\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,501: DEBUG/Worker-3] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@74fb39f734bc', u'platform': u'Erlang/OTP 20.1.7', u'version': u'3.7.4'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59.504 [info] <0.6827.6> connection <0.6827.6> (172.17.0.6:57146 -> 172.17.0.4:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,505: DEBUG/Worker-3] Open OK!\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,505: DEBUG/Worker-3] using channel_id: 1\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,507: DEBUG/Worker-3] Channel open\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,514: DEBUG/Worker-3] Closed channel #1\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,514: INFO/MainProcess] Received task: awx.main.tasks.run_inventory_update[74b12ff2-bfde-4b6d-b5cd-ded459c1d335]\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,515: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.tasks.run_inventory_update', u'74b12ff2-bfde-4b6d-b5cd-ded459c1d335', [39], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [39], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'awx', u'exchange': u'awx'}, u'expires': None, u'hostname': 'celery@awx', u'task': u'awx.main.tasks.run_inventory_update', u'callbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_success', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'task_actual': {u'type': u'inventory_update', u'id': 39}}, u'options': {}}], u'correlation_id': u'74b12ff2-bfde-4b6d-b5cd-ded459c1d335', u'errbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_error', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'subtasks': [{u'type': u'inventory_update', u'id': 39}]}, u'options': {}}], u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to':... kwargs:{})\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,520: DEBUG/MainProcess] Task accepted: awx.main.tasks.run_inventory_update[74b12ff2-bfde-4b6d-b5cd-ded459c1d335] pid:254\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59.518 [info] <0.6827.6> closing AMQP connection <0.6827.6> (172.17.0.6:57146 -> 172.17.0.4:5672, vhost: 'awx', user: 'guest')\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,531: INFO/MainProcess] Task awx.main.scheduler.tasks.run_job_launch[6f766022-d12d-4d86-8ce2-40f6d9b52f77] succeeded in 1.47918982204s: None\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59,642 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,642: DEBUG/Worker-5] Going to update inventory computed fields\r\nOct  3 13:25:59 itasz0 journal: 2018-10-03 11:25:59,671 DEBUG    awx.main.models.inventory Finished updating inventory computed fields\r\nOct  3 13:25:59 itasz0 journal: [2018-10-03 11:25:59,671: DEBUG/Worker-5] Finished updating inventory computed fields\r\nOct  3 13:26:00 itasz0 journal: [pid: 136|app: 0|req: 33/298] 172.17.0.7 () {50 vars in 2696 bytes} [Wed Oct  3 11:26:00 2018] GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all => generated 1091 bytes in 385 msecs (HTTP/1.1 200) 10 headers in 375 bytes (1 switches on core 0)\r\nOct  3 13:26:00 itasz0 journal: 172.26.7.15 - - [03/Oct/2018:11:26:00 +0000] \"GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all HTTP/1.1\" 200 1091 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\"\r\nOct  3 13:26:00 itasz0 journal: 172.17.0.7 - - [03/Oct/2018:11:26:00 +0000] \"GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all HTTP/1.1\" 200 1091 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\" \"172.26.7.15\"\r\nOct  3 13:26:00 itasz0 journal: RESULT 2\r\nOct  3 13:26:00 itasz0 journal: OKREADY\r\nOct  3 13:26:00 itasz0 journal: 172.17.0.7 - - [03/Oct/2018:11:26:00 +0000] \"GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all HTTP/1.1\" 200 1091 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\" \"172.26.7.15\"\r\nOct  3 13:26:00 itasz0 journal: 172.26.7.15 - - [03/Oct/2018:11:26:00 +0000] \"GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all HTTP/1.1\" 200 1091 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\"\r\nOct  3 13:26:00 itasz0 journal: [pid: 133|app: 0|req: 29/299] 172.17.0.7 () {50 vars in 2696 bytes} [Wed Oct  3 11:26:00 2018] GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all => generated 1091 bytes in 439 msecs (HTTP/1.1 200) 10 headers in 375 bytes (1 switches on core 0)\r\nOct  3 13:26:01 itasz0 journal: [pid: 134|app: 0|req: 46/300] 172.17.0.7 () {50 vars in 2734 bytes} [Wed Oct  3 11:26:00 2018] GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync => generated 43949 bytes in 1202 msecs (HTTP/1.1 200) 10 headers in 376 bytes (1 switches on core 0)\r\nOct  3 13:26:01 itasz0 journal: 172.17.0.7 - - [03/Oct/2018:11:26:01 +0000] \"GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync HTTP/1.1\" 200 43949 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\" \"172.26.7.15\"\r\nOct  3 13:26:01 itasz0 journal: 172.26.7.15 - - [03/Oct/2018:11:26:01 +0000] \"GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync HTTP/1.1\" 200 43949 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\"\r\nOct  3 13:26:01 itasz0 journal: RESULT 2\r\nOct  3 13:26:01 itasz0 journal: OKREADY\r\nOct  3 13:26:01 itasz0 journal: [pid: 137|app: 0|req: 78/301] 172.17.0.7 () {50 vars in 2734 bytes} [Wed Oct  3 11:26:00 2018] GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync => generated 43949 bytes in 1537 msecs (HTTP/1.1 200) 10 headers in 376 bytes (1 switches on core 0)\r\nOct  3 13:26:01 itasz0 journal: 172.26.7.15 - - [03/Oct/2018:11:26:01 +0000] \"GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync HTTP/1.1\" 200 43949 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\"\r\nOct  3 13:26:01 itasz0 journal: 172.17.0.7 - - [03/Oct/2018:11:26:01 +0000] \"GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync HTTP/1.1\" 200 43949 \"https://itasz0.intra.infotn.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101 Firefox/60.0\" \"172.26.7.15\"\r\nOct  3 13:26:05 itasz0 journal: 2018-10-03 11:26:05.791 [info] <0.6841.6> accepting AMQP connection <0.6841.6> (172.17.0.6:57188 -> 172.17.0.4:5672)\r\nOct  3 13:26:05 itasz0 journal: 2018-10-03 11:26:05.797 [info] <0.6841.6> connection <0.6841.6> (172.17.0.6:57188 -> 172.17.0.4:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\nOct  3 13:26:05 itasz0 journal: [2018-10-03 11:26:05,794: DEBUG/Worker-5] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@74fb39f734bc', u'platform': u'Erlang/OTP 20.1.7', u'version': u'3.7.4'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']\r\nOct  3 13:26:05 itasz0 journal: [2018-10-03 11:26:05,798: DEBUG/Worker-5] Open OK!\r\nOct  3 13:26:05 itasz0 journal: [2018-10-03 11:26:05,799: DEBUG/Worker-5] using channel_id: 1\r\nOct  3 13:26:05 itasz0 journal: [2018-10-03 11:26:05,801: DEBUG/Worker-5] Channel open\r\nOct  3 13:26:11 itasz0 journal: [2018-10-03 11:26:11,030: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\nOct  3 13:26:11 itasz0 journal: [2018-10-03 11:26:11,033: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->8d5815d8-0f00-45d7-8162-06905d0d80f2\r\nOct  3 13:26:11 itasz0 journal: [2018-10-03 11:26:11,033: DEBUG/Beat] beat: Waking up in 4.37 seconds.\r\nOct  3 13:26:11 itasz0 journal: [2018-10-03 11:26:11,038: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[8d5815d8-0f00-45d7-8162-06905d0d80f2] expires:[2018-10-03 11:26:31.031577+00:00]\r\nOct  3 13:26:11 itasz0 journal: [2018-10-03 11:26:11,039: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.tasks.awx_periodic_scheduler', u'8d5815d8-0f00-45d7-8162-06905d0d80f2', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:26:31.031577+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.awx_periodic_scheduler', u'callbacks': None, u'correlation_id': u'8d5815d8-0f00-45d7-8162-06905d0d80f2', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'8d5815d8-0f00-45d7-8162-06905d0d80f2', u'headers': {}}) kwargs:{})\r\nOct  3 13:26:11 itasz0 journal: [2018-10-03 11:26:11,044: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[8d5815d8-0f00-45d7-8162-06905d0d80f2] pid:251\r\nOct  3 13:26:11 itasz0 journal: 2018-10-03 11:26:11,066 DEBUG    awx.main.tasks Last scheduler run was: 2018-10-03 11:25:41.063583+00:00\r\nOct  3 13:26:11 itasz0 journal: [2018-10-03 11:26:11,107: INFO/MainProcess] Task awx.main.tasks.awx_periodic_scheduler[8d5815d8-0f00-45d7-8162-06905d0d80f2] succeeded in 0.0664546310436s: None\r\nOct  3 13:26:15 itasz0 journal: 2018-10-03 11:26:15.295 [info] <0.6852.6> accepting AMQP connection <0.6852.6> (172.17.0.6:57196 -> 172.17.0.4:5672)\r\nOct  3 13:26:15 itasz0 journal: 2018-10-03 11:26:15.301 [info] <0.6852.6> connection <0.6852.6> (172.17.0.6:57196 -> 172.17.0.4:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\nOct  3 13:26:15 itasz0 journal: [2018-10-03 11:26:15,314: DEBUG/MainProcess] pidbox received method ping() [reply_to:{u'routing_key': u'b1b71947-0897-3c6e-82df-b00dda7c02c4', u'exchange': u'reply.celery.pidbox'} ticket:ad406a29-bbd6-4e2a-b738-ae1692015962]\r\nOct  3 13:26:15 itasz0 journal: 2018-10-03 11:26:15.325 [info] <0.6852.6> closing AMQP connection <0.6852.6> (172.17.0.6:57196 -> 172.17.0.4:5672, vhost: 'awx', user: 'guest')\r\nOct  3 13:26:15 itasz0 journal: [2018-10-03 11:26:15,412: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\nOct  3 13:26:15 itasz0 journal: [2018-10-03 11:26:15,414: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->3b093d84-400f-4e6e-8198-1203996f692c\r\nOct  3 13:26:15 itasz0 journal: [2018-10-03 11:26:15,415: DEBUG/Beat] beat: Waking up in 19.47 seconds.\r\nOct  3 13:26:15 itasz0 journal: [2018-10-03 11:26:15,418: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[3b093d84-400f-4e6e-8198-1203996f692c] expires:[2018-10-03 11:26:35.413602+00:00]\r\nOct  3 13:26:15 itasz0 journal: [2018-10-03 11:26:15,418: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'3b093d84-400f-4e6e-8198-1203996f692c', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:26:35.413602+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'3b093d84-400f-4e6e-8198-1203996f692c', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'3b093d84-400f-4e6e-8198-1203996f692c', u'headers': {}}) kwargs:{})\r\nOct  3 13:26:15 itasz0 journal: [2018-10-03 11:26:15,423: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[3b093d84-400f-4e6e-8198-1203996f692c] pid:253\r\nOct  3 13:26:15 itasz0 journal: 2018-10-03 11:26:15,442 DEBUG    awx.main.scheduler Running Tower task manager.\r\nOct  3 13:26:15 itasz0 journal: 2018-10-03 11:26:15,456 DEBUG    awx.main.scheduler Starting Scheduler\r\nOct  3 13:26:15 itasz0 journal: [2018-10-03 11:26:15,540: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[3b093d84-400f-4e6e-8198-1203996f692c] succeeded in 0.119942312944s: None\r\nOct  3 13:26:34 itasz0 journal: [2018-10-03 11:26:34,898: INFO/Beat] Scheduler: Sending due task cluster_heartbeat (awx.main.tasks.cluster_node_heartbeat)\r\nOct  3 13:26:34 itasz0 journal: [2018-10-03 11:26:34,900: DEBUG/Beat] awx.main.tasks.cluster_node_heartbeat sent. id->27a07880-0be0-4b89-b6c7-9951ad91d93f\r\nOct  3 13:26:34 itasz0 journal: [2018-10-03 11:26:34,901: DEBUG/Beat] beat: Waking up now.\r\nOct  3 13:26:34 itasz0 journal: [2018-10-03 11:26:34,904: INFO/MainProcess] Received task: awx.main.tasks.cluster_node_heartbeat[27a07880-0be0-4b89-b6c7-9951ad91d93f] expires:[2018-10-03 11:27:24.899572+00:00]\r\nOct  3 13:26:34 itasz0 journal: [2018-10-03 11:26:34,905: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.tasks.cluster_node_heartbeat', u'27a07880-0be0-4b89-b6c7-9951ad91d93f', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx', u'exchange': u'awx'}, u'expires': u'2018-10-03T11:27:24.899572+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.cluster_node_heartbeat', u'callbacks': None, u'correlation_id': u'27a07880-0be0-4b89-b6c7-9951ad91d93f', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'27a07880-0be0-4b89-b6c7-9951ad91d93f', u'headers': {}}) kwargs:{})\r\nOct  3 13:26:34 itasz0 journal: [2018-10-03 11:26:34,910: DEBUG/MainProcess] Task accepted: awx.main.tasks.cluster_node_heartbeat[27a07880-0be0-4b89-b6c7-9951ad91d93f] pid:252\r\nOct  3 13:26:34 itasz0 journal: 2018-10-03 11:26:34,928 DEBUG    awx.main.tasks Cluster node heartbeat task.\r\nOct  3 13:26:35 itasz0 journal: [2018-10-03 11:26:35,219: INFO/MainProcess] Task awx.main.tasks.cluster_node_heartbeat[27a07880-0be0-4b89-b6c7-9951ad91d93f] succeeded in 0.312109655992s: None\r\nOct  3 13:26:35 itasz0 journal: [2018-10-03 11:26:35,413: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\nOct  3 13:26:35 itasz0 journal: [2018-10-03 11:26:35,416: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->d5191dcb-3cf3-4d65-bef5-2519d0f8fa88\r\nOct  3 13:26:35 itasz0 journal: [2018-10-03 11:26:35,418: DEBUG/Beat] beat: Waking up in 5.60 seconds.\r\nOct  3 13:26:35 itasz0 journal: [2018-10-03 11:26:35,419: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[d5191dcb-3cf3-4d65-bef5-2519d0f8fa88] expires:[2018-10-03 11:26:55.414847+00:00]\r\nOct  3 13:26:35 itasz0 journal: [2018-10-03 11:26:35,420: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'd5191dcb-3cf3-4d65-bef5-2519d0f8fa88', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:26:55.414847+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'd5191dcb-3cf3-4d65-bef5-2519d0f8fa88', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'd5191dcb-3cf3-4d65-bef5-2519d0f8fa88', u'headers': {}}) kwargs:{})\r\nOct  3 13:26:35 itasz0 journal: [2018-10-03 11:26:35,422: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[d5191dcb-3cf3-4d65-bef5-2519d0f8fa88] pid:251\r\nOct  3 13:26:35 itasz0 journal: 2018-10-03 11:26:35,440 DEBUG    awx.main.scheduler Running Tower task manager.\r\nOct  3 13:26:35 itasz0 journal: 2018-10-03 11:26:35,456 DEBUG    awx.main.scheduler Starting Scheduler\r\nOct  3 13:26:35 itasz0 journal: [2018-10-03 11:26:35,534: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[d5191dcb-3cf3-4d65-bef5-2519d0f8fa88] succeeded in 0.113091918989s: None\r\nOct  3 13:26:41 itasz0 journal: [2018-10-03 11:26:41,031: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\nOct  3 13:26:41 itasz0 journal: [2018-10-03 11:26:41,033: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->7e56347e-d86c-4a73-9399-c34a336f9fb5\r\nOct  3 13:26:41 itasz0 journal: [2018-10-03 11:26:41,034: DEBUG/Beat] beat: Waking up in 14.37 seconds.\r\nOct  3 13:26:41 itasz0 journal: [2018-10-03 11:26:41,038: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[7e56347e-d86c-4a73-9399-c34a336f9fb5] expires:[2018-10-03 11:27:01.032250+00:00]\r\nOct  3 13:26:41 itasz0 journal: [2018-10-03 11:26:41,039: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.tasks.awx_periodic_scheduler', u'7e56347e-d86c-4a73-9399-c34a336f9fb5', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:27:01.032250+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.awx_periodic_scheduler', u'callbacks': None, u'correlation_id': u'7e56347e-d86c-4a73-9399-c34a336f9fb5', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'7e56347e-d86c-4a73-9399-c34a336f9fb5', u'headers': {}}) kwargs:{})\r\nOct  3 13:26:41 itasz0 journal: [2018-10-03 11:26:41,042: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[7e56347e-d86c-4a73-9399-c34a336f9fb5] pid:253\r\nOct  3 13:26:41 itasz0 journal: 2018-10-03 11:26:41,063 DEBUG    awx.main.tasks Last scheduler run was: 2018-10-03 11:26:11.063665+00:00\r\nOct  3 13:26:41 itasz0 journal: [2018-10-03 11:26:41,107: INFO/MainProcess] Task awx.main.tasks.awx_periodic_scheduler[7e56347e-d86c-4a73-9399-c34a336f9fb5] succeeded in 0.0667069129995s: None\r\nOct  3 13:26:55 itasz0 journal: [2018-10-03 11:26:55,420: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\nOct  3 13:26:55 itasz0 journal: [2018-10-03 11:26:55,423: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->52f3e20d-d4e5-4cba-a5ae-a7dee8c72409\r\nOct  3 13:26:55 itasz0 journal: [2018-10-03 11:26:55,424: DEBUG/Beat] beat: Waking up in 15.60 seconds.\r\nOct  3 13:26:55 itasz0 journal: [2018-10-03 11:26:55,427: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[52f3e20d-d4e5-4cba-a5ae-a7dee8c72409] expires:[2018-10-03 11:27:15.421860+00:00]\r\nOct  3 13:26:55 itasz0 journal: [2018-10-03 11:26:55,427: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'52f3e20d-d4e5-4cba-a5ae-a7dee8c72409', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:27:15.421860+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'52f3e20d-d4e5-4cba-a5ae-a7dee8c72409', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'52f3e20d-d4e5-4cba-a5ae-a7dee8c72409', u'headers': {}}) kwargs:{})\r\nOct  3 13:26:55 itasz0 journal: [2018-10-03 11:26:55,433: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[52f3e20d-d4e5-4cba-a5ae-a7dee8c72409] pid:252\r\nOct  3 13:26:55 itasz0 journal: 2018-10-03 11:26:55,454 DEBUG    awx.main.scheduler Running Tower task manager.\r\nOct  3 13:26:55 itasz0 journal: 2018-10-03 11:26:55,471 DEBUG    awx.main.scheduler Starting Scheduler\r\nOct  3 13:26:55 itasz0 journal: [2018-10-03 11:26:55,551: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[52f3e20d-d4e5-4cba-a5ae-a7dee8c72409] succeeded in 0.121312379022s: None\r\nOct  3 13:27:01 itasz0 journal: RESULT 2\r\nOct  3 13:27:01 itasz0 journal: OKREADY\r\nOct  3 13:27:01 itasz0 journal: RESULT 2\r\nOct  3 13:27:01 itasz0 journal: OKREADY\r\nOct  3 13:27:11 itasz0 journal: [2018-10-03 11:27:11,032: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\nOct  3 13:27:11 itasz0 journal: [2018-10-03 11:27:11,035: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->a2ed4f9d-d42c-46df-834a-3e22a77373b8\r\nOct  3 13:27:11 itasz0 journal: [2018-10-03 11:27:11,035: DEBUG/Beat] beat: Waking up in 4.38 seconds.\r\nOct  3 13:27:11 itasz0 journal: [2018-10-03 11:27:11,039: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[a2ed4f9d-d42c-46df-834a-3e22a77373b8] expires:[2018-10-03 11:27:31.033692+00:00]\r\nOct  3 13:27:11 itasz0 journal: [2018-10-03 11:27:11,040: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.tasks.awx_periodic_scheduler', u'a2ed4f9d-d42c-46df-834a-3e22a77373b8', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:27:31.033692+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.awx_periodic_scheduler', u'callbacks': None, u'correlation_id': u'a2ed4f9d-d42c-46df-834a-3e22a77373b8', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'a2ed4f9d-d42c-46df-834a-3e22a77373b8', u'headers': {}}) kwargs:{})\r\nOct  3 13:27:11 itasz0 journal: [2018-10-03 11:27:11,042: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[a2ed4f9d-d42c-46df-834a-3e22a77373b8] pid:251\r\nOct  3 13:27:11 itasz0 journal: 2018-10-03 11:27:11,065 DEBUG    awx.main.tasks Last scheduler run was: 2018-10-03 11:26:41.060710+00:00\r\nOct  3 13:27:11 itasz0 journal: [2018-10-03 11:27:11,113: INFO/MainProcess] Task awx.main.tasks.awx_periodic_scheduler[a2ed4f9d-d42c-46df-834a-3e22a77373b8] succeeded in 0.0712597600068s: None\r\nOct  3 13:27:15 itasz0 journal: 2018-10-03 11:27:15.403 [info] <0.6874.6> accepting AMQP connection <0.6874.6> (172.17.0.6:57222 -> 172.17.0.4:5672)\r\nOct  3 13:27:15 itasz0 journal: 2018-10-03 11:27:15.416 [info] <0.6874.6> connection <0.6874.6> (172.17.0.6:57222 -> 172.17.0.4:5672): user 'guest' authenticated and granted access to vhost 'awx'\r\nOct  3 13:27:15 itasz0 journal: [2018-10-03 11:27:15,421: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\nOct  3 13:27:15 itasz0 journal: [2018-10-03 11:27:15,424: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->c894ec6c-9ccf-4165-b8c5-fa59f9c4dc88\r\nOct  3 13:27:15 itasz0 journal: [2018-10-03 11:27:15,425: DEBUG/Beat] beat: Waking up in 19.47 seconds.\r\nOct  3 13:27:15 itasz0 journal: [2018-10-03 11:27:15,429: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[c894ec6c-9ccf-4165-b8c5-fa59f9c4dc88] expires:[2018-10-03 11:27:35.423086+00:00]\r\nOct  3 13:27:15 itasz0 journal: [2018-10-03 11:27:15,430: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'c894ec6c-9ccf-4165-b8c5-fa59f9c4dc88', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:27:35.423086+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'c894ec6c-9ccf-4165-b8c5-fa59f9c4dc88', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'c894ec6c-9ccf-4165-b8c5-fa59f9c4dc88', u'headers': {}}) kwargs:{})\r\nOct  3 13:27:15 itasz0 journal: [2018-10-03 11:27:15,437: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[c894ec6c-9ccf-4165-b8c5-fa59f9c4dc88] pid:253\r\nOct  3 13:27:15 itasz0 journal: [2018-10-03 11:27:15,445: DEBUG/MainProcess] pidbox received method ping() [reply_to:{u'routing_key': u'b1b71947-0897-3c6e-82df-b00dda7c02c4', u'exchange': u'reply.celery.pidbox'} ticket:e46dfad9-872b-45a0-9c8a-b0f1796855b0]\r\nOct  3 13:27:15 itasz0 journal: 2018-10-03 11:27:15.461 [info] <0.6874.6> closing AMQP connection <0.6874.6> (172.17.0.6:57222 -> 172.17.0.4:5672, vhost: 'awx', user: 'guest')\r\nOct  3 13:27:15 itasz0 journal: 2018-10-03 11:27:15,463 DEBUG    awx.main.scheduler Running Tower task manager.\r\nOct  3 13:27:15 itasz0 journal: 2018-10-03 11:27:15,480 DEBUG    awx.main.scheduler Starting Scheduler\r\nOct  3 13:27:15 itasz0 journal: [2018-10-03 11:27:15,562: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[c894ec6c-9ccf-4165-b8c5-fa59f9c4dc88] succeeded in 0.130253429001s: None\r\nOct  3 13:27:34 itasz0 journal: [2018-10-03 11:27:34,899: INFO/Beat] Scheduler: Sending due task cluster_heartbeat (awx.main.tasks.cluster_node_heartbeat)\r\nOct  3 13:27:34 itasz0 journal: [2018-10-03 11:27:34,901: DEBUG/Beat] awx.main.tasks.cluster_node_heartbeat sent. id->c0c52d38-261a-4864-a7d9-8c0852f72435\r\nOct  3 13:27:34 itasz0 journal: [2018-10-03 11:27:34,902: DEBUG/Beat] beat: Waking up now.\r\nOct  3 13:27:34 itasz0 journal: [2018-10-03 11:27:34,906: INFO/MainProcess] Received task: awx.main.tasks.cluster_node_heartbeat[c0c52d38-261a-4864-a7d9-8c0852f72435] expires:[2018-10-03 11:28:24.900333+00:00]\r\nOct  3 13:27:34 itasz0 journal: [2018-10-03 11:27:34,907: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.tasks.cluster_node_heartbeat', u'c0c52d38-261a-4864-a7d9-8c0852f72435', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx', u'exchange': u'awx'}, u'expires': u'2018-10-03T11:28:24.900333+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.cluster_node_heartbeat', u'callbacks': None, u'correlation_id': u'c0c52d38-261a-4864-a7d9-8c0852f72435', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'c0c52d38-261a-4864-a7d9-8c0852f72435', u'headers': {}}) kwargs:{})\r\nOct  3 13:27:34 itasz0 journal: [2018-10-03 11:27:34,909: DEBUG/MainProcess] Task accepted: awx.main.tasks.cluster_node_heartbeat[c0c52d38-261a-4864-a7d9-8c0852f72435] pid:252\r\nOct  3 13:27:34 itasz0 journal: 2018-10-03 11:27:34,927 DEBUG    awx.main.tasks Cluster node heartbeat task.\r\nOct  3 13:27:34 itasz0 journal: [2018-10-03 11:27:34,959: INFO/MainProcess] Task awx.main.tasks.cluster_node_heartbeat[c0c52d38-261a-4864-a7d9-8c0852f72435] succeeded in 0.0506047030212s: None\r\nOct  3 13:27:35 itasz0 journal: [2018-10-03 11:27:35,422: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\nOct  3 13:27:35 itasz0 journal: [2018-10-03 11:27:35,425: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->8bc40d2e-b336-45f3-929e-3a43a99d01ec\r\nOct  3 13:27:35 itasz0 journal: [2018-10-03 11:27:35,426: DEBUG/Beat] beat: Waking up in 5.60 seconds.\r\nOct  3 13:27:35 itasz0 journal: [2018-10-03 11:27:35,428: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[8bc40d2e-b336-45f3-929e-3a43a99d01ec] expires:[2018-10-03 11:27:55.423724+00:00]\r\nOct  3 13:27:35 itasz0 journal: [2018-10-03 11:27:35,428: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'8bc40d2e-b336-45f3-929e-3a43a99d01ec', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:27:55.423724+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'8bc40d2e-b336-45f3-929e-3a43a99d01ec', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'8bc40d2e-b336-45f3-929e-3a43a99d01ec', u'headers': {}}) kwargs:{})\r\nOct  3 13:27:35 itasz0 journal: [2018-10-03 11:27:35,433: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[8bc40d2e-b336-45f3-929e-3a43a99d01ec] pid:251\r\nOct  3 13:27:35 itasz0 journal: 2018-10-03 11:27:35,452 DEBUG    awx.main.scheduler Running Tower task manager.\r\nOct  3 13:27:35 itasz0 journal: 2018-10-03 11:27:35,468 DEBUG    awx.main.scheduler Starting Scheduler\r\nOct  3 13:27:35 itasz0 journal: [2018-10-03 11:27:35,545: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[8bc40d2e-b336-45f3-929e-3a43a99d01ec] succeeded in 0.114750840992s: None\r\nOct  3 13:27:41 itasz0 journal: [2018-10-03 11:27:41,033: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\nOct  3 13:27:41 itasz0 journal: [2018-10-03 11:27:41,035: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->818626ea-8999-4c59-a7cb-d33be2de1466\r\nOct  3 13:27:41 itasz0 journal: [2018-10-03 11:27:41,036: DEBUG/Beat] beat: Waking up in 14.38 seconds.\r\nOct  3 13:27:41 itasz0 journal: [2018-10-03 11:27:41,039: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[818626ea-8999-4c59-a7cb-d33be2de1466] expires:[2018-10-03 11:28:01.034520+00:00]\r\nOct  3 13:27:41 itasz0 journal: [2018-10-03 11:27:41,039: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.tasks.awx_periodic_scheduler', u'818626ea-8999-4c59-a7cb-d33be2de1466', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:28:01.034520+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.awx_periodic_scheduler', u'callbacks': None, u'correlation_id': u'818626ea-8999-4c59-a7cb-d33be2de1466', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'818626ea-8999-4c59-a7cb-d33be2de1466', u'headers': {}}) kwargs:{})\r\nOct  3 13:27:41 itasz0 journal: [2018-10-03 11:27:41,044: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[818626ea-8999-4c59-a7cb-d33be2de1466] pid:253\r\nOct  3 13:27:41 itasz0 journal: 2018-10-03 11:27:41,064 DEBUG    awx.main.tasks Last scheduler run was: 2018-10-03 11:27:11.062971+00:00\r\nOct  3 13:27:41 itasz0 journal: [2018-10-03 11:27:41,109: INFO/MainProcess] Task awx.main.tasks.awx_periodic_scheduler[818626ea-8999-4c59-a7cb-d33be2de1466] succeeded in 0.0681440309854s: None\r\nOct  3 13:27:51 itasz0 journal: 2018/10/03 11:27:51 [error] 138#0: *777 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 172.17.0.7, server: _, request: \"POST /api/v2/job_templates/16/callback/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"itasz0.intra.infotn.it\"\r\n**Oct  3 13:27:51 itasz0 journal: 172.20.0.84 - - [03/Oct/2018:11:27:51 +0000] \"POST /api/v2/job_templates/16/callback/ HTTP/1.1\" 504 183 \"-\" \"curl/7.29.0\"\r\nOct  3 13:27:51 itasz0 journal: 172.17.0.7 - - [03/Oct/2018:11:27:51 +0000] \"POST /api/v2/job_templates/16/callback/ HTTP/1.1\" 504 183 \"-\" \"curl/7.29.0\" \"172.20.0.84\"\r\nOct  3 13:27:52 itasz0 journal: Wed Oct  3 11:27:52 2018 - *** HARAKIRI ON WORKER 3 (pid: 135, try: 1) ***\r\nOct  3 13:27:52 itasz0 journal: Wed Oct  3 11:27:52 2018 - HARAKIRI !!! worker 3 status !!!\r\nOct  3 13:27:52 itasz0 journal: Wed Oct  3 11:27:52 2018 - HARAKIRI [core 0] 172.17.0.7 - POST /api/v2/job_templates/16/callback/ since 1538565951**\r\nOct  3 13:27:52 itasz0 journal: Wed Oct  3 11:27:52 2018 - HARAKIRI !!! end of worker 3 status !!!\r\nOct  3 13:27:52 itasz0 journal: 2018-10-03 11:27:52.757 [warning] <0.23326.4> closing AMQP connection <0.23326.4> (172.17.0.5:56654 -> 172.17.0.4:5672, vhost: 'awx', user: 'guest'):\r\nOct  3 13:27:52 itasz0 journal: client unexpectedly closed TCP connection\r\nOct  3 13:27:52 itasz0 journal: 2018-10-03 11:27:52.758 [warning] <0.23336.4> closing AMQP connection <0.23336.4> (172.17.0.5:56656 -> 172.17.0.4:5672, vhost: 'awx', user: 'guest'):\r\nOct  3 13:27:52 itasz0 journal: client unexpectedly closed TCP connection\r\nOct  3 13:27:53 itasz0 journal: DAMN ! worker 3 (pid: 135) died, killed by signal 9 :( trying respawn ...\r\nOct  3 13:27:53 itasz0 journal: Respawned uWSGI worker 3 (new pid: 242)\r\nOct  3 13:27:55 itasz0 journal: [2018-10-03 11:27:55,424: DEBUG/Beat] beat: Synchronizing schedule...\r\nOct  3 13:27:55 itasz0 journal: [2018-10-03 11:27:55,431: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\nOct  3 13:27:55 itasz0 journal: [2018-10-03 11:27:55,433: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->14ea7a51-d7e0-4325-8631-6c082dabaae8\r\nOct  3 13:27:55 itasz0 journal: [2018-10-03 11:27:55,434: DEBUG/Beat] beat: Waking up in 15.59 seconds.\r\nOct  3 13:27:55 itasz0 journal: [2018-10-03 11:27:55,437: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[14ea7a51-d7e0-4325-8631-6c082dabaae8] expires:[2018-10-03 11:28:15.432608+00:00]\r\nOct  3 13:27:55 itasz0 journal: [2018-10-03 11:27:55,438: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'14ea7a51-d7e0-4325-8631-6c082dabaae8', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:28:15.432608+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'14ea7a51-d7e0-4325-8631-6c082dabaae8', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'14ea7a51-d7e0-4325-8631-6c082dabaae8', u'headers': {}}) kwargs:{})\r\nOct  3 13:27:55 itasz0 journal: [2018-10-03 11:27:55,443: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[14ea7a51-d7e0-4325-8631-6c082dabaae8] pid:252\r\nOct  3 13:27:55 itasz0 journal: 2018-10-03 11:27:55,461 DEBUG    awx.main.scheduler Running Tower task manager.\r\nOct  3 13:27:55 itasz0 journal: 2018-10-03 11:27:55,712 DEBUG    awx.main.scheduler Starting Scheduler\r\nOct  3 13:27:55 itasz0 journal: [2018-10-03 11:27:55,753: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[14ea7a51-d7e0-4325-8631-6c082dabaae8] succeeded in 0.313178937999s: None\r\nOct  3 13:27:57 itasz0 journal: WSGI app 0 (mountpoint='') ready in 4 seconds on interpreter 0x1bbfc30 pid: 242 (default app)\r\nOct  3 13:28:01 itasz0 journal: RESULT 2\r\nOct  3 13:28:01 itasz0 journal: OKREADY\r\nOct  3 13:28:01 itasz0 journal: RESULT 2\r\nOct  3 13:28:01 itasz0 journal: OKREADY\r\nOct  3 13:28:11 itasz0 journal: [2018-10-03 11:28:11,034: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\nOct  3 13:28:11 itasz0 journal: [2018-10-03 11:28:11,036: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->c4b8f340-9e56-4c60-8e69-07b32c666646\r\nOct  3 13:28:11 itasz0 journal: [2018-10-03 11:28:11,037: DEBUG/Beat] beat: Waking up in 4.38 seconds.\r\nOct  3 13:28:11 itasz0 journal: [2018-10-03 11:28:11,041: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[c4b8f340-9e56-4c60-8e69-07b32c666646] expires:[2018-10-03 11:28:31.035410+00:00]\r\nOct  3 13:28:11 itasz0 journal: [2018-10-03 11:28:11,042: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fab20209320> (args:(u'awx.main.tasks.awx_periodic_scheduler', u'c4b8f340-9e56-4c60-8e69-07b32c666646', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-10-03T11:28:31.035410+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.awx_periodic_scheduler', u'callbacks': None, u'correlation_id': u'c4b8f340-9e56-4c60-8e69-07b32c666646', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'1352fc63-6300-3aa9-99b8-aabe871f9a2b', u'id': u'c4b8f340-9e56-4c60-8e69-07b32c666646', u'headers': {}}) kwargs:{})\r\nOct  3 13:28:11 itasz0 journal: [2018-10-03 11:28:11,046: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[c4b8f340-9e56-4c60-8e69-07b32c666646] pid:251\r\nOct  3 13:28:11 itasz0 journal: 2018-10-03 11:28:11,067 DEBUG    awx.main.tasks Last scheduler run was: 2018-10-03 11:27:41.061800+00:00\r\nOct  3 13:28:11 itasz0 journal: [2018-10-03 11:28:11,114: INFO/MainProcess] Task awx.main.tasks.awx_periodic_scheduler[c4b8f340-9e56-4c60-8e69-07b32c666646] succeeded in 0.0700874640024s: None\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWe should give a 400 message if a user tries to use \"ANSIBLE_\" environment variables in a custom credential type. See:\r\n\r\nhttps://docs.ansible.com/ansible-tower/latest/html/userguide/credential_types.html\r\n\r\n> Also, avoid environment variable or extra variable names that start with ANSIBLE_ because they are reserved.\r\n\r\nIt's not obvious what the actual behavior in this case is, but I believe that they are ignored.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nJob relaunch has something weird happening when the JT credentials have changed since the prior launch\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - Create a new custom credential type\r\n - create 2 credentials of this type\r\n - launch a JT using the first of those credentials (not a prompt, on the JT)\r\n - modify JT to use 2nd of those credentials\r\n - relaunch the first job\r\n\r\n##### EXPECTED RESULTS\r\n\r\nrelaunched job has 2nd credential\r\n\r\n##### ACTUAL RESULTS\r\n\r\nrelaunched job has both credentials (note: they are of same type, which is a violation of our rules).\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nThere is no way to tell at a glance if a project update actually detected any change in the repo that it syncs. It would be nice to show this information.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe API currently doesn't deliver this info on the project update level. Even the playbook output doesn't give this information.\r\n\r\nPut in terms of git, my question for the API is: \"when you ran the update, did you find any new commits?\"\r\n\r\nsuggested icon: 🍞 \r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nWhile creating groups/hosts in inventory return GET returned: 500 A server error has occurred in UI.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8\r\n* AWX install method: docker compose on linux\r\n* Ansible version:  (N/A)\r\n* Operating System: Centos7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAfter creating inventory try adding group/host. It fails.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nGroups/Hosts should be created in inventory.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nLogs for groups creation:\r\n\r\nCall to /api/v2/groups/. GET returned: 500 A server error has occurred.\r\n```\r\n2018-10-01 12:29:51,217 ERROR    django.request Internal Server Error: /api/v2/hosts/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 71, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 328, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 244, in post\r\n    return self.create(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 21, in create\r\n    self.perform_create(serializer)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 26, in perform_create\r\n    serializer.save()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 214, in save\r\n    self.instance = self.create(validated_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 917, in create\r\n    instance = ModelClass.objects.create(**validated_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\", line 85, in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 394, in create\r\n    obj.save(force_insert=True, using=self.db)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\", line 700, in save\r\n    super(Host, self).save(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/base.py\", line 316, in save\r\n    super(PrimordialModel, self).save(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/base.py\", line 164, in save\r\n    super(CreatedModifiedModel, self).save(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\", line 808, in save\r\n    force_update=force_update, update_fields=update_fields)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\", line 848, in save_base\r\n    update_fields=update_fields, raw=raw, using=using,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/dispatch/dispatcher.py\", line 193, in send\r\n    for receiver in self._live_receivers(sender)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/signals.py\", line 155, in emit_update_inventory_on_created_or_deleted\r\n    update_inventory_computed_fields.delay(inventory.id, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 461, in delay\r\n    return self.apply_async(args, kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 573, in apply_async\r\n    **dict(self._get_exec_options(), **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/base.py\", line 354, in send_task\r\n    reply_to=reply_to or self.oid, **options\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/amqp.py\", line 310, in publish_task\r\n    **kwargs\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 172, in publish\r\n    routing_key, mandatory, immediate, exchange, declare)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 470, in _ensured\r\n    interval_max)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 382, in ensure_connection\r\n    interval_start, interval_step, interval_max, callback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/utils/__init__.py\", line 246, in retry_over_time\r\n    return fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 250, in connect\r\n    return self.connection\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 756, in connection\r\n    self._connection = self._establish_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 711, in _establish_connection\r\n    conn = self.transport.establish_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/transport/pyamqp.py\", line 116, in establish_connection\r\n    conn = self.Connection(**opts)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 180, in __init__\r\n    (10, 30),  # tune\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/abstract_channel.py\", line 67, in wait\r\n    self.channel_id, allowed_methods, timeout)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 241, in _wait_method\r\n    channel, method_sig, args, content = read_timeout(timeout)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 330, in read_timeout\r\n    return self.method_reader.read_method()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/method_framing.py\", line 189, in read_method\r\n    raise m\r\nerror: [Errno 104] Connection reset by peer\r\n2018-10-01 12:29:51,217 ERROR    django.request Internal Server Error: /api/v2/hosts/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 71, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 328, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 244, in post\r\n    return self.create(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 21, in create\r\n    self.perform_create(serializer)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 26, in perform_create\r\n    serializer.save()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 214, in save\r\n    self.instance = self.create(validated_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 917, in create\r\n    instance = ModelClass.objects.create(**validated_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\", line 85, in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 394, in create\r\n    obj.save(force_insert=True, using=self.db)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\", line 700, in save\r\n    super(Host, self).save(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/base.py\", line 316, in save\r\n    super(PrimordialModel, self).save(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/base.py\", line 164, in save\r\n    super(CreatedModifiedModel, self).save(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\", line 808, in save\r\n    force_update=force_update, update_fields=update_fields)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\", line 848, in save_base\r\n    update_fields=update_fields, raw=raw, using=using,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/dispatch/dispatcher.py\", line 193, in send\r\n    for receiver in self._live_receivers(sender)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/signals.py\", line 155, in emit_update_inventory_on_created_or_deleted\r\n    update_inventory_computed_fields.delay(inventory.id, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 461, in delay\r\n    return self.apply_async(args, kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 573, in apply_async\r\n    **dict(self._get_exec_options(), **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/base.py\", line 354, in send_task\r\n    reply_to=reply_to or self.oid, **options\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/amqp.py\", line 310, in publish_task\r\n    **kwargs\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 172, in publish\r\n    routing_key, mandatory, immediate, exchange, declare)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 470, in _ensured\r\n    interval_max)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 382, in ensure_connection\r\n    interval_start, interval_step, interval_max, callback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/utils/__init__.py\", line 246, in retry_over_time\r\n    return fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 250, in connect\r\n    return self.connection\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 756, in connection\r\n    self._connection = self._establish_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 711, in _establish_connection\r\n    conn = self.transport.establish_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/transport/pyamqp.py\", line 116, in establish_connection\r\n    conn = self.Connection(**opts)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 180, in __init__\r\n    (10, 30),  # tune\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/abstract_channel.py\", line 67, in wait\r\n    self.channel_id, allowed_methods, timeout)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 241, in _wait_method\r\n    channel, method_sig, args, content = read_timeout(timeout)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 330, in read_timeout\r\n    return self.method_reader.read_method()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/method_framing.py\", line 189, in read_method\r\n    raise m\r\nerror: [Errno 104] Connection reset by peer\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nSuperuser trying to add JT get permission error if there are no inventories or projects in system.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nDo a fresh install without create_preload_data, and go to add JT as superuser\r\n\r\n##### EXPECTED RESULTS\r\n\r\nError message, or ordinary failure to save.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n![screen shot 2018-09-28 at 11 57 17 am](https://user-images.githubusercontent.com/1385596/46219984-d250af00-c316-11e8-99c3-41b5fda9e490.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNot a permissions problem - problem that no projects exist.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nSuddenly Jobs are not startet any more while no SCM or inventory update is running.\r\nScheduled Jobs are not launched by scheduler\r\nAPI launched Jobs (from external API call) are stuck in status pending.\r\nrestart of docker service fixed the issue\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.23\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.0\r\n* Operating System: Debian\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSchedule reoccuring Jobs and launch Jobs via API\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJobs are getting startet\r\n\r\n##### ACTUAL RESULTS\r\n\r\nexternally triggered Jobs are remaining in status Pending\r\nJobs which should be startet via Scheduler are not in the list of Jobs\r\n\"Next run\" info in Schedules remains unchanged (showing start times in the past)\r\n\r\n##### ADDITIONAL INFORMATION\r\ndocker logs of awx_task container\r\nafter restart I found the following in the log:\r\n```\r\n{\"log\":\"2018-09-28 05:26:16,736 DEBUG    awx.main.tasks Last scheduler run was: 2018-09-27 20:55:53.147719+00:00\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T05:26:\r\n16.736377625Z\"}\r\n```\r\n\r\nattached the log from 2018-09-27 20:50 until 20:59:59\r\nstarting from 20:56:24 you only see the following in the logs\r\n\r\n```\r\n {\"log\":\"[2018-09-27 20:56:24,061: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-27T20:56:24.061669848Z\"}\r\n{\"log\":\"[2018-09-27 20:56:24,066: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id-\\u003edc103d16-7e5b-4e6a-b135-b1eb5d2f22b8\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-27T20:56:24.067137983Z\"}\r\n{\"log\":\"[2018-09-27 20:56:24,067: DEBUG/Beat] beat: Waking up in 19.97 seconds.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-27T20:56:24.067373892Z\"}\r\n{\"log\":\"[2018-09-27 20:56:44,056: INFO/Beat] Scheduler: Sending due task cluster_heartbeat (awx.main.tasks.cluster_node_heartbeat)\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-27T20:56:44.057362133Z\"}\r\n{\"log\":\"[2018-09-27 20:56:44,060: DEBUG/Beat] awx.main.tasks.cluster_node_heartbeat sent. id-\\u003e46421beb-fb5d-4bd4-af1d-1d66c39dad7d\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-27T20:56:44.060881477Z\"}\r\n```\r\n\r\nI thought it might be related to instance capacity/processes because the last thing I see is:\r\n```\r\n{\"log\":\"[2018-09-27 20:56:23,149: INFO/MainProcess] Scaling down -1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-27T20:56:23.149595956Z\"}\r\n```\r\n\r\nFurthermore it looks like instance is scaling down more than scaling up:\r\nI started changing the capacity_adjustment of instance from 1.00 (Memory) to 0.00 (CPU) and I wonder whether this helps.\r\n\r\n```\r\n{\"log\":\"[2018-09-28 09:27:26,132: INFO/MainProcess] Scaling down -3 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:27:26.132673173Z\"}\r\n{\"log\":\"[2018-09-28 09:27:30,001: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:27:30.002108791Z\"}\r\n{\"log\":\"[2018-09-28 09:27:48,962: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:27:48.962273731Z\"}\r\n{\"log\":\"[2018-09-28 09:27:49,138: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:27:49.138946462Z\"}\r\n{\"log\":\"[2018-09-28 09:28:26,132: INFO/MainProcess] Scaling down -1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:28:26.13348587Z\"}\r\n{\"log\":\"[2018-09-28 09:28:56,133: INFO/MainProcess] Scaling down -2 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:28:56.134365572Z\"}\r\n{\"log\":\"[2018-09-28 09:29:26,134: INFO/MainProcess] Scaling down -3 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:29:26.134626231Z\"}\r\n{\"log\":\"[2018-09-28 09:29:30,032: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:29:30.032987995Z\"}\r\n{\"log\":\"[2018-09-28 09:29:48,990: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:29:48.990238687Z\"}\r\n{\"log\":\"[2018-09-28 09:30:18,994: INFO/MainProcess] Scaling down -3 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:30:18.99447223Z\"}\r\n{\"log\":\"[2018-09-28 09:30:49,005: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:30:49.006195266Z\"}\r\n{\"log\":\"[2018-09-28 09:31:19,008: INFO/MainProcess] Scaling down -3 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:31:19.008233247Z\"}\r\n{\"log\":\"[2018-09-28 09:31:49,009: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:31:49.010075886Z\"}\r\n{\"log\":\"[2018-09-28 09:32:26,135: INFO/MainProcess] Scaling down -2 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:32:26.136512598Z\"}\r\n{\"log\":\"[2018-09-28 09:32:49,016: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:32:49.016604429Z\"}\r\n{\"log\":\"[2018-09-28 09:32:49,175: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:32:49.175469118Z\"}\r\n{\"log\":\"[2018-09-28 09:33:26,139: INFO/MainProcess] Scaling down -1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:33:26.14010445Z\"}\r\n{\"log\":\"[2018-09-28 09:33:56,140: INFO/MainProcess] Scaling down -2 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:33:56.141252878Z\"}\r\n{\"log\":\"[2018-09-28 09:34:26,141: INFO/MainProcess] Scaling down -3 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:34:26.142342344Z\"}\r\n{\"log\":\"[2018-09-28 09:34:30,123: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:34:30.123584014Z\"}\r\n{\"log\":\"[2018-09-28 09:34:49,043: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:34:49.043294456Z\"}\r\n{\"log\":\"[2018-09-28 09:35:19,047: INFO/MainProcess] Scaling down -3 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:35:19.047962042Z\"}\r\n{\"log\":\"[2018-09-28 09:35:49,048: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:35:49.049048538Z\"}\r\n{\"log\":\"[2018-09-28 09:35:49,196: INFO/MainProcess] Scaling up 1 processes.\\n\",\"stream\":\"stderr\",\"time\":\"2018-09-28T09:35:49.197025915Z\"}\r\n```\r\n[logs_20180927.txt](https://github.com/ansible/awx/files/2427727/logs_20180927.txt)\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Help request\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt`s posible to add git credential as extra credentials to job template???\r\nBecause I need to clone project in my tasks and I have error: \"Could not read from remote repository.\\n\\nPlease make sure you have the correct access rights\\nand the repository exists\"\r\nAnd I do not understand how to solve this\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8.\r\n* AWX install method: docker on linux,\r\n* Ansible version:  2.6.4 \r\n* Operating System Linux:\r\n* Web Browser Firefox/Chrome:\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAWX should work seamlessly with existing inline-vaulted variable inventories in the recommended Ansible Alternative Directory Layout.\r\n\r\n##### ADDITIONAL INFORMATION\r\n- When running the inventory sync, despite having entered the vault password in a credential, vault variables for some reason don't work -- i.e. we get \"ERROR!  Attempting to decrypt but no vault secrets found.\""},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nFrom https://docs.ansible.com/ansible/2.6/scenario_guides/guide_azure.html#providing-credentials-to-azure-modules:\r\n\r\n...\r\n\r\nUsing Environment Variables\r\n\r\nTo pass service principal credentials via the environment, define the following variables:\r\n\r\n    AZURE_CLIENT_ID\r\n    AZURE_SECRET\r\n    AZURE_SUBSCRIPTION_ID\r\n    AZURE_TENANT\r\n\r\nTo pass Active Directory username/password via the environment, define the following variables:\r\n\r\n    AZURE_AD_USER\r\n    AZURE_PASSWORD\r\n\r\nTo pass Active Directory username/password in ADFS via the environment, define the following variables:\r\n\r\n    AZURE_AD_USER\r\n    AZURE_PASSWORD\r\n    AZURE_CLIENT_ID\r\n    AZURE_TENANT\r\n    AZURE_ADFS_AUTHORITY_URL\r\n\r\n“AZURE_ADFS_AUTHORITY_URL” is optional. It’s necessary only when you have own ADFS authority like https://xxx.com/adfs.\r\n...\r\n\r\nWe do not support all of these in the current Azure credential.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe user serializer provides the `auth` field but it is not present in OPTIONS\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGET `/api/v2/users/`\r\n\r\nOPTIONS `/api/v2/users/`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFields match, GET vs. OPTIONS\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`auth` field returned but not in options.\r\n\r\nAlso, the field is not present in the access_list endpoints, and I would argue that it should be.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\nGreat feature which will help not to worry about Survey creation/synchronization for Templates.\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nAdd a checkbox option for templates which will allow to reuse vars_prompt from linked playbooks source.\r\nImplementation: parsing playbook YAML on launch.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n- Dynamic Inventory\r\n\r\n##### SUMMARY\r\nAs a writer of a custom dynamic inventory script, I want to be able to decide which host will be activated/deactivated in Tower so that this Host status can be based on information from my inventory source"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen executing a job I've noticed that (sometimes) it will state that the job failed by executing \"notification\" email stating failure. However, if you login and pull up the job activity it states the job was successful, but shows the following error \"Task was marked as running in Tower but was not present in the job queue, so it has been marked as failed.\"\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.4\r\n* AWX install method: Kubernetes\r\n* Ansible version:  2.6.4\r\n* Operating System: Kubernetes / Docker\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis doesn't seem to always occur. However occasionally cause false positive email going to users stating job \"failed\" when it was successful.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSuccessful template being sent to users not failed\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAWX sending job notification for job failure instead of successful. However states  \"Task was marked as running in Tower but was not present in the job queue, so it has been marked as failed\" when accessing the job id in the UI or API.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n3 PODs Running\r\n![screen shot 2018-09-19 at 11 05 19 am](https://user-images.githubusercontent.com/25063770/45774078-f1598d80-bc00-11e8-982b-5ad9453507bf.png)\r\n\r\nFailed Email Notification Template Sent to User\r\n<img width=\"303\" alt=\"screen shot 2018-09-19 at 11 42 25 am\" src=\"https://user-images.githubusercontent.com/25063770/45774170-2665e000-bc01-11e8-8590-56acdc27f234.png\">\r\n\r\nJob Successful but failure notice below Successful!\r\n![screen shot 2018-09-19 at 11 43 33 am](https://user-images.githubusercontent.com/25063770/45774217-45647200-bc01-11e8-961c-17d5597f653a.png)\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n \r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n- It would be nice to have an Export and Import feature in the UI\r\n- The current command line equivalent is receive and send with tower-cli\r\n##### ADDITIONAL INFORMATION\r\n\r\ntower-cli send and receive commands to export and import resources:\r\n\r\nhttps://github.com/ansible/tower-cli/tree/v3.3.0/tower_cli/cli/transfer\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nEven if \"forced\" by using the configuration files, the SSH host keys are explicitly not checked\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.2\r\n* AWX install method: openshift\r\n* Ansible version:  2.6.2\r\n* Web Browser: Firefox 62.0\r\n\r\n##### STEPS TO REPRODUCE\r\n- Create a playbook repo with ansible.cfg as shown below and import in AWX\r\n- Run it on a target host\r\n\r\n##### EXPECTED RESULTS\r\n```\r\nSSH: EXEC ssh -vvv -F sshop_config1 -o StrictHostKeyChecking=yes -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=ansible_test -o ConnectTimeout=10 redacted-target-host '/bin/sh -c '\"'\"'echo ~ansible_test && sleep 0'\"'\"''\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nSSH: EXEC ssh -vvv -F sshop_config1 -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=ansible_test -o ConnectTimeout=10 redacted-target-host '/bin/sh -c '\"'\"'echo ~ansible_test && sleep 0'\"'\"''\r\n```\r\n--> notice StrictHostKeyChecking parameter. For some reason it does get added, which overrides the one defined in ansible.cfg and sshop_config1 file.\r\n\r\nFile ansible.cfg:\r\n```yaml\r\n[ssh_connection]\r\nssh_args = -F sshop_config1\r\nhost_key_checking = True\r\n```\r\nFile sshop_config1:\r\n```\r\nHost redacted-target-host\r\n    User ansible_test\r\n    StrictHostKeyChecking yes\r\n    UserKnownHostsFile {{ known_hosts_file }}\r\n    ProxyCommand ssh ansible_test@redacted-jump-host -W redacted-target-host:22\r\n    ControlMaster auto\r\nHost redacted-jump-host\r\n    User ansible_test\r\n    StrictHostKeyChecking yes\r\n    UserKnownHostsFile {{ known_hosts_file }}\r\n    Port 22\r\n    ControlMaster auto\r\n```\r\nsshop_known_hosts1 file:\r\n```\r\nredacted-target-host ssh-ed25519 AAAAC3...\r\nredacted-jump-host,aaa.bbb.ccc.ddd,2a06:c0<snip> ssh-ed25519 AAAAC3N\r\n```\r\nPlaybook:\r\n```yaml\r\n- hosts: localhost\r\n  connection: local\r\n  vars:\r\n    known_hosts_file: sshop_known_hosts1\r\n    ssh_config_file: sshop_config1\r\n  tasks:\r\n    - name: Create ssh config\r\n      delegate_to: localhost\r\n      connection: local\r\n      template:\r\n        src: templates/sshop_config.j2\r\n        dest: \"{{ ssh_config_file }}\"\r\n        mode: 0644\r\n    - name: Create known_hosts\r\n      delegate_to: localhost\r\n      connection: local\r\n      template:\r\n        src: templates/sshop_known_hosts.j2\r\n        dest: \"{{ known_hosts_file }}\"\r\n        mode: 0644\r\n\r\n- hosts: all\r\n  tasks:\r\n    - debug:\r\n        var: ansible_user_id\r\n    - debug:\r\n        var: ansible_ssh_common_args\r\n```\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe output is somewhat formatted for better readability\r\n```\r\n<redacted-target-host> SSH: EXEC ssh -vvv -F sshop_config1 -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=ansible_test -o ConnectTimeout=10 redacted-target-host '/bin/sh -c '\"'\"'echo ~ansible_test && sleep 0'\"'\"''\r\nhe authenticity of host 'redacted-jump-host (redacted-ipv4)' can't be established.\r\nED25519 key fingerprint is SHA256:CCpaTtY3o<snip>.\r\nED25519 key fingerprint is MD5:a7:bb:ff:a6:5a:82:a<snip>.\r\nAre you sure you want to continue connecting (yes/no)? \r\n<redacted-target-host> (255, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\r\ndebug1: Reading configuration data sshop_config1\r\ndebug1: sshop_config1 line 1: Applying options for redacted-target-host\r\ndebug1: Executing proxy command: exec ssh ansible_test@redacted-jump-host -W redacted-target-host:22\r\ndebug3: timeout: 10000 ms remain after connect\r\ndebug1: permanently_drop_suid: 1005720000\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /var/lib/awx/.ssh/id_rsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /var/lib/awx/.ssh/id_rsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /var/lib/awx/.ssh/id_dsa type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /var/lib/awx/.ssh/id_dsa-cert type -1\r\ndebug1: key_load_public: No such file or directory\r\ndebug1: identity file /var/lib/awx/.ssh/id_ecdsa type -1\r\ndeb…\r\n<cut-off by AWX>\r\n```\r\nThen the playbook fails with\r\n```\r\nfatal: [redacted-target-host]: UNREACHABLE! => {\r\n    \"changed\": false, \r\n    \"msg\": \"Failed to connect to the host via ssh: <see error above, beginning with \"OpenSSH...\">\r\n```\r\n* The SSH key file for both hosts is the same.\r\n* No variables are set on inventory, group or host"},{"labels":["api",null,null],"text":"\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nunknown component, docker environment\r\n\r\n##### SUMMARY\r\nI installed awx with docker as described in the installation manual. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.2\r\n* AWX install method:  docker on linux\r\n* Ansible version: 2.6.2\r\n* Operating System: RHEL 7.5\r\n* Web Browser: irrelevant\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI installed awx with docker as described in the installation manual. Nothing more. This is a fresh install of awx linux on docker with version 1.0.7.\r\n\r\nwget https://github.com/ansible/awx/archive/1.0.7.zip\r\nunzip 1.0.7.zip\r\nedit inventory file as attached\r\nansible-playbook -i inventory install.yml\r\nafter that login screen of awx is available and cpu usage rises\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expect the docker containers to run without generating a linux cpu load of 3+.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThere are three python processes that are spawned every second and every process generates a cpu load about 95%.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n[20180919_awx_inventory.txt](https://github.com/ansible/awx/files/2397096/20180919_awx_inventory.txt)\r\n\r\nProcess Commands:\r\npython /usr/bin/awx-manage runworker --only-channels websocket.*\r\npython /usr/bin/awx-manage run_callback_receiver\r\npython /usr/bin/awx-manage celery beat -l debug --pidfile= -s /var/lib/awx/beat.db\r\n \r\n\r\ndocker stats\r\nCONTAINER ID        NAME                CPU %               MEM USAGE / LIMIT     MEM %               NET I/O             BLOCK I/O           PIDS\r\n146f810299da        awx_task            1.29%               641.3MiB / 7.631GiB   8.21%               106MB / 133MB       0B / 8.63MB         18\r\n6dd58d2c2b95        awx_web             0.06%               667.8MiB / 7.631GiB   8.55%               5.33MB / 16.1MB     0B / 0B             13\r\n3379099a009d        memcached           0.02%               7.168MiB / 7.631GiB   0.09%               28.2MB / 19.2MB     0B / 0B             10\r\n0d7782c8f420        rabbitmq            1.49%               80.85MiB / 7.631GiB   1.03%               30.4MB / 30.3MB     90.1kB / 55.4MB     94\r\n203f2bd6e549        postgres            0.00%               5.898MiB / 7.631GiB   0.08%               76.7MB / 61.5MB     8.19kB / 1.2GB      8\r\n\r\n \r\n\r\ntop - 14:02:01 up 20:13,  1 user,  load average: 3.42, 3.50, 3.55\r\nTasks: 224 total,   4 running, 220 sleeping,   0 stopped,   0 zombie\r\n%Cpu(s): 74.3 us,  4.3 sy,  0.0 ni, 21.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\r\nKiB Mem :  8001364 total,  1880040 free,  1088352 used,  5032972 buff/cache\r\nKiB Swap:  2097148 total,  2097148 free,        0 used.  6465360 avail Mem\r\n\r\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\r\n18145 awx       20   0  392512  74760   8280 R  94.1  0.9   0:01.80 python\r\n18152 awx       20   0  380528  62788   8276 R  94.1  0.8   0:01.43 python\r\n18153 awx       20   0  380520  62784   8276 R  94.1  0.8   0:01.43 python\r\n 1049 awx       20   0  424588  99384   8688 S   5.9  1.2  14:38.19 daphne\r\n    1 root      20   0   54388   6584   3964 S   0.0  0.1   0:12.36 systemd\r\n    2 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kthreadd\r\n    3 root      20   0       0      0      0 S   0.0  0.0   0:14.17 ksoftirqd/0\r\n    5 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/0:0H\r\n    7 root      rt   0       0      0      0 S   0.0  0.0   0:02.25 migration/0\r\n    8 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcu_bh\r\n    9 root      20   0       0      0      0 S   0.0  0.0   1:31.70 rcu_sched\r\n   10 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 lru-add-drain\r\n   11 root      rt   0       0      0      0 S   0.0  0.0   0:00.23 watchdog/0\r\n   12 root      rt   0       0      0      0 S   0.0  0.0   0:00.19 watchdog/1\r\n   13 root      rt   0       0      0      0 S   0.0  0.0   0:02.00 migration/1\r\n   14 root      20   0       0      0      0 S   0.0  0.0   0:14.05 ksoftirqd/1\r\n   16 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/1:0H\r\n   17 root      rt   0       0      0      0 S   0.0  0.0   0:00.19 watchdog/2\r\n   18 root      rt   0       0      0      0 S   0.0  0.0   0:01.99 migration/2\r\n   19 root      20   0       0      0      0 S   0.0  0.0   0:14.10 ksoftirqd/2\r\n   21 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/2:0H\r\n   22 root      rt   0       0      0      0 S   0.0  0.0   0:00.19 watchdog/3\r\n   23 root      rt   0       0      0      0 S   0.0  0.0   0:02.00 migration/3\r\n   24 root      20   0       0      0      0 S   0.0  0.0   0:14.16 ksoftirqd/3\r\n   26 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/3:0H\r\n   28 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kdevtmpfs\r\n   29 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 netns\r\n   30 root      20   0       0      0      0 S   0.0  0.0   0:00.04 khungtaskd\r\n   31 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 writeback\r\n   32 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kintegrityd\r\n   33 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n   34 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n   35 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n   36 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kblockd\r\n   37 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 md\r\n   38 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 edac-poller\r\n   47 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kswapd0\r\n   48 root      25   5       0      0      0 S   0.0  0.0   0:00.00 ksmd\r\n   49 root      39  19       0      0      0 S   0.0  0.0   0:01.46 khugepaged\r\n   50 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 crypto\r\n   58 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kthrotld\r\n   59 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kmpath_rdacd\r\n   60 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kaluad\r\n   62 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kpsmoused\r\n   64 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ipv6_addrconf\r\n   77 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 deferwq\r\n  110 root      20   0       0      0      0 S   0.0  0.0   0:00.01 kauditd\r\n  302 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_0\r\n  303 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_0\r\n  304 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 vmw_pvscsi_wq_0\r\n  306 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ata_sff\r\n  308 root      20   0       0      0      0 S   0.0  0.0   0:00.01 scsi_eh_1\r\n  309 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_1\r\n  311 root      20   0       0      0      0 S   0.0  0.0   0:00.01 scsi_eh_2\r\n  312 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_2\r\n  322 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_3\r\n  323 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_3\r\n  324 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_4\r\n  326 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_4\r\n  328 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_5\r\n  329 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_5\r\n  330 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_6\r\n  331 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_6\r\n  332 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_7\r\n  333 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_7\r\n  334 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_8\r\n  335 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_8\r\n  336 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_9\r\n  337 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_9\r\n  338 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_10\r\n  339 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_10\r\n  340 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_11\r\n  341 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_11\r\n  342 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_12\r\n  343 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_12\r\n  344 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_13\r\n  345 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_13\r\n  346 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_14\r\n  347 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_14\r\n  348 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_15\r\n  349 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_15\r\n  350 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_16\r\n  351 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_16\r\n  352 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_17\r\n  353 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_17\r\n  354 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_18\r\n  355 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_18\r\n  356 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_19\r\n  357 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_19\r\n  358 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_20\r\n  359 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_20\r\n  360 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_21\r\n  361 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_21\r\n  362 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_22\r\n  363 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_22\r\n  364 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_23\r\n  365 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_23\r\n  366 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_24\r\n  367 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_24\r\n  368 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_25\r\n  369 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_25\r\n  370 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_26\r\n  371 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_26\r\n  372 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_27\r\n  373 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_27\r\n  374 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_28\r\n  375 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_28\r\n  376 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_29\r\n  377 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_29\r\n  378 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_30\r\n  379 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_30\r\n  380 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_31\r\n  381 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_31\r\n  382 root      20   0       0      0      0 S   0.0  0.0   0:00.00 scsi_eh_32\r\n  383 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 scsi_tmf_32\r\n  413 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ttm_swap\r\n  414 root     -51   0       0      0      0 S   0.0  0.0   0:00.00 irq/16-vmwgfx\r\n  446 root       0 -20       0      0      0 S   0.0  0.0   0:00.09 kworker/0:1H\r\n  487 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kdmflush\r\n  488 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n  498 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kdmflush\r\n  500 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n  509 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kdmflush\r\n  510 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n  524 root      20   0       0      0      0 S   0.0  0.0   0:00.02 jbd2/dm-0-8\r\n  525 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ext4-rsv-conver\r\n  555 root      20   0       0      0      0 S   0.0  0.0   0:00.02 jbd2/dm-2-8\r\n  556 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ext4-rsv-conver\r\n  607 root      20   0   39476   8592   8196 S   0.0  0.1   0:01.68 systemd-journal\r\n  625 root      20   0  201056   5672   2616 S   0.0  0.1   0:00.02 lvmetad\r\n  696 root       0 -20       0      0      0 S   0.0  0.0   0:00.01 kworker/1:1H\r\n  734 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n  735 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfsalloc\r\n  736 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfs_mru_cache\r\n  737 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfs-buf/sda1\r\n  738 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfs-data/sda1\r\n  739 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfs-conv/sda1\r\n  740 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfs-cil/sda1\r\n  741 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfs-reclaim/sda\r\n  742 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfs-log/sda1\r\n  743 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xfs-eofblocks/s\r\n  744 root      20   0       0      0      0 S   0.0  0.0   0:00.01 xfsaild/sda1\r\n  746 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kdmflush\r\n  749 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kdmflush\r\n  750 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n  754 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kdmflush\r\n  755 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n  757 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kdmflush\r\n  758 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n  789 root      20   0       0      0      0 S   0.0  0.0   0:00.57 jbd2/dm-6-8\r\n  790 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ext4-rsv-conver\r\n  793 root      20   0       0      0      0 S   0.0  0.0   0:00.00 jbd2/dm-5-8\r\n  794 root      20   0       0      0      0 S   0.0  0.0   0:01.15 jbd2/dm-4-8\r\n  795 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ext4-rsv-conver\r\n  796 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ext4-rsv-conver\r\n  798 root      20   0       0      0      0 S   0.0  0.0   0:02.07 jbd2/dm-3-8\r\n  800 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 ext4-rsv-conver\r\n  835 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 rpciod\r\n  836 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 xprtiod\r\n  857 polkitd   20   0  538436  12080   4640 S   0.0  0.2   0:00.19 polkitd\r\n  858 root      20   0   21672   1296    972 S   0.0  0.0   0:02.75 irqbalance\r\n  859 dbus      20   0   66472   2608   1888 S   0.0  0.0   0:01.28 dbus-daemon\r\n  860 rpc       20   0   69220   1056    520 S   0.0  0.0   0:00.06 rpcbind\r\n  862 root      20   0   99656   6064   4460 S   0.0  0.1   0:00.00 VGAuthService\r\n  863 root      20   0   26376   1780   1452 S   0.0  0.0   0:00.63 systemd-logind\r\n  866 root      20   0  224960   6100   4772 S   0.0  0.1   0:30.32 vmtoolsd\r\n  881 ntp       20   0   25720   1980   1396 S   0.0  0.0   0:00.14 ntpd\r\n  888 root      20   0  195080   1240    768 S   0.0  0.0   0:00.00 gssproxy\r\n  907 nrpe      20   0   44876   1536    848 S   0.0  0.0   0:01.23 nrpe\r\n  910 root      20   0  126280   1692   1056 S   0.0  0.0   0:00.51 crond\r\n  932 root      20   0  110088    880    748 S   0.0  0.0   0:00.00 agetty\r\n 1043 root      20   0  221716  12276   1180 S   0.0  0.2   5:26.64 supervisord\r\n 1044 root      20   0  125492   4676   2064 S   0.0  0.1   0:13.71 python\r\n 1046 awx       20   0  167104   7244   4448 S   0.0  0.1   0:01.84 uwsgi\r\n 1059 awx       20   0  438484 108576   8424 S   0.0  1.4   0:02.79 uwsgi\r\n 1060 awx       20   0  438680 108788   8416 S   0.0  1.4   0:02.96 uwsgi\r\n 1061 awx       20   0  437744 107924   8384 S   0.0  1.3   0:02.66 uwsgi\r\n 1062 awx       20   0  438128 108048   8384 S   0.0  1.4   0:02.67 uwsgi\r\n 1063 awx       20   0  437728 108000   8404 S   0.0  1.3   0:02.63 uwsgi\r\n 1068 root       0 -20       0      0      0 S   0.0  0.0   0:00.01 kworker/3:1H\r\n 1265 memcach+  20   0  350232   7996   1224 S   0.0  0.1   0:16.82 memcached\r\n 1270 root      20   0  218504   7828   6904 S   0.0  0.1   0:02.28 rsyslogd\r\n 1275 root      20   0  112808   4276   3248 S   0.0  0.1   0:00.02 sshd\r\n 1276 rabbitmq  20   0 3896228  73928   3996 S   0.0  0.9   3:05.76 beam.smp\r\n 1291 root      20   0  115696    676    516 S   0.0  0.0   0:00.00 rhsmcertd\r\n 1302 root      20   0  107964    576    428 S   0.0  0.0   0:00.00 rhnsd\r\n 1309 postgres  20   0 1064796  44364  43140 S   0.0  0.6   0:12.92 postmaster\r\n 1348 root      20   0  107912   1244    144 S   0.0  0.0   0:00.00 nginx\r\n 1350 nginx     20   0  108560   3860   2224 S   0.0  0.0   0:00.01 nginx\r\n 1352 nginx     20   0  108564   3336   1700 S   0.0  0.0   0:00.01 nginx\r\n 1353 nginx     20   0  108568   3860   2220 S   0.0  0.0   0:00.02 nginx\r\n 1354 nginx     20   0  108564   3340   1624 S   0.0  0.0   0:00.01 nginx\r\n 1540 postgres  20   0  215328   1732    536 S   0.0  0.0   0:00.00 postmaster\r\n 1575 postgres  20   0 1064916  10872   9604 S   0.0  0.1   0:00.67 postmaster\r\n 1576 postgres  20   0 1064796   8036   6812 S   0.0  0.1   0:00.40 postmaster\r\n 1577 postgres  20   0 1064796  18296  17052 S   0.0  0.2   0:04.91 postmaster\r\n 1578 postgres  20   0 1065340   2992   1456 S   0.0  0.0   0:00.67 postmaster\r\n 1579 postgres  20   0  217716   2088    660 S   0.0  0.0   0:05.63 postmaster\r\n 1616 rabbitmq  20   0   11624    340    216 S   0.0  0.0   0:00.34 epmd\r\n 1877 rabbitmq  20   0    4352    536    444 S   0.0  0.0   0:01.17 erl_child_setup\r\n 2073 root       0 -20       0      0      0 S   0.0  0.0   0:00.01 kworker/2:1H\r\n 2250 postgres  20   0 1066004   6412   4296 S   0.0  0.1   0:00.00 postmaster\r\n 2814 rabbitmq  20   0   11588    448    344 S   0.0  0.0   0:00.04 inet_gethost\r\n 2815 rabbitmq  20   0   13712    704    560 S   0.0  0.0   0:00.08 inet_gethost\r\n 3801 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kworker/1:1\r\n 3821 root      20   0       0      0      0 S   0.0  0.0   0:00.01 kworker/0:3\r\n 3868 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kworker/3:1\r\n 3905 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kworker/2:0\r\n 3962 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kworker/u128:0\r\n 7280 root      20   0       0      0      0 S   0.0  0.0   0:00.08 kworker/3:2\r\n 7609 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 bioset\r\n11736 root      20   0       0      0      0 S   0.0  0.0   0:00.27 kworker/0:0\r\n14925 root      20   0       0      0      0 S   0.0  0.0   0:00.05 kworker/1:0\r\n18212 root      20   0  161972   2172   1516 R   0.0  0.0   0:00.02 top\r\n21066 root      20   0   46848   4496   2868 S   0.0  0.1   0:00.06 systemd-udevd\r\n24013 root      20   0  573816  19148   6096 S   0.0  0.2   0:04.50 tuned\r\n26124 root      20   0       0      0      0 S   0.0  0.0   0:06.20 kworker/0:1\r\n32650 root      20   0       0      0      0 S   0.0  0.0   0:00.20 kworker/2:2\r\n35070 root      16  -4   55508    896    492 S   0.0  0.0   0:00.08 auditd\r\n41252 root      20   0       0      0      0 S   0.0  0.0   0:00.45 kworker/u128:1\r\n48148 root      20   0  761812  66992  25168 S   0.0  0.8   1:08.53 dockerd\r\n48161 root      20   0  741816  31416  12552 S   0.0  0.4   0:58.97 docker-containe\r\n59026 root      20   0  154616   5608   4288 S   0.0  0.1   0:00.26 sshd\r\n59082 root      20   0  115516   2144   1680 S   0.0  0.0   0:00.05 bash\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nOAuth2 tokens having an expiration date in the past should be automatically deleted. \r\nA token listing can be retrieved by a GET request for /api/v2/tokens/\r\nThe list of tokens currently contains active and expired tokens but should show active tokens only.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6\r\n* AWX install method: docker\r\n* Ansible version:  2.5.4\r\n* Operating System: CentOS Linux 7.5.2804\r\n* Web Browser: Google Chrome 68.0.3440.106\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Update the value of ACCESS_TOKEN_EXPIRE_SECONDS from 31536000000 to 1200 by sending a PATCH request to /api/v2/settings/authentication/ (body: updated result of the GET request to /api/v2/settings/authentication/).\r\n2. Create a token by sending a POST request to /api/v2/tokens/ having the following body: {\"description\": \"My Access Token\",\"scope\": \"write\"}\r\n3. Wait half an hour or more.\r\n4. List all tokens by sending a GET request to /api/v2/tokens/\r\n5. The expired token is present in the list of tokens.\r\n\r\n##### EXPECTED RESULTS\r\nI would expect the list of tokens to show active (non-expired) tokens only. Expired tokens should be removed automatically.\r\n\r\n##### ACTUAL RESULTS\r\nThe list of tokens shows all tokens (active and expired). Expired tokens are never deleted.\r\n\r\n##### ADDITIONAL INFORMATION\r\nI can delete the expired token by sending a DELETE request to /api/v2/tokens/{id}/ but this should not be necessary in my opinion.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nProject update\r\n\r\n##### SUMMARY\r\nI was executing project update job, and the output got an import error (ImportError: cannot import name cleanup).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.8\r\n* AWX install method: native on linux\r\n* Ansible version:  2.6.4\r\n* Operating System: Linux\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCan't find a way\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob should success\r\n\r\n##### ACTUAL RESULTS\r\n\r\nStill got error\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nOutput:\r\n```\r\nansible-playbook 2.6.4\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /home/awx/venv/awx/lib/python2.7/site-packages/ansible\r\n  executable location = /home/awx/venv/awx/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Jul 13 2018, 13:06:57) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nParsed localhost, inventory source with host_list plugin\r\nERROR! Unexpected Exception, this is probably a bug: cannot import name cleanup\r\nthe full traceback was:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/awx/venv/awx/bin/ansible-playbook\", line 118, in <module>\r\n    exit_code = cli.run()\r\n  File \"/home/awx/venv/awx/lib/python2.7/site-packages/ansible/cli/playbook.py\", line 122, in run\r\n    results = pbex.run()\r\n  File \"/home/awx/venv/awx/lib/python2.7/site-packages/ansible/executor/playbook_executor.py\", line 89, in run\r\n    self._tqm.load_callbacks()\r\n  File \"/home/awx/venv/awx/lib/python2.7/site-packages/ansible/executor/task_queue_manager.py\", line 182, in load_callbacks\r\n    self._stdout_callback = callback_loader.get(self._stdout_callback)\r\n  File \"/home/awx/venv/awx/lib/python2.7/site-packages/ansible/plugins/loader.py\", line 378, in get\r\n    self._module_cache[path] = self._load_module_source(name, path)\r\n  File \"/home/awx/venv/awx/lib/python2.7/site-packages/ansible/plugins/loader.py\", line 357, in _load_module_source\r\n    module = imp.load_source(full_name, path, module_file)\r\n  File \"/home/awx/venv/awx/lib/python2.7/site-packages/awx-1.0.8-py2.7.egg/awx/plugins/callback/awx_display.py\", line 30, in <module>\r\n    from awx_display_callback import AWXDefaultCallbackModule as CallbackModule  # noqa\r\n  File \"/home/awx/venv/awx/lib/python2.7/site-packages/awx-1.0.8-py2.7.egg/awx/lib/awx_display_callback/__init__.py\", line 21, in <module>\r\n    from . import cleanup  # noqa (registers control persistent cleanup)\r\nImportError: cannot import name cleanup\r\n```\r\n\r\nJob api detail:\r\n`{\r\n    \"id\": 1,\r\n    \"type\": \"project_update\",\r\n    \"url\": \"/api/v2/project_updates/1/\",\r\n    \"related\": {\r\n        \"created_by\": \"/api/v2/users/1/\",\r\n        \"unified_job_template\": \"/api/v2/projects/4/\",\r\n        \"stdout\": \"/api/v2/project_updates/1/stdout/\",\r\n        \"project\": \"/api/v2/projects/4/\",\r\n        \"cancel\": \"/api/v2/project_updates/1/cancel/\",\r\n        \"notifications\": \"/api/v2/project_updates/1/notifications/\",\r\n        \"scm_inventory_updates\": \"/api/v2/project_updates/1/scm_inventory_updates/\",\r\n        \"events\": \"/api/v2/project_updates/1/events/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"instance_group\": {\r\n            \"id\": 2,\r\n            \"name\": \"tower\"\r\n        },\r\n        \"unified_job_template\": {\r\n            \"id\": 4,\r\n            \"name\": \"Demo Project\",\r\n            \"description\": \"\",\r\n            \"unified_job_type\": \"project_update\"\r\n        },\r\n        \"project\": {\r\n            \"id\": 4,\r\n            \"name\": \"Demo Project\",\r\n            \"description\": \"\",\r\n            \"status\": \"failed\",\r\n            \"scm_type\": \"git\"\r\n        },\r\n        \"created_by\": {\r\n            \"id\": 1,\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\"\r\n        },\r\n        \"user_capabilities\": {\r\n            \"start\": true,\r\n            \"delete\": true\r\n        }\r\n    },\r\n    \"created\": \"2018-09-19T14:20:30.897988Z\",\r\n    \"modified\": \"2018-09-19T14:45:41.116566Z\",\r\n    \"name\": \"Demo Project\",\r\n    \"description\": \"\",\r\n    \"local_path\": \"_4__demo_project\",\r\n    \"scm_type\": \"git\",\r\n    \"scm_url\": \"https://github.com/ansible/ansible-tower-samples\",\r\n    \"scm_branch\": \"\",\r\n    \"scm_clean\": false,\r\n    \"scm_delete_on_update\": false,\r\n    \"credential\": null,\r\n    \"timeout\": 0,\r\n    \"unified_job_template\": 4,\r\n    \"launch_type\": \"manual\",\r\n    \"status\": \"failed\",\r\n    \"failed\": true,\r\n    \"started\": \"2018-09-19T14:45:41.269848Z\",\r\n    \"finished\": \"2018-09-19T14:45:42.916423Z\",\r\n    \"elapsed\": 1.647,\r\n    \"job_args\": \"[\\\"ansible-playbook\\\", \\\"-i\\\", \\\"localhost,\\\", \\\"-vvv\\\", \\\"-e\\\", \\\"@/tmp/awx_1_JcSSI0/tmpX3LIfg\\\", \\\"project_update.yml\\\"]\",\r\n    \"job_cwd\": \"/home/awx/venv/awx/lib/python2.7/site-packages/awx-1.0.8-py2.7.egg/awx/playbooks\",\r\n    \"job_env\": {\r\n        \"TMP\": \"/tmp\",\r\n        \"ANSIBLE_BECOME_ASK_PASS\": \"False\",\r\n        \"ANSIBLE_PARAMIKO_RECORD_HOST_KEYS\": \"False\",\r\n        \"AWX_PRIVATE_DATA_DIR\": \"/tmp/awx_1_JcSSI0\",\r\n        \"LC_CTYPE\": \"en_US.UTF-8\",\r\n        \"_MP_FORK_LOGFILE_\": \"\",\r\n        \"ANSIBLE_ASK_PASS\": \"False\",\r\n        \"CELERY_LOG_REDIRECT\": \"1\",\r\n        \"SUPERVISOR_GROUP_NAME\": \"awx\",\r\n        \"PATH\": \"/home/awx/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin\",\r\n        \"HOME\": \"/var/lib/awx\",\r\n        \"DISPLAY\": \"\",\r\n        \"ANSIBLE_CALLBACK_PLUGINS\": \"/home/awx/venv/awx/lib/python2.7/site-packages/awx-1.0.8-py2.7.egg/awx/plugins/callback\",\r\n        \"LANG\": \"en_US.UTF-8\",\r\n        \"VIRTUAL_ENV\": \"/home/awx/venv/awx\",\r\n        \"SUPERVISOR_SERVER_URL\": \"unix:///var/run/supervisor/supervisor.sock\",\r\n        \"TZ\": \"UTC\",\r\n        \"ANSIBLE_RETRY_FILES_ENABLED\": \"False\",\r\n        \"LANGUAGE\": \"en_US.UTF-8\",\r\n        \"_MP_FORK_LOGFORMAT_\": \"[%(asctime)s: %(levelname)s/%(processName)s] %(message)s\",\r\n        \"AWX_SETTINGS_FILE\": \"/etc/awx/settings.py\",\r\n        \"SUPERVISOR_ENABLED\": \"1\",\r\n        \"CELERY_LOG_FILE\": \"\",\r\n        \"DJANGO_PROJECT_DIR\": \"/home/awx/venv/awx/lib/python2.7/site-packages/awx-1.0.8-py2.7.egg\",\r\n        \"CACHE\": \"redis://192.168.8.64:6379/4\",\r\n        \"ANSIBLE_HOST_KEY_CHECKING\": \"False\",\r\n        \"DJANGO_LIVE_TEST_SERVER_ADDRESS\": \"localhost:9013-9199\",\r\n        \"ANSIBLE_STDOUT_CALLBACK\": \"awx_display\",\r\n        \"PYTHONPATH\": \"/home/awx/venv/awx/lib/python2.7/site-packages:/home/awx/venv/awx/lib/python2.7/site-packages/awx-1.0.8-py2.7.egg/awx/lib:\",\r\n        \"CELERY_LOADER\": \"djcelery.loaders.DjangoLoader\",\r\n        \"_MP_FORK_LOGLEVEL_\": \"10\",\r\n        \"LC_ALL\": \"en_US.UTF-8\",\r\n        \"ANSIBLE_FORCE_COLOR\": \"True\",\r\n        \"CELERY_LOG_REDIRECT_LEVEL\": \"WARNING\",\r\n        \"SUPERVISOR_PROCESS_NAME\": \"celery\",\r\n        \"CELERY_LOG_LEVEL\": \"10\",\r\n        \"PROJECT_UPDATE_ID\": \"1\",\r\n        \"DJANGO_SETTINGS_MODULE\": \"awx.settings.production\",\r\n        \"ANSIBLE_VENV_PATH\": \"/home/awx/venv/awx\"\r\n    },\r\n    \"job_explanation\": \"\",\r\n    \"execution_node\": \"bogon\",\r\n    \"result_traceback\": \"\",\r\n    \"event_processing_finished\": true,\r\n    \"project\": 4,\r\n    \"job_type\": \"check\",\r\n    \"host_status_counts\": {},\r\n    \"playbook_counts\": {\r\n        \"play_count\": 0,\r\n        \"task_count\": 0\r\n    }\r\n}\r\n`"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nThe addition of an option to adjust job template parameters from the workflow editor would facilitate more direct adjustment of job template details in the context of creating or developing a workflow.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nDisplay YAML comments stored with the job template extra_vars in the prompt on launch extra_vars dialog.  This would allow some documentation of the vars in the YAML.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nTower displayed the complete YAML, as of version 3.2.6\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n- Feature\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen running a job and if using a custom virtual environment display it in the job details"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nSome resources can be created via a POST to their list view.\r\n\r\nSome resources can be created via a POST to a sublist of another (parent-like) resource.\r\n\r\nSome can be created by both methods.\r\n\r\nIt's impossible to predict which will be the case.\r\n\r\nWe should change this so clients can create via POST in all global lists and parent-like sublists.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAs an example, go to `/api/v2/schedules/` and observe that you cannot create a schedule from this view, even as superuser. This causes headaches, such as https://github.com/ansible/tower-cli/issues/578\r\n\r\nAt a cursory glance, it seems like a reasonable API practice because \"I can't create a schedule unless I already have a template\". But credentials / credential types go in the exact opposite direction. See a few highlight examples:\r\n\r\n| resource           | parent resource | global creation | sublist creation |\r\n|--------------------|-----------------|-----------------|------------------|\r\n| project            | organization    | yes             | yes              |\r\n| inventory          | organization    | yes             | no               |\r\n| host / group / src | inventory       | yes             | yes              |\r\n| schedule           | template        | no              | yes              |\r\n| credential         | credential type | yes             | no               |\r\n\r\nIdea here is that all of these would flip to \"yes\""},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nI created organisation red and blue and created admin, normal user and system auditor in both the organisation.\r\nI planned to check the option \"All user visible to organisation admin\" in the Settings option under System.\r\nI turned OFF this, I loggedIn with organisation blue admin and what i understand it should not allow the admin to control the users and teams of other organisation, but this is not happening.\r\n\r\nPlease let me know, if i am right here or i missing something.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.2\r\n* AWX install method:  docker on linux\r\n* Ansible version: 2.6.2\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate 2 organisation and create admin and normal users in both of them\r\nGoto settings under system tab turn off the option \"All users visible to organisation admin\".\r\n\r\n##### EXPECTED RESULTS\r\nAdmin of one team should be able access users and team of other organisation\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAdmin is able to access all users and team.\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n* Set an inventory for a workflow that will then be used by every Job Template in that workflow.\r\n\r\n##### ADDITIONAL INFORMATION\r\nNeeded to complete workflow callbacks https://github.com/ansible/awx/issues/1845"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n* Allow use of always nodes in combination with success and failure nodes\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n* Have a convergence step that tracks the completion of multiple workflow jobs before continuing\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n* Allow ad-hoc commands in workflows\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n* Allow workflows within workflows"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Documentation request\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nI would like to know from the API, if it is possible to retrieve inventory variables. For example, from one of our inventory, we have a variable defined which is a list of integers. The ultimate goal would be to retrieve that list from the API and expose it in a survey for the user to select existing values.. \r\n\r\nIf it's not possible that's not an issue, I could do it another way...\r\n\r\n##### ADDITIONAL INFORMATION\r\n Nil\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe can now rerun a job with either all or just failed hosts. It would be really great to use that in the workflow composer. E.g. If a job fails as part of a workflow, rerun the job on failed hosts only.\r\n\r\nCurrently you can run a new job from the same template if it fails, but it will execute against every host in the template. \r\n\r\nIn ansible terms, I think of this as limiting to the .retry file.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nAWX changes sequence of hosts in group (inventory sourced from project) so when I run job template it runs on wrong host.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.0.0.2\r\n* Operating System: ubuntu 16.04\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Add inventory from source - sourced from project.\r\n2. Add job template with playbook which should run on specific host from group (e.g. node01,node02,node03 are in docker group and in your playbook use docker[0] as host,which should point to node01). \r\n\r\n##### EXPECTED RESULTS\r\n\r\nPlaybook runs on node01.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPlaybook runs on node03.\r\n\r\nProject structure:\r\n![image](https://user-images.githubusercontent.com/7538311/45418730-7edb3180-b685-11e8-8161-b4add00634e6.png)\r\n\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n- UI\r\n- API\r\n\r\n##### SUMMARY\r\nGiven that tower-cli can't export secrets and that storing secrets directly in AWX might not be desirable. We propose that AWX be extended to support external secret stores.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNon exhaustive lists of possible backends:\r\n* https://www.vaultproject.io\r\n* https://thycotic.com/products/secret-server/\r\n* https://square.github.io/keywhiz/"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nFirst time of each day we log to AWX using SAML, the login FAILED with this message : `ERROR! Call to /api/v2/users/2/admin_of_organizations/ failed. GET returned status: 500. A server error has occurred.`\r\n\r\n![capture d ecran de 2018-09-11 09-40-13](https://user-images.githubusercontent.com/1652493/45346265-0b63f200-b5a9-11e8-9102-0159a31c859e.png)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.2\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6\r\n* Operating System: Debian\r\n* Web Browser: Firefox 61\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure SAML and use the **S** button on the login screen\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLogged. Home page.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nLogin Failed. Login page.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAfter the error message. We use the **S** button again, and this time, everytime, it works perfectly, and we are redirected to the home page, correctly logged in.\r\nMay be it's a misconfiguration on our side, but as it worked everytime the second try, we don't really think so.\r\n\r\nHere are the Web docker logs during login:\r\n\r\n```\r\nSep 11 07:38:22 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:22 +0000] \"GET /sso/login/saml/?idp=idp HTTP/1.1\" 302 0 \"https://ans01.com/\" \"Firefox/61.0\" \"10.5.18.15\"\r\nSep 11 07:38:25 server01 docker[3329]: [pid: 5396|app: 0|req: 23/446749] 172.16.98.14 () {54 vars in 1773 bytes} [Tue Sep 11 07:38:25 2018] POST /sso/complete/saml/ => generated 0 bytes in 184 msecs (HTTP/1.1 302) 11 headers in 537 bytes (1 switches on core 0)\r\nSep 11 07:38:25 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:25 +0000] \"POST /sso/complete/saml/ HTTP/1.1\" 302 0 \"https://saml01/adfs/ls/IdpInitiatedSignOn.aspx?loginToRp=awx&SAMLRequest=\r\nSep 11 07:38:25 server01 docker[3329]: 2018-09-11 07:38:25,721 INFO     awx.sso.views User cpatry logged in\r\nSep 11 07:38:25 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:25 +0000] \"GET /sso/complete/ HTTP/1.1\" 301 0 \"https://saml01/adfs/ls/IdpInitiatedSignOn.aspx?loginToRp=awx&SAMLRequest=\r\nSep 11 07:38:25 server01 docker[3329]: [pid: 5378|app: 0|req: 642/446750] 172.16.98.14 () {50 vars in 1644 bytes} [Tue Sep 11 07:38:25 2018] GET /sso/complete/ => generated 0 bytes in 77 msecs (HTTP/1.1 301) 10 headers in 1897 bytes (1 switches on core 0)\r\nSep 11 07:38:25 server01 docker[3329]: [pid: 5387|app: 0|req: 288/446751] 172.16.98.14 () {50 vars in 3137 bytes} [Tue Sep 11 07:38:25 2018] GET / => generated 11339 bytes in 184 msecs (HTTP/1.1 200) 7 headers in 312 bytes (1 switches on core 0)\r\nSep 11 07:38:25 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:25 +0000] \"GET / HTTP/1.1\" 200 11339 \"https://saml01/adfs/ls/IdpInitiatedSignOn.aspx?loginToRp=awx&SAMLRequest=\r\nSep 11 07:38:26 server01 docker[3329]: [pid: 5306|app: 0|req: 941/446752] 172.16.98.14 () {50 vars in 2423 bytes} [Tue Sep 11 07:38:26 2018] GET /api/ => generated 198727 bytes in 56 msecs (HTTP/1.1 200) 11 headers in 474 bytes (1 switches on core 0)\r\nSep 11 07:38:26 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:26 +0000] \"GET /api/ HTTP/1.1\" 200 198727 \"https://ans01.com/\" \"Firefox/61.0\" \"10.5.18.15\"\r\nSep 11 07:38:26 server01 docker[3329]: 2018-09-11 07:38:26,905 INFO     awx.api.generics User cpatry logged out.\r\nSep 11 07:38:26 server01 docker[3329]: [pid: 5387|app: 0|req: 289/446753] 172.16.98.14 () {50 vars in 2437 bytes} [Tue Sep 11 07:38:26 2018] GET /api/logout/ => generated 0 bytes in 45 msecs (HTTP/1.1 302) 10 headers in 396 bytes (1 switches on core 0)\r\nSep 11 07:38:26 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:26 +0000] \"GET /api/logout/ HTTP/1.1\" 302 0 \"https://ans01.com/\" \"Firefox/61.0\" \"10.5.18.15\"\r\nSep 11 07:38:26 server01 docker[3329]: 2018-09-11 07:38:26,922 ERROR    django.request Internal Server Error: /api/\r\nSep 11 07:38:26 server01 docker[3329]: Traceback (most recent call last):\r\nSep 11 07:38:26 server01 docker[3329]:   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 131, in get_response\r\nSep 11 07:38:26 server01 docker[3329]:     response = middleware_method(request, response)\r\nSep 11 07:38:26 server01 docker[3329]:   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/middleware.py\", line 61, in process_response\r\nSep 11 07:38:26 server01 docker[3329]:     \"The request's session was deleted before the \"\r\nSep 11 07:38:26 server01 docker[3329]: SuspiciousOperation: The request's session was deleted before the request completed. The user may have logged out in a concurrent request, for example.\r\nSep 11 07:38:26 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:26 +0000] \"GET /static/partials/breadcrumb.html HTTP/1.1\" 200 466 \"https://ans01.com/\" \"Firefox/61.0\" \"10.5.18.15\"\r\nSep 11 07:38:26 server01 docker[3329]: 2018-09-11 07:38:26,922 ERROR    django.request Internal Server Error: /api/\r\nSep 11 07:38:26 server01 docker[3329]: Traceback (most recent call last):\r\nSep 11 07:38:26 server01 docker[3329]:   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 131, in get_response\r\nSep 11 07:38:26 server01 docker[3329]:     response = middleware_method(request, response)\r\nSep 11 07:38:26 server01 docker[3329]:   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/middleware.py\", line 61, in process_response\r\nSep 11 07:38:26 server01 docker[3329]:     \"The request's session was deleted before the \"\r\nSep 11 07:38:26 server01 docker[3329]: SuspiciousOperation: The request's session was deleted before the request completed. The user may have logged out in a concurrent request, for example.\r\nSep 11 07:38:26 server01 docker[3329]: [pid: 5333|app: 0|req: 859/446754] 172.16.98.14 () {52 vars in 2445 bytes} [Tue Sep 11 07:38:26 2018] GET /api/ => generated 41 bytes in 74 msecs (HTTP/1.1 500) 2 headers in 84 bytes (1 switches on core 0)\r\nSep 11 07:38:26 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:26 +0000] \"GET /api/ HTTP/1.1\" 500 52 \"https://ans01.com/\" \"Firefox/61.0\" \"10.5.18.15\"\r\nSep 11 07:38:26 server01 docker[3329]: 2018-09-11 07:38:26,994 ERROR    django.request Internal Server Error: /api/v2/users/2/admin_of_organizations/\r\nSep 11 07:38:26 server01 docker[3329]: Traceback (most recent call last):\r\nSep 11 07:38:26 server01 docker[3329]:   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 131, in get_response\r\nSep 11 07:38:26 server01 docker[3329]:     response = middleware_method(request, response)\r\nSep 11 07:38:26 server01 docker[3329]:   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/middleware.py\", line 61, in process_response\r\nSep 11 07:38:26 server01 docker[3329]:     \"The request's session was deleted before the \"\r\nSep 11 07:38:26 server01 docker[3329]: SuspiciousOperation: The request's session was deleted before the request completed. The user may have logged out in a concurrent request, for example.\r\nSep 11 07:38:26 server01 docker[3329]: 2018-09-11 07:38:26,994 ERROR    django.request Internal Server Error: /api/v2/users/2/admin_of_organizations/\r\nSep 11 07:38:26 server01 docker[3329]: Traceback (most recent call last):\r\nSep 11 07:38:26 server01 docker[3329]:   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 131, in get_response\r\nSep 11 07:38:26 server01 docker[3329]:     response = middleware_method(request, response)\r\nSep 11 07:38:26 server01 docker[3329]:   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/middleware.py\", line 61, in process_response\r\nSep 11 07:38:26 server01 docker[3329]:     \"The request's session was deleted before the \"\r\nSep 11 07:38:26 server01 docker[3329]: SuspiciousOperation: The request's session was deleted before the request completed. The user may have logged out in a concurrent request, for example.\r\nSep 11 07:38:26 server01 docker[3329]: [pid: 5396|app: 0|req: 24/446755] 172.16.98.14 () {50 vars in 2491 bytes} [Tue Sep 11 07:38:26 2018] GET /api/v2/users/2/admin_of_organizations/ => generated 41 bytes in 133 msecs (HTTP/1.1 500) 2 headers in 84 bytes (1 switches on core 0)\r\nSep 11 07:38:27 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:27 +0000] \"GET /api/v2/users/2/admin_of_organizations/ HTTP/1.1\" 500 52 \"https://ans01.com/\" \"Firefox/61.0\" \"10.5.18.15\"\r\nSep 11 07:38:27 server01 docker[3329]: [pid: 5306|app: 0|req: 942/446756] 172.16.98.14 () {50 vars in 2380 bytes} [Tue Sep 11 07:38:26 2018] GET /api/ => generated 198727 bytes in 39 msecs (HTTP/1.1 200) 9 headers in 323 bytes (1 switches on core 0)\r\nSep 11 07:38:27 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:27 +0000] \"GET /api/ HTTP/1.1\" 200 198727 \"https://ans01.com/\" \"Firefox/61.0\" \"10.5.18.15\"\r\nSep 11 07:38:27 server01 docker[3329]: 172.16.98.14 - - [11/Sep/2018:07:38:27 +0000] \"GET /api/v2/auth/ HTTP/1.1\" 200 161 \"https://ans01.com/\" \"Firefox/61.0\" \"10.5.18.15\"\r\nSep 11 07:38:27 server01 docker[3329]: [pid: 5378|app: 0|req: 643/446757] 172.16.98.14 () {50 vars in 2396 bytes} [Tue Sep 11 07:38:27 2018] GET /api/v2/auth/ => generated 161 bytes in 30 msecs (HTTP/1.1 200) 8 headers in 223 bytes (1 switches on core 0)\r\n```\r\n\r\nThanks for your help.\r\n\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAdd an option in the configuration to limit the maximum verbosity allowed for a job template within the organization.  This will limit the volume of data placed in the database for each run, and therefore, limit the overall size and associated performance and operational impacts."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nSlack notifications are failing\r\n\r\n##### ENVIRONMENT\r\n* AWX  version 1.0.7.2\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.s\r\n* Operating System: Centos\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nInstall AWX with docker. Setup Slack notifications and test it. Error message \" Job Notification: Notification failed\" will appear.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe slack message should be sent successfully.\r\n\r\n##### ACTUAL RESULTS\r\nNothing sent, error message appears.\r\n\r\n##### ADDITIONAL INFORMATION\r\nAWX is installed with the database on the separate box. SSL was configured with nginx.\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI need to gather metrics on my jobs run via a specific template. The tower-cli command below should provide a list of the jobs for the template, along with a fail/succuss status, and the elapsed time the job took to complete. \r\nSome of the elapsed times are missing. Is this a know issue with AWX 1.0.6 and will upgrading to 1.0.7 solve this issue? \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.1\r\n* Operating System: CentOS 7\r\n* Tower-cli: 3.1.2\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nI checked the outcome of the jobs with this command:\r\ntower-cli job list --job-template job-template-name\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nA list of jobs that each have a failed/successful status and an elapsed time the job took to complete.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nSome of the elapsed times are missing:\r\n\r\n```\r\n=== ============ =========================== ========== =======\r\nid  job_template           created             status   elapsed\r\n=== ============ =========================== ========== =======\r\n237           31 2018-08-27T19:37:25.575351Z failed       4.986\r\n238           31 2018-08-27T19:41:44.179672Z failed        5.66\r\n239           31 2018-08-27T19:45:06.145526Z failed       8.211\r\n240           31 2018-08-27T19:58:03.841982Z failed       8.054\r\n241           31 2018-08-27T20:00:41.320033Z failed       8.187\r\n242           31 2018-08-27T21:15:47.253543Z failed\r\n243           31 2018-08-27T21:23:05.858683Z successful\r\n244           31 2018-08-27T21:30:07.320492Z successful\r\n245           31 2018-08-27T21:33:48.281844Z successful 164.604\r\n246           31 2018-08-27T21:38:24.677338Z successful\r\n279           31 2018-08-29T04:55:16.808927Z successful\r\n280           31 2018-08-29T05:43:02.052329Z successful\r\n=== ============ =========================== ========== =======\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nExperimenting with #223 I noticed a strange behaviour related to vaulted variables **on lists**, where the decryption is not performed. The behaviour can be observed on AWX only: running the playbook directly on Ansible the decryption works.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.2\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.2\r\n* Operating System: Ubuntu 18.04\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI have an host vars file with the same secret in 3 different situations:\r\n```\r\npassword: !vault |\r\n  $ANSIBLE_VAULT;1.1;AES256\r\n  35626564383635616564393862313733656232303436633532313137313238653964363263386336\r\n  3766633032643332666465663730336536333531633730320a303761666136643366373436636430\r\n  65396637613439383761356130663161396533326637353335623333353964383832353566313366\r\n  3038653039306136650a643735376563666363376661313561623337666238613832656636643463\r\n  3234\r\nfoo:\r\n  password: !vault |\r\n    $ANSIBLE_VAULT;1.1;AES256\r\n    35626564383635616564393862313733656232303436633532313137313238653964363263386336\r\n    3766633032643332666465663730336536333531633730320a303761666136643366373436636430\r\n    65396637613439383761356130663161396533326637353335623333353964383832353566313366\r\n    3038653039306136650a643735376563666363376661313561623337666238613832656636643463\r\n    3234\r\nbar:\r\n  baz:\r\n  - password: !vault |\r\n      $ANSIBLE_VAULT;1.1;AES256\r\n      35626564383635616564393862313733656232303436633532313137313238653964363263386336\r\n      3766633032643332666465663730336536333531633730320a303761666136643366373436636430\r\n      65396637613439383761356130663161396533326637353335623333353964383832353566313366\r\n      3038653039306136650a643735376563666363376661313561623337666238613832656636643463\r\n      3234\r\n```\r\nA simple playbook can be run, with 3 debug tasks:\r\n```\r\n  - debug:\r\n      msg: 'password {{ password }}'\r\n  - debug:\r\n      msg: 'foo.password: {{ foo.password }}'\r\n  - debug:\r\n      msg: \"bar.baz[0].password: {{ bar.baz[0].password }}\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe expected result, obtained using plain Ansible 2.6.2 without AWX, is the following:\r\n```\r\nTASK [debug] ***********************************************************************************************************\r\nok: [myhost] => {\r\n    \"msg\": \"password MyPassword\"\r\n}\r\n\r\nTASK [debug] ***********************************************************************************************************\r\nok: [myhost] => {\r\n    \"msg\": \"foo.password: MyPassword\"\r\n}\r\n\r\nTASK [debug] ***********************************************************************************************************\r\nok: [myhost] => {\r\n    \"msg\": \"bar.baz[0].password: MyPassword\"\r\n```\r\n\r\n##### ACTUAL RESULTS\r\nThe result obtained by running the 3 tasks on a Job Template from AWX is the following, and the problem seems related to the vaulted variable nested **in the list**:\r\n```\r\nTASK [debug] *******************************************************************\r\nok: [myhost] => {\r\n    \"msg\": \"password MyPassword\"\r\n}\r\nTASK [debug] *******************************************************************\r\nok: [myhost] => {\r\n    \"msg\": \"foo.password: MyPassword\"\r\n}\r\nTASK [debug] *******************************************************************\r\nok: [myhost] => {\r\n    \"msg\": \"bar.baz[0].password: {u'__ansible_vault': u'$ANSIBLE_VAULT;1.1;AES256\\\\n35626564383635616564393862313733656232303436633532313137313238653964363263386336\\\\n3766633032643332666465663730336536333531633730320a303761666136643366373436636430\\\\n65396637613439383761356130663161396533326637353335623333353964383832353566313366\\\\n3038653039306136650a643735376563666363376661313561623337666238613832656636643463\\\\n3234'}\"\r\n}\r\n```\r\n##### ADDITIONAL INFORMATION\r\n\r\nWaiting for a fix, a workaround to force the decryption of the 3rd password would be appreciated"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nwhile exeucitng powershell script on linux through ansible,  got the below error \r\n\r\n \"FailFast: Unable to retrieve the specified information about the process or thread.  It may have exited or may be privileged.\", \r\n        \"\", \r\n        \"   at System.Environment.FailFast(System.String, System.Exception)\", \r\n        \"   at System.Environment.FailFast(System.String, System.Exception)\", \r\n        \"   at Microsoft.PowerShell.UnmanagedPSEntry.Start(System.String, System.String[], Int32)\", \r\n        \"   at Microsoft.PowerShell.ManagedPSEntry.Main(System.String[])\"\r\n    ], \r\n\r\nNow this may sound like an ansible issue, but executing ansible directly on that host, everything works fine. This issue occurs only when job executed through tower \r\n\r\n##### ENVIRONMENT\r\n* AWX version: Tower 3.2.1\r\n* AWX install method: on vm\r\n* Ansible version:  ansible 2.4.1.0\r\n* Operating System: 16.04.3 \r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) execute below task  \r\n - name: wershell script\r\n      command: /usr/bin/pwsh  test.ps1\r\n      args:\r\n        chdir: \"commandpipeline\"\r\n\r\n##### EXPECTED RESULTS\r\n  Powershell should be executed successfully \r\n<!-- What did you expect to happen when running the steps above? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- What actually happened? -->\r\n\r\n    \"msg\": \"non-zero return code\", \r\n    \"rc\": -6, \r\n    \"start\": \"2018-09-04 09:32:09.378408\", \r\n    \"stderr\": \"FailFast: Unable to retrieve the specified information about the process or thread.  It may have exited or may be privileged.\\n\\n   at System.Environment.FailFast(System.String, System.Exception)\\n   at System.Environment.FailFast(System.String, System.Exception)\\n   at Microsoft.PowerShell.UnmanagedPSEntry.Start(System.String, System.String[], Int32)\\n   at Microsoft.PowerShell.ManagedPSEntry.Main(System.String[])\", \r\n    \"stderr_lines\": [\r\n        \"FailFast: Unable to retrieve the specified information about the process or thread.  It may have exited or may be privileged.\", \r\n        \"\", \r\n        \"   at System.Environment.FailFast(System.String, System.Exception)\", \r\n        \"   at System.Environment.FailFast(System.String, System.Exception)\", \r\n        \"   at Microsoft.PowerShell.UnmanagedPSEntry.Start(System.String, System.String[], Int32)\", \r\n        \"   at Microsoft.PowerShell.ManagedPSEntry.Main(System.String[])\"\r\n    ], \r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nTASK [ powershell script] *****\r\ntask path: /var/lib/awx/projects/_59__sshgittesttest7999actintautomategit_development/ansible/test/test_clone_repository.yml:55\r\nUsing module file /usr/lib/python2.7/dist-packages/ansible/modules/commands/command.py\r\n<127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: awx\r\n<127.0.0.1> EXEC /bin/sh -c 'echo ~ && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /var/lib/awx/.ansible/tmp/ansible-tmp-1536053529.27-33824948249879 `\" && echo ansible-tmp-1536053529.27-33824948249879=\"` echo /var/lib/awx/.ansible/tmp/ansible-tmp-1536053529.27-33824948249879 `\" ) && sleep 0'\r\n<127.0.0.1> PUT /tmp/tmpCSK0jO TO /var/lib/awx/.ansible/tmp/ansible-tmp-1536053529.27-33824948249879/command.py\r\n<127.0.0.1> EXEC /bin/sh -c 'chmod u+x /var/lib/awx/.ansible/tmp/ansible-tmp-1536053529.27-33824948249879/ /var/lib/awx/.ansible/tmp/ansible-tmp-1536053529.27-33824948249879/command.py && sleep 0'\r\n<127.0.0.1> EXEC /bin/sh -c '/usr/bin/python /var/lib/awx/.ansible/tmp/ansible-tmp-1536053529.27-33824948249879/command.py; rm -rf \"/var/lib/awx/.ansible/tmp/ansible-tmp-1536053529.27-33824948249879/\" > /dev/null 2>&1 && sleep 0'\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": true, \r\n    \"cmd\": [\r\n        \"/usr/bin/pwsh\", \r\n        \"test.ps1\"\r\n    ], \r\n    \"delta\": \"0:00:00.561549\", \r\n    \"end\": \"2018-09-04 09:32:09.939957\", \r\n    \"failed\": true, \r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"_raw_params\": \"/usr/bin/pwsh test.ps1\", \r\n            \"_uses_shell\": false, \r\n            \"chdir\": \"commandpipeline\", \r\n            \"creates\": null, \r\n            \"executable\": null, \r\n            \"removes\": null, \r\n            \"stdin\": null, \r\n            \"warn\": true\r\n        }\r\n    }, \r\n    \"msg\": \"non-zero return code\", \r\n    \"rc\": -6, \r\n    \"start\": \"2018-09-04 09:32:09.378408\", \r\n    \"stderr\": \"FailFast: Unable to retrieve the specified information about the process or thread.  It may have exited or may be privileged.\\n\\n   at System.Environment.FailFast(System.String, System.Exception)\\n   at System.Environment.FailFast(System.String, System.Exception)\\n   at Microsoft.PowerShell.UnmanagedPSEntry.Start(System.String, System.String[], Int32)\\n   at Microsoft.PowerShell.ManagedPSEntry.Main(System.String[])\", \r\n    \"stderr_lines\": [\r\n        \"FailFast: Unable to retrieve the specified information about the process or thread.  It may have exited or may be privileged.\", \r\n        \"\", \r\n        \"   at System.Environment.FailFast(System.String, System.Exception)\", \r\n        \"   at System.Environment.FailFast(System.String, System.Exception)\", \r\n        \"   at Microsoft.PowerShell.UnmanagedPSEntry.Start(System.String, System.String[], Int32)\", \r\n        \"   at Microsoft.PowerShell.ManagedPSEntry.Main(System.String[])\"\r\n    ], \r\n    \"stdout\": \"\", \r\n    \"stdout_lines\": []\r\n}"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\n\r\nIf we have a huge workflow with multiple branches. Currently, there is no way to move or delete 1 complete branch in one shot. We have to remove all the job nodes 1 by 1.  \r\nIt is very time-consuming & error prone process.\r\n\r\nThere should be an option to remove any branch from START in one shot. \r\nAlso we should be able to move any branch from anywhere and connect with any other node in any branch.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nFeature to add and link other Workflows from the Workflow Visualizer, similar to adding job templates, project and inventory sync."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nNext to REQUIRED checkbox, having a READ-ONLY checkbox would be useful as well.\r\nI understand it could be placed in Extra Variables, but since the Survey is the first thing that pops up on launch, I would like to include it as part of the survey, but as a read-only field, so they are aware of it.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nAWX now populates all the available venvs to all the users, we would like to restrict it based onorganization's assigned venv. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4\r\n* AWX install method: openshift\r\n* Ansible version:  2.6.3\r\n* Operating System: CentOS\r\n* Web Browser: google chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a new venv as described in the page https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md\r\n2. Assign newly created venv to any of the existing org and logout as admin user.\r\n3. Login as a member of the org to which venv was assigned.\r\n4. Create a new job template (for example) and select the dropdown to choose virtual environment. User will be able to see all the venvs not just the ones assigned to the org.\r\n\r\nIdeally I would expect only assigned venv to pop up in the dropdown.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIdeally I would expect only assigned venv to pop up in the dropdown.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAll the venvs are listed in the dropdown.\r\n\r\n##### ADDITIONAL INFORMATION\r\nNA\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - celery\r\n\r\n##### SUMMARY\r\nIf for some reason connection between celery and database is lost, celery stops running tasks. When connection is restored, celery does not restore the connection to the database. You need to restart celery to solve problem.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.3\r\n* Operating System: CentOS 7\r\n\r\n##### STEPS TO REPRODUCE\r\nRun all components.\r\nStop the database (or add iptables rule to deny access from celery).\r\nWatch celery log.\r\n```\r\n[2018-08-29 19:47:59,749: ERROR/Beat] Message Error: Couldn't apply scheduled task task_manager: connection already closed\r\n```\r\nStart the database.\r\nAfter database is up error messagese still present.\r\n\r\n##### EXPECTED RESULTS\r\nThe connection to the database must be restored\r\n\r\n##### ACTUAL RESULTS\r\nThe connection to the database is not restored\r\n\r\n##### ADDITIONAL INFORMATION\r\n```\r\nAug 29 22:47:59 celery[273]: [2018-08-29 19:47:59,622: INFO/Beat] Scheduler: Sending due task cluster_heartbeat (awx.main.tasks.cluster_node_heartbeat)\r\nAug 29 22:47:59 celery[273]: [2018-08-29 19:47:59,698: ERROR/Beat] Message Error: Couldn't apply scheduled task cluster_heartbeat: server closed the connection unexpectedly\r\nAug 29 22:47:59 celery[273]: This probably means the server terminated abnormally\r\nAug 29 22:47:59 celery[273]: before or while processing the request.\r\nAug 29 22:47:59 celery[273]: ['  File \"/var/lib/awx/venv/awx/bin/celery\", line 11, in <module>\\n    sys.exit(main())\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/__main__.py\", line 30, in main\\n    main()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 81, in main\\n    cmd.execute_from_commandline(argv)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 793, in execute_from_commandline\\n    super(CeleryCommand, self).execute_from_commandline(argv)))\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/base.py\", line 311, in execute_from_commandline\\n    return self.handle_argv(self.prog_name, argv[1:])\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 785, in handle_argv\\n    return self.execute(command, argv)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 717, in execute\\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/worker.py\", line 179, in run_from_argv\\n    return self(*args, **options)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/base.py\", line 274, in __call__\\n    ret = self.run(*args, **kwargs)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/worker.py\", line 212, in run\\n    state_db=self.node_format(state_db, hostname), **kwargs\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/worker/__init__.py\", line 206, in start\\n    self.blueprint.start(self)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bootsteps.py\", line 123, in start\\n    step.start(parent)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bootsteps.py\", line 374, in start\\n    return self.obj.start()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/process.py\", line 137, in start\\n    self._popen = Popen(self)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/forking.py\", line 105, in __init__\\n    code = process_obj._bootstrap()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/process.py\", line 292, in _bootstrap\\n    self.run()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 553, in run\\n    self.service.start(embedded_process=True)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 479, in start\\n    interval = self.scheduler.tick()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 221, in tick\\n    next_time_to_run = self.maybe_due(entry, self.publisher)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 207, in maybe_due\\n    exc, traceback.format_stack(), exc_info=True)\\n']\r\nAug 29 22:47:59 celery[273]: Traceback (most recent call last):\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 204, in maybe_due\r\nAug 29 22:47:59 celery[273]: result = self.apply_async(entry, publisher=publisher)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 260, in apply_async\r\nAug 29 22:47:59 celery[273]: entry, exc=exc)), sys.exc_info()[2])\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 252, in apply_async\r\nAug 29 22:47:59 celery[273]: **entry.options)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 573, in apply_async\r\nAug 29 22:47:59 celery[273]: **dict(self._get_exec_options(), **options)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/base.py\", line 345, in send_task\r\nAug 29 22:47:59 celery[273]: options = router.route(options, name, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/routes.py\", line 50, in route\r\nAug 29 22:47:59 celery[273]: route = self.lookup_route(task, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/routes.py\", line 78, in lookup_route\r\nAug 29 22:47:59 celery[273]: return _first_route(self.routes, task, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/utils/functional.py\", line 233, in _matcher\r\nAug 29 22:47:59 celery[273]: answer = getattr(maybe_evaluate(obj), method)(*args, **kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/utils/ha.py\", line 11, in route_for_task\r\nAug 29 22:47:59 celery[273]: (changed, instance) = Instance.objects.get_or_register()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/managers.py\", line 104, in get_or_register\r\nAug 29 22:47:59 celery[273]: return self.register()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/managers.py\", line 95, in register\r\nAug 29 22:47:59 celery[273]: with advisory_lock('instance_registration_%s' % hostname):\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib64/python2.7/contextlib.py\", line 17, in __enter__\r\nAug 29 22:47:59 celery[273]: return self.gen.next()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/utils/pglock.py\", line 13, in advisory_lock\r\nAug 29 22:47:59 celery[273]: with django_pglocks_advisory_lock(*args, **kwargs) as internal_lock:\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib64/python2.7/contextlib.py\", line 17, in __enter__\r\nAug 29 22:47:59 celery[273]: return self.gen.next()\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django_pglocks/__init__.py\", line 66, in advisory_lock\r\nAug 29 22:47:59 celery[273]: cursor.execute(command)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\", line 64, in execute\r\nAug 29 22:47:59 celery[273]: return self.cursor.execute(sql, params)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\nAug 29 22:47:59 celery[273]: six.reraise(dj_exc_type, dj_exc_value, traceback)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\", line 62, in execute\r\nAug 29 22:47:59 celery[273]: return self.cursor.execute(sql)\r\nAug 29 22:47:59 celery[273]: SchedulingError: Couldn't apply scheduled task cluster_heartbeat: server closed the connection unexpectedly\r\nAug 29 22:47:59 celery[273]: This probably means the server terminated abnormally\r\nAug 29 22:47:59 celery[273]: before or while processing the request.\r\nAug 29 22:47:59 celery[273]: [2018-08-29 19:47:59,748: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\nAug 29 22:47:59 celery[273]: [2018-08-29 19:47:59,749: ERROR/Beat] Message Error: Couldn't apply scheduled task task_manager: connection already closed\r\nAug 29 22:47:59 celery[273]: ['  File \"/var/lib/awx/venv/awx/bin/celery\", line 11, in <module>\\n    sys.exit(main())\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/__main__.py\", line 30, in main\\n    main()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 81, in main\\n    cmd.execute_from_commandline(argv)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 793, in execute_from_commandline\\n    super(CeleryCommand, self).execute_from_commandline(argv)))\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/base.py\", line 311, in execute_from_commandline\\n    return self.handle_argv(self.prog_name, argv[1:])\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 785, in handle_argv\\n    return self.execute(command, argv)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 717, in execute\\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/worker.py\", line 179, in run_from_argv\\n    return self(*args, **options)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/base.py\", line 274, in __call__\\n    ret = self.run(*args, **kwargs)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/worker.py\", line 212, in run\\n    state_db=self.node_format(state_db, hostname), **kwargs\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/worker/__init__.py\", line 206, in start\\n    self.blueprint.start(self)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bootsteps.py\", line 123, in start\\n    step.start(parent)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bootsteps.py\", line 374, in start\\n    return self.obj.start()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/process.py\", line 137, in start\\n    self._popen = Popen(self)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/forking.py\", line 105, in __init__\\n    code = process_obj._bootstrap()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/process.py\", line 292, in _bootstrap\\n    self.run()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 553, in run\\n    self.service.start(embedded_process=True)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 479, in start\\n    interval = self.scheduler.tick()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 221, in tick\\n    next_time_to_run = self.maybe_due(entry, self.publisher)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 207, in maybe_due\\n    exc, traceback.format_stack(), exc_info=True)\\n']\r\nAug 29 22:47:59 celery[273]: Traceback (most recent call last):\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 204, in maybe_due\r\nAug 29 22:47:59 celery[273]: result = self.apply_async(entry, publisher=publisher)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 260, in apply_async\r\nAug 29 22:47:59 celery[273]: entry, exc=exc)), sys.exc_info()[2])\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 252, in apply_async\r\nAug 29 22:47:59 celery[273]: **entry.options)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 573, in apply_async\r\nAug 29 22:47:59 celery[273]: **dict(self._get_exec_options(), **options)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/base.py\", line 345, in send_task\r\nAug 29 22:47:59 celery[273]: options = router.route(options, name, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/routes.py\", line 50, in route\r\nAug 29 22:47:59 celery[273]: route = self.lookup_route(task, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/routes.py\", line 78, in lookup_route\r\nAug 29 22:47:59 celery[273]: return _first_route(self.routes, task, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/utils/functional.py\", line 233, in _matcher\r\nAug 29 22:47:59 celery[273]: answer = getattr(maybe_evaluate(obj), method)(*args, **kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/utils/ha.py\", line 11, in route_for_task\r\nAug 29 22:47:59 celery[273]: (changed, instance) = Instance.objects.get_or_register()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/managers.py\", line 104, in get_or_register\r\nAug 29 22:47:59 celery[273]: return self.register()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/managers.py\", line 95, in register\r\nAug 29 22:47:59 celery[273]: with advisory_lock('instance_registration_%s' % hostname):\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib64/python2.7/contextlib.py\", line 17, in __enter__\r\nAug 29 22:47:59 celery[273]: return self.gen.next()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/utils/pglock.py\", line 13, in advisory_lock\r\nAug 29 22:47:59 celery[273]: with django_pglocks_advisory_lock(*args, **kwargs) as internal_lock:\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib64/python2.7/contextlib.py\", line 17, in __enter__\r\nAug 29 22:47:59 celery[273]: return self.gen.next()\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django_pglocks/__init__.py\", line 64, in advisory_lock\r\nAug 29 22:47:59 celery[273]: cursor = connections[using].cursor()\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\nAug 29 22:47:59 celery[273]: return self._cursor()\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 231, in _cursor\r\nAug 29 22:47:59 celery[273]: return self._prepare_cursor(self.create_cursor(name))\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\nAug 29 22:47:59 celery[273]: six.reraise(dj_exc_type, dj_exc_value, traceback)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 231, in _cursor\r\nAug 29 22:47:59 celery[273]: return self._prepare_cursor(self.create_cursor(name))\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 220, in create_cursor\r\nAug 29 22:47:59 celery[273]: cursor = self.connection.cursor()\r\nAug 29 22:47:59 celery[273]: SchedulingError: Couldn't apply scheduled task task_manager: connection already closed\r\nAug 29 22:47:59 celery[273]: [2018-08-29 19:47:59,761: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\nAug 29 22:47:59 celery[273]: [2018-08-29 19:47:59,762: ERROR/Beat] Message Error: Couldn't apply scheduled task tower_scheduler: connection already closed\r\nAug 29 22:47:59 celery[273]: ['  File \"/var/lib/awx/venv/awx/bin/celery\", line 11, in <module>\\n    sys.exit(main())\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/__main__.py\", line 30, in main\\n    main()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 81, in main\\n    cmd.execute_from_commandline(argv)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 793, in execute_from_commandline\\n    super(CeleryCommand, self).execute_from_commandline(argv)))\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/base.py\", line 311, in execute_from_commandline\\n    return self.handle_argv(self.prog_name, argv[1:])\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 785, in handle_argv\\n    return self.execute(command, argv)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/celery.py\", line 717, in execute\\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/worker.py\", line 179, in run_from_argv\\n    return self(*args, **options)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/base.py\", line 274, in __call__\\n    ret = self.run(*args, **kwargs)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bin/worker.py\", line 212, in run\\n    state_db=self.node_format(state_db, hostname), **kwargs\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/worker/__init__.py\", line 206, in start\\n    self.blueprint.start(self)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bootsteps.py\", line 123, in start\\n    step.start(parent)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/bootsteps.py\", line 374, in start\\n    return self.obj.start()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/process.py\", line 137, in start\\n    self._popen = Popen(self)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/forking.py\", line 105, in __init__\\n    code = process_obj._bootstrap()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/process.py\", line 292, in _bootstrap\\n    self.run()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 553, in run\\n    self.service.start(embedded_process=True)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 479, in start\\n    interval = self.scheduler.tick()\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 221, in tick\\n    next_time_to_run = self.maybe_due(entry, self.publisher)\\n', '  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 207, in maybe_due\\n    exc, traceback.format_stack(), exc_info=True)\\n']\r\nAug 29 22:47:59 celery[273]: Traceback (most recent call last):\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 204, in maybe_due\r\nAug 29 22:47:59 celery[273]: result = self.apply_async(entry, publisher=publisher)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 260, in apply_async\r\nAug 29 22:47:59 celery[273]: entry, exc=exc)), sys.exc_info()[2])\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/beat.py\", line 252, in apply_async\r\nAug 29 22:47:59 celery[273]: **entry.options)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 573, in apply_async\r\nAug 29 22:47:59 celery[273]: **dict(self._get_exec_options(), **options)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/base.py\", line 345, in send_task\r\nAug 29 22:47:59 celery[273]: options = router.route(options, name, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/routes.py\", line 50, in route\r\nAug 29 22:47:59 celery[273]: route = self.lookup_route(task, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/routes.py\", line 78, in lookup_route\r\nAug 29 22:47:59 celery[273]: return _first_route(self.routes, task, args, kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/utils/functional.py\", line 233, in _matcher\r\nAug 29 22:47:59 celery[273]: answer = getattr(maybe_evaluate(obj), method)(*args, **kwargs)\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/utils/ha.py\", line 11, in route_for_task\r\nAug 29 22:47:59 celery[273]: (changed, instance) = Instance.objects.get_or_register()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/managers.py\", line 104, in get_or_register\r\nAug 29 22:47:59 celery[273]: return self.register()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/managers.py\", line 95, in register\r\nAug 29 22:47:59 celery[273]: with advisory_lock('instance_registration_%s' % hostname):\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib64/python2.7/contextlib.py\", line 17, in __enter__\r\nAug 29 22:47:59 celery[273]: return self.gen.next()\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib/python2.7/site-packages/awx/main/utils/pglock.py\", line 13, in advisory_lock\r\nAug 29 22:47:59 celery[273]: with django_pglocks_advisory_lock(*args, **kwargs) as internal_lock:\r\nAug 29 22:47:59 celery[273]: File \"/usr/lib64/python2.7/contextlib.py\", line 17, in __enter__\r\nAug 29 22:47:59 celery[273]: return self.gen.next()\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django_pglocks/__init__.py\", line 64, in advisory_lock\r\nAug 29 22:47:59 celery[273]: cursor = connections[using].cursor()\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\nAug 29 22:47:59 celery[273]: return self._cursor()\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 231, in _cursor\r\nAug 29 22:47:59 celery[273]: return self._prepare_cursor(self.create_cursor(name))\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\nAug 29 22:47:59 celery[273]: six.reraise(dj_exc_type, dj_exc_value, traceback)\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 231, in _cursor\r\nAug 29 22:47:59 celery[273]: return self._prepare_cursor(self.create_cursor(name))\r\nAug 29 22:47:59 celery[273]: File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 220, in create_cursor\r\nAug 29 22:47:59 celery[273]: cursor = self.connection.cursor()\r\nAug 29 22:47:59 celery[273]: SchedulingError: Couldn't apply scheduled task tower_scheduler: connection already closed\r\nAug 29 22:47:59 celery[273]: [2018-08-29 19:47:59,763: DEBUG/Beat] beat: Waking up in 19.99 seconds.\r\n```"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nWhen Setting up LDAP Authentication it might be useful to test correct settings or not e.g. test button which checks connection with LDAP server and login, pass.\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"ISSUE TYPE\r\nFeature/ Bug \r\n\r\nCOMPONENT NAME\r\nUI\r\n\r\nSUMMARY\r\nI changed the role of only admin user (default admin) to normal user and now i cant change the role back to System admin neither i can create project or can do anything.\r\nIs there any thing that can be done in this case.\r\n\r\nSee Screen Shots:\r\nThis will work:"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nNotifications should have option to include job output as attachment (plain/html) or inline with body. I maintain a very clean template UI for users who only need to run workflow templates. I don't grant these users access to the underlying templates. As such these are hidden from the Templates and Jobs tab. These users can't view the output of failed jobs. If I could include job output of a failed playbook in the notification, I can maintain a clean Template UI.\r\n\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n- No logging when debugging AD authentication issues on Ubuntu 18.04.1 - AWX 1.0.7.2\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.2\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.2 \r\n* Operating System: Ubuntu 18.04\r\n* Web Browser: Safari, Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n`/etc/tower/conf.d/ldap.py` created\r\n`LOGGING['handlers']['tower_warnings']['level'] =  'DEBUG'` added to ldap.py\r\n\r\nLDAP Config:\r\n```\r\nServer URL\r\nldaps://<LDAP Server>:636\r\n\r\nBind DN\r\nCN=ansible,CN=users,DC=<LDAP domain>,DC=com\r\n\r\nLDAP User Search\r\n[\r\n \"OU=Users,DC=<LDAP domain>,DC=com\",\r\n \"SCOPE_SUBTREE\",\r\n \"(cn=%(user)s)\"\r\n]\r\n\r\nLDSP Group Search\r\n[\r\n \"dc=<LDAP domain>,dc=com\",\r\n \"SCOPE_SUBTREE\",\r\n \"(objectClass=group)\"\r\n]\r\n\r\nLDAP User Attribute MAP\r\n{\r\n \"first_name\": \"givenName\",\r\n \"last_name\": \"sn\",\r\n \"email\": \"mail\"\r\n}\r\n\r\nLDSP Group Type Params\r\n{\r\n \"member_attr\": \"member\",\r\n \"name_attr\": \"cn\"\r\n}\r\n\r\nLDSP User Flags by Group\r\n{\r\n \"is_superuser\": [\r\n  \"cn=AWX Admin,ou=groups,dc=<LDAP domain>,dc=com\"\r\n ]\r\n}\r\n\r\nLDAP Org MAP\r\n{\r\n \"MAIN\": {\r\n  \"users\": [\r\n   \"cn=AWX Users,ou=groups,dc=<LDAP domain>,dc=com\"\r\n  ],\r\n  \"admins\": \"cn=AWX Admin,ou=groups,dc=<LDAP domain>,dc=com\",\r\n  \"remove_admins\": false,\r\n  \"remove_users\": false\r\n }\r\n}\r\n```\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nFailures logged into `/var/log/tower`\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nNo logging exists on failed login with AD accounts\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem or desired enhancement. -->\r\nIt would be useful to be able to manage Satellite via playbook tasks. AWX currently does not include injectors for the Satellite 6 credential, meaning they are not usable in a playbook. \r\n\r\nWhen creating a custom credential, these are the injectors used:\r\n```yaml\r\ninjectors:\r\n      extra_vars:\r\n        satellite_username: \"{{ '{{ \\\"{{username}}\\\" }}'}}\"\r\n        satellite_password: \"{{ '{{ \\\"{{password}}\\\" }}'}}\"\r\n        satellite_host: \"{{ '{{ \\\"{{host}}\\\" }}'}}\"\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\n\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nI'm proud to announce the WIP on a terraform provider for AWX. It's based on the Go SDK https://github.com/Colstuwjx/awx-go that we are extending to satisfy the provider and the AWX/Tower capabilities.\r\nThe current provider version permits CRUD operations on the basic inventory resource.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhttps://github.com/mauromedda/terraform-provider-awx\r\nhttps://github.com/Colstuwjx/awx-go\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nSince upgrading to 1.0.7, the Slack notifier ignores the Avatar and name that is set within the Slack configuration\r\n\r\n##### ENVIRONMENT\r\n* AWX version:Ansible 2.6.2\r\n* AWX install method: docker on linux\r\n* Ansible version: AWX 1.0.7.2\r\n* Operating System: Ubuntu\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd a avatar and name to the bot in Slack and send a Slack notifier to it from AWX\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTo keep name and avatar\r\n\r\n##### ACTUAL RESULTS\r\n\r\n![screenshot from 2018-08-20 07-45-02](https://user-images.githubusercontent.com/6459792/44324240-f504c380-a44c-11e8-8d9c-0ee70534c306.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIt previous looked like this:\r\n\r\n![screenshot from 2018-08-20 07-45-50](https://user-images.githubusercontent.com/6459792/44324272-12399200-a44d-11e8-87b9-296d055d1471.png)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nAWX does not handle Azure modules the same as ansible \"core\"\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.41\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.2\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n`azure_rm_virtualmachine:\r\n    subscription_id: '{{ az_customer_subscription_id }}'\r\n    ad_user: '{{ ad_user_login_var }}'\r\n    password: '{{ ad_password_var }}'\r\n    resource_group: '{{customer_prefix}}-can{{can_var}}'\r\n    name: \"{{customer_prefix}}-can{{can_var}}-vm\"\r\n    vm_size: \"{{can_size_selection}}\"\r\n    os_type: Windows\r\n    managed_disk_type: Premium_LRS\r\n    public_ip_allocation_method: Dynamic\r\n    admin_username: \"{{admin_username}}\"\r\n    admin_password: \"{{can_admin_password}}\"\r\n    virtual_network_resource_group: \"{{customer_prefix}}-aio\"\r\n    virtual_network_name: \"{{customer_prefix}}-vnet\"\r\n    subnet_name: \"{{customer_prefix}}-aio-subnet\"\r\n    image:\r\n      offer: WindowsServer\r\n      publisher: MicrosoftWindowsServer\r\n      sku: 2012-R2-Datacenter\r\n      version: latest\r\n    data_disks:\r\n    - lun: 0\r\n      disk_size_gb: 1023\r\n      managed_disk_type: Premium_LRS\r\n    - lun: 1\r\n      disk_size_gb: 1023\r\n      managed_disk_type: Premium_LRS\r\n    - lun: 2\r\n      disk_size_gb: 1023\r\n      managed_disk_type: Premium_LRS`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIn ansible core with same ansible version a VM is created\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`\r\ntask path: /var/lib/awx/projects/_12__ansible141918/Playbooks/roles/azure-dce-can/tasks/main.yml:12 |  \r\n-- | --\r\n  | 103 | Using module file /usr/lib/python2.7/site-packages/ansible/modules/cloud/azure/azure_rm_virtualmachine.py |  \r\n  | 104 | <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root |  \r\n  | 105 | <127.0.0.1> EXEC /bin/sh -c '/usr/bin/python2 && sleep 0' |  \r\n  | 106 | The full traceback is: |  \r\n  | 107 | File \"/tmp/ansible_7Vosly/ansible_module_azure_rm_virtualmachine.py\", line 1635, in create_default_nic |  \r\n  | 108 | subnet = self.network_client.subnets.get(virtual_network_resource_group, virtual_network_name, self.subnet_name) |  \r\n  | 109 | File \"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/azure/mgmt/network/v2017_11_01/operations/subnets_operations.py\", line 175, in get |  \r\n  | 110 | raise exp |  \r\n  | 111 |   |  \r\n  | 112 | fatal: [localhost]: FAILED! => { |  \r\n  | 113 | \"changed\": false, |  \r\n  | 114 | \"invocation\": { |  \r\n  | 115 | \"module_args\": { |  \r\n  | 116 | \"ad_user\": \"VALUE_SPECIFIED_IN_NO_LOG_PARAMETER\", |  \r\n  | 117 | \"adfs_authority_url\": null, |  \r\n  | 118 | \"admin_password\": \"VALUE_SPECIFIED_IN_NO_LOG_PARAMETER\", |  \r\n  | 119 | \"admin_username\": \"testadmin\", |  \r\n  | 120 | \"allocated\": true, |  \r\n  | 121 | \"api_profile\": \"latest\", |  \r\n  | 122 | \"append_tags\": tru… |  \r\n  | ... |   |  \r\n  | 188 |   |  \r\n  | 189 | PLAY RECAP ********************************************************************* | 14:42:10\r\n  | 190 | localhost                  : ok=4    changed=1    unreachable=0    failed=1\r\n\r\n`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSeems like AWX has issues with the azure modules.\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nFor example, if operator can execute certain automation task during the greenzone, they would prefer to provide that particular user access to Ansible Tower only during the Greenzone time period and restrict the access to ansible tower for other time period."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\ninventory and vars files are written twice for some reason\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.7.start\r\n* AWX install method: all\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a JT that prints files in the private data directory\r\n\r\nor use this one\r\n\r\nhttps://github.com/AlanCoding/permission-testing-playbooks/blob/master/inspect_tower_directory.yml\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIf no credential was supplied, 4 normal files\r\n\r\n##### ACTUAL RESULTS\r\n\r\n2 files\r\n\r\n - inventory file\r\n - duplicate of the inventory file\r\n - extra_vars file\r\n - duplicate of the extra_vars file\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIn case it wasn't obvious, this issue is to stop producing the duplicate files."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI have been using the awx as our job system, and setup an inventory with a list of instances, they are all ssh via a jump host, and inventory ssh config likes below:\r\n\r\n```\r\nansible_ssh_common_args: '-o ProxyCommand=\"ssh -W %h:%p -q admin@jumper-01\"'\r\n```\r\nand awx throws error:\r\n\r\n![image](https://user-images.githubusercontent.com/3972545/44078895-3d3f17d0-9fda-11e8-8506-d4dcbe6664bf.png)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.9\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.3\r\n* Operating System: CentOS 7\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd an inventory with some instances, and configure instance variable likes below:\r\n\r\n```\r\nansible_ssh_common_args: '-o ProxyCommand=\"ssh -W %h:%p -q admin@jumper-01\"'\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob result would be succeed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nJob result was failed, could NOT ssh into instances.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n- Project\r\n\r\n##### SUMMARY\r\nI've got a project under Git that is clonable with HTTPS only, and which references git Submodules using an SSH Url (on Github, not needing any credentials)\r\nAnd the clone operation fails when trying to init/update submodules.\r\n\r\n##### ENVIRONMENT\r\n* AWX 1.0.6.41\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.1\r\n* Operating System: Ubuntu 16.04\r\n\r\n##### ADDITIONAL INFORMATION\r\nError message:\r\nFailed to init/update submodules: Submodule 'roles/logwatch' (git@github.com:nodje/ansible-logwatch.git) registered for path 'roles/logwatch'\r\netc."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nWe try to evaluate the AWX and are not able to send slack notifications.\r\nThe documentation seems to be outdated.\r\nSome examples how auth tokens look might be useful\r\n\r\n##### ENVIRONMENT\r\n* AWX version: \r\nawx-manage --version\r\n3.2.4\r\n\r\n* AWX install method: AWS europe central AMI\r\n\r\n* Ansible version:  X.Y.Z\r\nansible --version\r\nansible 2.5.2\r\n\r\n* Operating System:\r\n* Web Browser: firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Set up EC2 instance with latest AMI in Frankfurt Main\r\n- Add a notification type \"Slack\"\r\n- Click \"Test notification\" button\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA notification should appear in my slack channel\r\n\r\n##### ACTUAL RESULTS\r\n\r\nfrom tower.log\r\n```\r\n\r\n2018-08-10 13:00:00,680 ERROR    awx.main.notifications.slack_backend Exception sending messages: 'NoneType' object has no attribute 'send_message'\r\n2018-08-10 13:00:00,681 ERROR    awx.main.tasks Send Notification Failed 'NoneType' object has no attribute 'send_message'\r\n\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n- We created a new app in slack (there is no way to add a bot only right now)\r\n- We added a bot user\r\n- We installed the app in our private channel\r\n- We set up the channel name and the token starting with xoxb- (oAuth bot token) within Ansible tower\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\"check\" type project updates check out the full source tree to the file system.\r\n\r\nThis is not necessary, and it will be done on the pre-JT sync anyway. It would be lazier behavior, and more performant, to avoid this in the updates themselves.\r\n\r\nIt would also be semantically more easy to understand that a \"check\" type update just checks.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a project, check the projects folder. Alternatively, delete the project folder and do a new update, or update the project and do a new update.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nsource tree checkout is lazy, so the source tree should not be there after just creating the project, or be unaffected by the update.\r\n\r\nThe server should wait until actually running a job before checking out the source tree.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nEvery project update clones the full source tree\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nthe git module clearly has utilities to accomplish this:\r\n\r\nhttps://github.com/ansible/ansible/blob/0a701ff74601748efa93fbc366e6368e53c39cd0/lib/ansible/modules/source_control/git.py#L494-L534\r\n\r\nexamples using git CLI:\r\n\r\n```\r\n$ git ls-remote https://github.com/ansible/ansible.git -h HEAD\r\n8662e87b1af9b189d9c10d80655581807ad520dc\tHEAD\r\n$ git ls-remote https://github.com/ansible/ansible.git -h refs/heads/stable-2.3\r\nb20520f500ad6878750bd2e2e8be46f756e4eaa5\trefs/heads/stable-2.3\r\n```\r\n\r\nit appears that we can _just_ use these utilities without actually checking out if we use check_mode\r\n\r\nhttps://github.com/ansible/ansible/blob/0a701ff74601748efa93fbc366e6368e53c39cd0/lib/ansible/modules/source_control/git.py#L1067-L1074\r\n\r\nSo this is entirely possible...\r\n\r\nbut a major challenge will be how we deal with populating the playbook list."},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nSCM Failure  prints git synchronization passwords in plain text\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.14\r\n* AWX install method: docker\r\n* Ansible version:  2.5.4\r\n\r\n* Operating System: RHEL\r\n* Web Browser:  chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nCreate an SCM update at the project level\r\n\r\nensure that scm fails by putting a wrong username ,, password which is encrypted gets printed in plain text\r\n\r\n![image](https://user-images.githubusercontent.com/42220463/43861236-39bc52e0-9b24-11e8-87a9-a0a1e0ad34bb.png)\r\n![image](https://user-images.githubusercontent.com/42220463/43861342-86106bb8-9b24-11e8-8fee-4b3abe7a312d.png)\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\npassword should be *******\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nPassword is Password123 [Plain text]\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe now allow mutliple LDAP configurations.\r\n\r\nIt should be possible to designate a configuration such that it is only used by a particular domain. i.e., a user would enter foo@bar.baz.com as their user name, and their account would be verified against whatever LDAP configuration desginates that it's for bar.baz.com.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### STEPS TO REPRODUCE\r\nWe are going to use a network credential as if it was a machine credential. Network module usage looks like:\r\n```yaml\r\n  - name: Retrieving full config from devices\r\n    juniper_junos_config:\r\n      host: '{{ inventory_hostname }}'\r\n      user: 'netscript'\r\n      ssh_private_key_file: '~/.ssh/test_key'\r\n      port: 830\r\n      timeout: 300\r\n      format: text\r\n      return_output: false\r\n      retrieve: committed\r\n      dest_dir: \"output/\"\r\n```\r\n\r\n* Create a password protected ssh key\r\n* Add the public key to `authorized_key` on a host accessible by tower\r\n* Create an inventory w/ the host accessible by tower in it\r\n* Create a network cred that uses the ssh key and unlock password\r\n* Create a JT that uses the network credential and this playbook https://github.com/chrismeyersfsu/ansible-examples/blob/master/ssh_key_file/main.yml\r\n* Run the JT\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* Playbook to succeed\r\n\r\n##### ACTUAL RESULTS\r\n\r\n* Job fails when it runs it's first task, gathering facts\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nFor password protected network credentials, (1) we aren't telling pexpect to \"fill in the password\". Job templates can't, effectively, use two password protected ssh keys and (2) we aren't protecting the user from assigning a network cred and machine cred with this case.\r\n\r\n```\r\nTASK [Gathering Facts] *********************************************************\r\nEnter passphrase for key '/tmp/awx_479_KUdnKp/tmpwplXmU': \r\nfatal: [cmeyershost]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic).\\r\\n\", \"unreachable\": true}\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIn `inventory variables` of `Inventory` only data from one source is present after batch inventory sync.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.17, 1.0.6.39, 1.0.6.41\r\n* working AWX version: ??\r\n\r\nInventory Sources configured with following options:\r\n  [x] Overwrite \r\n  [ ] Overwrite Variables \r\n  [ ] Update on Launch \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate mutlisource inventory and sync it, i.e. manually or via tower-cli\r\n```\r\ntower-cli inventory batch_update -n \"INVENTORY-WITH-MANY-SOURCES\"\r\n```\r\nThis results in data from the single source present. Subsequent sync solves issue.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nData from all inventories is present in \"inventory variables\"\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOnly data from single source is present.\r\n\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nPassing extra_vars with integer values(i.e. via tower-cli --version 3.3.0) results on value not being passed\r\n```\r\ntower-cli workflow_job launch -W \"Test Workflow\" -e count_input='10' --monitor -v\r\n```\r\n\r\n```\r\nPOST http://.../api/v2/workflow_job_templates/1807/launch/\r\nData: {'extra_vars': u'{\"count_input\": 10}'}\r\n```\r\n`count_input` becomes empty in workflow :\r\n\r\n```\r\n$ curl http://<>:80/api/v2/workflow_jobs/9706/  | jq\r\n{\r\n...\r\n  \"elapsed\": 32.084,\r\n  \"job_args\": \"\",\r\n  \"job_cwd\": \"\",\r\n  \"job_env\": {},\r\n  \"job_explanation\": \"\",\r\n  \"result_traceback\": \"\",\r\n  \"workflow_job_template\": 1807,\r\n  \"extra_vars\": \"{\\\"count_input\\\": \\\"\\\"}\",\r\n \"allow_simultaneous\": false\r\n}\r\n```\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.39\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nCurrently :\r\n -  `extra_vars` are allowed for Nodes within workflows(job_template). Only vars defined in survey can be used here in extra_vars.\r\n -  `extra_data` variables are allowed for whole job_template/workflow only.\r\n\r\nThis is a suggestion of adding a support for `extra_data` within workflow on per-workflow node(job_template) basis. This will allow more precise control of workflow job_templates.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIncrease the maximum size of the 'limit' field in the job template from the current maximum of 1024 bytes to 2048 bytes.\r\n\r\n##### ENVIRONMENT\r\n* Tower 3.2.5\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis change will allow more complex limit logic in job templates, especially with large inventories."},{"labels":["api",null,null,null,null],"text":"\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n- UI\r\n\r\n##### SUMMARY\r\n\r\nWe fork some dependencies locally for both the API (requirements_git.txt) and the UI (packages.json).\r\n\r\nWhile that's OK, we should have it documented in the source tree:\r\n- why we forked a package\r\n- what the changes we added were\r\n- if the change was sent upstream/how we would know when we can use the upstream version\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI would like to add TCP Keepalive message option on logging setting to avoid closing idle connection by firewall. If firewall terminate the connection between logging aggregator, These events will be dropped and not recorded on external logging.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen a job is run through the API (and likely through the web interface too), it seems that the inventory sync happens first and then the SCM sync (or the two happen in parallel). That means that any inventory changes that happen as part of the SCM update don't get reflected in the job execution\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.41\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.6.0\r\n* Operating System: Linux\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a job with an inventory that has an SCM based inventory source. Run job. Update SCM to new value, re-run job\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNew value is reflected in job execution, because job execution triggers SCM sync first and then inventory sync\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOld value is reflected in job execution\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIt's difficult to see exact timings, but \r\n\r\nSCM sync job:  Started 8/6/2018 11:35:22 AM Finished 8/6/2018 11:35:33 AM\r\nInventory sync job: Started 8/6/2018 11:35:22 AM Finished 8/6/2018 11:35:31 AM\r\n\r\nFrom the SCM sync job:\r\n\r\n\r\n| 12 | TASK [update project using git] ************************************************ | 11:35:24\r\n| 13 | changed: [localhost] |  \r\n| 14 |   |  \r\n| 15 | TASK [Set the git repository version] ****************************************** | 11:35:32\r\n| 16 | ok: [localhost]\r\n\r\nFrom the tail of the inventory sync job:\r\n\r\n\r\n  | 439 | 2018-08-06 01:35:31,310 DEBUG    awx.main.models.inventory Going to update inventory computed fields |  \r\n  | 440 | 2018-08-06 01:35:31,424 DEBUG    awx.main.models.inventory Finished updating inventory computed fields |  \r\n  | 441 | 5.050 INFO     Inventory import completed for XYZ in 3.7s |  \r\n\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n \r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt is currently possible to filter by specific fields using the API but it would be good to be able to filter out specific fields similar to using jq:\r\nExample:\r\n\r\n```\r\ncurl -f -k -H 'Content-Type: application/json' -XGET --user admin:password https://localhost/api/v2/hosts/?last_job_host_summary__failed=false | jq -r '.[\"results\"][][\"name\"]'\r\n```\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n* AWX install method: N/A\r\n* Ansible version:  2.6.2\r\n* Operating System: RHEL7\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nN/A\r\n##### EXPECTED RESULTS\r\nN/A\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nN/A\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAnsible events can be multi-line, but any verbose events (which are not Ansible events) can be only 1 line each\r\n\r\nIt would be more performant to save multiple lines to a single event, when `write` is called to the standard out buffer in that way.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun an inventory update that fails\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSingle events that correspond to a write of the full traceback\r\n\r\n##### ACTUAL RESULTS\r\n\r\nStill things like blank line events\r\n\r\n```json\r\n        {\r\n            \"id\": 81,\r\n            \"type\": \"inventory_update_event\",\r\n            \"url\": \"\",\r\n            \"related\": {\r\n                \"inventory_update\": \"/api/v2/inventory_updates/21/\"\r\n            },\r\n            \"summary_fields\": {},\r\n            \"created\": \"2018-07-09T19:14:39.013314Z\",\r\n            \"modified\": \"2018-07-09T19:14:39.013331Z\",\r\n            \"event\": \"verbose\",\r\n            \"counter\": 38,\r\n            \"event_display\": \"verbose\",\r\n            \"event_data\": {},\r\n            \"failed\": false,\r\n            \"changed\": false,\r\n            \"uuid\": \"\",\r\n            \"stdout\": \"\",\r\n            \"start_line\": 37,\r\n            \"end_line\": 38,\r\n            \"verbosity\": 0,\r\n            \"inventory_update\": 21\r\n        },\r\n```\r\n\r\nEven lines that are clearly correlated, and written to the standard out buffer in that way, are broken up by lines.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nrelated to https://github.com/ansible/awx/issues/200"},{"labels":["api",null,null,null],"text":"##### SUMMARY\r\nWhen using set_stats, callback is not written. An error is generated, but playbook run successfully. Subsequent playbook in a workflow template does not receive set_stats on execution.\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\nawx/lib/awx_display_callback/module.py\r\n\r\n##### ANSIBLE VERSION\r\n```\r\nansible-playbook 2.6.1\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Feb 20 2018, 09:19:12) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n```\r\n\r\n##### OS / ENVIRONMENT\r\nRed Hat Enterprise Linux Server release 7.4 (Maipo)  \r\nAnsible Tower 3.2.5 \r\nAnsible 2.6.1\r\n\r\n##### STEPS TO REPRODUCE\r\n```yaml\r\n---\r\n- hosts: tower\r\n  become: no\r\n  gather_facts: no\r\n\r\n  tasks:\r\n  - set_stats:\r\n      data:\r\n        extra_vars:\r\n          some_fact: 'foo'\r\n        some_fact: 'foo'\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n```\r\nCUSTOM STATS: ******************************************************************\r\n\r\n\tRUN: { \"extra_vars\": {  \"some_fact\": \"foo\" },  \"some_fact\": \"foo\"}\r\n```\r\n\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n [WARNING]: Failure using method (v2_playbook_on_stats) in callback plugin\r\n(<awx_display_callback.module.AWXDefaultCallbackModule object at\r\n0x7fa9b563bf10>): [Errno 17] File exists:\r\n'/var/lib/awx/.ansible/tmp/awx_3094_b7FWcd/artifacts'\r\n\r\nCallback Exception: \r\n  File \"/usr/lib/python2.7/site-packages/ansible/executor/task_queue_manager.py\", line 374, in send_callback\r\n    method(*new_args, **kwargs)\r\n   File \"/lib/python2.7/site-packages/awx/lib/awx_display_callback/module.py\", line 323, in v2_playbook_on_stats\r\n   File \"/usr/lib64/python2.7/os.py\", line 157, in makedirs\r\n    mkdir(name, mode)\r\n```\r\n\r\n##### CODE TO BLAME\r\nhttps://github.com/ansible/awx/blob/devel/awx/lib/awx_display_callback/module.py#L311\r\n\r\n( last line in block below)\r\n```\r\n        if custom_artifact_data:\r\n            # create the directory for custom stats artifacts to live in (if it doesn't exist)\r\n            custom_artifacts_dir = os.path.join(os.getenv('AWX_PRIVATE_DATA_DIR'), 'artifacts')\r\n            os.makedirs(custom_artifacts_dir, mode=stat.S_IXUSR + stat.S_IWUSR + stat.S_IRUSR)\r\n```\r\nIt appears that on an isolated node, the custom_artifact_dir is automatically created. Add if condition to os.makedirs fixes the observed behavior:\r\n\r\n\r\n\r\n```\r\n        if custom_artifact_data:\r\n            # create the directory for custom stats artifacts to live in (if it doesn't exist)\r\n            custom_artifacts_dir = os.path.join(os.getenv('AWX_PRIVATE_DATA_DIR'), 'artifacts')\r\n            if not os.path.isdir(custom_artifacts_dir):\r\n                os.makedirs(custom_artifacts_dir, mode=stat.S_IXUSR + stat.S_IWUSR + stat.S_IRUSR)\r\n```\r\n"},{"labels":["api",null,null,null],"text":"\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nOur current OAuth support allows users to generate tokens for themselves.\r\n\r\nWe should extend our OAuth support such that a user XYZ in a third-party service can 'authenticate' themselves to Tower and allow that service to perform operations on their behalf.\r\n\r\nThis could also include creating specific service accounts that would take advantage of this.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nSee https://github.com/ansible/awx/issues/171\r\n\r\nWhen that lands, and we start using the boto3 `aws_ec2` inventory plugin, awx/main/models/inventory.py:get_ec2_region_choices should be updated to properly get regions from boto3 (and we can drop boto from the awx environment).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCannot save authentication settings\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6 (also tested with 1.0.5 and 1.0.4)\r\n* AWX install method: docker (linux)\r\n* Ansible version:  2.5.4\r\n* Operating System: CentOS 7\r\n* Web Browser: Firefox and Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nGoto settings -> Authentication -> Sub Category (LDAP) and fill in the basic configuration:\r\n- LDAP SERVER URI\r\n- LDAP BIND DN\r\n- LDAP BIND PASSWORD\r\n- LDAP USER DN TEMPLATE\r\n\r\nBefore save view the `awx_web` logs, on save the server produce a HTTP code `400`.\r\n\r\n##### EXPECTED RESULTS\r\nFilled-in information is saved and the HTTP code in the `awx_web` log should show `200`.\r\n\r\n##### ACTUAL RESULTS\r\nIn the `awx_web` logs shows an error 400 code:\r\n\r\n```\r\n2018-07-31 08:36:50,233 WARNING  awx.api.generics status 400 received by user admin attempting to access /api/v2/settings/all/ from 10.0.0.198\r\n10.0.0.198 - - [31/Jul/2018:08:36:50 +0000] \"PATCH /api/v2/settings/all/ HTTP/1.1\" 400 76 \"http://10.0.0.150/\" \"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36\"\r\n[pid: 29|app: 0|req: 8/21] 10.0.0.198 () {48 vars in 2423 bytes} [Tue Jul 31 08:36:49 2018] PATCH /api/v2/settings/all/ => generated 76 bytes in 272 msecs (HTTP/1.1 400) 8 headers in 251 bytes (1 switches on core 0)\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nSometimes, not always, I also see the following message passing in the `awx_web` logs when trying to save my configuration.\r\n\r\n```\r\n2018-07-31 08:52:33,509 ERROR    django.request Internal Server Error: /api/v2/settings/all/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 260, in patch\r\n    return self.partial_update(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 745, in partial_update\r\n    return super(RetrieveUpdateAPIView, self).partial_update(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 84, in partial_update\r\n    return self.update(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 741, in update\r\n    return super(RetrieveUpdateAPIView, self).update(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 69, in update\r\n    serializer.is_valid(raise_exception=True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 236, in is_valid\r\n    self._validated_data = self.run_validation(self.initial_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 435, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 465, in to_internal_value\r\n    validated_value = field.run_validation(primitive_value)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 523, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/serializers.py\", line 57, in to_internal_value\r\n    obj = super(SettingFieldMixin, self).to_internal_value(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/fields.py\", line 401, in to_internal_value\r\n    return cls(**params_sanitized)\r\nTypeError: __init__() takes at least 2 arguments (2 given)\r\n```\r\n"},{"labels":["api"],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThe ability to disable bubblewrap on a per job template or inventory sync basis.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Latest"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInventory updates have log-based verbosity, `ansible-inventory` has verbosity too, but the latter has no bearing on the former. We should change that.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nrun an inventory update and crank the verbosity up as far as it goes\r\n\r\nraise an exception in the script it runs\r\n\r\n##### EXPECTED RESULTS\r\n\r\ntraceback from exception\r\n\r\n##### ACTUAL RESULTS\r\n\r\nno traceback\r\n\r\nwe can get traceback by converting our inventory update verbosity to ansible verbosity (`-v`, `-vv`, etc.) and passing that in CLI args.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis could introduce problems if, in some cases, Ansible core writes verbose information to stdout, causing the JSON parser to error.\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCurrently, the Slack integration will send notifications to Slack as the user \"bot\" with a generic avatar icon.\r\nSlack allows configuring the appearance of bot users and it would be very nice if AWX took advantage of this.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0 (also with 1.0.6)\r\n* AWX install method: custom playbook based on official docker containers\r\n* Ansible version:  2.6.1\r\n* Operating System: CentOS Linux 7\r\n* Web Browser: Firefox / Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nThis would work exactly as the Slack integration does right now.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nThis is what the notification should look like, with a custom icon and bot name configured in Slack:\r\n![awx-bot-expected](https://user-images.githubusercontent.com/371687/43268093-03e6e4de-90f0-11e8-9ae7-7b0fd38c6752.png)\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nThis is what AWX posts:\r\n![awx-bot-actual](https://user-images.githubusercontent.com/371687/43268138-1f4acc9a-90f0-11e8-91a7-a7b243ed08a4.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nNone."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWorking with teams it is often not optimal to share vault encryption keys among developers. \r\n\r\nHaving a lightweight option in AWX that would allow a developer to select a vault credential and encrypt a given output, returning the encrypted value would allow developers to self-service encrypted secret generation.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: All\r\n\r\n##### STEPS TO REPRODUCE\r\n* Developer logs in to AWX\r\n* Developer navigates to encryption service\r\n* Encryption key is selected from known vault credentials\r\n* Secret is entered as input\r\n\r\n##### EXPECTED RESULTS\r\n* Encrypted secret value is returned to be inserted into ansible playbooks and decrypted by AWX upon run time\r\n\r\n##### ACTUAL RESULTS\r\nDoes not exist\r\n\r\n##### ADDITIONAL INFORMATION\r\n* Would there be any security concerns with this approach? \r\n* What are the pro's and con's in the communitie's opinion? \r\n* Could vault credentials be accessed with similar RBAC?\r\n"},{"labels":["api",null,null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nFor RHV credentials it would be nice to either insert FQDN or URL of oVirt API.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nCreate RHV credentials, try to insert FQDN instead of URL of the API.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nPossible.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nNot possible.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nIt would be nice to check if user has passed URL, just by searching for '/' in input string, if it contains '/' then pass it else append to it `https://{{host}}/ovirt-engine/api`\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nI use AWX Project synced with a Git repository with SSH source control credential type which uses a private key and a passphrase.\r\nEverything's fine except if I try to sync the AWX Project with a different branch than the default branch of the Git repository e.g: using the \"SCM BRANCH/TAG/COMMIT\" field in the AWX Project configuration. In this use case the project sync job launches the command \"/usr/bin/git ls-remote origin -h refs/heads/mybranch\" after clonging the repository branch. And this command apparently fails to authenticate through SSH with the private key and passphrase.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.3\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.2\r\n* Operating System: Ubuntu 16.04 LTS\r\n* Web Browser: Google Chrome 67.0.3396.99 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n- We want to sync an AWX project with a specific branch of Git (Gitlab in my case) repository. The authentication method to git is SSH with private key and passphrase.\r\n- Create a credential of type \"Source Control\" with:\r\n  - a username (\"git\") in my case\r\n  - no password\r\n  - a private key and its passphrase\r\n- Create an AWX Project with:\r\n  - \"SCM Type\" set to \"Git\" and sync it with a repository\r\n  - \"SCM Credential\" set to the previously created \"Source Control\" credential\r\n  - \"SCM BRANCH/TAG/COMMIT\" set to a branch different from the default clone branch of the Git repository, lets call it \"mybranch\"\r\n- Save the project click on the button \"Get latest SCM revision\" to get the project from the Git repository\r\n\r\n##### EXPECTED RESULTS\r\nThe project is successfully synced and exists in /var/lib/awx/project directory inside the awx_task_1 Docker container.\r\n\r\n##### ACTUAL RESULTS\r\nThe Project sync job fails with the following error:\r\n```\r\nfatal: [localhost]: FAILED! => \r\n{\r\n   \"changed\":false,\r\n   \"cmd\":\"/usr/bin/git ls-remote origin -h refs/heads/mybranch\",\r\n   \"msg\":\"ssh: connect to host gitlab.mydomain.com port 22: Connection refused\\\\r\\\\nfatal: Could not read from remote repository.\\\\n\\\\nPlease make sure you have the correct access rights\\\\nand the repository exists.\",\r\n   \"rc\":128,\r\n   \"stderr\":\"ssh: connect to host gitlab.mydomain.com port 22: Connection refused\\\\r\\\\nfatal: Could not read from remote repository.\\\\n\\\\nPlease make sure you have the correct access rights\\\\nand the repository exists.\\\\n\",\r\n   \"stderr_lines\":[\r\n      \"ssh: connect to host gitlab.mydomain.com port 22: Connection refused\",\r\n      \"fatal: Could not read from remote repository.\",\r\n      \"\",\r\n      \"Please make sure you have the correct access rights\",\r\n      \"and the repository exists.\"\r\n   ],\r\n   \"stdout\":\"\",\r\n   \"stdout_lines\":[\r\n\r\n   ]\r\n}\r\n```\r\nHowever:\r\n- The project actually exists inside `/var/lib/awx/project/_X__myproject`\r\n- a `git status` inside `/var/lib/awx/project/_X__myproject` reports that:\r\n```\r\nOn branch mybranch\r\nYour branch is up to date with 'origin/mybranch'.\r\n\r\nnothing to commit, working tree clean\r\n```\r\n\r\nSo as stated in my brief summary, the clone was done successfully but the command \"/usr/bin/git ls-remote origin -h refs/heads/mybranch\" apparently fails to authenticate through SSH with the private key and passphrase.\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis is a minor issue ihmo because if I leave the \"SCM BRANCH/TAG/COMMIT\" field empty in the Project configuration then everything goes fine. So as a workaround, I simply changed the default branch of my repository from \"master\" to \"mybranch\".\r\nHowever @matburt on IRC told me I could file the issue here.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAbility to create users categorized as 'Enterprise' (SAML, RADIUS, TACACS+) through the UI/API.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhile launching a job an activity tries to retrieve the latest updates from the GIT source repository. This activity fails.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.35\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.6.1\r\n* Operating System: Ubuntu Xenial\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n- Create a job template\r\n- Create a GIT source project (SCM update options: Clean, Update Revision On Launch)\r\n- Configure the job template to use a GIT source\r\n- Run the job template\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nJob runs succesfully\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nJob fails:\r\n`\r\nTraceback (most recent call last): File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 881, in run self.pre_run_hook(instance, **kwargs) File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 2123, in pre_run_hook task_instance.run(local_project_sync.id) File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 574, in _wrapped return f(self, *args, **kwargs) File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 1027, in run raise AwxTaskError.TaskError(instance, rc) Exception: project_update 567 (failed) encountered an error (rc=2), please see task stdout for details.\r\n`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI was executing jobs and the task was left in a loop, I eliminated the job and after all the jobs I was doing was in a pending state\r\n\r\n##### ENVIRONMENT\r\n* AWX install method: docker on linux\r\n\r\n##### STEPS TO REPRODUCE\r\nCan't find a way\r\n\r\n##### EXPECTED RESULTS\r\nJob should run\r\n\r\n##### ACTUAL RESULTS\r\n\r\njob staying in pendning\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\ndocker logs -f awx_task_1\r\n\r\n``\r\n[2018-07-20 13:46:05,332: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\n[2018-07-20 13:46:05,342: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->574271ce-5f2d-466d-ae66-d63180a9c599\r\n[2018-07-20 13:46:05,342: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[574271ce-5f2d-466d-ae66-d63180a9c599] expires:[2018-07-20 13:46:25.340442+00:00]\r\n[2018-07-20 13:46:05,343: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fca08502320> (args:(u'awx.main.tasks.awx_periodic_scheduler', u'574271ce-5f2d-466d-ae66-d63180a9c599', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-07-20T13:46:25.340442+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.awx_periodic_scheduler', u'callbacks': None, u'correlation_id': u'574271ce-5f2d-466d-ae66-d63180a9c599', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'f098019c-3780-3d1c-8bf7-425c0287b97a', u'id': u'574271ce-5f2d-466d-ae66-d63180a9c599', u'headers': {}}) kwargs:{})\r\n[2018-07-20 13:46:05,343: DEBUG/Beat] beat: Waking up in 11.11 seconds.\r\n[2018-07-20 13:46:05,345: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[574271ce-5f2d-466d-ae66-d63180a9c599] pid:408\r\n2018-07-20 13:46:05,354 DEBUG    awx.main.tasks Last scheduler run was: 2018-07-20 13:45:35.358843+00:00\r\n[2018-07-20 13:46:05,370: INFO/MainProcess] Task awx.main.tasks.awx_periodic_scheduler[574271ce-5f2d-466d-ae66-d63180a9c599] succeeded in 0.026739472989s: None\r\n[2018-07-20 13:46:14,725: INFO/MainProcess] Scaling down -3 processes.\r\n[2018-07-20 13:46:16,462: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\n[2018-07-20 13:46:16,472: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->7bf62211-a828-4cc7-9674-dab72725b4db\r\n[2018-07-20 13:46:16,473: DEBUG/Beat] beat: Waking up in 18.84 seconds.\r\n[2018-07-20 13:46:16,473: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[7bf62211-a828-4cc7-9674-dab72725b4db] expires:[2018-07-20 13:46:36.471718+00:00]\r\n[2018-07-20 13:46:16,474: INFO/MainProcess] Scaling up 1 processes.\r\n[2018-07-20 13:46:16,612: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fca08502320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'7bf62211-a828-4cc7-9674-dab72725b4db', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-07-20T13:46:36.471718+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'7bf62211-a828-4cc7-9674-dab72725b4db', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'f098019c-3780-3d1c-8bf7-425c0287b97a', u'id': u'7bf62211-a828-4cc7-9674-dab72725b4db', u'headers': {}}) kwargs:{})\r\n[2018-07-20 13:46:16,614: DEBUG/MainProcess] basic.qos: prefetch_count->1668\r\n[2018-07-20 13:46:16,626: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[7bf62211-a828-4cc7-9674-dab72725b4db] pid:409\r\n2018-07-20 13:46:16,640 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2018-07-20 13:46:16,652 DEBUG    awx.main.scheduler Starting Scheduler\r\n2018-07-20 13:46:16,657 DEBUG    awx.main.scheduler Failing inconsistent running jobs.\r\n[2018-07-20 13:46:16,672: DEBUG/Worker-186] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@90a651b88f04', u'platform': u'Erlang/OTP 20.1.7', u'version': u'3.7.4'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']\r\n[2018-07-20 13:46:16,674: DEBUG/Worker-186] Open OK!\r\n[2018-07-20 13:46:16,675: DEBUG/Worker-186] using channel_id: 1\r\n[2018-07-20 13:46:16,676: DEBUG/Worker-186] Channel open\r\n[2018-07-20 13:46:16,682: DEBUG/MainProcess] pidbox received method dump_active(safe=False) [reply_to:{u'routing_key': u'4d67ecb2-61fe-382c-8da4-eb711813ac3d', u'exchange': u'reply.celery.pidbox'} ticket:c11a2530-2059-426d-a964-992f10bb84d3]\r\n[2018-07-20 13:46:17,693: DEBUG/Worker-186] Closed channel #1\r\n2018-07-20 13:46:17,773 DEBUG    awx.main.scheduler Skipping group tower, remaining_capacity 0 <= 0\r\n2018-07-20 13:46:17,783 DEBUG    awx.main.scheduler project_update 261 (pending) couldn't be scheduled on graph, waiting for next cycle\r\n[2018-07-20 13:46:17,796: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[7bf62211-a828-4cc7-9674-dab72725b4db] succeeded in 1.17049525108s: None\r\n[2018-07-20 13:46:35,331: INFO/Beat] Scheduler: Sending due task cluster_heartbeat (awx.main.tasks.cluster_node_heartbeat)\r\n[2018-07-20 13:46:35,337: DEBUG/Beat] awx.main.tasks.cluster_node_heartbeat sent. id->c39a5086-03a2-4510-b2a3-5b0ec923e1bf\r\n[2018-07-20 13:46:35,338: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\n[2018-07-20 13:46:35,346: INFO/MainProcess] Received task: awx.main.tasks.cluster_node_heartbeat[c39a5086-03a2-4510-b2a3-5b0ec923e1bf] expires:[2018-07-20 13:47:25.336398+00:00]\r\n[2018-07-20 13:46:35,347: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fca08502320> (args:(u'awx.main.tasks.cluster_node_heartbeat', u'c39a5086-03a2-4510-b2a3-5b0ec923e1bf', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx', u'exchange': u'awx'}, u'expires': u'2018-07-20T13:47:25.336398+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.cluster_node_heartbeat', u'callbacks': None, u'correlation_id': u'c39a5086-03a2-4510-b2a3-5b0ec923e1bf', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'f098019c-3780-3d1c-8bf7-425c0287b97a', u'id': u'c39a5086-03a2-4510-b2a3-5b0ec923e1bf', u'headers': {}}) kwargs:{})\r\n[2018-07-20 13:46:35,347: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->3ee8ba75-0d07-4d89-aa76-4efc4a555e28\r\n[2018-07-20 13:46:35,348: DEBUG/Beat] beat: Waking up in 1.10 seconds.\r\n[2018-07-20 13:46:35,352: DEBUG/MainProcess] Task accepted: awx.main.tasks.cluster_node_heartbeat[c39a5086-03a2-4510-b2a3-5b0ec923e1bf] pid:409\r\n[2018-07-20 13:46:35,352: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[3ee8ba75-0d07-4d89-aa76-4efc4a555e28] expires:[2018-07-20 13:46:55.346448+00:00]\r\n[2018-07-20 13:46:35,353: INFO/MainProcess] Scaling up 1 processes.\r\n2018-07-20 13:46:35,371 DEBUG    awx.main.tasks Cluster node heartbeat task.\r\n[2018-07-20 13:46:35,430: DEBUG/Worker-186] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@90a651b88f04', u'platform': u'Erlang/OTP 20.1.7', u'version': u'3.7.4'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']\r\n[2018-07-20 13:46:35,440: DEBUG/Worker-186] Open OK!\r\n[2018-07-20 13:46:35,447: DEBUG/Worker-186] using channel_id: 1\r\n[2018-07-20 13:46:35,454: DEBUG/Worker-186] Channel open\r\n[2018-07-20 13:46:35,467: DEBUG/Worker-186] Closed channel #1\r\n[2018-07-20 13:46:35,582: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fca08502320> (args:(u'awx.main.tasks.awx_periodic_scheduler', u'3ee8ba75-0d07-4d89-aa76-4efc4a555e28', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-07-20T13:46:55.346448+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.awx_periodic_scheduler', u'callbacks': None, u'correlation_id': u'3ee8ba75-0d07-4d89-aa76-4efc4a555e28', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'f098019c-3780-3d1c-8bf7-425c0287b97a', u'id': u'3ee8ba75-0d07-4d89-aa76-4efc4a555e28', u'headers': {}}) kwargs:{})\r\n[2018-07-20 13:46:35,584: DEBUG/MainProcess] basic.qos: prefetch_count->1672\r\n[2018-07-20 13:46:35,594: INFO/MainProcess] Received task: awx.main.tasks.handle_ha_toplogy_changes[47679162-543f-45af-affa-e08f573b188a]\r\n[2018-07-20 13:46:35,595: INFO/MainProcess] Scaling up 1 processes.\r\n[2018-07-20 13:46:35,758: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fca08502320> (args:(u'awx.main.tasks.handle_ha_toplogy_changes', u'47679162-543f-45af-affa-e08f573b188a', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'tower_broadcast_all'}, u'expires': None, u'hostname': 'celery@awx', u'task': u'awx.main.tasks.handle_ha_toplogy_changes', u'callbacks': None, u'correlation_id': u'47679162-543f-45af-affa-e08f573b188a', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'd97d2b31-cad2-3577-b9eb-ed71d8a836c9', u'id': u'47679162-543f-45af-affa-e08f573b188a', u'headers': {}}) kwargs:{})\r\n[2018-07-20 13:46:35,764: INFO/MainProcess] Task awx.main.tasks.cluster_node_heartbeat[c39a5086-03a2-4510-b2a3-5b0ec923e1bf] succeeded in 0.4162342411s: None\r\n[2018-07-20 13:46:35,765: DEBUG/MainProcess] basic.qos: prefetch_count->1676\r\n[2018-07-20 13:46:35,777: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[3ee8ba75-0d07-4d89-aa76-4efc4a555e28] pid:410\r\n[2018-07-20 13:46:35,782: DEBUG/MainProcess] Task accepted: awx.main.tasks.handle_ha_toplogy_changes[47679162-543f-45af-affa-e08f573b188a] pid:409\r\n2018-07-20 13:46:35,796 DEBUG    awx.main.tasks Reconfigure celeryd queues task on host celery@awx\r\n2018-07-20 13:46:35,798 DEBUG    awx.main.tasks Last scheduler run was: 2018-07-20 13:46:05.353724+00:00\r\n[2018-07-20 13:46:35,826: DEBUG/Worker-186] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@90a651b88f04', u'platform': u'Erlang/OTP 20.1.7', u'version': u'3.7.4'}, mechanisms: [u'PLAIN', u'AMQPLAIN'], locales: [u'en_US']\r\n[2018-07-20 13:46:35,831: INFO/MainProcess] Task awx.main.tasks.awx_periodic_scheduler[3ee8ba75-0d07-4d89-aa76-4efc4a555e28] succeeded in 0.0639290830586s: None\r\n[2018-07-20 13:46:35,847: DEBUG/Worker-186] Open OK!\r\n[2018-07-20 13:46:35,848: DEBUG/Worker-186] using channel_id: 1\r\n[2018-07-20 13:46:35,850: DEBUG/Worker-186] Channel open\r\n[2018-07-20 13:46:35,858: DEBUG/MainProcess] pidbox received method active_queues() [reply_to:{u'routing_key': u'5b81485d-2ac0-33e0-a4b1-47d54c430904', u'exchange': u'reply.celery.pidbox'} ticket:07730e75-83ac-460a-a52c-b1986cec15ca]\r\n[2018-07-20 13:46:35,865: DEBUG/Worker-186] Closed channel #1\r\n[2018-07-20 13:46:35,883: INFO/MainProcess] Task awx.main.tasks.handle_ha_toplogy_changes[47679162-543f-45af-affa-e08f573b188a] succeeded in 0.110052595031s: None\r\n[2018-07-20 13:46:36,462: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\n[2018-07-20 13:46:36,471: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->6cfe1647-40b4-4ff3-b259-b50960b211a3\r\n[2018-07-20 13:46:36,471: DEBUG/Beat] beat: Waking up in 19.99 seconds.\r\n[2018-07-20 13:46:36,472: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[6cfe1647-40b4-4ff3-b259-b50960b211a3] expires:[2018-07-20 13:46:56.469239+00:00]\r\n[2018-07-20 13:46:36,473: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fca08502320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'6cfe1647-40b4-4ff3-b259-b50960b211a3', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-07-20T13:46:56.469239+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'6cfe1647-40b4-4ff3-b259-b50960b211a3', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'f098019c-3780-3d1c-8bf7-425c0287b97a', u'id': u'6cfe1647-40b4-4ff3-b259-b50960b211a3', u'headers': {}}) kwargs:{})\r\n[2018-07-20 13:46:36,478: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[6cfe1647-40b4-4ff3-b259-b50960b211a3] pid:409\r\n2018-07-20 13:46:36,487 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2018-07-20 13:46:36,501 DEBUG    awx.main.scheduler Starting Scheduler\r\n2018-07-20 13:46:36,557 DEBUG    awx.main.scheduler Skipping group tower, remaining_capacity 0 <= 0\r\n2018-07-20 13:46:36,559 DEBUG    awx.main.scheduler project_update 261 (pending) couldn't be scheduled on graph, waiting for next cycle\r\n[2018-07-20 13:46:36,576: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[6cfe1647-40b4-4ff3-b259-b50960b211a3] succeeded in 0.101959561929s: None\r\n[2018-07-20 13:46:56,482: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\n[2018-07-20 13:46:56,488: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->2c34fb52-7313-427b-a64f-9bc58583ec15\r\n[2018-07-20 13:46:56,489: DEBUG/Beat] beat: Waking up in 8.85 seconds.\r\n[2018-07-20 13:46:56,493: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[2c34fb52-7313-427b-a64f-9bc58583ec15] expires:[2018-07-20 13:47:16.487992+00:00]\r\n[2018-07-20 13:46:56,493: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x7fca08502320> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'2c34fb52-7313-427b-a64f-9bc58583ec15', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx_private_queue', u'exchange': u'awx_private_queue'}, u'expires': u'2018-07-20T13:47:16.487992+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'2c34fb52-7313-427b-a64f-9bc58583ec15', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'f098019c-3780-3d1c-8bf7-425c0287b97a', u'id': u'2c34fb52-7313-427b-a64f-9bc58583ec15', u'headers': {}}) kwargs:{})\r\n[2018-07-20 13:46:56,498: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[2c34fb52-7313-427b-a64f-9bc58583ec15] pid:411\r\n2018-07-20 13:46:56,508 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2018-07-20 13:46:56,679 DEBUG    awx.main.scheduler Starting Scheduler\r\n2018-07-20 13:46:56,742 DEBUG    awx.main.scheduler Skipping group tower, remaining_capacity 0 <= 0\r\n2018-07-20 13:46:56,748 DEBUG    awx.main.scheduler project_update 261 (pending) couldn't be scheduled on graph, waiting for next cycle\r\n[2018-07-20 13:46:56,759: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[2c34fb52-7313-427b-a64f-9bc58583ec15] succeeded in 0.265237590065s: None\r\nRESULT 2\r\nOKREADY\r\n``\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nDjango's base class seems to allow for a `timeout` parameter for the email notification class, but AWX doesn't allow making use of it\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSend a notification with incorrect configuration, see how long it takes to get a connection refused error\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSome way to configure timeout\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIt could be system-dependent, but through experimentation I can see a difference between an attempt to send the email notification to when it errors of 12:34:37 to 12:38:21, or around 4 minutes total.\r\n\r\nHypothetically. being a rational actor, and not wanting to swamp my system in the case my flaky email server sometimes dies, I would like the timeout to be shorter.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nOur class:\r\n\r\nhttps://github.com/ansible/awx/blob/devel/awx/main/notifications/email_backend.py\r\n\r\nThe base class of that:\r\n\r\nhttps://github.com/django/django/blob/stable/1.11.x/django/core/mail/backends/smtp.py\r\n\r\nThis allows a `timeout` parameter that users can't make use of... yet.\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen running a job template which launches a project update and the project update is pulling roles down from a requirements.yml file the output in the Tower job reports:\r\n  | 49 | TASK [Write Repository Version] ************************************************ | 16:32:13\r\n  | 50 | changed: [localhost] |  \r\n  | 51 |   |  \r\n  | 52 | PLAY [all] ********************************************************************* | 16:32:13\r\n  | 53 |   |  \r\n  | 54 | TASK [detect requirements.yml] ************************************************* | 16:32:13\r\n  | 55 | skipping: [localhost] |  \r\n  | 56 |   |  \r\n  | 57 | TASK [fetch galaxy roles from requirements.yml] ******************************** | 16:32:13\r\n  | 58 | skipping: [localhost] |  \r\n  | 59 |   |  \r\n  | 60 | TASK [fetch galaxy roles from requirements.yml (forced update)] **************** | 16:32:14\r\n  | 61 | skipping: [localhost] |  \r\n  | 62 |   |  \r\n  | 63 | PLAY RECAP *********************************************************************\r\n\r\nNote the skipping:[localhost].\r\n\r\nHowever, if you check /var/lib/awx/project/_<id>__<project name>/roles/ the roles files will be there.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.3\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.6.1\r\n* Operating System: OS X\r\n* Web Browser: Any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nThe JSON mentioned below will build a project called “GIT Project” and a job template called “GIT Test”. The project will be tied to Default organization tied back to a public GHE repo of mine. The JT will be tied to the GIT Project and Demo Inventory running a playbook called get_ip.yml which just spits out ansible_default_ipv4.address in a debug statement.\r\n\r\nHere is the import command (just make sure you don’t already have a “GIT Project” or “GIT Test” JT):\r\ntower-cli send —tower-host XXXX git_stuff.json \r\nIf you run into any issues be sure you have a github version of tower-cli. \r\n\r\nOnce its imported check out /var/lib/awx/projects/_<ID>__git_project/roles and note that thee is only a requirements.yml file. Now kick off the GIT Test job, this will kick off a full SCM update of GIT Project. It should then create /var/lib/awx/projects/_<ID>__git_projects/roles/yatesr.timezone\r\nNow look at project update job in Tower, scroll down to the bottom. You should see the skipping label.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nIf the steps are truly skipping I would expect that the yatesr.timezone directory would not exist. However, I expect the labels to not say skipping, instead they should correctly report changed or OK.\r\n\r\n##### ACTUAL RESULTS\r\nThe logs indicate that the role steps are skipping.\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nGithub location: https://github.com/john-westcott-iv/ansible-testing\r\nJSON file https://github.com/john-westcott-iv/ansible-testing/blob/master/files/git_stuff.json\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently \"First Name\" and \"Last Name\" fields are limited to max 30 characters. Its possible to have \"first_name\" and \"last_name\" > 30 chars. It should be either increased or at least be configurable to change the max size.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen you run a job through an isolated node which is unreachable, it remains in running status indefinitely.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Install Tower + Isolated node\r\n2. On the Isolated node, add the IP address of the Tower node in the \"/etc/hosts.deny\" file to deny connections.\r\n`sshd: <IP TOWER NODE>`\r\n3. Run a job through the Isolated node.\r\n\r\n##### EXPECTED RESULTS\r\nThe job should fail since the isolated node is unreachable.\r\n\r\n##### ACTUAL RESULTS\r\nThe job remains in running status indefinitely instead of fails.\r\n\r\n##### ADDITIONAL INFORMATION\r\nAttached:\r\n- Screenshot of the job page.\r\n![isolated_job](https://user-images.githubusercontent.com/33290633/42826805-9a614808-89e5-11e8-901e-b66350d27aa4.png)\r\n- Log files (management_playbooks.log, tower.log) and Job API output (job_212.txt).\r\n[management_playbooks.log](https://github.com/ansible/awx/files/2202273/management_playbooks.log)\r\n[tower.log](https://github.com/ansible/awx/files/2202276/tower.log)\r\n[job_212.txt](https://github.com/ansible/awx/files/2202324/job_212.txt)"},{"labels":["api",null,null,null,null,null],"text":"\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe allow users to enter AWS, GCE, etc. credentials into AWX.\r\n\r\nOne of the immediate usecases for these credentials is to create an inventory with a source configured with those credentials.\r\n\r\nWe should automate (ha!) this creation to avoid drudgery.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI have an issue with a job launch template via the API call.\r\nWhen you cURL a json template with survey **list** variable it is ignored.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.11\r\n* AWX install method: docker\r\n* Ansible version:  2.5.3\r\n* Operating System: Ubuntu 16.04 LTS\r\n* Web Browser: Firefox 61.0.1 (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a job template with survey and a multiple selection list.\r\nThen `curl -L -X POST \"http://awx_host/api/v2/job_templates/job_id/launch\" -d @awx-config.json -H \"Content-Type: application/json\" -H \"Authorization: Basic YourAUTH\"`\r\nawx-config.json below\r\n`{\r\n \"extra_vars\": {\r\n  \"list1\": [\r\n   \"item1\",\r\n   \"item2\"\r\n  ],\r\n  \"list2\": [\r\n   \"item3\",\r\n   \"item4\"\r\n  ],\r\n  \"var1\": \"bar1\",\r\n  \"var2\": \"bar2\"\r\n }\r\n}`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nList values should be updated from the json body.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWhen template is running on the role I only get the **var1** and **var2** changed vars.\r\n**List1** and **List2** remain the default values of the survey.\r\n\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n \r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAttempting to log on with a LDAP user simply logs a 401 error. Logging in with a locally defined user works.\r\n\r\n- \"POST /api/login/ HTTP/1.1\" 401 5879 \"https://host.domain.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15\"\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.25\r\n* AWX install method: docker on linux\r\n* Ansible version:  version included in docker container\r\n* Operating System: RHEL7\r\n* Web Browser: Safari\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure LDAP: (obviously changed sensitive information)\r\n\r\n\"AUTH_LDAP_SERVER_URI\": \"ldap://controller.domain.com:389\",\r\n    \"AUTH_LDAP_BIND_DN\": \"CN=awxuser,OU=Users,DC=domain,DC=com\",\r\n    \"AUTH_LDAP_BIND_PASSWORD\": [password],\r\n    \"AUTH_LDAP_START_TLS\": false,\r\n    \"AUTH_LDAP_CONNECTION_OPTIONS\": {\r\n        \"OPT_NETWORK_TIMEOUT\": 30,\r\n        \"OPT_REFERRALS\": 0\r\n    },\r\n    \"AUTH_LDAP_USER_SEARCH\": [\"OU=Users,DC=domain,DC=com\",\"SCOPE_SUBTREE\",\"(cn=%(user)s)\"],\r\n    \"AUTH_LDAP_USER_DN_TEMPLATE\": \"\",\r\n    \"AUTH_LDAP_USER_ATTR_MAP\": {},\r\n    \"AUTH_LDAP_GROUP_SEARCH\": [\"OU=Groups,dc=domain,dc=com\",\"SCOPE_SUBTREE\",\"(objectClass=group)\"],\r\n    \"AUTH_LDAP_GROUP_TYPE\": \"ActiveDirectoryGroupType\",\r\n    \"AUTH_LDAP_GROUP_TYPE_PARAMS\": {},\r\n    \"AUTH_LDAP_REQUIRE_GROUP\": null,\r\n    \"AUTH_LDAP_DENY_GROUP\": null,\r\n    \"AUTH_LDAP_USER_FLAGS_BY_GROUP\": {\"is_superuser\": \"CN=admins,OU=Groups,DC=domain,dc=com\"},\r\n\r\nLogin via UI with LDAP user.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAccess should be granted\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\"POST /api/login/ HTTP/1.1\" 401 5879 \"https://host.domain.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15\"\r\n\r\nUI displays - Invalid username and/or password. Please try again.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null,null],"text":"Add a restrictive Content-Security-Policy (https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP) to awx to drastically reduce the surface area for a wide variety of in-browser security issues.\r\n\r\nThis is **really easy** to do on the backend:\r\n\r\n```python\r\nresponse['Content-Security-Policy'] = \"default-src 'self'; report-uri /csp-violation/\"\r\n```\r\n\r\nIt's _hard_ on the front-end, because we'd need to identify any place we (or third-party libraries) inject inline JS and CSS.\r\n\r\nCurrent roadblocks **may** include:\r\n\r\n* Our version of Angular _itself_ (need to read up on https://code.angularjs.org/1.6.10/docs/api/ng/directive/ngCsp) \r\n* https://github.com/josdejong/mathjs/issues/401 (used by the network UI - it sounds like we're only using one or two small functions from this dependency, so maybe we can just lose it entirely?)\r\n* Anything related to the pendo service?"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nLogs are being sent in plain HTTP when \"LOG_AGGREGATOR_TYPE\": \"logstash\" and \"LOG_AGGREGATOR_PROTOCOL\": \"https\" is chosen.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.0\r\n* AWX install method: docker on linux,\r\n* Ansible version:  2.5.4\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure settings/logging to:\r\n`\r\n\"LOG_AGGREGATOR_TYPE\": \"logstash\"\r\n\"LOG_AGGREGATOR_PROTOCOL\": \"https\"\r\n`\r\n hit Test to send test logs to external aggregator\r\n\r\n##### EXPECTED RESULTS\r\n\r\nData encrypted in TLS \r\n\r\n##### ACTUAL RESULTS\r\n\r\nData sent in plain HTTP\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\ntcpdump pcap file attached\r\n<img width=\"707\" alt=\"awx-ext-agg-log\" src=\"https://user-images.githubusercontent.com/15342111/42371526-0813a960-8110-11e8-83e0-05b1989d6fff.png\">\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAbility to upload IdP metadata and auto-configure SAML providers through the UI/API rather than manual JSON input.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest"},{"labels":["api",null],"text":"Please reopen issue #1559, it is not fixed, it still happens. See comments after closing it, mine is from today."},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n/v2/jobs returns the first page (or all pages) of jobs from oldest to newest. A mechanism to reverse that order so that I could get the most recent page of jobs\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.6.0\r\n* Operating System: Linux\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n/v2/api/jobs\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA mechanism to sort by age descending\r\n\r\n##### ACTUAL RESULTS\r\n\r\nResults always returned oldest first, so have to paginate or request all results\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n ldap search on user_groups currently fetches ALL attributes which is a waste of bandwidth resources and woefully slow on large ldap groups when it only needs to parse the name_attr\r\n\r\nsee uses of attrlist in https://github.com/django-auth-ldap/django-auth-ldap/blob/master/CHANGES\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6\r\n\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n1. Make an awx-command for revoking all OAuth2 tokens.\r\n2. Add an optional `--user` flag to revoke a single user's OAuth2 tokens\r\n3. Make an optional `--revoke_refresh` flag to also revoke the associated refresh token\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n# The following command should revoke all existing OAuth2 Tokens \r\n$ awx-manage revoke_tokens\r\n\r\n# The following command should revoke all OAuth2 Tokens & their refresh tokens\r\n$ awx-manage revoke_tokens --revoke_refresh\r\n\r\n# The following command should revoke all OAuth2 Tokens for the user with id=<pk>. \r\n$ awx-manage revoke_tokens --user=<pk>\r\n\r\n# The following command should revoke all OAuth2 Tokens & refresh token for the user with id=<pk>. \r\n$ awx-manage revoke_tokens --user=<pk> --revoke_refresh\r\n\r\n# <pk-dne> is an user that does not exist.\r\n$ awx-manage revoke_tokens --user=<pk-dne>\r\nCommandError: The user does not exist.\r\n```"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n- Installer\r\n\r\n##### SUMMARY\r\nUnnecessary projects' directories should be removed.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.74\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.2.0\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n- Create a project\r\n- Do SCM update\r\n- Delete the project\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\nThere are no files related to removed project in root directory (`/var/lib/awx/projects`)\r\n\r\n##### ACTUAL RESULTS\r\nThe files still there\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\nThe main problem is extremely fast exhaustion of disk free space when AWX is intensively used and project's repositories are heavy.\r\nThe situation is getting worse when you will try cleanup old files by yourself. It's hard to determine which files in use right now and which free for removing even using AWX API.\r\nProbably we need some indexing of directories to relate it with AWX internal objects and some kind of garbage collector (a management job?) which will purge orphans files. \r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"It would be beneficial to have the ability to rename jobs in AWX.  For something with a long survey, it would be useful to be able to quickly get access to and rerun the job with the same parameters.\r\n\r\nYou can't do this with labels, because you can only add labels at the jt level, not the job (and thus the populated-with-particular-survey-based-extra-vars value can't be different by them)\r\n\r\nThe closest thing you can do is search for the template or the jobs that are `created_by:you` and remember when you last ran the job, which works, but is kind of a finicky flow.\r\n\r\nThere isn't a \"detail\" form-based view for jobs, so this is dependent on some sort of ux concept for inline-editing flow, a rename modal, something else?\r\n\r\nAlso would need to be able to PUT the new job name to the API."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nSome external loggers will intermittently reject some attempts to send log messages. We need a retry logic in order to fully solve this. It might be a simple if the fix is specific to Splunk, otherwise, we may need to utilize our messaging system to process logs.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSetup external logger with Splunk, send job events, run for >100 job events.\r\n\r\nInspect count of job events in Splunk versus Tower over a congruent filter.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCounts are the same\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSplunk is missing some events.\r\n\r\nWe know this to be related to a the error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/lib/python2.7/site-packages/awx/main/utils/handlers.py\", line 63, in _wrapped\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/requests_futures/sessions.py\", line 73, in wrap\r\n    resp = sup(*args_, **kwargs_)\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/requests/sessions.py\", line 475, in request\r\n    resp = self.send(prep, **send_kwargs)\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/requests/sessions.py\", line 596, in send\r\n    r = adapter.send(request, **kwargs)\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/requests/adapters.py\", line 473, in send\r\n    raise ConnectionError(err, request=request)\r\nConnectionError: ('Connection aborted.', error(104, 'Connection reset by peer'))\r\n```\r\n\r\nSince this is only intermittent, it is beyond the scope of external logger to resolve this actual issue (and is believed to be dependent on the Splunk server behavior). However, to fix this practically we need retry logic when sending the log.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf jobs are regularly deleted by the cleanup jobs task, then eventually the numbers will reset, and primary keys will start over at 1.\r\n\r\nThis means that there is no way to filter logs in an external log aggregator for a particular job, because it also picks up logs from jobs which had the same primary key in a prior epoch.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nEnable external logger, job events, have cleanup jobs management job run on frequent schedule, use AWX for a very very long time\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA field that uniquely identifies a single job, and will never conflict with another job.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nno such field exists\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nLogs related to a particular job do not have consistent metadata that would allow grouping them in an external log aggregator\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nEnable external logs for both awx logs & the job events logs\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA way to filter logs in the external log aggregator such that it returns everything related to job with id=3244, for example.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe job events logger has a field `job` which points to the id of the related job, but there is no such thing in AWX logs, even which those logs are obviously exclusively about a particular job. We have many log statements, here is one:\r\n\r\nhttps://github.com/ansible/awx/blob/4f5a0d5a08c6081389088f7aa7c9159bd4ab2a7f/awx/main/tasks.py#L999-L1000\r\n\r\nThe external log aggregator receives logs from all instances in the cluster, so someone would logically like to group logs related to a single job as it's path traversed multiple instances. One instance submits the job to the queue, and another runs it, for example.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nExternal logs for the activity stream show the `changes` field as a parsed JSON string, instead of as a sub-dict\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSet up external logger & send activity stream, view the raw text of the body being sent\r\n\r\n##### EXPECTED RESULTS\r\n\r\nEverything is JSON\r\n\r\n##### ACTUAL RESULTS\r\n\r\nJSON nested inside of JSON. Meaning that the log aggregator must parse the top-level data, and then replace the string in the `changes` field with a dict which came from parsing this value.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen sending job event logs, the field `host` needs to be modified by a custom rule in Splunk if it is to be used. Ordinarily, Splunk uses this field to report what address _it_ received the log from.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSet up external logging with splunk, include job events\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo manual rules needed\r\n\r\n##### ACTUAL RESULTS\r\n\r\nManual rule needed to rename the host field\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nOptions include:\r\n\r\n - rename the key \"host\" to something else\r\n - rename it just for Splunk\r\n - take all of our data and nest it under some other sub-field\r\n - ???\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nUnable to fetch job details on AWX. Getting \r\nERROR! Invalid search term entered. GET returned: -1\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.16\r\n* AWX install method: docker on linux, docker for mac\r\n* Ansible version: 2.3.1.0, 2.4.0.0\r\n* Operating System: Linux, Mac\r\n* Web Browser: Chrome, Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nLaunch any SCM job from UI and click on jobs. API call gets failed and error is shown on UI.\r\n\r\n##### EXPECTED RESULTS\r\nJobs view should work\r\n\r\n##### ACTUAL RESULTS\r\n\r\n![screen shot 2018-06-20 at 3 27 51 pm](https://user-images.githubusercontent.com/16406506/41687902-8a0acef4-749e-11e8-91e0-0f2e5bd8b634.png)\r\n\r\n##### ADDITONAL INFORMATION\r\nPlease find the screen recording. \r\n[jobs_issue.zip](https://github.com/ansible/awx/files/2121336/jobs_issue.zip)"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nPlease allow for all facts for hosts to be sent regardless of whether or not those are newly gathered facts. \r\n##### ENVIRONMENT\r\n* AWX version: Latest\r\n* AWX install method: N/A\r\n* Ansible version: 2.5.4\r\n* Operating System: RHEL 7\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nSmart inventory contains now only hosts, but not their groups. This creates problems for roles that use group names.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.11 \r\n* AWX install method: docker on linux\r\n* Ansible version: 2.5.3 \r\n* Operating System: Ubuntu 18.04 LTS\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - Make an inventory Inv with some number of hosts: Ha, Hb and Hc\r\n - Make a group Gtop\r\n - Make some subgroups Gsub1, Gsub2, ... in Gtop\r\n - Make new smart inventory Smrt with host filter by group Gtop\r\n - Make a job template, and set Smrt as its inventory\r\n - Run this job template\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expected to see groups Gtop, Gsub1, Gsub2 and so on: all the groups from Inv the filtered hosts in the Smrt are members of.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOnly hosts are in the Smrt."},{"labels":["api",null,null],"text":"\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nLOG_AGGREGATOR_LEVEL sets the log level used by external logging integrations.\r\n\r\nThere is no knob that changes the default logging level used by the service itself to syslog/stdout. Ideally, LOG_AGGREGATOR_LEVEL would set both.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nGroup variables are not overwritten after syncing a inventory of type \"Sourced from a Project\".\r\n\r\n##### ENVIRONMENT\r\n* AWX version: N/A\r\n* Ansible version: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a git repository with the following structure:\r\n- hosts.yml:\r\n```\r\nall:\r\n  host:\r\n    host01\r\n    host02\r\n```\r\n- group_vars/all.yml\r\n```\r\nall:\r\n  ansible_user: root\r\n```\r\n\r\n2. In Tower, create a git project pointing to the repository where we have our inventory files.\r\n3. In Tower, create a new inventory of type \"Sourced from a Project\" with the options \"Overwrite\" and \"Update on project change\" enabled.\r\n4. After the first sync, check the \"Details\" tab in the inventory to check the \"Variables\" field. The content should be exactly this:\r\n```\r\nall:\r\n  ansible_user: root\r\n```\r\n5. Back to the git repository, modify the \"group_vars/all.yml\" file removing the \"all:\" and fixing the indent.\r\n```\r\nansible_user: root\r\n```\r\n6. In Tower, sync the project and the inventory again.\r\n8. Go to the Inventory and check the \"Details\" tab, in the \"Variables\" field we can now see the \"ansible_user\" variable has been duplicated.\r\n```\r\nall:\r\n  ansible_user:root\r\nansible_user:root\r\n\r\n```\r\n##### EXPECTED RESULTS\r\nTower should overwrite the variables:\r\n```\r\nansible_user: root\r\n```\r\n\r\n##### ACTUAL RESULTS\r\nTower should not duplicate the variable \"ansible_user: root\":\r\n```\r\nall:\r\n  ansible_user: root\r\nansible_user: root\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nUnable to fetch job details on AWX. Getting \r\nERROR! Invalid search term entered. GET returned: -1\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.16\r\n* AWX install method: docker on linux, docker for mac\r\n* Ansible version: 2.3.1.0\r\n* Operating System: Linux, Mac\r\n* Web Browser: Chrome, Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nLaunch any SCM job from UI and click on jobs. API call gets failed and error is shown on UI.\r\n\r\n##### EXPECTED RESULTS\r\nJobs view should work\r\n\r\n##### ACTUAL RESULTS\r\n![screen shot 2018-06-18 at 11 38 29 am](https://user-images.githubusercontent.com/16406506/41555759-888a5f34-72ed-11e8-9265-8ff77f229d5b.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\nRunning nginx on https on port 443. Please find the nginx conf file.\r\n[nginx.txt](https://github.com/ansible/awx/files/2112589/nginx.txt)\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe have a workflow that passes some credentials (username and password) from Jenkins into Ansible Tower (passing \"extra_var\" via the API) to run a command on the remote systems.  These variables show up in the \"Extra Variables\" section and work fine when they are NOT encrypted with Vault.\r\n\r\nWhen we use Vault to encrypt the variables and provide the appropriate Vault credentials to Tower, the process fails as the vaulted variables are not encrypted.\r\n\r\nAttempting to simulate this in a simple example by pasting in vault encrypted variables results in the Tower GUI reporting \"Error saving job template.  Error: Parse error, failed to parse variables.\"\r\n\r\nSee this RedHat support ticket for details:\r\n    https://access.redhat.com/support/cases/#/case/02119398\r\n\r\nAlso see the attached screen shots showing the in-GUI extra variables setup attempt and error message.\r\n\r\n##### ENVIRONMENT\r\n* Tower version: 3.2.2\r\n* Ansible version:  2.5.2\r\n* Operating System: RHEL 7\r\n* Web Browser: Firefox and Chrome (both currently latest released versions)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a vaulted variable:\r\n    ansible-vault encrypt_string --name 'my_password' 'MySecretPa$$word!'\r\n1. Ensure vault credential is setup with the proper password and added to the template.\r\n1. Copy resulting \"my_password\" lines into the \"Extra Variables\" GUI, or pass it into the extra_vars section of the API call.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n * GUI - \"Extra Variables\" section populated and used during execution.\r\n * API - The extra variables section is used and variables are properly decoded during execution\r\n\r\n##### ACTUAL RESULTS\r\n\r\n * GUI - The GUI reports \"Error saving job template.  Error: Parse error, failed to parse variables.\" and will not save new Extra Variables block.\r\n * API - The variables are passed into API but are not decoded or used by the job.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nScreen shot showing vault password (screen shot \"01\"):\r\n\r\n![01_-_command_line_ansible-vault_output](https://user-images.githubusercontent.com/1124371/41539409-5813f136-72d3-11e8-9dd0-bb803225b35f.png)\r\n\r\nScreen shot showing Tower GUI error message (screen shot \"02\").\r\n\r\n![02_-_job_template_with_extra_variables_and_credentials_and_error](https://user-images.githubusercontent.com/1124371/41539410-583687a0-72d3-11e8-8d7e-fadcf58cde0e.png)\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCurrently, the \"instance_group\" has to be selected manually in the job template forcing to create one for each of the instance groups. It would be useful in the case that someone just wants to use a single job template and a single inventory and needs to set an specify \"instance_group\"  for each of the host groups.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAdd option to run a job template against a copy of the last completed inventory sync and allow job to launch without blocking for an ongoing inventory sync.\r\n\r\n##### ENVIRONMENT\r\n* Tower 3.2.5\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis allows the launch of jobs that do not depend on the latest inventory sync to launch against a complete, earlier version of the inventory, rather than blocking for the completion of the running sync."},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIt should be possible to connect to the database / PostgreSQL using TLS.\r\n\r\n##### ENVIRONMENT\r\nall"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nWhen using settings.py to configure SAML authentication, the `required=True` setting on certain fields causes problems\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6\r\n* AWX install method: minikube\r\n* Ansible version:  2.5.3\r\n* Operating System: OS X\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUsing standard 1.0.6 awx_web, set all the required SAML values:\r\n\r\n```\r\nSOCIAL_AUTH_SAML_SP_ENTITY_ID = 'https://awx.local'\r\nSOCIAL_AUTH_SAML_SP_PUBLIC_CERT = '{{ awx_sso_public_cert|trim }}'\r\nSOCIAL_AUTH_SAML_SP_PRIVATE_KEY = '{{ awx_sso_private_key|trim }}'\r\nSOCIAL_AUTH_SAML_ORG_INFO = {\r\n  \"en-US\": {\r\n    \"url\": \"https://awx.local/\",\r\n    \"displayname\": \"AWX Dev\",\r\n    \"name\": \"awx-dev\"\r\n  }\r\n}\r\nSOCIAL_AUTH_SAML_TECHNICAL_CONTACT = {\r\n  \"givenName\": \"xyz\",\r\n  \"emailAddress\": \"xyz@example.com\"\r\n}\r\nSOCIAL_AUTH_SAML_SUPPORT_CONTACT = {\r\n  \"givenName\": \"xyz\",\r\n  \"emailAddress\": \"xyz@example.com\"\r\n}\r\nSOCIAL_AUTH_SAML_ENABLED_IDPS = {\r\n  \"auth0\": {\r\n    \"entity_id\": \"{{ auth0_entity_id }}\",\r\n    \"url\": \"{{ auth0_url }}\",\r\n    \"x509cert\": \"...\",\r\n    \"attr_user_permanent_id\": \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\",\r\n    \"attr_email\": \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\",\r\n    \"attr_username\": \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn\",\r\n    \"attr_first_name\": \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname\",\r\n    \"attr_last_name\": \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname\",\r\n  }\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWorking SSO with login. Note that the above settings work fine as configured through the web interface.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n2018-06-12 04:17:45,000 ERROR    django.request Internal Server Error: /\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 59, in _legacy_get_response\r\n    if getattr(resolve(request.path), 'url_name', '') == 'migrations_notran':\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/urls/base.py\", line 27, in resolve\r\n    return get_resolver(urlconf).resolve(path)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/urls/resolvers.py\", line 362, in resolve\r\n    for pattern in self.url_patterns:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/functional.py\", line 35, in __get__\r\n    res = instance.__dict__[self.name] = self.func(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/urls/resolvers.py\", line 405, in url_patterns\r\n    patterns = getattr(self.urlconf_module, \"urlpatterns\", self.urlconf_module)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/functional.py\", line 35, in __get__\r\n    res = instance.__dict__[self.name] = self.func(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/urls/resolvers.py\", line 398, in urlconf_module\r\n    return import_module(self.urlconf_name)\r\n  File \"/usr/lib64/python2.7/importlib/__init__.py\", line 37, in import_module\r\n    __import__(name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/urls.py\", line 17, in <module>\r\n    url(r'^sso/', include('social_django.urls', namespace='social')),\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/conf/urls/__init__.py\", line 50, in include\r\n    urlconf_module = import_module(urlconf_module)\r\n  File \"/usr/lib64/python2.7/importlib/__init__.py\", line 37, in import_module\r\n    __import__(name)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/social_django/urls.py\", line 6, in <module>\r\n    from . import views\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/social_django/views.py\", line 10, in <module>\r\n    from .utils import psa\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/social_django/utils.py\", line 13, in <module>\r\n    BACKENDS = settings.AUTHENTICATION_BACKENDS\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 489, in __getattr_without_cache__\r\n    return getattr(self._wrapped, name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 402, in __getattr__\r\n    value = self._get_local(name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 356, in _get_local\r\n    value = field.get_default()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 479, in get_default\r\n    return self.default()\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/fields.py\", line 161, in _default_from_required_settings\r\n    if all([getattr(settings, rs, None) for rs in required_settings]):\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 489, in __getattr_without_cache__\r\n    return getattr(self._wrapped, name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 402, in __getattr__\r\n    value = self._get_local(name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 335, in _get_local\r\n    field = self.registry.get_setting_field(name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/registry.py\", line 143, in get_setting_field\r\n    field_instance = field_class(**field_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 1654, in __init__\r\n    super(DictField, self).__init__(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 320, in __init__\r\n    assert not (read_only and required), NOT_READ_ONLY_REQUIRED\r\n```\r\n##### ADDITIONAL INFORMATION\r\n\r\nWith the following patch, the application works:\r\n\r\n```\r\ndiff --git a/awx/sso/conf.py b/awx/sso/conf.py\r\nindex 75178d6d1..58b9b7ab1 100644\r\n--- a/awx/sso/conf.py\r\n+++ b/awx/sso/conf.py\r\n@@ -1005,7 +1005,6 @@ register(\r\n register(\r\n     'SOCIAL_AUTH_SAML_ORG_INFO',\r\n     field_class=fields.SAMLOrgInfoField,\r\n-    required=True,\r\n     label=_('SAML Service Provider Organization Info'),\r\n     help_text=_('Provide the URL, display name, and the name of your app. Refer to'\r\n                 ' the Ansible Tower documentation for example syntax.'),\r\n@@ -1025,7 +1024,6 @@ register(\r\n     'SOCIAL_AUTH_SAML_TECHNICAL_CONTACT',\r\n     field_class=fields.SAMLContactField,\r\n     allow_blank=True,\r\n-    required=True,\r\n     label=_('SAML Service Provider Technical Contact'),\r\n     help_text=_('Provide the name and email address of the technical contact for'\r\n                 ' your service provider. Refer to the Ansible Tower documentation'\r\n@@ -1043,7 +1041,6 @@ register(\r\n     'SOCIAL_AUTH_SAML_SUPPORT_CONTACT',\r\n     field_class=fields.SAMLContactField,\r\n     allow_blank=True,\r\n-    required=True,\r\n     label=_('SAML Service Provider Support Contact'),\r\n     help_text=_('Provide the name and email address of the support contact for your'\r\n                 ' service provider. Refer to the Ansible Tower documentation for'\r\n```\r\n\r\nI would raise this as a PR, but someone presumably spent effort putting those `required=True` settings in there for a reason!"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAWX is searching for SSH keys in the target machine's root directory, despite being instructed to search in the target user's directory.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.15\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.4\r\n* Operating System: Ubuntu 16.04 LTS\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nFollowed the official installation instructions for AWX on localhost.\r\nCreated a playbook that sends a shell command to the target machine (echo Hello world).\r\nCreated an ssh key-pair and copied public key to target machine.\r\nCreated a project.\r\nCreated a job template that uses this playbook, ssh key-pair, and project.\r\nLaunched the job.\r\n##### EXPECTED RESULTS\r\n\r\nThe target machine will be connected to and echo hello world.\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n`fatal: [106.0.0.3]: UNREACHABLE! => { |  \r\n-- | --\r\n  | 24 | \"changed\": false, |  \r\n  | 25 | \"msg\": \"Failed to connect to the host via ssh: OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \\\"/tmp/awx_1_0zvXaW/cp/b846739242\\\" does not exist\\r\\ndebug2: resolving \\\"106.0.0.3\\\" port 22\\r\\ndebug2: ssh_connect_direct: needpriv 0\\r\\ndebug1: Connecting to 106.0.0.3 [106.0.0.3] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 10000 ms remain after connect\\r\\ndebug1: permanently_set_uid: 0/0\\r\\ndebug1: SELinux support disabled\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_rsa type -1\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\\r\\ndeb…\r\n\r\n`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nMultiple Auth tests are broken due to futures dependency from django-radius update.  \r\n\r\nWe upgraded django-radius from 1.1.0 --> 1.3.3.  In this latest version, Futures v0.16.0 was added and is throwing an error on [this](https://github.com/robgolding/django-radius/blob/7824f978b9a143c642c6d089b4fd1e149b25db97/radiusauth/backends/radius.py#L2) import.  \r\n\r\nThis is throwing an error in our auth tests when they hit the radius backend, which seems to be hit when the LDAP backends are used as well.  \r\n\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX: docker for mac\r\n\r\n##### STEPS TO REPRODUCE\r\nExample test to reproduce:\r\n\r\n```\r\n@pytest.mark.django_db\r\ndef test_ldap_login(admin):\r\n        client = Client()\r\n        auth_url = reverse('api:login')\r\n        client.post(auth_url, {'username': admin.username, 'password': admin.password}, expect=200)\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTest uses 'django.contrib.auth.backends.ModelBackend' and passes.  \r\n\r\n##### ACTUAL RESULTS\r\n\r\nTest fails with traceback below.  \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/views/decorators/debug.py\", line 76, in sensitive_post_parameters_wrapper\r\n    return view(request, *args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 149, in _wrapped_view\r\n    response = view_func(request, *args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/views/decorators/cache.py\", line 57, in _wrapped_view_func\r\n    response = view_func(request, *args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/contrib/auth/views.py\", line 90, in dispatch\r\n    return super(LoginView, self).dispatch(request, *args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 88, in dispatch\r\n    return handler(request, *args, **kwargs)\r\n  File \"/awx_devel/awx/api/generics.py\", line 89, in post\r\n    ret = super(LoggedLoginView, self).post(request, *args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/views/generic/edit.py\", line 182, in post\r\n    if form.is_valid():\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/forms/forms.py\", line 183, in is_valid\r\n    return self.is_bound and not self.errors\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/forms/forms.py\", line 175, in errors\r\n    self.full_clean()\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/forms/forms.py\", line 385, in full_clean\r\n    self._clean_form()\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/forms/forms.py\", line 412, in _clean_form\r\n    cleaned_data = self.clean()\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/contrib/auth/forms.py\", line 187, in clean\r\n    self.user_cache = authenticate(self.request, username=username, password=password)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 68, in authenticate\r\n    for backend, backend_path in _get_backends(return_tuples=True):\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 29, in _get_backends\r\n    backend = load_backend(backend_path)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 23, in load_backend\r\n    return import_string(path)()\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/module_loading.py\", line 20, in import_string\r\n    module = import_module(module_path)\r\n  File \"/usr/lib64/python2.7/importlib/__init__.py\", line 37, in import_module\r\n    __import__(name)\r\n  File \"/venv/awx/lib/python2.7/site-packages/_pytest/assertion/rewrite.py\", line 213, in load_module\r\n    py.builtin.exec_(co, mod.__dict__)\r\n  File \"/venv/awx/lib/python2.7/site-packages/py/_builtin.py\", line 221, in exec_\r\n    exec2(obj, globals, locals)\r\n  File \"<string>\", line 7, in exec2\r\n  File \"/awx_devel/awx/sso/backends.py\", line 23, in <module>\r\n    from radiusauth.backends import RADIUSBackend as BaseRADIUSBackend\r\n  File \"/venv/awx/lib/python2.7/site-packages/radiusauth/backends/__init__.py\", line 1, in <module>\r\n    from radiusauth.backends.radius import RADIUSBackend, RADIUSRealmBackend\r\n  File \"/venv/awx/lib/python2.7/site-packages/_pytest/assertion/rewrite.py\", line 213, in load_module\r\n    py.builtin.exec_(co, mod.__dict__)\r\n  File \"/venv/awx/lib/python2.7/site-packages/py/_builtin.py\", line 221, in exec_\r\n    exec2(obj, globals, locals)\r\n  File \"<string>\", line 7, in exec2\r\n  File \"/venv/awx/lib/python2.7/site-packages/radiusauth/backends/radius.py\", line 2, in <module>\r\n    standard_library.install_aliases()\r\n  File \"/venv/awx/lib/python2.7/site-packages/future/standard_library/__init__.py\", line 460, in install_aliases\r\n    obj = getattr(oldmod, oldobjname)\r\nAttributeError: 'module' object has no attribute 'getoutput'\r\n```\r\n\r\nIt looks like futures repoints modules that have only been _moved_ between python 2 and 3, including `getoutput` from command --> subprocess module. [(here)](https://github.com/PythonCharmers/python-future/blob/fe494df5d66db19af94a1fdc32afe0e2e52dcf66/src/future/standard_library/__init__.py#L193) \r\nhttps://docs.python.org/3/library/subprocess.html#subprocess.getoutput\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nUse Fact Cache in templates throws IOError (see log)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.14\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.4 \r\n* Operating System: CentOS Linux release 7.4.1708 (Core)\r\n* Web Browser: Firefox 60.0.2\r\n* Docker: 18.03.0-ce, build 0520e24\r\n* Python: 2.7.5\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a new template, use Demo Project, tick \"Use Fact Cache\"\r\n\r\n##### EXPECTED RESULTS\r\nHosts with facts\r\n\r\n##### ACTUAL RESULTS\r\nError in job:\r\n`Traceback (most recent call last): File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 905, in run kwargs.setdefault('fact_modification_times', {}) File \"/usr/lib/python2.7/site-packages/awx/main/models/jobs.py\", line 775, in start_job_fact_cache with codecs.open(filepath, 'w', encoding='utf-8') as f: File \"/var/lib/awx/venv/awx/lib64/python2.7/codecs.py\", line 881, in open file = __builtin__.open(filename, mode, buffering) IOError: [Errno 2] No such file or directory: u'/tmp/awx_38_qFe2C8/facts/kcserver01/02' `\r\n\r\n##### ADDITIONAL INFORMATION\r\nRunning the template without \"Use Fact Cache\" works without error.\r\nThis is a fresh install, installed 2018-06-07"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nIf a variable in the \"Extra Variables\" section of a workflow template references another variable through jinja, it is not resolved by the ansible script.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.15\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.4\r\n* Operating System: Centos 7.5\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n1. Create a new workflow template\r\n2. Add a job template that has a ansible script that references a variable Ex: - debug: msg: \"{{ message }}\"\r\n3. Add two variables to extra vars, one that uses the name from step 2 and its value is a reference to another variable, the second variable uses the name that is referenced by the first and has any value. Ex. message: \"{{ reference }}\" and reference: \"value\"\r\n4. Execute workflow\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExtra variables should dereference the jinja variable it is assigned, in the example above, the message on the output should be \"value\" \r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe variable is taken literally and is not dereferenced. In the example above, the output is \"{{ reference }}\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI experimented with getting email notifications to work but never got it working, now when I try to remove the notification template it says `error : Delete not allowed while there are pending notifications`.\r\n\r\nWhen I query the API I can see that a notification is in fact stuck in pending, and has been for three days. This is the output, with some fields redacted:\r\n\r\n```\r\n        {\r\n            \"id\": 8,\r\n            \"type\": \"notification\",\r\n            \"url\": \"/api/v2/notifications/8/\",\r\n            \"related\": {\r\n                \"notification_template\": \"/api/v2/notification_templates/1/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"notification_template\": {\r\n                    \"id\": 1,\r\n                    \"name\": \"*********\",\r\n                    \"description\": \"*********\"\r\n                }\r\n            },\r\n            \"created\": \"2018-06-04T10:11:28.593034Z\",\r\n            \"modified\": \"2018-06-04T10:11:28.593079Z\",\r\n            \"notification_template\": 1,\r\n            \"error\": \"\",\r\n            \"status\": \"pending\",\r\n            \"notifications_sent\": 0,\r\n            \"notification_type\": \"email\",\r\n            \"recipients\": \"[u'********']\",\r\n            \"subject\": \"Tower Notification Test 1 *********\"\r\n        },\r\n```\r\nI have looked around the API in order to find some way to remove the broken notification but couldnt find any.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.12\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.3\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Firefox Quantum 60.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nNo idea, sorry.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nTo be able to remove the notification template.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nThe stuck notification blocks the removal of the template.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.2\r\n* Operating System: CentOS 7\r\n* Web Browser: FireFox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n---\r\n- name: ASA Backup\r\n  hosts: \"{{ host_name }}\"\r\n  gather_facts: no\r\n  vars:\r\n    remote_backup_host:\r\n    remote_backup_dir:\r\n    cli:\r\n      host: \"{{ inventory_hostname }}\"\r\n      username:\r\n      password:\r\n      authorize:\r\n      auth_pass:\r\n\r\n  tasks:\r\n    - name: Retrieve Running-Config\r\n      asa_command:\r\n        commands:\r\n          - more system:running-config\r\n        provider: \"{{ cli }}\"\r\n      register: show_run\r\n\r\n    - name: Copy Running-Config To Server\r\n      copy:\r\n        content: '{{ show_run.stdout[0] }}'\r\n        dest: /{{ remote_backup_dir }}/{{ inventory_hostname }}-{{ lookup('pipe','date +%d-%m-%Y') }}.txt\r\n\r\nRun this via CLI (Works Perfect)\r\nRun this via Tower (Copies contents LOCALLY to AWX Container instead of Ansible Host)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFile is copied to Ansible host directory, as designated in DEST:\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo directory found error appears.\r\nOR\r\nIf I provide it with a valid directory inside of the AWX container, is then successfully gets copied to the AWX container volume.\r\n\r\nHow do I get this to stop trying to use the AWX container volume?\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAs social auth2 for Google or Github have an integration method on WebUI, we need another for OIDC connect to provide a generic solution for auth/authz into AWX.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen sourcing an inventory from an SCM project, empty groups are ignored and not added to the AWX inventory.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.3\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.2\r\n* Operating System: Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate the following Inventory file:\r\n```\r\n[loadbalancers]\r\n\r\n[workers]\r\nlocalhost\r\n```\r\n\r\nUse it as an inventory source.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe AWX Inventory should comprise the groups `workers` and `loadbalancers`.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe `workers` group exists, but `loadbalancers` does not. Templates that expect `groups.loadbalancers` to be at least an empty list produce errors.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n`ansible-inventory` does seem to include empty groups in `--list` output:\r\n```\r\n{\r\n    \"_meta\": {\r\n        \"hostvars\": {\r\n            \"localhost\": {}\r\n        }\r\n    },\r\n    \"all\": {\r\n        \"children\": [\r\n            \"loadbalancers\",\r\n            \"ungrouped\",\r\n            \"workers\"\r\n        ]\r\n    },\r\n    \"loadbalancers\": {},\r\n    \"ungrouped\": {},\r\n    \"workers\": {\r\n        \"hosts\": [\r\n            \"localhost\"\r\n        ]\r\n    }\r\n}\r\n```\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n- API\r\n\r\n##### SUMMARY\r\nWhen defining custom credential type, I'm not able to inject fields as a dictionary, only flat string values seem to be accepted.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.15\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.4\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: chromium\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nNavigate to **CREDENTIAL TYPES -> Create a new credential type** and input following data:\r\n\r\n- name: \"My Custom Credential\"\r\n- input configuration:\r\n\r\n```yaml\r\n---\r\nfields:\r\n  - id: userid\r\n    type: string\r\n    label: Username\r\n  - id: password\r\n    type: string\r\n    label: Password\r\n```\r\n\r\n- injector configuration:\r\n\r\n```yaml\r\n---\r\nextra_vars:\r\n  auth:\r\n    api_username: '{{ userid }}'\r\n    api_password: '{{ password }}'\r\n```\r\n\r\nThen click **SAVE**.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nCredential type should be saved with no problems.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nFollowing error appears:\r\n\r\n```\r\nOrderedDict provided in relative path ['extra_vars', u'auth'], expected string\r\n```\r\n\r\n![capture](https://user-images.githubusercontent.com/8102426/41024247-000379ac-696f-11e8-8dda-5f9265519850.PNG)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nThe result I'm trying to achieve is that when I later use such credentials type, following variable is available to my playbook:\r\n\r\n```yaml\r\n---\r\nauth:\r\n  api_username: myusername\r\n  api_password: mypassword\r\n```\r\n\r\nATM this seems not to be possible and I'm only able to pass flat values like this:\r\n\r\n```yaml\r\n---\r\nauth_api_username: myusername\r\nauth_api_password: mypassword\r\n```\r\n\r\nbut then I need to modify all my playbooks that depend on `auth` variable only because I run them via AWX instead ansible directly...\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAdd Prometheus as a monitoring tool in awx for monitoring application internals.  Prometheus is also set as monitoring within Openshift.\r\nIt can be used to gain insights about:\r\n- any run time statistics like queue length, number of jobs executed, execution lengths of the jobs, etc.\r\n- any instance statistics like number of projects, number of user, number of job_templates\r\n- memory consumption of database, django itself, etc.\r\n- etc. etc..\r\nAll the nice feature a whitebox monitoring would like\r\nThese features should be accessible over a defined REST-Endpoint without any additional server which can be queried by prometheus. Please see examples under https://github.com/prometheus/prometheus/wiki/Default-port-allocations\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nJob Templates creates on vanila installation do not work. Problems with ssh connectivity. \r\nHowever, ad hoc operations on hosts work without any issues. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.14\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.4\r\n* Operating System: Centos\r\n* Web Browser: Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate 1 inventory, with 1 host, 1 machine credentials (with ssh key). \r\n1. Run ad hoc command (which triggers ansible) -> everything works \r\n2. Create job template and run it -> problems with ssh connections \r\n\r\nIn case if ControlMaster=no is set in ansible.conf everything works! \r\n\r\n##### EXPECTED RESULTS\r\n\r\nSystem works without any issues \r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nLogs of ad hoc VS job template execution\r\nhttps://gist.github.com/boris-42/87cdccd6dac08d2f10c810fd9340040b\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nPossible to put job template permissions in state the breaks the RBAC heirachy\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUsing a direct API client, or the API browser:\r\n\r\n - create a project with a null `organization`\r\n - create a job template from this project, give it a null `inventory`\r\n - check the permissions tab of this job template\r\n\r\n##### EXPECTED RESULTS\r\n\r\nObviously the superuser has permission to it...\r\n\r\n##### ACTUAL RESULTS\r\n\r\nempty. The roles for this job template are orphaned from the rest of the system.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRe-filed from issue https://github.com/ansible/tower-cli/issues/530\r\n"},{"labels":["api",null,null,null,null,null],"text":""},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAnsible core accepts YAML that we do not\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n* AWX install method: any\r\n* Ansible version:  2.4-2.7 at least\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAttempt to save this to a job template\r\n\r\n```yaml\r\n---\r\nmy_unsafe_array:\r\n    - !unsafe 'unsafe element'\r\n    - 'safe element'\r\n```\r\n\r\nSee https://docs.ansible.com/ansible/2.4/playbooks_advanced_syntax.html\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFeature request is to accept this, and accept any other syntax that Ansible core documents that it accepts.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nDemo of UI rejection in their parser:\r\n\r\n![screen shot 2018-06-05 at 9 07 05 am](https://user-images.githubusercontent.com/1385596/40977877-260fce36-68a0-11e8-9e82-e4e17841e27d.png)\r\n\r\n![screen shot 2018-06-05 at 9 07 13 am](https://user-images.githubusercontent.com/1385596/40977881-2d2cdd76-68a0-11e8-96a8-b73c0e315883.png)\r\n\r\nDemo of API rejection:\r\n\r\n```json\r\n{\r\n    \"extra_vars\": [\r\n        \"Cannot parse as JSON (error: No JSON object could be decoded) or YAML (error: could not determine a constructor for the tag '!unsafe'\\n  in \\\"<unicode string>\\\", line 1, column 6:\\n    foo: !unsafe 'unsafe element'\\n         ^).\"\r\n    ]\r\n}\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nCurrently any custom include statement in nginx.conf will be overwritten during upgrade. This option would provide a variable for the include path in the inventory file. \r\n\r\nroles/nginx/templates/nginx.conf:\r\n```\r\n{% if extra_nginx_include is defined %}\r\n    include {{ extra_nginx_include }};\r\n    {% endif %}\r\n```\r\nInventory:\r\n```\r\n#cat inventory |grep extra\r\nextra_nginx_include='./conf.d/*'\r\n```\r\n##### ENVIRONMENT\r\n* AWX version: 1.0\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen you try to run a job, the application remains on hold and does not start or finish executing it.\r\nAny ideas? Can anybody help me?\r\n\r\nThank you\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.3\r\n* AWX install method: openshift\r\n* Ansible version:  2.5.3\r\n* Operating System: Ubuntu 16.04.4 LTS\r\n* Web Browser: Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI executed several tasks at once and suddenly stopped doing new tasks.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![awx-1](https://user-images.githubusercontent.com/39795205/40904345-c300516e-67da-11e8-9e01-4a96959396b1.png)\r\n\r\n![awx-2](https://user-images.githubusercontent.com/39795205/40904354-c9212226-67da-11e8-9efb-749af7cd77db.png)\r\n\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nrequirements.yml file is ignored in project\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.5-1\r\n* AWX install method: via RPM\r\n* Ansible version:  2.5.3-1.el7\r\n* Operating System: Red Hat Enterprise Linux Server 7.5\r\n* Web Browser: firefox 52.7.3\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nI used an example: https://github.com/ansible/tower-example (cloned into /var/lib/awx/projects/)\r\nI changed only playbook file (helloworld.yml) to use role defined in requirements.yml file:\r\n\r\n```yaml\r\n---\r\n- name: Hello World!\r\n  hosts: all\r\n \r\n  tasks:\r\n    - name: Hello World!\r\n      shell: echo \"Hi! Tower is working.\"\r\n\r\n  roles:\r\n    - yatesr.timezone\r\n```\r\n\r\nI created in Ansible Tower project with type manual. From that project I created template and ran it as a job and I get this error:\r\n\r\nERROR! the role 'yatesr.timezone' was not found in /var/lib/awx/projects/tower-example/roles:/var/lib/awx/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:/var/lib/awx/projects/tower-example\r\nThe error appears to have been in '/var/lib/awx/projects/tower-example/helloworld.yml': line 11, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\nThe offending line appears to be:\r\n  roles:\r\n    - yatesr.timezone\r\n      ^ here\r\n\r\nbut yatesr.timezone is mentioned in <project_dir>/roles/requirements.yml\r\n\r\n##### EXPECTED RESULTS\r\ndependencies should be installed\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nignored requirement file\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api"],"text":"\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIn a workflow you should be able to define 2 templates to run in parallel and have a 3rd template rely on the previous 2 templates `on success` completion before executing 3rd playbook.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  all\r\n* Operating System: all\r\n* Web Browser: All\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nOpen Workflow and create two nodes that run in parallel, create a third node that should connect to the two previous nodes. You will see you can only choose a single node.\r\n\r\n##### EXPECTED RESULTS\r\nOpen workflow and create two nodes that run in parallel, create a third node that can connect to the two previous plays.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nUnable to do so today.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![workflow](https://user-images.githubusercontent.com/9244813/40767196-b0079134-6466-11e8-8c70-c20f9e9ff7dd.PNG)\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nI have `ansible.cfg` file at the same root directory of the playbook file. With the following content.\r\n\r\n```\r\n[defaults]\r\nhost_key_checking = no\r\nrecord_host_keys = no\r\nssh_args = -o ControlMaster=no -o ControlPersist=30m\r\ncallback_plugins = plugins/callbacks\r\ngather_facts = smart\r\nforks = 1000\r\nprivate_key_file=~/.ssh/id_rsa\r\nremote_user=ec2-user\r\nlog_path=/usr/local/var/log/ansible.log\r\n```\r\nBut the job always pick up `root` as the user, though I could see in the logs that correct ansible.cfg file is picked up\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.9\r\n* AWX install method: docker-compose\r\n* Ansible version: 2.5.3\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nUse the provided `ansible.cfg` file with the hello world sample below\r\n\r\n```\r\n---\r\n - name: Hello World!\r\n   hosts: <ec2 host ip>\r\n  \r\n   tasks:\r\n  \r\n   - name: Hello World!\r\n     shell: echo \"Hi! Tower is working.\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nssh user being overridden by the `remote_user` given in the ansible.cfg file\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nansible use the default `root` user while sshing\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n```\r\nansible-playbook 2.5.3\r\n  config file = /var/lib/awx/projects/_6__dev/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Apr 11 2018, 07:36:10) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\nUsing /var/lib/awx/projects/_6__dev/ansible.cfg as config file\r\nsetting up inventory plugins\r\nParsed /tmp/awx_75_L57Fc4/tmp9nI0cK inventory source with script plugin\r\nLoading callback plugin awx_display of type stdout, v2.0 from /usr/lib/python2.7/site-packages/awx/lib/awx_display_callback/module.pyc\r\n\r\nPLAYBOOK: manager.yml **********************************************************\r\n1 plays in manager.yml\r\n\r\nPLAY [tag_Environment_dev] *****************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\ntask path: /var/lib/awx/projects/_6__dev/manager.yml:1\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/basic.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/__init__.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/namespace.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/ansible_collector.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/default_collectors.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/_text.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/parsing/convert_bool.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/parsing/__init__.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/pycompat24.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/six/__init__.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/compat.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/timeout.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/collector.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/freebsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/openbsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/base.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/dragonfly.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/dragonfly.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/aix.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/aix.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/linux.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/platform.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/hpux.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/user.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/hurd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/other/facter.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/sunos.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/hpux.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/distribution.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/freebsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/__init__.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/openbsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/darwin.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/linux.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/sunos.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/sunos.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/chroot.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/apparmor.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/openbsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/local.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/other/ohai.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/other/__init__.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/service_mgr.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/hurd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/hpux.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/fips.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/selinux.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/__init__.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/pkg_mgr.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/dns.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/base.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/darwin.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/dragonfly.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/ssh_pub_keys.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/__init__.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/__init__.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/lsb.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/date_time.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/netbsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/base.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/cmdline.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/freebsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/netbsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/hardware/netbsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/caps.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/env.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/linux.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/system/python.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/network/generic_bsd.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/virtual/sysctl.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/utils.py\r\nUsing module_utils file /usr/lib/python2.7/site-packages/ansible/module_utils/facts/sysctl.py\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/system/setup.py\r\n<1.2.3.4> ESTABLISH SSH CONNECTION FOR USER: root\r\n<1.2.3.4> SSH: ansible.cfg set ssh_args: (-C)(-o)(ControlMaster=auto)(-o)(ControlPersist=60s)\r\n<1.2.3.4> SSH: ANSIBLE_HOST_KEY_CHECKING/host_key_checking disabled: (-o)(StrictHostKeyChecking=no)\r\n<1.2.3.4> SSH: ansible_password/ansible_ssh_pass not set: (-o)(KbdInteractiveAuthentication=no)(-o)(PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey)(-o)(PasswordAuthentication=no)\r\n<1.2.3.4> SSH: ANSIBLE_REMOTE_USER/remote_user/ansible_user/user/-u set: (-o)(User=root)\r\n<1.2.3.4> SSH: ANSIBLE_TIMEOUT/timeout set: (-o)(ConnectTimeout=10)\r\n<1.2.3.4> SSH: found only ControlPersist; added ControlPath: (-o)(ControlPath=/tmp/awx_75_L57Fc4/cp/aa83cb88fb)\r\n<1.2.3.4> SSH: EXEC ssh -vvv -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=root -o ConnectTimeout=10 -o ControlPath=/tmp/awx_75_L57Fc4/cp/aa83cb88fb 1.2.3.4 '/bin/sh -c '\"'\"'echo ~root && sleep 0'\"'\"''\r\n<1.2.3.4> (255, '', 'OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\\\r\\\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\\\r\\\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\\\r\\\\ndebug1: auto-mux: Trying existing master\\\\r\\\\ndebug1: Control socket \"/tmp/awx_75_L57Fc4/cp/aa83cb88fb\" does not exist\\\\r\\\\ndebug2: resolving \"1.2.3.4\" port 22\\\\r\\\\ndebug2: ssh_connect_direct: needpriv 0\\\\r\\\\ndebug1: Connecting to 1.2.3.4 [1.2.3.4] port 22.\\\\r\\\\ndebug2: fd 3 setting O_NONBLOCK\\\\r\\\\ndebug1: fd 3 clearing O_NONBLOCK\\\\r\\\\ndebug1: Connection established.\\\\r\\\\ndebug3: timeout: 9739 ms remain after connect\\\\r\\\\ndebug1: permanently_set_uid: 0/0\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_rsa type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_dsa type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_ecdsa type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_ed25519 type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\\\\r\\\\ndebug1: Enabling compatibility mode for protocol 2.0\\\\r\\\\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\\\\r\\\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_7.4\\\\r\\\\ndebug1: match: OpenSSH_7.4 pat OpenSSH* compat 0x04000000\\\\r\\\\ndebug2: fd 3 setting O_NONBLOCK\\\\r\\\\ndebug1: Authenticating to 1.2.3.4:22 as \\\\'root\\\\'\\\\r\\\\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\\\\r\\\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\\\\r\\\\ndebug3: load_hostkeys: loaded 1 keys from 1.2.3.4\\\\r\\\\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\\\\r\\\\ndebug3: send packet: type 20\\\\r\\\\ndebug1: SSH2_MSG_KEXINIT sent\\\\r\\\\ndebug3: receive packet: type 20\\\\r\\\\ndebug1: SSH2_MSG_KEXINIT received\\\\r\\\\ndebug2: local client KEXINIT proposal\\\\r\\\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\\\\r\\\\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\\\\r\\\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\\\\r\\\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\\\\r\\\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\\\r\\\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\\\r\\\\ndebug2: compression ctos: zlib@openssh.com,zlib,none\\\\r\\\\ndebug2: compression stoc: zlib@openssh.com,zlib,none\\\\r\\\\ndebug2: languages ctos: \\\\r\\\\ndebug2: languages stoc: \\\\r\\\\ndebug2: first_kex_follows 0 \\\\r\\\\ndebug2: reserved 0 \\\\r\\\\ndebug2: peer server KEXINIT proposal\\\\r\\\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\\\\r\\\\ndebug2: host key algorithms: ssh-rsa,rsa-sha2-512,rsa-sha2-256,ecdsa-sha2-nistp256,ssh-ed25519\\\\r\\\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc,blowfish-cbc,cast128-cbc,3des-cbc\\\\r\\\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc,blowfish-cbc,cast128-cbc,3des-cbc\\\\r\\\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\\\r\\\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\\\r\\\\ndebug2: compression ctos: none,zlib@openssh.com\\\\r\\\\ndebug2: compression stoc: none,zlib@openssh.com\\\\r\\\\ndebug2: languages ctos: \\\\r\\\\ndebug2: languages stoc: \\\\r\\\\ndebug2: first_kex_follows 0 \\\\r\\\\ndebug2: reserved 0 \\\\r\\\\ndebug1: kex: algorithm: curve25519-sha256\\\\r\\\\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\\\\r\\\\ndebug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\\\r\\\\ndebug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\\\r\\\\ndebug1: kex: curve25519-sha256 need=64 dh_need=64\\\\r\\\\ndebug1: kex: curve25519-sha256 need=64 dh_need=64\\\\r\\\\ndebug3: send packet: type 30\\\\r\\\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\\\r\\\\ndebug3: receive packet: type 31\\\\r\\\\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:+4nIiFbBApTK2KigjM+qOESf6OP/JtjZ3qBo/4JqQmw\\\\r\\\\ndebug3: hostkeys_foreach: reading file \"/root/.ssh/known_hosts\"\\\\r\\\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\\\\r\\\\ndebug3: load_hostkeys: loaded 1 keys from 1.26.37.6\\\\r\\\\ndebug1: Host \\\\'1.2.3.4\\\\' is known and matches the ECDSA host key.\\\\r\\\\ndebug1: Found key in /root/.ssh/known_hosts:1\\\\r\\\\ndebug3: send packet: type 21\\\\r\\\\ndebug2: set_newkeys: mode 1\\\\r\\\\ndebug1: rekey after 134217728 blocks\\\\r\\\\ndebug1: SSH2_MSG_NEWKEYS sent\\\\r\\\\ndebug1: expecting SSH2_MSG_NEWKEYS\\\\r\\\\ndebug3: receive packet: type 21\\\\r\\\\ndebug1: SSH2_MSG_NEWKEYS received\\\\r\\\\ndebug2: set_newkeys: mode 0\\\\r\\\\ndebug1: rekey after 134217728 blocks\\\\r\\\\ndebug2: key: /root/.ssh/id_rsa ((nil))\\\\r\\\\ndebug2: key: /root/.ssh/id_dsa ((nil))\\\\r\\\\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\\\\r\\\\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\\\\r\\\\ndebug3: send packet: type 5\\\\r\\\\ndebug3: receive packet: type 7\\\\r\\\\ndebug1: SSH2_MSG_EXT_INFO received\\\\r\\\\ndebug1: kex_input_ext_info: server-sig-algs=<rsa-sha2-256,rsa-sha2-512>\\\\r\\\\ndebug3: receive packet: type 6\\\\r\\\\ndebug2: service_accept: ssh-userauth\\\\r\\\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\\\r\\\\ndebug3: send packet: type 50\\\\r\\\\ndebug3: receive packet: type 51\\\\r\\\\ndebug1: Authentications that can continue: publickey\\\\r\\\\ndebug3: start over, passed a different list publickey\\\\r\\\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\\\r\\\\ndebug3: authmethod_lookup publickey\\\\r\\\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\\\r\\\\ndebug3: authmethod_is_enabled publickey\\\\r\\\\ndebug1: Next authentication method: publickey\\\\r\\\\ndebug1: Trying private key: /root/.ssh/id_rsa\\\\r\\\\ndebug3: sign_and_send_pubkey: RSA SHA256:jVAoBN0MenDTTfJk68WQYald8VPwhFsAa2eicpCY3hc\\\\r\\\\ndebug3: send packet: type 50\\\\r\\\\ndebug2: we sent a publickey packet, wait for reply\\\\r\\\\ndebug3: receive packet: type 51\\\\r\\\\ndebug1: Authentications that can continue: publickey\\\\r\\\\ndebug1: Trying private key: /root/.ssh/id_dsa\\\\r\\\\ndebug3: no such identity: /root/.ssh/id_dsa: No such file or directory\\\\r\\\\ndebug1: Trying private key: /root/.ssh/id_ecdsa\\\\r\\\\ndebug3: no such identity: /root/.ssh/id_ecdsa: No such file or directory\\\\r\\\\ndebug1: Trying private key: /root/.ssh/id_ed25519\\\\r\\\\ndebug3: no such identity: /root/.ssh/id_ed25519: No such file or directory\\\\r\\\\ndebug2: we did not send a packet, disable method\\\\r\\\\ndebug1: No more authentication methods to try.\\\\r\\\\nPermission denied (publickey).\\\\r\\\\n')\r\nfatal: [1.2.3.4]: UNREACHABLE! => {\r\n    \"changed\": false, \r\n    \"msg\": \"Failed to connect to the host via ssh: OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\\\r\\\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\\\r\\\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\\\r\\\\ndebug1: auto-mux: Trying existing master\\\\r\\\\ndebug1: Control socket \\\\\"/tmp/awx_75_L57Fc4/cp/aa83cb88fb\\\\\" does not exist\\\\r\\\\ndebug2: resolving \\\\\"1.2.3.4\\\\\" port 22\\\\r\\\\ndebug2: ssh_connect_direct: needpriv 0\\\\r\\\\ndebug1: Connecting to 1.2.3.4 [1.2.3.4] port 22.\\\\r\\\\ndebug2: fd 3 setting O_NONBLOCK\\\\r\\\\ndebug1: fd 3 clearing O_NONBLOCK\\\\r\\\\ndebug1: Connection established.\\\\r\\\\ndebug3: timeout: 9739 ms remain after connect\\\\r\\\\ndebug1: permanently_set_uid: 0/0\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_rsa type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_rsa-cert type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_dsa type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_dsa-cert type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_ecdsa type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_ecdsa-cert type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_ed25519 type -1\\\\r\\\\ndebug1: key_load_public: No such file or directory\\\\r\\\\ndebug1: identity file /root/.ssh/id_ed25519-cert type -1\\\\r\\\\ndebug1: Enabling compatibility mode for protocol 2.0\\\\r\\\\ndebug1: Local version string SSH-2.0-OpenSSH_7.4\\\\r\\\\ndebug1: Remote protocol version 2.0, remote software version OpenSSH_7.4\\\\r\\\\ndebug1: match: OpenSSH_7.4 pat OpenSSH* compat 0x04000000\\\\r\\\\ndebug2: fd 3 setting O_NONBLOCK\\\\r\\\\ndebug1: Authenticating to 1.2.3.4:22 as 'root'\\\\r\\\\ndebug3: hostkeys_foreach: reading file \\\\\"/root/.ssh/known_hosts\\\\\"\\\\r\\\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\\\\r\\\\ndebug3: load_hostkeys: loaded 1 keys from 1.2.3.4\\\\r\\\\ndebug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521\\\\r\\\\ndebug3: send packet: type 20\\\\r\\\\ndebug1: SSH2_MSG_KEXINIT sent\\\\r\\\\ndebug3: receive packet: type 20\\\\r\\\\ndebug1: SSH2_MSG_KEXINIT received\\\\r\\\\ndebug2: local client KEXINIT proposal\\\\r\\\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1,ext-info-c\\\\r\\\\ndebug2: host key algorithms: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-dss-cert-v01@openssh.com,ssh-ed25519,rsa-sha2-512,rsa-sha2-256,ssh-rsa,ssh-dss\\\\r\\\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\\\\r\\\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc\\\\r\\\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\\\r\\\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\\\r\\\\ndebug2: compression ctos: zlib@openssh.com,zlib,none\\\\r\\\\ndebug2: compression stoc: zlib@openssh.com,zlib,none\\\\r\\\\ndebug2: languages ctos: \\\\r\\\\ndebug2: languages stoc: \\\\r\\\\ndebug2: first_kex_follows 0 \\\\r\\\\ndebug2: reserved 0 \\\\r\\\\ndebug2: peer server KEXINIT proposal\\\\r\\\\ndebug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\\\\r\\\\ndebug2: host key algorithms: ssh-rsa,rsa-sha2-512,rsa-sha2-256,ecdsa-sha2-nistp256,ssh-ed25519\\\\r\\\\ndebug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc,blowfish-cbc,cast128-cbc,3des-cbc\\\\r\\\\ndebug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,aes128-cbc,aes192-cbc,aes256-cbc,blowfish-cbc,cast128-cbc,3des-cbc\\\\r\\\\ndebug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\\\r\\\\ndebug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\\\\r\\\\ndebug2: compression ctos: none,zlib@openssh.com\\\\r\\\\ndebug2: compression stoc: none,zlib@openssh.com\\\\r\\\\ndebug2: languages ctos: \\\\r\\\\ndebug2: languages stoc: \\\\r\\\\ndebug2: first_kex_follows 0 \\\\r\\\\ndebug2: reserved 0 \\\\r\\\\ndebug1: kex: algorithm: curve25519-sha256\\\\r\\\\ndebug1: kex: host key algorithm: ecdsa-sha2-nistp256\\\\r\\\\ndebug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\\\r\\\\ndebug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: zlib@openssh.com\\\\r\\\\ndebug1: kex: curve25519-sha256 need=64 dh_need=64\\\\r\\\\ndebug1: kex: curve25519-sha256 need=64 dh_need=64\\\\r\\\\ndebug3: send packet: type 30\\\\r\\\\ndebug1: expecting SSH2_MSG_KEX_ECDH_REPLY\\\\r\\\\ndebug3: receive packet: type 31\\\\r\\\\ndebug1: Server host key: ecdsa-sha2-nistp256 SHA256:+4nIiFbBApTK2KigjM+qOESf6OP/JtjZ3qBo/4JqQmw\\\\r\\\\ndebug3: hostkeys_foreach: reading file \\\\\"/root/.ssh/known_hosts\\\\\"\\\\r\\\\ndebug3: record_hostkey: found key type ECDSA in file /root/.ssh/known_hosts:1\\\\r\\\\ndebug3: load_hostkeys: loaded 1 keys from 1.2.3.4\\\\r\\\\ndebug1: Host '1.2.3.4' is known and matches the ECDSA host key.\\\\r\\\\ndebug1: Found key in /root/.ssh/known_hosts:1\\\\r\\\\ndebug3: send packet: type 21\\\\r\\\\ndebug2: set_newkeys: mode 1\\\\r\\\\ndebug1: rekey after 134217728 blocks\\\\r\\\\ndebug1: SSH2_MSG_NEWKEYS sent\\\\r\\\\ndebug1: expecting SSH2_MSG_NEWKEYS\\\\r\\\\ndebug3: receive packet: type 21\\\\r\\\\ndebug1: SSH2_MSG_NEWKEYS received\\\\r\\\\ndebug2: set_newkeys: mode 0\\\\r\\\\ndebug1: rekey after 134217728 blocks\\\\r\\\\ndebug2: key: /root/.ssh/id_rsa ((nil))\\\\r\\\\ndebug2: key: /root/.ssh/id_dsa ((nil))\\\\r\\\\ndebug2: key: /root/.ssh/id_ecdsa ((nil))\\\\r\\\\ndebug2: key: /root/.ssh/id_ed25519 ((nil))\\\\r\\\\ndebug3: send packet: type 5\\\\r\\\\ndebug3: receive packet: type 7\\\\r\\\\ndebug1: SSH2_MSG_EXT_INFO received\\\\r\\\\ndebug1: kex_input_ext_info: server-sig-algs=<rsa-sha2-256,rsa-sha2-512>\\\\r\\\\ndebug3: receive packet: type 6\\\\r\\\\ndebug2: service_accept: ssh-userauth\\\\r\\\\ndebug1: SSH2_MSG_SERVICE_ACCEPT received\\\\r\\\\ndebug3: send packet: type 50\\\\r\\\\ndebug3: receive packet: type 51\\\\r\\\\ndebug1: Authentications that can continue: publickey\\\\r\\\\ndebug3: start over, passed a different list publickey\\\\r\\\\ndebug3: preferred gssapi-with-mic,gssapi-keyex,hostbased,publickey\\\\r\\\\ndebug3: authmethod_lookup publickey\\\\r\\\\ndebug3: remaining preferred: ,gssapi-keyex,hostbased,publickey\\\\r\\\\ndebug3: authmethod_is_enabled publickey\\\\r\\\\ndebug1: Next authentication method: publickey\\\\r\\\\ndebug1: Trying private key: /root/.ssh/id_rsa\\\\r\\\\ndebug3: sign_and_send_pubkey: RSA SHA256:jVAoBN0MenDTTfJk68WQYald8VPwhFsAa2eicpCY3hc\\\\r\\\\ndebug3: send packet: type 50\\\\r\\\\ndebug2: we sent a publickey packet, wait for reply\\\\r\\\\ndebug3: receive packet: type 51\\\\r\\\\ndebug1: Authentications that can continue: publickey\\\\r\\\\ndebug1: Trying private key: /root/.ssh/id_dsa\\\\r\\\\ndebug3: no such identity: /root/.ssh/id_dsa: No such file or directory\\\\r\\\\ndebug1: Trying private key: /root/.ssh/id_ecdsa\\\\r\\\\ndebug3: no such identity: /root/.ssh/id_ecdsa: No such file or directory\\\\r\\\\ndebug1: Trying private key: /root/.ssh/id_ed25519\\\\r\\\\ndebug3: no such identity: /root/.ssh/id_ed25519: No such file or directory\\\\r\\\\ndebug2: we did not send a packet, disable method\\\\r\\\\ndebug1: No more authentication methods to try.\\\\r\\\\nPermission denied (publickey).\\\\r\\\\n\", \r\n    \"unreachable\": true\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\n1.2.3.4              : ok=0    changed=0    unreachable=1    failed=0   \r\n\r\n```"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAllow both an inventory and/or project sync on launch to be an option **in the job template**.\r\n\r\nOur use case is that our inventory is dynamically sourced from Red Hat Satellite. During the deployment of a new server, a provisioning callback is done to configure the new server. However, the new server is not yet added to the inventory. Currently the inventory settings have it set to \"update on launch\" which is not ideal as the large inventory takes a long time to process for every Job Template that is ran. The inventory only needs to be updated during a few select Jobs.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6\r\n* AWX install method: DockerHub\r\n* Ansible version:  2.5.3\r\n* Operating System: RHEL 7.5\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a new Job Template. There is no option in there to update an inventory and/or project whenever this Job is ran.\r\n\r\n##### EXPECTED RESULTS\r\nThere should be an option in the Job Template to update the inventory and/or project. This way it will update the relevant source of truth only for the Job Templates that have those options checked/enabled.\r\n\r\n##### ACTUAL RESULTS\r\nInventories and projects can only have their settings changed to *always* update on launch or *never* update on launch. There is no way to do this on a per-Job Template basis.\r\n\r\n##### ADDITIONAL INFORMATION\r\nRelated RBAC settings are also something to keep in mind.\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nThere are \"no default ordering warnings\" on our functional tests that were introduced when we upgraded to Django 1.11.11.  \r\n\r\n##### Possible Solutions\r\nOption A: add an `ordered_by` in all of the get_queryset() and filtered_querysets() functions that are acting up in views.py.  \r\nOption B: Make this change by adding ordering to the Meta class on the model.  \r\nmaybe we can find a sneaky metaclassed way to default to something like `order_by = ['id']`\r\nOption C: Inherit from a common model that is `order_by = ['id']`.  It looks like this is already done for all models that use BaseModel, and is only an issue for custom models.  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun our functional tests.  \r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo warning messages\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWarning messages that our serializers are not ordered.  \r\n\r\n##### ADDITIONAL INFORMATION\r\nIt looks like this is already done for all models that use BaseModel, and is only an issue for custom models.  \r\n\r\nTraceback:\r\n\r\n\r\n```\r\n============================= warnings summary ===============================\r\nawx/main/tests/functional/api/test_oauth.py::test_oauth_token_create\r\n  /venv/awx/lib/python2.7/site-packages/rest_framework/pagination.py:208: UnorderedObjectListWarning: Pagination may yield inconsistent results with an unordered object_list: <class 'awx.main.models.oauth.OAuth2AccessToken'> QuerySet.\r\n    paginator = self.django_paginator_class(queryset, page_size)\r\n\r\n-- Docs: http://doc.pytest.org/en/latest/warnings.html\r\n```"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nInstalled AWX on rhel 7.5, configured 570 hosts and tried to test using ping module and the tower freezes for a while\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.6.8 \r\n* AWX install method: docker on linux\r\n* Ansible version: Ansible 2.5.3\r\n* Operating System: rhel 7.5\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nI have installed awx ansible on rhel 7.5, configures 570 hosts and tried to use ping module on awx tower, it freezes for a while. i wanted to see the cpu usagae of the server. i have found that the container is using 1 cpu \"25%\" usage. what changes should be made so that the tower uses 2 cpu's?\r\nThe server is configured with 2 cpu, 4 cores.\r\n\r\n\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nUsing the methods described here: [https://github.com/ansible/awx/blob/devel/docs/auth/oauth.md](url) I am unable to revoke a personal token.  I am also unable to change the expiry time from 1000 years to something reasonable in the UI.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.5\r\n* AWX install method: docker \r\n* Ansible version:  2.5.2(awx) 2.4.1.0 (my laptop)\r\n* Operating System: RHEL Atomic 7.5\r\n* Web Browser: Ansible URI, Curl, Chrome 66.0.3359.181 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nCreated a token using tower-cli\r\n\r\n```\r\n$ tower-cli login admin -v\r\nPassword:\r\n\r\nPOST https://cvawxd03.symprod.com:8443/api/v2/users/admin/personal_tokens/\r\nData: {'application': None, 'description': 'Tower CLI', 'scope': 'write'}\r\n\r\n{\r\n \"id\": 7,\r\n \"type\": \"o_auth2_access_token\",\r\n \"url\": \"/api/v2/tokens/7/\",\r\n \"created\": \"2018-05-29T12:42:48.086056Z\",\r\n \"modified\": \"2018-05-29T12:42:48.297897Z\",\r\n \"description\": \"Tower CLI\",\r\n \"user\": 1,\r\n \"refresh_token\": null,\r\n \"application\": null,\r\n \"expires\": \"3017-09-29T12:42:48.084732Z\",\r\n \"scope\": \"write\",\r\n \"token\": \"73HNeV53E6p2oYMMAogRn9TIKt92Cf\"\r\n}\r\n\r\n```\r\n\r\n\r\n```\r\n$ curl -X POST -d \"token=73HNeV53E6p2oYMMAogRn9TIKt92Cf\" -H \"Authorization: Bearer 73HNeV53E6p2oYMMAogRn9TIKt92Cf\" https://awx:8443/api/o/revoke_token/ -ik\r\nHTTP/1.1 401 Unauthorized\r\nServer: nginx/1.13.12\r\nDate: Wed, 30 May 2018 11:34:01 GMT\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 27\r\nConnection: keep-alive\r\nVary: Accept-Language, Cookie\r\nX-API-Total-Time: 0.008s\r\nContent-Language: en\r\n\r\n{\"error\": \"invalid_client\"}\r\n```\r\n\r\n```\r\n$ curl -X POST -d \"token=73HNeV53E6p2oYMMAogRn9TIKt92Cf\"   -u \"admin:redacted\" https://awx:8443/api/o/revoke_token/ -ik\r\nHTTP/1.1 401 Unauthorized\r\nServer: nginx/1.13.12\r\nDate: Wed, 30 May 2018 11:35:56 GMT\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 27\r\nConnection: keep-alive\r\nVary: Accept-Language, Cookie\r\nX-API-Total-Time: 0.007s\r\nContent-Language: en\r\n\r\n{\"error\": \"invalid_client\"}\r\n```\r\n\r\n\r\n```\r\n---\r\n- name: oauth2 test\r\n  hosts: localhost\r\n  connection: local\r\n  gather_facts: no\r\n\r\n  tasks:\r\n    - name: get auth token from awx\r\n      uri:\r\n        url: https://{{ awxPortal }}/api/v2/users/{{ awxUser }}/personal_tokens/\r\n        method: POST\r\n        force_basic_auth: yes\r\n        validate_certs: no\r\n        status_code: 201\r\n        body_type: json\r\n        body_format: json\r\n        user: \"{{ awxUser | default('admin') }}\"\r\n        password: \"{{ awxPassword | default('redacted') }}\"\r\n        body:\r\n          # application: \"None\"\r\n          description: \"Tower CLI\"\r\n          scope: \"write\"\r\n      register: restLogin\r\n    - name: revoke token from awx\r\n      uri:\r\n        url: https://{{ awxPortal }}/api/o/revoke_token/\r\n        method: POST\r\n        header:\r\n          Authorization: \"Bearer {{ restLogin.json.token }}\"\r\n        validate_certs: no\r\n        status_code: 200\r\n        body_type: json\r\n        body_format: json\r\n        body:\r\n          token: \"{{ restLogin.json.token }}\"\r\n```\r\n```\r\n$ ansible-playbook -i inventory/dev-inventory.yml test.yml -vvv\r\nansible-playbook 2.4.1.0\r\n  config file = None\r\n  configured module search path = [u'/home/devuser/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.14 (default, Oct 31 2017, 21:12:13) [GCC 6.4.0]\r\nNo config file found; using defaults\r\nParsed /home/devuser/awx-deployment-orchestration/inventory/dev-inventory.yml inventory source with yaml plugin\r\n\r\nPLAYBOOK: test.yml ******************************************************************************************************************************************************************\r\n1 plays in test.yml\r\n\r\nPLAY [test] **************************************************************************************************************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [get auth token from awx] ***********************************************************************************************************************************************************************************\r\ntask path: /home/devuser/awx-deployment-orchestration/test.yml:9\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/net_tools/basics/uri.py\r\n<localhost> ESTABLISH LOCAL CONNECTION FOR USER: devuser\r\n<localhost> EXEC /bin/sh -c 'echo ~ && sleep 0'\r\n<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/devuser/.ansible/tmp/ansible-tmp-1527695490.59-148529499835490 `\" && echo ansible-tmp-1527695490.59-148529499835490=\"` echo /home/devuser/.ansible/tmp/ansible-tmp-1527695490.59-148529499835490 `\" ) && sleep 0'\r\n<localhost> PUT /tmp/tmp0PsPay TO /home/devuser/.ansible/tmp/ansible-tmp-1527695490.59-148529499835490/uri.py\r\n<localhost> EXEC /bin/sh -c 'chmod u+x /home/devuser/.ansible/tmp/ansible-tmp-1527695490.59-148529499835490/ /home/devuser/.ansible/tmp/ansible-tmp-1527695490.59-148529499835490/uri.py && sleep 0'\r\n<localhost> EXEC /bin/sh -c '/usr/bin/python /home/devuser/.ansible/tmp/ansible-tmp-1527695490.59-148529499835490/uri.py; rm -rf \"/home/devuser/.ansible/tmp/ansible-tmp-1527695490.59-148529499835490/\" > /dev/null 2>&1 && sleep 0'\r\nok: [localhost] => {\r\n    \"access_control_allow_origin\": \"*\",\r\n    \"allow\": \"GET, POST, HEAD, OPTIONS\",\r\n    \"changed\": false,\r\n    \"connection\": \"close\",\r\n    \"content_language\": \"en\",\r\n    \"content_length\": \"497\",\r\n    \"content_type\": \"application/json\",\r\n    \"cookies\": {},\r\n    \"date\": \"Wed, 30 May 2018 11:50:33 GMT\",\r\n    \"failed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backup\": null,\r\n            \"body\": {\r\n                \"description\": \"Tower CLI\",\r\n                \"scope\": \"write\"\r\n            },\r\n            \"body_format\": \"json\",\r\n            \"body_type\": \"json\",\r\n            \"client_cert\": null,\r\n            \"client_key\": null,\r\n            \"content\": null,\r\n            \"creates\": null,\r\n            \"delimiter\": null,\r\n            \"dest\": null,\r\n            \"directory_mode\": null,\r\n            \"follow\": false,\r\n            \"follow_redirects\": \"safe\",\r\n            \"force\": false,\r\n            \"force_basic_auth\": true,\r\n            \"group\": null,\r\n            \"headers\": {\r\n                \"Authorization\": \"Basic redacted\",\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            \"http_agent\": \"ansible-httpget\",\r\n            \"method\": \"POST\",\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"password\": \"VALUE_SPECIFIED_IN_NO_LOG_PARAMETER\",\r\n            \"regexp\": null,\r\n            \"remote_src\": null,\r\n            \"removes\": null,\r\n            \"return_content\": false,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": null,\r\n            \"status_code\": [\r\n                \"201\"\r\n            ],\r\n            \"timeout\": 30,\r\n            \"unsafe_writes\": null,\r\n            \"url\": \"https://awxserver:8443/api/v2/users/admin/personal_tokens/\",\r\n            \"url_password\": \"VALUE_SPECIFIED_IN_NO_LOG_PARAMETER\",\r\n            \"url_username\": \"admin\",\r\n            \"use_proxy\": true,\r\n            \"user\": \"admin\",\r\n            \"validate_certs\": false\r\n        }\r\n    },\r\n    \"json\": {\r\n        \"application\": null,\r\n        \"created\": \"2018-05-30T11:50:33.420737Z\",\r\n        \"description\": \"Tower CLI\",\r\n        \"expires\": \"3017-09-30T11:50:33.420074Z\",\r\n        \"id\": 24,\r\n        \"modified\": \"2018-05-30T11:50:33.433755Z\",\r\n        \"refresh_token\": null,\r\n        \"related\": {\r\n            \"activity_stream\": \"/api/v2/tokens/24/activity_stream/\",\r\n            \"user\": \"/api/v2/users/1/\"\r\n        },\r\n        \"scope\": \"write\",\r\n        \"summary_fields\": {\r\n            \"user\": {\r\n                \"first_name\": \"\",\r\n                \"id\": 1,\r\n                \"last_name\": \"\",\r\n                \"username\": \"admin\"\r\n            }\r\n        },\r\n        \"token\": \"i91ofHrQdOiNaN4HtLyF5D2zwX0dSg\",\r\n        \"type\": \"o_auth2_access_token\",\r\n        \"url\": \"/api/v2/tokens/24/\",\r\n        \"user\": 1\r\n    },\r\n    \"location\": \"https://awxserver:8443/api/v2/tokens/24/\",\r\n    \"msg\": \"OK (497 bytes)\",\r\n    \"redirected\": false,\r\n    \"server\": \"nginx/1.13.12\",\r\n    \"status\": 201,\r\n    \"strict_transport_security\": \"max-age=15768000\",\r\n    \"url\": \"https://awxserver:8443/api/v2/users/admin/personal_tokens/\",\r\n    \"vary\": \"Accept, Accept-Language, Cookie\",\r\n    \"x_api_node\": \"awx\",\r\n    \"x_api_time\": \"0.088s\",\r\n    \"x_api_total_time\": \"0.100s\"\r\n}\r\n\r\nTASK [revoke token from awx] *************************************************************************************************************************************************************************************\r\ntask path: /home/devuser/awx-deployment-orchestration/test.yml:25\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/net_tools/basics/uri.py\r\n<localhost> ESTABLISH LOCAL CONNECTION FOR USER: devuser\r\n<localhost> EXEC /bin/sh -c 'echo ~ && sleep 0'\r\n<localhost> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /home/devuser/.ansible/tmp/ansible-tmp-1527695492.58-123221534948391 `\" && echo ansible-tmp-1527695492.58-123221534948391=\"` echo /home/devuser/.ansible/tmp/ansible-tmp-1527695492.58-123221534948391 `\" ) && sleep 0'\r\n<localhost> PUT /tmp/tmpwAmu_I TO /home/devuser/.ansible/tmp/ansible-tmp-1527695492.58-123221534948391/uri.py\r\n<localhost> EXEC /bin/sh -c 'chmod u+x /home/devuser/.ansible/tmp/ansible-tmp-1527695492.58-123221534948391/ /home/devuser/.ansible/tmp/ansible-tmp-1527695492.58-123221534948391/uri.py && sleep 0'\r\n<localhost> EXEC /bin/sh -c '/usr/bin/python /home/devuser/.ansible/tmp/ansible-tmp-1527695492.58-123221534948391/uri.py; rm -rf \"/home/devuser/.ansible/tmp/ansible-tmp-1527695492.58-123221534948391/\" > /dev/null 2>&1 && sleep 0'\r\nThe full traceback is:\r\n  File \"/tmp/ansible_uH8OQQ/ansible_module_uri.py\", line 468, in main\r\n    uresp['location'] = absolute_location(url, uresp['location'])\r\n\r\nfatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"connection\": \"close\",\r\n    \"content\": \"{\\\"error_description\\\": \\\"Missing token parameter.\\\", \\\"error\\\": \\\"invalid_request\\\"}\",\r\n    \"content_language\": \"en\",\r\n    \"content_length\": \"77\",\r\n    \"content_type\": \"text/html; charset=utf-8\",\r\n    \"date\": \"Wed, 30 May 2018 11:50:35 GMT\",\r\n    \"failed\": true,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"attributes\": null,\r\n            \"backup\": null,\r\n            \"body\": {\r\n                \"token\": \"i91ofHrQdOiNaN4HtLyF5D2zwX0dSg\"\r\n            },\r\n            \"body_format\": \"json\",\r\n            \"body_type\": \"json\",\r\n            \"client_cert\": null,\r\n            \"client_key\": null,\r\n            \"content\": null,\r\n            \"creates\": null,\r\n            \"delimiter\": null,\r\n            \"dest\": null,\r\n            \"directory_mode\": null,\r\n            \"follow\": false,\r\n            \"follow_redirects\": \"safe\",\r\n            \"force\": false,\r\n            \"force_basic_auth\": false,\r\n            \"group\": null,\r\n            \"header\": {\r\n                \"Authorization\": \"Bearer i91ofHrQdOiNaN4HtLyF5D2zwX0dSg\"\r\n            },\r\n            \"headers\": {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            \"http_agent\": \"ansible-httpget\",\r\n            \"method\": \"POST\",\r\n            \"mode\": null,\r\n            \"owner\": null,\r\n            \"regexp\": null,\r\n            \"remote_src\": null,\r\n            \"removes\": null,\r\n            \"return_content\": false,\r\n            \"selevel\": null,\r\n            \"serole\": null,\r\n            \"setype\": null,\r\n            \"seuser\": null,\r\n            \"src\": null,\r\n            \"status_code\": [\r\n                \"200\"\r\n            ],\r\n            \"timeout\": 30,\r\n            \"unsafe_writes\": null,\r\n            \"url\": \"https://awxserver:8443/api/o/revoke_token/\",\r\n            \"url_password\": null,\r\n            \"url_username\": null,\r\n            \"use_proxy\": true,\r\n            \"validate_certs\": false\r\n        }\r\n    },\r\n    \"msg\": \"Status code was not [200]: HTTP Error 400: Bad Request\",\r\n    \"redirected\": false,\r\n    \"server\": \"nginx/1.13.12\",\r\n    \"status\": 400,\r\n    \"url\": \"https://awxserver:8443/api/o/revoke_token/\",\r\n    \"vary\": \"Accept-Language, Cookie\",\r\n    \"x_api_total_time\": \"0.003s\"\r\n}\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nToken is revoked.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nI received invalid client errors using the curl methods and Missing token parameter using ansible URI.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe first time you create an OAuth2 token for a user, you must use basic HTTP Auth with the API using a password.  To make automation easier, it might be nice to have an `awx-manage` command that could be run as the `awx` user over ssh.\r\n\r\n`awx-manage create_oauth2_token --user=some_user`\r\n\r\nSuch a command would create a write-scoped token for an existing user and return the token value.\r\n\r\nrelated: https://github.com/ansible/awx/issues/1906"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCan't create a new credential with an organization administrator account\r\n\r\n![2018-05-30 10_34_30-ansible awx _ create credential](https://user-images.githubusercontent.com/37828871/40709434-4e9de148-63f6-11e8-9892-6572b221dddc.jpg)\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.9\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.3\r\n* Operating System: Windows 7 \r\n* Web Browser: Chrome, Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n- Log in to AWX with an organization administrator account (no system administrator)\r\n- Create new credentials of any type\r\n- When saving the error message \"Unexpected Error: {\"detail\":\"You do not have permission to perform this action.\"}\" appears\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nWhen passing through the API or using system administrator account, there is no problem\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nLooking for a option to set SCM branch at job template level with `prompt on launch` to avoid having to configure multiple projects when running different branches of the same playbook.  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nAs a workaround this is currently being done by performing the checkout as part of the playbook."},{"labels":["api"],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n  - Feature Idea\r\n \r\n\r\n##### COMPONENT NAME\r\n - API\r\n \r\n\r\n##### SUMMARY\r\nWe raised an RFE against redhat (when we was using ansible tower) to have the ability for passwordless access to the api. In awx 1.0.5 this was supposedly delivered with oauth2. However we now discover having looked at it, that you now need a password to get the initial token required for the rest of the api commands to work without a password. This is fundementally not much different to the previous authorisation model and still hinders automation as we now have to deal with a password and storing it in some location that is secure. \r\n\r\nWe assumed that having read our requirement and indeed spelt that out on the github ticket (https://github.com/ansible/awx/issues/21) addressing this - that it was understood what we meant. I assumed that the move to oauth2 was to allow openssl public / private keys to be used to enable this. However this hasn't been done. So can someone look into this. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.8\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.3\r\n* Operating System: rhel 7.4\r\n* Web Browser: chrome\r\n"},{"labels":["api",null],"text":"Hi Team,\r\n\r\nI am running Ansible tower docker version.\r\n\r\nI configured LDAP authentication in the UI setting section of LDAP, but it is not working.\r\n\r\nWanted to know , does docker version of ansible tower support AD integration.\r\n\r\nIf yes, I am not sure, if I am making any mistake while configuring LDAP.\r\n "},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nServer update to CentOS 7.5 makes api fail?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5.22\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.0\r\n* Operating System: CentOS 7.5\r\n* Web Browser: Chrome Version 66.0.3359.117\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a fresh install of AWX on a CentOS 7.5 machine\r\n2. Delete the demo inventory\r\n\r\n##### EXPECTED RESULTS\r\n\r\nDemo Inventory is deleted\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAfter a server update to CentOS 7.5 I began to recieve the error: \"Call to /api/v2/inventories/1/ failed. DELETE returned status: 500 A server error has occurred.\" After attempting to delete the default demo inventory on a fresh install of AWX. \r\n\r\n##### ADDITIONAL INFORMATION\r\nawx_web docker container has a centos version of 7.4.1708 and the version of the machine running docker is CentOS 7.5.1804\r\n\r\nawx_web logs:\r\n\r\nerror: [Errno 104] Connection reset by peer                                                                                                                                                              [138/4664]\r\n2018-05-22 16:04:20,292 ERROR    django.request Internal Server Error: /api/v2/inventories/1/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 219, in delete\r\n    return self.destroy(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 2075, in destroy\r\n    obj.schedule_deletion(getattr(request.user, 'id', None))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\", line 475, in schedule_deletion\r\n    delete_inventory.delay(self.pk, user_id)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 461, in delay\r\n    return self.apply_async(args, kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 573, in apply_async\r\n    **dict(self._get_exec_options(), **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/base.py\", line 354, in send_task\r\n    reply_to=reply_to or self.oid, **options\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/amqp.py\", line 310, in publish_task\r\n    **kwargs\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 172, in publish\r\n    routing_key, mandatory, immediate, exchange, declare)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 470, in _ensured\r\n    interval_max)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 382, in ensure_connection\r\n    interval_start, interval_step, interval_max, callback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/utils/__init__.py\", line 246, in retry_over_time\r\n    return fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 250, in connect\r\n    return self.connection\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 756, in connection\r\n    self._connection = self._establish_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/connection.py\", line 711, in _establish_connection\r\n    conn = self.transport.establish_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/transport/pyamqp.py\", line 116, in establish_connection\r\n    conn = self.Connection(**opts)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 180, in __init__\r\n    (10, 30),  # tune\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/abstract_channel.py\", line 67, in wait\r\n    self.channel_id, allowed_methods, timeout)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 241, in _wait_method\r\n    channel, method_sig, args, content = read_timeout(timeout)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/connection.py\", line 330, in read_timeout\r\n    return self.method_reader.read_method()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/method_framing.py\", line 189, in read_method\r\n    raise m"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe field `scm_delete_on_next_update` isn't working like it should. It was only ever intended for internal use, but something went wrong with its implementation, and even if it was implemented correctly, clustered deploys wouldn't work with it.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: targeting 1.0.7 or something like that\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nModify the URL of a project, and see that this field isn't helping to trigger the subsequent update.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nField should be removed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThere, but not really hooked up right.\r\n\r\nhttps://github.com/ansible/awx/search?utf8=%E2%9C%93&q=scm_delete_on_next_update&type=\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRelated to https://github.com/ansible/awx/issues/208\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n \r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe would like to suggest that there is a feature to limit the number of times a job template can be launched within a particular time period - i.e set a maximum number of successful executions within 24 hours.\r\nRight now the best we can achieve is to have retrospective events triggered if a threshold has been met, but there are use cases where after the fact is too late.\r\nIs this possible?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: \r\n* AWX install method: \r\n* Ansible version:  \r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nImplement the ability to automatically redirect users to a specified external authentication provider when accessing the Tower login page rather than selecting a specific provider.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThis would be for auth providers such as SAML which require a third party authentication method outside of AWX/Tower"},{"labels":["api"],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nAWX 1.0.6.5  on kubernetes I cannot use custom inventory scripts via AWX ui that use the ansible.inventory.manager api \r\nI have no issues using the script via cmd from within the awx-celery pod or \r\nif I upload custom scripts llike mababio/test.py from here http://www.pythonexample.com/code/ansible-dynamic-inventory-hostvars/  and run it then I get my inventory succesfully imported aswell. \r\nI would be nice to be able to use the ansible API for parsing inventory files  instead of creating a manual json mapping from scratch\r\nIt does work actually , just not via the awx web ui\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.6.5 \r\n* AWX install method: kubernetes\r\n* Ansible version:  ansible 2.5.2\r\n* Web Browser: Firefox / Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nI have uploaded custom inventory script\r\n***************************\r\n```\r\n#!/usr/bin/env python\r\n \r\nimport json\r\nimport sys\r\nimport os\r\nimport argparse\r\n\r\nfrom ansible.parsing.dataloader import DataLoader\r\nfrom ansible.inventory.manager import InventoryManager\r\n \r\n \r\ndef main():\r\n  parser = argparse.ArgumentParser()\r\n  parser.add_argument('--list', action = 'store_true')\r\n  parser.add_argument('--host', action = 'store')\r\n  parser.add_argument('--pretty', action = 'store_true')\r\n  args = parser.parse_args()\r\n  loader = DataLoader()\r\n\r\n  \r\n  sources = '/nfs_mount/foo'\r\n\r\n  inventory = InventoryManager(loader=loader, sources=sources) \r\n  inventory.parse_sources()\r\n  out = {'_meta': {'hostvars': {}}}\r\n  if args.list:\r\n    for group in inventory.groups.values():\r\n      out[group.name] = {\r\n          'hosts': [h.name for h in group.hosts],\r\n          'vars': group.vars,\r\n          'children': [c.name for c in group.child_groups]\r\n      }\r\n    for host in inventory.get_hosts():\r\n      out['_meta']['hostvars'][host.name] = host.vars\r\n\r\n    print(json.dumps(out, indent=4, sort_keys=True))\r\n \r\n\r\nif __name__ == \"__main__\":\r\n  main() \r\n```\r\n\r\n***************************\r\nI have  file '/nfs_mount/foo' available with the following contents\r\n\r\n> [foo]\r\n> host1  ansible_host=192.168.1.0\r\n> host2  ansible_host=192.168.1.1\r\n\r\nIn  awx ui /my_imported_script/sources press sync \r\nTo try to replicate in the pod via cmd  I logon to the container in kubernetes\r\n\r\nkubectl exec -it awx-kubernetes-pod  -c awx-celery bash -n awx\r\nI catch the scripts  that are created in /tmp in the awx-celery container via simple for loop  while I run the sync in the UI\r\n`_while true; do ps -ef|grep inv ; cp -rfp /tmp/awx_* .; sleep 1; done_`\r\nI will end up with the following command \r\n**`/usr/bin/awx-manage inventory_import --inventory-id 19 --group-filter ^.+$ --host-filter ^.+$ --exclude-empty-groups --source /tmp/awx_inventory_OvPnsK/tmp1NGkwV --custom -v2 `**\r\n\r\nThe inventory script is now stored in my local dir as **awx_inventory_OvPnsK/tmp1NGkwV** \r\ninspecting **awx_inventory_OvPnsK/tmp1NGkwV**  and it looks identical to the script uploaded in the ui itself \r\nIn the awx-celery docker container I run the command \r\n**`/usr/bin/awx-manage inventory_import --inventory-id 19 --group-filter ^.+$ --host-filter ^.+$ --exclude-empty-groups --source /tmp/awx_inventory_OvPnsK/tmp1NGkwV --custom -v2 `**\r\n\r\nThe sync is succesful\r\nThe sync run in cmd from the pod  will also be visible and registered as succesful in web ui as\r\n![image](https://user-images.githubusercontent.com/2832654/40119007-cd924650-591b-11e8-87fd-7d43e2ffdc38.png)\r\n\r\nThe inventory sync in UI will crash with error error (see actual results below)\r\nHowever running the command caught in the container produces successful output and the hosts are indeed available in the UI for playbook runs\r\n\r\n\r\nOutput from within the awx-celery container\r\n```\r\n\r\nbash-4.2$ /usr/bin/awx-manage inventory_import --inventory-id 19 --group-filter ^.+$ --host-filter ^.+$ --exclude-empty-groups --source /tmp/awx_inventory_OvPnsK/tmp1NGkwV --custom -v2\r\n2018-05-16 13:00:37,999 INFO     awx.main.commands.inventory_import Updating inventory 19: static_inventory\r\n2018-05-16 13:00:38,101 DEBUG    awx.main.commands.inventory_import Using system install of ansible-inventory CLI: /usr/bin/ansible-inventory\r\n2018-05-16 13:00:38,101 INFO     awx.main.commands.inventory_import Reading Ansible inventory source: /tmp/awx_inventory_OvPnsK/tmp1NGkwV\r\n2018-05-16 13:00:39,439 ERROR    awx.main.commands.inventory_import  [ERROR]:\r\n2018-05-16 13:00:39,439 INFO     awx.main.commands.inventory_import Processing JSON output...\r\n2018-05-16 13:00:39,439 DEBUG    awx.main.commands.inventory_import Loaded group: all\r\n2018-05-16 13:00:39,439 DEBUG    awx.main.commands.inventory_import Loaded group: foo\r\n2018-05-16 13:00:39,440 DEBUG    awx.main.commands.inventory_import Adding child group foo to parent all\r\n2018-05-16 13:00:39,440 DEBUG    awx.main.commands.inventory_import Loaded host: host1\r\n2018-05-16 13:00:39,440 DEBUG    awx.main.commands.inventory_import Adding host host1 to group foo\r\n2018-05-16 13:00:39,440 DEBUG    awx.main.commands.inventory_import Loaded host: host2\r\n2018-05-16 13:00:39,440 DEBUG    awx.main.commands.inventory_import Adding host host2 to group foo\r\n2018-05-16 13:00:39,440 DEBUG    awx.main.commands.inventory_import Adding child group foo to parent all\r\n2018-05-16 13:00:39,440 DEBUG    awx.main.commands.inventory_import Finished loading from source: /tmp/awx_inventory_OvPnsK/tmp1NGkwV\r\n2018-05-16 13:00:39,440 INFO     awx.main.commands.inventory_import Loaded 1 groups, 2 hosts\r\n2018-05-16 13:00:39,442 INFO     awx.main.commands.inventory_import Inventory variables unmodified\r\n2018-05-16 13:00:39,453 INFO     awx.main.commands.inventory_import Group \"foo\" added\r\n2018-05-16 13:00:39,468 INFO     awx.main.commands.inventory_import Host \"host1\" added\r\n2018-05-16 13:00:39,472 INFO     awx.main.commands.inventory_import Host \"host2\" added\r\n2018-05-16 13:00:39,493 INFO     awx.main.commands.inventory_import Host \"host1\" added to group \"foo\" \r\n2018-05-16 13:00:39,493 INFO     awx.main.commands.inventory_import Host \"host2\" added to group \"foo\"\r\n2018-05-16 13:00:39,497 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\n2018-05-16 13:00:39,581 DEBUG    awx.main.models.inventory Finished updating inventory computed fields\r\n2018-05-16 13:00:39,582 INFO     awx.main.commands.inventory_import Inventory import completed for  (static_inventory - 28) in 1.6s\r\n\r\n\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/2832654/40118748-0fc47a1c-591b-11e8-832f-625fea5dd991.png)\r\n\r\n\r\n##### ACTUAL RESULTS\r\n2018-05-16 12:56:43,413 INFO     awx.main.commands.inventory_import Updating inventory 19: static_inventory\r\n2018-05-16 12:56:43,428 DEBUG    awx.main.commands.inventory_import Using system install of ansible-inventory CLI: /usr/bin/ansible-inventory\r\n2018-05-16 12:56:43,428 INFO     awx.main.commands.inventory_import Reading Ansible inventory source: /tmp/awx_inventory_OvPnsK/tmp1NGkwV\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx==1.0.6.5', 'console_scripts', 'awx-manage')()\r\n  File \"/usr/lib/python2.7/site-packages/awx/__init__.py\", line 109, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 991, in handle\r\n    self.is_custom)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 242, in load_inventory_source\r\n    is_custom=is_custom).load()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 177, in load\r\n    data = self.command_to_json(base_args + ['--list'])\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 160, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=1) with stdout:\r\n\r\nstderr:\r\n [WARNING]:  * Failed to parse /tmp/awx_inventory_OvPnsK/tmp1NGkwV with script\r\nplugin: Inventory script (/tmp/awx_inventory_OvPnsK/tmp1NGkwV) had an execution\r\nerror:  [WARNING]: Unable to parse /nfs_mount/foo as an\r\ninventory source  Traceback (most recent call last):   File\r\n\"/tmp/awx_inventory_OvPnsK/tmp1NGkwV\", line 35, in <module>     main()   File\r\n\"/tmp/awx_inventory_OvPnsK/tmp1NGkwV\", line 18, in main     inventory =\r\nInventoryManager(loader=loader, sources=\"/nfs_mount/foo\")   File\r\n\"/usr/lib/python2.7/site-packages/ansible/inventory/manager.py\", line 145, in\r\n__init__     self.parse_sources(cache=True)   File \"/usr/lib/python2.7/site-\r\npackages/ansible/inventory/manager.py\", line 215, in parse_sources     raise\r\nAnsibleError(\"No inventory was parsed, please check your configuration and\r\noptions.\") ansible.errors.AnsibleError: No inventory was parsed, please check\r\nyour configuration and options.\r\n\r\n [WARNING]: Unable to parse /tmp/awx_inventory_OvPnsK/tmp1NGkwV as an inventory\r\nsource\r\n\r\nERROR! No inventory was parsed, please check your configuration and options.\r\n\r\n![image](https://user-images.githubusercontent.com/2832654/40119087-fa24e498-591b-11e8-8a80-d52f3758db2f.png)\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n - API\r\n\r\n##### SUMMARY\r\nWhen trying to configure LDAP, I get the following error:\r\n\r\nHTTP 400 Bad Request\r\nAllow: GET, PUT, PATCH, DELETE, HEAD, OPTIONS\r\nContent-Type: application/json\r\nVary: Accept\r\nX-API-Node: awx-1-fgf4g\r\nX-API-Time: 0.057s\r\n\r\n{\r\n    \"AUTH_LDAP_GROUP_TYPE_PARAMS\": [\r\n        \"Invalid key(s): \\\"member_attr\\\".\"\r\n    ]\r\n}\r\n\r\nAs a result of this error, I can not log into AWX using LDAP credentials.  The same config works on AWX 1.0.3.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.5\r\n* AWX install method: openshift\r\n* Ansible version:  2.5.2\r\n* Operating System:\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Log into AWX\r\n- Configured LDAP\r\n- Logout and try to login with a LDAP user\r\n\r\nOr \r\n- Log into the API - /api/v2/settings/ldap/ \r\n- Configured LDAP settings.\r\n- The settings don't save unless you remove memeber_attr from AUTH_LDAP_GROUP_TYPE_PARAMS.\r\n\r\n##### EXPECTED RESULTS\r\nI should be able to configure LDAP and login as an LDAP user.\r\n\r\n##### ACTUAL RESULTS\r\nI am not able to fully configure LDAP and can't login as an LDAP user.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n- none of the above\r\n\r\n##### SUMMARY\r\n\r\nThe contributing docs should explain how to contribute translations.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. see https://github.com/ansible/awx/issues/1864\r\n2. note we don't document this\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe schedule a run of a playbook on all our inventories. We expect the instances handle the load correctly, but we see weird behaviours when playbooks are run against big inventories.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.5\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.5.2\r\n* Operating System: Linux\r\n* Web Browser: Firefox/Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nHave a small playbook that checks the expiration date of an SSL certificate.\r\nHave 100 Inventories, varying from 2 hosts, to 150 hosts.\r\nHave a kubernetes cluster with 5 nodes (4 cpus / 12G ram )\r\nDeploy awx and scale it to 5 instances\r\nSet the instances capacity to 70% \r\nCreate an instance group with 4 instances only (80%)\r\nAssociate the playbook to that instance group\r\nRun the playbook against all inventories.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe instances handle capacity correctly and all the playbooks complete.\r\n\r\n##### ACTUAL RESULTS\r\nVery erratical results, several cases.\r\n\r\n1.  After capacity is reached and playbooks seemingly run smoothly, one instance disappears, I guess by the AutoScaler\r\n2.  That causes chaos, and capacity never gets distributed among the nodes, only 1 node seem to handle everything. It seems all the jobs that were kicked out of the dropped instances(s), end-up as part of the capacity calculacion for the remaining node , showin percentages going over +100%, 550% while I was writing this.\r\n\r\n##### ADDITIONAL INFORMATION"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nJobs in progress cannot be cancelled and never complete\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.2\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome on Windows 7\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. create a project, add credentials, and create a job template\r\n2. attempt to spin up a job from the template\r\n\r\n##### EXPECTED RESULTS\r\n\r\nthe job should begin, execute fully, and terminate.  The job should also be able to be cancelled.\r\n\r\n##### ACTUAL RESULTS\r\n\r\noccasionally, the job will simply never start.  Other times, the job will start but never complete.  Attempting to cancel the job, either from the individual job page or from the jobs list page, simply does nothing.\r\n\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nTeams and users permissions in a \"SCM type\" project are removed when get latest SCM version\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.5\r\n* AWX install method: docker-compose on linux\r\n* Ansible version:  2.5.2\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Add project with SCM source\r\n- Create a team with one user (e.g. \"testuser\")\r\n- Assign permissions on SCM project (use & update) to that team\r\n- Login as \"testuser\"\r\n- Get latest SCM version of project\r\n\r\n##### EXPECTED RESULTS\r\n\r\nProject disappear after refresh of the page\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSCM project is no more visible in the \"testuser\" screen\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen pulling the JSON output from the /api/v2/jobs/<ID>/stdout endpoint, it appears in a large text blob contained inside a content with what looks like HTML as well. It would nice if this was formatted more cleanly so its easier to parse for facts.\r\n\r\n##### ADDITIONAL INFORMATION\r\nExample of current output:\r\n```\r\n{\"content\":\"<span class=\\\"ansi31\\\"> [ERROR]:</span>\\r\\n<span class=\\\"ansi31\\\"></span>\\r\\n\\r\\nPLAY [Hello World Sample] ******************************************************\\r\\n\\r\\nTASK [Gathering Facts] *********************************************************\\r\\n<span class=\\\"ansi32\\\">ok: [localhost]</span>\\r\\n\\r\\nTASK [Hello Message] ***********************************************************\\r\\n<span class=\\\"ansi32\\\">ok: [localhost] =&gt; {</span>\\r\\n<span class=\\\"ansi32\\\">    \\\"msg\\\": \\\"Hello World!\\\"</span>\\r\\n<span class=\\\"ansi32\\\">}</span>\\r\\n\\r\\nPLAY RECAP *********************************************************************\\r\\n<span class=\\\"ansi32\\\">localhost</span>                  : <span class=\\\"ansi32\\\">ok=2   </span> changed=0    unreachable=0    failed=0   \\r\\n\\r\\n\",\"range\":{\"start\":0,\"end\":17,\"absolute_end\":17}}\r\n```\r\nExample of desired output:\r\n```\r\n{content: {\r\n  machine1: {\r\n    task1: {\r\n      metadata: {some_metadata},\r\n      output: {actual_task_output}},\r\n    task2: {\r\n      metadata: {some_metadata},\r\n      output: {actual_task_output}}\r\n  },\r\n  machine2: {\r\n    task1: {\r\n      metadata: {some_metadata},\r\n      output: {actual_task_output}},\r\n    task2: {\r\n      metadata: {some_metadata},\r\n      output: {actual_task_output}}\r\n}}\r\n```"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n \r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt would be nice to have another type of workflow status to add to always/ success/ failed which ran only if all other job templates were successful.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n* AWX install method: n/a\r\n* Ansible version:  2.5.2\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nJob details and Job view not working properly\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.2\r\n* Operating System: RedHat 7.4\r\n* Web Browser: Firefox/Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nRun any playbook, failed and succeeded jobs are present but not showing any details.\r\n\r\n##### EXPECTED RESULTS\r\nDetails from jobs\r\n\r\n##### ACTUAL RESULTS\r\nNothing is showing, no errors, no timeouts, just nothing\r\n\r\n##### ADDITIONAL INFORMATION\r\nFor example I have a failed job. When clicking on details, I can see the URL changing to:\r\nhttps://awx-url/#/jobz/project/<job number>\r\nHowever nothing happens. When using right mouse button and opening in new tab/page I will only get the navigation pane and a blank page.\r\nSame happens when I click on the job it self. \r\n\r\nAdditionaly, adding inventory sources works fine, however when navigating to 'Schedule inventory sync' I can see the the gear-wheel spinning but also nothing happens. \r\nI did a fresh installation today (9th May)\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nGetting a list of jobs that are running and have an elapsed time greater than N seconds does not seem to work.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Tower 3.2.2\r\n* AWX install method: \r\n  * src: \"https://releases.ansible.com/ansible-tower/setup-bundle/{{ tower_bundle }}.tar.gz\"\r\n  * command: ./setup.sh\r\n* Ansible version:  2.4.2.0\r\n* Operating System: Red Hat Enterprise Linux Server release 7.4 (Maipo)\r\n* Web Browser: any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPasting tower-cli commands used for easiness, I get the same bevaviour if I point a browswer of my choice at `https://tower.example.com/api/v2/jobs/?&elapsed__gt=9;status=running` and `https://tower.example.com/api/v2/jobs/?&elapsed__gt=9&status=running` (unsure if *;* or *&* needed when combining the query. I'm told *;* is the correct delimiter)\r\n\r\n(It's just easier to paste one shell session than copypasta from multiple queries in the browser)\r\n\r\n```\r\n[vagrant@tower ~]$ tower-cli job list --all-pages --query status running                       \r\n=== ============ ======================== ======= ========= \r\nid  job_template         created          status   elapsed  \r\n=== ============ ======================== ======= ========= \r\n796           35 2018-05-08T19:30:09.076Z running 62.556298\r\n=== ============ ======================== ======= ========= \r\n[vagrant@tower ~]$ tower-cli job list --all-pages --query status running --query elapsed__gt 60\r\nNo records found.\r\n[vagrant@tower ~]$ tower-cli job list --all-pages --query status running --query elapsed__gt 90\r\nNo records found.\r\n[vagrant@tower ~]$ tower-cli job list --all-pages --query status running                       \r\n=== ============ ======================== ======= ========= \r\nid  job_template         created          status   elapsed  \r\n=== ============ ======================== ======= ========= \r\n796           35 2018-05-08T19:30:09.076Z running 79.255133\r\n=== ============ ======================== ======= ========= \r\n```\r\n```\r\n[vagrant@tower ~]$ tower-cli job list --all-pages --query status running --query elapsed__lt 10\r\n=== ============ ======================== ======= ========= \r\nid  job_template         created          status   elapsed  \r\n=== ============ ======================== ======= ========= \r\n796           35 2018-05-08T19:30:09.076Z running 88.274961\r\n=== ============ ======================== ======= ========= \r\n[vagrant@tower ~]$ tower-cli job list --all-pages --query status running --query elapsed__lt 100\r\n=== ============ ======================== ======= ========= \r\nid  job_template         created          status   elapsed  \r\n=== ============ ======================== ======= ========= \r\n796           35 2018-05-08T19:30:09.076Z running 91.281971\r\n=== ============ ======================== ======= ========= \r\n```\r\n\r\nPlease note that queries on non-running jobs seem to work just fine. So be sure to query for running jobs when reproducing.\r\n\r\n##### EXPECTED RESULTS\r\n`elapsed__lt` and `elapsed__gt` should correctly compare the values (but maybe I'm just using it wrong).\r\n* `tower-cli job list --all-pages --query status running --query elapsed__gt 60` should have returned *job 796*\r\n* `tower-cli job list --all-pages --query status running --query elapsed__lt 100` should have returned *No records found.*\r\n\r\n##### ACTUAL RESULTS\r\n* `status=running` combined with `elapsed__gt` never returns results\r\n* `status=running` combined with `elapsed__lt` always returns results\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API?\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI initially thought this might be something related to the ldap implementation but I created a local test user, test team, test project.  I am unable to assign the test user to the team or permission the test user to the project (UI accepts inputs but changes don't result in the user being added/permissioned to the object).  Same holds true for users/teams created from ldap.\r\n\r\nUpdate: It appears I'm getting a 403 on the POST even though I'm logged into a super user account.\r\n`{\"detail\":\"You do not have permission to perform this action.\"}`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.2\r\n* Operating System:  Ubuntu 16.04\r\n* Web Browser:  Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate a local user.  Create a test org, project, team, and template.  Attempt to add user to team (UI accepts inputs as normal but no changes are made to perms).  Attempt to add user perms to the test template (UI accepts inputs as normal but no changes are made to perms).\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\nThe desired permission assignment should be revealed through the UI or throw an exception.\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nPermission assignments don't persist.\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\nI first noticed this behavior after I had configured ldap.  Unsure if this is a prereq to reproducing this issue.\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nLDAP authentication settings don't persist when \"LDAP Group Type\" equals \"ActiveDirectoryGroupType\".\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.2\r\n* Operating System:  Ubuntu 16.04\r\n* Web Browser:  Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nLogin to the webui.  Click on \"Settings\", click on \"Authentication\", select \"LDAP\" from the \"Sub Category\" drop-down on the right.  Input the applicable LDAP settings making sure to choose \"ActiveDirectoryGroupType\" for the \"LDAP Group Type\".\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\nSettings get saved and persist in the database.\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nSettings return to the previous value.  In my case this was the default value of \"MemberDNGroupType\"\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n \r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAllow admins to set and enforce a password strength policy that applies to all users when updating passwords\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCurrently, password strength requirements can be enforced only on externally-authenticated accounts.  This enhancement would allow the enforcement of strength requirements on local users' passwords.\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nBe able to allow Callbacks to awx via the awx API and invoke the launch of a Workflow.\r\n\r\nDepends on https://github.com/ansible/awx/issues/1845"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe 'Update on launch' behaviour for inventories does not work when using a Smart inventory.\r\n\r\n##### ENVIRONMENT\r\n*  AWX 1.0.5.32\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.1\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Webkit \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Mark the 'Update on launch' option on a inventory source.\r\n- Create a Smart inventory based on the previous one.\r\n- Run a job associated to the smart inventory.\r\n- Do some changes on the smart inventory (like deleting/adding a node).\r\n- Run same job again.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWhen the job runs, the parent inventory gets updated, and then the smart directory too.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWhen the job runs, the inventory is not updated. \r\nI.E.: Job fails if some host is now missing.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nUsing digitalocean.py script to create the dynamic inventory.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nLaunched a Job. The job got orphaned after running for several hours.  The job never got canceled even if it reached the DEFAULT JOB TIMEOUT, configured as 27000 (7 hours)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.3\r\n* AWX install method: kubernetes\r\n* Ansible version:  2.5.2\r\n* Operating System: Linux\r\n* Web Browser: Chrome / Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a playbook where one of the tasks hangs there forever. \r\n\r\n##### EXPECTED RESULTS\r\nExpect the timeout set DEFAULT JOB TIMEOUT when is reached, the system cancels or terminates the job.\r\n\r\n##### ACTUAL RESULTS\r\nNo timeout was honored.\r\n\r\nDEFAULT_JOB_TIMEOUT 27000\r\n\r\ntower-cli result:\r\ntower-cli job list --status running\r\n3520          441 2018-05-01T19:18:31.102280Z running 82742.098922\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"How do you tell what the version of AWX you are running?  Is there plans to update the current version?\r\nthanks\r\n<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"**ISSUE TYPE**\r\n\r\n- Bug Report\r\n\r\n**COMPONENT NAME**\r\n\r\n- UI\r\n\r\n**SUMMARY**\r\n\r\nFirst, I am a normal user with execute permission for the workflow template. I successfully executed first time as following figure.\r\n\r\n![default](https://user-images.githubusercontent.com/36478905/39513404-ccdcc208-4e26-11e8-942a-0cbad0ba7d07.JPG)\r\n\r\n\r\n \r\nWhen I relaunched the workflow template with rocket button on the upper-right corner, UI had no any response.  I checked the log of awx_web contanier. The error is shown as below.\r\n\r\n```bash\r\n2018-05-02 08:13:32,160 ERROR    django.request Internal Server Error: /api/v2/workflow_jobs/255/relaunch/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 3741, in post\r\n    obj = self.get_object()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 101, in get_object\r\n    self.check_object_permissions(self.request, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 3732, in check_object_permissions\r\n    relaunch_perm, messages = request.user.can_access_with_errors(self.model, 'start', obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 130, in check_user_access_with_errors\r\n    result = access_method(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 1926, in can_start\r\n    return self.can_recreate(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 1932, in can_recreate\r\n    for node in node_qs:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 250, in __iter__\r\n    self._fetch_all()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 1120, in _fetch_all\r\n    self._prefetch_related_objects()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 675, in _prefetch_related_objects\r\n    prefetch_related_objects(self._result_cache, *self._prefetch_related_lookups)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 1466, in prefetch_related_objects\r\n    \"prefetch_related().\" % lookup.prefetch_through)\r\nValueError: 'credential' does not resolve to an item that supports prefetching - this is an invalid parameter to prefetch_related().\r\n2018-05-02 08:13:32,160 ERROR    django.request Internal Server Error: /api/v2/workflow_jobs/255/relaunch/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 3741, in post\r\n    obj = self.get_object()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 101, in get_object\r\n    self.check_object_permissions(self.request, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 3732, in check_object_permissions\r\n    relaunch_perm, messages = request.user.can_access_with_errors(self.model, 'start', obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 130, in check_user_access_with_errors\r\n    result = access_method(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 1926, in can_start\r\n    return self.can_recreate(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 1932, in can_recreate\r\n    for node in node_qs:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 250, in __iter__\r\n    self._fetch_all()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 1120, in _fetch_all\r\n    self._prefetch_related_objects()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 675, in _prefetch_related_objects\r\n    prefetch_related_objects(self._result_cache, *self._prefetch_related_lookups)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 1466, in prefetch_related_objects\r\n    \"prefetch_related().\" % lookup.prefetch_through)\r\nValueError: 'credential' does not resolve to an item that supports prefetching - this is an invalid parameter to prefetch_related().\r\n172.18.0.6 - - [02/May/2018:08:13:32 +0000] \"POST /api/v2/workflow_jobs/255/relaunch/ HTTP/1.1\" 500 41 \"https://10.21.97.96/\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\"\r\n[pid: 31|app: 0|req: 685/3753] 172.18.0.6 () {46 vars in 2408 bytes} [Wed May  2 08:13:32 2018] POST /api/v2/workflow_jobs/255/relaunch/ => generated 41 bytes in 113 msecs(HTTP/1.1 500) 5 headers in 177 bytes (1 switches on core 0)\r\n```\r\n\r\n**ENVIRONMENT**\r\n\r\n- AWX version: 1.0.5.24\r\n- AWX install method: docker on Linux\r\n- Ansible version: 2.4.3.0\r\n- Operating System: Linux Ubuntu 16.04\r\n- Web Browser: Google Chrome\r\n\r\n**STEPS TO REPRODUCE**\r\n\r\n1. Configure workflow template by admin\r\n2.  Normal user logged in and successfully launched workflow template. \r\n3. With \"Relauch\" button in Jobs pages, it had no reponse and show error in awx_web console.\r\n\r\n**EXPECTED RESULTS**\r\n\r\nNormal user can relaunch the workflow templates.\r\n\r\n**ACTUAL RESULTS**\r\n\r\nFailed when relaunched.\r\n\r\n**ADDITIONAL INFORMATION**\r\n\r\nWhen I changed to admin user to execute, it can be successfully launched and relaunched."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\ntower-cli not able to connect to host\r\n\r\n##### ENVIRONMENT\r\nRHEL 7.4\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Install AWX Community edition in docker\r\n2. Copy towe cli tar ansible-tower-cli-3.2.1.tar inside awx_web container\r\n    docker cp /ansible-tower-cli-3.2.1.tar awx_web:/\r\n3. Attach to awx_web container and extract ansible cli tar.\r\n4. Run setup script to install tower-cli\r\n    ./setup build\r\n    ./setup install\r\n5. Tun tower-cli to update user and password\r\n   tower-cli config username admin\r\n   tower-cli config password <password>\r\n   tower-cli config host <hostip of the host on which docker containers are running>\r\n6. Run tower-cli command to get list of templates\r\n    \r\ntower-cli job_template list\r\nError: There was a network error of some kind trying to connect to Tower.\r\n\r\nThe most common  reason for this is a settings issue; is your \"host\" value in `tower-cli config` correct?\r\nRight now it is: \"<ip>\".\r\n\r\nScenario here is I have created a manual project in awx at location /var/lib/awx/projects/<projectname>\r\nProject is visible in awx GUI\r\nPlaybook already uploaded in Manual project\r\nCreate template using the manual project .\r\n\r\nI already have a json file for survey, which I want to upload to the created job template using tower-cli\r\n\r\nI have already copied survey json in awx_web container\r\ntower-cli job_template modify --name=\"<job template name>\" --survey-spec=@/<Survey>.json --survey-enabled=true \r\n\r\nMy question here is\r\n\r\n1. On which container i should install tower-cli\r\n2. What should be the host ip to update in tower-cli config host <IP?>\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nThe YAML files are stored in a git repo and successfully downloaded via a \"Project\" in AWX.\r\nHowever, when the playbook is launched, the galaxy roles defined in [git repo]/roles/requirements.yml are not loaded, leading to a fatal error.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.6.1\r\n* AWX install method: docker on linux (Debian 9)\r\n* Ansible version: Ansible 2.5.2\r\n* Operating System: Linux (Debian 9)\r\n* Web Browser: Chrome 66\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1a) Create the following files;\r\n> /test1.yml\r\n> /roles/requirements.yml\r\n1b) /test1.yml\r\n```\r\n---\r\n- hosts: all\r\n\r\n  roles:\r\n    - yatesr.timezone\r\n  vars:\r\n    timezone: Europe/Berlin\r\n```\r\n1c) /roles/requirements.yml\r\n```\r\n---\r\n- src: yatesr.timezone\r\n```\r\n2) Sync the AWX project owning the git repo\r\n3) Create a template job and configure it as following:\r\n- Job Type = **Run**\r\n- Inventory = **_<inventory>_**\r\n- Project = **_<project>_**\r\n- Playbook = **/test1.yml**\r\n- Check \"**Enable Concurrent Jobs**\"\r\n- Check \"**Use Fact Cache**\"\r\n\r\n4) Run the job.\r\n\r\n##### EXPECTED RESULTS\r\nThe playbook should run without error.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nansible-playbook 2.5.2\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/usr/lib/python2.7/site-packages/awx/plugins/library']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n [ERROR]:\r\n\r\nParsed /tmp/awx_98_15kXc8/tmpuRtOnI inventory source with script plugin\r\nERROR! the role 'yatesr.timezone' was not found in /var/lib/awx/projects/_6__playbooks_inventories/roles:/var/lib/awx/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:/var/lib/awx/projects/_6__playbooks_inventories\r\n\r\nThe error appears to have been in '/var/lib/awx/projects/_6__playbooks_inventories/test1.yml': line 5, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n  roles:\r\n    - yatesr.timezone\r\n      ^ here\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWhen running the playbook manually via Ansible CLI (ie out of AWX), it works as expected."},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWith the release of Ansible 2.4 it's possible to use **import_playbook** statements to add other playbooks into a playbook file. In some instances a playbook only contains these statements to import other playbooks and it does not contain any plays in them directly.\r\n\r\nExample (openshift deploy_cluster playbook): https://github.com/openshift/openshift-ansible/blob/master/playbooks/deploy_cluster.yml\r\n\r\nNot possible to add as job template either via UI and API until a minimum of one play is created somewhere in the file. For example:\r\n\r\n- import_playbook: other_playbook.yml\r\n- name: noop\r\n   hosts: localhost\r\n   tasks:\r\n   - debug:\r\n          msg: 'noop' \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- create a playbook with one or more import_playbook statement(s) only, try to add a job template and associate from a project.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob template is created from a valid playbook that contains only imported playbooks in them.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPlaybook doesn't show up in the list to add.\r\n\r\n"},{"labels":["api",null,null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nforeman.py dynamic inventory script for Red Hat Satellite 6 not loading Host Collections as groups\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5.24\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: AWX running on CentOS 7, browser accessing UI from Windows 7u\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a new Inventory in AWX UI\r\n2. Add a new Source, type Red Hat Satellite 6\r\n3. Associate Red Hat Satellite 6 credentials (including hostname) with new Inventory Source\r\n4. Add new Source Variable, contents:\r\n\r\n```\r\n---\r\nwant_hostcollections: True\r\n```\r\n\r\n5. Save the new Inventory Source\r\n6. Sync new Inventory Source\r\n\r\n##### EXPECTED RESULTS\r\n\r\nInventory defined above is populated from Satellite 6 server, with Host Collections included as groups for the Hosts.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nInventory is populated, but Host Collections are not retrieved from the Satellite 6 server - dynamic inventory script behaves like want_hostcollections=False (which is the default)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - Installer\r\n\r\n##### SUMMARY\r\nWhen you perform the integration between SAML and Ansible Tower/AWX the users that are federated on the SAML side will be created on Tower/AWX, but there is not any way to sync groups. The point of this issue is create a way to Map those groups that exists on SAML server agains the Orgs/Teams on Tower/AWX.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n* AWX install method: all\r\n* Ansible version:  a compatible one\r\n* Operating System: Linux\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nTo perform the integration with SAML you must put the correct JSON definition on Authentication field regarding to Tower/AWX Configuration.\r\n\r\nThe point is that now you could Map users to a Team/Org using regex like this:\r\n\r\n```json\r\nSOCIAL_AUTH_TEAM_MAP = {\r\n  \"My Team\": {\r\n    \"organization\": \"Test Org\",\r\n    \"users\": [\"/^[^@]+?@test\\.example\\.com$/\"],\r\n    \"remove\": True,\r\n  },\r\n  \"Other Team\": {\r\n    \"organization\": \"Test Org 2\",\r\n    \"users\": [\"/^[^@]+?@test\\.example\\.com$/\"],\r\n    \"remove\": False,\r\n  },\r\n}\r\n```\r\n\r\nBut the point is to create a way to use a SAML attribute comming from the IDP to be mapped against the Orgs/Tems on Tower/AWX, something like this:\r\n\r\n```json\r\n{\r\n \"Default\": {\r\n  \"users\": true\r\n },\r\n \"Systems Engineering\": {\r\n  \"users\": true,\r\n  \"admins\": [\r\n   \"groups.tower-admin\"\r\n  ],\r\n  \"remove_admins\": false,\r\n  \"remove_users\": false\r\n }\r\n}\r\n```\r\n\r\nThe content of groups array is:\r\n```\r\ngroups = ['tower-admin', 'group1', 'group2']\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCreate a Team/Org that maps with the groups which comes from SAML attributes\r\n\r\n"},{"labels":["api",null,null],"text":"\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen a template job fails and you double click the icon and choose Relaunched on `Failed` it triggers a new job but doesn't limit to the failed host, it just re-runs job on all hosts.\r\n \r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.0\r\n* Operating System: Linux\r\n* Web Browser: Firefox 59.0.2 (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a template and execute a template with a task that will fail on a given host.\r\n2. Double click Launch Icon and choose `Failed`\r\n3. Notice it runs on all hosts again.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTo run only on the failed hosts.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nRuns on all hosts.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI do pass my hosts via extra variables, not sure if that's causing the issue, but i would i assume the limit would take a subset of those hosts.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API ( I suppose as it's related to data storage)\r\n - UI\r\n\r\n##### SUMMARY\r\nCannot delete an user that has created something (for example even the default admin user on a blank install)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.5.31\r\n* AWX install method: Docker on Linux\r\n* Ansible version:  2.5.1\r\n* Operating System: Docker on Centos Atomic\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Delete the admin user on a blank install\r\nor\r\n- Delete a custom user after having created for example a template with it\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe user would get deleted\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe UI returns an error 500 and `awx_web` shows \r\n```sql\r\nIntegrityError: update or delete on table \"auth_user\" violates foreign key constraint \"main_unifie\r\ndjobtemplate_created_by_id_1f5fadfa_fk_auth_user_id\" on table \"main_unifiedjobtemplate\"\r\nDETAIL:  Key (id)=(2) is still referenced from table \"main_unifiedjobtemplate\".\r\n```"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nCurrently  the TACACS+ authentication backend\r\n\r\nhttps://github.com/ansible/awx/blob/96370584062a15271abafab7fc557ac2879aa38c/awx/sso/backends.py#L225-L227\r\n\r\nsends default value for client remote address \r\n\r\nhttps://github.com/ansible/tacacs_plus/blob/526b5a29c5656bbd8644accca238d1e9303dc272/tacacs_plus/flags.py#L81\r\n\r\nThe function `authenticate()` in  `TACACSClient` supports sending client remote address as parameter and should be used to correctly report client real address.\r\n\r\nhttps://github.com/ansible/tacacs_plus/blob/9ba553f79efcc7b955001503d1953900ba6284a4/tacacs_plus/client.py#L158\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  N/A\r\n* Operating System: Any\r\n* Web Browser: Any\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTACACS+ authentication packet will contain clients real remote address.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nClient remote address is always set to `python_device`."},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n/api/v2/authtoken/ no longer seems to be available in AWX 3.2.3. The release notes suggest that this endpoint is deprecated and that it will be removed on AWX 3.3. However, OAuth endpoint is available but there is no documentation and there seems to be no way to generate application keys in AWX.\r\n\r\n\r\n\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.3\r\n* AWX install method: ansible role: geerlingguy.ansible\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nGET /api/v2/\r\nHTTP 200 OK\r\nAllow: GET, HEAD, OPTIONS\r\nContent-Type: application/json\r\nVary: Accept\r\nX-API-Node: awx\r\nX-API-Time: 0.059s\r\n\r\n\r\n\r\n{\r\n    \"ping\": \"/api/v2/ping/\",\r\n    \"instances\": \"/api/v2/instances/\",\r\n    \"instance_groups\": \"/api/v2/instance_groups/\",\r\n    \"config\": \"/api/v2/config/\",\r\n    \"settings\": \"/api/v2/settings/\",\r\n    \"me\": \"/api/v2/me/\",\r\n    \"dashboard\": \"/api/v2/dashboard/\",\r\n    \"organizations\": \"/api/v2/organizations/\",\r\n    \"users\": \"/api/v2/users/\",\r\n    \"projects\": \"/api/v2/projects/\",\r\n    \"project_updates\": \"/api/v2/project_updates/\",\r\n    \"teams\": \"/api/v2/teams/\",\r\n    \"credentials\": \"/api/v2/credentials/\",\r\n    \"credential_types\": \"/api/v2/credential_types/\",\r\n    \"applications\": \"/api/v2/applications/\",\r\n    \"tokens\": \"/api/v2/tokens/\",\r\n    \"inventory\": \"/api/v2/inventories/\",\r\n    \"inventory_scripts\": \"/api/v2/inventory_scripts/\",\r\n    \"inventory_sources\": \"/api/v2/inventory_sources/\",\r\n    \"inventory_updates\": \"/api/v2/inventory_updates/\",\r\n    \"groups\": \"/api/v2/groups/\",\r\n    \"hosts\": \"/api/v2/hosts/\",\r\n    \"job_templates\": \"/api/v2/job_templates/\",\r\n    \"jobs\": \"/api/v2/jobs/\",\r\n    \"job_events\": \"/api/v2/job_events/\",\r\n    \"ad_hoc_commands\": \"/api/v2/ad_hoc_commands/\",\r\n    \"system_job_templates\": \"/api/v2/system_job_templates/\",\r\n    \"system_jobs\": \"/api/v2/system_jobs/\",\r\n    \"schedules\": \"/api/v2/schedules/\",\r\n    \"roles\": \"/api/v2/roles/\",\r\n    \"notification_templates\": \"/api/v2/notification_templates/\",\r\n    \"notifications\": \"/api/v2/notifications/\",\r\n    \"labels\": \"/api/v2/labels/\",\r\n    \"unified_job_templates\": \"/api/v2/unified_job_templates/\",\r\n    \"unified_jobs\": \"/api/v2/unified_jobs/\",\r\n    \"activity_stream\": \"/api/v2/activity_stream/\",\r\n    \"workflow_job_templates\": \"/api/v2/workflow_job_templates/\",\r\n    \"workflow_jobs\": \"/api/v2/workflow_jobs/\",\r\n    \"workflow_job_template_nodes\": \"/api/v2/workflow_job_template_nodes/\",\r\n    \"workflow_job_nodes\": \"/api/v2/workflow_job_nodes/\"\r\n}\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nNo cached facts for some hosts,  facts not exist iether API or web UI .\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.0  \r\n* AWX install method:  docker on linux\r\n* Ansible version: 2.4.3.0 \r\n* Operating System: CentOS 7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Configure AWX according to gude http://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html#ug-fact-caching\r\n2. Configure and run job for fact gathering,  job playbook \r\n ```\r\n- name: Gather node facts\r\n  become: yes\r\n  become_user: root\r\n  hosts: \"{{ host_list }}\"\r\n  gather_facts: True\r\n  tasks:\r\n\r\n```\r\n3.  Run  job with certain  invertory ( for all invertory hosts )\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nCan use cached facts for smart inventory filters and view them in AWX UI or via API .\r\n\r\n##### ACTUAL RESULTS\r\nFor some host facts not cached , but  gathering job end with successfull status for them .\r\n\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen a job returns a large standard output(around 4800 lines) the UI does not shown any output at all and just displays {}, \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.05\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.1\r\n* Operating System: Ubuntu 16\r\n* Web Browser: Firefox/Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nRun a job that has at least 4800 lines returned in standard ouput\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n![expected](https://user-images.githubusercontent.com/5055026/39128329-6aa5ac4a-46ff-11e8-9af9-99abf50fbfc8.PNG)\r\nStandard output returned around 1800 lines in this one\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n![empty](https://user-images.githubusercontent.com/5055026/39128177-0333b304-46ff-11e8-8977-a6a2dd8b5543.PNG)\r\nThis was around 4800 lines in standard output.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nThis is a fresh install of ansible, awx and ubuntu\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n \r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nIt would be useful to be able to tell quickly who is actively logged into the UI. For example if having to carryout emergency maintenance work. To quickly notify them. Ideally afilter to rapidly show active.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: docker on linux, \r\n* Ansible version:  2.5\r\n* Operating System: RHEL 7.4\r\n* Web Browser: CHROME\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nI manage a number of playbooks designed for automating highly-branched tasks that used to be performed by operators. The nature of this branching logic is highly boolean, and so I *very* frequently find myself using `multiple choice` type user surveys with `[true, false]` options. This requires more effort to make the survey, more effort to complete it, and requires care in input sanitation (where inputs are not `true` and `false`, but `\"true\"` and `\"false\"`. The `bool` filter is a life-saver.)\r\n\r\nUser surveys should support checkbox type fields, with `true` and `false` defaults.\r\n\r\nPerhaps they could be trinary checkboxes, with `true`, `false`, and `omitted`, to be more in-line with other non-required extra variables, but that strikes me as a potential UI headache.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: docker on linux"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nI have created a webhook notification I am able to test run it.But When I bind that notification to a template it does not trigger on success or failure.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: \r\n* Ansible version:  2.4.2.0\r\n* Operating System:centos\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nCreate a webhook  and bind it to a template for failure or success\r\n##### EXPECTED RESULTS\r\n\r\nI want webhook to get triggerred\r\n\r\n##### ACTUAL RESULTS\r\nNotification does not trigger\r\n\r\n"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nAfter installing and starting an AWX install using the 1.0.4 docker images, I tried to log in through the API using /api/v2/authtoken/.  The API issued a 404 response.  I looked inside the docker image at api/urls/urls.py, and found references to LoggedLoginView and LoggedLogoutView instead of AuthTokenView; these changes are found in the 1.0.5 tagged version, not in 1.0.4.  I'm wondering if the docker images were built from the wrong source.\r\n\r\nThe images I'm using are:\r\n\r\n```\r\nansible/awx_task    1.0.4               6d2002c20b84        3 weeks ago         1.03GB\r\nansible/awx_task    1.0.4.130           6d2002c20b84        3 weeks ago         1.03GB\r\nansible/awx_web     1.0.4               efce4d0feb8c        3 weeks ago         1.01GB\r\nansible/awx_web     1.0.4.130           efce4d0feb8c        3 weeks ago         1.01GB\r\n\r\n\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1\r\n* Operating System: Centos7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nRan installer/install.yml, having set ```dockerhub_version=1.0.4``` in inventory.\r\n\r\n```\r\ncurl  -X POST -H 'Content-type: application/json' 'http://localhost:8010/api/v2/authtoken/' -d '{\"username\":\"admin\",\"password\":\"password\"}'\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nOutput:\r\n```\r\n{\"token\":\"b61b77dc58ca53aecc846977e13784c08c2c64af\",\"expires\":\"2018-04-18T17:10:43.352981Z\"}\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nOutput:\r\n```{\"detail\":\"The requested resource could not be found.\"}```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe have a workflow with 20+ jobs. We are able to set the inventory source at the job level, but it becomes a bit taxing to have to modify each of the job templates whenever we want to switch inventory sources. It is also not feasible to copy job templates to have separate inventories per workflow, as it wouldn't be very long before we have more job templates than we can manage. It would be nice to be able to set the inventory source at the workflow template alone, and have the workflow level inventory take precedence over the job template level inventory.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.124\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a workflow template with various job templates. In each job template, you have the ability to set the inventory source. In the workflow template, you can overwrite job template level variables, but you cannot overwrite the job template level inventory source.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null],"text":"\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCame back from weekend and noticed I was getting a 502 Bad Gateway when I have not made any changes. I believe something may have been corrupted\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: docker on linux, \r\n* Ansible version:  2.5.0\r\n* Operating System: Centos 7.4\r\n* Web Browser: Firefox 59.0.2\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nNot sure, how to reproduce this issue. I have had my AWX instance running for about 2 weeks and have made no changes since about 6 days ago. I logged into the UI today and noticed i was getting a 502 bad gateway.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTo see the dashboard\r\n\r\n##### ACTUAL RESULTS\r\n\r\nI get a 502 Bad Gateway\r\n##### ADDITIONAL INFORMATION\r\n\r\nBelow are some error's i see in the awx_web container.\r\n```\r\n2018-04-16 20:50:13,715 ERROR    django.request Internal Server Error: /\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 244, in _legacy_get_response\r\n    response = middleware_method(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/middleware.py\", line 195, in process_request\r\n    executor = MigrationExecutor(connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/executor.py\", line 20, in __init__\r\n    self.loader = MigrationLoader(self.connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 52, in __init__\r\n    self.build_graph()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 209, in build_graph\r\n    self.applied_migrations = recorder.applied_migrations()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 65, in applied_migrations\r\n    self.ensure_schema()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 52, in ensure_schema\r\n    if self.Migration._meta.db_table in self.connection.introspection.table_names(self.connection.cursor()):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 229, in _cursor\r\n    self.ensure_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 189, in connect\r\n    self.connection = self.get_new_connection(conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 176, in get_new_connection\r\n    connection = Database.connect(**conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/psycopg2/__init__.py\", line 130, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\nOperationalError: FATAL:  could not open file \"base/16384/2601\": No such file or directory\r\n\r\n2018-04-16 20:50:13,715 ERROR    django.request Internal Server Error: /\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 244, in _legacy_get_response\r\n    response = middleware_method(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/middleware.py\", line 195, in process_request\r\n    executor = MigrationExecutor(connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/executor.py\", line 20, in __init__\r\n    self.loader = MigrationLoader(self.connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 52, in __init__\r\n    self.build_graph()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 209, in build_graph\r\n    self.applied_migrations = recorder.applied_migrations()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 65, in applied_migrations\r\n    self.ensure_schema()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 52, in ensure_schema\r\n    if self.Migration._meta.db_table in self.connection.introspection.table_names(self.connection.cursor()):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 229, in _cursor\r\n    self.ensure_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 189, in connect\r\n    self.connection = self.get_new_connection(conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 176, in get_new_connection\r\n    connection = Database.connect(**conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/psycopg2/__init__.py\", line 130, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\nOperationalError: FATAL:  could not open file \"base/16384/2601\": No such file or directory\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/wsgi.py\", line 157, in __call__\r\n    response = self.get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 124, in get_response\r\n    response = self._middleware_chain(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 43, in inner\r\n    response = response_for_exception(request, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 93, in response_for_exception\r\n    response = handle_uncaught_exception(request, get_resolver(get_urlconf()), sys.exc_info())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 143, in handle_uncaught_exception\r\n    return callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 88, in handle_500\r\n    return handle_error(request, 500, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 40, in render\r\n    output = self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 166, in render\r\n    values = self.sequence.resolve(context, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 736, in resolve\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 243, in items\r\n2018/04/16 20:50:13 [error] 27#0: *5844 upstream prematurely closed connection while reading response header from upstream, client: <IP>, server: _, request: \"GET / HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"<IP>\"\r\n    return value.items()\r\nAttributeError: 'NoneType' object has no attribute 'items'\r\n[pid: 276|app: 0|req: 395/5085] <IP> () {42 vars in 640 bytes} [Mon Apr 16 20:50:13 2018] GET / => generated 0 bytes in 29 msecs (HTTP/1.1 500) 0 headers in 0 bytes (0 switches on core 0)\r\n<IP> - - [16/Apr/2018:20:50:13 +0000] \"GET / HTTP/1.1\" 502 173 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:59.0) Gecko/20100101 Firefox/59.0\"\r\n2018-04-16 20:50:15,154 ERROR    django.request Internal Server Error: /\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 244, in _legacy_get_response\r\n    response = middleware_method(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/middleware.py\", line 195, in process_request\r\n    executor = MigrationExecutor(connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/executor.py\", line 20, in __init__\r\n    self.loader = MigrationLoader(self.connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 52, in __init__\r\n    self.build_graph()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 209, in build_graph\r\n    self.applied_migrations = recorder.applied_migrations()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 65, in applied_migrations\r\n    self.ensure_schema()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 52, in ensure_schema\r\n    if self.Migration._meta.db_table in self.connection.introspection.table_names(self.connection.cursor()):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 229, in _cursor\r\n    self.ensure_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 189, in connect\r\n    self.connection = self.get_new_connection(conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 176, in get_new_connection\r\n    connection = Database.connect(**conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/psycopg2/__init__.py\", line 130, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\nOperationalError: FATAL:  could not open file \"base/16384/2601\": No such file or directory\r\n\r\n2018-04-16 20:50:15,154 ERROR    django.request Internal Server Error: /\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 244, in _legacy_get_response\r\n    response = middleware_method(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/middleware.py\", line 195, in process_request\r\n    executor = MigrationExecutor(connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/executor.py\", line 20, in __init__\r\n    self.loader = MigrationLoader(self.connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 52, in __init__\r\n    self.build_graph()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 209, in build_graph\r\n    self.applied_migrations = recorder.applied_migrations()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 65, in applied_migrations\r\n    self.ensure_schema()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 52, in ensure_schema\r\n    if self.Migration._meta.db_table in self.connection.introspection.table_names(self.connection.cursor()):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 229, in _cursor\r\n    self.ensure_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 189, in connect\r\n    self.connection = self.get_new_connection(conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 176, in get_new_connection\r\n    connection = Database.connect(**conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/psycopg2/__init__.py\", line 130, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\nOperationalError: FATAL:  could not open file \"base/16384/2601\": No such file or directory\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/wsgi.py\", line 157, in __call__\r\n    response = self.get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 124, in get_response\r\n    response = self._middleware_chain(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 43, in inner\r\n    response = response_for_exception(request, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 93, in response_for_exception\r\n    response = handle_uncaught_exception(request, get_resolver(get_urlconf()), sys.exc_info())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 143, in handle_uncaught_exception\r\n    return callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 88, in handle_500\r\n    return handle_error(request, 500, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 40, in render\r\n    output = self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 166, in render\r\n    values = self.sequence.resolve(context, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 736, in resolve\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 243, in items\r\n    return value.items()\r\nAttributeError: 'NoneType' object has no attribute 'items'\r\n[pid: 276|app: 0|req: 396/5086] <IP> () {42 vars in 640 bytes} [Mon Apr 16 20:50:15 2018] GET / => generated 0 bytes in 29 msecs (HTTP/1.1 500) 0 headers in 0 bytes (0 switches on core 0)\r\n2018/04/16 20:50:15 [error] 27#0: *5844 upstream prematurely closed connection while reading response header from upstream, client: <IP>, server: _, request: \"GET / HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"<IP>\"\r\n<IP> - - [16/Apr/2018:20:50:15 +0000] \"GET / HTTP/1.1\" 502 173 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:59.0) Gecko/20100101 Firefox/59.0\"\r\n2018-04-16 20:50:22,837 ERROR    django.request Internal Server Error: /\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 244, in _legacy_get_response\r\n    response = middleware_method(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/middleware.py\", line 195, in process_request\r\n    executor = MigrationExecutor(connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/executor.py\", line 20, in __init__\r\n    self.loader = MigrationLoader(self.connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 52, in __init__\r\n    self.build_graph()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 209, in build_graph\r\n    self.applied_migrations = recorder.applied_migrations()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 65, in applied_migrations\r\n    self.ensure_schema()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 52, in ensure_schema\r\n    if self.Migration._meta.db_table in self.connection.introspection.table_names(self.connection.cursor()):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 229, in _cursor\r\n    self.ensure_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 189, in connect\r\n    self.connection = self.get_new_connection(conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 176, in get_new_connection\r\n    connection = Database.connect(**conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/psycopg2/__init__.py\", line 130, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\nOperationalError: FATAL:  could not open file \"base/16384/2601\": No such file or directory\r\n\r\n2018-04-16 20:50:22,837 ERROR    django.request Internal Server Error: /\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 244, in _legacy_get_response\r\n    response = middleware_method(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/middleware.py\", line 195, in process_request\r\n    executor = MigrationExecutor(connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/executor.py\", line 20, in __init__\r\n    self.loader = MigrationLoader(self.connection)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 52, in __init__\r\n    self.build_graph()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/loader.py\", line 209, in build_graph\r\n    self.applied_migrations = recorder.applied_migrations()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 65, in applied_migrations\r\n    self.ensure_schema()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/migrations/recorder.py\", line 52, in ensure_schema\r\n    if self.Migration._meta.db_table in self.connection.introspection.table_names(self.connection.cursor()):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 229, in _cursor\r\n    self.ensure_connection()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 213, in ensure_connection\r\n    self.connect()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 189, in connect\r\n    self.connection = self.get_new_connection(conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 176, in get_new_connection\r\n    connection = Database.connect(**conn_params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/psycopg2/__init__.py\", line 130, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\nOperationalError: FATAL:  could not open file \"base/16384/2601\": No such file or directory\r\n\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/wsgi.py\", line 157, in __call__\r\n    response = self.get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 124, in get_response\r\n    response = self._middleware_chain(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 43, in inner\r\n    response = response_for_exception(request, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 93, in response_for_exception\r\n    response = handle_uncaught_exception(request, get_resolver(get_urlconf()), sys.exc_info())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 143, in handle_uncaught_exception\r\n    return callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 88, in handle_500\r\n    return handle_error(request, 500, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 40, in render\r\n    output = self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 166, in render\r\n    values = self.sequence.resolve(context, True)\r\n<IP> - - [16/Apr/2018:20:50:22 +0000] \"GET / HTTP/1.1\" 502 173 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:59.0) Gecko/20100101 Firefox/59.0\"\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 736, in resolve\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 243, in items\r\n    return value.items()\r\nAttributeError: 'NoneType' object has no attribute 'items'\r\n```"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen I use e.g. terraform module with a binary that is downloaded in the same playbook, the credentials I have configured don't get passed to the binary it seems. The same playbook executed on my own machine with the exact same environment variables configured works just fine. In addition dynamic inventory script in AWX that uses the same credentials (OpenStack) also works..\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5\r\n* Operating System: CentOS\r\n* Web Browser: Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Configure openstack credential type on AWX (Built in are broken, I had to create custom ones for it to work) with the following environment vars:\r\n```\r\nOS_USERNAME=user name (can be AD)\r\nOS_PROJECT_NAME=project name\r\nOS_USER_DOMAIN_NAME=user domain name\r\nOS_PROJECT_DOMAIN_NAME=project domain name\r\nOS_AUTH_URL=openstack auth url\r\nOS_AUTH_TYPE=password\r\nOS_IDENTITY_API_VERSION=3\r\nOS_NO_CACHE=True \r\n```\r\n2. Put in your credentials\r\n3. Write a playbook that deploys some infra using terraform with the following tasks:\r\n```\r\n- name: Download terraform\r\n  get_url:\r\n    url: https://releases.hashicorp.com/terraform/{{ terraform_version | default('0.11.7') }}/terraform_{{ terraform_version }}_linux_amd64.zip\r\n    dest: /tmp/terraform-{{terraform_version}}.zip\r\n  when: \"'64' in ansible_architecture and 'Linux' == ansible_system and not stat_terraform.stat.exists and install_terraform\"\r\n\r\n- name: Install unzip to unarchive terraform\r\n  package:\r\n    name: unzip\r\n    state: present\r\n  when: install_terraform and not stat_terraform.stat.exists\r\n\r\n- name: Unpack\r\n  unarchive:\r\n    dest: '{{playbook_dir}}'\r\n    src: /tmp/terraform-{{terraform_version}}.zip\r\n    mode: u+rwx\r\n  when: not stat_terraform.stat.exists and install_terraform\r\n\r\n- name: Check terraform again\r\n  stat:\r\n    path: '{{playbook_dir}}/terraform'\r\n  register: stat_terraform\r\n  when: install_terraform\r\n  failed_when: install_terraform and not stat_terraform.stat.exists\r\n\r\n- name: Lookup tfstate file\r\n  stat:\r\n    path: '{{terraform_path}}/{{infra}}/terraform.tfstate'\r\n  register: stat_tfstate\r\n\r\n- name: Lookup .terraform directory\r\n  stat:\r\n    path: '{{terraform_path}}/{{infra}}/.terraform'\r\n  register: stat_tfmodules\r\n\r\n- name: Init terraform if its downloaded (since force_init is broken in release currently)\r\n  shell: 'pushd {{terraform_path}}/{{infra}} && {{playbook_dir}}/terraform init && popd'\r\n  check_mode: no\r\n  when: not stat_tfmodules.stat.exists and install_terraform\r\n\r\n- name: Init terraform if its in path (since force_init is broken in release currently)\r\n  shell: 'pushd {{terraform_path}}/{{infra}} && terraform init && popd'\r\n  check_mode: no\r\n  when: not stat_tfmodules.stat.exists and not install_terraform\r\n\r\n- name: Run terraform\r\n  terraform:\r\n    binary_path: \"{{install_terraform | ternary(playbook_dir+'/terraform', omit)}}\"\r\n    plan_file: '{{tf_plan | default(omit)}}'\r\n    project_path: '{{terraform_path}}/{{infra}}'\r\n    state_file: '{{stat_tfstate.stat.exists | ternary(stat_tfstate.stat.path, omit)}}'\r\n    variables: '{{terraform_vars | default(omit)}}'\r\n  register: tf_output\r\n  environment:\r\n    # This is not necessary, I think, it does the same thing regardless of me putting these manual lookups in\r\n    OS_USER_DOMAIN_NAME: \"{{lookup('env', 'OS_USER_DOMAIN_NAME')}}\"\r\n    OS_PROJECT_NAME: \"{{lookup('env', 'OS_PROJECT_NAME')}}\"\r\n    OS_IDENTITY_API_VERSION: \"{{lookup('env', 'OS_IDENTITY_API_VERSION')}}\"\r\n    OS_PASSWORD: \"{{lookup('env', 'OS_PASSWORD')}}\"\r\n    OS_AUTH_TYPE: \"{{lookup('env', 'OS_AUTH_TYPE')}}\"\r\n    OS_AUTH_URL: \"{{lookup('env', 'OS_AUTH_URL')}}\"\r\n    OS_USERNAME: \"{{lookup('env', 'OS_USERNAME')}}\"\r\n    OS_NO_CACHE: \"{{lookup('env', 'OS_NO_CACHE')}}\"\r\n    OS_PROJECT_DOMAIN_NAME: \"{{lookup('env', 'OS_PROJECT_DOMAIN_NAME')}}\"\r\n```\r\n4. Deploy infra from your dev machine using the environment vars defined above. It should work.\r\n5. Try to run the same playbook in AWX\r\n##### EXPECTED RESULTS\r\n\r\nInfra is deployed\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`provider.openstack: Authentication failed`\r\n\r\n##### ADDITIONAL INFORMATION\r\nN/A"},{"labels":["api",null,null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThe Python netaddr package is widely used and mentioned as [closely related to Ansible](http://docs.ansible.com/ansible/latest/user_guide/playbooks_filters_ipaddr.html) but is not available in the default venv.  This rules out deploying other major projects including the popular [Kubernetes Kubespray installer](https://github.com/kubernetes-incubator/kubespray/blob/master/README.md).  Could netaddr please be added to the standard AWX task/web docker image virtualenv so that users do not have to maintain a custom Docker build for this one package?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: minikube (Kubernetes)\r\n* Ansible version:  latest\r\n* Operating System: Ubuntu/minikube\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThe feature would be a pip install netaddr into the default venv and would allow for a wider range of playbook compatibility with the default AWX builds.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThis came out of discussion on #1757 \r\nOn update, the object id is not included in any of the fields logged by the ActivityStreamMiddleware, and there is no single field that could be logged to solve the issue for all object types - each type has a separate field in ActivityStream.\r\nOn create and delete, the object id is logged in ActivityStream.changes, as `get_allowed_fields` in `model_to_dict` (which populates changes) includes the id for all object types. On associate/dissociate, objtect1_pk and object2_pk are included in changes. So only update is missing the id.\r\n\r\n#1757 Fixes this problem for Setting by logging ActivityStream.setting, but a more general solution is needed.\r\nA few ideas:\r\n- Include the object id in the changes field as in the case of create, delete, and associate/dissociate. ActivityStream.changes comes from `model_instance_diff`, which could easily be modified for this, but it could break any tools that depend on ActivityStream.changes to be only values that changed in the case of an update.\r\n- Make the change in the middleware - log an object1_pk field and object2_pk  determined from the appropriate ManyToManyFIeld in ActivityStream. This wouldn't work for Setting, as ActivityStream doesn't maintain a relation to the Setting object that was updated.\r\n- Switch to GenericForeignKeys or add object1_id/object2_id back to ActivityStream (they were removed in 61059fa1a4bd93f881eccf16d5f703bd8625ce74)\r\n\r\nFor all of the solutions above (except GenericForeignKey), I would recommend still logging the ActivityStream.setting field in the middleware OR finding a solution that logs Setting.key as part of the ActivityStream log, as this would make compliance easier. Currently, `model_to_dict` (which is used for ActivityStream.changes on create/delete) does not include Setting.key because it is a read-only field in the serializer. (See `get_allowed_fields`).\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5.22\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.0\r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n- Setup external logging to include activity_stream\r\n- Change a JobTemplate or Setting\r\n- Notice the activity stream logs doesn't include the id of the object changed (see actual results)\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n- The object id should be present for all ActivityStream logs.\r\n- The Setting key should be present for all settings creation/changes/deletion\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nFor JobTemplate update:\r\n```\r\n{\"cluster_host_id\": \"awx\", \r\n\"relationship\": \"\", \r\n\"level\": \"INFO\", \r\n\"type\": \"splunk\", \r\n\"@timestamp\": \"2018-04-11T22:49:16.160Z\", \r\n\"host\": \"awxweb\", \r\n\"actor\": \"admin\", \r\n\"object1\": \"job_template\", \r\n\"object2\": \"\",\r\n\"logger_name\": \"awx.analytics.activity_stream\", \r\n\"message\": \"Activity Stream update entry for job_template\", \r\n\"changes\": \"{\\\"description\\\": [\\\"\\\", \\\"TEST\\\"]}\", \r\n\"operation\": \"update\"}\r\n```\r\n\r\nFor Setting update\r\n```\r\n{\"cluster_host_id\": \"awx\",\r\n\"relationship\": \"\",\r\n\"level\": \"INFO\",\r\n\"type\": \"splunk\",\r\n\"@timestamp\": \"2018-04-11T19:15:22.352Z\",\r\n\"host\": \"awxweb\",\r\n\"actor\": \"admin\",\r\n\"object1\": \"setting\",\r\n\"object2\": \"\",\r\n\"logger_name\": \"awx.analytics.activity_stream\",\r\n\"message\": \"Activity Stream update entry for setting\",\r\n\"changes\": \"{\\\"value\\\": [30, 31]}\",\r\n\"operation\": \"update\"}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThis might be considered a bug, as it breaks auditing compliance."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWe have a customer that needs to manage the RSA key that we distribute to all \"isolated\" nodes  (isolated_key_generation=false), but the isolated nodes only accepts SSH keys without passphrase.\r\n\r\n##### EXPECTED RESULTS\r\nAllowing password phrase to ssh keys for isolated node\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nEnabling radius authentication causes error and locks out all users including admin\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.5.0 and devel (1.5.23)\r\n* AWX install method: docker on linux, docker for mac\r\n* Ansible version:  2.5.0\r\n* Operating System: Linux - Docker\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn Settings->Authentication->Radius set a hostname/port/secret\r\n\r\n##### EXPECTED RESULTS\r\n\r\nRadius auth would work or at least the admin user would be able to log in\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAll users locked out.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSetting django-radius==1.1.0 in requirements instead of 1.3.3 allows radius auth to work. (Introduced in https://github.com/ansible/awx/commit/556e6c4a117597fc36fdab53b32a4e29ed494a34 )\r\n\r\nError log:\r\n2018-04-12 02:41:38,386 ERROR    django.request Internal Server Error: /api/login/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/debug.py\", line 76, in sensitive_post_parameters_wrapper\r\n    return view(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 149, in _wrapped_view\r\n    response = view_func(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/cache.py\", line 57, in _wrapped_view_func\r\n    response = view_func(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/views.py\", line 90, in dispatch\r\n    return super(LoginView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 88, in dispatch\r\n    return handler(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 67, in post\r\n    ret = super(LoggedLoginView, self).post(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/edit.py\", line 182, in post\r\n    if form.is_valid():\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/forms/forms.py\", line 183, in is_valid\r\n    return self.is_bound and not self.errors\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/forms/forms.py\", line 175, in errors\r\n    self.full_clean()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/forms/forms.py\", line 385, in full_clean\r\n    self._clean_form()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/forms/forms.py\", line 412, in _clean_form\r\n    cleaned_data = self.clean()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/forms.py\", line 187, in clean\r\n    self.user_cache = authenticate(self.request, username=username, password=password)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 70, in authenticate\r\n    user = _authenticate_with_backend(backend, backend_path, request, credentials)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 116, in _authenticate_with_backend\r\n    return backend.authenticate(*args, **credentials)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/backends.py\", line 191, in authenticate\r\n    return super(RADIUSBackend, self).authenticate(username, password)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/radiusauth/backends/radius.py\", line 178, in authenticate\r\n    result = self._radius_auth(server, username, password)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/radiusauth/backends/radius.py\", line 146, in _radius_auth\r\n    packet = self._get_auth_packet(username, password, client)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/radiusauth/backends/radius.py\", line 82, in _get_auth_packet\r\n    pkt[\"User-Password\"] = pkt.PwCrypt(password)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/pyrad/packet.py\", line 500, in PwCrypt\r\n    if len(password) % 16 != 0:\r\nTypeError: object of type 'NoneType' has no len()\r\n"},{"labels":["api",null,null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nBe able to run a Scheduled / Delayed job chained to a Workflow.\r\n\r\nUse Case Workflow:\r\n-  _Run Playbook 1 (patch  Server1)_\r\n-  _On Success,  Run Playbook 2 **once at 3AM** (reboot Server1 during a planned maintenance window)_\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n"},{"labels":["api",null,null,null],"text":"\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nPOST Requests to AWX API do not check the Connect-Type of an incoming request to ensure it's type is \"application/json\"\r\n\r\nWhen post requests are not a valid json POST request, the API returns a 500.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.130\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: CentOS 7.4.1708\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n````\r\n#!/usr/bin/env python\r\n\r\nimport requests\r\n\r\nurl = \"http://<SERVER>/api/v2/inventories/\"\r\nauth_username = \"USERNAME\"\r\nauth_password = 'PASSWORD'\r\n\r\npayload = {'name': 'TEST', 'organization': 1}\r\nr = requests.post(url, auth=(auth_username, auth_password), **data=payload**)\r\nprint(r.text)\r\nheader = r.headers\r\nprint(header.get('content-type'))\r\nif not r.ok:\r\n    r.raise_for_status()\r\n````\r\n\r\ntcpdump of the host connecting to the server performing the post.\r\n````\r\ntcpdump -Anni host <client> <server>\r\n11:41:10.875386 IP <CLIENT>.59564 > <SERVER>.80: Flags [P.], seq 1:313, ack 1, win 229, options [nop,nop,TS val 3600715861 ecr 1364901405], length 312: HTTP: POST /api/v2/inventories/ HTTP/1.1\r\nE..l..@.@...\r\n..2\r\n.B....PW.B.UP.P...........\r\n...UQZ..POST /api/v2/inventories/ HTTP/1.1\r\nHost: 10.173.66.225\r\nConnection: keep-alive\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nUser-Agent: python-requests/2.18.4\r\nContent-Length: 24\r\n**Content-Type: application/x-www-form-urlencoded**\r\nAuthorization: Basic xxxxxxxxxxx\r\n````\r\n\r\n##### EXPECTED RESULTS\r\n````\r\n#!/usr/bin/env python\r\n\r\nimport requests\r\n\r\nurl = \"http://<SERVER>/api/v2/inventories/\"\r\nauth_username = \"USERNAME\"\r\nauth_password = 'PASSWORD'\r\n\r\nr = requests.post(url, auth=(auth_username, auth_password), **json=payload**)\r\nprint(r.text)\r\nheader = r.headers\r\nprint(header.get('content-type'))\r\n````\r\n````\r\n11:41:10.925813 IP CLIENT.59566 > SERVER.80: Flags [P.], seq 1:307, ack 1, win 229, options [nop,nop,TS val 3600715912 ecr 1364901455], length 306: HTTP: POST /api/v2/inventories/ HTTP/1.1\r\nE..f.j@.@.w.\r\n..2\r\n.B....P._\r\n..`.............\r\n....QZ.OPOST /api/v2/inventories/ HTTP/1.1\r\nHost: SERVER\r\nConnection: keep-alive\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nUser-Agent: python-requests/2.18.4\r\nContent-Length: 35\r\n**Content-Type: application/json**\r\nAuthorization: Basic xxxxxxxxxx\r\n\r\n{\"organization\": 1, \"name\": \"TEST\"}\r\n````\r\nReturns a valid response.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n````\r\nrequests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://SERVER/api/v2/inventories/\r\n````\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - AWX \"web\" docker image\r\n\r\n##### SUMMARY\r\nMercurial projects cannot be cloned when the remote server is hosting multiple SSL certificates via SNI. All certificates are LetsEncrypt signed and currently valid.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.0\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Host an Ansible Project or a role in a mercurial repository on a server providing multiple SSL certificates via SNI\r\n* Define a Project or also a dependency on a role in a roles/requirements.yml file\r\n* Try an inventory update from the interface, or run `hg clone` for the same repository inside the web container\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe mercurial repository is correctly cloned.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe clone operation cannot complete because of a certificate error:\r\n```\r\n[root@5caa6406da47 /]# hg clone https://user:password@a.example.com/rolename\r\nabort: a.example.com certificate error: certificate is for b.example.com\r\n(configure hostfingerprint <fingerprint> or use --insecure to connect insecurely)\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe problem can be solved by installing mercurial 3.3.0+ inside the container, i.e. via `pip`:\r\nhttps://www.mercurial-scm.org/wiki/WhatsNew/Archive#Mercurial_3.0_.282014-05-01.29\r\n> * https: support tls sni (server name indication) for https urls (issue3090)\r\n\r\nPresumably in https://github.com/ansible/awx/blob/1595947ae2b87756ecac0124bf1ba7823ee20285/installer/roles/image_build/files/Dockerfile.sdist ?"},{"labels":["api",null,null,null],"text":"\r\n\r\n##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n - Installer\r\n\r\n##### SUMMARY\r\nrunning the command  (in awx_task container) -  \"awx-manage print_settings\"\r\n\r\ncrashes out with errors -\r\n\r\n2018-04-10 13:09:00,615 WARNING  awx.conf.settings The current value \"u'MemberDNGroupType'\" for setting \"AUTH_LDAP_1_GROUP_TYPE\" is invalid.\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 372, in _get_local\r\n    return field.run_validation(value)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 523, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/fields.py\", line 401, in to_internal_value\r\n    return cls(**params_sanitized)\r\nTypeError: __init__() takes at least 2 arguments (2 given)\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx==1.0.5.11', 'console_scripts', 'awx-manage')()\r\n  File \"/usr/lib/python2.7/site-packages/awx/__init__.py\", line 109, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django_extensions/management/utils.py\", line 59, in inner\r\n    ret = func(self, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django_extensions/management/commands/print_settings.py\", line 49, in handle\r\n    value = getattr(settings, attr)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 479, in __getattr_without_cache__\r\n    return getattr(self._wrapped, name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 395, in __getattr__\r\n    return self._get_default(name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 382, in _get_default\r\n    return getattr(self.default_settings, name)\r\nAttributeError: 'Settings' object has no attribute 'AUTH_LDAP_1_GROUP_TYPE'\r\n\r\n\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5.11\r\n* AWX install method:  docker on linux, \r\n* Ansible version:  2.5.0\r\n* Operating System: RHEL 7.4\r\n* Web Browser: Chrome 10\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nrun bash in awx_task container\r\n\r\nrun command awx-manage print_settings\r\n\r\n##### EXPECTED RESULTS\r\n\r\noutput of awx settings\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n2018-04-10 13:09:00,615 WARNING  awx.conf.settings The current value \"u'MemberDNGroupType'\" for setting \"AUTH_LDAP_1_GROUP_TYPE\" is invalid.\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 372, in _get_local\r\n    return field.run_validation(value)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 523, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/fields.py\", line 401, in to_internal_value\r\n    return cls(**params_sanitized)\r\nTypeError: __init__() takes at least 2 arguments (2 given)\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx==1.0.5.11', 'console_scripts', 'awx-manage')()\r\n  File \"/usr/lib/python2.7/site-packages/awx/__init__.py\", line 109, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django_extensions/management/utils.py\", line 59, in inner\r\n    ret = func(self, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django_extensions/management/commands/print_settings.py\", line 49, in handle\r\n    value = getattr(settings, attr)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 479, in __getattr_without_cache__\r\n    return getattr(self._wrapped, name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 395, in __getattr__\r\n    return self._get_default(name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 382, in _get_default\r\n    return getattr(self.default_settings, name)\r\nAttributeError: 'Settings' object has no attribute 'AUTH_LDAP_1_GROUP_TYPE'\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nLooking in the api - we haven't got the AUTH_LDAP_1 settings defined ( we do have AUTH_LDAP) -\r\n\r\n \"AUTH_LDAP_1_SERVER_URI\": \"\",\r\n    \"AUTH_LDAP_1_BIND_DN\": \"\",\r\n    \"AUTH_LDAP_1_BIND_PASSWORD\": \"\",\r\n    \"AUTH_LDAP_1_START_TLS\": false,\r\n    \"AUTH_LDAP_1_CONNECTION_OPTIONS\": {\r\n        \"OPT_NETWORK_TIMEOUT\": 30,\r\n        \"OPT_REFERRALS\": 0\r\n    },\r\n    \"AUTH_LDAP_1_USER_SEARCH\": [],\r\n    \"AUTH_LDAP_1_USER_DN_TEMPLATE\": null,\r\n    \"AUTH_LDAP_1_USER_ATTR_MAP\": {},\r\n    \"AUTH_LDAP_1_GROUP_SEARCH\": [],\r\n    \"AUTH_LDAP_1_GROUP_TYPE\": \"MemberDNGroupType\",\r\n    \"AUTH_LDAP_1_GROUP_TYPE_PARAMS\": {\r\n        \"name_attr\": \"cn\"\r\n    },\r\n    \"AUTH_LDAP_1_REQUIRE_GROUP\": null,\r\n    \"AUTH_LDAP_1_DENY_GROUP\": null,\r\n    \"AUTH_LDAP_1_USER_FLAGS_BY_GROUP\": {},\r\n    \"AUTH_LDAP_1_ORGANIZATION_MAP\": {},\r\n    \"AUTH_LDAP_1_TEAM_MAP\": {},\r\n    \"AUTH_LDAP_2_SERVER_URI\": \"\",\r\n    \"AUTH_LDAP_2_BIND_DN\": \"\",\r\n    \"AUTH_LDAP_2_BIND_PASSWORD\": \"\",\r\n    \"AUTH_LDAP_2_START_TLS\": false,\r\n    \"AUTH_LDAP_2_CONNECTION_OPTIONS\": {\r\n        \"OPT_NETWORK_TIMEOUT\": 30,\r\n        \"OPT_REFERRALS\": 0\r\n    },\r\n    \"AUTH_LDAP_2_USER_SEARCH\": [],\r\n    \"AUTH_LDAP_2_USER_DN_TEMPLATE\": null,\r\n    \"AUTH_LDAP_2_USER_ATTR_MAP\": {},\r\n    \"AUTH_LDAP_2_GROUP_SEARCH\": [],\r\n    \"AUTH_LDAP_2_GROUP_TYPE\": \"MemberDNGroupType\",\r\n    \"AUTH_LDAP_2_GROUP_TYPE_PARAMS\": {\r\n        \"name_attr\": \"cn\"\r\n    },\r\n    \"AUTH_LDAP_2_REQUIRE_GROUP\": null,\r\n    \"AUTH_LDAP_2_DENY_GROUP\": null,\r\n    \"AUTH_LDAP_2_USER_FLAGS_BY_GROUP\": {},\r\n    \"AUTH_LDAP_2_ORGANIZATION_MAP\": {},\r\n    \"AUTH_LDAP_2_TEAM_MAP\": {},\r\n    \"AUTH_LDAP_3_SERVER_URI\": \"\",\r\n    \"AUTH_LDAP_3_BIND_DN\": \"\",\r\n    \"AUTH_LDAP_3_BIND_PASSWORD\": \"\",\r\n    \"AUTH_LDAP_3_START_TLS\": false,\r\n    \"AUTH_LDAP_3_CONNECTION_OPTIONS\": {\r\n        \"OPT_NETWORK_TIMEOUT\": 30,\r\n        \"OPT_REFERRALS\": 0\r\n    },\r\n    \"AUTH_LDAP_3_USER_SEARCH\": [],\r\n    \"AUTH_LDAP_3_USER_DN_TEMPLATE\": null,\r\n    \"AUTH_LDAP_3_USER_ATTR_MAP\": {},\r\n    \"AUTH_LDAP_3_GROUP_SEARCH\": [],\r\n    \"AUTH_LDAP_3_GROUP_TYPE\": \"MemberDNGroupType\",\r\n    \"AUTH_LDAP_3_GROUP_TYPE_PARAMS\": {\r\n        \"name_attr\": \"cn\"\r\n    },\r\n    \"AUTH_LDAP_3_REQUIRE_GROUP\": null,\r\n    \"AUTH_LDAP_3_DENY_GROUP\": null,\r\n    \"AUTH_LDAP_3_USER_FLAGS_BY_GROUP\": {},\r\n    \"AUTH_LDAP_3_ORGANIZATION_MAP\": {},\r\n    \"AUTH_LDAP_3_TEAM_MAP\": {},\r\n    \"AUTH_LDAP_4_SERVER_URI\": \"\",\r\n    \"AUTH_LDAP_4_BIND_DN\": \"\",\r\n    \"AUTH_LDAP_4_BIND_PASSWORD\": \"\",\r\n    \"AUTH_LDAP_4_START_TLS\": false,\r\n    \"AUTH_LDAP_4_CONNECTION_OPTIONS\": {\r\n        \"OPT_NETWORK_TIMEOUT\": 30,\r\n        \"OPT_REFERRALS\": 0\r\n    },\r\n    \"AUTH_LDAP_4_USER_SEARCH\": [],\r\n    \"AUTH_LDAP_4_USER_DN_TEMPLATE\": null,\r\n    \"AUTH_LDAP_4_USER_ATTR_MAP\": {},\r\n    \"AUTH_LDAP_4_GROUP_SEARCH\": [],\r\n    \"AUTH_LDAP_4_GROUP_TYPE\": \"MemberDNGroupType\",\r\n    \"AUTH_LDAP_4_GROUP_TYPE_PARAMS\": {\r\n        \"name_attr\": \"cn\"\r\n    },\r\n    \"AUTH_LDAP_4_REQUIRE_GROUP\": null,\r\n    \"AUTH_LDAP_4_DENY_GROUP\": null,\r\n    \"AUTH_LDAP_4_USER_FLAGS_BY_GROUP\": {},\r\n    \"AUTH_LDAP_4_ORGANIZATION_MAP\": {},\r\n    \"AUTH_LDAP_4_TEAM_MAP\": {},\r\n    \"AUTH_LDAP_5_SERVER_URI\": \"\",\r\n    \"AUTH_LDAP_5_BIND_DN\": \"\",\r\n    \"AUTH_LDAP_5_BIND_PASSWORD\": \"\",\r\n    \"AUTH_LDAP_5_START_TLS\": false,\r\n    \"AUTH_LDAP_5_CONNECTION_OPTIONS\": {\r\n        \"OPT_NETWORK_TIMEOUT\": 30,\r\n        \"OPT_REFERRALS\": 0\r\n    },\r\n    \"AUTH_LDAP_5_USER_SEARCH\": [],\r\n    \"AUTH_LDAP_5_USER_DN_TEMPLATE\": null,\r\n    \"AUTH_LDAP_5_USER_ATTR_MAP\": {},\r\n    \"AUTH_LDAP_5_GROUP_SEARCH\": [],\r\n    \"AUTH_LDAP_5_GROUP_TYPE\": \"MemberDNGroupType\",\r\n    \"AUTH_LDAP_5_GROUP_TYPE_PARAMS\": {\r\n        \"name_attr\": \"cn\"\r\n    },\r\n    \"AUTH_LDAP_5_REQUIRE_GROUP\": null,\r\n    \"AUTH_LDAP_5_DENY_GROUP\": null,\r\n    \"AUTH_LDAP_5_USER_FLAGS_BY_GROUP\": {},\r\n    \"AUTH_LDAP_5_ORGANIZATION_MAP\": {},\r\n    \"AUTH_LDAP_5_TEAM_MAP\": {}\r\n}\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n- UI\r\n- API\r\n\r\n##### SUMMARY\r\nCustomer would like to be able to add/skip tags in the workflow editor in addition to individual job templates\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - Installer\r\n\r\n##### SUMMARY\r\nCurrently the [documentation](http://docs.ansible.com/ansible-tower/latest/html/administration/backup_restore.html) for tower's backup and restore feature says to use a script `setup.sh` but it is not clear where that script when using AWX.\r\n\r\nPlease can documentation be provided for backing up and restoring an AWX instance.\r\n"},{"labels":["api",null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nOffer option for Slack notifications to include a thread timestamp so that notifications can reply to a specific thread. More details on Slack threaded messages/replies [here](https://api.slack.com/docs/message-threading)\r\n\r\n##### ENVIRONMENT\r\nN/A\r\n\r\n##### STEPS TO REPRODUCE\r\nWhen setting up a Destination Channel, user will be able to include a message timestamp that the notification will reply to.\r\n\r\nFor example:\r\n\r\ntest-channel,1482960137.003543\r\n\r\nIf the user chooses not to use the timestamp, then should fall back to replying to the channel listed.\r\n\r\n##### ADDITIONAL INFORMATION\r\nHi there, I've included some quick changes that I think would enable this feature. I have them in this branch compare here: https://github.com/ansible/awx/compare/devel...traytonwhite:notifications/slack/add_thread_timestamp\r\n\r\nI didn't want to open a PR on this quite yet since I'm not sure if this is the best way forward for this type of change."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n- Bug Report\r\n\r\n##### COMPONENT NAME\r\n- UI\r\n- Installer\r\n\r\n##### SUMMARY\r\nThere are references in the documentation that AWX should be using ansible as installed in ``/var/lib/awx/venv/ansible`` but it's actually using ``/usr/bin/ansible-playbook`` with the ``/usr/bin/python2`` interpreter.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: awx==1.0.5.22\r\n* AWX install method: ``docker-compose up`` from [geerlingguy](https://github.com/geerlingguy/awx-container)\r\n* Ansible version: ansible==2.5.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWhen the AWX instance is up with the demo template, edit the template to use the scm from here instead: https://github.com/dmsimard/ansible-tower-samples\r\n\r\nIt's a simple playbook edit that prints the value of the ``ansible_playbook_python`` variable.\r\nThis will return ``/usr/bin/python2``.\r\n\r\nAdditionally, you can also look at the shebang of the ``/usr/bin/ansible-playbook`` file, you'll see:\r\n```\r\n#!/usr/bin/python2\r\n# (c) 2012, Michael DeHaan <michael.dehaan@gmail.com>\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe documentation appears to reference ``/var/lib/awx/venv/ansible`` as where ansible runs from, i.e:\r\n- https://github.com/ansible/awx/blob/devel/docs/custom_virtualenvs.md\r\n- http://docs.ansible.com/ansible-tower/latest/html/administration/tipsandtricks.html#using-virtualenv-with-at\r\n\r\nBut in fact, that doesn't appear to be the case as shown in the reproducer.\r\nThis feels like either a bug or perhaps the documentation is outdated.\r\n\r\nI know AWX provides the ability to create a virtualenv and you can select it manually when doing templates but that's a bit bothersome.\r\n\r\nI would like to have the ability to install something for the python interpreter ansible/awx uses by default without having to install it system-wide -- because right now ansible/awx uses the system python interpreter and libraries.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nI'm getting ``/usr/bin/python2`` as the interpreter so installing things in ``/var/lib/awx/venv/ansible`` are not effective since ansible will seek things in ``/usr/lib/python2.7/site-packages`` instead.\r\n"},{"labels":["api",null,null,null],"text":"\r\n##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWhen trying to relaunch a failed job an error pops up but another user can re-launch the job even though we have the same permissions. \r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.124\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0 \r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Chrome 65.0.3325.181 (Official Build) (64-bit) (MAC)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Launch a job.\r\n2. Job fails, then click on the Rocket to relaunch with same variables. \r\n3. Error opens with: \r\n\r\n![Error](https://i.imgur.com/TjHnYJP.png)\r\n\r\n4. When the original user who created the AWX instance clicks the same button it re-launches but with parallel jobs like so:\r\n\r\n![Dual Jobs](https://i.imgur.com/Apnyu3Q.png)\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1. Just re-launches job with the same variables as expected. \r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\n1. Error box opens with: \r\n\r\n![Error](https://i.imgur.com/TjHnYJP.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\nNone."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nWhen creating a workflow with several templates that have prompt on launch enabled for extra-vars it will not prompt when starting your workflow.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.0\r\n* Operating System: Linux\r\n* Web Browser: Firefox 59.0.2\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create 2 job templates with extra-variables `prompt on launch` enabled \r\n2. Create a workflow template and add your newly created job templates\r\n3. Launch your workflow template\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA prompt for extra-variables\r\n\r\n##### ACTUAL RESULTS\r\nWorkflow executed the template, but did not prompt me for extra-variables.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCurrently Slack notification just contain Ansible Template name ,job id and information regarding job result. I would like an ability to manipulate slack message or notification .\r\nWe just have single template which can run thing according to variables and I would really like to get information regarding those variables in my slack message.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently, when an Ansible task specifies `no_log`, the summary output in AWX is not as explicit about this as it should be. Particularly with tasks with multiple items, we see output like\r\n```\r\nTASK [foreman_proxy : Slurp cert content for installation on the proxy] ********\r\n14:16:04\r\nok: [foreman-sp.<domain>] => (item=None)\r\nok: [foreman-sp.<domain>] => (item=None)\r\nok: [foreman-sp.<domain>] => (item=None)\r\n```\r\nWhen clicked, it explains as follows:\r\n```\r\n{\r\n    \"censored\": \"the output has been hidden due to the fact that 'no_log: true' was specified for this result\"\r\n}\r\n```\r\n\r\nIt would be clearer if the summary log added `<CENSORED>` or a similar marker for identifying at a glance why there is no information in the log.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.75\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: Mac\r\n* Web Browser: Firefox\r\n"},{"labels":["api",null,null,null,null],"text":"This conflicts with the same name used by the tower credential type\r\n\r\nhttps://github.com/ansible/awx/blob/d685815478b813d669dd55c248392a8eecb97923/awx/main/models/credential/__init__.py#L1194\r\n\r\nWe will be asking all playbook authors to change any environment var reference from `TOWER_HOST` to `AWX_HOST`, which has the same value."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n \r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen I execute a template, ad-hoc command or even sync a project with SCM the standard out is blank with a spinning indicator saying \"working....\" even though the job has failed or completed successfully.  If I refresh I can download the logs, but still does not show in the UI.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.0\r\n* Operating System: Centos 7.4\r\n* Web Browser: Firefox 59.0.2\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create new Projects and setup with Private Github project and don't enter any credentials\r\n2. Sync process kicks off and fails.\r\n3. No standard out appears\r\n4. Refresh page and click download logs icon\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTo be able to see the standard out from the UI.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nBlank Standard Out with no error message\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI tried to retry the job and it shows the standard out.\r\n"},{"labels":["api",null,null,null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAfter adding a new project, the project pull job stays with status 'Pending'. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: Code taken from opensource late in Nov 2016 and built locally. \r\n* AWX install method: docker-compose and deployed to kubernetes. \r\n* Ansible version:  2.4.2.0\r\n* Operating System: Windows 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n1. The AWX project was working fine in Dev server. We developers, moved on to build the image with SSL, Vanity URLs etc. Deployed again (in the meantime, our kubernetes clusters got upgraded.). Now, when I test the UI, the job stays at pending state. \r\n- \r\n![image](https://user-images.githubusercontent.com/26941146/38270794-207877ac-374a-11e8-915b-eae5c40dec1a.png)\r\n\r\n\r\n- <CompanyTowerHost>/api/v2/instances/ ==> shows count 57. \r\n- <CompanyTowerHost>/api/v2/unified_jobs/?status=running ==> shows count 0.\r\n\r\nAny help is much appreciated as my prod deployment got stopped after finding this issue. It was working fine before 2 months. And I don't see clearly what might have caused the issue. \r\nThe changes were minimal, like Adding Vanity URLs, Enabling SSL, etc. \r\nThen, the kubernetes cluster got upgraded too. \r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nProjects can be pulled with no issue. \r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n1. Projects staying in waiting status. \r\n2. If I try to manually create project, i see project ROOT as /projects/\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nawx-web-devel image has no error log\r\nand awx-rabbit has no error log. \r\nIt is the UI that stays in 'Waiting' status while trying to run the clean/update job of the project. \r\n\r\nWill be watching actively and can provide more info if needed. \r\nThank you. "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe unified job serializer changes from list view to detail view\r\n\r\nbut some unified job list views use the detail view serializer\r\n\r\n##### ENVIRONMENT\r\n* AWX version: \r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGET `/api/v2/unified_jobs/?order_by=id`\r\n\r\nGET `/api/v2/instance_groups/1/jobs/`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSame serialization\r\n\r\n##### ACTUAL RESULTS\r\n\r\nDifferent serialization\r\n\r\nentry in unified jobs:\r\n\r\n```json\r\n        {\r\n            \"id\": 1,\r\n            \"type\": \"project_update\",\r\n            \"url\": \"/api/v2/project_updates/1/\",\r\n            \"related\": {\r\n                \"created_by\": \"/api/v2/users/1/\",\r\n                \"unified_job_template\": \"/api/v2/projects/4/\",\r\n                \"stdout\": \"/api/v2/project_updates/1/stdout/\",\r\n                \"project\": \"/api/v2/projects/4/\",\r\n                \"cancel\": \"/api/v2/project_updates/1/cancel/\",\r\n                \"notifications\": \"/api/v2/project_updates/1/notifications/\",\r\n                \"scm_inventory_updates\": \"/api/v2/project_updates/1/scm_inventory_updates/\",\r\n                \"events\": \"/api/v2/project_updates/1/events/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"instance_group\": {\r\n                    \"id\": 1,\r\n                    \"name\": \"tower\"\r\n                },\r\n                \"unified_job_template\": {\r\n                    \"id\": 4,\r\n                    \"name\": \"AlanCoding permission testing playbooks\",\r\n                    \"description\": \"\",\r\n                    \"unified_job_type\": \"project_update\"\r\n                },\r\n                \"project\": {\r\n                    \"id\": 4,\r\n                    \"name\": \"AlanCoding permission testing playbooks\",\r\n                    \"description\": \"\",\r\n                    \"status\": \"successful\",\r\n                    \"scm_type\": \"git\"\r\n                },\r\n                \"created_by\": {\r\n                    \"id\": 1,\r\n                    \"username\": \"admin\",\r\n                    \"first_name\": \"\",\r\n                    \"last_name\": \"\"\r\n                },\r\n                \"user_capabilities\": {\r\n                    \"start\": true,\r\n                    \"delete\": true\r\n                }\r\n            },\r\n            \"created\": \"2018-03-01T18:28:22.423893Z\",\r\n            \"modified\": \"2018-03-01T18:28:23.682479Z\",\r\n            \"name\": \"AlanCoding permission testing playbooks\",\r\n            \"description\": \"\",\r\n            \"unified_job_template\": 4,\r\n            \"launch_type\": \"manual\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false,\r\n            \"started\": \"2018-03-01T18:28:23.761650Z\",\r\n            \"finished\": \"2018-03-01T18:28:31.286606Z\",\r\n            \"elapsed\": 7.525,\r\n            \"job_explanation\": \"\",\r\n            \"execution_node\": \"awx\",\r\n            \"local_path\": \"_4__alancoding_permission_testing_playbooks\",\r\n            \"scm_type\": \"git\",\r\n            \"scm_url\": \"https://github.com/AlanCoding/permission-testing-playbooks.git\",\r\n            \"scm_branch\": \"\",\r\n            \"scm_clean\": false,\r\n            \"scm_delete_on_update\": false,\r\n            \"credential\": null,\r\n            \"timeout\": 0,\r\n            \"project\": 4,\r\n            \"job_type\": \"check\"\r\n        },\r\n```\r\n\r\nentry for same object in the instance job list\r\n\r\n```json\r\n        {\r\n            \"id\": 1,\r\n            \"type\": \"project_update\",\r\n            \"url\": \"/api/v2/project_updates/1/\",\r\n            \"related\": {\r\n                \"created_by\": \"/api/v2/users/1/\",\r\n                \"unified_job_template\": \"/api/v2/projects/4/\",\r\n                \"stdout\": \"/api/v2/project_updates/1/stdout/\",\r\n                \"project\": \"/api/v2/projects/4/\",\r\n                \"cancel\": \"/api/v2/project_updates/1/cancel/\",\r\n                \"notifications\": \"/api/v2/project_updates/1/notifications/\",\r\n                \"scm_inventory_updates\": \"/api/v2/project_updates/1/scm_inventory_updates/\",\r\n                \"events\": \"/api/v2/project_updates/1/events/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"instance_group\": {\r\n                    \"id\": 1,\r\n                    \"name\": \"tower\"\r\n                },\r\n                \"unified_job_template\": {\r\n                    \"id\": 4,\r\n                    \"name\": \"AlanCoding permission testing playbooks\",\r\n                    \"description\": \"\",\r\n                    \"unified_job_type\": \"project_update\"\r\n                },\r\n                \"project\": {\r\n                    \"id\": 4,\r\n                    \"name\": \"AlanCoding permission testing playbooks\",\r\n                    \"description\": \"\",\r\n                    \"status\": \"successful\",\r\n                    \"scm_type\": \"git\"\r\n                },\r\n                \"created_by\": {\r\n                    \"id\": 1,\r\n                    \"username\": \"admin\",\r\n                    \"first_name\": \"\",\r\n                    \"last_name\": \"\"\r\n                },\r\n                \"user_capabilities\": {\r\n                    \"start\": true,\r\n                    \"delete\": true\r\n                }\r\n            },\r\n            \"created\": \"2018-03-01T18:28:22.423893Z\",\r\n            \"modified\": \"2018-03-01T18:28:23.682479Z\",\r\n            \"name\": \"AlanCoding permission testing playbooks\",\r\n            \"description\": \"\",\r\n            \"local_path\": \"_4__alancoding_permission_testing_playbooks\",\r\n            \"scm_type\": \"git\",\r\n            \"scm_url\": \"https://github.com/AlanCoding/permission-testing-playbooks.git\",\r\n            \"scm_branch\": \"\",\r\n            \"scm_clean\": false,\r\n            \"scm_delete_on_update\": false,\r\n            \"credential\": null,\r\n            \"timeout\": 0,\r\n            \"unified_job_template\": 4,\r\n            \"launch_type\": \"manual\",\r\n            \"status\": \"successful\",\r\n            \"failed\": false,\r\n            \"started\": \"2018-03-01T18:28:23.761650Z\",\r\n            \"finished\": \"2018-03-01T18:28:31.286606Z\",\r\n            \"elapsed\": 7.525,\r\n            \"job_args\": \"[\\\"bwrap\\\", \\\"--unshare-pid\\\", \\\"--dev-bind\\\", \\\"/\\\", \\\"/\\\", \\\"--proc\\\", \\\"/proc\\\", \\\"--bind\\\", \\\"/tmp/awx_proot_czV4Y1/tmpBJoU_r\\\", \\\"/awx_devel/awx/job_status\\\", \\\"--bind\\\", \\\"/tmp/awx_proot_czV4Y1/tmpACzZxq\\\", \\\"/projects\\\", \\\"--bind\\\", \\\"/tmp/awx_proot_czV4Y1/tmpoWioq9\\\", \\\"/tmp\\\", \\\"--bind\\\", \\\"/tmp/awx_proot_czV4Y1/tmp4GYrK5\\\", \\\"/var/lib/awx\\\", \\\"--bind\\\", \\\"/tmp/awx_proot_czV4Y1/tmpfT58jF\\\", \\\"/var/log\\\", \\\"--ro-bind\\\", \\\"/venv/ansible\\\", \\\"/venv/ansible\\\", \\\"--ro-bind\\\", \\\"/venv/awx\\\", \\\"/venv/awx\\\", \\\"--bind\\\", \\\"/awx_devel/awx/playbooks\\\", \\\"/awx_devel/awx/playbooks\\\", \\\"--bind\\\", \\\"/projects\\\", \\\"/projects\\\", \\\"--bind\\\", \\\"/tmp/awx_1_lp0t6B\\\", \\\"/tmp/awx_1_lp0t6B\\\", \\\"--chdir\\\", \\\"/awx_devel/awx/playbooks\\\", \\\"ansible-playbook\\\", \\\"-i\\\", \\\"localhost,\\\", \\\"-v\\\", \\\"-e\\\", \\\"@/tmp/awx_1_lp0t6B/tmpaNWF7d\\\", \\\"project_update.yml\\\"]\",\r\n            \"job_cwd\": \"/awx_devel/awx/playbooks\",\r\n            \"job_env\": {\r\n                \"TMP\": \"/tmp\",\r\n                \"RABBITMQ_PASS\": \"**********\",\r\n                \"ANSIBLE_BECOME_ASK_PASS\": \"False\",\r\n                \"ANSIBLE_PARAMIKO_RECORD_HOST_KEYS\": \"False\",\r\n                \"AWX_PRIVATE_DATA_DIR\": \"/tmp/awx_1_lp0t6B\",\r\n                \"_MP_FORK_LOGFILE_\": \"\",\r\n                \"CACHE\": \"memcached:11211\",\r\n                \"ANSIBLE_ASK_PASS\": \"False\",\r\n                \"CELERY_LOG_REDIRECT\": \"1\",\r\n                \"SUPERVISOR_GROUP_NAME\": \"awx-processes\",\r\n                \"PATH\": \"/venv/ansible/bin:/venv/awx/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\r\n                \"RABBITMQ_VHOST\": \"/\",\r\n                \"HOME\": \"/root\",\r\n                \"PS1\": \"(awx) \",\r\n                \"DISPLAY\": \"\",\r\n                \"MAKEFLAGS\": \"\",\r\n                \"ANSIBLE_CALLBACK_PLUGINS\": \"/awx_devel/awx/plugins/callback\",\r\n                \"LANG\": \"\\\"en-us\\\"\",\r\n                \"VIRTUAL_ENV\": \"/venv/ansible\",\r\n                \"SUPERVISOR_SERVER_URL\": \"unix:///tmp/supervisor.sock\",\r\n                \"TZ\": \"UTC\",\r\n                \"ANSIBLE_RETRY_FILES_ENABLED\": \"False\",\r\n                \"LANGUAGE\": \"en_US:en\",\r\n                \"_MP_FORK_LOGFORMAT_\": \"[%(asctime)s: %(levelname)s/%(processName)s] %(message)s\",\r\n                \"SHLVL\": \"3\",\r\n                \"SUPERVISOR_ENABLED\": \"1\",\r\n                \"SDB_HOST\": \"0.0.0.0\",\r\n                \"DJANGO_PROJECT_DIR\": \"/awx_devel\",\r\n                \"MFLAGS\": \"\",\r\n                \"ANSIBLE_HOST_KEY_CHECKING\": \"False\",\r\n                \"CELERY_LOG_FILE\": \"\",\r\n                \"DJANGO_LIVE_TEST_SERVER_ADDRESS\": \"localhost:9013-9199\",\r\n                \"RABBITMQ_HOST\": \"rabbitmq\",\r\n                \"ANSIBLE_STDOUT_CALLBACK\": \"awx_display\",\r\n                \"PYTHONPATH\": \"/venv/ansible/lib/python2.7/site-packages:/awx_devel/awx/lib:\",\r\n                \"SDB_NOTIFY_HOST\": \"172.18.0.1\",\r\n                \"SUPERVISOR_PROCESS_NAME\": \"celeryd\",\r\n                \"_MP_FORK_LOGLEVEL_\": \"10\",\r\n                \"LC_ALL\": \"en_US.UTF-8\",\r\n                \"ANSIBLE_FORCE_COLOR\": \"True\",\r\n                \"_\": \"/usr/bin/supervisord\",\r\n                \"RABBITMQ_USER\": \"guest\",\r\n                \"AWX_GROUP_QUEUES\": \"tower\",\r\n                \"CELERY_LOADER\": \"djcelery.loaders.DjangoLoader\",\r\n                \"CELERY_LOG_LEVEL\": \"10\",\r\n                \"HOSTNAME\": \"awx\",\r\n                \"PROJECT_UPDATE_ID\": \"1\",\r\n                \"MAKELEVEL\": \"1\",\r\n                \"PWD\": \"/awx_devel\",\r\n                \"CELERY_LOG_REDIRECT_LEVEL\": \"WARNING\",\r\n                \"DJANGO_SETTINGS_MODULE\": \"awx.settings.development\",\r\n                \"ANSIBLE_VENV_PATH\": \"/venv/ansible\",\r\n                \"PROOT_TMP_DIR\": \"/tmp\"\r\n            },\r\n            \"job_explanation\": \"\",\r\n            \"execution_node\": \"awx\",\r\n            \"result_traceback\": \"\",\r\n            \"event_processing_finished\": false,\r\n            \"project\": 4,\r\n            \"job_type\": \"check\"\r\n        },\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAfter configuring external logging settings SCM updates no longer work.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5.18\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.0.0\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Setup a new project (I used git as an SCM source) and confirm an SCM update works\r\n2) Configure external logging\r\n3) Run an SCM update\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSCM updates continue to work with external logging enabled\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSCM updates stop working\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n[2018-04-03 08:37:50,491: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_job_launch[b7a8b43f-5984-4e21-ab55-76a0d9cc9d5d]\r\n[2018-04-03 08:37:50,491: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x23c2b18> (args:(u'awx.main.scheduler.tasks.run_job_launch', u'b7a8b43f-5984-4e21-ab55-76a0d9cc9d5d', [14], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [14], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower'}, u'expires': None, u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_job_launch', u'callbacks': None, u'correlation_id': u'b7a8b43f-5984-4e21-ab55-76a0d9cc9d5d', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'0383f788-0b18-31a4-b456-5196350e2ba7', u'id': u'b7a8b43f-5984-4e21-ab55-76a0d9cc9d5d', u'headers': {}}) kwargs:{})\r\n[2018-04-03 08:37:50,493: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_job_launch[b7a8b43f-5984-4e21-ab55-76a0d9cc9d5d] pid:231\r\n2018-04-03 08:37:50,511 DEBUG    awx.main.scheduler Starting Scheduler\r\n2018-04-03 08:37:50,558 DEBUG    awx.main.scheduler Starting project_update 14 (pending) in group tower (remaining_capacity=37)\r\n2018-04-03 08:37:50,561 INFO     awx.main.scheduler Submitting project_update 14 (waiting) to instance group 1.\r\n2018-04-03 08:37:50,595 DEBUG    awx.main.scheduler project_update 14 (waiting) consumed 1 capacity units from tower with prior total of 0\r\n[2018-04-03 08:37:50,616: DEBUG/Worker-6] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@58b137aa44ea', u'platform': u'Erlang/OTP 20.1.7', u'version': u'3.7.4'}, mechanisms: [u'AMQPLAIN', u'PLAIN'], locales: [u'en_US']\r\n[2018-04-03 08:37:50,620: DEBUG/Worker-6] Open OK!\r\n[2018-04-03 08:37:50,620: DEBUG/Worker-6] using channel_id: 1\r\n[2018-04-03 08:37:50,622: DEBUG/Worker-6] Channel open\r\n[2018-04-03 08:37:50,625: INFO/MainProcess] Received task: awx.main.tasks.run_project_update[d1e01b36-4405-486d-8c69-ca54bbe01417]\r\n[2018-04-03 08:37:50,626: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x23c2b18> (args:(u'awx.main.tasks.run_project_update', u'd1e01b36-4405-486d-8c69-ca54bbe01417', [14], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [14], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower'}, u'expires': None, u'hostname': 'celery@awx', u'task': u'awx.main.tasks.run_project_update', u'callbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_success', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'task_actual': {u'type': u'project_update', u'id': 14}}, u'options': {}}], u'correlation_id': u'd1e01b36-4405-486d-8c69-ca54bbe01417', u'errbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_error', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'subtasks': [{u'type': u'project_update', u'id': 14}]}, u'options': {}}], u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to':... kwargs:{})\r\n[2018-04-03 08:37:50,628: DEBUG/MainProcess] Task accepted: awx.main.tasks.run_project_update[d1e01b36-4405-486d-8c69-ca54bbe01417] pid:233\r\n[2018-04-03 08:37:50,630: DEBUG/Worker-6] Closed channel #1\r\n[2018-04-03 08:37:50,652: INFO/MainProcess] Task awx.main.scheduler.tasks.run_job_launch[b7a8b43f-5984-4e21-ab55-76a0d9cc9d5d] succeeded in 0.159662134014s: None\r\n2018-04-03 08:37:50,756 ERROR    awx.main.tasks Error flushing job stdout and saving event count.\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 975, in run\r\n    stdout_handle.flush()\r\nUnboundLocalError: local variable 'stdout_handle' referenced before assignment\r\n2018-04-03 08:37:50,757 INFO     awx.main.tasks project_update 14 (running) Could not find scm revision in check\r\n2018-04-03 08:37:50,843 WARNING  awx.main.tasks project_update 14 (error) encountered an error (rc=None), please see task stdout for details.\r\n[2018-04-03 08:37:50,845: CRITICAL/MainProcess] Task awx.main.tasks.run_project_update[d1e01b36-4405-486d-8c69-ca54bbe01417] INTERNAL ERROR: TypeError('super(type, obj): obj must be an instance or subtype of type',)\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 253, in trace_task\r\n    I, R, state, retval = on_error(task_request, exc, uuid)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 201, in on_error\r\n    R = I.handle_error_state(task, eager=eager)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 85, in handle_error_state\r\n    }[self.state](task, store_errors=store_errors)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 120, in handle_failure\r\n    task.on_failure(exc, req.id, req.args, req.kwargs, einfo)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 94, in on_failure\r\n    super(LogErrorsTask, self).on_failure(exc, task_id, args, kwargs, einfo)\r\nTypeError: super(type, obj): obj must be an instance or subtype of type\r\n```\r\n"},{"labels":["api",null,null],"text":"\r\n\r\n##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nAllow the assignment of some Organization roles to Teams.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nCurrently you cannot assign a Team any Organization level roles, this is due to nature of how role assignments are implemented and how parent/children hieachies are caclutated. With the addition of the new focused admin roles for Organization resources it might be nice to revisit the idea of allowing a Team to belong to Organization level roles.\r\n"},{"labels":["api",null,null],"text":"ISSUE TYPE: Bug\r\nCOMPONENT NAME: API\r\n\r\nSUMMARY: \r\nPOST request to http://<server-ip>/api/v2/job_templates/<template_id>/launch/\r\nresponds with\r\n{\r\n    \"detail\": \"You do not have permission to perform this action.\"\r\n}, but\r\nGET request to http://<server-ip>/api/v2/job_templates/<template_id>/launch/\r\nSucceeds, and responds back with the template details.\r\n\r\nENVIRONMENT\r\n* AWX version: 1.0.5.19\r\n* AWX install method: docker for linux\r\n* Ansible version:  2.5.0\r\n* Operating System: Centos 7\r\n* Web Browser: POSTMAN Request\r\n\r\nSTEPS TO REPRODUCE\r\n1. Create Application in AWX\r\n2. Follow https://github.com/ansible/awx/blob/ac70945071bec9bb1cfdfed328c13c3b2d1fbd39/docs/auth/oauth.md to create a new Auth Token, and bind it to the application.\r\n3. Ensure that the token has write permissions\r\n4. Fire a GET request to http://<server-ip>/api/v2/job_templates/<template_id>/launch/, to confirm that the access has been granted.\r\n5. Fire a POST request to http://<server-ip>/api/v2/job_templates/<template_id>/launch/\r\n\r\nEXPECTED RESULTS\r\nJob gets invoked.\r\nACTUAL RESULTS\r\n403 Forbidden: \r\n{\r\n    \"detail\": \"You do not have permission to perform this action.\"\r\n}"},{"labels":["api"],"text":"Issue:  - Documentation\r\nComponent Name: API\r\n\r\nSummary: \r\n\r\nENVIRONMENT: \r\nAWX Version: 1.0.5.19\r\nAWX Install Method: Docker on linux\r\nAnsible version: 2.5.0\r\nOS: Centos 7\r\nRequest Source: POSTMAN\r\n\r\nSTEPS TO REPRODUCE:\r\n1. Fire a request from Postman to the awx server, requesting a job template: http://server-ip/api/v2/job_templates/8/launch/\r\n\r\nEXPECTED RESULTS: template details\r\nACTUAL RESULTS\r\n403 Forbidden: \r\n{\r\n    \"detail\": \"Authentication credentials were not provided.\"\r\n}\r\n\r\n\r\nISSUE DESCRIPTION:\r\nPlease provide the headers/parameters that need to be passed with the API, to make an authorised request. \r\nPlease also elaborate on how to obtain the needed credentials that should be passed. (such as auth token, etc)"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### ENVIRONMENT\r\n\r\n* Ansible Tower / AWX latest release\r\n\r\n##### SUMMARY\r\nCurrently 'doas' is missing in the drop down list of privilege escalation methods in credential. Since the method is already supported in core. It can be also added in AWX.\r\n\r\n##### ACTUAL RESULTS\r\n![screenshot from 2018-03-31 08-40-34](https://user-images.githubusercontent.com/10349173/38159088-6198a802-34bf-11e8-8269-7ce85b2d480f.png)\r\n\r\n\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCustomer would like to implement ssh private key passphrases into custom credentials, similar to the way machine credentials allow for this:\r\n\r\n\"We would like to use the ssh private key (from custom credential injectors) and to get the ssh passphrase (by a request to the vault) to connect to the guests.\""},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n- UI (not sure)\r\n\r\n##### SUMMARY\r\nRunning a playbook and following the output live, one of the tasks generated this warning:\r\n\r\n```\r\nTASK [fail2ban : manage fail2ban/jail.local] ***********************************13:26:00\r\n [WARNING]: Failure using method (v2_playbook_on_notify) in callback plugin\r\n(<awx_display_callback.module.AWXDefaultCallbackModule object at 0x214de50>):\r\n'Handler' object has no attribute '_host'\r\n```\r\n\r\nThis is the task, I don't know what's special about it to cause this warning - everything other task ran fine.\r\n\r\n```\r\n- name: manage fail2ban/jail.local\r\n  template:\r\n    src: jail.local.j2\r\n    dest: /etc/fail2ban/jail.local\r\n  notify: reload fail2ban\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.5.13\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.5.0\r\n* Operating System: Debian Stretch\r\n* Web Browser: Chromium"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWe tried to configure the LDAP endpoint from web UI but after the change if we click to save and we switch to another tab, the old configurations were missing. We noticed an HTTP 500 error on call /api/v2/settings/all/. We added the stackt race generated during the save action.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.5.13\r\n* AWX install method: openshift \r\n* Ansible version: 2.4.2.0\r\n* Operating System: CentOS 7\r\n* Web Browser: Firefox and Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n- Edit the configuration from settings panel and click to save\r\n\r\n##### EXPECTED RESULTS\r\nWe would keep persistent the LDAP configuration for the external users\r\n\r\n##### ACTUAL RESULTS\r\nThe configurations becomes blank when i change the tab selection and i return to the previous one.\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis is the error reported during the issue:\r\n\r\n```\r\n10.130.2.1 - - [29/Mar/2018:06:53:59 +0000] \"GET /api/v2/settings/all/ HTTP/1.1\" 200 9706 \"https://awx-web-svc-test-dev.devapps.test.it/\" \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36\"\r\n[pid: 35|app: 0|req: 91/535] 10.130.2.1 () {50 vars in 2655 bytes} [Thu Mar 29 06:53:58 2018] GET /api/v2/settings/all/ => generated 9706 bytes in 288 msecs (HTTP/1.1 200) 8 headers in 260 bytes (1 switches on core 0)\r\nRESULT 2\r\nOKREADY\r\n2018-03-29 06:54:04,888 ERROR    django.request Internal Server Error: /api/v2/settings/all/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 260, in patch\r\n    return self.partial_update(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 745, in partial_update\r\n    return super(RetrieveUpdateAPIView, self).partial_update(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 84, in partial_update\r\n    return self.update(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 741, in update\r\n    return super(RetrieveUpdateAPIView, self).update(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 69, in update\r\n    serializer.is_valid(raise_exception=True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 236, in is_valid\r\n    self._validated_data = self.run_validation(self.initial_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 435, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 465, in to_internal_value\r\n    validated_value = field.run_validation(primitive_value)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 523, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/serializers.py\", line 57, in to_internal_value\r\n    obj = super(SettingFieldMixin, self).to_internal_value(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/fields.py\", line 401, in to_internal_value\r\n    return cls(**params_sanitized)\r\nTypeError: __init__() takes at least 2 arguments (2 given)\r\n2018-03-29 06:54:04,888 ERROR    django.request Internal Server Error: /api/v2/settings/all/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 260, in patch\r\n    return self.partial_update(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 745, in partial_update\r\n    return super(RetrieveUpdateAPIView, self).partial_update(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 84, in partial_update\r\n    return self.update(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 741, in update\r\n    return super(RetrieveUpdateAPIView, self).update(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 69, in update\r\n    serializer.is_valid(raise_exception=True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 236, in is_valid\r\n    self._validated_data = self.run_validation(self.initial_data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 435, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 465, in to_internal_value\r\n    validated_value = field.run_validation(primitive_value)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 523, in run_validation\r\n    value = self.to_internal_value(data)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/serializers.py\", line 57, in to_internal_value\r\n    obj = super(SettingFieldMixin, self).to_internal_value(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/fields.py\", line 401, in to_internal_value\r\n    return cls(**params_sanitized)\r\nTypeError: __init__() takes at least 2 arguments (2 given)\r\n[pid: 36|app: 0|req: 155/536] 10.130.2.1 () {56 vars in 2830 bytes} [Thu Mar 29 06:54:04 2018] PATCH /api/v2/settings/all/ => generated 41 bytes in 325 msecs (HTTP/1.1 500) 5 headers in 177 bytes (1 switches on core 0)\r\n```"},{"labels":["api",null],"text":"<!---\r\nThe Ansible community is highly committed to the security of our open source\r\nprojects.  Security concerns should be reported directly by email to\r\nsecurity@ansible.com.  For more information on the Ansible community's\r\npractices regarding responsible disclosure, see\r\nhttps://www.ansible.com/security\r\n-->\r\n\r\n##### ISSUE TYPE\r\n\r\n - Bug Report\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nThe slack client fix for larger workspace (probably more than 10K members) has to be incorporated in awx backend code. It fails to deliver the slack notification with in the defined time out,  throws error on the GUI \"\r\nCall to test notifications failed.\" and the notification left undelivered inconsistently.\r\n\r\nFix on the slackclient\r\nhttps://github.com/slackapi/python-slackclient/blob/master/slackclient/client.py#L42\r\n\r\nto be made, \r\nhttps://github.com/ansible/awx/blob/1.0.5/awx/main/notifications/slack_backend.py#L35\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0 (corrected)\r\n* AWX install method: RH Community ansible script on RHEL 7.3 machine\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Windows 10\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nBot & channel on a Workspace with 10K member or more\r\nTest notification from Tower\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTest notification must be delivered successfully \r\n\r\n##### ACTUAL RESULTS\r\n\r\n`Call to test notifications failed.`\r\n\r\n"},{"labels":["api",null],"text":"ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - Installer\r\n\r\n##### SUMMARY\r\nI have created template and pointed one of my playbook which is vault encrypted ,  \r\n\r\nCreated new credential with following details:\r\n\r\nCredential type : Vault\r\nVault Password  : password given at the time of creating vault file\r\nVault Identifier  : Vault file name\r\n\r\nMapped this user to template.\r\n\r\nBut playbook fails\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.130\r\n* AWX install method: docker on Linux\r\n* Ansible version:  2.5.0\r\n* Operating System: Centos \r\n* Web Browser: IE\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI have created template and pointed one of my playbook which is vault encrypted ,  \r\n\r\nCreated new credential with following details:\r\n\r\nCredential type : Vault\r\nVault Password  : password given at the time of creating vault file\r\nVault Identifier  : Vault file name\r\n\r\nMapped this user to template.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPlaybook should run successfully \r\n\r\n##### ACTUAL RESULTS\r\n\r\nFound a vault_id (default) in the vault text, but we do not have a associated secret (--vault-id)\r\nTrying to use vault secret=(<ansible.parsing.vault.PromptVaultSecret object at 0x1c630d0>) id=db2_vault to decrypt None\r\nTrying secret <ansible.parsing.vault.PromptVaultSecret object at 0x1c630d0> for vault_id=db2_vault\r\nTried to use the vault secret (db2_vault) to decrypt (None) but it failed. Error: HMAC verification failed: Signature did not match digest.\r\n\r\n\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe Host Variable Data endpoint at `/api/v1/hosts/<host_number>/variable_data/` is listed as deprecated, but there is no listed alternative. Once it is deprecated, how can host variables be set/updated from the API?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Google Chrome on macOS\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n  - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt would be good to inject the labels field from the Job template into the api for the /api/v2/activity_stream/ endpoint. This could be used to create a custom filter for reporting via external logging aggregators. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.4.3\r\n* Operating System: RHEL 7\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAfter creating an inventory source (EC2 type is the problem, but the issue occurs with other types as well) with an LDAP-managed AWX user (that is an Organization admin), an error appears when attempting to edit that inventory source.  The inventory source _can_ be edited by the local \"admin\" AWX user after that point.  This forces the LDAP-managed AWX user to have to recreate the inventory source to make any changes.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.125\r\n* AWX install method: docker on AWS ECS\r\n* Ansible version:  2.4.3.0\r\n* Operating System: in container: CentOS Linux release 7.4.1708 (Core), docker host: Amazon Linux AMI 2017.09\r\n* Web Browser: Firefox 59.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create an inventory.\r\n2. Create an inventory source in the previously created inventory.  Use the Amazon Web Services credential type and enter other required attribute values.\r\n3. Edit the previously created inventory source (change the Description value, for example) and notice that an error appears and the change does not apply.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe inventory source should save any changes made without an error that pops up.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n1. Editing the inventory source results in a modal pop-up error in the UI like:\r\n<img width=\"587\" alt=\"image\" src=\"https://user-images.githubusercontent.com/236515/37838521-7e41733a-2e8e-11e8-9df0-d014bb905538.png\">\r\n\r\n2. The resulting log in the awx_web container from this API call:\r\n\r\n```\r\n2018-03-23 15:38:36,900 ERROR    django.request Internal Server Error: /api/v2/inventory_sources/25/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 257, in put\r\n    return self.update(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 741, in update\r\n    return super(RetrieveUpdateAPIView, self).update(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 67, in update\r\n    instance = self.get_object()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 101, in get_object\r\n    self.check_object_permissions(self.request, obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 344, in check_object_permissions\r\n    if not permission.has_object_permission(request, self, obj):\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 138, in has_object_permission\r\n    return self.has_permission(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 129, in has_permission\r\n    response = self.check_permissions(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 118, in check_permissions\r\n    result = check_method and check_method(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 82, in check_put_permissions\r\n    request.data)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 117, in check_user_access\r\n    result = access_method(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 157, in wrapper\r\n    return func(self, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 931, in can_change\r\n    self.check_related('credential', Credential, data, obj=obj, role_field='use_role') and\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 290, in check_related\r\n    if current and (changed or mandatory) and (not user_has_resource_access(current)):\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 283, in user_has_resource_access\r\n    access_method_type = {'admin_role': 'change', 'execute_role': 'start'}[role_field]\r\nKeyError: 'use_role'\r\n```\r\n\r\n3. Notice that the changes made have not applied to the inventory source.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIncluded above in ACTUAL RESULTS\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen trying to launch a unified workflow job using passwords, the workflow hangs on the inventory sync job. When running a 'docker log awx_task' command, it looks like I'm receiving the following exception:\r\n\r\n[2018-03-23 00:11:33,187: ERROR/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[5479bcab-2aec-4be4-b3a7-4891704d3ee8] raised unexpected: Exception('Unrecognized launch config field survey_passwords.',)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.124\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3\r\n* Operating System: Centos\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a unified workflow job with a few job templates and an inventory sync job in the workflow and use password variables in the survey.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe workflow should run successfully without hanging\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe job never completes. It hangs at the inventory sync job. This might also occur with a project scm sync job in the workflow, but I'm not completely sure.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n2018-03-23 00:17:12,246 ERROR    awx.main.scheduler Task awx.main.scheduler.tasks.run_task_manager encountered exception.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 240, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 438, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/tasks.py\", line 37, in run_task_manager\r\n    TaskManager().schedule()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 629, in schedule\r\n    finished_wfjs = self._schedule()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 614, in _schedule\r\n    self.spawn_workflow_graph_jobs(running_workflow_tasks)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 196, in spawn_workflow_graph_jobs\r\n    job = spawn_node.unified_job_template.create_unified_job(**kv)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\", line 1500, in create_unified_job\r\n    return super(InventorySource, self).create_unified_job(**kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 393, in create_unified_job\r\n    unified_job.create_config_from_prompts(kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 880, in create_config_from_prompts\r\n    raise Exception('Unrecognized launch config field {}.'.format(field_name))\r\nException: Unrecognized launch config field survey_passwords.\r\n[2018-03-23 00:17:12,249: ERROR/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[c29823d8-2fc7-40a4-ba2d-c79253cb4596] raised unexpected: Exception('Unrecognized launch config field survey_passwords.',)\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 240, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 438, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/tasks.py\", line 37, in run_task_manager\r\n    TaskManager().schedule()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 629, in schedule\r\n    finished_wfjs = self._schedule()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 614, in _schedule\r\n    self.spawn_workflow_graph_jobs(running_workflow_tasks)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 196, in spawn_workflow_graph_jobs\r\n    job = spawn_node.unified_job_template.create_unified_job(**kv)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\", line 1500, in create_unified_job\r\n    return super(InventorySource, self).create_unified_job(**kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 393, in create_unified_job\r\n    unified_job.create_config_from_prompts(kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 880, in create_config_from_prompts\r\n    raise Exception('Unrecognized launch config field {}.'.format(field_name))\r\nException: Unrecognized launch config field survey_passwords.\r\n[2018-03-23 00:17:26,777: INFO/MainProcess] Scaling down -2 processes.\r\n[2018-03-23 00:17:26,778: DEBUG/MainProcess] basic.qos: prefetch_count->5432\r\n[2018-03-23 00:17:31,896: DEBUG/Beat] beat: Synchronizing schedule...\r\n[2018-03-23 00:17:31,916: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\n[2018-03-23 00:17:31,918: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->c0466b22-2a05-4ac1-868c-0c28b34d0980\r\n[2018-03-23 00:17:31,919: DEBUG/Beat] beat: Waking up now.\r\n[2018-03-23 00:17:31,919: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[c0466b22-2a05-4ac1-868c-0c28b34d0980] expires:[2018-03-23 00:17:51.917332+00:00]\r\n[2018-03-23 00:17:31,919: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x30f8aa0> (args:(u'awx.main.tasks.awx_periodic_scheduler', u'c0466b22-2a05-4ac1-868c-0c28b34d0980', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower'}, u'expires': u'2018-03-23T00:17:51.917332+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.tasks.awx_periodic_scheduler', u'callbacks': None, u'correlation_id': u'c0466b22-2a05-4ac1-868c-0c28b34d0980', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'ebf3eb54-7a03-3352-a5e6-df53ebd2ceb6', u'id': u'c0466b22-2a05-4ac1-868c-0c28b34d0980', u'headers': {}}) kwargs:{})\r\n[2018-03-23 00:17:31,921: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[c0466b22-2a05-4ac1-868c-0c28b34d0980] pid:20372\r\n2018-03-23 00:17:31,935 DEBUG    awx.main.tasks Last scheduler run was: 2018-03-23 00:17:01.909449+00:00\r\n[2018-03-23 00:17:31,960: INFO/MainProcess] Task awx.main.tasks.awx_periodic_scheduler[c0466b22-2a05-4ac1-868c-0c28b34d0980] succeeded in 0.0399558200006s: None\r\n[2018-03-23 00:17:31,973: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\n[2018-03-23 00:17:31,974: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->0b292032-d685-4beb-a953-9b5fe6e6c812\r\n[2018-03-23 00:17:31,975: DEBUG/Beat] beat: Waking up in 18.41 seconds.\r\n[2018-03-23 00:17:31,975: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[0b292032-d685-4beb-a953-9b5fe6e6c812] expires:[2018-03-23 00:17:51.974214+00:00]\r\n[2018-03-23 00:17:31,976: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x30f8aa0> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'0b292032-d685-4beb-a953-9b5fe6e6c812', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower'}, u'expires': u'2018-03-23T00:17:51.974214+00:00', u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'0b292032-d685-4beb-a953-9b5fe6e6c812', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'ebf3eb54-7a03-3352-a5e6-df53ebd2ceb6', u'id': u'0b292032-d685-4beb-a953-9b5fe6e6c812', u'headers': {}}) kwargs:{})\r\n[2018-03-23 00:17:31,977: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[0b292032-d685-4beb-a953-9b5fe6e6c812] pid:20372\r\n2018-03-23 00:17:31,989 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2018-03-23 00:17:31,997 DEBUG    awx.main.scheduler Starting Scheduler\r\n2018-03-23 00:17:32,187 WARNING  awx.main.models.unified_jobs Fields set(['extra_vars']) are not allowed as overrides.\r\n[2018-03-23 00:17:32,187: WARNING/Worker-445] Fields set(['extra_vars']) are not allowed as overrides.\r\n2018-03-23 00:17:32,219 ERROR    awx.main.scheduler Task awx.main.scheduler.tasks.run_task_manager encountered exception.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 240, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 438, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/tasks.py\", line 37, in run_task_manager\r\n    TaskManager().schedule()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 629, in schedule\r\n    finished_wfjs = self._schedule()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 614, in _schedule\r\n    self.spawn_workflow_graph_jobs(running_workflow_tasks)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 196, in spawn_workflow_graph_jobs\r\n    job = spawn_node.unified_job_template.create_unified_job(**kv)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\", line 1500, in create_unified_job\r\n    return super(InventorySource, self).create_unified_job(**kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 393, in create_unified_job\r\n    unified_job.create_config_from_prompts(kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 880, in create_config_from_prompts\r\n    raise Exception('Unrecognized launch config field {}.'.format(field_name))\r\nException: Unrecognized launch config field survey_passwords.\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently, the credential field is required in the UI.  However, there are scenarios where it makes sense to have a job template with no credentials at all.\r\n\r\nFor example, Tower running in AWS may be installed on an EC2 instance with an IAM role assigned that grants it privileges to manage other parts of the AWS infrastructure, without requiring any tokens or keys.\r\n\r\nYou can get around this by assigning 'Demo Credential' (or some other meaningless credential) to the JT, but it seems inelegant to require this."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n- awx_tasks\r\n\r\n##### SUMMARY\r\n\r\nThis idea is to use signed SSH certificates, provided by Hashicorp Vault. \r\nYou can check https://www.vaultproject.io/docs/secrets/ssh/signed-ssh-certificates.html.\r\n\r\nI want to stop deploying public keys, and use short-lived signed certificates provided.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nCurrently, users can only create tokens for themselves (for app tokens and PAT's).  It seems desirable that admins and org admins should have the capability to create tokens for other users within their jurisdiction.  \r\n\r\n##### ENVIRONMENT\r\nawx: 1.0.4.102\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSteps to support this: \r\n1. Change logic in serializers to make user field required on token creation at all token endpoints and remove logic to automatically populate user field with the current user.  \r\n2. Update the tower-cli login to pass the user field.  "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nNo login possible \r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4\r\n* Operating System: RHEL 7.4\r\n* Web Browser: Chrome/Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAttempt to login after setting timeout expiry to > 1212121212121211\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLog in\r\n\r\n##### ACTUAL RESULTS\r\n\r\nInvalid username/password generated\r\nHappens for all accounts - admin account fails to login and all other accounts are LDAP authenticated which also fail.\r\n\r\nawx_web container logs show the following when attempting to log in;\r\n\r\n2018-03-22 09:53:49,940 ERROR    django.request Internal Server Error: /api/login/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/debug.py\", line 76, in sensitive_post_parameters_wrapper\r\n    return view(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 149, in _wrapped_view\r\n    response = view_func(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 67, in _wrapper\r\n    return bound_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/cache.py\", line 57, in _wrapped_view_func\r\n    response = view_func(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 63, in bound_func\r\n    return func.__get__(self, type(self))(*args2, **kwargs2)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/views.py\", line 90, in dispatch\r\n    return super(LoginView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 88, in dispatch\r\n    return handler(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 67, in post\r\n    ret = super(LoggedLoginView, self).post(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/edit.py\", line 183, in post\r\n    return self.form_valid(form)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/views.py\", line 119, in form_valid\r\n    auth_login(self.request, form.get_user())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 139, in login\r\n    request.session.cycle_key()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/backends/base.py\", line 311, in cycle_key\r\n    self.create()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/backends/db.py\", line 54, in create\r\n    self.save(must_create=True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/backends/db.py\", line 83, in save\r\n    obj = self.create_model_instance(data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/backends/db.py\", line 70, in create_model_instance\r\n    expire_date=self.get_expiry_date(),\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/sessions/backends/base.py\", line 257, in get_expiry_date\r\n    return modification + timedelta(seconds=expiry)\r\nOverflowError: normalized days too large to fit in a C int\r\n[pid: 28|app: 0|req: 3/9] 10.99.85.18 () {48 vars in 863 bytes} [Thu Mar 22 09:53:49 2018] POST /api/login/ => generated 41 bytes in 357 msecs (HTTP/1.1 500) 5 headers in 177 bytes (1 switches on core 0)\r\n\r\nThe timeout time was set to 12121212121211 (as a test) and this resulted in logins being disabled. \r\nTo fix this I just removed the entry via the postgres database - command used in case anyone else sets their timeout too high;\r\n\\c awx\r\nDELETE FROM public.conf_setting WHERE id = 96;\r\nProbably best to double check id 96 is in fact the entry for the timeout.\r\n\r\nThe error handling for this could be improved I reckon, perhaps add a limit to the timeout activity entry to prevent this or at the very least a tip in the '?' entry for timeout to avoid setting too high.\r\n\r\nCheers\r\n\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAdditional hosts added to an inventory sourced from SCM don't get group_vars applied to them after being associated with said group.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.109\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Debian 9\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n1.  Create a new project from SCM using this repo: [https://github.com/cjworden/ansible-test-playbook](https://github.com/cjworden/ansible-test-playbook)\r\n2. Create an inventory sourced from that project\r\n3. Add an extra host which is not currently in the inventory to the inventory manually\r\n4. Add the SCM sourced groups to your manually added host (\"+ ASSOCIATE GROUP\" button)\r\n5. Create a job template using inventory created in step 2, project created in step 3, and playbooks/play.yml. \r\n6. Run the job\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nThe job completes successfully against all hosts\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nThe job runs successfully against all hosts defined in SCM, but fails on the manually added host due to unknown variable:\r\n\r\n```\r\nPLAY [Print variable] **********************************************************14:12:06\r\nTASK [Print variable] **********************************************************14:12:06\r\nfatal: [127.0.0.1]: FAILED! => {\"msg\": \"The task includes an option with an undefined variable. The error was: 'test_var' is undefined\\n\\nThe error appears to have been in '/var/lib/awx/projects/_13__cody/playbooks/play.yml': line 5, column 7, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n  tasks:\\n    - name: Print variable\\n      ^ here\\n\\nexception type: <class 'ansible.errors.AnsibleUndefinedVariable'>\\nexception: 'test_var' is undefined\"}\r\nok: [localhost] => {\r\n    \"msg\": \"this is a variable\"\r\n}\r\nPLAY RECAP *********************************************************************14:12:06\r\n127.0.0.1                  : ok=0    changed=0    unreachable=0    failed=1   \r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=0   \r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nI'm not sure if this is the same underlying issue as #1192, if it is and should be fixed, what version should I update to to test it out? (I'm currently installing AWX using docker-compose pulling the 'latest' tag)"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInventory script with 500 hosts, 27 groups, and 351 group-group relationships reaches scaling limit of AWX.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-318\r\n* AWX install method: docker for mac\r\n* Ansible version:  relevant for 2.6/2.7\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAnsible core cannot yet handle these numbers, but a fix for that is in progress - https://github.com/ansible/ansible/pull/37141. If that fix lands, then Ansible will be able to handle inventories that AWX cannot.\r\n\r\nIn order to get around the temporarily limitation of core make this change\r\n\r\n```\r\n--- a/awx/main/management/commands/inventory_import.py\r\n+++ b/awx/main/management/commands/inventory_import.py\r\n@@ -90,6 +90,7 @@ class AnsibleInventoryLoader(object):\r\n         return env\r\n \r\n     def get_base_args(self):\r\n+        return [self.source]\r\n```\r\n\r\nNext, create an inventory source that syncs from\r\n\r\nhttps://github.com/AlanCoding/Ansible-inventory-file-examples/blob/master/scripts/connections/hosts/dag_max.py\r\n\r\nset source variables\r\n\r\n```yaml\r\nNUMBER_HOSTS: 1000\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nScript expected to run with 10k hosts.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n500 takes too long for me to wait, but limit varies based on your own patience.\r\n\r\nthousands of hosts approach \"heat death of the universe\" slow.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInventory updates should be something that the client can continuously monitor, but it appears that events are getting stuck in some buffer until the update is fully finished.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-318\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun and inventory update that takes a considerable time to run.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThat events are saved and show up in the API in real time.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nInspect any inventory update events, and you can find that fields like `created` on the _event_ take place after the `finished` time on the inventory update. By my testing so far, this is true for all inventory update events.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nFor isolated nodes have a default option that could be used by hosts in the isolated networks to make callbacks. \r\n\r\nOne option would be to configure the isolated node as a SSL proxy for those hosts to reach the control nodes. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nPasswords used within the \"password\" option of the URI module are being logged in plain text to the \"task_args\" field of the job_event\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.109\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Ubuntu 16\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a playbook with a URI task that includes the password option\r\n\r\n- name: \"Running vmBase playbook\"\r\n  local_action:\r\n    module: uri\r\n    url: \"{{ awx_api_url }}/job_templates/7/launch/\"\r\n    method: POST\r\n    validate_certs: no\r\n    body: {\"inventory\": \"{{ AWX_INVENTORY }}\", \"limit\": \"{{ inventory_hostname }}\", \"credential\": 45}\r\n    body_format: json\r\n    user: \"{{ srvfiamawx_user }}\"\r\n    password: \"{{ srvfiamawx_password }}\"\r\n    status_code: 200, 201\r\n  register: awx_playbook\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe password option would be censored\r\n\r\nFrom job_events:\r\n\"task_args\": \"body={u'credential': 45, u'limit': u'hostname', u'inventory': 16}, _ansible_version=2.4.3.0, password=******\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe password is displayed in plaintext\r\n\r\nFrom job_events:\r\n\"task_args\": \"body={u'credential': 45, u'limit': u'hostname', u'inventory': 16}, _ansible_version=2.4.3.0, password=plaintext"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nUpdates in Roles are not consistently brought in to awx\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPrimary Repo:  Junk repo with only playbook calling one test role.  It also contained (2) naming variations of the rolesfile with (3) roles declared in it (files where identical bases the name, but didn't have to be).\r\nRoles:  (2) random roles, not really used for testing.  (1) test role just echoing a variable.\r\n\r\n1 - Create project, inventory, job template using the above.  Set project to update on launch and delete on update.  Cache timeout = 0\r\n2 - Trigger job template, view/record echo statement\r\n3 - Repeat step # 2 for a total of (5) attempts.\r\n4 - Modify the variable in the test role and push the changes.\r\n5 - Repeat steps # 2 and # 3.\r\n6 - Repeat step # 4 (5) times.\r\n\r\nIn all my tests, this always failed within the (25) job runs.  Failure = the output in Ansible Tower console regarding the echoed variable did not match what was pushed to the test role.  NOTE - in all cases the project update output showed that the ansible-galaxy command ran and was \"changed\" for each of the \"rolesfile\" and appeared to be correct on the filesystem.\r\n\r\nThe interesting observation that we found was that if we remove the \"when\" statement noted above (ie. trigger the find and ansible-galaxy tasks on repo change), the above mentioned failures disappeared.  The project update output still showed the same \"changed\" for the ansible-galaxy task, as these always triggered due to delete on project update.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCorrect roles being pulled into awx.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nRolls remain unchanged.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWe've done the following already:\r\n-  Changed the ansible stat detect requirements.yml to a find looking for \"rolesfile\", \"rolesfile.yml\" or \"requirements.yml\" within the entire repository.\r\n-  Update the ansible-galaxy command to iterate over all of those paths and extract the roles.\r\n-  Both of these tasks are blocked off and only trigger when a change was detected in the primary repo or obviously if the project was deleted on update.\r\n\r\nrelated #106\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report (I think)\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen launching a job template with credentials that require passwords at run time, the api accepts the following format in the POST:\r\n\r\n```\r\n{\r\n    credential_passwords: {\r\n        ssh_password: \"foo\",\r\n        become_password: \"bar\"\r\n    }\r\n}\r\n```\r\n\r\nWhen hitting the relaunch endpoint for the same job, the api throws a 400 if the passwords are formatted like they are above.  I think the api is expecting them to come in like:\r\n\r\n```\r\n{\r\n    ssh_password: \"foo\",\r\n    become_password: \"bar\"\r\n}\r\n```\r\n\r\nI _think_ that this is a bug.  I'm pretty sure that the format directly above is the legacy format (pre-vault credential changes).  There could be a good reason why the api expects this format for relaunch but I figured I'd better make an issue just in case this was missed.  If this gets closed without any API changes then the UI will need a bit of work to make sure that the format matches up.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nOutlined in summary but the basic gist is:\r\n\r\n1) Create a credential that requires password on launch\r\n2) Create a JT that uses the credential in step 1\r\n3) Launch a job with that JT\r\n4) Try to relaunch the job and pass credential passwords in the specified format\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nBreaking this out from #166 \r\n\r\nAbility to configure LDAP settings per organization.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nauth with password that contains special chars using ldap\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4 \r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.4.3.0\r\n* Operating System: CentOS 7\r\n* Web Browser: any browser\r\n\r\n##### STEPS TO REPRODUCE\r\nWe have configured ldap auth in awx. It seems awx transmits to ldap wrong password which contains special chars like \"&\" (tested only with \"&\") and as result ldap returns \r\ndjango_auth_ldap Authentication failed for <username>: user DN/password rejected by LDAP server.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nMany places in the UI we trigger UI updates via websockets... that are done by making REST calls back to the API.\r\n\r\nExamples:\r\n- dashboard\r\n- templates list\r\n- jobs list\r\n\r\nThis is due to not having sufficient information in the socket message itself to do the UI update.\r\n\r\nWe should fix that. \r\n\r\n(Imagine the case where you have 100 jobs start in quick succession, 5 people with AWX tabs open, and now you get 500+ API queries.)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nCannot connect to an ec2 instance using the private key while running the playbook using job template.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.3.0\r\n* Operating System: Red Hat Enterprise Linux Server release 7.4 (Maipo)\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Setup inventory with host, private key and user\r\n2. Setup job with existing repo\r\n3. Run playbook against the inventory\r\n\r\n##### EXPECTED RESULTS\r\n\r\nShould be able to connect to the host using ssh private key\r\n\r\n##### ACTUAL RESULTS\r\nConnection fails with following results -\r\n\r\nssh -vvv -o ControlMaster=auto -o ControlPersist=30m -o StrictHostKeyChecking=no -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=ec2-user -o ConnectTimeout=10 -o ControlPath=/tmp/awx_20_4deC_Z/cp/%h%p%r 10.50.x.x '/bin/sh -c '\"'\"'no_proxy=localhost,127.0.0.1,169.254.169.254,10.0.0.0/8,.example.com,s3-ap-southeast-2.amazonaws.com https_proxy=http://awsproxy.example.com:80 http_proxy=http://awsproxy.example.com:80 /usr/bin/python && sleep 0'\"'\"''\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nWe use proxy in our environment. Also ping, telnet and ssh connection to the target host from docker container awx_task_1, shows ok.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAPI filter doesn't work for roles endpoint with fields name and description\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.80\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: ubuntu 16.04\r\n* Web Browser: Firefox 59.0\r\n\r\n##### STEPS TO REPRODUCE\r\nSend GET request to\r\nhttps://your-awx.com/api/v2/roles/?name=Use\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAnswer with list of roles which have name='Use'\r\n\r\n##### ACTUAL RESULTS\r\n\r\nHTTP 400 Bad Request\r\n{\r\n    \"detail\": \"Role has no field named 'name'\"\r\n}"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - Project\r\n\r\n##### SUMMARY\r\nI configured AWX to support Manual SCM. I am able to create Projects with Manual SCM by selecting folders created under /opt/awx_projects (mounted to /var/lib/awx/projects).\r\n\r\nWhen creating a template, I can select the project but the playbooks within the folder are not shown in the Playbook selection field.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: CentOS Linux release 7.4.1708 \r\n* Web Browser: Chrome \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure AWX to map volumes to /opt/awx_projects (uncomment line in inventory).\r\nCreate several directories under /opt/awx_projects and add playbooks.\r\nMake sure that folders and files are accessible.\r\nCreate a project and chose manual SCM.\r\nSelect a directory.\r\nCreate a template and chose the project.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPlaybooks in the folder should be selectable\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo playbook is shown\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWorking fine with GitGub as SCM.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - Installer\r\n\r\n##### SUMMARY\r\nPrefetching behavior seems to not be working right all jobs launched around the same time tend to flood one entire node instead of being fairly distributed.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - Installer\r\n\r\n##### SUMMARY\r\n\r\nWe currently pull RMQ 3.6.14 into the K8S/OpenShift install, and use etcd2 for handling autoclustering.\r\n\r\nRabbitMQ 3.7 supports a K8S autodiscovery mechanism: http://www.rabbitmq.com/cluster-formation.html#peer-discovery-k8s. This sounds better than maintaining our own etcd container.\r\n\r\nWork is approximately:\r\n\r\n1) revving the rabbitmq image versions all around\r\nb) update our rabbitmq config to accept some templated values\r\niii) find a way to apply those templates at deployment, or at least take them as env vars so they get picked up on pod launch\r\n4) revise the inventory file if the defaults don’t work\r\nV) k8s vs openshift differences?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\nSee also https://github.com/ansible/awx/issues/1578#issuecomment-373770886\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nDELETE `/api/v2/tokens/N/`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n204\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nawx_1        | 2018-03-16 19:13:40,480 ERROR    django.request Internal Server Error: /api/v2/tokens/11/\r\nawx_1        | Traceback (most recent call last):\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\nawx_1        |     response = get_response(request)\r\nawx_1        |   File \"./awx/wsgi.py\", line 65, in _legacy_get_response\r\nawx_1        |     return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\nawx_1        |     response = self._get_response(request)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\nawx_1        |     response = self.process_exception_by_middleware(e, request)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\nawx_1        |     response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\nawx_1        |     return func(*args, **kwargs)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\nawx_1        |     return view_func(*args, **kwargs)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\nawx_1        |     return self.dispatch(request, *args, **kwargs)\r\nawx_1        |   File \"./awx/api/generics.py\", line 284, in dispatch\r\nawx_1        |     return super(APIView, self).dispatch(request, *args, **kwargs)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\nawx_1        |     response = self.handle_exception(exc)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\nawx_1        |     self.raise_uncaught_exception(exc)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\nawx_1        |     response = handler(request, *args, **kwargs)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 219, in delete\r\nawx_1        |     return self.destroy(request, *args, **kwargs)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 93, in destroy\r\nawx_1        |     self.perform_destroy(instance)\r\nawx_1        |   File \"./awx/api/generics.py\", line 487, in perform_destroy\r\nawx_1        |     super(DestroyAPIView, self).perform_destroy(instance)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 97, in perform_destroy\r\nawx_1        |     instance.delete()\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\", line 974, in delete\r\nawx_1        |     return collector.delete()\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/deletion.py\", line 284, in delete\r\nawx_1        |     count = qs._raw_delete(using=self.using)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 631, in _raw_delete\r\nawx_1        |     return sql.DeleteQuery(self.model).delete_qs(self, using)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/sql/subqueries.py\", line 80, in delete_qs\r\nawx_1        |     cursor = self.get_compiler(using).execute_sql(CURSOR)\r\nawx_1        |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\", line 899, in execute_sql\r\nawx_1        |     raise original_exception\r\nawx_1        | ProgrammingError: relation \"oauth2_provider_refreshtoken\" does not exist\r\nawx_1        | LINE 1: DELETE FROM \"oauth2_provider_refreshtoken\" WHERE \"oauth2_pro...\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - `azure_rm.py` dynamic inventory\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4\r\n* AWX install method: docker\r\n* Ansible version:  2.4.2\r\n* Operating System: CentOS 7.4\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n Run Azure inventory against a subscription containing a VM with a `win_rm` listener set\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\nA JSON dump of the inventory, or a successful inventory job\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n```\r\nTraceback (most recent call last):\r\n  File \"./azure_rm.py\", line 860, in <module>\r\n    main()\r\n  File \"./azure_rm.py\", line 856, in main\r\n    AzureInventory()\r\n  File \"./azure_rm.py\", line 502, in __init__\r\n    print(self._json_format_dict(pretty=self._args.pretty))\r\n  File \"./azure_rm.py\", line 745, in _json_format_dict\r\n    return json.dumps(self._inventory, sort_keys=True, indent=2)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/__init__.py\", line 251, in dumps\r\n    sort_keys=sort_keys, **kw).encode(obj)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 209, in encode\r\n    chunks = list(chunks)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 434, in _iterencode\r\n    for chunk in _iterencode_dict(o, _current_indent_level):\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n    for chunk in chunks:\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n    for chunk in chunks:\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n    for chunk in chunks:\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n    for chunk in chunks:\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n    for chunk in chunks:\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 332, in _iterencode_list\r\n    for chunk in chunks:\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 408, in _iterencode_dict\r\n    for chunk in chunks:\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 442, in _iterencode\r\n    o = _default(o)\r\n  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py\", line 184, in default\r\n    raise TypeError(repr(o) + \" is not JSON serializable\")\r\nTypeError: <ProtocolTypes.http: 'Http'> is not JSON serializable\r\n```\r\n<!-- For bug reports, what actually happened? -->\r\nThe script chokes on serializing ProtocolTypes to JSON. Calling `protocol.name` resolves this by putting the string into the dict, instead of the entire object.\r\n##### ADDITIONAL INFORMATION\r\nDue to my inability to read, there are two upstream PRs for this:\r\n* ansible/ansible#37499\r\n* ansible/ansible#18085\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nGithub Team/Organisation authentication gives a 502 with Django error - \"You have multiple authentication backends configured and therefore must provide the `backend` argument or set the `backend` attribute on the user.\" The user is authenticated, but isn't able to log in to AWX.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.62\r\n* AWX install method: Docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Mozilla Firefox 59.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nFresh install of AWX, setup of Github team authentication by adding the client ID/client secret/team ID, and then trying to log in using a Github account of the organisation.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nUser logs in properly using Github credentials.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n502 at /sso/complete/github-team/. The user is actually created and correct permissions are assigned according to the team/organisation map, but the log in doesn't happen.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nLogs from awx_web -\r\n```192.168.2.6 - - [16/Mar/2018:14:29:39 +0000] \"GET /api/v2/ HTTP/1.1\" 200 1545 \"https://awx.url.com/\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:59.0) Gecko/20100101 Firefox/59.0\"\r\n192.168.2.6 - - [16/Mar/2018:14:29:42 +0000] \"GET /sso/login/github-team/ HTTP/1.1\" 302 0 \"https://awx.url.com/\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:59.0) Gecko/20100101 Firefox/59.0\"\r\n[pid: 28|app: 0|req: 256/1131] 192.168.2.6 () {48 vars in 1265 bytes} [Fri Mar 16 14:29:42 2018] GET /sso/login/github-team/ => generated 0 bytes in 28 msecs (HTTP/1.1 302) 9 headers in 699 bytes (1 switches on core 0)\r\n[pid: 29|app: 0|req: 340/1132] 192.168.2.6 () {48 vars in 1496 bytes} [Fri Mar 16 14:29:42 2018] GET /sso/complete/github-team/?redirect_state=a6Zh1SXW2zTWXfDChXGj9hPmG3PsVJUE&code=2fa2829a3f0ebe6cb32b&state=a6Zh1SXW2zTWXfDChXGj9hPmG3PsVJUE => generated 0 bytes in 422 msecs (HTTP/1.1 302) 8 headers in 289 bytes (1 switches on core 0)\r\n192.168.2.6 - - [16/Mar/2018:14:29:43 +0000] \"GET /sso/complete/github-team/?redirect_state=a6Zh1SXW2zTWXfDChXGj9hPmG3PsVJUE&code=2fa2829a3f0ebe6cb32b&state=a6Zh1SXW2zTWXfDChXGj9hPmG3PsVJUE HTTP/1.1\" 302 0 \"https://awx.url.com/\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:59.0) Gecko/20100101 Firefox/59.0\"\r\n2018-03-16 14:29:43,242 ERROR    django.request Internal Server Error: /sso/complete/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/views.py\", line 42, in dispatch\r\n    auth.login(self.request, self.request.user)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 150, in login\r\n    'You have multiple authentication backends configured and '\r\nValueError: You have multiple authentication backends configured and therefore must provide the `backend` argument or set the `backend` attribute on the user.\r\n2018-03-16 14:29:43,242 ERROR    django.request Internal Server Error: /sso/complete/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/views.py\", line 42, in dispatch\r\n    auth.login(self.request, self.request.user)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 150, in login\r\n    'You have multiple authentication backends configured and '\r\nValueError: You have multiple authentication backends configured and therefore must provide the `backend` argument or set the `backend` attribute on the user.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/wsgi.py\", line 157, in __call__\r\n    response = self.get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 124, in get_response\r\n    response = self._middleware_chain(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 43, in inner\r\n    response = response_for_exception(request, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 93, in response_for_exception\r\n    response = handle_uncaught_exception(request, get_resolver(get_urlconf()), sys.exc_info())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 143, in handle_uncaught_exception\r\n    return callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 88, in handle_500\r\n    return handle_error(request, 500, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 40, in render\r\n    output = self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 166, in render\r\n    values = self.sequence.resolve(context, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 736, in resolve\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 243, in items\r\n    return value.items()\r\nAttributeError: 'NoneType' object has no attribute 'items'\r\n[pid: 26|app: 0|req: 166/1133] 192.168.2.6 () {48 vars in 1247 bytes} [Fri Mar 16 14:29:43 2018] GET /sso/complete/ => generated 0 bytes in 41 msecs (HTTP/1.1 500) 0 headers in 0 bytes (0 switches on core 0)\r\n2018/03/16 14:29:43 [error] 25#0: *2287 upstream prematurely closed connection while reading response header from upstream, client: 192.168.2.6, server: _, request: \"GET /sso/complete/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx.url.com\", referrer: \"https://awx.url.com/\"\r\n2018-03-16 14:29:43,296 ERROR    django.request Internal Server Error: /sso/complete/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/views.py\", line 42, in dispatch\r\n    auth.login(self.request, self.request.user)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 150, in login\r\n    'You have multiple authentication backends configured and '\r\nValueError: You have multiple authentication backends configured and therefore must provide the `backend` argument or set the `backend` attribute on the user.\r\n2018-03-16 14:29:43,296 ERROR    django.request Internal Server Error: /sso/complete/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/views.py\", line 42, in dispatch\r\n    auth.login(self.request, self.request.user)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 150, in login\r\n    'You have multiple authentication backends configured and '\r\nValueError: You have multiple authentication backends configured and therefore must provide the `backend` argument or set the `backend` attribute on the user.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/wsgi.py\", line 157, in __call__\r\n    response = self.get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 124, in get_response\r\n    response = self._middleware_chain(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 43, in inner\r\n    response = response_for_exception(request, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 93, in response_for_exception\r\n    response = handle_uncaught_exception(request, get_resolver(get_urlconf()), sys.exc_info())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 143, in handle_uncaught_exception\r\n    return callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 88, in handle_500\r\n    return handle_error(request, 500, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 40, in render\r\n    output = self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 166, in render\r\n    values = self.sequence.resolve(context, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 736, in resolve\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 243, in items\r\n    return value.items()\r\nAttributeError: 'NoneType' object has no attribute 'items'\r\n2018/03/16 14:29:43 [error] 25#0: *2287 upstream prematurely closed connection while reading response header from upstream, client: 192.168.2.6, server: _, request: \"GET /sso/complete/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx.url.com\", referrer: \"https://awx.url.com/\"\r\n192.168.2.6 - - [16/Mar/2018:14:29:43 +0000] \"GET /sso/complete/ HTTP/1.1\" 502 173 \"https://awx.url.com/\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:59.0) Gecko/20100101 Firefox/59.0\"\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nDemo project can not be deleted from Projects on fresh deploy of AWX  1.0.4.97 from Docker hub official images.\r\n\r\nLogs from awx_web container:\r\nhttps://pastebin.com/9QDS84Sf\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.97\r\n* AWX install method: docker linux\r\n* Operating System: Docker\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n1. run awx stack on version 1.0.4.97\r\n2. try to delete demo project from projects\r\n3. Error shows up ( Call to /api/v2/projects/4/ failed. DELETE returned status: 500 A server error has occurred. ) \r\n4. more logs in awx_web\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nToken creation for Applications with the implicit grant type that are public type form the `api/o/tokens` endpoint currently does not work.   \r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n```\r\ncurl -kX POST \"https://localhost:8043/api/o/token/\" -d \"grant_type=password&username=root&password=reverse&scope=read\" -u \"vwyeo1gtZWMJuJgEdPMdS1X9f8vRSSLxlqF4YAPN\"\r\n```\r\nShould yield a token if the user is logged in to AWX with session auth.  \r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n{\"error\": \"invalid_client\"}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis is likely due to how the client_secret is \"removed\" from implicit applications.  \r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nWhen an access token is made for an implicit grant, a refresh token should not be made.  This may be done correctly at the `api/o/token` endpoint, but needs to be fixed at the `api/v2/tokens`, `api/v2/applications/N/tokens`, and `api/v2/users/N/authorized-tokens`.  \r\n\r\nBased on: https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-dev-understanding-oauth2-implicit-grant\r\n\r\n> The implicit grant flow does not issue refresh tokens, mostly for security reasons. A refresh token isn’t as narrowly scoped as access tokens, granting far more power hence inflicting far more damage in case it is leaked out. In the implicit flow, tokens are delivered in the URL, hence the risk of interception is higher than in the authorization code grant.\r\n\r\n\r\n##### ENVIRONMENT\r\nawx: 1.0.4.94\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Make implicit application with POST to applications endpoint.\r\n2. Create tokens for this application\r\n3. Using dbshell, you can see that a RefreshToken is made.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo RefreshTokens should be made for tokens made for applications with implicit grants.  \r\n\r\n##### ACTUAL RESULTS\r\nThere are.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n1. Verify if this works or not with a curl to `api/o/token`\r\n2. Conditionally remove creation of RefreshToken from the token serializers. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nMy machine running AWX has 4GB. When process start, everything is well. After a few hours/days, the web docker is filling up the RAM and random processes OOM (usually tasks because celery creates and deletes workers all the time)\r\n\r\nIf I restart the `web` docker, I'm good again for a few hours.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.58\r\n* AWX install method: docker on linux\r\n* Ansible version:  I guess it's irrelevant but 2.4.3.0\r\n* Operating System: Debian\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nFrom a clean instance, on a machine with 4 GB (corresponding to official recommendations)\r\n- Define 1 organization, 2 projects, ~20 job templates\r\n- Launch about 10 jobs per day\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWorks\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOut of memory errors frequently, tasks marked as failed because they disappeared from the broker...\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```console\r\n$ free -hm\r\n              total        used        free      shared  buff/cache   available\r\nMem:           3,9G        3,4G        159M         97M        290M        137M\r\nSwap:            0B          0B          0B\r\n\r\n$ docker-compose restart web\r\nRestarting awx_web_1 ... done\r\n# (navigating on the website, making sure it has loaded the code)\r\n$ free -hm                          \r\n              total        used        free      shared  buff/cache   available\r\nMem:           3,9G        1,2G        2,4G         97M        324M        2,4G\r\nSwap:            0B          0B          0B\r\n```\r\n\r\nI'll try to find OOM output, but, as you guess, they're exceptions when allocating stuff.\r\n\r\n**EDIT** Forgot to mention: I've used `top` in the docker to verify that it's actually uwsgi and not daphne or nginx that's taking all the space."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nWhen using the set_fact method and the variable to set involves using a template, AWX intermittently throws the following templating error:\r\n\r\n`\"msg\": \"Unexpected templating type error occurred on ({{ ((dir_output.stdout_lines[0])[-1] | regex_search(regexp,'\\\\\\\\g<fs>') | list)[0] | int }}): 'NoneType' object is not iterable\"`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.78\r\n* AWX install method: docker on linux,\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Red Hat 4.8.5-16\r\n* Web Browser: Google Chrome Version 65.0.3325.162 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nTo reproduce, use the set_fact method and try to set the variable value based upon the result of a regular expression using a template:\r\n\r\nFor example:\r\n\r\n`    - name: Check flash directory free space\r\n      asa_command:\r\n        commands:\r\n          - command: \"dir {{ new_image.filesystem }}\"\r\n      register: dir_output\r\n    - name: Record number of bytes free within Flash\r\n      set_fact:\r\n        flash_free_space: \"{{ ((dir_output.stdout_lines[0])[-1] | regex_search(regexp,'\\\\g<fs>') | list)[0] | int }}\"\r\n      vars:\r\n        regexp: '(?P<fs>[0-9]*) bytes free'`\r\n\r\nThe code snippet above looks to record the number of bytes free within the flash directory of a Cisco ASA device by looking at the end of the output and locating the value next to \"bytes free\".\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nThe following result is expected:\r\n\r\n`\"ansible_facts\": {\r\n        \"flash_free_space\": \"154906624\"\r\n    }`\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nThe following result is observed, albeit intermittently:\r\n\r\n`\"msg\": \"Unexpected templating type error occurred on ({{ ((dir_output.stdout_lines[0])[-1] | regex_search(regexp,'\\\\\\\\g<fs>') | list)[0] | int }}): 'NoneType' object is not iterable\"`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nThe AWX UI doesn't appear to refresh for on-going tasks. For example, starting a job, the job always remains at pending unless you manually refresh the page.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.70\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: RHEL7 Docker\r\n* Web Browser: Chrome and Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nStart a job of any kind.\r\n\r\n##### EXPECTED RESULTS\r\nThe UI should automatically refresh as the job goes from Pending to In Progress to Complete and the activity log to automatically update.\r\n\r\n##### ACTUAL RESULTS\r\nThe job appears to stay in pending until the browser is manually refreshed.\r\n\r\nThis did work in earlier versions of AWX. Is this a new regression?"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nI am unable to create inventory source based on custom script.\r\nFor previous versions (<=1.0.4.0), it is working fine. Now I am facing the following error while using the version 1.0.4.83\r\n\r\n![image](https://user-images.githubusercontent.com/30578850/37396035-079db102-2778-11e8-90d8-5baac97b9297.png)\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.83\r\n* AWX install method: openshift\r\n* Ansible version:  2.4.3.0\r\n* Operating System: ubuntu 16.04\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate inventory script [working fine]\r\nCreate inventory [working fine]\r\nCreate inventory source based on custom script: select the newly created inventory, click on sources, add sources, choose custom script as source and select the created one, set a name and click on Save. [Then the problem appears]\r\n\r\n##### EXPECTED RESULTS\r\n\r\ninventory source based on custom script created successfully\r\n\r\n##### ACTUAL RESULTS\r\n\r\n![image](https://user-images.githubusercontent.com/30578850/37396035-079db102-2778-11e8-90d8-5baac97b9297.png)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWebUI User variable not available in Job runs.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.327 \r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n\r\n##### ADDITIONAL INFORMATION\r\nEmail to Forum resulted in the following exchange, prompting me to open an issue. Transcript:\r\n\r\nMatthew Jones <majones@redhat.com>\r\n\r\nAt one time we put the username in as an extra var but it looks like that's somehow being omitted from anything ad-hoc jobs right now. Can you open an issue for us to add that and the email address back to job runs?  I'll point out that, even when populated, it will not be populated when jobs are launched via schedules etc.\r\n\r\n------\r\nHowdy everyone,\r\n\r\nWondering if you could direct me to what I am looking for.\r\n\r\nWhen you launch a template and the job starts, one of the details of the job, is \"Launched By\" and the username of the user. If you click on the user, it shows you a username, first and last name and email address.\r\n\r\nIn my survey that builds EC2 instances, we have a filed for person launching the template to enter their email address. That info is used to add a tag to the EC2 instance called \"Requestor\".\r\n\r\nI was wondering if there was a way to access the WebUI variable for \"Launched By\" users email address and auto fill my survey filed that asks for the info.\r\n\r\nThanks!\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n- attempting to delete an inventory script through the UI results in a 500 error being displayed to the user.\r\n\r\n##### STEPS TO REPRODUCE\r\n- create an inventory script\r\n- attempt to delete the inventory script by clicking the trashcan delete icon\r\n\r\n##### EXPECTED RESULTS\r\n- the inventory script is deleted or the delete prompt is shown\r\n\r\n##### ACTUAL RESULTS\r\n- nothing visible happens, but a 500 error is indicated in the browser console\r\n\r\n##### ADDITIONAL INFORMATION\r\n<img width=\"879\" alt=\"screen shot 2018-03-13 at 3 51 41 pm\" src=\"https://user-images.githubusercontent.com/9753817/37366307-7a71ef24-26d6-11e8-8dc8-13acc9dfd935.png\">\r\n\r\nThe following traceback is present in the awx_web container logs:\r\n\r\n```\r\nAttributeError: 'super' object has no attribute 'accessible_pk_qs'\r\n2018-03-13 19:49:42,026 ERROR    django.request Internal Server Error: /api/v2/inventory_sources/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 45, in list\r\n    return self.get_paginated_response(serializer.data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 742, in data\r\n    ret = super(ListSerializer, self).data\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 262, in data\r\n    self._data = self.to_representation(self.instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 660, in to_representation\r\n    self.child.to_representation(item) for item in iterable\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 2070, in to_representation\r\n    ret = super(InventorySourceSerializer, self).to_representation(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 683, in to_representation\r\n    return super(UnifiedJobTemplateSerializer, self).to_representation(obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 504, in to_representation\r\n    ret[field.field_name] = field.to_representation(attribute)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 1816, in to_representation\r\n    return method(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 346, in _get_summary_fields\r\n    return {} if obj is None else self.get_summary_fields(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 2038, in get_summary_fields\r\n    summary_fields = super(InventorySourceSerializer, self).get_summary_fields(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 1973, in get_summary_fields\r\n    summary_fields = super(InventorySourceOptionsSerializer, self).get_summary_fields(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 407, in get_summary_fields\r\n    user_capabilities = self._obj_capability_dict(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 436, in _obj_capability_dict\r\n    model, qs, prefetch_list, view.request.user\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/utils/common.py\", line 571, in prefetch_page_capabilities\r\n    filter_args.append(Q(**{'pk__in': model.accessible_pk_qs(user, '%s_role' % role_type)}))\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 199, in accessible_pk_qs\r\n    return super(UnifiedJobTemplate, cls).accessible_pk_qs(accessor, role_field)\r\nAttributeError: 'super' object has no attribute 'accessible_pk_qs'\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n- attempting to open the workflow editor in the UI results in a 500 error being displayed to the user.\r\n\r\n##### STEPS TO REPRODUCE\r\n- create a workflow job template\r\n- open the edit panel for the workflow job template\r\n- click the \"workflow editor button\"\r\n\r\n##### EXPECTED RESULTS\r\n- the workflow editor becomes visible\r\n\r\n##### ACTUAL RESULTS\r\n- a 500 error notification is displayed\r\n\r\n##### ADDITIONAL INFORMATION\r\n<img width=\"1291\" alt=\"screen shot 2018-03-13 at 2 52 22 pm\" src=\"https://user-images.githubusercontent.com/9753817/37363515-8681352a-26ce-11e8-8782-4a82d880c32a.png\">\r\n\r\nThe following traceback is present in the awx_web container logs:\r\n\r\n```\r\nAttributeError: 'super' object has no attribute 'accessible_pk_qs'\r\n2018-03-13 19:49:42,026 ERROR    django.request Internal Server Error: /api/v2/inventory_sources/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/usr/lib/python2.7/site-packages/awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 45, in list\r\n    return self.get_paginated_response(serializer.data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 742, in data\r\n    ret = super(ListSerializer, self).data\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 262, in data\r\n    self._data = self.to_representation(self.instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 660, in to_representation\r\n    self.child.to_representation(item) for item in iterable\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 2070, in to_representation\r\n    ret = super(InventorySourceSerializer, self).to_representation(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 683, in to_representation\r\n    return super(UnifiedJobTemplateSerializer, self).to_representation(obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 504, in to_representation\r\n    ret[field.field_name] = field.to_representation(attribute)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 1816, in to_representation\r\n    return method(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 346, in _get_summary_fields\r\n    return {} if obj is None else self.get_summary_fields(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 2038, in get_summary_fields\r\n    summary_fields = super(InventorySourceSerializer, self).get_summary_fields(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 1973, in get_summary_fields\r\n    summary_fields = super(InventorySourceOptionsSerializer, self).get_summary_fields(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 407, in get_summary_fields\r\n    user_capabilities = self._obj_capability_dict(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 436, in _obj_capability_dict\r\n    model, qs, prefetch_list, view.request.user\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/utils/common.py\", line 571, in prefetch_page_capabilities\r\n    filter_args.append(Q(**{'pk__in': model.accessible_pk_qs(user, '%s_role' % role_type)}))\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 199, in accessible_pk_qs\r\n    return super(UnifiedJobTemplate, cls).accessible_pk_qs(accessor, role_field)\r\nAttributeError: 'super' object has no attribute 'accessible_pk_qs'\r\n```"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen the 'Delete on Update' and 'Update on Launch' options are activated in an SCM project, it should be possible to execute several different or the same playbook within one project.\r\n\r\nThe background is, that in our case each project is executed on 3 to 4 inventories. However, when I have only one inventory and start several different playbooks on it at the same time, the issue also occurs.\r\n\r\n Here, a function should be built which creates a working copy of the content, e.g. after an SCM update, on which it can work. Further, an SCM update should be able to wait for another update until the loaded version was copied (or relocated) into the working directory."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen setting up a project from a repo on GitHub (private or public) the sync of the repo fails. I believe this is due to the fact that the AWX is required to go through a proxy to get to the outside world.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.3.70\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: RHEL 7.4\r\n* Web Browser: Chrome 64\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nDirectly after install go to Projects and add a new Project that is hosted on GitHub. Fill in correct parameters for Project. Save. The project will fail to be pulled when you are behind an outbound proxy.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe project to be pulled.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe project pull fails. Says to look at STDIO but nothing is displayed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI have read through (http://docs.ansible.com/ansible-tower/latest/html/administration/proxy-support.html) but I believe this is when a proxy is in front of AWX for inbound traffic.\r\n\r\nRelevant logs from awx_task\r\n\r\n```\r\n[2018-03-12 18:32:37,311: INFO/MainProcess] Received task: awx.main.tasks.run_project_update[4ac2b0f2-17b2-4bf7-996b-6a698a02e61d]\r\n[2018-03-12 18:32:37,311: INFO/MainProcess] Scaling up 1 processes.\r\n[2018-03-12 18:32:37,315: DEBUG/Worker-37] Closed channel #1\r\n[2018-03-12 18:32:37,516: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1fa7488> (args:(u'awx.main.tasks.run_project_update', u'4ac2b0f2-17b2-4bf7-996b-6a698a02e61d', [7], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [7], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower'}, u'expires': None, u'hostname': 'celery@awx', u'task': u'awx.main.tasks.run_project_update', u'callbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_success', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'task_actual': {u'type': u'project_update', u'id': 7}}, u'options': {}}], u'correlation_id': u'4ac2b0f2-17b2-4bf7-996b-6a698a02e61d', u'errbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_error', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'subtasks': [{u'type': u'project_update', u'id': 7}]}, u'options': {}}], u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to':... kwargs:{})\r\n[2018-03-12 18:32:37,521: DEBUG/MainProcess] basic.qos: prefetch_count->140\r\n[2018-03-12 18:32:37,531: INFO/MainProcess] Task awx.main.scheduler.tasks.run_job_launch[0af4bf87-8288-403d-a34d-0da0b9727d05] succeeded in 1.563852333s: None\r\n[2018-03-12 18:32:37,538: DEBUG/MainProcess] Task accepted: awx.main.tasks.run_project_update[4ac2b0f2-17b2-4bf7-996b-6a698a02e61d] pid:251\r\n2018-03-12 18:32:37,642 ERROR    awx.main.tasks project_update 7 (running) Post run hook errored.\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 1014, in run\r\n    self.post_run_hook(instance, status, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 1684, in post_run_hook\r\n    fd = open(self.revision_path, 'r')\r\nAttributeError: 'RunProjectUpdate' object has no attribute 'revision_path'\r\n2018-03-12 18:32:37,777 WARNING  awx.main.tasks project_update 7 (error) encountered an error (rc=None), please see task stdout for details.\r\n[2018-03-12 18:32:37,791: DEBUG/Worker-37] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@43205256709e', u'platform': u'Erlang/OTP 20.2.2', u'version': u'3.7.3'}, mechanisms: [u'AMQPLAIN', u'PLAIN'], locales: [u'en_US']\r\n[2018-03-12 18:32:37,796: DEBUG/Worker-37] Open OK!\r\n[2018-03-12 18:32:37,796: DEBUG/Worker-37] using channel_id: 1\r\n[2018-03-12 18:32:37,799: DEBUG/Worker-37] Channel open\r\n[2018-03-12 18:32:37,803: INFO/MainProcess] Received task: awx.main.tasks.handle_work_error[94cc6f94-2a8b-48d1-a21f-c25cee694cf1]\r\n[2018-03-12 18:32:37,804: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1fa7488> (args:(u'awx.main.tasks.handle_work_error', u'94cc6f94-2a8b-48d1-a21f-c25cee694cf1', [u'4ac2b0f2-17b2-4bf7-996b-6a698a02e61d'], {u'subtasks': [{u'type': u'project_update', u'id': 7}]}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': u'1030d988-6c80-40cf-a143-602da34ca261', u'args': [u'4ac2b0f2-17b2-4bf7-996b-6a698a02e61d'], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower'}, u'expires': None, u'hostname': 'celery@awx', u'task': u'awx.main.tasks.handle_work_error', u'callbacks': None, u'correlation_id': u'94cc6f94-2a8b-48d1-a21f-c25cee694cf1', u'errbacks': None, u'timelimit': [None, None], u'taskset': u'1030d988-6c80-40cf-a143-602da34ca261', u'kwargs': {u'subtasks': [{u'type': u'project_update', u'id': 7}]}, u'eta': None, u'reply_to': u'80209b5a-1841-3338-8df6-dbdee030031c', u'id': u'94cc6f94-2a8b-48d1-a21f-c25cee694cf1', u'headers': {}}) kwargs:{})\r\n[2018-03-12 18:32:37,810: DEBUG/MainProcess] Task accepted: awx.main.tasks.handle_work_error[94cc6f94-2a8b-48d1-a21f-c25cee694cf1] pid:252\r\n[2018-03-12 18:32:37,819: DEBUG/Worker-37] Closed channel #1\r\n[2018-03-12 18:32:37,838: ERROR/MainProcess] Task awx.main.tasks.run_project_update[4ac2b0f2-17b2-4bf7-996b-6a698a02e61d] raised unexpected: Exception('project_update 7 (error) encountered an error (rc=None), please see task stdout for details.',)\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 240, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 438, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 592, in _wrapped\r\n    return f(self, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 1035, in run\r\n    raise AwxTaskError.TaskError(instance, rc)\r\nException: project_update 7 (error) encountered an error (rc=None), please see task stdout for details.\r\n2018-03-12 18:32:37,867 DEBUG    awx.main.tasks Executing error task id 4ac2b0f2-17b2-4bf7-996b-6a698a02e61d, subtasks: [{u'type': u'project_update', u'id': 7}]\r\n[2018-03-12 18:32:37,941: DEBUG/Worker-38] Start from server, version: 0.9, properties: {u'information': u'Licensed under the MPL.  See http://www.rabbitmq.com/', u'product': u'RabbitMQ', u'copyright': u'Copyright (C) 2007-2018 Pivotal Software, Inc.', u'capabilities': {u'exchange_exchange_bindings': True, u'connection.blocked': True, u'authentication_failure_close': True, u'direct_reply_to': True, u'basic.nack': True, u'per_consumer_qos': True, u'consumer_priorities': True, u'consumer_cancel_notify': True, u'publisher_confirms': True}, u'cluster_name': u'rabbit@43205256709e', u'platform': u'Erlang/OTP 20.2.2', u'version': u'3.7.3'}, mechanisms: [u'AMQPLAIN', u'PLAIN'], locales: [u'en_US']\r\n[2018-03-12 18:32:37,946: DEBUG/Worker-38] Open OK!\r\n[2018-03-12 18:32:37,947: DEBUG/Worker-38] using channel_id: 1\r\n[2018-03-12 18:32:37,949: DEBUG/Worker-38] Channel open\r\n[2018-03-12 18:32:37,954: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_job_complete[6840854b-2611-4eb9-8299-c8901d0c2d1e]\r\n[2018-03-12 18:32:37,954: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1fa7488> (args:(u'awx.main.scheduler.tasks.run_job_complete', u'6840854b-2611-4eb9-8299-c8901d0c2d1e', [7], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [7], u'retries': 0, u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower'}, u'expires': None, u'hostname': 'celery@awx', u'task': u'awx.main.scheduler.tasks.run_job_complete', u'callbacks': None, u'correlation_id': u'6840854b-2611-4eb9-8299-c8901d0c2d1e', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'80209b5a-1841-3338-8df6-dbdee030031c', u'id': u'6840854b-2611-4eb9-8299-c8901d0c2d1e', u'headers': {}}) kwargs:{})\r\n[2018-03-12 18:32:37,957: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_job_complete[6840854b-2611-4eb9-8299-c8901d0c2d1e] pid:251\r\n[2018-03-12 18:32:37,958: DEBUG/Worker-38] Closed channel #1\r\n[2018-03-12 18:32:37,974: INFO/MainProcess] Task awx.main.tasks.handle_work_error[94cc6f94-2a8b-48d1-a21f-c25cee694cf1] succeeded in 0.169628502976s: None\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe want to prevent Org admins being able to create local users within tower. All our controls are based around ldap groups. We want to prevent teams with their own orgs being able to create local users in awx, as this breaks our standard. We therefore need finer grained RBAC rules. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.173\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.4.3\r\n* Operating System: RHEL 7.x\r\n* Web Browser: Chrome\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nAWX currently sets no CORS policy. This means that all cross-origin requests from a browser are denied.\r\n\r\nWhile secure (fail-closed), a user may want to build a frontend that talks to the API, and therefore conditionally allow some domain requests. This would require AWX to have a CORS policy that allows some user-configured domains.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis would be off by default."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThe `help_text` of a credential type field is defined inside of the JSON definition of the fields in the database, getting translations for this is different from ordinary fields and will take extra work to solve.\r\n\r\nThis is only a problem for managed_by_tower credential types. Users will write help text for their custom types in whatever language they prefer.\r\n\r\nRight now the `help_text` is static. This issue is to make it translated like how other text is translated.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nSomeday, django-polymorphic might implement https://github.com/django-polymorphic/django-polymorphic/issues/198.\r\n\r\nIf that glorious future comes to pass, we should use it.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nWe pass `*_user_name` and `*_user_id` to jobs launched by a user. It could be useful to pass other\r\nuser fields (email, etc.) or perhaps the whole user structure.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis should come with the understanding that fields beyond username/id are mutable by the user in many cases.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nConsider the job activity stream entry:\r\n\r\n```json\r\n        {\r\n            \"id\": 1891,\r\n            \"type\": \"activity_stream\",\r\n            \"url\": \"/api/v1/activity_stream/1891/\",\r\n            \"related\": {\r\n                \"job\": [\r\n                    \"/api/v1/jobs/20/\"\r\n                ]\r\n            },\r\n            \"summary_fields\": {\r\n                \"job\": [\r\n                    {\r\n                        \"status\": \"failed\",\r\n                        \"description\": \"\",\r\n                        \"elapsed\": 0.0,\r\n                        \"failed\": true,\r\n                        \"id\": 20,\r\n                        \"name\": \" Job Template 1 Project 0-0\"\r\n                    }\r\n                ],\r\n                \"job_template\": [\r\n                    {\r\n                        \"description\": \"\",\r\n                        \"id\": 40,\r\n                        \"name\": \" Job Template 1 Project 0\"\r\n                    }\r\n                ]\r\n            },\r\n            \"timestamp\": \"2017-02-01T16:33:01.887634Z\",\r\n            \"operation\": \"create\",\r\n            \"changes\": {\r\n                \"description\": \"\",\r\n                \"credential\": \" Credential 1 User 0-8\",\r\n                \"network_credential\": null,\r\n                \"name\": \" Job Template 1 Project 0-0\",\r\n                \"job_template\": \" Job Template 1 Project 0-40\",\r\n                \"job_tags\": \"\",\r\n                \"extra_vars\": \"\",\r\n                \"verbosity\": 0,\r\n                \"allow_simultaneous\": false,\r\n                \"job_type\": \"run\",\r\n                \"start_at_task\": \"\",\r\n                \"id\": 20,\r\n                \"project\": \" Project 1 Org 0-30\",\r\n                \"skip_tags\": \"\",\r\n                \"limit\": \"\",\r\n                \"inventory\": \" Inventory 1 Org 0-7\",\r\n                \"timeout\": 0,\r\n                \"forks\": 0,\r\n                \"cloud_credential\": null,\r\n                \"force_handlers\": false,\r\n                \"playbook\": \"\"\r\n            },\r\n            \"object1\": \"job\",\r\n            \"object2\": \"\",\r\n            \"object_association\": \"\"\r\n        },\r\n```\r\n\r\nEven through this is a `create` action, the job template is listed in the summary_fields.\r\n\r\nNow consider groups, workflow nodes, and labels. These all objects which have a tight-coupling to a parent object. Consider WFJT node:\r\n\r\n```json\r\n        {\r\n            \"id\": 783,\r\n            \"type\": \"activity_stream\",\r\n            \"url\": \"/api/v1/activity_stream/783/\",\r\n            \"related\": {\r\n                \"workflow_job_template_node\": [\r\n                    \"/api/v1/workflow_job_template_nodes/1/\"\r\n                ]\r\n            },\r\n            \"summary_fields\": {\r\n                \"workflow_job_template_node\": [\r\n                    {\r\n                        \"unified_job_template_id\": 40,\r\n                        \"id\": 1\r\n                    }\r\n                ]\r\n            },\r\n            \"timestamp\": \"2017-02-01T16:32:50.244372Z\",\r\n            \"operation\": \"create\",\r\n            \"changes\": {\r\n                \"credential\": \" Credential 1 User 0-8\",\r\n                \"created\": \"2017-02-01 16:32:50.241822+00:00\",\r\n                \"modified\": \"2017-02-01 16:32:50.241914+00:00\",\r\n                \"unified_job_template\": \" Job Template 1 Project 0-40\",\r\n                \"inventory\": \" Inventory 1 Org 0-7\",\r\n                \"char_prompts\": \"{}\",\r\n                \"workflow_job_template\": \" WFJT 1 Org 0-60\",\r\n                \"id\": 1\r\n            },\r\n            \"object1\": \"workflow_job_template_node\",\r\n            \"object2\": \"\",\r\n            \"object_association\": \"\"\r\n        }\r\n```\r\n\r\nIt puts the unified job template id in the summary fields, but we would probably prefer the full set of information like jobs. This issue is to handle these cases broadly for all similar scenarios.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nMaking a request using a PAT as authentication leaves an activity stream entry in its wake.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-171\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version: N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUse the branch for tower-cli oauth2 support (thanks @ryanpetrello !)\r\n\r\n```\r\ntower-cli login admin\r\ntower-cli user list\r\ntower-cli user list\r\ntower-cli user list\r\ntower-cli user list\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1 activity stream entry.\r\n\r\nIf that. 0 sounds more reasonable\r\n\r\n##### ACTUAL RESULTS\r\n\r\n2 for logging in.\r\n\r\n4 more entries, one for each `user list` command issued.\r\n\r\nOne of the entries from the list command\r\n\r\n```json\r\n{\r\n    \"id\": 595,\r\n    \"type\": \"activity_stream\",\r\n    \"url\": \"/api/v2/activity_stream/595/\",\r\n    \"related\": {\r\n        \"access_token\": \"*************\",\r\n        \"actor\": \"/api/v2/users/1/\"\r\n    },\r\n    \"summary_fields\": {\r\n        \"actor\": {\r\n            \"username\": \"admin\",\r\n            \"first_name\": \"\",\r\n            \"last_name\": \"\",\r\n            \"id\": 1\r\n        },\r\n        \"access_token\": \"*************\"\r\n    },\r\n    \"timestamp\": \"2018-03-09T20:03:02.068234Z\",\r\n    \"operation\": \"update\",\r\n    \"changes\": {\r\n        \"last_used\": [\r\n            \"2018-03-09 20:02:30.950601+00:00\",\r\n            \"2018-03-09 20:03:02.001484+00:00\"\r\n        ]\r\n    },\r\n    \"object1\": \"o_auth2_access_token\",\r\n    \"object2\": \"\",\r\n    \"object_association\": \"\"\r\n}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe have the new 'invalid' marker on job templates with missing components.\r\n\r\nIt should also show for:\r\n- workflows with missing nodes (deleted JT, or deleted project/inventory that there was a sync node for)\r\n- workflows with invalid JTs (as denoted by the existing invalid marker)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.64\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThe activity stream is currently very fine-grained. While this allows detailed look at changes, this does lead to verbosity.\r\n\r\nMany edits in AWX are a series of related changes - adding a user + associating it with an org/team. Adding a job template + adding a survey + adding permissions + adding notifications. An inventory update creates a flurry of activity stream entries for associating hosts to groups.\r\n\r\nThis leads to a very verbose activity stream, and collapsing some of these into single larger events may be useful.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nShift OAuth2 permissions scheme by relying on a FK on the Application model to Organization rather than to User (as is currently the case and is default for DOT).  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.31\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.0.3\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAn Application should \r\n\r\n##### ACTUAL RESULTS\r\n\r\nApplications currently have to specify a user of that application.  This change will make it so that you specify an org for that user.  \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nTo fix, the application model we will have to add an organization field on the application model.  The user field may be able to go.  \r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAllow Notification Admin for an organization to toggle notifications for any resource they have read access to. Currently you must have change access.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nSCM update keeps pending infinitely\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.64\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Ubuntu 16.04 Xenial\r\n* Web Browser: Chrome, Firefox, Edge\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nProjects > Get latest SCM version > Stuck in pending mode infinitely\r\nTemplates > Job > Launch job > Stuck in pending mode infinitely (probably because the job is triggering the SCM update process)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSCM update succesful\r\n\r\n##### ACTUAL RESULTS\r\n\r\nStays in pending mode, no stdout logs are generated in the UI\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![image](https://user-images.githubusercontent.com/20809792/37209704-74c28c2e-23a6-11e8-9c8b-37994a0e9a99.png)\r\n![image](https://user-images.githubusercontent.com/20809792/37209762-a7c28778-23a6-11e8-8a7a-cdda5d12025e.png)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nNo more than 4 jobs running in the same time despite an important RAM addition.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.48\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.3\r\n* Operating System: Red Hat 7.4\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nUpgrade RAM from 4 to 25Gb and CPU from 2 to 4. Launch multiple job from UI (more 4 jobs).\r\n\r\n##### EXPECTED RESULTS\r\nAWX should launch more than 4 jobs in the same time.\r\n\r\n##### ACTUAL RESULTS\r\nWhen I try to run many jobs from same (or different) jobs templates and targeting same (or different) remote hosts, I cannot get more than 4 jobs running in the same time, the others stay in the waiting queue.\r\n\r\n##### ADDITIONAL INFORMATION\r\n![awx](https://user-images.githubusercontent.com/32674944/37198127-84db3bac-237d-11e8-94ee-415964b70895.PNG)\r\n\r\nI tested the same template (with same project, playbook, inventory) on the trial version of tower and I actually went ~20 jobs simultaneously on the same server configuration.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThe option 'Prompt on launch' should be available additionally in the configuration of the job template in the 'Playbook' field. Quite reasonably, the to-be-selected playbook should be selectable from the list of the executable playbooks of the project during the execution of the job template.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0\r\n\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n \r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nI want to receive color notification in Slack as Hipchat notification.\r\nTo use color is more user friendly.\r\n\r\nTo send attatchments is not supported with RTM API , but supported with Web API.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.48\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: CentOS7\r\n* Web Browser: google chrome\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<img width=\"399\" alt=\"2018-03-07 17 24 05\" src=\"https://user-images.githubusercontent.com/13479783/37185017-a3799b7c-2381-11e8-846e-ceb58b786745.png\">\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nUpstream `uwsgi` does not respond. The web interface intermittently gives 502 errors and awx_web says `no live upstreams while connecting to upstream, client: X.X.X.X, server: _, request: \"GET /\", upstream: \"uwsgi://uwsgi`. This is on a fresh install using docker-compose.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.62\r\n* AWX install method: Docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Mozilla Firefox 58.0.2\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nStandard install using docker compose.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPages and the API loading properly.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nUI gives errors like - `Invalid search term entered. GET returned: 502`\r\nOr just times out with 502 Bad Gateway.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSample log from awx_web -\r\n```[pid: 30|app: 0|req: 62/130] 192.168.2.6 () {26 vars in 261 bytes} [Thu Mar  8 22:03:45 2018] GET / => generated 0 bytes in 38 msecs ( 500) 0 headers in 0 bytes (0 switches on core 0)\r\n192.168.2.6 - - [08/Mar/2018:22:03:46 +0000] \"GET /\" 502 173 \"-\" \"-\"\r\n2018/03/08 22:03:50 [error] 25#0: *329 no live upstreams while connecting to upstream, client: 192.168.2.6, server: _, request: \"GET /\", upstream: \"uwsgi://uwsgi\"\r\n192.168.2.6 - - [08/Mar/2018:22:03:50 +0000] \"GET /\" 502 173 \"-\" \"-\"\r\n2018/03/08 22:03:55 [error] 25#0: *330 no live upstreams while connecting to upstream, client: 192.168.2.6, server: _, request: \"GET /\", upstream: \"uwsgi://uwsgi\"\r\n192.168.2.6 - - [08/Mar/2018:22:03:55 +0000] \"GET /\" 502 173 \"-\" \"-\"\r\n2018-03-08 22:04:00,898 ERROR    django.security.DisallowedHost Invalid HTTP_HOST header: u'_:8052'. The domain name provided is not valid according to RFC 1034/1035.\r\n2018-03-08 22:04:00,906 ERROR    django.request Internal Server Error: /\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nJobs can be queued for a variety of reasons:\r\n\r\n- waiting on dependent SCM update\r\n- waiting on dependent inventory update\r\n- blocked due to another instance of the same job\r\n- blocked to another job which has the inventory locked (see above 'dependent inventory update')\r\n- waiting on spare job running capacity\r\n\r\nThis should be surfaced somehow, even if just in the UI tooltip/popover.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Create a system auditor user via the UI OR\r\n* POST to `/api/v2/organization/1/users/`\r\n\r\n```\r\n{\r\n\t\"first_name\": \"Djkfd\",\r\n\t\"last_name\": \"Kjdlkf\",\r\n\t\"organization\": 1,\r\n\t\"email\": \"dfdlj@kdjfd.com\",\r\n\t\"username\": \"admin\",\r\n\t\"password\": \"abc123\",\r\n\t\"password_confirm\": \"abc123\",\r\n\t\"user_type\": {\r\n\t\t\"type\": \"system_auditor\",\r\n\t\t\"label\": \"System Auditor\"\r\n\t},\r\n\t\"is_superuser\": false,\r\n\t\"is_system_auditor\": true\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n* For a system auditor user to be created\r\n\r\n##### ACTUAL RESULTS\r\n\r\n500\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n2018-03-08 21:19:35,536 ERROR    django.request Internal Server Error: /api/v2/organizations/1/users/\r\nTraceback (most recent call last):\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"./awx/wsgi.py\", line 65, in _legacy_get_response\r\n    return super(AWXWSGIHandler, self)._legacy_get_response(request)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"./awx/api/generics.py\", line 284, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 494, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 454, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 491, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"./awx/api/views.py\", line 968, in post\r\n    user = User.objects.get(id=ret.data['id'])\r\nKeyError: 'id'\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nFollowon of https://github.com/ansible/awx/issues/1207\r\n\r\nEssentially, once we can register an isolated node (or something like it) on demand, there's no reason how AWX runs jobs can't change to a simple:\r\n\r\n- create job\r\n- spin up a per-job-run container\r\n- run job\r\n- kill container\r\n\r\nThis has many followon questions:\r\n- does this obsolete instance groups?\r\n- how does this work with custom venvs?\r\n- what's the best mechanism for passing the runtime environment?\r\n\r\nIn general, this requires that we be able to talk to our container orchestrator to spin up the job running containers. So this may limit supported platforms.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n`/api/v2/workflow_job_template_nodes/:id/credentials` gets reverted back to an empty array when the user changes the node from failure->success.  I suspect that this happens no matter what you change the edge type to but I haven't tested all the cases.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.64\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Create a Job Template and select PROMPT ON LAUNCH for credentials\r\n2) Create a Workflow\r\n3) Add a root node (the details of this node are not important)\r\n4) Add a on failure child node extending from the root using the template created in step 1 and select some additional credentials when creating the node.  (this will cause `/api/v2/workflow_job_template_nodes/:id/credentials` to be populated)\r\n\r\nThe workflow should look like:\r\n\r\n<img width=\"1355\" alt=\"screen shot 2018-03-08 at 3 29 23 pm\" src=\"https://user-images.githubusercontent.com/9889020/37174758-86fd00d4-22e5-11e8-98f7-0abc7629447e.png\">\r\n\r\n5) Change the edge type of the child node from On Failure to On Success -> this is where the credentials seem to get wiped.\r\n\r\nIn the UI, the following requests are made:\r\n\r\n1) POST - `/api/v2/workflow_job_template_nodes/:id/failure_nodes/` with the payload `{id: 2, disassociate: true}`\r\n2) PUT - `/api/v2/workflow_job_template_nodes/:id/` with whatever the node overrides are (this step is only necessary if the user has _changed_ something in the prompt modal but we make the request every time)\r\n3) POST - `/api/v2/workflow_job_template_nodes/:id/success_nodes/` with the payload `{id: 2}`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected contents of `/api/v2/workflow_job_template_nodes/:id/credentials` to remain the same while POSTing to the different node buckets.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`/api/v2/workflow_job_template_nodes/:id/credentials` returns empty array after POSTing to the different node buckets.\r\n\r\nThe UI for this workflow node prompting is currently in a local branch but I expect to have a PR up in the next 24 hours or so than can be used for testing.  This could be reproduced through the API browser though with enough effort.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - Installer\r\n\r\n##### SUMMARY\r\nOccasionally, clients have asked about connecting to isolated nodes through bastion hosts. Can we expose the ssh args for isolated groups as group vars during installation?\r\n\r\n##### ENVIRONMENT\r\n* Tower Version - 3.2+\r\n\r\n\r\n##### EXPECTED RESULTS\r\n```\r\n[instance_group_security]\r\ntowerB\r\ntowerC\r\n\r\n[isolated_group_govcloud]\r\nisolatedA\r\nisolatedB\r\n\r\n[isolated_group_govcloud:vars]\r\ncontroller=security\r\nssh_args='-o ProxyCommand=\"ssh -W %h:%p -q user@gateway.example.com\"'\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nOther considerations would include making sure we can authenticate on the jump host."},{"labels":["api",null,null,null],"text":"code:\r\n\r\nhttps://github.com/ansible/awx/blob/953850a0d7875b7a6d18f79ded5059a3083d52c5/awx/main/utils/common.py#L150\r\n\r\nhttp://decorator.readthedocs.io/en/latest/tests.documentation.html#what-s-new-in-version-4\r\n\r\n> Code changes A new utility function decorate(func, caller) has been added. It does the same job that was performed by the older decorator(caller, func). The old functionality is now deprecated and no longer documented, but still available for now.\r\n\r\nSounds like it's not urgent, but we could get bitten by it later.\r\n\r\nI'm not yet entirely clear on how to replace our use pattern from the release notes wording."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nAnsible run seems to use old data\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.14\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.3.0\r\n* Operating System: rhel7\r\n* Web Browser: firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI have a playbook that creates users on the target-servers. There's user `foo`. This user had id `500` sometime in the past. Then I changed the id on the target-servers to `505` and also in the git-repository (see below). Now everytime the playbook runs via awx, the user-id wants to be changed to `500`.\r\n\r\nI verified in the docker-container that the project uses the correct git checkout. I even deleted the project and recreated it. awx also tells me that its using the correct commit id, where the user-id is `505`.\r\n\r\nPlaybook:\r\n```\r\n- hosts: all\r\n  roles:\r\n   - role: user\r\n```\r\n\r\nuser-role:\r\n```\r\n# file: user/tasks/main.yml\r\n\r\n- name: generic-users | Make sure the users are present\r\n  user:\r\n    name: \"{{ item.name }}\"\r\n    group: \"{{ item.group|default(omit) }}\"\r\n    groups: \"{{ ','.join(item.groups)|default(omit) }}\"\r\n    append: \"{{ item.append|default(omit) }}\"\r\n    password: \"{{ item.pass|default(omit) }}\"\r\n    comment: \"{{ item.comment|default(omit) }}\"\r\n    shell: \"{{ item.shell|default(omit) }}\"\r\n    uid: \"{{ item.uid|default(omit) }}\"\r\n    home: \"{{ item.home|default(omit) }}\"\r\n    system: \"{{ item.system|default(omit) }}\"\r\n    state: present\r\n  with_items: \"{{ genericusers_users }}\"\r\n```\r\n\r\ngroup_vars:\r\n```\r\ngenericusers_users:\r\n  - name: \"foo\"\r\n    group: \"foo\"\r\n    groups: []\r\n    shell: \"/bin/bash\"\r\n    home: \"/home/foo\"\r\n    append: \"no\"\r\n    comment: \"foo User\"\r\n    uid: \"505\"\r\n    system: \"yes\"\r\n    ssh_keys: []\r\n```\r\n\r\nIf I run this playbook on the shell from within the docker container, it works flawlessly, meaning the user-id does not get changed to 500.\r\nBut still when running it from awx, the user-id gets changed.\r\n\r\nI restarted all the docker-container and the server running docker, too. It did not help.\r\n\r\nWhat did help is to set the `genericusers_users:` in awx as an extra variable. Then the id stays at `505`.\r\n\r\nI guess there's some cache here at work?\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe user-id does not get changed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nsee above.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![grafik](https://user-images.githubusercontent.com/3198961/37150752-2e0be182-22d3-11e8-9f4b-04e71563db22.png)\r\n\r\n![grafik](https://user-images.githubusercontent.com/3198961/37150767-3fb0fd32-22d3-11e8-8874-36bc1be9a8a2.png)\r\n\r\n![grafik](https://user-images.githubusercontent.com/3198961/37150787-5fc2fa1c-22d3-11e8-9d01-290b114896f3.png)\r\n\r\n```\r\n{\r\n    \"_ansible_parsed\": true,\r\n    \"changed\": false,\r\n    \"_ansible_no_log\": false,\r\n    \"_ansible_item_result\": true,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"comment\": \"foo User\",\r\n            \"ssh_key_bits\": 0,\r\n            \"update_password\": \"always\",\r\n            \"non_unique\": false,\r\n            \"force\": false,\r\n            \"uid\": \"500\",\r\n            \"ssh_key_passphrase\": null,\r\n            \"createhome\": true,\r\n            \"home\": \"/home/foo\",\r\n            \"skeleton\": null,\r\n            \"append\": false,\r\n            \"ssh_key_type\": \"rsa\",\r\n            \"ssh_key_comment\": \"ansible-generated on server\",\r\n            \"group\": \"foo\",\r\n            \"system\": false,\r\n            \"state\": \"present\",\r\n            \"local\": null,\r\n            \"shell\": \"/bin/bash\",\r\n            \"expires\": null,\r\n            \"ssh_key_file\": null,\r\n            \"groups\": [\r\n                \"\"\r\n            ],\r\n            \"move_home\": false,\r\n            \"password\": null,\r\n            \"name\": \"foo\",\r\n            \"seuser\": null,\r\n            \"remove\": false,\r\n            \"login_class\": null,\r\n            \"generate_ssh_key\": null\r\n        }\r\n    },\r\n    \"item\": {\r\n        \"comment\": \"foo User\",\r\n        \"shell\": \"/bin/bash\",\r\n        \"group\": \"foo\",\r\n        \"ssh_keys\": [],\r\n        \"system\": \"no\",\r\n        \"name\": \"foo\",\r\n        \"groups\": [],\r\n        \"home\": \"/home/foo\",\r\n        \"append\": \"no\",\r\n        \"uid\": \"500\"\r\n    },\r\n    \"rc\": 8,\r\n    \"msg\": \"usermod: user foo is currently used by process 1937\\n\",\r\n    \"_ansible_ignore_errors\": null,\r\n    \"name\": \"foo\"\r\n}\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThere seems to be something missing in the newly implemented OAuth.. I'm having problems with websockets.. Daphne is not working correctly:\r\n\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: 2018-03-06 22:20:04,844 WARNING  The current value \"{u'ACCESS_TOKEN_EXPIRE_SECONDS': 31536000000, u'REFRESH_TOKEN_EXPIRE_SECONDS': 31536000000, u'AUTHORIZATION_CODE\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: Traceback (most recent call last):\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: File \"/opt/awx/embedded/lib/python2.7/site-packages/awx/conf/settings.py\", line 371, in _get_local\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: return field.run_validation(value)\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: File \"/opt/awx/embedded/lib/python2.7/site-packages/rest_framework/fields.py\", line 523, in run_validation\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: value = self.to_internal_value(data)\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: File \"/opt/awx/embedded/lib/python2.7/site-packages/awx/api/fields.py\", line 88, in to_internal_value\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: self.fail('invalid_key_names', invalid_key_names=', '.join(list(invalid_flags)))\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: File \"/opt/awx/embedded/lib/python2.7/site-packages/rest_framework/fields.py\", line 585, in fail\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: raise ValidationError(message_string, code=key)\r\nmar 06 22:20:04 akiva.outerrim.lan daphne[10618]: ValidationError: [u'Invalid key names: REFRESH_TOKEN_EXPIRE_SECONDS']\r\n\r\nREFRESH_TOKEN_EXPIRE_SECONDS seems to be missing from:\r\n\r\n/opt/awx/embedded/lib/python2.7/site-packages/awx/api/fields.py\r\n\r\n valid_key_names = {'ACCESS_TOKEN_EXPIRE_SECONDS', 'AUTHORIZATION_CODE_EXPIRE_SECONDS'}\r\n\r\nIf I add it to the list, I no longer get the error, but websockets are still not working..\r\n\r\nI'm using my own RPM build, but just want to let you guys know that there is something wrong.."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.372\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: RHEL 7\r\n* Web Browser: Chrome\r\n\r\npython3.6 installed from epel repo\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nCreate a new custom inventory script with python3 as the source and attempt to run the script.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nScript runs and produces output valid out.\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n2018-03-05 20:50:10,300 INFO     awx.main.commands.inventory_import Updating inventory 5: Should Fail\r\n2018-03-05 20:50:10,314 INFO     awx.main.commands.inventory_import Reading Ansible inventory source: /tmp/awx_inventory_U9Lsxk/tmpSSnZpu\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx==1.0.2.372', 'console_scripts', 'awx-manage')()\r\n  File \"/usr/lib/python2.7/site-packages/awx/__init__.py\", line 109, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 993, in handle\r\n    self.is_custom)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 242, in load_inventory_source\r\n    is_custom=is_custom).load()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 177, in load\r\n    data = self.command_to_json(base_args + ['--list'])\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 160, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=4) with stdout:\r\n\r\nstderr:\r\nERROR! Could not parse inventory source /tmp/awx_inventory_U9Lsxk/tmpSSnZpu with available plugins:\r\nPlugin script failed: Inventory script (/tmp/awx_inventory_U9Lsxk/tmpSSnZpu) had an execution error: Traceback (most recent call last):\r\n  File \"/tmp/awx_inventory_U9Lsxk/tmpSSnZpu\", line 3, in <module>\r\n    import json\r\n  File \"/usr/lib64/python3.6/json/__init__.py\", line 106, in <module>\r\n    from .decoder import JSONDecoder, JSONDecodeError\r\n  File \"/usr/lib64/python3.6/json/decoder.py\", line 3, in <module>\r\n    import re\r\n  File \"/usr/lib64/python3.6/re.py\", line 142, in <module>\r\n    class RegexFlag(enum.IntFlag):\r\nAttributeError: module 'enum' has no attribute 'IntFlag'\r\n```\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\nDoing a bit of googling it looks like the above error is a result of python pointing to the wrong enum.py library, however running the script manually inside the awx_task container functions normally so I expect AWX is doing something on the backend that is causing it to fail\r\n\r\nScript used to produce the output above:\r\n```\r\n#!/usr/bin/python36\r\nimport sys\r\nimport json\r\nprint(json.dumps({sys.version}))\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n1.  Create an inventory and associated inventory source.\r\n2. `InventorySource.objects.get(pk=N).inventory = None` and `save()`\r\n3.  Launch the inventory source.\r\n4.  The task manager will start failing with this traceback:\r\n\r\n```python\r\nawx_1        | 17:44:49 celeryd.1   |     return self.run(*args, **kwargs)\r\nawx_1        | 17:44:49 celeryd.1   |   File \"/awx_devel/awx/main/scheduler/tasks.py\", line 37, in run_task_manager\r\nawx_1        | 17:44:49 celeryd.1   |     TaskManager().schedule()\r\nawx_1        | 17:44:49 celeryd.1   |   File \"/awx_devel/awx/main/scheduler/task_manager.py\", line 628, in schedule\r\nawx_1        | 17:44:49 celeryd.1   |     finished_wfjs = self._schedule()\r\nawx_1        | 17:44:49 celeryd.1   |   File \"/awx_devel/awx/main/scheduler/task_manager.py\", line 615, in _schedule\r\nawx_1        | 17:44:49 celeryd.1   |     self.process_tasks(all_sorted_tasks)\r\nawx_1        | 17:44:49 celeryd.1   |   File \"/awx_devel/awx/main/scheduler/task_manager.py\", line 595, in process_tasks\r\nawx_1        | 17:44:49 celeryd.1   |     self.process_pending_tasks(pending_tasks)\r\nawx_1        | 17:44:49 celeryd.1   |   File \"/awx_devel/awx/main/scheduler/task_manager.py\", line 449, in process_pending_tasks\r\nawx_1        | 17:44:49 celeryd.1   |     preferred_instance_groups = task.preferred_instance_groups\r\nawx_1        | 17:44:49 celeryd.1   |   File \"/awx_devel/awx/main/models/inventory.py\", line 1656, in preferred_instance_groups\r\nawx_1        | 17:44:49 celeryd.1   |     selected_groups = inventory_groups + organization_groups\r\nawx_1        | 17:44:49 celeryd.1   | UnboundLocalError: local variable 'inventory_groups' referenced before assignment\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently, users are always required to enter a username and password for AD authentication into Tower.  This feature request suggests adding SPNEGO support to the AWX UI login to allow for login to UI with established Kerberos credentials without an interactive authentication.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis feature would add another SSO option to Tower to allow login by SPNEGO/Kerberos.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf you have a workflow that runs multiple jobs from the same project in parallel they will interfere with each others galaxy roles install. When each job kicks off it triggers a project scm full update which run ansible-galaxy install with a --force flag. \r\nhttps://github.com/ansible/awx/blob/5370c5e07d701bb4c97381a4969f818339f01db2/awx/playbooks/project_update.yml#L142\r\nThis --force flag will replace the roles in the project and if another job is already running through those roles certain files will go missing at the point the other jobs try to use them. I have mostly encountered this with template files (presumably because these are looked up as needed, where as other files are potentially looked up and evaluated when an the ansible-playbook command starts up).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.33\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a project with two playbooks and a galaxy requirements.yml file in the roles directory\r\n2. Add the project to AWX\r\n3. Create two job templates from that project (one for each playbook)\r\n4. Create a workflow that runs both job templates at the same time\r\n5. Execute the workflow\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe two job templates execute in parallel successfully\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOne of the two jobs fails due to the roles files being replaced after it started executing.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe problem seems to be more pronounced as more jobs run in parallel in the workflow. Quite possibly there is a way of stopping the project from updating for each job template execution, I'm quite new to AWX and maybe there is something I'm missing\r\n\r\n\r\n\r\nhttps://github.com/ansible/awx/blob/5370c5e07d701bb4c97381a4969f818339f01db2/awx/playbooks/project_update.yml#L142"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nWe currently only handle `scm_delete_on_update` for check jobs. (See https://github.com/ansible/awx/commit/1a946d51c13131103561c97c076f628589cdae69).\r\n\r\nThis leads to weird semantics.\r\n\r\nThe option originally existed to handle cases where jobs may leave temporary files in the repo, or other similar issues. Now imagine the following:\r\n- update_on_launch is set\r\n- delete_on_update is set\r\n\r\nIf the update on launch runs on node A, records a revision of X, and the job then runs on node B which already has revision X... nothing will actually be deleted before the job runs. That doesn't mesh with what the expected use of the option is.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIt is difficult (and probably theoretically impossible) to write idempotent scripts for workflows in AWX.\r\n\r\nBranches can't be distinguished from each other in a general sense. There's no _invariant_ identifier that a client can use to know that they are consistently modifying one branch versus a different branch.\r\n\r\nThis comes up if you try to write code that will create a particular workflow on a tower instance. Here is the 2nd of two such attempts I know of:\r\n\r\nhttps://github.com/ansible/tower-cli/pull/479\r\n\r\nAWX should provide a field on the node to make this easier.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nObserve that all resources have name and/or description.\r\n\r\nLook at workflow nodes.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nDoesn't have to be name or description, but just any filterable field that a client can set would make client scripts (and Ansible modules) for workflows robust.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWorkflow nodes do not have any client-writable attribute that can be later used to address it.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPing @john-westcott-iv \r\n"},{"labels":["api",null,null,null,null,null],"text":"Here's the story, the `__init__.py` of the sso app has some heroic logic (written by @cchurch) in order to avoid a segmentation fault in CentOS triggered in a library that it uses.\r\n\r\nhttps://github.com/ansible/awx/blob/f9079953744af1d79de11148a6e49f2ef38c94be/awx/sso/__init__.py#L4-L23\r\n\r\nRelated issue for the library https://github.com/onelogin/python-saml/issues/30#issuecomment-75954988\r\n\r\nWithin the current batch of dependencies, it was found that a segmentation fault occurred (borking the entire app) on version 2.2.3 of python-saml, but not version 2.2.2. This is what changed between the versions.\r\n\r\nhttps://github.com/onelogin/python-saml/compare/v2.2.2...v2.2.3\r\n\r\nNote that the monkeypatch changed things with the `dm.xmlsec.binding`, and that the upgrade of python-saml upgraded `dm.xmlsec.binding`.\r\n\r\nClearly these things are connected.\r\n\r\nIt looks like we need to alter the monkeypatch logic in `awx/sso/__init__.py` to be compatible with python-saml>=2.2.3 (specifically _its_ updated dependency,  `dm.xmlsec.binding` 1.3.3).\r\n\r\nI'm carding this out separately so it doesn't hold up the timeframe of the rest of dependency updates."},{"labels":["api",null,null,null],"text":"because some people are already assuming we support it...\r\n\r\nhttps://github.com/ansible/ansible/pull/27376/files#diff-f5b4ed56691a28c106adf759d95de084L128"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nSAML Authentication (which worked in 1.0.2.103) is now broken when the IdP response gets sent to AWX\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.33\r\n* AWX install method: docker\r\n* Ansible version:  2.4.3.0\r\n* Operating System: CentOS\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nFresh Install AWX 1.0.4.33\r\nConfigure SAML Authentication using an ADFS IdP\r\nLogin with SAML\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI'm logged in\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAWX crashes, see stacktrace below\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nEven if not authenticated, the User got created\r\n\r\nTested with settings.py\r\n```\r\nAUTHENTICATION_BACKENDS = (\r\n    'awx.sso.backends.SAMLAuth',\r\n    'django.contrib.auth.backends.ModelBackend',\r\n)\r\n```\r\nand\r\n```\r\nAUTHENTICATION_BACKENDS = (\r\n    'awx.sso.backends.SAMLAuth',\r\n)\r\n```\r\nStacktrace:\r\n```\r\n2018/03/01 21:33:27 [warn] 31#0: *24 upstream server temporarily disabled while reading response header from upstream, client: 172.18.0.4, server: _, request: \"GET /sso/complete/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"awx.example.com\", referrer: \"https://logon.example.com/adfs/ls?SAMLRequest=<RESPONSE>&RelayState=IDP\"\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 244, in items\r\n    return value.items()\r\nAttributeError: 'NoneType' object has no attribute 'items'\r\n[pid: 42|app: 0|req: 2/8] 172.18.0.4 () {56 vars in 1674 bytes} [Thu Mar  1 21:33:26 2018] GET /sso/complete/ => generated 0 bytes in 271 msecs (HTTP/1.1 500) 0 headers in 0 bytes (0 switches on core 0)\r\n2018-03-01 21:33:27,330 ERROR    django.request Internal Server Error: /sso/complete/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/views.py\", line 42, in dispatch\r\n    auth.login(self.request, self.request.user)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 149, in login\r\n    'You have multiple authentication backends configured and '\r\nValueError: You have multiple authentication backends configured and therefore must provide the `backend` argument or set the `backend` attribute on the user.\r\n2018-03-01 21:33:27,330 ERROR    django.request Internal Server Error: /sso/complete/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/sso/views.py\", line 42, in dispatch\r\n    auth.login(self.request, self.request.user)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/contrib/auth/__init__.py\", line 149, in login\r\n    'You have multiple authentication backends configured and '\r\nValueError: You have multiple authentication backends configured and therefore must provide the `backend` argument or set the `backend` attribute on the user.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/wsgi.py\", line 157, in __call__\r\n    response = self.get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 124, in get_response\r\n    response = self._middleware_chain(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 43, in inner\r\n    response = response_for_exception(request, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 93, in response_for_exception\r\n    response = handle_uncaught_exception(request, get_resolver(get_urlconf()), sys.exc_info())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 143, in handle_uncaught_exception\r\n    return callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 88, in handle_500\r\n    return handle_error(request, 500, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 40, in render\r\n    output = self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 166, in render\r\n    values = self.sequence.resolve(context, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 736, in resolve\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 244, in items\r\n    return value.items()\r\nAttributeError: 'NoneType' object has no attribute 'items'\r\n\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nApplication client_secret is not encrypted in the database.  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.31\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.0.3\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. exec into the awx container\r\n2. do a SELECT on main__oauth2application\r\n3. see client_secret field in plain text\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpect that django-oauth-toolkit would encrypt this by default. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe client_secret is shown in plain text.  \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nTo fix, the application model we will have to override the application model.  \r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nSCM Access for inventory and specifically vars, not tied to project.\r\n\r\n\r\n##### ENVIRONMENT\r\nN/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nN/A\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nTo allow the inventory from SCM to pull down not just inventory, but group and host vars via SCM. This allows normal CI/CD workflow for adding vars within all repo's that awx/tower is tied to. \r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nN/A\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nThis is an extension of the well documented feature: `Sourced from a Project`"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nHere's a test case that replicates the instructions at https://github.com/ansible/awx/blob/devel/awx/api/templates/api/api_o_auth_authorization_root_view.md#authorization-using-application-of-grant-type-password (but fails with `E   OperationalError: no such table: oauth2_provider_refreshtoken`):\r\n\r\n\r\n```diff\r\n(awx) [devel:●] ~/dev/awx/awx git diff\r\ndiff --git a/awx/main/tests/functional/api/test_oauth.py b/awx/main/tests/functional/api/test_oauth.py\r\nindex 435204957..6fad2fb9d 100644\r\n--- a/awx/main/tests/functional/api/test_oauth.py\r\n+++ b/awx/main/tests/functional/api/test_oauth.py\r\n@@ -1,6 +1,9 @@\r\n+import base64\r\n+import os\r\n+\r\n import pytest\r\n\r\n-from awx.api.versioning import reverse\r\n+from awx.api.versioning import reverse, drf_reverse\r\n from awx.main.models.oauth import (OAuth2Application as Application,\r\n                                    OAuth2AccessToken as AccessToken,\r\n                                    OAuth2RefreshToken as RefreshToken\r\n@@ -133,3 +136,16 @@ def test_oauth_application_delete(oauth_application, post, delete, admin):\r\n     assert Application.objects.filter(client_id=oauth_application.client_id).count() == 0\r\n     assert RefreshToken.objects.filter(application=oauth_application).count() == 0\r\n     assert AccessToken.objects.filter(application=oauth_application).count() == 0\r\n+\r\n+\r\n+@pytest.mark.django_db\r\n+def test_personal_access_token_creation(oauth_application, post, alice):\r\n+    url = drf_reverse('api:oauth_authorization_root_view') + 'token/'\r\n+    resp = post(\r\n+        url,\r\n+        data='grant_type=password&username=alice&password=alice&scope=read',\r\n+        content_type='application/x-www-form-urlencoded',\r\n+        HTTP_AUTHORIZATION='Basic ' + base64.b64encode(':'.join([\r\n+            oauth_application.client_id, oauth_application.client_secret\r\n+        ]))\r\n+    )\r\ndiff --git a/awx/main/tests/functional/conftest.py b/awx/main/tests/functional/conftest.py\r\nindex 22e675246..d5b45cf72 100644\r\n--- a/awx/main/tests/functional/conftest.py\r\n+++ b/awx/main/tests/functional/conftest.py\r\n@@ -531,7 +531,7 @@ def _request(verb):\r\n             user = data_or_user\r\n         elif 'data' not in kwargs:\r\n             kwargs['data'] = data_or_user\r\n-        if 'format' not in kwargs:\r\n+        if 'format' not in kwargs and 'content_type' not in kwargs:\r\n             kwargs['format'] = 'json'\r\n\r\n         view, view_args, view_kwargs = resolve(urlparse(url)[2])\r\n```\r\n\r\n```python\r\n$ py.test awx/main/tests/functional/api/test_oauth.py\r\n>>>>>>>>>>>>>>>>>>> PDB set_trace (IO-capturing turned off) >>>>>>>>>>>>>>>>>>>>\r\n...\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/endpoints/token.py:118: in create_token_response\r\n    request, self.default_token_type)\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py:109: in create_token_response\r\n    self.request_validator.save_token(token, request)\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/request_validator.py:246: in save_token\r\n    return self.save_bearer_token(token, request, *args, **kwargs)\r\n    return f(endpoint, uri, *args, **kwargs)\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/endpoints/token.py:118: in create_token_response\r\n    request, self.default_token_type)\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py:109: in create_token_response\r\n    self.request_validator.save_token(token, request)\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/request_validator.py:246: in save_token\r\n    return self.save_bearer_token(token, request, *args, **kwargs)\r\n    return f(endpoint, uri, *args, **kwargs)\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/endpoints/token.py:118: in create_token_response\r\n    request, self.default_token_type)\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py:109: in create_token_response\r\n    self.request_validator.save_token(token, request)\r\n/venv/awx/lib/python2.7/site-packages/oauthlib/oauth2/rfc6749/request_validator.py:246: in save_token\r\n    return self.save_bearer_token(token, request, *args, **kwargs)\r\n/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py:185: in inner\r\n    return func(*args, **kwargs)\r\n/venv/awx/lib/python2.7/site-packages/oauth2_provider/oauth2_validators.py:472: in save_bearer_token\r\n    refresh_token.save()\r\n/venv/awx/lib/python2.7/site-packages/django/db/models/base.py:808: in save\r\n    force_update=force_update, update_fields=update_fields)\r\n/venv/awx/lib/python2.7/site-packages/django/db/models/base.py:838: in save_base\r\n    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)\r\n/venv/awx/lib/python2.7/site-packages/django/db/models/base.py:924: in _save_table\r\n    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)\r\n/venv/awx/lib/python2.7/site-packages/django/db/models/base.py:963: in _do_insert\r\n    using=using, raw=raw)\r\n/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py:85: in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n/venv/awx/lib/python2.7/site-packages/django/db/models/query.py:1076: in _insert\r\n    return query.get_compiler(using=using).execute_sql(return_id)\r\n/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py:1107: in execute_sql\r\n    cursor.execute(sql, params)\r\n/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py:65: in execute\r\n    return self.cursor.execute(sql, params)\r\n/venv/awx/lib/python2.7/site-packages/django/db/utils.py:94: in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py:65: in execute\r\n    return self.cursor.execute(sql, params)\r\n/venv/awx/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py:328: in execute\r\n    return Database.Cursor.execute(self, query, params)\r\nE   OperationalError: no such table: oauth2_provider_refreshtoken\r\n==================== 1 failed, 6 deselected in 4.18 seconds ====================\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nAdd ability to copy job schedules\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.31\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.3\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThere should be a copy action for job schedules\r\n\r\n##### EXPECTED RESULTS\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![image](https://user-images.githubusercontent.com/19539695/36811679-8ad6278c-1cc6-11e8-9824-d0aa5fe3575a.png)\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nIn recent versions of AWX there is no longer a flashing grey/green icon for pending/running jobs\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.4.0.31\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.3\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Run a job and go back to the job_templates view, \r\n\r\n##### EXPECTED RESULTS\r\n\r\nYou'll see an icon flashing to indicate there is a pending/running job\r\n\r\n##### ACTUAL RESULTS\r\n\r\nYou no longer see a flashing icon to indicate a job is running\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![image](https://user-images.githubusercontent.com/19539695/36810402-7f3aec0e-1cc2-11e8-8b82-1c3500463d59.png)\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen attempting to use VMWare VCenter as an inventory source it fails with the following error:\r\n\r\n```\r\nPlugin ini failed: /usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py:10: Error parsing host definition '\"\"\"': No closing quotation\r\n```\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.14\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Red Hat Enterprise Linux Server release 7.4 (Maipo)\r\n* Web Browser: Google Chrome Version 64.0.3282.167 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure an inventory source to use VCenter and sync.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSync full VCenter inventory\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n2018-02-28 16:21:08,866 INFO     awx.main.commands.inventory_import Updating inventory 2: VCenter Servers\r\n2018-02-28 16:21:08,876 DEBUG    awx.main.commands.inventory_import Using system install of ansible-inventory CLI: /usr/bin/ansible-inventory\r\n2018-02-28 16:21:08,876 INFO     awx.main.commands.inventory_import Reading Ansible inventory source: /usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx==1.0.4.14', 'console_scripts', 'awx-manage')()\r\n  File \"/usr/lib/python2.7/site-packages/awx/__init__.py\", line 109, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 993, in handle\r\n    self.is_custom)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 242, in load_inventory_source\r\n    is_custom=is_custom).load()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 177, in load\r\n    data = self.command_to_json(base_args + ['--list'])\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 160, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=4) with stdout:\r\nstderr:\r\nERROR! Could not parse inventory source /usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py with available plugins:\r\nPlugin script failed: Inventory script (/usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py) had an execution error: Traceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py\", line 727, in <module>\r\n    print(VMWareInventory().show())\r\n  File \"/usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py\", line 134, in __init__\r\n    self.do_api_calls_update_cache()\r\n  File \"/usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py\", line 176, in do_api_calls_update_cache\r\n    self.inventory = self.instances_to_inventory(self.get_instances())\r\n  File \"/usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py\", line 329, in get_instances\r\n    return self._get_instances(kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py\", line 336, in _get_instances\r\n    si = SmartConnect(**inkwargs)\r\n  File \"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/pyVim/connect.py\", line 836, in SmartConnect\r\n    sslContext)\r\n  File \"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/pyVim/connect.py\", line 718, in __FindSupportedVersion\r\n    sslContext)\r\n  File \"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/pyVim/connect.py\", line 638, in __GetServiceVersionDescription\r\n    path + \"/vimServiceVersions.xml\", sslContext)\r\n  File \"/var/lib/awx/venv/ansible/lib/python2.7/site-packages/pyVim/connect.py\", line 604, in __GetElementTree\r\n    conn.request(\"GET\", path)\r\n  File \"/usr/lib64/python2.7/httplib.py\", line 1017, in request\r\n    self._send_request(method, url, body, headers)\r\n  File \"/usr/lib64/python2.7/httplib.py\", line 1051, in _send_request\r\n    self.endheaders(body)\r\n  File \"/usr/lib64/python2.7/httplib.py\", line 1013, in endheaders\r\n    self._send_output(message_body)\r\n  File \"/usr/lib64/python2.7/httplib.py\", line 864, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib64/python2.7/httplib.py\", line 826, in send\r\n    self.connect()\r\n  File \"/usr/lib64/python2.7/httplib.py\", line 1227, in connect\r\n    HTTPConnection.connect(self)\r\n  File \"/usr/lib64/python2.7/httplib.py\", line 807, in connect\r\n    self.timeout, self.source_address)\r\n  File \"/usr/lib64/python2.7/socket.py\", line 553, in create_connection\r\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\r\nsocket.gaierror: [Errno -2] Name or service not known\r\n \r\nPlugin ini failed: /usr/lib/python2.7/site-packages/awx/plugins/inventory/vmware_inventory.py:10: Error parsing host definition '\"\"\"': No closing quotation\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: N/A\r\n* AWX install method: N/A\r\n* Ansible version:  N/A\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCurrently the heartbeat schedule for cluster is hard-coded in here\r\n\r\nhttps://github.com/ansible/awx/blob/devel/awx/settings/defaults.py#L489\r\n\r\nConsider making it configurable.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBe able to configure the heartbeats schedule, e.g. every 30 seconds instead of currently hard-coded 60.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API?\r\n - UI\r\n\r\n##### SUMMARY\r\nI create a Smart Inventory. Then I disable (\"OFF\") hosts in it. When now running a Template on my Smart Inventory, the Template will also be executed on all hosts that are disabled.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.14\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Linux (Ubuntu)\r\n* Web Browser: Firefox, Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create Inventory with some hosts in it.\r\n2. Create Smart Inventory with hosts of previous Inventory\r\n3. Disable (\"OFF\") some hosts in these Smart Inventory\r\n4. Execute a Template that uses the Smart Inventory.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe Template will be executed on all hosts of the Smart Inventory except for those that are marked as \"OFF\".\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe Template executes on all hosts of the Smart Inventory.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nNormal Users that have launched a job with a survey are unable to use the relaunch function as it brings back \"Job was launched with prompted fields. Organization level permissions required.\"\r\nDiscussed in #219 there is no exception for this to work on jobs with surveys at the moment\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.14\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nLaunch a job with survey variables as a normal user, Try to click the button to re-launch the job and get the below error\r\n![awx_issue_capture01](https://user-images.githubusercontent.com/1752478/36785970-9f9fc852-1c7c-11e8-954c-be51fc9b6078.PNG)\r\n\r\n\r\n##### EXPECTED RESULTS\r\nJob to relaunch, as the user has all the correct permissions\r\n\r\n##### ACTUAL RESULTS\r\nSee screenshot\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAble to remove application from token\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-73\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn the API browser go to something like `/api/v2/tokens/1/`\r\n\r\nPATCH\r\n\r\n```json\r\n{\r\n    \"application\": null,\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n400, from acceptance docs\r\n\r\n##### ACTUAL RESULTS\r\n\r\nchanged.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPATCH is not listed in the OPTIONS, which I guess is another bug.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nNo link to token from token activity stream entries (or applications)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-72\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nInspect:\r\n\r\n - `/api/v2/tokens/3/activity_stream/`\r\n - `/api/v2/applications/2/activity_stream/`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n`related` section should have links back to the token and application for their respective activity stream entries\r\n\r\n##### ACTUAL RESULTS\r\n\r\nexample inside of application activity stream\r\n\r\n```json\r\n            \"id\": 583,\r\n            \"type\": \"activity_stream\",\r\n            \"url\": \"/api/v2/activity_stream/583/\",\r\n            \"related\": {\r\n                \"access_token\": \"*************\",\r\n                \"actor\": \"/api/v2/users/1/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"actor\": {\r\n                    \"username\": \"admin\",\r\n                    \"first_name\": \"\",\r\n                    \"last_name\": \"\",\r\n                    \"id\": 1\r\n                },\r\n                \"access_token\": \"*************\"\r\n            },\r\n```\r\n\r\nLink & summary_fields are present for actor but not the application.\r\n\r\nSame goes for tokens.\r\n\r\nAdditionally, somehow tokens are showing up in unrelated activity stream entries. Example for a job template.\r\n\r\n```json\r\n            \"id\": 341,\r\n            \"type\": \"activity_stream\",\r\n            \"url\": \"/api/v2/activity_stream/341/\",\r\n            \"related\": {\r\n                \"access_token\": \"*************\",\r\n                \"job_template\": [\r\n                    \"/api/v2/job_templates/32/\"\r\n                ],\r\n                \"actor\": \"/api/v2/users/5/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"job_template\": [\r\n                    {\r\n                        \"description\": \"I edited this...  45\",\r\n                        \"id\": 32,\r\n                        \"name\": \"A - B - C - D\"\r\n                    }\r\n                ],\r\n                \"actor\": {\r\n                    \"username\": \"org_member\",\r\n                    \"first_name\": \"Organization\",\r\n                    \"last_name\": \"Auditor\",\r\n                    \"id\": 5\r\n                },\r\n                \"access_token\": \"*************\"\r\n            },\r\n```\r\n\r\nThis action was actually taken before the OAuth2 stuff was merged, so it's particularly strange that `access_token` appears there.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-66\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPOST to `/api/v2/applications/N/tokens/` the data\r\n\r\n```json\r\n{\r\n    \"description\": \"mai token\",\r\n    \"scope\": \"foobar\"\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n400\r\n\r\n##### ACTUAL RESULTS\r\n\r\n201, created\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nMy first gut reaction was that this should be a choice field, but our design is to allow \"read write\", and if the types of scope increased, then we wouldn't want to manually list all permutations, so a simple algorithmic validation method should suffice."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-66\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGET some endpoint with `user_capabilities` in `summary_fields` using a read-limited token\r\n\r\n##### EXPECTED RESULTS\r\n\r\nfor user_capabilities values to not be wrong\r\n\r\n##### ACTUAL RESULTS\r\n\r\ndoes not take token scope into account.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nActivity stream for Application model leaks secret\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-66\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate an application, view `/api/v2/applications/1/activity_stream/`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo secrets.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n            \"changes\": {\r\n                \"updated\": \"2018-02-27 14:15:50.398779+00:00\",\r\n                \"redirect_uris\": \"\",\r\n                \"description\": \"\",\r\n                \"created\": \"2018-02-27 14:15:50.398752+00:00\",\r\n                \"logo_data\": \"\",\r\n                \"client_type\": \"public\",\r\n                \"user\": \"admin\",\r\n                \"client_id\": \"TLmqoGkOxTGq4E7rF8gGmmFMK6f76tI8AKynGz3S\",\r\n                \"client_secret\": \"ufF43Ea72Bt1J7f5ONjHlCwhH39j1jKpUjHMg9Z0h65oNa5t6nwLDOFuERy6AkXkul7vWw8XfsteLJtSyhzang8MsX33iEJijfYeu4DQnU3R4IYnjjif68AQOVBPPkEF\",\r\n                \"skip_authorization\": false,\r\n                \"authorization_grant_type\": \"password\",\r\n                \"id\": \"1\",\r\n                \"name\": \"alans application 日本語\"\r\n            },\r\n```\r\n\r\n`client_secret` shown in the data.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen trying to run a custom inventory script i get the follow error: \r\n`awx-manage inventory_import: error: unrecognized arguments: -e @/tmp/awx_62_6tcS9H/tmphP32xr`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.14\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0 \r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Chrome 64\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- create a custom inventory script\r\n- create or use a credential that has a `extra_vars` injector\r\n- create a inventory that uses the above script as its source with an `extra_vars` injector for its credential\r\n- attempt to sync the inventory\r\n\r\n##### EXPECTED RESULTS\r\n\r\ninventory is updated based on the output of the inventory script\r\n\r\n##### ACTUAL RESULTS\r\n\r\nupdate fails with the following error: \r\n\r\n```\r\nusage: awx-manage inventory_import [-h] [--version] [-v {0,1,2,3}]\r\n                                   [--settings SETTINGS]\r\n                                   [--pythonpath PYTHONPATH] [--traceback]\r\n                                   [--no-color] [--inventory-name n]\r\n                                   [--inventory-id i] [--overwrite]\r\n                                   [--overwrite-vars] [--keep-vars] [--custom]\r\n                                   [--source s] [--enabled-var v]\r\n                                   [--enabled-value v] [--group-filter regex]\r\n                                   [--host-filter regex]\r\n                                   [--exclude-empty-groups]\r\n                                   [--instance-id-var v]\r\nawx-manage inventory_import: error: unrecognized arguments: -e @/tmp/awx_62_6tcS9H/tmphP32xr\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nPlease, consider using [Alt Galaxy](https://github.com/gantsign/alt-galaxy) as an ansible-galaxy alternative, as this one is damn' too slow\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4\r\n* AWX install method: docker on linux\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUse a project with dozens of roles defined in `roles/requirements.yml`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLaunching a simple playbook should take few seconds.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nLaunching a simple playbook could take more than 20 minutes, just because of ansible-galaxy slowness\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPlease.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n \r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nAdded Git project and created template now want to add template into the project so the git pull directly on inventory server not on project directory but not able to add job template on git project\r\n\r\n##### ENVIRONMENT\r\n* AWX version: development\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4\r\n* Operating System: Centos\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate git project to pull source code from git\r\nCreate template to run playbook on inventory server\r\n\r\nThen try to add job template on project\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPull Source code directly to inventory servers and then run playbook to build.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNot able to add job template on project\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"The `AuthToken` model is no longer needed, we should remove it (and all its uses) and include its removal in a migration."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nUsers can presumably obtain tokens through the API with auditor type permissions.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4-61\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGET `/api/v2/activity_stream/?o_auth2_access_token__token__gte=aoekbieoxoe`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n403, nothing even remotely resembling this is allowed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nGives a count of activity stream entries related to access tokens greater or equal to a certain value.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n`awx/api/filters.py` see `AuthToken`\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nUnable to construct a valid host_filter  that searches for a JSON key with `__` or `\"` in the key.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhost_filter backing grammar should allow for:\r\n\r\n* [ ] \\\" support. i.e. `\"hello_\\\"world\\\"\"=\"goodbye\"`\r\n* [ ] __ support i.e. `a__b__c\\_\\_d=\"foo\"`\r\n\r\n```\r\n{ \"a\": { \"b\": { \"c__d\": \"foo\" } } } \r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen starting a job from template, the SCM update job prior to this job fails with Error 500 and `ValueError: Invalid IPv6 URL` in logs.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.4.14\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0 \r\n* Operating System: Red Hat Enterprise Linux Server release 7.4\r\n* Web Browser: Firefox Latest\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWhen starting a job from template, the SCM update job fails with Error 500 and `ValueError: Invalid IPv6 URL` in logs. This does not happen if I start the SCM Update from the Projects Page. It does not matter what kind of job I start.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo 500 error.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\nLogs from awx_web:\r\n```2018-02-26 15:13:05,016 ERROR    django.request Internal Server Error: /api/v2/project_updates/16/stdout/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 255, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 210, in get\r\n    return self.retrieve(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 4591, in retrieve\r\n    content, start, end, absolute_end = unified_job.result_stdout_raw_limited(start_line, end_line)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/projects.py\", line 510, in result_stdout_raw_limited\r\n    return self._result_stdout_raw_limited(start_line, end_line, redact_sensitive=redact_sensitive)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 1052, in _result_stdout_raw_limited\r\n    return_buffer = UriCleaner.remove_sensitive(return_buffer)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/redact.py\", line 20, in remove_sensitive\r\n    o = urlparse.urlsplit(match.group(1))\r\n  File \"/usr/lib64/python2.7/urlparse.py\", line 190, in urlsplit\r\n    raise ValueError(\"Invalid IPv6 URL\")\r\nValueError: Invalid IPv6 URL\r\n```\r\nIn the Standard Out of the SCM Update job only this is written:\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\nPLAY [all] *********************************************************************\r\n\r\n\r\nTASK [delete project directory before update] **********************************\r\nskipping: [localhost]\r\n```\r\n\r\nAdresses:\r\n``` ip a\r\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1\r\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\r\n    inet 127.0.0.1/8 scope host lo\r\n       valid_lft forever preferred_lft forever\r\n    inet6 ::1/128 scope host\r\n       valid_lft forever preferred_lft forever\r\n2: ens192: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP qlen 1000\r\n    link/ether 00:50:56:b2:e2:5f brd ff:ff:ff:ff:ff:ff\r\n    inet 172.31.224.73/27 brd 172.31.224.95 scope global ens192\r\n       valid_lft forever preferred_lft forever\r\n    inet6 fe80::250:56ff:feb2:e25f/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n3: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP\r\n    link/ether 02:42:2c:7c:c0:81 brd ff:ff:ff:ff:ff:ff\r\n    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\r\n       valid_lft forever preferred_lft forever\r\n    inet6 fe80::42:2cff:fe7c:c081/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n5: veth326ad54@if4: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP\r\n    link/ether fe:dc:a8:b1:d2:e8 brd ff:ff:ff:ff:ff:ff link-netnsid 0\r\n    inet6 fe80::fcdc:a8ff:feb1:d2e8/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n7: veth3d49e88@if6: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP\r\n    link/ether 12:84:b3:57:f6:ec brd ff:ff:ff:ff:ff:ff link-netnsid 1\r\n    inet6 fe80::1084:b3ff:fe57:f6ec/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n9: vetha800b2e@if8: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP\r\n    link/ether 42:8f:16:55:34:2d brd ff:ff:ff:ff:ff:ff link-netnsid 2\r\n    inet6 fe80::408f:16ff:fe55:342d/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n11: veth03c3e67@if10: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP\r\n    link/ether 06:86:28:67:83:99 brd ff:ff:ff:ff:ff:ff link-netnsid 3\r\n    inet6 fe80::486:28ff:fe67:8399/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n13: veth3a66f4f@if12: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP\r\n    link/ether 22:87:25:46:a5:cb brd ff:ff:ff:ff:ff:ff link-netnsid 4\r\n    inet6 fe80::2087:25ff:fe46:a5cb/64 scope link\r\n       valid_lft forever preferred_lft forever\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nOn a GET to the `api/login` endpoint, HTML is returned instead of the expected JSON.  \r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.3\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.3.1\r\n* Operating System: OS X\r\n* Web Browser: Chrome\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n1. Create a Personal Access Token at `api/v2/users/<your pk>/personal_tokens`\r\n2. Make a curl to the `api/login` endpoint: `curl http://localhost:8013/api/login -H \"Authorization: Bearer <your token>\"\r\n3. See HTML response instead of JSON\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFor non-browser clients, JSON should be returned.  \r\n\r\n##### ACTUAL RESULTS\r\n\r\nBecause there is no GET method, HTML is returned.  \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nMay want to also rename LoggedLoginView and LoggedLogoutView and make them proper DRF API views if they are to live under /api/. They can still accept username and password as application/x-www-form-urlencoded in addition to JSON using DRF's parser for this format.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nAdd `Introspect` endpoint to fully support OAuth2 RFC.  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.3\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.3.1\r\n* Operating System: OS X\r\n* Web Browser: Chrome\r\n* After OAuth2 Merge\r\n\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWill Allow Admin user to Post a token value to this endpoint and receive back information about the token.  These are the fields that should be returned:\r\n* active\r\n* scope\r\n* client_id\r\n* username\r\n* expires\r\n* description\r\n\r\nWhen testing this, it should be ensured that it works for both application tokens _and_ personal access tokens.\r\n\r\nFor Reference: https://github.com/jazzband/django-oauth-toolkit/blob/master/oauth2_provider/views/introspect.py"},{"labels":["api",null,null,null],"text":"Hi,\r\n\r\nIs there any change log for the current and future releases of AWX ?\r\n\r\nWould be great that this repository would have a `CHANGELOG.md` describing all the new features, bug fixes, etc."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n\r\n - API\r\n\r\n##### SUMMARY\r\nWhen a user logs in with incorrect credentials, awx logs in as the previous user from that client browser.  This is because the client browser stores those credentials and uses them to authenticate via basic auth.  \r\n\r\nWhen Django Session Authentication fails, it falls through to Basic Auth, for which the browser has saved the token for.  \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.3\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.3.1\r\n* Operating System: OS X\r\n* Web Browser: Chrome\r\n* After OAuth2 Merge\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Log in with proper credentials in the UI\r\n2. Log out\r\n3. Log in with incorrect credentials\r\n4. User is now logged in as the previous user\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpect to not be logged in upon passing an invalid username and password.  \r\n\r\n##### ACTUAL RESULTS\r\n\r\nLogs in as previous user, using basic auth token.  \r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nThis behavior is not experiences when Basic Auth is turned off.  \r\n\r\nPossible fix: Selectively disallow Basic Auth for login's from the UI, basic auth support is only needed for the API (to keep supporting users who use this instead of tokens) as the UI can rely on Django Session Auth.  "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n\r\n - API\r\n\r\n##### SUMMARY\r\nLogin session is not maintained from API to UI. \r\n\r\nPossible related issue is: when you log out on the API side, it doesn’t log out on the UI.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.3\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.3.1\r\n* Operating System: OS X\r\n* Web Browser: Chrome\r\n* After OAuth2 Merge\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Log into the API\r\n2. Navigate to the UI\r\n\r\nTemporary fix: \r\n1. Open Developer's console\r\n2. Click Applications tab\r\n3. Clear all cookies\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWhen you log in to the UI and navigate to an API endpoint, the user should remain logged in.  And visa versa.  Currently there is a bug going from the API to the UI.  \r\n\r\n##### ACTUAL RESULTS\r\n\r\n*Issue*: when a user logs in to the api, then navigates to the UI, the user is logged out and sees an incomplete dashboard.  At this point the user is unable to log in via the UI and needs to clear application cookies manually from the Developer's console to fix it.  \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThe first two activity stream entries on AWX bringup:\r\n```\r\n    \"results\": [\r\n        {\r\n            \"id\": 1,\r\n            \"type\": \"activity_stream\",\r\n            \"url\": \"/api/v2/activity_stream/1/\",\r\n            \"related\": {},\r\n            \"summary_fields\": {},\r\n            \"timestamp\": \"2018-02-22T17:07:19.229508Z\",\r\n            \"operation\": \"update\",\r\n            \"changes\": {\r\n                \"modified\": [\r\n                    \"2018-02-22 17:07:12.453663+00:00\",\r\n                    \"2018-02-22 17:07:19.138425+00:00\"\r\n                ]\r\n            },\r\n            \"object1\": \"credential_type\",\r\n            \"object2\": \"\",\r\n            \"object_association\": \"\"\r\n        },\r\n        {\r\n            \"id\": 2,\r\n            \"type\": \"activity_stream\",\r\n            \"url\": \"/api/v2/activity_stream/2/\",\r\n            \"related\": {},\r\n            \"summary_fields\": {},\r\n            \"timestamp\": \"2018-02-22T17:07:20.742075Z\",\r\n            \"operation\": \"update\",\r\n            \"changes\": {\r\n                \"modified\": [\r\n                    \"2018-02-22 17:07:12.439959+00:00\",\r\n                    \"2018-02-22 17:07:20.740224+00:00\"\r\n                ]\r\n            },\r\n            \"object1\": \"credential_type\",\r\n            \"object2\": \"\",\r\n            \"object_association\": \"\"\r\n        },\r\n```\r\n\r\nNot sure what these are supposed to be.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.41\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. start AWX\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nTrying to create a job template using several vault passwords... Exception provided from application\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.41\r\n* AWX install method:docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: CentOS 7\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAssigned 10+ vaults to job template. Run and produces exception...\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSuccessful playbook execution\r\n\r\n##### ACTUAL RESULTS\r\n\r\nEnter passphrase for /tmp/awx_6664_0c_C6H/credential_3: \r\nIdentity added: /tmp/awx_6664_0c_C6H/credential_3 (/tmp/awx_6664_0c_C6H/credential_3)\r\nansible-playbook 2.4.3.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nVault password (**********): \r\nVault password (**********): \r\nVault password (**********): \r\nVault password (**********): \r\nVault password (**********): \r\nVault password (**********): \r\nVault password (**********): \r\nVault password (**********): \r\nVault password (**********): \r\nVault password (**********): \r\nParsed /tmp/awx_6664_0c_C6H/tmpbEmBQz inventory source with script plugin\r\nERROR! Unexpected Exception, this is probably a bug: 'NoneType' object is not iterable\r\nthe full traceback was:\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/ansible-playbook\", line 106, in <module>\r\n    exit_code = cli.run()\r\n  File \"/usr/lib/python2.7/site-packages/ansible/cli/playbook.py\", line 122, in run\r\n    results = pbex.run()\r\n  File \"/usr/lib/python2.7/site-packages/ansible/executor/playbook_executor.py\", line 82, in run\r\n    pb = Playbook.load(playbook_path, variable_manager=self._variable_manager, loader=self._loader)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/__init__.py\", line 54, in load\r\n    pb._load_playbook_data(file_name=file_name, variable_manager=variable_manager)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/__init__.py\", line 106, in _load_playbook_data\r\n    entry_obj = Play.load(entry, variable_manager=variable_manager, loader=self._loader)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/play.py\", line 117, in load\r\n    return p.load_data(data, variable_manager=variable_manager, loader=loader)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/base.py\", line 255, in load_data\r\n    self._attributes[name] = method(name, ds[name])\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/play.py\", line 191, in _load_roles\r\n    role_includes = load_list_of_roles(ds, play=self, variable_manager=self._variable_manager, loader=self._loader)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/helpers.py\", line 352, in load_list_of_roles\r\n    i = RoleInclude.load(role_def, play=play, current_role_path=current_role_path, variable_manager=variable_manager, loader=loader)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/role/include.py\", line 59, in load\r\n    return ri.load_data(data, variable_manager=variable_manager, loader=loader)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/base.py\", line 245, in load_data\r\n    ds = self.preprocess_data(ds)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/role/definition.py\", line 93, in preprocess_data\r\n    role_name = self._load_role_name(ds)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/playbook/role/definition.py\", line 130, in _load_role_name\r\n    all_vars = self._variable_manager.get_vars(play=self._play)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/vars/manager.py\", line 364, in get_vars\r\n    for vars_file_item in play.get_vars_files():\r\nTypeError: 'NoneType' object is not iterable\r\n\r\n"},{"labels":["api",null,null,null],"text":"https://github.com/ansible/awx/blame/6163cc6b5c3a3c8f5bd173d121cafd15c5b75b17/installer/image_build/files/settings.py#L26 is set statically in the base image, and that makes the setting read-only from the Settings API.  We should come up with a way to set this value at install time that doesn't require setting the value in `settings.py` (via either an API call or via `awx-manage shell`)."},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n - UI\r\n \r\n##### SUMMARY\r\n\r\nIs it possible to e send tower log to graylog without using logstash ? \r\nLooks like its possible to pass tower log to gelf using payload, refer link : http://docs.graylog.org/en/2.4/pages/gelf.html \r\nwhich says with the help of payload any graylog-server node accepts and stores this as a message. So can this be candidate for RFE ?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInventory Source for GCP raise python exception\r\n\r\n##### ENVIRONMENT\r\n* AWX version:  1.0.4.0\r\n* AWX install method: kubernetes ( on gcp )\r\n* Ansible version:   2.4.3.0\r\n* Operating System: Docker container centOs | ansible/awx_web:latest \r\n* Web Browser: chrome/firefox\r\n\r\n##### STEPS TO REPRODUCE\r\ngo to Inventory -> Sources -> +add sources -> Google compute engine.\r\n##### EXPECTED RESULTS\r\nRetrieve gcp instances.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`Plugin ini failed: /usr/lib/python2.7/site-packages/awx/plugins/inventory/gce.py:19: Error parsing host definition ''''': No closing quotation`\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nGetting failed to emit log to external aggregator - even when there isn't one configured, I was testing splunk but have reverted all to defaults in UI.\r\n\r\n\r\nFeb 20 11:18:41 HOSTNAME journal: 2018-02-20 11:18:41,702 ERROR    awx.main.utils.handlers failed to emit log to external aggregator. Its also attempting to then talk via our proxy (ReadTimeout: HTTPConnectionPool(host='xx.yy.zz.xx', port=8080)\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 10.1.173\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3\r\n* Operating System: RHEL 7.4\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConstant output in /var/log/messages\r\n\r\n##### EXPECTED RESULTS\r\n\r\nno error !\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOutput below sanitised.\r\n\r\nFeb 20 11:18:41 HOSTNAME journal: 2018-02-20 11:18:41,702 ERROR    awx.main.utils.handlers failed to emit log to external aggregator\r\nFeb 20 11:18:41 HOSTNAME journal: Traceback (most recent call last):\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/usr/lib/python2.7/site-packages/awx/main/utils/handlers.py\", line 75, in _wrapped\r\nFeb 20 11:18:41 HOSTNAME journal:    return func(*args, **kwargs)\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/requests_futures/sessions.py\", line 73, in wrap\r\nFeb 20 11:18:41 HOSTNAME journal:    resp = sup(*args_, **kwargs_)\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/requests/sessions.py\", line 518, in request\r\nFeb 20 11:18:41 HOSTNAME journal:    resp = self.send(prep, **send_kwargs)\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/requests/sessions.py\", line 639, in send\r\nFeb 20 11:18:41 HOSTNAME journal:    r = adapter.send(request, **kwargs)\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/requests/adapters.py\", line 514, in send\r\nFeb 20 11:18:41 HOSTNAME journal:    raise ReadTimeout(e, request=request)\r\nFeb 20 11:18:41 HOSTNAME journal: ReadTimeout: HTTPConnectionPool(host='xx.yy.zz.xx', port=8080): Read timed out. (read timeout=5)\r\nFeb 20 11:18:41 HOSTNAME journal: [2018-02-20 11:18:41,702: ERROR/ForkPoolWorker-98] failed to emit log to external aggregator\r\nFeb 20 11:18:41 HOSTNAME journal: Traceback (most recent call last):\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/usr/lib/python2.7/site-packages/awx/main/utils/handlers.py\", line 75, in _wrapped\r\nFeb 20 11:18:41 HOSTNAME journal:    return func(*args, **kwargs)\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/requests_futures/sessions.py\", line 73, in wrap\r\nFeb 20 11:18:41 HOSTNAME journal:    resp = sup(*args_, **kwargs_)\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/requests/sessions.py\", line 518, in request\r\nFeb 20 11:18:41 HOSTNAME journal:    resp = self.send(prep, **send_kwargs)\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/requests/sessions.py\", line 639, in send\r\nFeb 20 11:18:41 HOSTNAME journal:    r = adapter.send(request, **kwargs)\r\nFeb 20 11:18:41 HOSTNAME journal:  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/requests/adapters.py\", line 514, in send\r\nFeb 20 11:18:41 HOSTNAME journal:    raise ReadTimeout(e, request=request)\r\nFeb 20 11:18:41 HOSTNAME journal: ReadTimeout: HTTPConnectionPool(host='xx.yy.zz.xx', port=8080): Read timed out. (read timeout=5)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nI set up a Docker install of AWX. However, once every couple of days, I cannot connect to the web interface. It just hangs. If I reboot the server, everything is fine, for a couple more days. When I check the scheduler, nothing is running once it hangs. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.327\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: Ubuntu 16.04.3 LTS running 4.13.0-32-generic\r\n* Web Browser: Safari\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Brand new docker install of AWX using the installer\r\n2. Wait....\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt continues working\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIt times out or I get an \"Internal Server Error\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nawx-task container log had this:\r\n\r\n```\r\n[2018-02-19 22:22:15,355: ERROR/MainProcess] Task handler raised error: <MaybeEncodingError: Error sending result: ''<ExceptionInfo: OperationalError(\\'could not connect to server: Connection timed out\\\\n\\\\tIs the server running on host \"postgres\" (172.17.0.4) and accepting\\\\n\\\\tTCP/IP connections on port 5432?\\\\n\\',)>''. Reason: ''TypeError(\"can\\'t pickle traceback objects\",)''.>\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/pool.py\", line 362, in workloop\r\n    put((READY, (job, i, result, inqW_fd)))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/queues.py\", line 366, in put\r\n    self.send_payload(ForkingPickler.dumps(obj))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/reduction.py\", line 82, in dumps\r\n    cls(buf, protocol).dump(obj)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 224, in dump\r\n    self.save(obj)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 286, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 562, in save_tuple\r\n    save(element)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 286, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 562, in save_tuple\r\n    save(element)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 286, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 562, in save_tuple\r\n    save(element)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 331, in save\r\n    self.save_reduce(obj=obj, *rv)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 419, in save_reduce\r\n    save(state)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 286, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 649, in save_dict\r\n    self._batch_setitems(obj.iteritems())\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 663, in _batch_setitems\r\n    save(v)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 331, in save\r\n    self.save_reduce(obj=obj, *rv)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 419, in save_reduce\r\n    save(state)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 286, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 649, in save_dict\r\n    self._batch_setitems(obj.iteritems())\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 663, in _batch_setitems\r\n    save(v)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 331, in save\r\n    self.save_reduce(obj=obj, *rv)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 419, in save_reduce\r\n    save(state)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 286, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 649, in save_dict\r\n    self._batch_setitems(obj.iteritems())\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 663, in _batch_setitems\r\n    save(v)\r\n  File \"/usr/lib64/python2.7/pickle.py\", line 306, in save\r\n    rv = reduce(self.proto)\r\n  File \"/var/lib/awx/venv/awx/lib64/python2.7/copy_reg.py\", line 70, in _reduce_ex\r\n    raise TypeError, \"can't pickle %s objects\" % base.__name__\r\nMaybeEncodingError: Error sending result: ''<ExceptionInfo: OperationalError(\\'could not connect to server: Connection timed out\\\\n\\\\tIs the server running on host \"postgres\" (172.17.0.4) and accepting\\\\n\\\\tTCP/IP connections on port 5432?\\\\n\\',)>''. Reason: ''TypeError(\"can\\'t pickle traceback objects\",)''.\r\n```\r\n\r\n\r\nIts possible its related to #677 and/or #796, but both are closed and no information in them has helped solve my issue.\r\n\r\nI did a reinstall twice just to verify I didn't do anything wrong. "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWorkflows create too many activity stream events.\r\n\r\n`modified_by` is getting nulled by system activity, impairing finger-pointing ability.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3-174\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - Create a WFJT\r\n - Add a JT to the workflow 3 times in success-linked series execution\r\n - Run it\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTo set expectations, we run a simple job template. Inspect activity stream entries. There is 1 entry\r\n\r\n - job created\r\n\r\nIf we apply the same precedent to workflow job templates, then one could argue that the following entries are expected\r\n\r\n - workflow job created\r\n - job created x 3\r\n\r\n(total of 4 entries)\r\n\r\n##### ACTUAL RESULTS\r\n\r\n![screen shot 2018-02-19 at 10 31 52 am](https://user-images.githubusercontent.com/1385596/36385682-3580cdb2-1561-11e8-924d-123e46c9a7d9.png)\r\n\r\n(8 entries)\r\n\r\nIn my example, my JT is called \"A - B - C - D\" and there is a workflow that spawns it. The workflow runs once, running the JT 3 times. 4 out of the 8 entries were expected, so 4 of them were unexpected.\r\n\r\nDiving in:\r\n\r\n - workflow job created (expected)\r\n - workflow job modified by launching user (unexpected)\r\n - WFJT modified by launching user (unexpected)\r\n - created job (expected)\r\n - created job (expected)\r\n - created job (expected)\r\n - updated workflow job by system (unexpected)\r\n - updated WFJT by system (unexpected)\r\n\r\nThe last 2 here have a detrimental effect of making `modified_by` null - this is very undesirable and is the highest priority to fix.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3-174\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n(in the UI)\r\n\r\n - Create a JT that runs a debug playbook and has no credentials attached to it (machine or otherwise)\r\n - Launch that JT\r\n - Relaunch that job you just created\r\n\r\n##### EXPECTED RESULTS\r\n\r\nRelaunched job runs\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```json\r\n{\"credential\":[\"Neither credential nor vault credential provided.\"]}\r\n```\r\n\r\n![screen shot 2018-02-19 at 10 01 21 am](https://user-images.githubusercontent.com/1385596/36384017-db2bf6de-155b-11e8-9666-0b8c92fa6a3a.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPayload for relaunch submitted by the UI\r\n\r\n```json\r\n{\"extra_vars\": {}}\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3-174\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn the UI, click the button to make a copy of a manual project.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nValid result.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOriginal and copy\r\n\r\n![screen shot 2018-02-19 at 9 55 32 am](https://user-images.githubusercontent.com/1385596/36383733-0ec29878-155b-11e8-86a8-0168714774a5.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe copy button might just be disabled for this case?\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - RFE\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\nWhen I run the workflow job in tower and from the interface, I can see on the interface is graphical presentation and status of job template.  But when I look at the (api/v2/workflow_jobs/job_id) \"result_stdout\" on workflow_jobs, the result is stdout out capture is missing.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0\r\n* Ansible version:  2.4.1\r\n* Operating System: RHEL 7\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1] Run workflow template on tower.\r\n2] After job run, go to `https://<tower>/api/v2/workflow_jobs/job_id` and check for \"result_stdout\" it shows \r\n~~~\r\n\"result_stdout\": \"stdout capture is missing\",\r\n~~~\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt should show complete successful/ failed output. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nBut its showing :  \"result_stdout\": \"stdout capture is missing\",\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nwhile attempting to create an inventory with a source from project, no inventories are shown in the list.\r\ni tried yaml and ini files but it doesn't show it. \r\nalso tried to change permissions but also 777 permissions didn't worked for me.\r\nany ideas ? \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.41\r\n* AWX install method: docker on linux (+docker compose)\r\n* Ansible version:  2.4.3.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\ncreated new directory under /var/lib/projects/awx\r\nunder it create ini\\yaml files with some hosts \r\ncreated project in awx \r\ncreate inventory \r\ntry to create source from project inventory with no success\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n```\r\nRemote system is failing with XML module due to \"fatal: [docker1]: FAILED! => {\"changed\": false, \"msg\": \"The xml ansible module requires the lxml python library installed on the managed machine\"}\"\r\n```\r\n\r\nEven though it is installed:\r\n\r\n```\r\nspollock@docker1:~$ pip list\r\nbackports.ssl-match-hostname (3.5.0.1)\r\ncertifi (2017.11.5)\r\nchardet (3.0.4)\r\ndocker (2.7.0)\r\ndocker-pycreds (0.2.1)\r\nidna (2.6)\r\nipaddress (1.0.19)\r\nlxml (4.1.1)  <-----\r\npip (9.0.1)\r\nrequests (2.18.4)\r\nsetuptools (20.7.0)\r\nsix (1.11.0)\r\nurllib3 (1.22)\r\nwebsocket-client (0.46.0)\r\nwheel (0.29.0)\r\n```\r\n\r\n##### ENVIRONMENT\r\n\r\n```\r\n$ ansible --version\r\nansible 2.5.0\r\n  config file = /Users/spollock/ansible/fs-linux-services/ansible.cfg\r\n  configured module search path = [u'/Users/spollock/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /Library/Python/2.7/site-packages/ansible\r\n  executable location = /usr/local/bin/ansible\r\n  python version = 2.7.10 (default, Oct 23 2015, 19:19:21) [GCC 4.2.1 Compatible Apple LLVM 7.0.0 (clang-700.0.59.5)]\r\n```\r\n\r\n* Ansible version:  2.5.0\r\n* Operating System:OSX\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nhost: docker1 (from above)\r\n\r\nTask:\r\n```\r\n- name: Grab version from xml.pom\r\n  xml:\r\n    path: /home/spollock/webui/xxxx-web/pom.xml\r\n    xpath: /project\r\n    content: attribute\r\n    attribute: version\r\n  register: version\r\n  tags: version\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nshould have parsed the XML and returned the value of the version attribute in the register.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n```\r\nTASK [dashboard : Grab version from xml.pom] ***********************************\r\nfatal: [docker1]: FAILED! => {\"changed\": false, \"msg\": \"The xml ansible module requires the lxml python library installed on the managed machine\"}\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently you can only rerun individual templates that have executed or failed as part of the workflow. It would be nice to be able to restart from failure and continue with the rest of the workflow.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nSometimes a user wants to run a job across a very very large number of endpoints. The current best practice is to 'size the number of forks based on available resources, and cycle until done'.\r\n\r\nHowever, this still limits execution to a single AWX node.\r\n\r\nIt would be potentially useful to have AWX split a job into multiple `ansible-playbook` executions, each on a subset of inventory, that can be scheduled in parallel across a cluster.\r\n\r\nCaveats:\r\n- Not all playbooks work in the scenario. This would require explict per-job opt-in. (We would not attempt to discover whether or not a playbook would support this ... that way lies madness.)\r\n- This may end up being a new template type, a la workflows, as it changes the playbook/inventory -> template -> job -> ansible-playbook run -> output 1:1 relationships\r\n- There may need to be new output display paradigms for this, to find the individual playbook run where a particular host was handled\r\n- How to break jobs up? Do we do it differently based on available resources?\r\n- probably other things\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nStrawman proposal:\r\n\r\nA new unified job type, 'distributed job', is created.\r\n\r\nA 'distributed job' consists of a job template, 1-N inventories, and a 'slice size' (integer, better names welcome).\r\n\r\nWhen executed, a distributed job calculates the size of its linked inventories (1-N), and splits each inventory into a number of chunks of size 'slice size'.  It then queues jobs of ansible-playbook runs on each chunk of the appropriate inventory, using `limit` to specify it.  These jobs follow normal scheduling behavior (number of forks, queueing due to capacity, assignation to instance groups based on inventory mapping).\r\n\r\nA 'distributed job' status is calculated in the same manner as workflow jobs; failure if there are any unhandled failures in its sub-jobs.\r\n\r\nDisplay of distributed job status/runs is.... `¯\\_(ツ)_/¯`. We may re-use workflow display, or come up with something else entirely.\r\n\r\nDocumentation should have VERY LARGE warnings that any job that intends to orchestrate across hosts (rather than just applying changes to individual hosts) should not be configured as a distributed job. Any job that does may fail, and we will not attempt to discover or account for playbooks that fail when run as distributed jobs.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n \r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nAdd option to not import host variables in to AWX when sourcing inventory from SCM\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.38\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.3\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI would like the option for AWX to not import any varibles from SCM so when Ansible is run it continues to use variables inside the project folder."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen working with a workflow, the variables \"stored\" with set_facts are not recovered by subsequent jobs\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.52\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4\r\n* Operating System: Centos 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n- Create 2 jobs, 1 with set_stats, the other using the viariable defined in 1 ( I used those indicated here for testing: http://docs.ansible.com/ansible-tower/latest/html/userguide/workflows.html#extra-variables)\r\n- add them to a workflow\r\n- run the workflow\r\n\r\n\r\n##### EXPECTED RESULTS\r\nThe second job of the flow should display the value of the variable set in the first (display page content)\r\n\r\n##### ACTUAL RESULTS\r\nThe second job fails saying the variable is undefined: \r\n`fatal: [localhost]: FAILED! => {\"msg\": \"The task includes an option with an undefined variable. The error was: 'integration_results_url' is undefined\\n\\nThe error appears to have been in '/var/lib/awx/projects/_19__mchesnel/playbooks/use_set_stats.yml': line 3, column 5, but may\\nbe elsewhere in the file depending on the exact syntax problem.\\n\\nThe offending line appears to be:\\n\\n  tasks:\\n  - name: \\\"Get test results from the web\\\"\\n    ^ here\\n\\nexception type: <class 'ansible.errors.AnsibleUndefinedVariable'>\\nexception: 'integration_results_url' is undefined\"}`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nCase 1. AWX is upgrading. Go to AWX.\r\n\r\n1. You are redirected to /migrations_notran.\r\n2. You wait\r\n3. You are redirected to AWX when done.\r\n\r\nCase 2: AWX is not upgrading. Go to awx/migrations_notran (by accident)\r\n\r\n1. You see 'will redirect to AWX when done'\r\n2. You wait\r\n3. Nothing happens\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n\r\nOption to not save jt survey passwords via seperate Survey field Type \"volatile Password\".\r\nThis is simmilar to #742 but with Credentials provided by Surveys.\r\n\r\nI worked around #688 where the Password promt on launch is faulty. \r\nI did this by creating a password field in a survey and overwrote ansible_ssh_password.\r\n\r\nNow the problem is that the Password Survey answer gets saved somwhere and relaunches can be triggered without supplying a password. \r\n\r\nThe requirement that the password does not get saved can be covered with the promt on launch of the credential when #688 is fixed. But if there must be other variables/passwords provided in a playbook to login somewhere (eg. rest apis), there should also be an option to not save survey passwords like it is done with credential prompt on launch.\r\n\r\nI propose this as there can be environments wich force that there is no saved passwords anywhere.\r\nThese are likely more organisatorical Requirement than Technical requirements but they exist nonetheless.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a JT with Suvery and a Password field.\r\nRun the JT and supply the Password\r\nTrigger Relaunch of the above completed Job\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThere could be a seperate Survey field Type \"volatile Password\" which is not saved anywhere and forces a Survey popup on relauch. When using this survey field, schedules are disabled of course, because there is no way one can supply the Survey values.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe Relunch has valid credentials and triggers the relaunch without prompt.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nError syncing inventory with openstack\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.55\r\n* AWX install method: docker-compose on linux\r\n* Ansible version:  2.4.3.0 \r\n* Operating System: Ubuntu 16.04.3\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nUse an SSL endpoint\r\n\r\n##### EXPECTED RESULTS\r\n\r\nImport instances to inventory\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n\r\n2018-02-16 05:02:06,680 INFO     awx.main.commands.inventory_import Updating inventory 2: devstack\r\n2018-02-16 05:02:06,692 INFO     awx.main.commands.inventory_import Reading Ansible inventory source: /usr/lib/python2.7/site-packages/awx/plugins/inventory/openstack.py\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx==1.0.3.55', 'console_scripts', 'awx-manage')()\r\n  File \"/usr/lib/python2.7/site-packages/awx/__init__.py\", line 109, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 991, in handle\r\n    self.is_custom)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 242, in load_inventory_source\r\n    is_custom=is_custom).load()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 177, in load\r\n    data = self.command_to_json(base_args + ['--list'])\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 160, in command_to_json\r\n    self.method, proc.returncode, stdout, stderr))\r\nRuntimeError: ansible-inventory failed (rc=4) with stdout:\r\n\r\nstderr:\r\nERROR! Could not parse inventory source /usr/lib/python2.7/site-packages/awx/plugins/inventory/openstack.py with available plugins:\r\nPlugin script failed: Inventory script (/usr/lib/python2.7/site-packages/awx/plugins/inventory/openstack.py) had an execution error: Error fetching server list on devstack::\r\n\r\n \r\nPlugin ini failed: /usr/lib/python2.7/site-packages/awx/plugins/inventory/openstack.py:48: Expected key=value host variable assignment, got: argparse\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI also tried to use \"Source variables\":\r\n```\r\n---\r\nclouds:\r\n  devstack:\r\n    cacert: /etc/pki/ca-trust/source/anchors/overcloud-cacert-mo.crt\r\n    verify: false\r\n    auth:\r\n      auth_url: https://172.16.128.10:13000/v2.0\r\n      username: user\r\n      password: mi_pass\r\n      project_name: project\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nIn theory, if we store and display the last login of the user, the user could notice if their creds were used without them.\r\n\r\nRequest is to store this info and display it... somewhere.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe don't currently do live updates of instance group capacity & status.\r\n\r\nThis feature is for the API to send the necessary info via websocket, and for the UI to consume it.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nSort of a bughancement. We don't currently allocate capacity for controller nodes controlling isolated jobs.\r\n\r\nNotes from @AlanCoding:\r\n\r\nThere are 2 types of activities that have a hypothetical task impact\r\n\r\n    job-related management playbooks\r\n    the isolated heartbeat task\r\n\r\nfor those scenarios, we have 2 things to consider\r\n\r\n    blocking the run of the task if there is insufficient capacity (I'll call \"blocking\")\r\n    adding the action's task impact to consumed_capacity (I'll call \"consuming\")\r\n\r\nFor a rundown of what would be relatively easy to do - I have a concrete idea of how to do blocking for the heartbeat, and a concrete idea of how to do consuming for the job-related management tasks. The reverse (consuming in the heartbeat, blocking for jobs) would be relatively difficult, risking some hazards with the task manager.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nAdd Inventory Field in Schedules view\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.36\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWhen looking a the schedule view it would be nice to see what inventory the schedule will be run against, in addition to the schedule name, first run, next run, final run fields."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nHTTP 500 errors trying to get to schedules after creating a schedule using the new prompt function\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.36\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Create template that has a survey\r\n2) Schedule a job against the template and use the blue prompt button to fill in the survey\r\n3) Click on the calendar icon on the main navigation bar, or click on jobs and schedules\r\n\r\n##### EXPECTED RESULTS\r\n\r\nYou're able to see all schedules\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError! Invalid search term entered. GET returned: 500 A server error has occurred.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nNested groups cannot be found using `host_filter` API or smart inventories.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.14\r\n* AWX install method: [awx-container from geerlingguy](https://github.com/geerlingguy/awx-container/)\r\n* Ansible version:  2.4.3.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPreparation: create groups:\r\n\r\n* Create a group in AWX, for example `dnsservers`\r\n* In that group, create 2 other groups: `dns-authoritative` and `dns-recursive`\r\n* Add diffrerent hosts to the `dns-authoritative` and `dns-recursive` groups, and none directly in the `dnsservers` group.\r\n\r\nUsing the API, go to:\r\n\r\n`/api/v2/hosts/?host_filter=groups__name=dnsservers`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected results are that when searching for `dnsservers` would return all hosts in both the `dns-authoritative` and `dns-recursive` groups.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nActual result is that an empty result is returned:\r\n\r\n```\r\n{\r\n    \"count\": 0,\r\n    \"next\": null,\r\n    \"previous\": null,\r\n    \"results\": []\r\n}\r\n```\r\n\r\nBoth the `/api/v2/hosts/?host_filter=groups__name=dns-authoritative` and `/api/v2/hosts/?host_filter=groups__name=dns-recursive` requests do return the expected hosts in those groups.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n* When in the UI, you go to an the inventory, select this `dnsservers` group, and look at the hosts there, you do see all hosts I would expect to be returned.\r\n* Using `/api/v2/hosts/?groups__search=` does not make any difference.\r\n* This also does not work in Smart Inventories. A smart host filter for `dns-authoritative` or `dns-recursive` works,  but `dnsservers` results in an empty result.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nSCM upate fails but provides no information.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.52\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.3.0 \r\n* Operating System: RHEL 7\r\n* Web Browser: Firefox \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSetup new credentials\r\nSetup new project using the credentials.\r\nStart an SCM update.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSCM succeeds and playbooks are available.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSCM fails almost immediately with no output to the standard output box.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n[2018-02-15 10:31:51,202: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1d71c80> (args:('awx.main.tasks.run_project_update', '69545664-1752-4c48-a46c-41b7976d5bd3', {'origin': 'gen280@awx', 'lang': 'py', 'task': 'awx.main.tasks.run_project_update', 'group': None, 'root_id': 'e22c4be1-8d1a-4193-a5e8-03b8c6b25f3a', u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': None, u'correlation_id': '69545664-1752-4c48-a46c-41b7976d5bd3', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '[18]', 'eta': None, 'parent_id': 'e22c4be1-8d1a-4193-a5e8-03b8c6b25f3a', u'reply_to': 'aef45ebd-7309-34e3-8669-7f378d04708f', 'id': '69545664-1752-4c48-a46c-41b7976d5bd3', 'kwargsrepr': '{}'}, u'[[18], {}, {\"chord\": null, \"callbacks\": [{\"chord_size\": null, \"task\": \"awx.main.tasks.handle_work_success\", \"subtask_type\": null, \"kwargs\": {\"task_actual\": {\"type\": \"project_update\", \"id\": 18}}, \"args\": [], \"options\": {}, \"immutable\": false}], \"errbacks\": [{\"chord_size\": null, \"task\": \"awx.main.tasks.handle_work_error\", \"subtask_type\": null, \"kwargs\":... kwargs:{})\r\n[2018-02-15 10:31:51,205: DEBUG/MainProcess] Task accepted: awx.main.tasks.run_project_update[69545664-1752-4c48-a46c-41b7976d5bd3] pid:279\r\n[2018-02-15 10:31:51,221: INFO/ForkPoolWorker-50] Task awx.main.scheduler.tasks.run_job_launch[e22c4be1-8d1a-4193-a5e8-03b8c6b25f3a] succeeded in 0.280421956s: None\r\n2018-02-15 10:31:52,001 ERROR    awx.main.tasks project_update 18 (running) Post run hook errored.\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 997, in run\r\n    self.post_run_hook(instance, status, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 1647, in post_run_hook\r\n    fd = open(self.revision_path, 'r')\r\nAttributeError: 'RunProjectUpdate' object has no attribute 'revision_path'\r\n2018-02-15 10:31:52,089 DEBUG    awx.main.tasks Executing error task id <Context: {'origin': 'gen280@awx', u'args': [18], u'chain': None, 'root_id': 'e22c4be1-8d1a-4193-a5e8-03b8c6b25f3a', 'expires': None, u'is_eager': False, u'correlation_id': '69545664-1752-4c48-a46c-41b7976d5bd3', u'chord': None, u'reply_to': 'aef45ebd-7309-34e3-8669-7f378d04708f', '_children': [], 'id': '69545664-1752-4c48-a46c-41b7976d5bd3', 'kwargsrepr': '{}', 'lang': 'py', 'retries': 0, 'task': 'awx.main.tasks.run_project_update', 'group': None, 'timelimit': [None, None], u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, u'hostname': u'celery@awx', 'called_directly': False, 'parent_id': 'e22c4be1-8d1a-4193-a5e8-03b8c6b25f3a', 'argsrepr': '[18]', u'errbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_error', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'subtasks': [{u'type': u'project_update', u'id': 18}]}, u'options': {}}], u'callbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_success', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'task_actual': {u'type': u'project_update', u'id': 18}}, u'options': {}}], u'kwargs': {}, 'eta': None, '_protected': 1}>, subtasks: [{u'type': u'project_update', u'id': 18}]\r\n2018-02-15 10:31:52,180 WARNING  awx.main.tasks project_update 18 (error) encountered an error (rc=None), please see task stdout for details.\r\n[2018-02-15 10:31:52,181: ERROR/ForkPoolWorker-49] Task awx.main.tasks.run_project_update[69545664-1752-4c48-a46c-41b7976d5bd3] raised unexpected: Exception('project_update 18 (error) encountered an error (rc=None), please see task stdout for details.',)\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nConnection reset by peer message in logs during fresh install.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.47\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: CentOS 7.4\r\n* Web Browser: Chrome 63.0.3239.132\r\n\r\n##### STEPS TO REPRODUCE\r\nInstall as per instructions in docker/playbook method in install guide.\r\n\r\n##### EXPECTED RESULTS\r\nInstall logs without errors\r\n\r\n##### ACTUAL RESULTS\r\nInstall logs are without errors\r\n```\r\n`[2018-02-14 08:06:33,516: DEBUG/ForkPoolWorker-6] Channel open\r\n[2018-02-14 08:06:33,517: DEBUG/MainProcess] pidbox received method active_queues() [reply_to:{u'routing_key': u'1b46c844-a556-34db-a85d-d0792134534b', u'exchange': u'reply.celery.pidbox'} ticket:639e62d9-f1e2-466e-a00d-2da23fea486a]\r\n[2018-02-14 08:06:33,518: ERROR/MainProcess] Control command error: error(104, 'Connection reset by peer')\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/worker/pidbox.py\", line 42, in on_message\r\n    self.node.handle_message(body, message)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 129, in handle_message\r\n    return self.dispatch(**body)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 112, in dispatch\r\n    ticket=ticket)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 135, in reply\r\n    serializer=self.mailbox.serializer)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 265, in _publish_reply\r\n    **opts\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 181, in publish\r\n    exchange_name, declare,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 203, in _publish\r\n    mandatory=mandatory, immediate=immediate,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/channel.py\", line 1734, in _basic_publish\r\n    (0, exchange, routing_key, mandatory, immediate), msg\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/abstract_channel.py\", line 50, in send_method\r\n    conn.frame_writer(1, self.channel_id, sig, args, content)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/method_framing.py\", line 166, in write_frame\r\n    write(view[:offset])\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/transport.py\", line 258, in write\r\n    self._write(s)\r\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\r\n    return getattr(self._sock,name)(*args)\r\nerror: [Errno 104] Connection reset by peer\r\n[2018-02-14 08:06:33,520: DEBUG/MainProcess] Closed channel #3\r\n[2018-02-14 08:06:33,520: DEBUG/MainProcess] using channel_id: 3\r\n[2018-02-14 08:06:33,521: DEBUG/MainProcess] Channel open\r\n[2018-02-14 08:06:34,045: DEBUG/MainProcess] heartbeat_tick : for connection 7651125451bb4e6ca43de2c71ef36be3\r\n[2018-02-14 08:06:34,045: DEBUG/MainProcess] heartbeat_tick : Prev sent/recv: 70/290, now - 81/342, monotonic - 2502.3833967, last_heartbeat_sent - 2502.3833892, heartbeat int. - 60 for connection 7651125451bb4e6ca43de2c71ef36be3`\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nAWX_WEB logs:\r\n```\r\n`192.168.0.13 - - [14/Feb/2018:08:16:22 +0000] \"GET /api/ HTTP/1.1\" 502 575 \"http://192.168.0.12/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36\" \"-\"\r\n192.168.0.13 - - [14/Feb/2018:08:16:22 +0000] \"GET /api/v2/auth/ HTTP/1.1\" 502 575 \"http://192.168.0.12/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36\" \"-\"\r\n2018-02-14 08:17:00,640 ERRO pool awx-config-watcher event buffer overflowed, discarding event 4`\r\n```\r\n\r\nAWX_TASK log with infos before error:\r\n```\r\n`[2018-02-14 08:17:33,366: INFO/Beat] Scheduler: Sending due task cluster_heartbeat (awx.main.tasks.cluster_node_heartbeat)\r\n[2018-02-14 08:17:33,368: DEBUG/Beat] awx.main.tasks.cluster_node_heartbeat sent. id->f870c794-bfee-464c-9187-095bd214f1b2\r\n[2018-02-14 08:17:33,368: DEBUG/Beat] beat: Waking up now.\r\n[2018-02-14 08:17:33,369: INFO/MainProcess] Received task: awx.main.tasks.cluster_node_heartbeat[f870c794-bfee-464c-9187-095bd214f1b2]   expires:[2018-02-14 08:18:23.367528+00:00]\r\n[2018-02-14 08:17:33,370: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x32dec80> (args:('awx.main.tasks.cluster_node_heartbeat', 'f870c794-bfee-464c-9187-095bd214f1b2', {'origin': 'gen205@awx', 'lang': 'py', 'task': 'awx.main.tasks.cluster_node_heartbeat', 'group': None, 'root_id': 'f870c794-bfee-464c-9187-095bd214f1b2', u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'awx', u'exchange': u''}, 'expires': '2018-02-14T08:18:23.367528+00:00', u'correlation_id': 'f870c794-bfee-464c-9187-095bd214f1b2', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '()', 'eta': None, 'parent_id': None, u'reply_to': '77090448-ee12-361f-ab69-0dff05aa3da4', 'id': 'f870c794-bfee-464c-9187-095bd214f1b2', 'kwargsrepr': '{}'}, u'[[], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2018-02-14 08:17:33,372: DEBUG/MainProcess] Task accepted: awx.main.tasks.cluster_node_heartbeat[f870c794-bfee-464c-9187-095bd214f1b2] pid:273\r\n[2018-02-14 08:17:33,381: INFO/Beat] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\n2018-02-14 08:17:33,381 DEBUG    awx.main.tasks Cluster node heartbeat task.\r\n[2018-02-14 08:17:33,382: DEBUG/Beat] awx.main.scheduler.tasks.run_task_manager sent. id->a57b201b-9618-4d34-af27-a1d1a3c6de5d\r\n[2018-02-14 08:17:33,382: INFO/Beat] Scheduler: Sending due task tower_scheduler (awx.main.tasks.awx_periodic_scheduler)\r\n[2018-02-14 08:17:33,383: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[a57b201b-9618-4d34-af27-a1d1a3c6de5d]   expires:[2018-02-14 08:17:53.381638+00:00]\r\n[2018-02-14 08:17:33,383: INFO/MainProcess] Scaling up 1 processes.\r\n[2018-02-14 08:17:33,383: DEBUG/Beat] awx.main.tasks.awx_periodic_scheduler sent. id->e009fd58-0ae5-4c18-8867-057a8e2c0c12\r\n[2018-02-14 08:17:33,383: DEBUG/Beat] beat: Waking up in 19.99 seconds.\r\n[2018-02-14 08:17:33,414: DEBUG/ForkPoolWorker-42] Start from server, version: 0.9, properties: {'information': 'Licensed under the MPL.  See http://www.rabbitmq.com/', 'product': 'RabbitMQ', 'copyright': 'Copyright (C) 2007-2018 Pivotal Software, Inc.', 'capabilities': {'exchange_exchange_bindings': True, 'connection.blocked': True, 'authentication_failure_close': True, 'direct_reply_to': True, 'basic.nack': True, 'per_consumer_qos': True, 'consumer_priorities': True, 'consumer_cancel_notify': True, 'publisher_confirms': True}, 'cluster_name': 'rabbit@b0de64c74aa0', 'platform': 'Erlang/OTP 20.1.7', 'version': '3.7.3'}, mechanisms: ['PLAIN', 'AMQPLAIN'], locales: [u'en_US']\r\n[2018-02-14 08:17:33,416: DEBUG/ForkPoolWorker-42] using channel_id: 1\r\n[2018-02-14 08:17:33,417: DEBUG/ForkPoolWorker-42] Channel open\r\n[2018-02-14 08:17:33,421: INFO/ForkPoolWorker-42] Task awx.main.tasks.cluster_node_heartbeat[f870c794-bfee-464c-9187-095bd214f1b2] succeeded in 0.0511565829997s: None\r\n[2018-02-14 08:17:33,479: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x32dec80> (args:('awx.main.scheduler.tasks.run_task_manager', 'a57b201b-9618-4d34-af27-a1d1a3c6de5d', {'origin': 'gen205@awx', 'lang': 'py', 'task': 'awx.main.scheduler.tasks.run_task_manager', 'group': None, 'root_id': 'a57b201b-9618-4d34-af27-a1d1a3c6de5d', u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': '2018-02-14T08:17:53.381638+00:00', u'correlation_id': 'a57b201b-9618-4d34-af27-a1d1a3c6de5d', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '()', 'eta': None, 'parent_id': None, u'reply_to': '77090448-ee12-361f-ab69-0dff05aa3da4', 'id': 'a57b201b-9618-4d34-af27-a1d1a3c6de5d', 'kwargsrepr': '{}'}, u'[[], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2018-02-14 08:17:33,479: DEBUG/MainProcess] basic.qos: prefetch_count->156\r\n[2018-02-14 08:17:33,481: INFO/MainProcess] Received task: awx.main.tasks.awx_periodic_scheduler[e009fd58-0ae5-4c18-8867-057a8e2c0c12]   expires:[2018-02-14 08:17:53.382949+00:00]\r\n[2018-02-14 08:17:33,481: INFO/MainProcess] Scaling up 1 processes.\r\n[2018-02-14 08:17:33,576: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x32dec80> (args:('awx.main.tasks.awx_periodic_scheduler', 'e009fd58-0ae5-4c18-8867-057a8e2c0c12', {'origin': 'gen205@awx', 'lang': 'py', 'task': 'awx.main.tasks.awx_periodic_scheduler', 'group': None, 'root_id': 'e009fd58-0ae5-4c18-8867-057a8e2c0c12', u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': '2018-02-14T08:17:53.382949+00:00', u'correlation_id': 'e009fd58-0ae5-4c18-8867-057a8e2c0c12', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '()', 'eta': None, 'parent_id': None, u'reply_to': '77090448-ee12-361f-ab69-0dff05aa3da4', 'id': 'e009fd58-0ae5-4c18-8867-057a8e2c0c12', 'kwargsrepr': '{}'}, u'[[], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2018-02-14 08:17:33,578: INFO/MainProcess] Received task: awx.main.tasks.handle_ha_toplogy_changes[ff7c9786-03d7-4f99-bf37-c2602b491df4]\r\n[2018-02-14 08:17:33,578: INFO/MainProcess] Scaling up 1 processes.\r\n[2018-02-14 08:17:33,674: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x32dec80> (args:('awx.main.tasks.handle_ha_toplogy_changes', 'ff7c9786-03d7-4f99-bf37-c2602b491df4', {'origin': 'gen273@awx', 'lang': 'py', 'task': 'awx.main.tasks.handle_ha_toplogy_changes', 'group': None, 'root_id': 'f870c794-bfee-464c-9187-095bd214f1b2', u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower_broadcast_all'}, 'expires': None, u'correlation_id': 'ff7c9786-03d7-4f99-bf37-c2602b491df4', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '()', 'eta': None, 'parent_id': 'f870c794-bfee-464c-9187-095bd214f1b2', u'reply_to': 'd31a9964-8432-3034-9e7a-b6c2da22697a', 'id': 'ff7c9786-03d7-4f99-bf37-c2602b491df4', 'kwargsrepr': '{}'}, u'[[], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2018-02-14 08:17:33,675: DEBUG/MainProcess] basic.qos: prefetch_count->164\r\n[2018-02-14 08:17:33,682: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[a57b201b-9618-4d34-af27-a1d1a3c6de5d] pid:273\r\n[2018-02-14 08:17:33,682: DEBUG/MainProcess] Task accepted: awx.main.tasks.handle_ha_toplogy_changes[ff7c9786-03d7-4f99-bf37-c2602b491df4] pid:274\r\n[2018-02-14 08:17:33,682: DEBUG/MainProcess] Task accepted: awx.main.tasks.awx_periodic_scheduler[e009fd58-0ae5-4c18-8867-057a8e2c0c12] pid:275\r\n2018-02-14 08:17:33,691 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2018-02-14 08:17:33,694 DEBUG    awx.main.tasks Last scheduler run was: 2018-02-14 08:17:03.381193+00:00\r\n2018-02-14 08:17:33,695 DEBUG    awx.main.scheduler Starting Scheduler\r\n2018-02-14 08:17:33,695 DEBUG    awx.main.tasks Reconfigure celeryd queues task on host celery@awx\r\n[2018-02-14 08:17:33,709: INFO/ForkPoolWorker-44] Task awx.main.tasks.awx_periodic_scheduler[e009fd58-0ae5-4c18-8867-057a8e2c0c12] succeeded in 0.028698651s: None\r\n[2018-02-14 08:17:33,712: DEBUG/ForkPoolWorker-43] Start from server, version: 0.9, properties: {'information': 'Licensed under the MPL.  See http://www.rabbitmq.com/', 'product': 'RabbitMQ', 'copyright': 'Copyright (C) 2007-2018 Pivotal Software, Inc.', 'capabilities': {'exchange_exchange_bindings': True, 'connection.blocked': True, 'authentication_failure_close': True, 'direct_reply_to': True, 'basic.nack': True, 'per_consumer_qos': True, 'consumer_priorities': True, 'consumer_cancel_notify': True, 'publisher_confirms': True}, 'cluster_name': 'rabbit@b0de64c74aa0', 'platform': 'Erlang/OTP 20.1.7', 'version': '3.7.3'}, mechanisms: ['PLAIN', 'AMQPLAIN'], locales: [u'en_US']\r\n[2018-02-14 08:17:33,713: DEBUG/ForkPoolWorker-43] using channel_id: 1\r\n[2018-02-14 08:17:33,713: INFO/ForkPoolWorker-42] Task awx.main.scheduler.tasks.run_task_manager[a57b201b-9618-4d34-af27-a1d1a3c6de5d] succeeded in 0.0338850829999s: None\r\n[2018-02-14 08:17:33,714: DEBUG/ForkPoolWorker-43] Channel open\r\n[2018-02-14 08:17:33,728: DEBUG/ForkPoolWorker-43] Start from server, version: 0.9, properties: {'information': 'Licensed under the MPL.  See http://www.rabbitmq.com/', 'product': 'RabbitMQ', 'copyright': 'Copyright (C) 2007-2018 Pivotal Software, Inc.', 'capabilities': {'exchange_exchange_bindings': True, 'connection.blocked': True, 'authentication_failure_close': True, 'direct_reply_to': True, 'basic.nack': True, 'per_consumer_qos': True, 'consumer_priorities': True, 'consumer_cancel_notify': True, 'publisher_confirms': True}, 'cluster_name': 'rabbit@b0de64c74aa0', 'platform': 'Erlang/OTP 20.1.7', 'version': '3.7.3'}, mechanisms: ['PLAIN', 'AMQPLAIN'], locales: [u'en_US']\r\n[2018-02-14 08:17:33,729: DEBUG/ForkPoolWorker-43] using channel_id: 1\r\n[2018-02-14 08:17:33,730: DEBUG/ForkPoolWorker-43] Channel open\r\n[2018-02-14 08:17:33,731: DEBUG/MainProcess] pidbox received method active_queues() [reply_to:{u'routing_key': u'335f4216-1057-371f-acf9-5d6d69923375', u'exchange': u'reply.celery.pidbox'} ticket:e379796c-27ce-4425-97cb-603119f8f4e9]\r\n[2018-02-14 08:17:33,732: ERROR/MainProcess] Control command error: error(104, 'Connection reset by peer')\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/worker/pidbox.py\", line 42, in on_message\r\n    self.node.handle_message(body, message)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 129, in handle_message\r\n    return self.dispatch(**body)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 112, in dispatch\r\n    ticket=ticket)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 135, in reply\r\n    serializer=self.mailbox.serializer)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 265, in _publish_reply\r\n    **opts\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 181, in publish\r\n    exchange_name, declare,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 203, in _publish\r\n    mandatory=mandatory, immediate=immediate,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/channel.py\", line 1734, in _basic_publish\r\n    (0, exchange, routing_key, mandatory, immediate), msg\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/abstract_channel.py\", line 50, in send_method\r\n    conn.frame_writer(1, self.channel_id, sig, args, content)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/method_framing.py\", line 166, in write_frame\r\n    write(view[:offset])\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/transport.py\", line 258, in write\r\n    self._write(s)\r\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\r\n    return getattr(self._sock,name)(*args)\r\nerror: [Errno 104] Connection reset by peer\r\n[2018-02-14 08:17:33,735: DEBUG/MainProcess] Closed channel #3\r\n[2018-02-14 08:17:33,735: DEBUG/MainProcess] using channel_id: 3\r\n[2018-02-14 08:17:33,735: DEBUG/MainProcess] Channel open\r\n[2018-02-14 08:17:34,057: DEBUG/MainProcess] heartbeat_tick : for connection 7651125451bb4e6ca43de2c71ef36be3\r\n[2018-02-14 08:17:34,057: DEBUG/MainProcess] heartbeat_tick : Prev sent/recv: 242/1731, now - 254/1781, monotonic - 3162.39587087, last_heartbeat_sent - 3162.39585887, heartbeat int. - 60 for connection 7651125451bb4e6ca43de2c71ef36be3\r\n[2018-02-14 08:17:34,743: DEBUG/MainProcess] pidbox received method add_consumer(queue=u'tower', exchange=None, routing_key=None, exchange_type=u'direct') [reply_to:{u'routing_key': u'335f4216-1057-371f-acf9-5d6d69923375', u'exchange': u'reply.celery.pidbox'} ticket:abec8419-b2e3-473a-9c44-e41784d17c2c]\r\n[2018-02-14 08:17:34,750: DEBUG/MainProcess] Start from server, version: 0.9, properties: {'information': 'Licensed under the MPL.  See http://www.rabbitmq.com/', 'product': 'RabbitMQ', 'copyright': 'Copyright (C) 2007-2018 Pivotal Software, Inc.', 'capabilities': {'exchange_exchange_bindings': True, 'connection.blocked': True, 'authentication_failure_close': True, 'direct_reply_to': True, 'basic.nack': True, 'per_consumer_qos': True, 'consumer_priorities': True, 'consumer_cancel_notify': True, 'publisher_confirms': True}, 'cluster_name': 'rabbit@b0de64c74aa0', 'platform': 'Erlang/OTP 20.1.7', 'version': '3.7.3'}, mechanisms: ['PLAIN', 'AMQPLAIN'], locales: [u'en_US']\r\n[2018-02-14 08:17:34,752: DEBUG/MainProcess] using channel_id: 1\r\n[2018-02-14 08:17:34,752: DEBUG/MainProcess] Channel open\r\n[2018-02-14 08:17:34,758: DEBUG/MainProcess] pidbox received method add_consumer(queue=u'tower_instance_router', exchange=None, routing_key=None, exchange_type=u'direct') [reply_to:{u'routing_key': u'335f4216-1057-371f-acf9-5d6d69923375', u'exchange': u'reply.celery.pidbox'} ticket:e657d3b3-fc03-4794-b2f6-5503da354054]\r\n[2018-02-14 08:17:34,768: DEBUG/MainProcess] pidbox received method add_consumer(queue=u'awx', exchange=None, routing_key=None, exchange_type=u'direct') [reply_to:{u'routing_key': u'335f4216-1057-371f-acf9-5d6d69923375', u'exchange': u'reply.celery.pidbox'} ticket:835dec95-46d8-4af2-aa2f-60b31e6216d8]\r\n2018-02-14 08:17:34,771 INFO     awx.main.tasks Workers on tower node 'awx' removed from queues [] and added to queues [u'tower', 'tower_instance_router', u'awx']\r\n2018-02-14 08:17:34,774 INFO     awx.main.tasks Worker on tower node 'awx' updated celery routes {'awx.main.tasks.purge_old_stdout_files': {'queue': u'awx', 'routing_key': u'awx'}, 'awx.main.tasks.cluster_node_heartbeat': {'queue': u'awx', 'routing_key': u'awx'}} all routes are now {'awx.main.tasks.purge_old_stdout_files': {'queue': u'awx', 'routing_key': u'awx'}, 'awx.main.tasks.cluster_node_heartbeat': {'queue': u'awx', 'routing_key': u'awx'}}\r\n[2018-02-14 08:17:34,778: INFO/ForkPoolWorker-43] Task awx.main.tasks.handle_ha_toplogy_changes[ff7c9786-03d7-4f99-bf37-c2602b491df4] succeeded in 1.098841784s: None`\r\n```\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nI've created new unprivileged member of organization and trying to get list of scheduled jobs via his interface. Every time I get this error:\r\n\r\n```\r\n2018-02-14 07:15:32,441 ERROR    django.request Internal Server Error: /api/v2/schedules/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 248, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 42, in list\r\n    page = self.paginate_queryset(queryset)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 319, in paginate_queryset\r\n    page = super(ListAPIView, self).paginate_queryset(queryset)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 173, in paginate_queryset\r\n    return self.paginator.paginate_queryset(queryset, self.request, view=self)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/pagination.py\", line 214, in paginate_queryset\r\n    self.page = paginator.page(page_number)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 57, in page\r\n    number = self.validate_number(number)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 46, in validate_number\r\n    if number > self.num_pages:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/functional.py\", line 35, in __get__\r\n    res = instance.__dict__[self.name] = self.func(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 91, in num_pages\r\n    if self.count == 0 and not self.allow_empty_first_page:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/functional.py\", line 35, in __get__\r\n    res = instance.__dict__[self.name] = self.func(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 79, in count\r\n    return self.object_list.count()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 364, in count\r\n    return self.query.get_count(using=self.db)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/query.py\", line 499, in get_count\r\n    number = obj.get_aggregation(using, ['__count'])['__count']\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/query.py\", line 480, in get_aggregation\r\n    result = compiler.execute_sql(SINGLE)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\", line 894, in execute_sql\r\n    raise original_exception\r\nProgrammingError: more than one row returned by a subquery used as an expression\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.302\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: OSX High Sierra\r\n* Web Browser: \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- create new user\r\n- assign it as a member organization\r\n- login to new user\r\n- go to \"SCHEDULES\" page\r\n\r\n##### EXPECTED RESULTS\r\n\r\nList of scheduled jobs\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError with message: \"Invalid search term entered. GET returned: 500 A server error has occurred.\" appears.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSystem Administrator user can access \"SCHEDULES\" page without any problems.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nA user should be able to be constrained such that portal mode / my view is the only part of the UI they see.\r\n\r\nWe'd need user fields that the user could not edit for this.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThis is not currently allowed.\r\n```\r\njobs.py:    SOFT_UNIQUE_TOGETHER = [('polymorphic_ctype', 'name')]\r\n```\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nCreate a root group\r\n```\r\n[user@host: ~]$ tower-cli  group create --inventory test --name one\r\nResource changed.\r\n==== ==== ========= \r\n id  name inventory \r\n==== ==== ========= \r\n2332 one          9\r\n==== ==== ========= \r\n```\r\nCreate a second root group\r\n```\r\n[user@host: ~]$ tower-cli  group create --inventory test --name two\r\nResource changed.\r\n==== ==== ========= \r\n id  name inventory \r\n==== ==== ========= \r\n2333 two          9\r\n==== ==== ========= \r\n```\r\nCreate a child group\r\n```\r\n[user@host: ~]$ tower-cli  group create --inventory test --name three --parent two\r\nResource changed.\r\n==== ===== ========= \r\n id  name  inventory \r\n==== ===== ========= \r\n2334 three         9\r\n==== ===== ========= \r\n```\r\nOK, we have two root groups\r\n```\r\n[user@host: ~]$ tower-cli group list --inventory test --root\r\n==== ==== ========= \r\n id  name inventory \r\n==== ==== ========= \r\n2332 one          9\r\n2333 two          9\r\n==== ==== ========= \r\n```\r\nAssociate the child group with the other root group\r\n```\r\n[user@host: ~]$ tower-cli group associate --group three --parent one\r\nOK. (changed: true)\r\n```\r\n\r\nExamine the inventory. Note that the newly associated group remained in its current associated path.\r\n```\r\n[user@host: ~]$ curl -k --basic https://awxhost/api/v2/inventories/9/script/ | jq '.'\r\n...\r\n{\r\n  \"three\": {\r\n    \"hosts\": [],\r\n    \"children\": [],\r\n    \"vars\": {}\r\n  },\r\n  \"two\": {\r\n    \"hosts\": [],\r\n    \"children\": [\r\n      \"three\"\r\n    ],\r\n    \"vars\": {}\r\n  },\r\n  \"one\": {\r\n    \"hosts\": [],\r\n    \"children\": [\r\n      \"three\"\r\n    ],\r\n    \"vars\": {}\r\n  }\r\n}\r\n```\r\n\r\nAssociate the root group with the other root group\r\n```\r\n[user@host: ~]$ tower-cli group associate --group two --parent one\r\nOK. (changed: true)\r\n```\r\n\r\nExamine the root groups. Note that the newly associated group *did not* remain in its current associated path.\r\n```\r\n[user@host: ~]$ tower-cli group list --inventory test --root\r\n==== ==== ========= \r\n id  name inventory \r\n==== ==== ========= \r\n2332 one          9\r\n==== ==== ========= \r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSince 'root groups' is what's used to populate the UI, this leads to inconsistent behavior.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThere are many places where the API takes a string input that is a JSON field. (Sat6 group patterns, extra_vars, etc)\r\n\r\nPassing this data generally involves a lot of quoting. It may be useful to have a cleaner way to input this data.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nA typical error log from AWX is:\r\n\r\n```\r\n2018-02-12 21:41:29,559 WARNING  awx.api.generics status 400 received by user SuperCoolUser attempting to access /api/v2/job_templates/42/extra_credentials/ from 127.0.0.12\r\n```\r\n\r\nIt would help debugging API failures (especially provisioning callbacks) if the JSON error returned to the user in this case was also included in the log.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nOccasionally it is worthwhile to run a playbook at least somewhat \"in the manner that AWX does\" for debugging purposes.\r\n\r\nIt would be useful to ship a small wrapper (`awx-ansible-playbook` ?) that does:\r\n- venv activation (allow overriding with a custom venv location)\r\n- PYTHONPATH setting\r\n- any other similar parameters\r\n\r\nand then executes `ansible-playbook` with the required arguments.\r\n\r\nThis tool should NOT try and cover:\r\n- bwrap isolation\r\n- credentials\r\n- AWX inventory\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWould be nice to have the ability to exclude dates, times, hours, or ... from scheduler. (Example Usage: static maintenance windows, exclude known times/dates) \r\n\r\n##### ENVIRONMENT\r\n* AWX install method: docker on linux\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAbility to exclude certain dates, times, hours, ...."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThe 'cleanup facts' management job cleans up old system tracking facts... which is not something AWX even collects.\r\n\r\nIt should be updated to purge the fact cache.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nrun 'cleanup facts' with any timeframe\r\n\r\n##### EXPECTED RESULTS\r\n\r\nFacts are cleaned up.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNothing.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf I'm in the middle of an inventory update script, I don't have any way of directly knowing what workflow I'm a part of, and some users make decisions based on that type of context.\r\n\r\nWe expanded the set of magic variables we provide for job runs in https://github.com/ansible/awx/issues/237, but this only applied to `--extra-vars`, which are not available for inventory updates. Those only have the env vars as an option to receive contextual data.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n* AWX install method: N/A\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun an inventory script, inspect environment variables\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSubject to expansion, but at least a variable for\r\n\r\n - workflow ID\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWe have these, and I think that's pretty well it\r\n\r\n - INVENTORY_SOURCE_ID\r\n - INVENTORY_UPDATE_ID\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nActually, I would like to consolidate the magic variables for all types, and consistently provide the same ones for both extra_vars as well as env vars.\r\n\r\nDocs should also be updated after this lands."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nIf a controller node dies for an isolated job, we lose track of the job. Currently, we mark it as failed.\r\n\r\nHowever, we likely do have enough information on the job to resume monitoring from another node in the controller group. We just don't do it yet.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n```\r\n        if res.status_code == 401:\r\n            return (dict(error=_('Unauthorized access. Please check your Insights Credential username and password.')), status.HTTP_502_BAD_GA\r\nTEWAY)\r\n        elif res.status_code != 200:\r\n            return (dict(error=_(\r\n                'Failed to gather reports and maintenance plans from Insights API at URL {}. Server responded with {} status code and message {}'\r\n            ).format(url, res.status_code, res.content)), status.HTTP_502_BAD_GATEWAY)\r\n```\r\n\r\nOne example case of this is a 404 when the host is not known in insights (or was deleted) ... we should catch this case and porvide a nicer error message.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nTo get all inventory updates for a particular inventory, you need query all related inventory sources.\r\n\r\nWe could create a toplevel related field that accomplishes this.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nYou can post random things in the survey 'name' field, and it will be accepted.\r\n\r\nExample:\r\n```\r\n{\"description\": \"test\",\r\n \"name\": [{\"default\": \"wfjn_var1_default\",\r\n           \"question_name\": \"Test-1\",\r\n           \"required\": false,\r\n           \"type\": \"password\",\r\n           \"variable\": \"var1\"},\r\n          {\"default\": \"wfjn_var2_default\",\r\n           \"question_name\": \"Test-2\",\r\n           \"required\": false,\r\n           \"type\": \"text\",\r\n           \"variable\": \"var2\"}],\r\n \"spec\": [{\"default\": \"foo\",\r\n           \"question_name\": \"What's the password?\",\r\n           \"required\": false,\r\n           \"type\": \"password\",\r\n           \"variable\": \"secret\"}]}\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: current\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nExample:\r\n- [ ] update on Smart Inventory\r\n- [ ] read on team\r\n(add more here)\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nThe inventory update for a project-based source just says 'Sourced from a project' for the source type.\r\n\r\n<img width=\"1439\" alt=\"screen shot 2017-08-11 at 2 38 36 pm\" src=\"https://user-images.githubusercontent.com/9889020/29227214-ff44ccc6-7ea2-11e7-8a3a-5173d6fd885b.png\">\r\n\r\nIt should link to the actual project.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nSatellite 6 credentials ('cloud' type) are only exposed as a file (foreman.ini), generally for use by inventory.\r\nInsights credentials ('scm' type) are only exposed for projects, but also can be attached to inventories.\r\n\r\nHowever, ansible modules exist (redhat_subscription, etc) that potentially could use one/both of these credential types.\r\n\r\nWe should fix this, ideally in a way that:\r\n- allows for exposing them in a way that playbooks can be clearly written that use them\r\n- does not just change both to expose them as the same extra/env vars, in ways that would conflict\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n\r\nWith https://github.com/ansible/awx/issues/74, we added the ability to scale podified cluster nodes at runtime.\r\n\r\nThis followon is to extend/merge those features into the isolated node concept:\r\n- register/deregister isolated nodes at runtime as standalone execution nodes\r\n- use these execution nodes when in OCP\r\n\r\nWhen used containerized, isolated nodes should have the option to have a potentially more efficient transfer mechanism than ssh, such as a shared volume set up by the container manager.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI \r\n\r\n##### SUMMARY\r\nI am requesting a pause feature be included as one of the steps in a job workflow in-between playbooks so that a user can give the +1 to continue on to the next playbook in the job workflow.\r\n\r\nThis will give the user the unlimited amount of time they need to do their manual steps, but also allow them to continue as fast as they are ready with out having to wait on some other trigger.\r\n\r\n\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\nor \r\n - Documentation\r\nnot sure if I just missed some config here\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nI've set up a fresh env and I'm attempting to run a job on a host from the inventory.  The job fails with an ssh error.  Investigation suggests to me that awx is attempting to connect as the root user (not the ec2-user configured in the cred).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n   Python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\n* Operating System: Amazon linux\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nClean build following the install guide and then connect to the awx via browser.  Set up 3 credentials aws key/secret, ec2-user ssh key & git key.  \r\n\r\nSetup an inventory & source then sync, verify ec2 instances are imported.  Setup a project from git.  Setup a template using the info from the previous steps and attempt to execute the job.  Set the ssh verbosity to debug.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpected the job to complete.  The ssh key imported into the UI has been tested from my laptop and the server hosting the AWX containers.  \r\n\r\n##### ACTUAL RESULTS\r\n\r\nJob fails with the following:\r\n\r\n\"msg\": \"Failed to connect to the host via ssh: OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017\\r\\ndebug1: Reading configuration data /etc/ssh/ssh_config\\r\\ndebug1: /etc/ssh/ssh_config line 58: Applying options for *\\r\\ndebug1: auto-mux: Trying existing master\\r\\ndebug1: Control socket \\\"/tmp/awx_7_Oeu3CV/cp/ec2-**-**-**-**.eu-west-1.compute.amazonaws.com22root\\\" does not exist\\r\\ndebug2: resolving \\\"ec2-**-**-**-**.eu-west-1.compute.amazonaws.com\\\" port 22\\r\\ndebug2: ssh_connect_direct: needpriv 0\\r\\ndebug1: Connecting to ec2-**-**-**-**.eu-west-1.compute.amazonaws.com [**.**.**.**] port 22.\\r\\ndebug2: fd 3 setting O_NONBLOCK\\r\\ndebug1: fd 3 clearing O_NONBLOCK\\r\\ndebug1: Connection established.\\r\\ndebug3: timeout: 9999 ms remain after connect\\r\\ndebug1: permanently_set_uid: 0/0\\r\\ndebug1: key_load_public: No such file or directory\\r\\ndebug1: identity file /root/.ssh…\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI've tested the ssh key I'm using from the server running the awx containers and the awx_task container itself using:\r\n\r\ndocker exec -ti  awx_task bash\r\nssh ec2-user@ec2-**-**-**-**.eu-west-1.compute.amazonaws.com -i ssh_key\r\n\r\nthis connection works fine.\r\n\r\nFrom the logs it looks like ansible is attempting to use root to login, I've also checked the secure log on the remote host and see this\r\n\r\nFeb 12 12:14:22 integration sshd[11773]: ROOT LOGIN REFUSED FROM 10.98.135.52\r\nFeb 12 12:14:22 integration sshd[11773]: ROOT LOGIN REFUSED FROM 10.98.135.52 [preauth]\r\nFeb 12 12:14:22 integration sshd[11773]: Connection closed by 10.98.135.52 [preauth]\r\n\r\nI've double checked the USERNAME field in the credential and it's set to ec2-user.\r\n\r\nmany thanks for your help.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCurrently, the inventory import script for oVirt/RHEV always select the IP address of the first network interface as the inventory host ip.  This feature would add filtering to allow the ip address of an alternative interface to be used instead.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nImport an oVirt/RHEV inventory that contains hosts with multiple network interfaces.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAdditional filtering options will allow for cases where the first interface is not the interface through which Ansible should connect to the host.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOnly the first interface is available.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nUI shows job failed status even when worker in background is still running in background. Gives users false status.\r\n\r\n##### ENVIRONMENT\r\nSee Google Posting for more: https://groups.google.com/forum/#!topic/awx-project/fjKjQa78f_A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRunning a job that takes > than 5 minutes to execute\r\n\r\n##### EXPECTED RESULTS\r\n\r\nRunning status instead of failed. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nFailed Status.\r\n\r\nProcess is still running in background and later will update the correct status, however shows job failure until correct status update.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSee Google Posting for more: https://groups.google.com/forum/#!topic/awx-project/fjKjQa78f_A"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWe need to query playbook for provide list of tags selection for execution.\r\nMost actual when using  \"Prompt on launch\" option.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.29\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Archlinux\r\n* Web Browser: Firefox 58.0\r\n\r\n##### ADDITIONAL INFORMATION\r\n![screenshot-2018-2-9 ansible awx set maintenance](https://user-images.githubusercontent.com/7556217/36032237-a748972e-0dad-11e8-931f-4bb1e6f1b363.png)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen using \"Limit\" option, we need to query playbook and inventory file for provide list of hosts (or groups) selection for execution.\r\nMost actual when using  \"Prompt on launch\" option.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.29\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Archlinux\r\n* Web Browser: Firefox 58.0\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI'm having a lot of trouble getting jobs to run consistently. Often they will just hang forever, there doesn't seem to be a specific task that causes this, and it happens randomly, though the bigger the playbook the more likely it seems to happen. When checking the worker container logs I see the following\r\n\r\n``` \r\n018-02-09 12:29:48,578 ERROR    awx.main.tasks Encountered error on initial log configuration.\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 114, in task_set_logger_pre_run\r\n    configure_external_logger(settings, is_startup=False)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/utils/handlers.py\", line 342, in configure_external_logger\r\n    is_enabled = settings_module.LOG_AGGREGATOR_ENABLED\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 476, in __getattr_without_cache__\r\n    return getattr(self._wrapped, name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 389, in __getattr__\r\n    value = self._get_local(name)\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 309, in _get_local\r\n    self._preload_cache()\r\n  File \"/usr/lib/python2.7/site-packages/awx/conf/settings.py\", line 271, in _preload_cache\r\n    for setting in Setting.objects.filter(key__in=settings_to_cache.keys(), user__isnull=True).order_by('pk'):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 250, in __iter__\r\n    self._fetch_all()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 1118, in _fetch_all\r\n    self._result_cache = list(self._iterable_class(self))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 53, in __iter__\r\n    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\", line 882, in execute_sql\r\n    cursor = self.connection.cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 231, in _cursor\r\n    return self._prepare_cursor(self.create_cursor(name))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 231, in _cursor\r\n    return self._prepare_cursor(self.create_cursor(name))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 220, in create_cursor\r\n    cursor = self.connection.cursor()\r\nInterfaceError: connection already closed\r\n```\r\nThis seems to put the task container in a state where it cannot run any more jobs, and needs to be restarted. However in the interface it seems to think the job is still running, but it just hangs forever\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.372\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: RHEL\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis is hard as it seems to happen in a random manner, step that worked before have this error on next run etc......\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe job does not exit randomly, or if it does it at least does not leave the task container in a broken state which stops all future jobs from proceeding\r\n"},{"labels":["api",null,null],"text":"This is a followup issue for #903\r\n\r\nThe RBAC and other deep-copying logic related to node credentials have not been updated to use the new `credentials` relationship. Workflow copying things related to this relationship need to be tested and updated."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nStandard UI/UX paradigm for non-admin accounts is to require the current password to change a password.\r\n\r\nTower just lets you change your password.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nansible-tower issue #3384 "},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nf3f10df361884d5060796f467181eeaab0309c51 disabled direct job launching via the v2 API. I'd like to propose this commit is reverted. \r\n\r\nAlthough I guess there was a good reason for disabling this, I've been unable to discover why.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: devel (9bc0a0743b608add7cebfe7c976c666a2788a03d)\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPOST a job object to `/api/v2/jobs/`\r\n\r\n```json\r\n{\r\n\t\"name\": \"testrun1__job_080c5a9f-d574-4cce-b46b-1b5351d63722\",\r\n\t\"description\": \"[ED2] Apply roles ([testrole]) and/or playbooks ([]) to 1 hosts\",\r\n\t\"job_type\": \"run\",\r\n\t\"inventory\": 5,\r\n\t\"project\": 6,\r\n\t\"playbook\": \"de51657d-9c58-419e-ac70-bd1f5080e2d4.yml\",\r\n\t\"credential\": 3,\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe job runs as desired without the need for a job template.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n405 Method Not Allowed\r\n`{\"error\":\"POST not allowed for Job launching in version 2 of the api\"}`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAs you may be able to tell from the example POST, we are auto generating these requests to AWX as we're trying to use it to one-shot provision servers which then leave our control (so no need for permanent inventory/playbook configuration). While I could create an ephemeral job template for this I'd rather avoid the extra API call and management overhead.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nI am building the awx from the source code using make targets. When  I start the container using the image that I built from source getting the below error.   Can some please help me to find all the where the rabbitmq connection details are mentioned.  When I check the rabbitmq logs for the same user sometimes the  connection is established, sometimes it is failing. Please help!!!!\r\n\r\nawx_devel_logs\r\n==============\r\n18:47:29 flower.1    | [W 180208 18:47:29 control:44] 'active' inspect method failed\r\n18:47:29 flower.1    | [W 180208 18:47:29 control:44] 'reserved' inspect method failed\r\n18:47:29 flower.1    | [W 180208 18:47:29 control:44] 'revoked' inspect method failed\r\n18:47:29 flower.1    | [W 180208 18:47:29 control:44] 'conf' inspect method failed\r\n18:47:39 daphne.1    | 2018-02-08 18:47:39,107 INFO     Starting server at tcp:port=8051:interface=127.0.0.1, channel layer awx.asgi:channel_layer.\r\n18:47:39 daphne.1    | 2018-02-08 18:47:39,107 INFO     HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n18:47:39 daphne.1    | 2018-02-08 18:47:39,108 INFO     Using busy-loop synchronous mode on channel layer\r\n18:47:39 daphne.1    | 2018-02-08 18:47:39,108 INFO     Listening on endpoint tcp:port=8051:interface=127.0.0.1\r\n18:47:39 receiver.1  | 2018-02-08 18:47:39,204 INFO     awx.main.commands.run_callback_receiver Started worker 0\r\n18:47:39 receiver.1  | 2018-02-08 18:47:39,204 INFO     awx.main.commands.run_callback_receiver Started worker 0\r\n18:47:39 receiver.1  | 2018-02-08 18:47:39,210 INFO     awx.main.commands.run_callback_receiver Started worker 1\r\n18:47:39 receiver.1  | 2018-02-08 18:47:39,210 INFO     awx.main.commands.run_callback_receiver Started worker 1\r\n18:47:39 daphne.1    | 2018-02-08 18:47:39,300 ERROR    Error trying to receive messages: (0, 0): (403) ACCESS_REFUSED - Login was refused using authentication mechanism AMQPLAIN. For details see the broker logfile.\r\n\r\n18:47:40 runworker.1 | Traceback (most recent call last):\r\n18:47:40 runworker.1 |   File \"manage.py\", line 8, in <module>\r\n18:47:40 runworker.1 |     manage()\r\n18:47:40 runworker.1 |   File \"/awx_devel/awx/__init__.py\", line 109, in manage\r\n18:47:40 runworker.1 |     execute_from_command_line(sys.argv)\r\n18:47:40 runworker.1 |   File \"/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line\r\n18:47:40 runworker.1 |     utility.execute()\r\n18:47:40 runworker.1 |   File \"/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 356, in execute\r\n18:47:40 runworker.1 |     self.fetch_command(subcommand).run_from_argv(self.argv)\r\n18:47:40 runworker.1 |   File \"/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 283, in run_from_argv\r\n18:47:40 runworker.1 |     self.execute(*args, **cmd_options)\r\n18:47:40 runworker.1 |   File \"/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 330, in execute\r\n18:47:40 runworker.1 |     output = self.handle(*args, **options)\r\n18:47:40 runworker.1 |   File \"/venv/awx/lib/python2.7/site-packages/channels/management/commands/runworker.py\", line 83, in handle\r\n18:47:40 runworker.1 |     worker.run()\r\n18:47:40 runworker.1 |   File \"/venv/awx/lib/python2.7/site-packages/channels/worker.py\", line 87, in run\r\n18:47:40 runworker.1 |     channel, content = self.channel_layer.receive_many(channels, block=True)\r\n18:47:40 runworker.1 |   File \"/venv/awx/lib/python2.7/site-packages/asgiref/base_layer.py\", line 43, in receive_many\r\n18:47:40 runworker.1 |     return self.receive(channels, block)\r\n\r\n\r\n\r\nRabbitMq Logs:\r\n==========\r\n\r\n2018-02-08 18:47:27.402 [info] <0.13249.0> connection <0.13249.0> (127.0.0.1:37504 -> 127.0.0.1:5672): user 'awx' authenticated and granted access to vhost '/'\r\n2018-02-08 18:47:27.402 [info] <0.13253.0> connection <0.13253.0> (127.0.0.1:37506 -> 127.0.0.1:5672): user 'awx' authenticated and granted access to vhost '/'\r\n2018-02-08 18:47:39.209 [info] <0.13311.0> accepting AMQP connection <0.13311.0> (127.0.0.1:37534 -> 127.0.0.1:5672)\r\n2018-02-08 18:47:39.225 [error] <0.13311.0> Error on AMQP connection <0.13311.0> (127.0.0.1:37534 -> 127.0.0.1:5672, state: starting):\r\nAMQPLAIN login refused: user 'awx' - invalid credentials\r\n2018-02-08 18:47:39.226 [info] <0.13311.0> closing AMQP connection <0.13311.0> (127.0.0.1:37534 -> 127.0.0.1:5672)\r\n2018-02-08 18:47:39.315 [info] <0.13315.0> accepting AMQP connection <0.13315.0> (127.0.0.1:37536 -> 127.0.0.1:5672)\r\n2018-02-08 18:47:39.319 [error] <0.13315.0> Error on AMQP connection <0.13315.0> (127.0.0.1:37536 -> 127.0.0.1:5672, state: starting):\r\nAMQPLAIN login refused: user 'awx' - invalid credentials\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"This is a followup issue for https://github.com/ansible/awx/pull/903\r\n\r\nThe UI will need \"copy\" inside of summary_fields -> `user_capabilities` for at least some resources. The resources that have the copy endpoint are the following.\r\n\r\n - job templates\r\n - projects\r\n - inventories\r\n - workflows\r\n - credentials\r\n - notification templates\r\n - inventory scripts\r\n\r\nThe copy capability is a non-trivial calculation for at least some of these. Consider:\r\n\r\nInventories and projects have an associated `organization`. When a copy is made, the copy must have the same organization. That means that the necessary permission to copy the resource is exactly the admin_role to the related organization. This information is not available to the UI anywhere else.\r\n\r\nThere may be some trivial rule that the UI can key off of for some resources (like for inventory scripts, it might be the same as \"edit\" capability). So I don't want to say from the get-go that we will be adding this field for all the resources listed above.\r\n\r\nPing @jakemcdermott "},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nNo more than 4 jobs running in the same time\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.4.3\r\n* Operating System: centos7\r\n* Web Browser: chrome\r\n\r\n##### \r\nWhen I try to run many jobs from different jobs templates and targeting different remote hosts, I cannot get more than 4 jobs running in the same time, the other stay in the waiting queue.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen I rerun a failed Workflow job, it tries to execute each stage twice, in parallel\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3\r\n* AWX install method: docker\r\n* Ansible version:  2.4.1\r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome, Opera, Safari\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate 2 jobs. Ensure one of them will fail.\r\nCreate a workflow job using these 2 jobs.\r\nThe job which will fail is first to execute.\r\nRun the workflow job.\r\nAfter it fails, go to the job list and click the rocket to rerun.\r\n\r\n\r\n##### EXPECTED RESULTS\r\nThe job should rerun the failed instance.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe job attempts to rerun twice in parallel.\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n![image](https://user-images.githubusercontent.com/4122160/35932656-19869c7c-0bed-11e8-93c4-2b4f88e57457.png)\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n \r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n \r\n##### SUMMARY\r\n2 users execute jobs in ui - one immediately starts to run, other goes to pending state until first job finishes. \r\n\r\nThe host holding the docker container has 16 gig of ram (circa 10 gig available). \r\n\r\nThe job templates are using entirely different git repos (update on launch is not ticked), \r\n\r\nFirst job has 10 hosts in the inventory (forks at default)\r\n\r\nsecond job has 4 hosts in the inventory (forks at 200)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1,0.1.273\r\n* AWX install method: docker on linux, \r\n* Ansible version:  2.4.2\r\n* Operating System: rhel 7\r\n* Web Browser: chrome 10\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure 2 job templates, projects from git, inventory one using etcd, other is in awx internal inventory. \r\n\r\none user executes their inventory in ui, other user executes, there one in ui, second one goes pending state.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nboth jobs should run simultanously\r\n\r\n##### ACTUAL RESULTS\r\n first job runs,\r\nsecond one remains in pending state until first finished.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Usage question\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: Linux 3.10.0-693.2.2.el7.x86_64\r\n* Web Browser: Google Chrome 63\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nFirst, import an existing Ansible project from git, where a couple of playbooks and an inventory file are already there. Then created a workflow template composed of three job templates each of which was created according to a playbook respectively. For simplicity, l take only two jobs for example:\r\n\r\n1. Create an Azure VM\r\n2. Install some softwares on the created VM\r\n\r\nThe last task in the first job is adding the created VM's ip address into a temporary group with the ansible module `add_host`. However, this newly added VM can not be seen in the second job. So I get a `[WARNING]: Could not match supplied host pattern, ignoring: da23334a-63cb-40c3\r\n-b0eb-2bf0f8cbe892` where the uuid is the temp group name. \r\n\r\nSuch issue won't happen if I combine the two jobs into a single playbook and run it in awx. So I guess the `add_host`'s result doesn't propagate to the subsequent jobs. Besides this, I found that it's also impossible to use `hostvars['PREVIOUS_HOST']` in the subsequent jobs. So my question is: what is the `add_host` result's scope? How can I access the variables in a whole workflow?\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLet `add_host` result visible in subsequent jobs in a workflow.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`add_host` can only work within a playbook/job template.\r\n\r\nMany thanks.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen using an Inventory Source (tested on Custom/EC2 Inventory Scripts), providing a custom environment variable through the UI doesn't get used when the script runs. For example:\r\nUsing EC2 Inventory Source, set envrionment variables `iam_role: <role_arn>` doesn't actually get passed to the script.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.5\r\n* AWX install method: minishift\r\n* Ansible version:  2.4.2.0\r\n* Operating System: MacOS\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nLogin on UI, Inventories > Add > Fill out the primary details > Save > Sources > Add Source > name: test-ec2, Source: Amazon EC2, Select AWS creds, Select Region (eu-west-1), Blank Instance Filters, Blank Group By, Debug > Set Source Variables: iam_role:  <an IAM role>,  vpc_destination_variable: private_ip_address > Save\r\nRun Inventory Sync (which fails)\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nInventory Source to succeed and retrieve AWS Information\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nFailed with error: ERROR: \"Error connecting to AWS backend.\"\r\nDebug provides more output - ERROR: \"Error connecting to AWS backend. Operation not permitted\" \r\n\r\nYet running the script from desktop (same ec2.py script) with ec2.ini and the same options set, works correctly.\r\n\r\nMy current work around requires me to copy the script for every iam_role change, and create a custom inventory script, placing the source variables directly into the file and not passing in any source variables through the UI\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n<img width=\"1422\" alt=\"screen shot 2018-02-06 at 11 03 48\" src=\"https://user-images.githubusercontent.com/23191993/35856297-82a2861e-0b2d-11e8-86bb-6a35829fc84b.png\">\r\n<img width=\"1432\" alt=\"screen shot 2018-02-06 at 11 05 11\" src=\"https://user-images.githubusercontent.com/23191993/35856354-adb8624c-0b2d-11e8-851c-113d28dea2ef.png\">\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n400 error if I try to add a template with a survey to a workflow\r\n\r\nI get a popup \"ERROR!\r\nFailed to add workflow node. POST returned status: 400\"\r\n\r\nIn logs I see:\r\n`awx_web_1    | 2018-02-05 23:09:34,992 WARNING  awx.api.generics status 400 received by user justme attempting to access /api/v2/workflow_job_templates/40/workflow_nodes/ from 4.4.4.4\r\nawx_web_1    | [pid: 31|app: 0|req: 69/168] 3.3.3.3() {52 vars in 3578 bytes} [Mon Feb  5 23:09:34 2018] POST /api/v2/workflow_job_templates/40/workflow_nodes/ => generated 146 bytes in 727 msecs (HTTP/1.1 400) 9 headers in 264 bytes (1 switches on core 0)\r\nawx_web_1    | 3.3.3.3- - [05/Feb/2018:23:09:35 +0000] \"POST /api/v2/workflow_job_templates/40/workflow_nodes/ HTTP/1.1\" 400 146 \"http://ps1mawx-01.mydomain.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.119 Safari/537.36\" \"-\"`\r\n\r\nUsing Chrome developer tools, I see:\r\n\r\nRequest URL:http://boxname-01.mydomain.com/api/v2/workflow_job_templates/40/workflow_nodes/\r\nRequest Method:POST\r\nStatus Code:400 Bad Request\r\nRemote Address:10.254.139.185:80\r\nReferrer Policy:no-referrer-when-downgrade\r\n\r\nvariables_needed_to_start : [\"'x_template' value missing\", \"'x_env_name' value missing\", \"'x_label' value missing\",…]\r\n0 : \"'x_template' value missing\"\r\n1 : \"'x_env_name' value missing\"\r\n2 : \"'x_label' value missing\"\r\n3 : \"'static_ip' value missing\"\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2\r\n* AWX install method: docker on ubuntu\r\n* Ansible version:  2.4.2\r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome, Safara, Opera\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1.  Create a Job Template. Details are irrelevant. All that matters is this template has a Survey. I have tried various names and Answer types and Required / not and get the same result any time\r\n2. Now create a Workflow Template \r\n2a. Click Workflow Editor\r\n2b. Add the job template created above.\r\n2c. Click Save\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expect it to either add the template & query the survey of the template or popup error stating \r\n\r\n##### ACTUAL RESULTS\r\n\r\nI get a popup \"ERROR!\r\nFailed to add workflow node. POST returned status: 400\"\r\n\r\nIn logs I see:\r\n`awx_web_1    | 2018-02-05 23:09:34,992 WARNING  awx.api.generics status 400 received by user justme attempting to access /api/v2/workflow_job_templates/40/workflow_nodes/ from 4.4.4.4\r\nawx_web_1    | [pid: 31|app: 0|req: 69/168] 3.3.3.3() {52 vars in 3578 bytes} [Mon Feb  5 23:09:34 2018] POST /api/v2/workflow_job_templates/40/workflow_nodes/ => generated 146 bytes in 727 msecs (HTTP/1.1 400) 9 headers in 264 bytes (1 switches on core 0)\r\nawx_web_1    | 3.3.3.3- - [05/Feb/2018:23:09:35 +0000] \"POST /api/v2/workflow_job_templates/40/workflow_nodes/ HTTP/1.1\" 400 146 \"http://ps1mawx-01.mydomain.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.119 Safari/537.36\" \"-\"`\r\n\r\nUsing Chrome developer tools, I see:\r\n\r\nRequest URL:http://boxname-01.mydomain.com/api/v2/workflow_job_templates/40/workflow_nodes/\r\nRequest Method:POST\r\nStatus Code:400 Bad Request\r\nRemote Address:10.254.139.185:80\r\nReferrer Policy:no-referrer-when-downgrade\r\n\r\nvariables_needed_to_start : [\"'x_template' value missing\", \"'x_env_name' value missing\", \"'x_label' value missing\",…]\r\n0 : \"'x_template' value missing\"\r\n1 : \"'x_env_name' value missing\"\r\n2 : \"'x_label' value missing\"\r\n3 : \"'static_ip' value missing\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nRaise \"Field is not allowed for use in workflows\" error when creating workflow schedule\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.3.5\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.3.0\r\n* Operating System: WIN10\r\n* Web Browser: Chrome  63.0.3239.132（64 bits）\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a workflow template, add jobs into it by workflow editor\r\n2. Click schedule button in this new workflow template\r\n3. Fill the form and click Save\r\n4. Failed to save, web throw a error:\r\nERROR!\r\nField is not allowed for use in workflows.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCreate schedule for workflow template normally\r\n\r\n##### ACTUAL RESULTS\r\n\r\nRaise \"Field is not allowed for use in workflows\" error when creating workflow schedule\r\n![image](https://user-images.githubusercontent.com/28291313/35786590-33fe658e-0a63-11e8-8b1c-5c6ed3d004b2.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n![image](https://user-images.githubusercontent.com/28291313/35786558-f51ef8ec-0a62-11e8-86fa-509a1928f39d.png)\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nHave the option to select if a job template performs an SCM checkout/update. This can significantly reduce the amount of time it takes to run each job. It also means that jobs don't need to queue if they are using the same project.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWhen a project is added first time it downloads from source control, at that point all the source control files exist on the filesystem. A job template is then created and points to the playbooks on the filesystem. Could we not then be able to choose if we update the project on each job run? If we choose not to then it just uses the files downloaded earlier from the project setup?\r\n\r\nIf there are multiple AWX nodes then could there be a process that runs on project add/update that forces the other nodes to also perform and download/update? This will keep things in sync."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nAny user currently can create a personal credential and then delegate access to it to other users.\r\n\r\nThe request is to disable this feature, such that only elevated users can create credentials.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAlternatively, restrict the ability to delegate access to them.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nVisiting the API endpoint /api/v2/job_templates/ results in a server error\r\n\r\n##### ENVIRONMENT\r\nAWX version: 1.0.2.75\r\nAWX install method: docker on linux\r\nAnsible version: 2.4.2.0\r\nOperating System: RHEL\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a workflow and do not edit it, delete it, in my case it is not removed from the UI, then visit the api page\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWorkflows/job templates are shown as expected\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nServer Error\r\nGET /api/v2/job_templates/\r\nHTTP 500 Internal Server Error\r\nContent-Type: application/json\r\nVary: Accept\r\n{\r\n    \"detail\": \"A server error has occurred.\"\r\n}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWeb Logs\r\n```\r\n2018-02-02 12:59:17,022 ERROR    django.request Internal Server Error: /api/v2/job_templates/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 253, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 45, in list\r\n    return self.get_paginated_response(serializer.data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 738, in data\r\n    ret = super(ListSerializer, self).data\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 262, in data\r\n    self._data = self.to_representation(self.instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 656, in to_representation\r\n    self.child.to_representation(item) for item in iterable\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 611, in to_representation\r\n    return super(UnifiedJobTemplateSerializer, self).to_representation(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 2407, in to_representation\r\n    ret = super(JobOptionsSerializer, self).to_representation(obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 500, in to_representation\r\n    ret[field.field_name] = field.to_representation(attribute)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 1816, in to_representation\r\n    return method(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 300, in _get_related\r\n    return {} if obj is None else self.get_related(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 2536, in get_related\r\n    res = super(JobTemplateSerializer, self).get_related(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 580, in get_related\r\n    if obj.current_job:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/related_descriptors.py\", line 184, in __get__\r\n    rel_obj = self.get_object(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/related_descriptors.py\", line 159, in get_object\r\n    return qs.get(self.field.get_reverse_related_filter(instance))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 380, in get\r\n    self.model._meta.object_name\r\nDoesNotExist: UnifiedJob matching query does not exist.\r\n2018-02-02 12:59:17,022 ERROR    django.request Internal Server Error: /api/v2/job_templates/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 253, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 45, in list\r\n    return self.get_paginated_response(serializer.data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 738, in data\r\n    ret = super(ListSerializer, self).data\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 262, in data\r\n    self._data = self.to_representation(self.instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 656, in to_representation\r\n    self.child.to_representation(item) for item in iterable\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 611, in to_representation\r\n    return super(UnifiedJobTemplateSerializer, self).to_representation(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 2407, in to_representation\r\n    ret = super(JobOptionsSerializer, self).to_representation(obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 500, in to_representation\r\n    ret[field.field_name] = field.to_representation(attribute)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 1816, in to_representation\r\n    return method(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 300, in _get_related\r\n    return {} if obj is None else self.get_related(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 2536, in get_related\r\n    res = super(JobTemplateSerializer, self).get_related(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 580, in get_related\r\n    if obj.current_job:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/related_descriptors.py\", line 184, in __get__\r\n    rel_obj = self.get_object(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/related_descriptors.py\", line 159, in get_object\r\n    return qs.get(self.field.get_reverse_related_filter(instance))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 380, in get\r\n    self.model._meta.object_name\r\nDoesNotExist: UnifiedJob matching query does not exist.\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen running some playbooks they fail with no output\r\n\r\n##### ENVIRONMENT\r\n* AWX version:  1.0.2.75\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: RHEL\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn this specific case I am trying to run the openshift byo config.yml playbook, but i'm not sure that this is the root cause.\r\nI set up the job and trigger it, it fails, and no output at all is written. Note that perhaps the job is failing for a valid reason, but how can I tell what that is?\r\n\r\nTrying to get the output from the tower-cli also produces no helpful output \r\n\r\n```\r\n☿ tower-cli job stdout 37\r\nOK. (changed: false)`\r\n```\r\n\r\nOther ad-hoc commands directly on the host work correctly and write to stdout as expected\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSomething is output that explains why the job fails\r\n\r\n##### ACTUAL RESULTS\r\n\r\nOutput is blank\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIn the task worked logs some data is output, but it directs you to stdout, which is of course blank\r\n```\r\n2018-02-02 12:08:21,895 DEBUG    awx.main.scheduler Starting job 38 (pending) in group tower (remaining_capacity=275)\r\n2018-02-02 12:08:21,895 DEBUG    awx.main.scheduler Starting job 38 (pending) in group tower (remaining_capacity=275)\r\n[2018-02-02 12:08:21,895: DEBUG/ForkPoolWorker-324] Starting job 38 (pending) in group tower (remaining_capacity=275)\r\n2018-02-02 12:08:21,977 INFO     awx.main.scheduler Submitting job 38 (waiting) to instance group 1.\r\n2018-02-02 12:08:21,977 INFO     awx.main.scheduler Submitting job 38 (waiting) to instance group 1.\r\n[2018-02-02 12:08:21,977: INFO/ForkPoolWorker-324] Submitting job 38 (waiting) to instance group 1.\r\n2018-02-02 12:08:22,058 DEBUG    awx.main.scheduler job 38 (waiting) consumed 20 capacity units from tower with prior total of 0\r\n2018-02-02 12:08:22,058 DEBUG    awx.main.scheduler job 38 (waiting) consumed 20 capacity units from tower with prior total of 0\r\n[2018-02-02 12:08:22,058: DEBUG/ForkPoolWorker-324] job 38 (waiting) consumed 20 capacity units from tower with prior total of 0\r\n[2018-02-02 12:08:22,089: DEBUG/ForkPoolWorker-324] Start from server, version: 0.9, properties: {'information': 'Licensed under the MPL.  See http://www.rabbitmq.com/', 'product': 'RabbitMQ', 'copyright': 'Copyright (C) 2007-2015 Pivotal Software, Inc.', 'capabilities': {'exchange_exchange_bindings': True, 'connection.blocked': True, 'authentication_failure_close': True, 'basic.nack': True, 'per_consumer_qos': True, 'consumer_priorities': True, 'consumer_cancel_notify': True, 'publisher_confirms': True}, 'cluster_name': 'rabbit@XXXXXXXX', 'platform': 'Erlang/OTP', 'version': '3.5.7'}, mechanisms: ['AMQPLAIN', 'PLAIN'], locales: [u'en_US']\r\n[2018-02-02 12:08:22,090: DEBUG/ForkPoolWorker-324] using channel_id: 1\r\n[2018-02-02 12:08:22,091: DEBUG/ForkPoolWorker-324] Channel open\r\n[2018-02-02 12:08:22,110: INFO/MainProcess] Received task: awx.main.tasks.run_job[35a87a6f-2cc4-428d-9cd7-11370ddb70ab]\r\n[2018-02-02 12:08:22,111: INFO/MainProcess] Scaling up 1 processes.\r\n[2018-02-02 12:08:22,115: INFO/ForkPoolWorker-324] Task awx.main.scheduler.tasks.run_job_launch[158c411f-6068-457c-96ab-135c3f844ffe] succeeded in 1.44872143492s: None\r\n[2018-02-02 12:08:22,234: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1e93c80> (args:('awx.main.tasks.run_job', '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', {'origin': 'gen579@awx', 'lang': 'py', 'task': 'awx.main.tasks.run_job', 'group': None, 'root_id': '158c411f-6068-457c-96ab-135c3f844ffe', u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': None, u'correlation_id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '[38]', 'eta': None, 'parent_id': '158c411f-6068-457c-96ab-135c3f844ffe', u'reply_to': 'a42c8b04-b3e5-382a-bd65-a5762728a982', 'id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', 'kwargsrepr': '{}'}, u'[[38], {}, {\"chord\": null, \"callbacks\": [{\"chord_size\": null, \"task\": \"awx.main.tasks.handle_work_success\", \"subtask_type\": null, \"kwargs\": {\"task_actual\": {\"type\": \"job\", \"id\": 38}}, \"args\": [], \"options\": {}, \"immutable\": false}], \"errbacks\": [{\"chord_size\": null, \"task\": \"awx.main.tasks.handle_work_error\", \"subtask_type\": null, \"kwargs\": {\"subtasks\": [{\"type\": \"job\", \"id\": 38}]},... kwargs:{})\r\n[2018-02-02 12:08:22,236: DEBUG/MainProcess] basic.qos: prefetch_count->1288\r\n[2018-02-02 12:08:22,238: DEBUG/ForkPoolWorker-326] Closed channel #1\r\n[2018-02-02 12:08:22,240: DEBUG/MainProcess] Task accepted: awx.main.tasks.run_job[35a87a6f-2cc4-428d-9cd7-11370ddb70ab] pid:579\r\n[2018-02-02 12:08:23,708: INFO/MainProcess] Received task: awx.main.tasks.update_inventory_computed_fields[ecba1b6a-5e98-4b82-a60a-9b28ba98c279]\r\n[2018-02-02 12:08:23,708: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1e93c80> (args:('awx.main.tasks.update_inventory_computed_fields', 'ecba1b6a-5e98-4b82-a60a-9b28ba98c279', {'origin': 'gen579@awx', 'lang': 'py', 'task': 'awx.main.tasks.update_inventory_computed_fields', 'group': None, 'root_id': '158c411f-6068-457c-96ab-135c3f844ffe', u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': None, u'correlation_id': 'ecba1b6a-5e98-4b82-a60a-9b28ba98c279', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '(2, True)', 'eta': None, 'parent_id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', u'reply_to': '6ac4aa64-0b39-39d4-a106-91a4a7c7780b', 'id': 'ecba1b6a-5e98-4b82-a60a-9b28ba98c279', 'kwargsrepr': '{}'}, u'[[2, true], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2018-02-02 12:08:23,716: DEBUG/MainProcess] Task accepted: awx.main.tasks.update_inventory_computed_fields[ecba1b6a-5e98-4b82-a60a-9b28ba98c279] pid:581\r\n2018-02-02 12:08:23,734 DEBUG    awx.main.tasks Executing error task id <Context: {'origin': 'gen579@awx', u'args': [38], u'chain': None, 'root_id': '158c411f-6068-457c-96ab-135c3f844ffe', 'expires': None, u'is_eager': False, u'correlation_id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', u'chord': None, u'reply_to': 'a42c8b04-b3e5-382a-bd65-a5762728a982', '_children': [<AsyncResult: ecba1b6a-5e98-4b82-a60a-9b28ba98c279>], 'id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', 'kwargsrepr': '{}', 'lang': 'py', 'retries': 0, 'task': 'awx.main.tasks.run_job', 'group': None, 'timelimit': [None, None], u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, u'hostname': u'celery@localhost', 'called_directly': False, 'parent_id': '158c411f-6068-457c-96ab-135c3f844ffe', 'argsrepr': '[38]', u'errbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_error', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'subtasks': [{u'type': u'job', u'id': 38}]}, u'options': {}}], u'callbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_success', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'task_actual': {u'type': u'job', u'id': 38}}, u'options': {}}], u'kwargs': {}, 'eta': None, '_protected': 1}>, subtasks: [{u'type': u'job', u'id': 38}]\r\n2018-02-02 12:08:23,734 DEBUG    awx.main.tasks Executing error task id <Context: {'origin': 'gen579@awx', u'args': [38], u'chain': None, 'root_id': '158c411f-6068-457c-96ab-135c3f844ffe', 'expires': None, u'is_eager': False, u'correlation_id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', u'chord': None, u'reply_to': 'a42c8b04-b3e5-382a-bd65-a5762728a982', '_children': [<AsyncResult: ecba1b6a-5e98-4b82-a60a-9b28ba98c279>], 'id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', 'kwargsrepr': '{}', 'lang': 'py', 'retries': 0, 'task': 'awx.main.tasks.run_job', 'group': None, 'timelimit': [None, None], u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, u'hostname': u'celery@localhost', 'called_directly': False, 'parent_id': '158c411f-6068-457c-96ab-135c3f844ffe', 'argsrepr': '[38]', u'errbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_error', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'subtasks': [{u'type': u'job', u'id': 38}]}, u'options': {}}], u'callbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_success', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'task_actual': {u'type': u'job', u'id': 38}}, u'options': {}}], u'kwargs': {}, 'eta': None, '_protected': 1}>, subtasks: [{u'type': u'job', u'id': 38}]\r\n[2018-02-02 12:08:23,734: DEBUG/ForkPoolWorker-324] Executing error task id <Context: {'origin': 'gen579@awx', u'args': [38], u'chain': None, 'root_id': '158c411f-6068-457c-96ab-135c3f844ffe', 'expires': None, u'is_eager': False, u'correlation_id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', u'chord': None, u'reply_to': 'a42c8b04-b3e5-382a-bd65-a5762728a982', '_children': [<AsyncResult: ecba1b6a-5e98-4b82-a60a-9b28ba98c279>], 'id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', 'kwargsrepr': '{}', 'lang': 'py', 'retries': 0, 'task': 'awx.main.tasks.run_job', 'group': None, 'timelimit': [None, None], u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, u'hostname': u'celery@localhost', 'called_directly': False, 'parent_id': '158c411f-6068-457c-96ab-135c3f844ffe', 'argsrepr': '[38]', u'errbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_error', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'subtasks': [{u'type': u'job', u'id': 38}]}, u'options': {}}], u'callbacks': [{u'chord_size': None, u'task': u'awx.main.tasks.handle_work_success', u'args': [], u'immutable': False, u'subtask_type': None, u'kwargs': {u'task_actual': {u'type': u'job', u'id': 38}}, u'options': {}}], u'kwargs': {}, 'eta': None, '_protected': 1}>, subtasks: [{u'type': u'job', u'id': 38}]\r\n2018-02-02 12:08:23,760 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\n[2018-02-02 12:08:23,760: DEBUG/ForkPoolWorker-326] Going to update inventory computed fields\r\n2018-02-02 12:08:23,837 DEBUG    awx.main.models.inventory Finished updating inventory computed fields\r\n[2018-02-02 12:08:23,837: DEBUG/ForkPoolWorker-326] Finished updating inventory computed fields\r\n[2018-02-02 12:08:23,844: INFO/ForkPoolWorker-326] Task awx.main.tasks.update_inventory_computed_fields[ecba1b6a-5e98-4b82-a60a-9b28ba98c279] succeeded in 0.132328880019s: None\r\n2018-02-02 12:08:23,961 WARNING  awx.main.tasks job 38 (error) encountered an error (rc=None), please see task stdout for details.\r\n2018-02-02 12:08:23,961 WARNING  awx.main.tasks job 38 (error) encountered an error (rc=None), please see task stdout for details.\r\n[2018-02-02 12:08:23,961: WARNING/ForkPoolWorker-324] job 38 (error) encountered an error (rc=None), please see task stdout for details.\r\n[2018-02-02 12:08:23,962: ERROR/ForkPoolWorker-324] Task awx.main.tasks.run_job[35a87a6f-2cc4-428d-9cd7-11370ddb70ab] raised unexpected: Exception('job 38 (error) encountered an error (rc=None), please see task stdout for details.',)\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 374, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 629, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 483, in _wrapped\r\n    return f(self, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 924, in run\r\n    raise AwxTaskError.TaskError(instance, rc)\r\nException: job 38 (error) encountered an error (rc=None), please see task stdout for details.\r\n[2018-02-02 12:08:23,963: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_job_complete[66beed69-6e2f-401a-adca-dfdc95da6a7f]\r\n[2018-02-02 12:08:23,963: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1e93c80> (args:('awx.main.scheduler.tasks.run_job_complete', '66beed69-6e2f-401a-adca-dfdc95da6a7f', {'origin': 'gen579@awx', 'lang': 'py', 'task': 'awx.main.scheduler.tasks.run_job_complete', 'group': None, 'root_id': '158c411f-6068-457c-96ab-135c3f844ffe', u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'tower_scheduler.job.complete', u'exchange': u'scheduler'}, 'expires': None, u'correlation_id': '66beed69-6e2f-401a-adca-dfdc95da6a7f', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '(38,)', 'eta': None, 'parent_id': '35a87a6f-2cc4-428d-9cd7-11370ddb70ab', u'reply_to': '6ac4aa64-0b39-39d4-a106-91a4a7c7780b', 'id': '66beed69-6e2f-401a-adca-dfdc95da6a7f', 'kwargsrepr': '{}'}, u'[[38], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2018-02-02 12:08:23,965: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_job_complete[66beed69-6e2f-401a-adca-dfdc95da6a7f] pid:581\r\n```"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI (?)\r\n\r\n##### SUMMARY\r\n\r\nRequest for additional survey validation options:\r\n[ ] alphanum on text types\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nFairly sure 'password strength' validation is not something we would consider for surveys.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - Notifications\r\n\r\n##### SUMMARY\r\nI cannot get slack notifications to send from AWX currently. After entering a correct slack configuration and trying the test notification AWX reports that it is successful, however no message arrives in slack. In the logs I can see the job being sent to the task worker, and the job, but it seems to only open the websocket, and never post the message.\r\n```\r\ntask_1       | [2018-02-01 13:47:48,505: DEBUG/MainProcess] Task accepted: awx.main.tasks.send_notifications[0af135fd-c497-4660-8dd0-6c0dff37bd6c] pid:166\r\ntask_1       | [2018-02-01 13:47:48,537: DEBUG/ForkPoolWorker-24] Starting new HTTPS connection (1): slack.com\r\ntask_1       | [2018-02-01 13:47:49,010: DEBUG/ForkPoolWorker-24] https://slack.com:443 \"POST /api/rtm.start HTTP/1.1\" 200 30868\r\ntask_1       | [2018-02-01 13:47:50,459: INFO/ForkPoolWorker-24] Task awx.main.tasks.send_notifications[0af135fd-c497-4660-8dd0-6c0dff37bd6c] succeeded in 1.955134352s: None\r\n```\r\nI would assume that after opening this socket it would actually need to post the message to it.\r\n\r\nI have tested that the containers have connectivity by curl-ing a simple message to slack, which is received.\r\n\r\n##### ENVIRONMENT\r\nFails in both our production environment (docker on linux with an nginx reverse proxy in front)and on a localhost setup (docker on mac, no proxy)\r\n\r\n* AWX version: 1.0.2.75\r\n* AWX install method: , docker on linux, docker for mac\r\n* Ansible version:  2.4.2.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure slack notifications with a working bot token, and a public channel, press the test notification button. \r\n##### EXPECTED RESULTS\r\n\r\nA green 'Notification sent' message will be shown and a message is posted to the configured slack channel\r\n\r\n##### ACTUAL RESULTS\r\n\r\nA green 'Notification sent' message will be shown but no message is posted to slack\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nJust updated my awx environment using docker-compose. Since then it is showing this error when openeing the schema's page.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.92\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0 \r\n* Operating System: CentOS 7 server, ubuntu 17.10 Desktop\r\n* Web Browser: Firefox / Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLog in to AWX and click Schedules\r\n\r\n##### EXPECTED RESULTS\r\n\r\nShow schedules\r\n\r\n##### ACTUAL RESULTS\r\n\r\nInvalid search term entered. GET returned: 500 A server error has occurred.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nawx_task log:\r\n\r\n```\r\n192.168.127.28 - - [01/Feb/2018:12:05:20 +0000] \"GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync HTTP/1.1\" 200 41347 \"http://awx.int.previder.nl/\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:58.0) Gecko/20100101 Firefox/58.0\" \"-\"\r\n[pid: 29|app: 0|req: 41/159] 192.168.127.28 () {46 vars in 2273 bytes} [Thu Feb  1 12:05:19 2018] GET /api/v2/unified_jobs/?page_size=20&order_by=-finished&not__launch_type=sync => generated 41347 bytes in 436 msecs (HTTP/1.1 200) 9 headers in 251 bytes (1 switches on core 0)\r\n2018-02-01 12:05:20,371 ERROR    django.request Internal Server Error: /api/v2/schedules/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 253, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 45, in list\r\n    return self.get_paginated_response(serializer.data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 738, in data\r\n    ret = super(ListSerializer, self).data\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 262, in data\r\n    self._data = self.to_representation(self.instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 656, in to_representation\r\n    self.child.to_representation(item) for item in iterable\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 3103, in to_representation\r\n    ret = super(LaunchConfigurationBaseSerializer, self).to_representation(obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 500, in to_representation\r\n    ret[field.field_name] = field.to_representation(attribute)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 1816, in to_representation\r\n    return method(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 299, in _get_related\r\n    return {} if obj is None else self.get_related(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 3949, in get_related\r\n    if obj.unified_job_template.project:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/polymorphic/models.py\", line 159, in accessor_function\r\n    attr = model.base_objects.get(pk=self.pk)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\", line 85, in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 380, in get\r\n    self.model._meta.object_name\r\nDoesNotExist: Project matching query does not exist.\r\n2018-02-01 12:05:20,371 ERROR    django.request Internal Server Error: /api/v2/schedules/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 253, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 45, in list\r\n    return self.get_paginated_response(serializer.data)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 738, in data\r\n    ret = super(ListSerializer, self).data\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 262, in data\r\n    self._data = self.to_representation(self.instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 656, in to_representation\r\n    self.child.to_representation(item) for item in iterable\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 3103, in to_representation\r\n    ret = super(LaunchConfigurationBaseSerializer, self).to_representation(obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/serializers.py\", line 500, in to_representation\r\n    ret[field.field_name] = field.to_representation(attribute)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/fields.py\", line 1816, in to_representation\r\n    return method(value)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 299, in _get_related\r\n    return {} if obj is None else self.get_related(obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/serializers.py\", line 3949, in get_related\r\n    if obj.unified_job_template.project:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/polymorphic/models.py\", line 159, in accessor_function\r\n    attr = model.base_objects.get(pk=self.pk)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\", line 85, in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 380, in get\r\n    self.model._meta.object_name\r\nDoesNotExist: Project matching query does not exist.\r\n[pid: 26|app: 0|req: 30/160] 192.168.127.28 () {46 vars in 2343 bytes} [Thu Feb  1 12:05:20 2018] GET /api/v2/schedules/?page_size=20&order_by=unified_job_template__polymorphic_ctype__model&next_run__isnull=false => generated 41 bytes in 57 msecs (HTTP/1.1 500) 6 headers in 203 bytes (1 switches on core 0)\r\n192.168.127.28 - - [01/Feb/2018:12:05:20 +0000] \"GET /api/v2/schedules/?page_size=20&order_by=unified_job_template__polymorphic_ctype__model&next_run__isnull=false HTTP/1.1\" 500 41 \"http://awx.int.previder.nl/\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:58.0) Gecko/20100101 Firefox/58.0\" \"-\"\r\n192.168.127.28 - - [01/Feb/2018:12:05:20 +0000] \"OPTIONS /api/v2/unified_jobs/ HTTP/1.1\" 200 9802 \"http://awx.int.previder.nl/\" \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:58.0) Gecko/20100101 Firefox/58.0\" \"-\"\r\n[pid: 25|app: 0|req: 59/161] 192.168.127.28 () {50 vars in 2264 bytes} [Thu Feb  1 12:05:20 2018] OPTIONS /api/v2/unified_jobs/ => generated 9802 bytes in 72 msecs (HTTP/1.1 200) 9 headers in 250 bytes (1 switches on core 0)\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nAdd the option \"Prompt on launch\" in the custom credentials configuration to ask the user for the password at launch time."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nansible_host variable value has targeted host IP even delegating to localhost at Ansible command line execution BUT at AWX execution, ansible_host variable value changes to localhost.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.337\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2\r\n* Operating System: CentOS 7.4 (for AWX), Windows (for browser)\r\n* Web Browser: Firefox Quantum\r\n\r\n##### STEPS TO REPRODUCE\r\nRun this playbook at both, CentOS7 with Ansible installed (AWX host) and inside AWX as JobTemplate.\r\n\r\nhosts example\r\n`target04 ansible_host=10.70.10.104 ansible_user=root`\r\n\r\nsite.yml \r\n```yaml\r\n---\r\n  - name: Test\r\n    hosts: all\r\n    gather_facts: yes\r\n    become: yes\r\n    tasks:\r\n      - name: Debug ansible_host locally\r\n        local_action: debug var=ansible_host\r\n\r\n      - name: Debug ansible_host remotely\r\n        debug: var=ansible_host\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nansible_host variable contents should be target host's IP (10.70.10.104) at both Ansible (command line and AWX) execution results even delegating to localhost.\r\n\r\n##### ACTUAL RESULTS\r\nWhen the task is delegated to the localhost, ansible_host variable value changes to \"localhost\" at AWX execution but it remains with targeted host IP (10.70.10.104) at command line execution.\r\n\r\n**Command line execution LOG:**\r\n```\r\n[root@awxawx01 test]# ansible-playbook -i ./hosts ./site.yml --ask-pass\r\nSSH password:\r\n\r\nPLAY [Test] ********************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\nok: [target04]\r\n\r\nTASK [Debug ansible_host locally] **********************************************\r\nok: [target04 -> localhost] => {\r\n    \"ansible_host\": \"10.70.10.104\"   <--- HERE (expected value)\r\n}\r\n\r\nTASK [Debug ansible_host remotely] *********************************************\r\nok: [target04] => {\r\n    \"ansible_host\": \"10.70.10.104\"\r\n}\r\n\r\nPLAY RECAP *********************************************************************\r\ntarget04                   : ok=3    changed=0    unreachable=0    failed=0\r\n\r\n[root@awxawx01 test]#\r\n```\r\n\r\n**AWX execution LOG:**\r\n```\r\nSSH password: \r\nPLAY [Test] ********************************************************************\r\n\r\nTASK [Gathering Facts] *********************************************************\r\n\r\nok: [10.70.10.100]\r\nTASK [Debug ansible_host locally] **********************************************\r\n\r\nok: [10.70.10.100 -> localhost] => {\r\n    \"ansible_host\": \"localhost\"   <--- HERE (unexpected value)\r\n}\r\nTASK [Debug ansible_host remotely] *********************************************\r\n\r\nok: [10.70.10.100] => {\r\n    \"ansible_host\": \"10.70.10.100\"\r\n}\r\nPLAY RECAP *********************************************************************\r\n\r\n10.70.10.100               : ok=3    changed=0    unreachable=0    failed=0   \r\n```\r\n\r\nIs it something wrong with ansible_host behaviour in AWX or is it the expected behaviour?\r\nIn case it is an expected behaviour at AWX, is there any other variable that we could use to pull target host IP to emulate command line execution results?\r\n\r\n##### ADDITIONAL INFORMATION\r\nThank you."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nwhen executing new or existing jobs from templates or workflows the first job fails at when updating the SCM\r\n\r\n##### ENVIRONMENT\r\n* AWX version:1.0.2.82\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.4.2\r\n* Operating System: Server Side: Centos 7, Client side MacOS 10.13.2\r\n* Web Browser: Safari 11.0.2, Chrome: 63.0.3239.132\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create template from project (or use existing)\r\n2. run template\r\n3. During SCM checkout/update phase job fails\r\n\r\nNot: a manual project update triggered from the project page succeeds.  is only failing when performed as part of the job.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1. Create job template\r\n2. run template\r\n3. SCM updates\r\n4. Job runs to completion.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nFails at SCM update stage on any job, appears to be when processing requirement.yml stage\r\n\r\n##### ADDITIONAL INFORMATION\r\n![2018-01-31_08-00-12](https://user-images.githubusercontent.com/4160293/35598185-c66736d6-065c-11e8-9091-c77fab0e493c.png)\r\n![2018-01-31_08-00-39](https://user-images.githubusercontent.com/4160293/35598191-d7fbb61a-065c-11e8-813d-de5370f57a87.png)\r\n\r\n\r\njsconsole output:\r\n\r\n(chrome)\r\n```\r\nvendor.043bddee0a3393997c11.js:29 [Deprecation] Synchronous XMLHttpRequest on the main thread is deprecated because of its detrimental effects to the end user's experience. For more help, check https://xhr.spec.whatwg.org/.\r\nsend @ vendor.043bddee0a3393997c11.js:29\r\n/#/login:1 This page includes a password or credit card input in a non-secure context. A warning has been added to the URL bar. For more information, see https://goo.gl/zmWq3m.\r\n/api/v2/project_updates/191/stdout/?format=json&start_line=18&end_line=518 Failed to load resource: the server responded with a status of 500 (Internal Server Error)\r\n\r\n```\r\n\r\n(Safari)\r\n```\r\n[Error] Failed to load resource: the server responded with a status of 500 (Internal Server Error) (stdout, line 0)\r\n[Error] [$controller:ctrlreg] The controller with the name 'TemplatesListController' is not registered.\r\nhttp://errors.angularjs.org/1.6.8/$controller/ctrlreg?p0=TemplatesListController\r\nhttp://nms-ans01/static/js/vendor.043bddee0a3393997c11.js:570 – \"<div ui-view=\\\"related\\\" class=\\\"ng-scope\\\">\"\r\n\t(anonymous function) (vendor.043bddee0a3393997c11.js:570:93569)\r\n\tinvokeLinkFn (vendor.043bddee0a3393997c11.js:570:82212)\r\n\tnodeLinkFn (vendor.043bddee0a3393997c11.js:570:64025)\r\n\tcompositeLinkFn (vendor.043bddee0a3393997c11.js:570:52835)\r\n\t(anonymous function) (vendor.043bddee0a3393997c11.js:570:51496)\r\n\tupdateView (vendor.043bddee0a3393997c11.js:603:28839)\r\n\tconfigUpdatedCallback (vendor.043bddee0a3393997c11.js:603:28009)\r\n\tconfigureUIView (vendor.043bddee0a3393997c11.js:443:48314)\r\n\tforEach\r\n\tsync (vendor.043bddee0a3393997c11.js:443:48705)\r\n\tactivateViews (vendor.043bddee0a3393997c11.js:603:37906)\r\n\tinvokeHook (vendor.043bddee0a3393997c11.js:37:576873)\r\n\tforEach\r\n\trunAllHooks (vendor.043bddee0a3393997c11.js:37:576084)\r\n\ttransitionSuccess (vendor.043bddee0a3393997c11.js:53:13081)\r\n\tprocessQueue (vendor.043bddee0a3393997c11.js:570:134253)\r\n\t(anonymous function) (vendor.043bddee0a3393997c11.js:570:135212)\r\n\t$digest (vendor.043bddee0a3393997c11.js:570:146078)\r\n\t$apply (vendor.043bddee0a3393997c11.js:570:148862)\r\n\tdone (vendor.043bddee0a3393997c11.js:570:101129)\r\n\tcompleteRequest (vendor.043bddee0a3393997c11.js:570:106031)\r\n\tonload (vendor.043bddee0a3393997c11.js:570:106797)\r\n[Error] Failed to load resource: the server responded with a status of 500 (Internal Server Error) (stdout, line 0)\r\n\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\nAPI\r\n\r\n##### SUMMARY\r\nClient would like all users in an Org to be able to see Teams and grant them permissions on Job Templates that they are admins on.\r\n"},{"labels":["api",null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nawx allows you to ship logs to external systems via UDP - this feature primarily exists to support logstash via UDP.  As such, UDP messages shipped from awx are in the JSON format that logstash expects.  It would be nice if you could ship syslog-formatted messages over UDP or TCP.\r\n\r\nrelated: https://github.com/ansible/awx/issues/1062"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n ##### SUMMARY\r\n<!-- Gui error ERROR\r\nFailed to read /api. GET status: 500 A server error has occurred. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Latest\r\n* AWX install method: Github\r\n* Ansible version: 2.4.2.0\r\n* CentOS Linux release 7.4.1708 (Core) :\r\n* Chrome:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- On Browser GUI interface gives Error Failed to read /api. GET status: 500 A server error has occurred. -->\r\n##### EXPECTED RESULTS\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!--\r\nOn Login page of AWX Tower, it gives error\r\nError  Failed to read /api. GET status: 500 A server error has occurred. -->\r\n\r\nUsed this blog for installation of AWX Tower\r\nhttp://khmel.org/?p=1245\r\nUsed this link for debugging the project issue. \r\n\r\nhttps://github.com/ansible/awx/issues/857\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Feature Idea\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n- Installer\r\n- API\r\n\r\n##### SUMMARY\r\n\r\nThe enhancement request is to separate the database \"schema owner\" required for installation, upgrades and restores, from the tower database \"operational user\" which is required for normal operations.\r\nEg.   The DB user which creates (and more importantly perhaps) can drop tables should not be the operational database user which the AWX / Tower process uses to connect for day-to-day running of Tower.\r\n\r\nThe operational database user should be able to insert, query, (if required by the application) update rows in the AWX / Tower database.   It ideally should not be able to delete database, delete tables, create users etc.\r\n\r\nWhat is being requested is a least privileged model for database users, separating the privileged user which creates the database from the operational user which uses it."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nLogin page of AWX contain \"SIGN IN WITH\" (Azure AD, Google, Github, Github teams and Github org) after fresh installation.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2 and 1.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  \r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Not relevant, but tested on Chrome and Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nInstall awx and check the login page\r\n\r\n##### EXPECTED RESULTS\r\nLogin page should not contain \"SIGN IN WITH\" icons (unless external authentication providers are enabled)\r\n\r\n##### ACTUAL RESULTS\r\nLogin page of AWX contain \"SIGN IN WITH\" Azure AD, Google, Github, Github teams and Github org.\r\n![screenshot from 2018-01-26 14-28-45](https://user-images.githubusercontent.com/8266857/35503875-4cdea8f0-04d9-11e8-9245-44e4cfe806ba.png)\r\n\r\n##### ADDITIONAL INFORMATION\r\nI have tested few dockerhub_versions and the last version that is working as expected is 1.0.1.167. The issue is occurring since version 1.0.1.203 (maybe even version 1.0.1.176, I having issues running this version).\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nSCM Update options have ability to select what to do during update. But for projects with requirements.yml files these options ignored because ansible-galaxy runs with --force key.\r\n\r\nhttps://github.com/ansible/awx/blob/1.0.2/awx/playbooks/project_update.yml#L142\r\n\r\n<img width=\"200\" alt=\"image\" src=\"https://user-images.githubusercontent.com/3703483/35499448-666ff3b4-04e3-11e8-8e7e-f654c76d5e6b.png\">\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.3.1\r\n* Operating System: RHEL 7\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n1. Configure project with requirements.yml file\r\n2. Start Job Template based on project.\r\n3. Roles uploaded every time.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nRoles from requirement.yml uploaded only once.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nRoles from requirement.yml  uploaded every time.\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAdd support in AWX for a single write-only database instance and read from one of a number of replicated read-only database instances.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis change would allow connection of a Tower instance to any one of a number of database instances distributed for performance or reliability.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen I have configured Tower/AWX logging to use \"udp/514\" for syslog logging, logging works but the \"test\" button produces a red \"toast\" message on the GUI reporting \"HTTPConnectionPool(host='syslog.net.west.com', port=514): Read timed out. (read timeout=5)\" \r\n\r\n##### ENVIRONMENT\r\n* Tower version: 3.2.2\r\n* Tower install method: setup.sh\r\n* Ansible version:  2.4.2\r\n* Operating System: RedHat 7.4\r\n* Web Browser: Chrome, Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWe have the following setup in the \"Logging\" configuration category:\r\nAggregator: syslog.server.hostname.com\r\nPort: 514\r\nType: other\r\nLoggers: awx, activity_stream, job_events, system_tracking\r\nProtocol: udp\r\nThreshold: Info\r\nUsername: blank (not needed for syslog)\r\nEnable external logging: On\r\nTracking facts individually: Off\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpect a \"test\" message in syslog and NO error message on the GUI.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThere is no \"test\" message in the syslog output, and an error message is displayed in the GUI.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIt appears that the Test button is expecting to interact with the other logging interfaces and require a TCP HTTP connection, not the simplistic UDP Syslog message.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt would be useful to be able to have Named URLs so that roles can be granted via automation more easily.  For example,\r\n\r\n`/api/v2/teams/MyTeam++MyOrg/roles/Admin`\r\n\r\nWhere you could post an id to that role to assign someone as admin.\r\n\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nI am trying build the docker image from the source. I have used the below commands to build and start the containers successfully for awx .\r\n\r\nmake docker-compose-build\r\nmake docker-compose\r\n\r\nOne difference I found while building the AWX like this it is only starting one container \"tools_awx_1\" where as if you use the installer it has two images awx_task and awx_web. Can you please let me know how can I built these two images from source. I haven't find any references for awx_task and awx_web in the Makefile. Please help. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\nSCM update fails from inventory update process\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n \r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nConfigured a project to retrieve configurations from a GIT repository. The project is able to sync properly with the GIT repository.\r\nAfter that an inventory has been configured to retrieve a list of hosts from the GIT repository. Within inventory the option \"Source from project\" has been selected and the apropriate hosts file in the GIT folder.\r\nAll seems to be configured properly. After that did a sync to retrieve the hostnames. That sync fails\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.75\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.2.0\r\n* Operating System: Ubuntu 16.04 Xenial\r\n* Web Browser: Chrome, Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Clean install of the latest AWX version (no database migration from previous versions)\r\n- Follow the steps from the summary above\r\n\r\n##### EXPECTED RESULTS\r\n\r\n- Sync should import hosts from the GIT hosts file properly\r\n\r\n##### ACTUAL RESULTS\r\n\r\n- Sync fails with a random ID code (stdout file is empty, mail notification provides more information - see results below)\r\n- Error message: SCM Update failed for <GIT source> with ID <random number>.\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nInventory Update #52 had status failed, view details at http://x.x.x.x/#/inventory_sync/52\r\n{\r\n    \"status\": \"failed\", \r\n    \"name\": \"Inventory - Source from project\", \r\n    \"started\": \"2018-01-25T13:27:18.123421+00:00\", \r\n    \"traceback\": \"Traceback (most recent call last):\\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/tasks.py\\\", line 770, in run\\n    self.pre_run_hook(instance, **kwargs)\\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/tasks.py\\\", line 1934, in pre_run_hook\\n    task_instance.run(local_project_sync.id)\\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/tasks.py\\\", line 483, in _wrapped\\n    return f(self, *args, **kwargs)\\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/tasks.py\\\", line 905, in run\\n    raise AwxTaskError.TaskError(instance, rc)\\nException: project_update 53 (failed) encountered an error (rc=2), please see task stdout for details.\\n\", \r\n    \"friendly_name\": \"Inventory Update\", \r\n    \"created_by\": \"admin\", \r\n    \"url\": \"http://x.x.x.x/#/inventory_sync/52\", \r\n    \"finished\": \"2018-01-25T13:27:24.466897+00:00\", \r\n    \"id\": 52\r\n}\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nIt would be great if in survey editor if we could choose a boolean formular.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.285\r\n* AWX install method: docker on linux, \r\n* Ansible version:  2.4.2.0\r\n* Operating System: Linux\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn job_template > edit_survey > answer_type \r\nadding a boolean type.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n \r\n##### SUMMARY\r\nWe have an internal Auth/Autz system which is being used by all our apps for authentication and authorization purpose.  This is kind of centralized system where we manage the user's permissions for a specific application. Our authorization stuff is exposed as a REST API. So wondering if we can integrate our access management system with AWX in any way instead of making the changes to the existing codebase.   Like creating separate plugins for Authentication and Authorization may be? Please help.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nWhen we run a job template though the isolated node with the following variable on inventory level `ansible_connection: '{{ {\"W\": \"winrm\", \"L\": \"ssh\"}[(inventory_hostname[1] | upper)] | default(\"ssh\") }}'`, Tower shows in the job output the following error (see job_250.txt).\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.0\r\n* Ansible version:  2.4.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create basic job template\r\n2. Set the following variable  on inventory level:\r\n`ansible_connection: '{{ {\"W\": \"winrm\", \"L\": \"ssh\"}[(inventory_hostname[1] | upper)] | default(\"ssh\") }}'`\r\n3. Launch the job template through an isolated node.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThese are the tests performed with isolated nodes :\r\n- When we set them on the job template only, they work just fine. \r\n- When we set them on the inventory only, I get the error.\r\n- When we set them on the inventory and the job template, I get the error.\r\n\r\nAdditionally, If we run the same job template to the target node without isolated node, the job template works fine.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAttached\r\n[job_250.txt](https://github.com/ansible/awx/files/1660714/job_250.txt)\r\n the full error.( job_250.txt)"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Enhancement\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently we only surface errors when sending slack notification if a Python exception occurs.\r\nWe could do better if we read the event stream after our `rtm_send_message` call to see if there\r\nwere any error events waiting.\r\n\r\nA common error is when the bot has not been invited to a channel that we are attempting to send the notification to. This can be caught in the message stream, but does not throw an exception.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhttps://github.com/ansible/awx/blob/devel/awx/main/notifications/slack_backend.py#L49\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAPI call on job stdout results on error 500 when there is an unicode caracter\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.372\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: Centos 7\r\n* Web Browser: any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate a playbook : \r\n```\r\n---\r\n- hosts: all\r\n  gather_facts: false\r\n  tasks:\r\n    - name: unicode ☠☠☠☠☠☠☠☠☠☠☠☠☠\r\n      debug: msg=\"☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠\"\r\n```\r\nlaunch it from awx\r\n\r\nGet the output from the api : \r\n$AWX_HOST/api/v2/jobs/$JOB_ID/stdout/?content_format=ansi&start_line=0&content_encoding=base64&format=json\r\n\r\n##### EXPECTED RESULTS\r\n\r\n`\"<div class=\\\"nocode ansi_fore ansi_back\\\"><style type=\\\"text/css\\\">\\n.ansi_fore { color: #000000; }\\n.ansi_back { background-color: #F5F5F5; }\\n.ansi_fore.ansi_dark { color: #AAAAAA; }\\n.ansi_back.ansi_dark { background-color: #000000; }\\n.ansi1 { font-weight: bold; }\\n.ansi3 { font-weight: italic; }\\n.ansi4 { text-decoration: underline; }\\n.ansi9 { text-decoration: line-through; }\\n.ansi30 { color: #161b1f; }\\n.ansi31 { color: #d9534f; }\\n.ansi32 { color: #5cb85c; }\\n.ansi33 { color: #f0ad4e; }\\n.ansi34 { color: #337ab7; }\\n.ansi35 { color: #e1539e; }\\n.ansi36 { color: #2dbaba; }\\n.ansi37 { color: #ffffff; }\\n.ansi40 { background-color: #161b1f; }\\n.ansi41 { background-color: #d9534f; }\\n.ansi42 { background-color: #5cb85c; }\\n.ansi43 { background-color: #f0ad4e; }\\n.ansi44 { background-color: #337ab7; }\\n.ansi45 { background-color: #e1539e; }\\n.ansi46 { background-color: #2dbaba; }\\n.ansi47 { background-color: #ffffff; }\\nbody.ansi_back pre {\\n  font-family: Monaco, Menlo, Consolas, \\\"Courier New\\\", monospace;\\n  font-size: 12px;\\n}\\ndiv.ansi_back.ansi_dark {\\n  padding: 0 8px;\\n  -webkit-border-radius: 3px;\\n  -moz-border-radius: 3px;\\n  border-radius: 3px;\\n}\\n</style><span class=\\\"ansi34\\\">ansible-playbook 2.4.2.0</span>\\n<span class=\\\"ansi34\\\">  config file = /etc/ansible/ansible.cfg</span>\\n<span class=\\\"ansi34\\\">  configured module search path = [u'/usr/lib/python2.7/site-packages/awx/plugins/library']</span>\\n<span class=\\\"ansi34\\\">  ansible python module location = /usr/lib/python2.7/site-packages/ansible</span>\\n<span class=\\\"ansi34\\\">  executable location = /usr/bin/ansible-playbook</span>\\n<span class=\\\"ansi34\\\">  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]</span>\\n<span class=\\\"ansi34\\\">Using /etc/ansible/ansible.cfg as config file</span>\\nSSH password: \\n\\nPLAYBOOK: test_unicode.yml *****************************************************\\n<span class=\\\"ansi34\\\">1 plays in test_unicode.yml</span>\\n\\nPLAY [all] *********************************************************************\\n<span class=\\\"ansi34\\\">META: ran handlers</span>\\n\\nTASK [unicode ☠☠☠☠☠☠☠☠☠☠☠☠☠] ***************************************************\\n<span class=\\\"ansi1 ansi30\\\">task path: /var/lib/awx/projects/_10__itg_tlf/test_unicode.yml:5</span>\\n<span class=\\\"ansi32\\\">ok: [itgtlf-batch01n.prppai27.cvf] =&gt; {</span>\\n<span class=\\\"ansi32\\\">    \\\"msg\\\": \\\"☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠☠\\\"</span>\\n<span class=\\\"ansi32\\\">}</span>\\n<span class=\\\"ansi31\\\">ERROR! Attempting to decrypt but no vault secrets found</span>\\n\\n</div>\"`\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`{\"detail\":\"A server error has occurred.\"}`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhere is the trace in awx_web : \r\n\r\n```\r\n X.X.X.X - - [23/Jan/2018:16:39:57 +0000] \"GET /api/v2/jobs/639/stdout/?content_format=ansi&start_line=0&content_encoding=base64&format=json HTTP/1.1\" 500 41 \"-\" \"curl/7.57.0\" \"-\"\r\n 2018-01-23 16:39:57,268 ERROR    django.request Internal Server Error: /api/v2/jobs/639/stdout/\r\n Traceback (most recent call last):\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n     response = get_response(request)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n     response = self._get_response(request)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n     response = self.process_exception_by_middleware(e, request)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n     response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n     return func(*args, **kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n     return view_func(*args, **kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n     return self.dispatch(request, *args, **kwargs)\r\n   File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 253, in dispatch\r\n     return super(APIView, self).dispatch(request, *args, **kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n     response = self.handle_exception(exc)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n     self.raise_uncaught_exception(exc)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n     response = handler(request, *args, **kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 210, in get\r\n     return self.retrieve(request, *args, **kwargs)\r\n   File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 4603, in retrieve\r\n     return Response({'range': {'start': start, 'end': end, 'absolute_end': absolute_end}, 'content': b64encode(content)})\r\n   File \"/usr/lib64/python2.7/base64.py\", line 53, in b64encode\r\n     encoded = binascii.b2a_base64(s)[:-1]\r\n UnicodeEncodeError: 'ascii' codec can't encode characters in position 768-780: ordinal not in range(128)\r\n 2018-01-23 16:39:57,268 ERROR    django.request Internal Server Error: /api/v2/jobs/639/stdout/\r\n Traceback (most recent call last):\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n     response = get_response(request)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n     response = self._get_response(request)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n     response = self.process_exception_by_middleware(e, request)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n     response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n     return func(*args, **kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n     return view_func(*args, **kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n     return self.dispatch(request, *args, **kwargs)\r\n   File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 253, in dispatch\r\n     return super(APIView, self).dispatch(request, *args, **kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n     response = self.handle_exception(exc)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n     self.raise_uncaught_exception(exc)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n     response = handler(request, *args, **kwargs)\r\n   File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 210, in get\r\n     return self.retrieve(request, *args, **kwargs)\r\n   File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 4603, in retrieve\r\n     return Response({'range': {'start': start, 'end': end, 'absolute_end': absolute_end}, 'content': b64encode(content)})\r\n   File \"/usr/lib64/python2.7/base64.py\", line 53, in b64encode\r\n     encoded = binascii.b2a_base64(s)[:-1]\r\n UnicodeEncodeError: 'ascii' codec can't encode characters in position 768-780: ordinal not in range(128)\r\n [pid: 415|app: 0|req: 506/12435] X.X.X.X () {34 vars in 605 bytes} [Tue Jan 23 16:39:57 2018] GET /api/v2/jobs/639/stdout/?content_format=ansi&start_line=0&content_encoding=base64&format=json => generated 41 bytes in 71 msecs (HTTP/1.1 500) 5 headers in 177 bytes (1 switches on core 0)\r\n\r\n```\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n \r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAfter the default Docker install when accessing login page an [error](https://www.awesomescreenshot.com/image/3119432/32c83ae8bf78cd232633599654fde098) is thrown.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: latest\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: Ubuntu\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nAfter running `ansible-playbook -i inventory install.yml` and a couple of [this](https://github.com/ansible/awx/issues/689) errors in the taks logs:\r\n```python\r\n    return getattr(self._sock,name)(*args)\r\nerror: [Errno 104] Connection reset by peer\r\n```\r\nI try to login and get the following message in the UI:\r\n```\r\nFailed to read /api. GET status: 502\r\n```\r\nThe Web server logs show:\r\n```python\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/wsgi.py\", line 157, in __call__\r\n    response = self.get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 124, in get_response\r\n    response = self._middleware_chain(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 43, in inner\r\n    response = response_for_exception(request, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 53, in response_for_exception\r\n    response = get_exception_response(request, get_resolver(get_urlconf()), 404, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 119, in get_exception_response\r\n    response = handle_uncaught_exception(request, resolver, sys.exc_info())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 143, in handle_uncaught_exception\r\n    return callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 88, in handle_500\r\n    return handle_error(request, 500, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 40, in render\r\n    output = self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 166, in render\r\n    values = self.sequence.resolve(context, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 736, in resolve\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 244, in items\r\n    return value.items()\r\n```\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen setting up job template callbacks, I'm tightly coupling the curl command with the primary key of the job template I want to run. This is annoying because ideally I'd want to re-create the AWX database from scratch without anything breaking.\r\n\r\nIt would be nice if I could optionally specify a \"slug\" for a job template, which could then be used in place of the PK in the callback URL. For example:\r\n\r\n    curl --data \"host_config_key=...\" https://awx.example.local/api/v2/job_templates/my-template/callback/"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n - API\r\n\r\n##### SUMMARY\r\nWhen logging into AWX with SAML configured the final redirect appears to be to an incorrect port that is of the container and not the web interface.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.370\r\n* AWX install method: official image\r\n* Ansible version:  2.4.1\r\n* Operating System: Centos 7.6\r\n* Web Browser: Chrome/Safari\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure AWX with a SAML Identity Provider. The SAML portion of the authentication appears to work up to the point where a redirect occurs to an incorrect port and protocol (that appears to be the port and protocol on the docker container) and not that which the web/API is hosted from.\r\n\r\nIt appears this may be a regression from the transition from social-app-django to social-auth-core and social-auth-app-django.\r\n\r\nThere has been some activity here that seems related: https://github.com/ansible/awx/issues/119 but it looks like there have been changes in the authentication back-end since it was closed and the issue covers multiple challenges.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nRedirected to the URL that includes the hostname and port of the web/API logged in.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAn error after successfully logging into the IDp.\r\n\r\n> Authentication failed: SAML login failed: ['invalid_response'] (The response was received at **http**://awx.test.com:**8052**/sso/complete/saml/ instead of https://awx.test.com/sso/complete/saml/)."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen asking for AWX sending notifications to mattermost on template execution, it doesn't send anything to it. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.337\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: RHEL7.4 (host), Windows 7 (client)\r\n* Web Browser: Google Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nSetup a new Mattermost Notification, add it to a project and a template, then run the template.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nTwo notifications should have been sent to Mattermost.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nMattermost only received a notification on SCM update (so I guess it is the one sent at Project level), and no notification on job ending (which is according to me corresponding to the template)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nAdd a field to a job template that would allow a user to start a playbook at the task specified. This would be analogous to the '--start-at-task' option from the ansible-playbook command.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBe able to select in a job template the task of the playbook that you want to launch without having to use tags.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen you have a dictionary defined in your project which has keys that are integers, AWX imports them as strings when using a project as the inventory source.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2-350-gae06cff\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: CentOS 7.4.1708\r\n* Web Browser: Chrome 63.0.3239.132 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a project in source control containing a dictionary like the following in host_vars/group_vars\r\n    ```yaml\r\n    loader1_var:\r\n      subvar1:\r\n        1:\r\n          - foo\r\n        2:\r\n          - bar\r\n    ```\r\n2. Add the project in AWX and sync\r\n3. Create an inventory that uses this project as a source and sync\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nDictionary is imported as laid out in the source file with the keys as integers:\r\n\r\n```yaml\r\nloader1_var:\r\n  subvar1:\r\n    1:\r\n      - foo\r\n    2:\r\n      - bar\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\nDictionary is imported with the keys converted to strings:\r\n\r\n```yaml\r\nloader1_var:\r\n  subvar1:\r\n    '1':\r\n      - foo\r\n    '2':\r\n      - bar\r\n```\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Bug Report (I think?)\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n1) Create a Job Template without any extra vars or survey\r\n2) POST to `/api/v2/job_templates/:id/schedules` and include something in `extra_data` like so:\r\n\r\n```\r\n{\r\n    ...\r\n    extra_data: {\r\n        foo: \"bar\"\r\n    }\r\n}\r\n```\r\n\r\nThe api will respond with a 400 error in this case, saying:\r\n\r\n`{extra_data: [\"Variables foo are not allowed on launch.\"]}`\r\n\r\nI guess I'm looking for clarification on what the expected behavior here is.  I would have expected that the variables supplied at the schedule level would merge with those supplied at the job template level, allowing the user to supply additional variables that may not have been specified in the JT.  \r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nJob callbacks result in 500 error, no jobs are triggered. Exception in logs is `Fields set(['launch_type']) are not allowed as overrides.`\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.358\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a new job template\r\n2. Check 'Allow Provisioning Callbacks'\r\n3. Add Host Config Key\r\n4. POST to job callback URI with Host Config Key\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob should be ran\r\n\r\n##### ACTUAL RESULTS\r\n\r\n500 Server Error\r\n{\"detail\": \"A server error has occurred.\"}\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n2018-01-12 20:08:02,444 ERROR    django.request Internal Server Error: /api/v2/job_templates/9/callback/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 3197, in dispatch\r\n    return super(JobTemplateCallback, self).dispatch(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 253, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 3327, in post\r\n    job = job_template.create_job(**kv)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/jobs.py\", line 309, in create_job\r\n    return self.create_unified_job(**kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 358, in create_unified_job\r\n    raise Exception('Fields {} are not allowed as overrides.'.format(unallowed_fields))\r\nException: Fields set(['launch_type']) are not allowed as overrides.\r\n172.20.5.57 - - [12/Jan/2018:20:08:02 +0000] \"POST /api/v2/job_templates/9/callback/ HTTP/1.1\" 500 41 \"-\" \"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.14393.1944\" \"-\"\r\n[pid: 30|app: 0|req: 140/965] 172.20.5.57 () {36 vars in 602 bytes} [Fri Jan 12 20:08:02 2018] POST /api/v2/job_templates/9/callback/ => generated 41 bytes in 61 msecs (HTTP/1.1 500) 5 headers in 177 bytes (1 switches on core 0)\r\n```\r\n"},{"labels":["api",null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nCurrently Tower only allows a single configurable method for logging data, please allow for multi-server / multi-method logging configuration.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.0\r\n* Ansible version:  2.4.0\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSupport multiple logger aggregation"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI propose a few spelling corrections listed below\r\n\r\n```\r\ndiff --git a/docs/clustering.md b/docs/clustering.md\r\nindex df52cbadd..84245c7d7 100644\r\n--- a/docs/clustering.md\r\n+++ b/docs/clustering.md\r\n@@ -60,7 +60,7 @@ The current standalone instance configuration doesn't change for a 3.1+ deploy.\r\n   hostD\r\n   ```\r\n \r\n-  The `database` group remains for specifying an external postgres. If the database host is provisioned seperately this group should be empty\r\n+  The `database` group remains for specifying an external postgres. If the database host is provisioned separately this group should be empty\r\n   ```\r\n   [tower]\r\n   hostA\r\n@@ -97,7 +97,7 @@ The current standalone instance configuration doesn't change for a 3.1+ deploy.\r\n \r\n The most important field to point out for variability is `rabbitmq_use_long_name`. That's something we can't detect or provide a reasonable\r\n default for so it's important to point out when it needs to be changed. If instances are provisioned to where they reference other instances\r\n-internally and not on external addressess then `rabbitmq_use_long_name` semantics should follow the internal addressing (aka `rabbitmq_host`.\r\n+internally and not on external addresses then `rabbitmq_use_long_name` semantics should follow the internal addressing (aka `rabbitmq_host`.\r\n \r\n Other than `rabbitmq_use_long_name` the defaults are pretty reasonable:\r\n ```\r\n@@ -246,7 +246,7 @@ Each Tower instance is made up of several different services working collaborati\r\n * HTTP Services - This includes the Tower application itself as well as external web services.\r\n * Callback Receiver - Whose job it is to receive job events from running Ansible jobs.\r\n * Celery - The worker queue, that processes and runs all jobs.\r\n-* RabbitMQ - Message Broker, this is used as a signaling mechanism for Celery as well as any event data propogated to the application.\r\n+* RabbitMQ - Message Broker, this is used as a signaling mechanism for Celery as well as any event data propagated to the application.\r\n * Memcached - local caching service for the instance it lives on.\r\n \r\n Tower is configured in such a way that if any of these services or their components fail then all services are restarted. If these fail sufficiently\r\n@@ -326,7 +326,7 @@ When verifying acceptance we should ensure the following statements are true\r\n   only run on instances in those Instance Groups.\r\n * Project updates should manifest their data on the host that will run the job immediately prior to the job running\r\n * Tower should be able to reasonably survive the removal of all instances in the cluster\r\n-* Tower should behave in a predictable fashiong during network partitioning\r\n+* Tower should behave in a predictable fashion during network partitioning\r\n \r\n ## Testing Considerations\r\n \r\ndiff --git a/docs/custom_credential_types.md b/docs/custom_credential_types.md\r\nindex c1b538756..905c43aa7 100644\r\n--- a/docs/custom_credential_types.md\r\n+++ b/docs/custom_credential_types.md\r\n@@ -255,7 +255,7 @@ endpoint:\r\n     }\r\n \r\n \r\n-API Backwards Compatability\r\n+API Backwards Compatibility\r\n ---------------------------\r\n \r\n `/api/v1/credentials/` still exists in Tower 3.2, and it transparently works as\r\ndiff --git a/docs/inventory_refresh.md b/docs/inventory_refresh.md\r\nindex a623840ed..250bb4e17 100644\r\n--- a/docs/inventory_refresh.md\r\n+++ b/docs/inventory_refresh.md\r\n@@ -18,7 +18,7 @@ facts and are per-host. These stored facts can be used to filter hosts via the\r\n `/api/v2/hosts` endpoint, using the GET query parameter `host_filter` i.e.\r\n `/api/v2/hosts?host_filter=ansible_facts__ansible_processor_vcpus=8`\r\n \r\n-The grammer of `host_filter` allows for:\r\n+The grammar of `host_filter` allows for:\r\n * grouping via `()`\r\n * the boolean `and` operator\r\n * `__` to reference related fields in relational fields\r\n@@ -100,7 +100,7 @@ In the above example, you are limiting the search to the \"US-East\" inventory and\r\n hosts with a name containing \"nyc\".\r\n \r\n \r\n-### Acceptance Critera\r\n+### Acceptance Criteria\r\n When verifying acceptance we should ensure the following statements are true:\r\n ``\r\n \r\ndiff --git a/docs/rbac.md b/docs/rbac.md\r\nindex c0bcb6860..540729e24 100644\r\n--- a/docs/rbac.md\r\n+++ b/docs/rbac.md\r\n@@ -9,7 +9,7 @@ The intended audience of this document is the Ansible Tower developer.\r\n \r\n There are three main concepts to be familiar with, Roles, Resources, and Users.\r\n Users can be members of a role, which gives them certain access to any\r\n-resources associated with that role, or any resources associated with \"descendent\"\r\n+resources associated with that role, or any resources associated with \"descendant\"\r\n roles.\r\n \r\n For example, if I have an organization named \"MyCompany\" and I want to allow\r\n@@ -72,7 +72,7 @@ The RBAC system defines a few new models. These models represent the underlying\r\n \r\n ##### `visible_roles(cls, user)`\r\n \r\n-`visible_roles` is a class method that will lookup all of the `Role` instances a user can \"see\". This includes any roles the user is a direct decendent of as well as any ancestor roles.\r\n+`visible_roles` is a class method that will lookup all of the `Role` instances a user can \"see\". This includes any roles the user is a direct decedent of as well as any ancestor roles.\r\n \r\n ##### `singleton(cls, name)`\r\n \r\ndiff --git a/docs/task_manager_system.md b/docs/task_manager_system.md\r\nindex 4d1dd8dae..3b983fe15 100644\r\n--- a/docs/task_manager_system.md\r\n+++ b/docs/task_manager_system.md\r\n@@ -6,11 +6,11 @@ Independent jobs are ran in order of creation time, earliest first. Jobs with de\r\n \r\n ## Task Manager Architecture\r\n \r\ne()`.\r\ndule()`.\r\n \r\n ### Hybrid Scheduler: Periodic + Event\r\n in the present and future, that change the 3 scheduling considerations for which we should call `schedule()` (i.e. adding new nodes to tower changes the capacity, obscure job error handling that fails a job)\r\n- Emperically, the periodic task manager has served us well in the past and we will continue to rely on it with the added event-triggered `schedule()`.\r\n+ Empirically, the periodic task manager has served us well in the past and we will continue to rely on it with the added event-triggered `schedule()`.\r\n \r\n ### Scheduler Algorithm\r\n  * Get all non-completed jobs, `all_tasks`\r\n\r\n```\r\n\r\n\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nHipchat notification not working\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.322\r\n* AWX install method: docker\r\n* Ansible version:  2.4.2.0 \r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nConfigure alerting to hipchat, test alert (works OK), setup notification (fail&success) for template, run job.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nEntries in hipchat channel.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo alerts in hipchat channel (apart from test alert).\r\n\r\nWorked before, updated from devel latest, seems broken. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nMost probably related to:\r\n- https://github.com/ansible/awx/issues/933 (slack notification broken in the same way)\r\n- https://github.com/ansible/awx/issues/935 (email notification broken in the same way)\r\n\r\nAll of which seem to be linked to the way flags for firing notifications work.\r\n- https://github.com/ansible/awx/issues/711 "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nFailed to send webhook notification, raising NotImplementedError\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.356\r\n* AWX install method: docker\r\n* Ansible version:  2.4.10\r\n* Operating System: WIN 10\r\n* Web Browser: Chrome 62.0.3202.94（64 bit）\r\n\r\n##### STEPS TO REPRODUCE\r\n1. add webhook notification template\r\n2. enable \"on success and on failure\" notification in job template\r\n3. run job template\r\n4. Raising NotImplementedError while sending webhook\r\n\r\n##### EXPECTED RESULTS\r\n\r\nno exception while sending webhook\r\n\r\n##### ACTUAL RESULTS\r\n\r\nRaising NotImplementedError while sending webhook\r\n\r\n##### ADDITIONAL INFORMATION\r\n**Notification Template Config**\r\n            \"name\": \"ZOOM Webhook Notifications\",\r\n            \"description\": \"\",\r\n            \"organization\": 1,\r\n            \"notification_type\": \"webhook\",\r\n            \"notification_configuration\": {\r\n                \"url\": \"https://addon.zoom.us/webhook/incoming/6af6dea8db0a4641ac16b66dd9319b8d\",\r\n                \"headers\": {\r\n                    \"X-Zoom-Token\": \"nuEI218PBtxRk15v\",\r\n                    \"Content-Type\": \"application/json\",\r\n                    \"Accept\": \"Application/json\"\r\n                },\r\n                \"use_tls\": false,\r\n                \"use_ssl\": false\r\n\r\n**Exceptions**\r\n```\r\n2018-01-11 06:34:37,441 ERROR    awx.main.tasks Task awx.main.tasks.handle_work_success encountered exception.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 374, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 629, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 357, in handle_work_success\r\n    _send_notification_templates(instance, 'succeeded')\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 341, in _send_notification_templates\r\n    raise NotImplementedError(\"build_notification_%s_message() does not exist\" % status_str)\r\nNotImplementedError: build_notification_succeeded_message() does not exist\r\n2018-01-11 06:34:37,441 ERROR    awx.main.tasks Task awx.main.tasks.handle_work_success encountered exception.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 374, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 629, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 357, in handle_work_success\r\n    _send_notification_templates(instance, 'succeeded')\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 341, in _send_notification_templates\r\n    raise NotImplementedError(\"build_notification_%s_message() does not exist\" % status_str)\r\nNotImplementedError: build_notification_succeeded_message() does not exist\r\n[2018-01-11 06:34:37,441: ERROR/ForkPoolWorker-513] Task awx.main.tasks.handle_work_success encountered exception.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 374, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 629, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 357, in handle_work_success\r\n    _send_notification_templates(instance, 'succeeded')\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 341, in _send_notification_templates\r\n    raise NotImplementedError(\"build_notification_%s_message() does not exist\" % status_str)\r\nNotImplementedError: build_notification_succeeded_message() does not exist\r\n[2018-01-11 06:34:37,441: ERROR/ForkPoolWorker-513] Task awx.main.tasks.handle_work_success[15735be5-7f25-4340-ab3a-970831d0244e] raised unexpected: NotImplementedError('build_notification_succeeded_message() does not exist',)\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 374, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 629, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 357, in handle_work_success\r\n    _send_notification_templates(instance, 'succeeded')\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 341, in _send_notification_templates\r\n    raise NotImplementedError(\"build_notification_%s_message() does not exist\" % status_str)\r\nNotImplementedError: build_notification_succeeded_message() does not exist\r\n```\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nI started a Workflow job, it is in running state and it is hunging. The first job has not yet been spawned. With WJ cancellation nothing happens.\r\nAll the following jobs are in queue.\r\n\r\n##### ENVIRONMENT\r\n-    AWX version: 1.0.2.327\r\n-    AWX install method: docker on linux\r\n-    Ansible version: 2.4.2.0\r\n-    Operating System: Centos 7\r\n-    Web Browser: Chrome/Firefox on Ubuntu\r\n\r\n##### STEPS TO REPRODUCE\r\nThe WJ has a survey, I inserted some custom values and run it.\r\n\r\n##### EXPECTED RESULTS\r\nWJ comes to an end (success/failure).\r\n\r\n##### ACTUAL RESULTS\r\nIt stucks in running state. No job spawned.\r\n\r\n##### ADDITIONAL INFORMATION\r\nSingle jobs (who compose the workflow) are working passing the same values asked in survey.\r\n\r\nRam seems ok.\r\n\r\nI have no errors in UI. The only error in logs seems to be this one:\r\n```\r\n[2018-01-10 15:39:50,299: ERROR/ForkPoolWorker-3649] Task awx.main.scheduler.tasks.run_task_manager encountered exception.\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 374, in trace_task\r\n    R = retval = fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 629, in __protected_call__\r\n    return self.run(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/tasks.py\", line 37, in run_task_manager\r\n    TaskManager().schedule()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 628, in schedule\r\n    finished_wfjs = self._schedule()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 613, in _schedule\r\n    self.spawn_workflow_graph_jobs(running_workflow_tasks)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/scheduler/task_manager.py\", line 195, in spawn_workflow_graph_jobs\r\n    job = spawn_node.unified_job_template.create_unified_job(**kv)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/unified_jobs.py\", line 358, in create_unified_job\r\n    raise Exception('Fields {} are not allowed as overrides.'.format(unallowed_fields))\r\nException: Fields set(['extra_vars']) are not allowed as overrides.\r\n```\r\nCould the \"override\" thing be related to the fact that the Workflow has a survey, but also Job Templates used to build the Worflow have surveys? That's because JT could be also executed atomically.\r\n\r\nAs the system is unusable I both tried restarting all containers and rebooting the server, with no luck.\r\nPlease help to cancel that Workflow job.\r\n\r\nThanks a lot!"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIn the tower docs, the header for authentication is referenced as 'Authorization', when in fact this doesn't work and it requires using the header 'X-Auth-Token'\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.315\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: n/a\r\n* Web Browser: n/a\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCall an API with the Authorization header (and a valid token)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nRequest should respond appropriately\r\n\r\n##### ACTUAL RESULTS\r\n\r\nRequest responds with an error about credentials\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNot sure if this is a bug or a documentation issue, i.e. this is the correct header, but docs are out of date, or this is the wrong header and the code should be updated.\r\n"},{"labels":["api",null,null,null],"text":" - Feature Idea\r\n\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI have some requirements that needs to be installed for my playbooks to run. These requirements may change depending on SCM updates. It would be nice to be able to run a playbook to do setup after a SCM update has been completed rather than add an extra task, to make sure all dependencies are installed, to all my playbooks.\r\n\r\nIt also seems to me that this would be very useful if you e.g. have a project with git submodule dependencies.\r\n\r\nSomething like a top-level requirements.yml playbook would suffice for my purposes."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nGit SCM Update sometimes hungs with no apparent reason and get stuck in running.\r\n\r\n##### ENVIRONMENT\r\n- AWX version: 1.0.2.327\r\n- AWX install method: docker on linux\r\n- Ansible version: 2.4.2.0\r\n- Operating System: Centos 7\r\n- Web Browser: Chrome/Firefox on Ubuntu\r\n\r\n##### STEPS TO REPRODUCE\r\nLaunch SCM Update on a Project (both manually, or scheduled, or invoked by a job with 'Update on launch' option).\r\n\r\n##### EXPECTED RESULTS\r\nThe job ends (success/failure).\r\n\r\n##### ACTUAL RESULTS\r\nThe job stays in running state.\r\nI then cancel it, and one of the following situation happens:\r\n- sometimes rerun it some minutes/hours later helps\r\n- sometimes if I run a different job/project update and I rerun the hunging one, it completes\r\n- sometimes I have to restart all containers or reboot the whole server to get it work.\r\n\r\n##### ADDITIONAL INFORMATION\r\nThere is no a precise scheme.\r\nWhile hunging:\r\n- Git server is reacheable\r\n- AWX host resources seem ok (ram, disk, I/O, ..)\r\n- No specific errors in UI o awx_task logs \r\n- Job standard out:\r\n\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file\r\n\r\nPLAY [all] *********************************************************************\r\n\r\n\r\nTASK [delete project directory before update] **********************************\r\nskipping: [localhost]\r\n\r\nTASK [check repo using git] ****************************************************\r\nskipping: [localhost]\r\n\r\nTASK [update project using git] ************************************************\r\n```\r\n\r\nDid anybody experience the same?\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun the following adhoc command with the `shell` module:\r\n`printf '\\xE2\\x98\\xA0'`\r\n\r\nNext, visit `/api/v2/ad_hoc_commands/N/stdout/`.  You will see a traceback:\r\n\r\n```python\r\n/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py in get\r\n        return self.retrieve(request, *args, **kwargs) ...\r\n./awx/api/views.py in retrieve\r\n                content, start, end, absolute_end = unified_job.result_stdout_raw_limited(start_line, end_line) ...\r\n./awx/main/models/unified_jobs.py in result_stdout_raw_limited\r\n        return self._result_stdout_raw_limited(start_line, end_line, redact_sensitive) ...\r\n./awx/main/models/unified_jobs.py in _result_stdout_raw_limited\r\n            return_buffer += line \r\n'ascii' codec can't decode byte 0xe2 in position 7: ordinal not in range(128)\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nOn the current network visualization branch (network_ui_3_3), running a project update fails with `No module named websocket`.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2-596-g6f9d0b7\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.4.2.0\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. After deploying the container (from branch `network_ui_3_3`), use `awx-manage create_preload_data` to load the Demo Inventory, Project and Job Template.\r\n2. Open the Tower UI, and run an update for the Demo Project\r\n\r\n##### EXPECTED RESULTS\r\n\r\nUpdate is successful.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nProject update fails. The update's stdout shows:\r\n`ERROR! Unexpected Exception, this is probably a bug: No module named websocket`\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWorkaround:\r\n```\r\ndocker exec -it tools_awx_1 bash\r\n. /venv/ansible/bin/activate\r\npip install websocket-client==0.44.0\r\n```\r\n\r\nSeems like the new dependency may have been introduced by:\r\nhttps://github.com/ansible/awx/blob/network_ui_3_3/awx/plugins/callback/network_ui.py#L22\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nExpand UI openstack credential with other os-client-config options available for [clouds.yaml](https://docs.openstack.org/os-client-config/latest/user/configuration.html#config-files). For example `verify` for SSL verification.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1\r\n\r\n  "},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nEmail notification is not working for job completion (success or failure) even though testing notification works.\r\nIt seems the same as #933 \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.327\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0 \r\n* Operating System: Centos 7\r\n* Web Browser: Chrome/Firefox on Ubuntu\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nEmail notification setup and the test notification with the bell alarm icon work fine. Both notifications of job completion (success or failure) are enabled (as per #711, with my build it works fine). \r\nExecute template job.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSuccess/failure email sent when job completes.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo message sent.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nFor SCM update and Workflow job email notification works.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIs there any release of awx that is usable? Cant't run any Job with 1.0.2.0 or 1.0.2.327\r\n\r\nWith 1.0.2.0:\r\n![2018-01-09 07_32_56-ansible awx _ about_1](https://user-images.githubusercontent.com/3391958/34708723-4e1aac84-f514-11e7-961b-72116d61c11f.png)\r\n\r\n![2018-01-09 07_33_29-ansible awx _ sit-linux_1](https://user-images.githubusercontent.com/3391958/34708727-5181f986-f514-11e7-87ec-4c8f82d60337.png)\r\nProject snyc job stucks.\r\n\r\nWith 1.0.2.327:\r\n![2018-01-09 08_09_13-ansible awx _ about_2](https://user-images.githubusercontent.com/3391958/34708749-7675c326-f514-11e7-86b6-d71babf6747e.png)\r\n\r\n![2018-01-09 08_09_28-ansible awx _ sit-linux_2](https://user-images.githubusercontent.com/3391958/34708753-78f81a68-f514-11e7-949c-433377dd6135.png)\r\nProject snyc job stucks without any error message.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.0/327\r\n* AWX install method: docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.4.0\r\n* Operating System: Linux\r\n* Web Browser: Firefox\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nSlack notification is not working for job completion (success or failure) even though testing notification works well.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.2.303\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.2.0\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI confirmed the Slack notification setup and **the test notification with the bell alarm icon works fine**. And I also confirmed the both notifications of job completion (success or failure) are enabled. However, no message appeared in the Slack channel when the job completed.\r\n\r\nThere are some comments about the same issue.\r\nhttps://github.com/ansible/awx/issues/711#issuecomment-354250896\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe success/failure message of job completion is sent to the Slack channel.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo message appears in the Slack channel.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n1) Create a vault credential with vault_id: `foo` and check the box to ask password on launch. (lets say this is ID: 1)\r\n2) Create a second vault credential with vault_id: `bar` and also check the box to ask password on launch. (lets say this is ID: 2)\r\n3) Create a job template and select the vault credential from step one as a default credential.\r\n4) Click the checkbox to prompt for credentials on job template launch and save.\r\n\r\nIf we launched this job without any credential changes, the payload would look like:\r\n\r\n```\r\n{\r\n    \"credentials\": [\r\n        1\r\n    ],\r\n    \"credential_passwords\": {\r\n        \"vault_password.foo\": \"somepasswordhere\"\r\n    }\r\n}\r\n```\r\n\r\nIf we wanted to replace the default credential (id: 1) with the other vault credential (id: 2) then I would expect the payload to look like:\r\n\r\n```\r\n{\r\n    \"credentials\": [\r\n        2\r\n    ],\r\n    \"credential_passwords\": {\r\n        \"vault_password.bar\": \"somepasswordhere\"\r\n    }\r\n}\r\n```\r\n\r\nbut when that gets POST'd to the launch endpoint we get back a 400 error with the following:\r\n\r\n`{passwords_needed_to_start: [\"vault_password.foo\", \"vault_password.bar\"]}`\r\n\r\nLink https://github.com/ansible/awx/issues/352"},{"labels":["api",null,null],"text":"The network UI will add new API endpoints for:\r\n\r\n* Topology\r\n* Device\r\n* Interface\r\n* Link\r\n* NetworkGroup\r\n\r\n  "},{"labels":["api"],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n\r\n##### SUMMARY\r\nCan anyone please tell me where is the place to control the user permissions to create a new job template. I was overwriting the authorization part integrating with our internal api.  I tried changing the few classes in api/permissions.py, main/access.py but none of them worked for creating a Job template. Not really sure where I am missing.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAdd functionality to Azure inventory import similar to the AWS `vpc_destination_variable: private_ip_address' source variable setting, that would allow the importing of Azure hosts by private IP address.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCurrently, if a default public IP address is not available, the hosts are imported by hostname in that circumstance, and the hostname is often not resolvable, so playbooks fail.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - API Bug/Enhancement\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen scheduling a job template run where the credentials are promptable, the current implementation requires the UI to POST to `/api/v2/schedules/:id/credentials` to provide a non-default credential selection.  As far as I can tell this implementation is a bit restricting.  Take the following example: Create a Job Template with a single default machine credential.  If I then wanted to create a schedule with that Job Template but wanted to remove that default credential so that no credentials were selected I'm not sure how to represent that with the current api implementation.  Its almost like we need a flag on the schedule that says the user has overwritten the default credentials so that `/api/v2/schedules/:id/credentials` becomes the source of truth.\r\n\r\nPinging @ryanpetrello but feel free to redirect if someone else has cycles.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRelated to work being done on https://github.com/ansible/awx/issues/169"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - API Enhancement\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen launching a job template we want the user to be able to select N number of vault credentials with the stipulation that the user can only select one vault credential per vault_id.  Initially, the UI uses data from `/api/v2/job_templates/:id/launch/` to populate the default selected credentials.  The object that we get back looks something like:\r\n\r\n```\r\n\"defaults\": {\r\n        \"job_tags\": \"\",\r\n        \"extra_vars\": \"---\\nfoo: bar\",\r\n        \"verbosity\": 0,\r\n        \"job_type\": \"run\",\r\n        \"diff_mode\": false,\r\n        \"skip_tags\": \"\",\r\n        \"limit\": \"\",\r\n        \"inventory\": {\r\n            \"id\": 1,\r\n            \"name\": \"Inventory 1\"\r\n        },\r\n        \"credentials\": [\r\n            {\r\n                \"credential_type\": 3,\r\n                \"passwords_needed\": [],\r\n                \"name\": \"Vault 1\",\r\n                \"id\": 3\r\n            }\r\n        ]\r\n    }\r\n```\r\n\r\nWhen the user selects a new vault credential from the list we want to check to see if the newly selected vault credential's `vault_id` matches any of the previously selected vault credentials.  If so, then we need to remove the old credential with the same `vault_id`.  Currently we can't do this without making an extra request for each default vault credential.  If it's possible to include the `vault_id` in the launch endpoint's default credentials then that would help us out quite a bit but if it's determined that we need to go ahead and make those extra requests then we can do that too.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRelated to https://github.com/ansible/awx/issues/352\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAdd functionality to allow the on/off host enabled flag to be set manually in the Tower inventory hosts display for hosts that were sourced from an external dynamic inventory, overriding the flag set in the inventory sync.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis change would allow hosts to be manually excluded from job runs, according to a manual action in the UI without requiring a change to the inventory source data."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nWhen a job_template is created by the admin user and the admin user creates a survey no other users with admin perms on the job_template can edit the survey.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.8\r\n* AWX install method: docker on linux\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. log in as admin\r\n2. create a new job_template\r\n3. save job_template\r\n4. add a survey and save\r\n5. assign a local user admin rights to job_template\r\n6. log out\r\n7. log in as another local user who has admin rights over job_template\r\n8. try and edit survey\r\n\r\n##### EXPECTED RESULTS\r\n\r\nOrg admin or user that has admin rights to job_template can edit survey\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError! You do not have permission to perform this action."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nOn a fresh install to local docker, I get an error when attempting to run a job on a newly created job template.\r\n\r\nError message in AWX UI:\r\n\r\n```\r\nFailed to get job template details. GET returned status: undefined\r\n```\r\n\r\nawx_web log:\r\n\r\n```\r\n[pid: 25|app: 0|req: 610/1551] 10.0.6.36 () {54 vars in 2333 bytes} [Thu Dec 28 09:42:33 2017] GET /api/v2/job_templates/9/launch/ => generated 726 bytes in 115 msecs (HTTP/1.1 200) 9 headers in 255 bytes (1 switches on core 0)\r\n10.0.6.36 - - [28/Dec/2017:09:42:34 +0000] \"GET /api/v2/job_templates/9/launch/ HTTP/1.1\" 200 726 \"https://ansible.foo.bar/\" \"Mozilla/5.0 (Windows NT 6.3; WOW64; rv:57.0) Gecko/20100101 Firefox/57.0\" \"10.5.101.154\"\r\n10.0.6.36 - - [28/Dec/2017:09:42:34 +0000] \"OPTIONS /api/v2/job_templates/9/launch/ HTTP/1.1\" 200 5091 \"https://ansible.foo.bar/\" \"Mozilla/5.0 (Windows NT 6.3; WOW64; rv:57.0) Gecko/20100101 Firefox/57.0\" \"10.5.101.154\"\r\n[pid: 28|app: 0|req: 491/1552] 10.0.6.36 () {58 vars in 2431 bytes} [Thu Dec 28 09:42:34 2017] OPTIONS /api/v2/job_templates/9/launch/ => generated 5091 bytes in 145 msecs (HTTP/1.1 200) 9 headers in 256 bytes (1 switches on core 0)\r\n10.0.6.36 - - [28/Dec/2017:09:42:34 +0000] \"GET /api/v2/credential_types/ HTTP/1.1\" 200 13569 \"https://ansible.foo.bar/\" \"Mozilla/5.0 (Windows NT 6.3; WOW64; rv:57.0) Gecko/20100101 Firefox/57.0\" \"10.5.101.154\"\r\n[pid: 25|app: 0|req: 611/1553] 10.0.6.36 () {54 vars in 2321 bytes} [Thu Dec 28 09:42:34 2017] GET /api/v2/credential_types/ => generated 13569 bytes in 146 msecs (HTTP/1.1 200) 9 headers in 257 bytes (1 switches on core 0)\r\n```\r\n\r\nEditing the job template through the web UI works.\r\n\r\nThe issue may be related to #875 (same error message).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.303\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: CentOS 7.4 x64\r\n* Web Browser: Mozilla Firefox 57\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n- create new template for running an Ansible playbook from the project's Git repository\r\n- attempt to run template through UI\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nAnsible playbook run is triggered\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nI get an error message\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - Hipchat plugin (notifications)\r\n\r\n##### SUMMARY\r\nHipchat is a way to create notificatons to the Tower Rest API. By not verifying that certificate, this could lead in a MiTM attack or most probably in an information leak.\r\n\r\n##### ENVIRONMENT\r\n* AWX 3.2.2 \r\n* AWX 3.3.X (development)\r\n\r\n##### STEPS TO REPRODUCE\r\nIdeally, this line should actually verify the certificate by setting verify=True (currently the value is False):\r\nhttps://github.com/ansible/awx/blob/devel/awx/main/notifications/hipchat_backend.py#L41\r\n\r\n##### EXPECTED RESULTS\r\nN/A\r\n\r\n##### ACTUAL RESULTS\r\nN/A\r\n\r\n##### ADDITIONAL INFORMATION\r\nN/A\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - Installer\r\n\r\n##### SUMMARY\r\nAfter updating from 1.0.1.0 to 1.0.2.0 several of my job templates had their settings adjusted. Parameters that previously were set to \"prompt on launch\" were disabled.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.0\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Amazon Linux\r\n* Web Browser: any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Install AWX 1.0.1.0\r\n2) Create Job A that is set to prompt on launch its extra variables\r\n3) Set permissions on Job A to allow a test user Admin role on the job\r\n3) Create Job B that uses tower-cli with test user's credentials to schedule Job A\r\n4) Verify that Job B completes and schedules Job A instances to run\r\n5) Verify that Job A instances run\r\n6) Upgrade AWX instance to 1.0.2.0\r\n7) Check to see if Job B can schedule additional Job A\r\n\r\n##### EXPECTED RESULTS\r\n\r\nJob A should be scheduled\r\n\r\n##### ACTUAL RESULTS\r\n\r\ntower-cli fails with `Error: The Tower server claims it was sent a bad request.`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI saw this in the upgrade logs which seems related;\r\n```\r\n2017-12-21T17:30:23.124393307Z Running migrations:\r\n2017-12-21T19:10:00.731526893Z   Applying main.0009_v330_multi_credential... OK\r\n2017-12-21T19:10:11.576576393Z   Applying main.0010_saved_launchtime_configs... OK\r\n2017-12-21T19:10:12.485539011Z 2017-12-21 19:10:12,485 DEBUG    awx.main.migrations Blanking job args for 48\r\n2017-12-21T19:10:12.489662623Z 2017-12-21 19:10:12,489 DEBUG    awx.main.migrations Blanking job args for 88\r\n...\r\n2017-12-21T19:19:28.886759479Z 2017-12-21 19:19:28,886 DEBUG    awx.main.migrations Blanking job args for 295038\r\n2017-12-21T19:19:28.890076619Z 2017-12-21 19:19:28,889 DEBUG    awx.main.migrations Blanking job args for 295054\r\n2017-12-21T19:19:28.893428979Z 2017-12-21 19:19:28,893 DEBUG    awx.main.migrations Blanking job args for 295058\r\n2017-12-21T19:19:28.908807011Z   Applying main.0011_blank_start_args... OK\r\n```\r\n\r\nSeems like both main.0010 and main.0011 could be related to this issue."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nJob stuck and cannot be cancelled. When cancelling the job, nothing happens and the job is still running.\r\n\r\nOther job templates that use the same inventory are held in a queue and blocked from running.\r\n\r\nI'm unable to sync the inventory in question either, it just hangs with no output.\r\n\r\nTo work around this I had to create a new inventory, assign all templates to the new inventory before I could run them, which isn't ideal.\r\n\r\n##### ENVIRONMENT\r\nAWX version: latest\r\nAWX install method: docker on linux\r\nAnsible version: 2.4\r\nOperating System: Linux\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIf anyone could please help me force cancel this job it would be great. \r\n\r\nThe AWX server is busy so it's hard to know if what I'm seeing in the log in realtime whilst trying to cancel a task is related. Maybe this relates:\r\n\r\n\r\n`[2017-12-27 13:28:31,207: INFO/MainProcess] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\n[2017-12-27 13:28:31,210: DEBUG/MainProcess] awx.main.scheduler.tasks.run_task_manager sent. id->9112f3b1-adee-42d6-ab9a-d490504ca624\r\n[2017-12-27 13:28:31,210: DEBUG/MainProcess] beat: Waking up in 19.99 seconds.\r\n[2017-12-27 13:28:31,215: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[9112f3b1-adee-42d6-ab9a-d490504ca624]   expires:[2017-12-27 13:28:51.209264+00:00]\r\n[2017-12-27 13:28:31,215: INFO/MainProcess] Scaling down 1 processes.\r\n[2017-12-27 13:28:31,216: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x3095c80> (args:('awx.main.scheduler.tasks.run_task_manager', '9112f3b1-adee-42d6-ab9a-d490504ca624', {'origin': 'gen98@awx', 'lang': 'py', 'task': 'awx.main.scheduler.tasks.run_task_manager', 'group': None, 'root_id': '9112f3b1-adee-42d6-ab9a-d490504ca624', u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': '2017-12-27T13:28:51.209264+00:00', u'correlation_id': '9112f3b1-adee-42d6-ab9a-d490504ca624', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '()', 'eta': None, 'parent_id': None, u'reply_to': '4ccaf1dd-88bd-3bce-a993-29e1f2156d88', 'id': '9112f3b1-adee-42d6-ab9a-d490504ca624', 'kwargsrepr': '{}'}, u'[[], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2017-12-27 13:28:31,216: DEBUG/MainProcess] basic.qos: prefetch_count->96\r\n[2017-12-27 13:28:31,232: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[9112f3b1-adee-42d6-ab9a-d490504ca624] pid:1658\r\n2017-12-27 13:28:31,248 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2017-12-27 13:28:31,248 DEBUG    awx.main.scheduler Running Tower task manager.\r\n[2017-12-27 13:28:31,248: DEBUG/ForkPoolWorker-59] Running Tower task manager.\r\n2017-12-27 13:28:31,256 DEBUG    awx.main.scheduler Starting Scheduler\r\n2017-12-27 13:28:31,256 DEBUG    awx.main.scheduler Starting Scheduler\r\n[2017-12-27 13:28:31,256: DEBUG/ForkPoolWorker-59] Starting Scheduler\r\n[2017-12-27 13:28:31,413: INFO/ForkPoolWorker-59] Task awx.main.scheduler.tasks.run_task_manager[9112f3b1-adee-42d6-ab9a-d490504ca624] succeeded in 0.181198501028s: None\r\n[2017-12-27 13:28:34,242: INFO/MainProcess] Scaling down 1 processes.\r\n[2017-12-27 13:28:34,280: DEBUG/MainProcess] heartbeat_tick : for connection e2a1ec09a42b44a094b96282fa6433c2\r\n[2017-12-27 13:28:34,281: DEBUG/MainProcess] heartbeat_tick : Prev sent/recv: 400/3485, now - 404/3525, monotonic - 2510462.00238, last_heartbeat_sent - 2510462.00237, heartbeat int. - 60 for connection e2a1ec09a42b44a094b96282fa6433c2`\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n- help wanted\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nIn my organization we working with gitlab server, i want to pull a project from my gitlab server, \r\nIm creating a credetials with my gitlab username and password, I get an error:  \r\n\"Could not read from remote repository, Please make sure you have the correct access rights and \r\nthe repository exist\" \r\n\r\n##### ENVIRONMENT\r\n* AWX version: newest 1.0.2.303\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.4.2.0\r\n* Operating System: RHEL 7 \r\n* Web Browser: Chrome / Explorer\r\n\r\n##### STEPS TO REPRODUCE\r\nI created a Credentials for gitlab with my gitlab username and password but I have a field with SCM private key, I dont know which key to take, usually need a public key but here its private \r\n\r\n##### EXPECTED RESULTS\r\n\r\nConnecting to gitlab\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\"Could not read from remote repository, Please make sure you have the correct access rights and \r\nthe repository exist\" \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI searched for tutorial connecting gitlab to AWX with ssh keys but nothing found . \r\nthanks for help . \r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nI'm trying to setup webhooks notifications with Microsoft Teams, but i'm getting errors. Maybe a misconfiguration, but there is no documentation about how to do it.\r\n\r\nMaybe someone already achieved this by webhooks, but it would be great to add an option to do it like slack.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.303\r\n* AWX install method: docker on linux\r\n* Ansible version: 2.4.2.0\r\n* Operating System: Ubuntu\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nas described here:\r\nhttps://docs.ansible.com/ansible-tower/latest/html/userguide/notifications.html#webhook\r\n\r\nand here:\r\nhttps://docs.microsoft.com/en-us/microsoftteams/platform/concepts/connectors\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSelect notification type Microsoft Teams, and configure the options. Or a documentation of how to do it with webhook option.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWith webhook I'm receiving this error.\r\nERROR    awx.main.notifications.webhook_backend Error sending notification webhook: Summary or Text is required.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAllow execution of a workflow on a per host basis, where a particular host may take either a success path or a failure path depending on task outcomes for only that host.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis enhancement would allow finer-grained control of the path that particular hosts take through a workflow and would reduce the problem of a workflow node failure causing hosts to fail to complete the workflow that otherwise could.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI (I guess?)\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWe're currently exploring AWX, and in our existing playbooks we have nested yaml declarations in `group_vars` that look like this:\r\n\r\n```\r\n# OS API User Login Information:\r\nauth:\r\n  os_auth_url: \"http://openstack.domain.io:5000\"\r\n  os_username: \"username\"\r\n\r\n# OS Project Details:\r\nproject:\r\n  os_project: \"admin\"\r\n  os_region_name: \"RegionOne\"\r\n  os_domain_name: \"Default\"\r\n```\r\n\r\n...and so on. This is valid yaml syntax, and when used in the playbooks, they're declared like the following just fine (without AWX):\r\n\r\n```\r\n- name: creating new instances and attaching to declared networks\r\n  os_server:\r\n       state: present\r\n       auth:\r\n         auth_url: \"{{ auth.os_auth_url }}\"\r\n         username: \"{{ auth.os_username }}\"\r\n         password: \"{{ os_password }}\"\r\n         project_name: \"{{ project.os_project }}\"\r\n       name: \"{{ instance.os_hostname }}\"\r\n       image: \"{{ instance.os_image_id }}\"\r\n       key_name: \"{{ instance.os_key_name }}\"\r\n       timeout: 200\r\n       flavor: \"{{ instance.os_flavor_id }}\"\r\n       network: \"{{ network.os_network_id }}\"\r\n       meta:\r\n         hostname: \"{{ meta.os_hostname }}\"\r\n         group: \"{{ meta.os_group }}\"\r\n```\r\n\r\nThis works as expected when running Ansible manually, but when trying to use these same variable declarations in surveys I receive an error that states \"Please remove the illegal character from the survey question variable name\". I believe this occurs because AWX is not interpreting \".\" as a valid YAML nested delimiter.\r\n\r\nCan someone tell me if there's a work around, or do I really need to redraft our playbooks? We have a lot of playbooks with this format, and I would like to avoid that if possible.\r\n\r\nThanks for the help/guidance in advance!\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Master and also tagged version 1.0.2\r\n* AWX install method: docker\r\n* Ansible version:  2.4.x\r\n* Operating System: Linux\r\n* Web Browser: Firefox and Chrome (same results)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nDetails are included above...\r\n\r\n##### EXPECTED RESULTS\r\n\r\nDetails are included above...\r\n\r\n##### ACTUAL RESULTS\r\n\r\nDetails are included above...\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNone\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### STEPS TO REPRODUCE\r\nFeature proposal, some user stories:\r\n\r\n - I have a `.ini` file in source control\r\n - I don't want Ansible to guess which format this is, in case it is picked up by another parser, like yaml\r\n - I want to select ini out of a dropdown as I create my SCM-based inventory source\r\n\r\nAnother user story:\r\n\r\n - I have an Ansible inventory plugin module in a file in source control\r\n - I want an SCM inventory source update (using this source control) to parse the inventory with that plugin\r\n\r\nReeealy advanced use story:\r\n\r\n - I have a prototype general inventory plugin, and I want to use this in AWX inventory updates\r\n - the source control that holds my inventory files does _not_ hold my inventory plugin\r\n - I want to add the inventory plugin to the plugin search path of the machines in the cluster that is running AWX\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis is an issue that corresponds to what #480 was attempting to solve. No guarantees that all these use cases will be satisfied within this development cycle.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf something goes wrong with the script content, a job may still be marked as successful.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2-301\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.4 and 2.5\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\nOnly matters when some kind of AWX / Ansible internal error happens. This may happen when the script that tasks.py dynamically creates is an invalid Ansible inventory script.\r\n\r\n##### EXPECTED RESULTS\r\njob or update fails or errors.\r\n\r\nThis behavior should be enabled by setting environment variables\r\n\r\n```\r\nANSIBLE_INVENTORY_ENABLED=script\r\nINVENTORY_UNPARSED_IS_FAILED=true\r\n```\r\n\r\nThese env vars should be enabled for all jobs running in AWX. Inventory updates should also be limited to a single inventory plugin, as per #171\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThese are not set, which causes a confusing cascade of error messages (examples exist in other issues, look for garbage errors like \"Expected key=value host variable assignment\").\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nenvironment config variables reference\r\n\r\nhttps://github.com/ansible/ansible/blob/deve/lib/ansible/config/base.yml\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nUnexpected fields in credential summary fields\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2-301\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\nGET /api/v2/credentials/\r\n\r\ninspect summary_fields\r\n\r\n##### EXPECTED RESULTS\r\nno related host or project, these don't make sense\r\n\r\n##### ACTUAL RESULTS\r\n```json\r\n\"summary_fields\": {\r\n    \"host\": {},\r\n    \"project\": {},\r\n    ...\r\n```\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAWX Crashes when it encounters a 404.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2 (also tested on latest devel)\r\n* AWX install method: docker on linux\r\n* Ansible version:  Unsure, not really relevant though.\r\n* Operating System: Linux\r\n* Web Browser: Not relevant as long as it can send a HTTP request.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGo to any invalid url like /404\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt should give me a 404 page\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIt actually crashes.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n2017-12-19 11:30:12,216 ERROR    django.request Internal Server Error: /crash\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 116, in get_exception_response\r\n    response = callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 80, in handle_404\r\n    return handle_error(request, 404, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 177, in render\r\n    return compiled_parent._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader_tags.py\", line 72, in render\r\n    result = block.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 40, in render\r\n    output = self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n    return self.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/defaulttags.py\", line 166, in render\r\n    values = self.sequence.resolve(context, True)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 736, in resolve\r\n    new_obj = func(obj, *arg_vals)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/templatetags/rest_framework.py\", line 244, in items\r\n    return value.items()\r\nAttributeError: 'NoneType' object has no attribute 'items'\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/wsgi.py\", line 157, in __call__\r\n    response = self.get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 124, in get_response\r\n    response = self._middleware_chain(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 43, in inner\r\n    response = response_for_exception(request, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 53, in response_for_exception\r\n    response = get_exception_response(request, get_resolver(get_urlconf()), 404, exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 119, in get_exception_response\r\n    response = handle_uncaught_exception(request, resolver, sys.exc_info())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 143, in handle_uncaught_exception\r\n    return callback(request, **param_dict)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 88, in handle_500\r\n    return handle_error(request, 500, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/views.py\", line 56, in handle_error\r\n    return render(request, 'error.html', kwargs, status=status)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/shortcuts.py\", line 30, in render\r\n    content = loader.render_to_string(template_name, context, request, using=using)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/loader.py\", line 68, in render_to_string\r\n    return template.render(context, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/backends/django.py\", line 66, in render\r\n    return self.template.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 207, in render\r\n    return self._render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 199, in _render\r\n    return self.nodelist.render(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 990, in render\r\n    bit = node.render_annotated(context)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/template/base.py\", line 957, in render_annotated\r\n2017/12/19 11:30:12 [error] 24#0: *37717 upstream prematurely closed connection while reading response header from upstream, client: 172.16.34.20, server: _, request: \"GET /crash HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"therewasahostherebutiremovedit.com\"\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe inventory import searches for an `ansible-inventory` executable in a way that makes assumptions, which will probably lead it to not picking up the correct executable from the relevant virtual environment.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe current behavior is that it searches by the system PATH.\r\n\r\nhttps://github.com/ansible/awx/blob/7e261b5246343ac12720a24b5a98a0326f1a0b8a/awx/main/management/commands/inventory_import.py#L93-L98\r\n\r\nThis needs re-evaluation to make sure it is compatible with the virtual environment.\r\n\r\nThis is important to do in such a way that it is compatible with #34"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen using the network modules, for example eos_command, passwords that are provided via a network credential in AWX can be seen in cleartext in job_events. The password can then be picked up via Postgres, the API and also when using a HTTP log aggregator.\r\nThis happens despite the network modules having no_log: true set inside them. It's not possible to see the password via regular Ansible core.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.2.289\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.2\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a network credential in AWX\r\n2. Setup a project, inventory and template which use the following playbook:\r\n\r\n```\r\n---\r\n - name: connect to eos\r\n   hosts: all\r\n   gather_facts: no\r\n   connection: local\r\n   vars:\r\n    eos:\r\n# Username and password come from network cred in AWX, unhash these if using regular Ansible Core\r\n#     username: admin\r\n#     password: mypassword\r\n     transport: cli\r\n\r\n   tasks:\r\n\r\n    - name: run command\r\n      eos_command:\r\n        commands:\r\n          - show version\r\n        provider: \"{{ eos }}\"\r\n```\r\n\r\n3. After the playbook is run you can then get the password stored in the credential store via 3 ways:\r\n\r\ndump the database and check the main_jobevents table - provider password can be seen::\r\n\r\n```\r\n--\r\n-- Data for Name: main_jobevent; Type: TABLE DATA; Schema: public; Owner: awx\r\n--\r\n\r\n\r\n\r\n15      2017-12-15 21:56:26.502137+00   2017-12-15 21:56:26.84251+00    runner_on_ok    {\"play_pattern\": \"all\", \"play\": \"connect to eos\", \"task\": \"run command\", \"task_args\": \"_ansible_version=2.4.2.0, commands=[u'show version'], _ansible_selinux_special_fs=['fuse', 'nfs', 'vboxsf', 'ramfs', '9p'], _ansible_no_log=False, _ansible_module_name=eos_command, _ansible_debug=False, _ansible_verbosity=0, _ansible_syslog_facility=LOG_USER, _ansible_socket=/var/lib/awx/.ansible/pc/2acfec4c5b, _ansible_diff=False, provider={u'username': u'admin', 'authorize': '0', 'ssh_keyfile': None, 'auth_pass': None, 'host': None, 'timeout': None, 'use_ssl': None, u'password': u'mypassword', 'validate_certs': None, 'port': None, u'transport': u'cli'}, _ansible_shell_executable=/bin/sh, _ansible_check_mode=False\", \"remote_addr\": \"192.168.0.22\", \"res\": {\"_ansible_parsed\": true, \"stdout\": [\"Arista vEOS\\\\nHardware version:    \\\\nSerial number:       \\\\nSystem MAC address:  5254.0055.dae4\\\\n\\\\nSoftware image version: 4.16.6M\\\\nArchitecture:           i386\\\\nInternal build version: 4.16.6M-3205780.4166M\\\\nInternal build ID:      e796e94c-ba3b-4355-afcf-ef0abfbfaee3\\\\n\\\\nUptime:                 1 week, 5 days, 21 hours and 50 minutes\\\\nTotal memory:           1897528 kB\\\\nFree memory:            589916 kB\"], \"_ansible_no_log\": false, \"warnings\": [\"argument username has been deprecated and will be removed in a future version\", \"argument password has been deprecated and will be removed in a future version\"], \"changed\": false, \"invocation\": {\"module_args\": \"\"}, \"stdout_lines\": [[\"Arista vEOS\", \"Hardware version:    \", \"Serial number:       \", \"System MAC address:  5254.0055.dae4\", \"\", \"Software image version: 4.16.6M\", \"Architecture:           i386\", \"Internal build version: 4.16.6M-3205780.4166M\", \"Internal build ID:      e796e94c-ba3b-4355-afcf-ef0abfbfaee3\", \"\", \"Uptime:                 1 week, 5 days, 21 hours and 50 minutes\", \"Total memory:           1897528 kB\", \"Free memory:            589916 kB\"]]}, \"pid\": 765, \"play_uuid\": \"0242c0a8-0014-f648-e00d-000000000006\", \"task_uuid\": \"0242c0a8-0014-f648-e00d-000000000008\", \"event_loop\": null, \"playbook_uuid\": \"b4cb2449-cca3-48bf-bb08-e041db1ee598\", \"playbook\": \"eos.yml\", \"task_action\": \"eos_command\", \"host\": \"192.168.0.22\", \"task_path\": \"/var/lib/awx/projects/local/eos.yml:14\"}  f       f       192.168.0.22       connect to eos          run command     10      2       \\N      5       758e4aac-09ef-4b40-8295-e5c475cd09a4    0242c0a8-0014-f648-e00d-000000000008       11      eos.yml 10      ok: [192.168.0.22]\r\n```\r\n\r\nBrowse to api/v2/job_events/:\r\n\r\n![image](https://user-images.githubusercontent.com/19539695/34062889-d79d4cf0-e1e6-11e7-956d-ce36c920d837.png)\r\n\r\nIf exporting via a HTTP log aggregator, the same can also be seen. (I don't have an example)\r\n\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nPasswords aren't exposed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPasswords are exposed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWe can see in Regular Ansible Core via Debug mode that the provider password isn't exposed:\r\n\r\n```\r\n\r\n[root@host playbook]# ansible-playbook -i 192.168.0.1, eos.yml -vvvv\r\nansible-playbook 2.4.1.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.14 (default, Sep 20 2017, 01:25:59) [GCC 7.2.0]\r\nUsing /etc/ansible/ansible.cfg as config file\r\nsetting up inventory plugins\r\nParsed 192.168.0.1, inventory source with host_list plugin\r\nLoading callback plugin default of type stdout, v2.0 from /usr/lib/python2.7/site-packages/ansible/plugins/callback/__init__.pyc\r\n\r\nPLAYBOOK: eos.yml *****************************************************************************************************************\r\n1 plays in eos.yml\r\n\r\nPLAY [connect to eos] *************************************************************************************************************\r\nMETA: ran handlers\r\n\r\nTASK [run command] ****************************************************************************************************************\r\ntask path: /root/playbook/eos.yml:14\r\n<192.168.0.1> connection transport is cli\r\n<192.168.0.1> using connection plugin network_cli\r\n<192.168.0.1> socket_path: /root/.ansible/pc/2acfec4c5b\r\nUsing module file /usr/lib/python2.7/site-packages/ansible/modules/network/eos/eos_command.py\r\n<192.168.0.1> ESTABLISH LOCAL CONNECTION FOR USER: root\r\n<192.168.0.1> EXEC /bin/sh -c 'echo ~ && sleep 0'\r\n<192.168.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p \"` echo /root/.ansible/tmp/ansible-tmp-1513374225.29-16131039252737 `\" && echo ansible-tmp-1513374225.29-16131039252737=\"` echo /root/.ansible/tmp/ansible-tmp-1513374225.29-16131039252737 `\" ) && sleep 0'\r\n<192.168.0.1> PUT /tmp/tmpfCORxF TO /root/.ansible/tmp/ansible-tmp-1513374225.29-16131039252737/eos_command.py\r\n<192.168.0.1> EXEC /bin/sh -c 'chmod u+x /root/.ansible/tmp/ansible-tmp-1513374225.29-16131039252737/ /root/.ansible/tmp/ansible-tmp-1513374225.29-16131039252737/eos_command.py && sleep 0'\r\n<192.168.0.1> EXEC /bin/sh -c '/usr/bin/python /root/.ansible/tmp/ansible-tmp-1513374225.29-16131039252737/eos_command.py; rm -rf \"/root/.ansible/tmp/ansible-tmp-1513374225.29-16131039252737/\" > /dev/null 2>&1 && sleep 0'\r\nok: [192.168.0.1] => {\r\n    \"changed\": false,\r\n    \"failed\": false,\r\n    \"invocation\": {\r\n        \"module_args\": {\r\n            \"auth_pass\": null,\r\n            \"authorize\": null,\r\n            \"commands\": [\r\n                \"show version\"\r\n            ],\r\n            \"host\": null,\r\n            \"interval\": 1,\r\n            \"match\": \"all\",\r\n            \"password\": \"VALUE_SPECIFIED_IN_NO_LOG_PARAMETER\",\r\n            \"port\": null,\r\n            \"provider\": {\r\n                \"auth_pass\": null,\r\n                \"authorize\": null,\r\n                \"host\": null,\r\n                \"password\": \"VALUE_SPECIFIED_IN_NO_LOG_PARAMETER\",\r\n                \"port\": null,\r\n                \"ssh_keyfile\": null,\r\n                \"timeout\": null,\r\n                \"transport\": \"cli\",\r\n                \"use_ssl\": null,\r\n                \"username\": \"admin\",\r\n                \"validate_certs\": null\r\n            },\r\n            \"retries\": 10,\r\n            \"ssh_keyfile\": null,\r\n            \"timeout\": null,\r\n            \"transport\": \"cli\",\r\n            \"use_ssl\": true,\r\n            \"username\": \"admin\",\r\n            \"validate_certs\": true,\r\n            \"wait_for\": null\r\n        }\r\n    },\r\n    \"stdout\": [\r\n        \"Arista vEOS\\nHardware version:    \\nSerial number:       \\nSystem MAC address:  5254.0055.dae4\\n\\nSoftware image version:         4.16.6M\\nArchitecture:           i386\\nInternal build version: 4.16.6M-3205780.4166M\\nInternal build ID:      e796e94c-ba3b-4355-af        cf-ef0abfbfaee3\\n\\nUptime:                 1 week, 5 days, 21 hours and 37 minutes\\nTotal memory:           1897528 kB\\nFree memory        :            590916 kB\"\r\n    ],\r\n    \"stdout_lines\": [\r\n        [\r\n            \"Arista vEOS\",\r\n            \"Hardware version:    \",\r\n            \"Serial number:       \",\r\n            \"System MAC address:  5254.0055.dae4\",\r\n            \"\",\r\n            \"Software image version: 4.16.6M\",\r\n            \"Architecture:           i386\",\r\n            \"Internal build version: 4.16.6M-3205780.4166M\",\r\n            \"Internal build ID:      e796e94c-ba3b-4355-afcf-ef0abfbfaee3\",\r\n            \"\",\r\n            \"Uptime:                 1 week, 5 days, 21 hours and 37 minutes\",\r\n            \"Total memory:           1897528 kB\",\r\n            \"Free memory:            590916 kB\"\r\n        ]\r\n    ]\r\n}\r\nMETA: ran handlers\r\nMETA: ran handlers\r\n\r\nPLAY RECAP ************************************************************************************************************************\r\n192.168.0.1               : ok=1    changed=0    unreachable=0    failed=0\r\n```\r\n\r\nWe can also see that if you look via at the results in the AWX GUI, the provider password isn't exposed:\r\n\r\n![image](https://user-images.githubusercontent.com/19539695/34063009-6e9f4450-e1e7-11e7-99f0-378d6ea8ff5d.png)\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIf you've got fact caching enabled AWX will ignore custom library paths.\r\n##### ENVIRONMENT\r\n* AWX version: Latest\r\n* AWX install method: Tower Installer\r\n* Ansible version:  2.4.2\r\n* Operating System: RHEL 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a custom module and a non default library path /usr/share/ansible\r\n2. set that as library in ansible.cfg library = /usr/share/ansible\r\n3. create a job template using a playbook that calls that module\r\n4. enable fact caching on job template\r\n5. Run job\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpect that the module is run without an issue.\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nReceive an error\r\n ```ERROR! no action detected in task. This often indicates a misspelled module name, or incorrect module path.```\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\nWorkaround is to add modules to the ANSIBLE_LIBRARY path hard coded inside AWX, disable fact caching option or alter project to house custom modules in library/ adjacent to playbook\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\ninventory sources cannot be scheduled\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1-319\r\n* AWX install method: docker for mac\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPOST to `/api/v2/inventory_sources/N/schedules/`\r\n\r\n```json\r\n{\"name\":\"asdf\",\"rrule\":\"DTSTART:20171104T040000Z RRULE:FREQ=DAILY;INTERVAL=1;COUNT=1\"}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\ncreates schedule\r\n\r\n##### ACTUAL RESULTS\r\n\r\n400\r\n\r\n```json\r\n{\r\n    \"_exclude_errors\": [\r\n        \"Field is not allowed on launch.\"\r\n    ]\r\n}\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI recieve a 500 Server error whenever I visit the schedules page.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1 - installed from commit 1bc2d83\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.4.2.0\r\n* Operating System: Ubuntu 16.04.3 LTS\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nVisit the schedules page or the schedules api route\r\n\r\n##### EXPECTED RESULTS\r\n\r\nGet a valid response from the API\r\n\r\n##### ACTUAL RESULTS\r\n\r\nHTTP 500 Internal Server Error\r\nContent-Type: application/json\r\nVary: Accept\r\n{\r\n    \"detail\": \"A server error has occurred.\"\r\n}\r\n\r\nawx_web log: \r\n`2017-12-12 15:52:34,550 ERROR    django.request Internal Server Error: /api/v2/schedules/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 248, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 42, in list\r\n    page = self.paginate_queryset(queryset)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 319, in paginate_queryset\r\n    page = super(ListAPIView, self).paginate_queryset(queryset)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 173, in paginate_queryset\r\n    return self.paginator.paginate_queryset(queryset, self.request, view=self)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/pagination.py\", line 214, in paginate_queryset\r\n    self.page = paginator.page(page_number)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 57, in page\r\n    number = self.validate_number(number)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 46, in validate_number\r\n    if number > self.num_pages:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/functional.py\", line 35, in __get__\r\n    res = instance.__dict__[self.name] = self.func(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 91, in num_pages\r\n    if self.count == 0 and not self.allow_empty_first_page:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/functional.py\", line 35, in __get__\r\n    res = instance.__dict__[self.name] = self.func(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 79, in count\r\n    return self.object_list.count()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 364, in count\r\n    return self.query.get_count(using=self.db)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/query.py\", line 499, in get_count\r\n    number = obj.get_aggregation(using, ['__count'])['__count']\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/query.py\", line 480, in get_aggregation\r\n    result = compiler.execute_sql(SINGLE)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\", line 894, in execute_sql\r\n    raise original_exception\r\nProgrammingError: more than one row returned by a subquery used as an expression\r\n`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRelatively fresh install, just the schedules page that has the problem. I'm not particularly familiar with python, so I've not debugged anything in detail.\r\n\r\nThis is possibly a duplicate of #796?\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen opening the website I get only text: Internal Server Error\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.3.2.0\r\n* Operating System: RedHat 7.4\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nOpen a website\r\n\r\n##### EXPECTED RESULTS\r\nI expect at least some verbose explanation of what went wrong not just \"error\", <rant>actually I would think programmers in 2017 can do better error message than this...</rant>\r\n\r\n##### ACTUAL RESULTS\r\nJust a nothing-saying error message\r\n\r\n##### ADDITIONAL INFORMATION\r\nIs there any way to get AWX to produce more verbose error messages?\r\n\r\nFrom\r\n```\r\nTEST [root@ansible-test-rhel7 ~]# docker ps\r\nCONTAINER ID        IMAGE                     COMMAND                  CREATED             STATUS                         PORTS                                NAMES\r\nc6fc4305906d        ansible/awx_task:latest   \"/tini -- /bin/sh -c \"   13 days ago         Up 8 seconds                   8052/tcp                             awx_task\r\n2f10d502e530        ansible/awx_web:latest    \"/tini -- /bin/sh -c \"   13 days ago         Up 9 seconds                   0.0.0.0:80->8052/tcp                 awx_web\r\nc835cbc75dae        memcached:alpine          \"docker-entrypoint.sh\"   13 days ago         Up 10 seconds                  11211/tcp                            memcached\r\n7ef2305537c9        rabbitmq:3                \"docker-entrypoint.sh\"   13 days ago         Up 10 seconds                  4369/tcp, 5671-5672/tcp, 25672/tcp   rabbitmq\r\nc954e46025fa        postgres:9.6              \"docker-entrypoint.sh\"   13 days ago         Restarting (1) 3 seconds ago   5432/tcp                             postgres\r\n```\r\n\r\nI am judging that problem is with postgres container? I didn't do anything to it though. It probably started crashing on its own.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nSuccessful inventory updates with verbosity at WARNING will not issue any stdout, and this presents to the user in an undesirable way\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.0 and on\r\n* AWX install method: docker for mac\r\n* Ansible version:  2.4+\r\n* Operating System: Mac\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun a successful inventory import with verbosity set to WARNING\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA message like \"everything you wanted was imported\"\r\n\r\n##### ACTUAL RESULTS\r\n\r\nstdout capture missing\r\n\r\nMessage is unclear, bad UX\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNot yet clear if this will be an API or an UI fix.\r\n\r\nAlso, interesting possibility of a tie-in with #364 \r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nAdd AWX management jobs as options that can be selected as workflow nodes.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThe option of incorporating AWX management jobs into an AWX workflow would enhance the ability to use AWX to automate management of the AWX machine by allowing the coordination f internal and external tasks that may be required.  For example, backups could be triggered in an external database system immediately preceding the automated cleanup of the database.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nhttps://awxhost/api/v2/job_events/?event=playbook_on_task_start&order_by=event_data.task_action\r\n\r\nyields a 500 error.\r\n\r\n```\r\n2017-12-07 18:56:57,133 ERROR    django.request Internal Server Error: /api/v2/job_events/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 132, in get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 145, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 71, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/lib/python2.7/site-packages/awx/api/generics.py\", line 246, in dispatch\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 466, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 463, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 201, in get\r\n    return self.list(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 42, in list\r\n    page = self.paginate_queryset(queryset)\r\n  File \"/lib/python2.7/site-packages/awx/api/generics.py\", line 317, in paginate_queryset\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 172, in paginate_queryset\r\n    return self.paginator.paginate_queryset(queryset, self.request, view=self)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/pagination.py\", line 218, in paginate_queryset\r\n    return list(self.page)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/paginator.py\", line 117, in __len__\r\n    return len(self.object_list)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 144, in __len__\r\n    self._fetch_all()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 965, in _fetch_all\r\n    self._result_cache = list(self.iterator())\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 238, in iterator\r\n    results = compiler.execute_sql()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\", line 840, in execute_sql\r\n    cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\", line 64, in execute\r\n    return self.cursor.execute(sql, params)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 98, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\", line 64, in execute\r\n    return self.cursor.execute(sql, params)\r\nProgrammingError: missing FROM-clause entry for table \"event_data\"\r\nLINE 1: ...event\".\"start_line\", \"main_jobevent\".\"end_line\", (\"event_dat...\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: recent\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nIt is possible through the API to assign READ roles to users/teams for AWX objects, but READ role does not appear in the drop down when selecting roles within the UI. The only available option for READ through the UI is via an org auditor which garners READ for all organization owned objects.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1+"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI realize a POC on AWX and when i use the API v2 i get an error. This error is an internal server error when i attempt to add a tower credential via an Ansible playbook. \r\nI don't have this error on API v1 but i don't have all attributes that i want.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.223\r\n* AWX install method: docker on linux + postgres on standalone mode\r\n* Ansible version:  2.4.1\r\n* Operating System: CentOS 7.4\r\n\r\n##### STEPS TO REPRODUCE\r\n`tasks:\r\n       - name: Create an organization\r\n         tower_organization:\r\n           name: \"Pyxis\"\r\n           description: \"Pyxis organization\"\r\n           state: present\r\n           tower_config_file: \"/etc/tower/tower_cli.cfg\"` \r\n\r\n##### EXPECTED RESULTS\r\nAdd an organization on AWX via Ansible playbook.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n> fatal: [localhost]: FAILED! => {\r\n    \"changed\": false,\r\n    \"failed\": true,\r\n    \"module_stderr\": \"*** DETAILS: Checking for an existing record. *********************************\\nGET http://10.11.176.196 last):\\n  File \\\"/tmp/ansible_X2jOZs/ansible_module_tower_organization.py\\\", line 147, in <module>\\n    main()\\n  File \\\"/tmp/sult = organization.modify(name=name, description=description, create_on_missing=True)\\n  File \\\"/usr/lib/python2.7/site-packageate_on_missing=create_on_missing, force_on_exists=True, **kwargs)\\n  File \\\"/usr/lib/python2.7/site-packages/tower_cli/models/ckages/tower_cli/models/base.py\\\", line 202, in _lookup\\n    existing_data = self.get(include_debug_header=include_debug_headere.py\\\", line 465, in get\\n    response = self.read(pk=pk, fail_on_no_results=True, fail_on_multiple_results=True, **kwargs)\\n   read\\n    r = client.get(url, params=kwargs)\\n  File \\\"/usr/lib/python2.7/site-packages/requests/sessions.py\\\", line 476, in gite-packages/tower_cli/api.py\\\", line 199, in request\\n    raise exc.ServerError('The Tower server sent back a server error. '\\ease try again later.\\n\",\r\n    \"module_stdout\": \"\",\r\n    \"msg\": \"MODULE FAILURE\",\r\n    \"rc\": 0\r\n}\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nOne template from a project playbook with 1 inventory and 2 credentials. If i grant a team Admin permission on this template it cannot be saved: operation not permitted.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.268\r\n* AWX install method: docker swarm\r\n* Ansible version:  2.4.x\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Chromium 63\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Create a project, credentials, inventories\r\n- Create a template from a playbook with credentials and inventories\r\n- Add a team (user?) Admin permission on the template\r\n- Edit the template\r\n- Save\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTemplate is saved when only the template has admin permission for the user.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nError on save: ERROR! Operation not permitted (not exact as it is localized to browser language)\r\n\r\nIn the browser network tab: PUT /api/v2/job_templates/9/ 403 Forbidden\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWhen the user has no permission to dependencies of the template it is visible during the page load: the network page:\r\n    /api/v2/credentials/3/  - 403 Forbidden\r\n\r\nIf I add permission to all credentials/inventories it works. But for credentials teams cannot be granted, only users (but this is another story)"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nSlack notification is not working for job completion (success or failure) but works fine for workflow job \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.234 \r\n* AWX install method: docker on linux, \r\n* Ansible version:  2.4.1.0\r\n* Operating System: Redhat 7\r\n* Web Browser: chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nI created a slack chat bot (not using webhook) following the instruction from https://www.linkedin.com/pulse/slack-chat-bot-ansible-tower-rahul-natarajan/\r\n\r\nI got the token from slack and it into the Slack notification in AWX.  \r\nThe test notificaiton with the bell alarm icon works fine.  However when I associate a job with the slack notificaition, nothing is send to slack when the job completes successful or in error.\r\n\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nI expect a message send to the slack channel defined according to the success/fail setting defined in the job template->notification screen.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nNo message appear in the slack channel configured. \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe job relaunch endpoint has become extremely noisy for no apparent reason.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLaunch a job\r\n\r\nGET `/api/v2/jobs/N/relaunch/`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNice clean output like\r\n\r\n```json\r\n{\r\n    \"passwords_needed_to_start\": [],\r\n    \"retry_counts\": {...}\r\n}\r\n```\r\n\r\nthat's how it was before\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe endpoint contains the full serialization of the job, which is unlike the job template launch, and other similar endpoints.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nProbably related to the recent feature churn (like retry on failed hosts), or upgrade of DRF.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI run a template and sometimes the stdout is empty. I open the stdout link: /api/v2/jobs/192/stdout/?format=txt_download (which is not working, but deleting the format part:) /api/v2/jobs/192/stdout/ and it shows:\r\n\r\n```\r\nHTTP 200 OK\r\nAllow: GET, HEAD, OPTIONS\r\nContent-Type: text/plain ;utf-8\r\nVary: Accept\r\nX-API-Node: awx\r\nX-API-Time: 0.017s\r\n\r\n\r\n\r\nstdout capture is missing\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.203 - 1.0.1.268 (at least)\r\n* AWX install method: docker on linux (docker-compose deployed to docker swarm)\r\n* Ansible version:  2.4.x\r\n* Operating System: Linux (not relevant)\r\n* Web Browser: Chromium 63 (not relevant)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI run playbooks, and after a few runs stdout is always empty. The task is run successfully or with failure as it should.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nStdout is shown every time.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nStdout is empty, downloading stdout shows: \"stdout capture is missing\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIf I restart the awx_tag container (in my case as it is deployed with Swarm: docker kill ...) the problem disappears for some time.\r\n\r\nThis is from the awx_tag output (in case of missing stdout):\r\n\r\n```\r\n...\r\n2017-11-30 10:45:33,575 ERROR    awx.main.commands.run_callback_receiver Detail: Traceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/run_callback_receiver.py\", line 138, in callback_worker\r\n    JobEvent.create_from_data(**body)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/jobs.py\", line 1288, in create_from_data\r\n    job_event = JobEvent.objects.create(**kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\", line 85, in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 394, in create\r\n    obj.save(force_insert=True, using=self.db)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/jobs.py\", line 1230, in save\r\n    updated_fields = self._update_from_event_data()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/jobs.py\", line 1116, in _update_from_event_data\r\n    job = self.job\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/related_descriptors.py\", line 184, in __get__\r\n    rel_obj = self.get_object(instance)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/related_descriptors.py\", line 159, in get_object\r\n    return qs.get(self.field.get_reverse_related_filter(instance))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 374, in get\r\n    num = len(clone)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 232, in __len__\r\n    self._fetch_all()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 1118, in _fetch_all\r\n    self._result_cache = list(self._iterable_class(self))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/polymorphic/query.py\", line 42, in _polymorphic_iterator\r\n    o = next(base_iter)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\", line 53, in __iter__\r\n    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\", line 882, in execute_sql\r\n    cursor = self.connection.cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 254, in cursor\r\n    return self._cursor()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 231, in _cursor\r\n    return self._prepare_cursor(self.create_cursor(name))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 94, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/base/base.py\", line 231, in _cursor\r\n    return self._prepare_cursor(self.create_cursor(name))\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/backends/postgresql/base.py\", line 220, in create_cursor\r\n    cursor = self.connection.cursor()\r\nInterfaceError: connection already closed\r\n\r\n[2017-11-30 10:45:33,855: INFO/MainProcess] Received task: awx.main.tasks.update_inventory_computed_fields[415ee508-ea5d-4438-b01e-d8893c695195]  \r\n[2017-11-30 10:45:33,856: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x398cc80> (args:('awx.main.tasks.update_inventory_computed_fields', '415ee508-ea5d-4438-b01e-d8893c695195', {'origin': 'gen1300@awx', 'lang': 'py', 'task': 'awx.main.tasks.update_inventory_computed_fields', 'group': None, 'root_id': 'e2d017d1-af7e-4055-a2fa-abc9d00b7cc0', u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': None, u'correlation_id': '415ee508-ea5d-4438-b01e-d8893c695195', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '(2, True)', 'eta': None, 'parent_id': 'b9a32fd8-85a0-41f3-913d-18eb131efef8', u'reply_to': '0d3e5470-35b1-31a3-bb7b-2d6394e29252', 'id': '415ee508-ea5d-4438-b01e-d8893c695195', 'kwargsrepr': '{}'}, u'[[2, true], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2017-11-30 10:45:33,857: DEBUG/MainProcess] Task accepted: awx.main.tasks.update_inventory_computed_fields[415ee508-ea5d-4438-b01e-d8893c695195] pid:1465\r\n[2017-11-30 10:45:33,864: INFO/MainProcess] Received task: awx.main.tasks.handle_work_success[da5909e7-b979-4937-b060-9a3ab0524f04]  \r\n[2017-11-30 10:45:33,865: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x398cc80> (args:('awx.main.tasks.handle_work_success', 'da5909e7-b979-4937-b060-9a3ab0524f04', {'origin': 'gen1300@awx', 'lang': 'py', 'task': 'awx.main.tasks.handle_work_success', 'group': None, 'root_id': 'e2d017d1-af7e-4055-a2fa-abc9d00b7cc0', u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': None, u'correlation_id': 'da5909e7-b979-4937-b060-9a3ab0524f04', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '(None,)', 'eta': None, 'parent_id': 'b9a32fd8-85a0-41f3-913d-18eb131efef8', u'reply_to': '0d3e5470-35b1-31a3-bb7b-2d6394e29252', 'id': 'da5909e7-b979-4937-b060-9a3ab0524f04', 'kwargsrepr': \"{'task_actual': {'type': 'job', 'id': 194}}\"}, u'[[null], {\"task_actual\": {\"type\": \"job\", \"id\": 194}}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2017-11-30 10:45:33,871: DEBUG/MainProcess] Task accepted: awx.main.tasks.handle_work_success[da5909e7-b979-4937-b060-9a3ab0524f04] pid:1463\r\n2017-11-30 10:45:33,873 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\n[2017-11-30 10:45:33,873: DEBUG/ForkPoolWorker-378] Going to update inventory computed fields\r\n[2017-11-30 10:45:33,890: INFO/ForkPoolWorker-375] Task awx.main.tasks.run_job[b9a32fd8-85a0-41f3-913d-18eb131efef8] succeeded in 18.663942109s: None\r\n2017-11-30 10:45:33,926 DEBUG    awx.main.models.inventory Finished updating inventory computed fields\r\n[2017-11-30 10:45:33,926: DEBUG/ForkPoolWorker-378] Finished updating inventory computed fields\r\n[2017-11-30 10:45:33,929: DEBUG/ForkPoolWorker-377] Start from server, version: 0.9, properties: {'information': 'Licensed under the MPL.  See http://www.rabbitmq.com/', 'product': 'RabbitMQ', 'copyright': 'Copyright (C) 2007-2017 Pivotal Software, Inc.', 'capabilities': {'exchange_exchange_bindings': True, 'connection.blocked': True, 'authentication_failure_close': True, 'direct_reply_to': True, 'basic.nack': True, 'per_consumer_qos': True, 'consumer_priorities': True, 'consumer_cancel_notify': True, 'publisher_confirms': True}, 'cluster_name': 'rabbit@b3ced9c88a6b', 'platform': 'Erlang/OTP 19.2.1', 'version': '3.6.14'}, mechanisms: ['AMQPLAIN', 'PLAIN'], locales: [u'en_US']\r\n[2017-11-30 10:45:33,931: DEBUG/ForkPoolWorker-377] using channel_id: 1\r\n[2017-11-30 10:45:33,932: DEBUG/ForkPoolWorker-377] Channel open\r\n[2017-11-30 10:45:33,933: INFO/ForkPoolWorker-378] Task awx.main.tasks.update_inventory_computed_fields[415ee508-ea5d-4438-b01e-d8893c695195] succeeded in 0.0754506569992s: None\r\n[2017-11-30 10:45:33,938: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_job_complete[018be77a-9f63-4436-95a1-f017e5b4c404]  \r\n[2017-11-30 10:45:33,938: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x398cc80> (args:('awx.main.scheduler.tasks.run_job_complete', '018be77a-9f63-4436-95a1-f017e5b4c404', {'origin': 'gen1463@awx', 'lang': 'py', 'task': 'awx.main.scheduler.tasks.run_job_complete', 'group': None, 'root_id': 'e2d017d1-af7e-4055-a2fa-abc9d00b7cc0', u'delivery_info': {u'priority': 0, u'redelivered': False, u'routing_key': u'tower_scheduler.job.complete', u'exchange': u'scheduler'}, 'expires': None, u'correlation_id': '018be77a-9f63-4436-95a1-f017e5b4c404', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '(194,)', 'eta': None, 'parent_id': 'da5909e7-b979-4937-b060-9a3ab0524f04', u'reply_to': '2eab75a3-a7dd-31de-b662-b6874d21acf1', 'id': '018be77a-9f63-4436-95a1-f017e5b4c404', 'kwargsrepr': '{}'}, u'[[194], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2017-11-30 10:45:33,942: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_job_complete[018be77a-9f63-4436-95a1-f017e5b4c404] pid:1300\r\n[2017-11-30 10:45:33,944: INFO/ForkPoolWorker-377] Task awx.main.tasks.handle_work_success[da5909e7-b979-4937-b060-9a3ab0524f04] succeeded in 0.0770123319999s: None\r\n2017-11-30 10:45:33,955 DEBUG    awx.main.scheduler Starting Scheduler\r\n2017-11-30 10:45:33,955 DEBUG    awx.main.scheduler Starting Scheduler\r\n[2017-11-30 10:45:33,955: DEBUG/ForkPoolWorker-375] Starting Scheduler\r\n[2017-11-30 10:45:33,978: INFO/ForkPoolWorker-375] Task awx.main.scheduler.tasks.run_job_complete[018be77a-9f63-4436-95a1-f017e5b4c404] succeeded in 0.0385397499995s: None\r\n```\r\n\r\nThe \"connection already closed\" error is not present when the stdout is working - maybe this helps.\r\n\r\nWhen the stdout is lost it is no longer working on any template (including project update/pull) so I think the problem is not because of the template. The missing stdout is not necessary large, it is not a size limit or something.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe AWX server never lets you launch a job with a credential password marked to ASK.\r\n\r\nThis leads to a user expectation that the server doesn't know the passwords in these cases. That is not true. For job relaunch, the previously-inputted passwords remain stored in `start_args`, they are just not used, and the requirement that the user enters the password is arbitrary.\r\n\r\nFor enhanced security, the server should forget credential passwords the user enters.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - create a machine credential, set to ask password on launch\r\n - use in a JT\r\n - launch that JT, provide password \"artemis\"\r\n - wait for job to be successful\r\n\r\n##### EXPECTED RESULTS\r\n\r\nUnable to use the server to retrieve the string \"artemis\", even with full admin privileges.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAdmin can relatively easy obtain it.\r\n\r\n```python\r\nIn [3]: j = Job.objects.order_by('-created').first()\r\n\r\nIn [4]: from awx.main.utils import encryption\r\n\r\nIn [7]: encryption.decrypt_field(j, 'start_args')\r\nOut[7]: '{\"ssh_password\": \"artemis\"}'\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAllow jobs to be named when launching them from a template\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.8\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: rhel-7\r\n* Web Browser: chrome\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nI used to have the ability with api/v1/ to create a job with a given name based off of a template. This allowed me to make jobs with meaningful names (i.e. that contained hostnames or other information). \r\n\r\nNow that I have moved to using api/v2/ it looks as if you can only launch a job based off of a template by targeting **api/v2/job_templates/<id>/launch** which results in a job with the same name of the template. \r\n\r\nIt would be nice to have some way to rename each instance of a job to reflect something a bit more human readable. Either this option exists and I'm doing it wrong, in which case sorry/please point me in the right direction, or can this be considered as a feature. \r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nJob template machine credential shows as an empty dictionary for `credential` in summary fields\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser: Chome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - create a job template\r\n - associate a machine credential with the job template\r\n - view the list view of all job templates or all unified job templates\r\n\r\n##### EXPECTED RESULTS\r\n\r\nunclear, either no credential in summary_fields, or summary field data\r\n\r\n##### ACTUAL RESULTS\r\n\r\nempty entry for `credential`.\r\n\r\nexample, looking at `/api/v2/job_templates/?id=34`:\r\n\r\n```json\r\n{\r\n    \"count\": 1,\r\n    \"next\": null,\r\n    \"previous\": null,\r\n    \"results\": [\r\n        {\r\n            \"id\": 34,\r\n            \"type\": \"job_template\",\r\n            \"url\": \"/api/v2/job_templates/34/\",\r\n            \"related\": {\r\n                \"created_by\": \"/api/v2/users/1/\",\r\n                \"modified_by\": \"/api/v2/users/1/\",\r\n                \"labels\": \"/api/v2/job_templates/34/labels/\",\r\n                \"inventory\": \"/api/v2/inventories/7/\",\r\n                \"project\": \"/api/v2/projects/29/\",\r\n                \"credential\": \"/api/v2/credentials/13/\",\r\n                \"extra_credentials\": \"/api/v2/job_templates/34/extra_credentials/\",\r\n                \"credentials\": \"/api/v2/job_templates/34/credentials/\",\r\n                \"notification_templates_error\": \"/api/v2/job_templates/34/notification_templates_error/\",\r\n                \"notification_templates_success\": \"/api/v2/job_templates/34/notification_templates_success/\",\r\n                \"jobs\": \"/api/v2/job_templates/34/jobs/\",\r\n                \"object_roles\": \"/api/v2/job_templates/34/object_roles/\",\r\n                \"notification_templates_any\": \"/api/v2/job_templates/34/notification_templates_any/\",\r\n                \"access_list\": \"/api/v2/job_templates/34/access_list/\",\r\n                \"launch\": \"/api/v2/job_templates/34/launch/\",\r\n                \"instance_groups\": \"/api/v2/job_templates/34/instance_groups/\",\r\n                \"schedules\": \"/api/v2/job_templates/34/schedules/\",\r\n                \"activity_stream\": \"/api/v2/job_templates/34/activity_stream/\",\r\n                \"survey_spec\": \"/api/v2/job_templates/34/survey_spec/\"\r\n            },\r\n            \"summary_fields\": {\r\n                \"inventory\": {\r\n                    \"id\": 7,\r\n                    \"name\": \"localhost\",\r\n                    \"description\": \"created by Alans cloud scripts\",\r\n                    \"has_active_failures\": false,\r\n                    \"total_hosts\": 1,\r\n                    \"hosts_with_active_failures\": 0,\r\n                    \"total_groups\": 0,\r\n                    \"groups_with_active_failures\": 0,\r\n                    \"has_inventory_sources\": false,\r\n                    \"total_inventory_sources\": 0,\r\n                    \"inventory_sources_with_failures\": 0,\r\n                    \"organization_id\": 1,\r\n                    \"kind\": \"\"\r\n                },\r\n                \"credential\": {},\r\n                \"project\": {\r\n                    \"id\": 29,\r\n                    \"name\": \"sample_playbooks\",\r\n                    \"description\": \"\",\r\n                    \"status\": \"successful\",\r\n                    \"scm_type\": \"git\"\r\n                },\r\n                \"created_by\": {\r\n                    \"id\": 1,\r\n                    \"username\": \"admin\",\r\n                    \"first_name\": \"\",\r\n                    \"last_name\": \"\"\r\n                },\r\n                \"modified_by\": {\r\n                    \"id\": 1,\r\n                    \"username\": \"admin\",\r\n                    \"first_name\": \"\",\r\n                    \"last_name\": \"\"\r\n                },\r\n                \"object_roles\": {\r\n                    \"admin_role\": {\r\n                        \"id\": 241,\r\n                        \"description\": \"Can manage all aspects of the job template\",\r\n                        \"name\": \"Admin\"\r\n                    },\r\n                    \"execute_role\": {\r\n                        \"id\": 240,\r\n                        \"description\": \"May run the job template\",\r\n                        \"name\": \"Execute\"\r\n                    },\r\n                    \"read_role\": {\r\n                        \"id\": 239,\r\n                        \"description\": \"May view settings for the job template\",\r\n                        \"name\": \"Read\"\r\n                    }\r\n                },\r\n                \"user_capabilities\": {\r\n                    \"edit\": true,\r\n                    \"start\": true,\r\n                    \"copy\": true,\r\n                    \"schedule\": true,\r\n                    \"delete\": true\r\n                },\r\n                \"labels\": {\r\n                    \"count\": 0,\r\n                    \"results\": []\r\n                },\r\n                \"recent_jobs\": []\r\n            },\r\n            \"created\": \"2017-11-17T18:47:39.395073Z\",\r\n            \"modified\": \"2017-11-17T18:47:40.467277Z\",\r\n            \"name\": \"Hello World\",\r\n            \"description\": \"echo statement\",\r\n            \"job_type\": \"run\",\r\n            \"inventory\": 7,\r\n            \"project\": 29,\r\n            \"playbook\": \"helloworld.yml\",\r\n            \"forks\": 0,\r\n            \"limit\": \"\",\r\n            \"verbosity\": 0,\r\n            \"extra_vars\": \"\",\r\n            \"job_tags\": \"\",\r\n            \"force_handlers\": false,\r\n            \"skip_tags\": \"\",\r\n            \"start_at_task\": \"\",\r\n            \"timeout\": 0,\r\n            \"use_fact_cache\": false,\r\n            \"last_job_run\": null,\r\n            \"last_job_failed\": false,\r\n            \"next_job_run\": null,\r\n            \"status\": \"never updated\",\r\n            \"host_config_key\": \"\",\r\n            \"ask_diff_mode_on_launch\": false,\r\n            \"ask_variables_on_launch\": false,\r\n            \"ask_limit_on_launch\": false,\r\n            \"ask_tags_on_launch\": false,\r\n            \"ask_skip_tags_on_launch\": false,\r\n            \"ask_job_type_on_launch\": false,\r\n            \"ask_verbosity_on_launch\": false,\r\n            \"ask_inventory_on_launch\": false,\r\n            \"ask_credential_on_launch\": false,\r\n            \"survey_enabled\": false,\r\n            \"become_enabled\": false,\r\n            \"diff_mode\": false,\r\n            \"allow_simultaneous\": false,\r\n            \"credential\": 13,\r\n            \"vault_credential\": null\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nWhen user AWX without HTTPS (plain HTTP), logging in with the GitHub OAuth button fails.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.229\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1.0\r\n* Operating System: debian stretch\r\n* Web Browser: firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Setup AWX, access through port 80 (default)\r\n* Setup GitHub Org auth (but really, it's the same with any Social Auth plugin)\r\n* Log in using the social auth\r\n\r\n##### EXPECTED RESULTS\r\n\r\nYou're logged-in\r\n\r\n##### ACTUAL RESULTS\r\n\r\nYou're not.\r\nawx_web has a log saying :\r\n```\r\n2017-11-28 17:57:48,299 ERROR    social Session value state missing.\r\n```\r\non the `GET /sso/complete/github-org/` call.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThe session to persist the `state` parameter between the initial and the `complete` view of the oauth dance is defined by:\r\nhttps://github.com/ansible/awx/blob/9ed2a0da8f4883a7d6311de2958a01e70605b062/awx/settings/defaults.py#L492\r\n\r\nWhich uses the default Django session store, which uses a secure cookie due to\r\nhttps://github.com/ansible/awx/blob/9ed2a0da8f4883a7d6311de2958a01e70605b062/awx/settings/defaults.py#L188\r\n\r\nSo, if we're not using HTTPS, the cookie will not be sent on the second call, so the session will not be retrieved, the `state` value is absent and the oauth dance fails.\r\n\r\n##### WORK AROUND\r\n\r\nI guess either use HTTPS or override the SESSION_COOKIE_SECURE to False."},{"labels":["api",null],"text":"\r\n![awx_tower_error](https://user-images.githubusercontent.com/34062219/33321663-8443713e-d457-11e7-9e44-4e63609ebcd3.png)\r\n##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Getting HTTP code 500 error when trying to get inventory source sync status while logged in as any user other then global system administartor (default admin)-->\r\nGetting HTTP code 500 error when trying to get inventory source sync status while logged in as any user other then global system administartor (default admin)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.225\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1.0-1.el7\r\n* Operating System: Red Hat Enterprise Linux Server release 7.4 (Maipo)\r\n* Web Browser: Google Chrome Version 62.0.3202.94 (Official Build) (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- 1. Log in as any user without system administrator privileges.  -->\r\n1. Create a user and give him admin privileges on projects and inventory, organisation and all other elements. The user MUST not have a \"system administrator\" role.\r\n2. Log in as any user without system administrator privileges.\r\n3. Create a git project and an inventory sourced from that project and syncronize that source using \"2 round arrows\" from a toolbox to the right.\r\n4. Give the user all privileges on the project and inventory.\r\n5. After all press \"green cloud\" in front of inventory source object and request the URL  /#/inventory_sync/1219\r\n\r\nObserve the error message similar to one from a picture attached to this issue.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nExpected that a screen with syncronization job status in a left part of the screen and ansible output in a right part of the screen should appear as it do when the user has system administrator privileges (default admin)\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nIn the same time we have the following error in awx_web docker container log:\r\n\r\nHOSTIP - - [28/Nov/2017:13:08:21 +0000] \"GET /api/v2/config/ HTTP/1.1\" 200 506 \"http://HOSTNAME:PORT/\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\" \"-\"\r\n2017-11-28 13:08:22,116 ERROR    django.request Internal Server Error: /api/v2/inventory_updates/1219/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 248, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 210, in get\r\n    return self.retrieve(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 56, in retrieve\r\n    instance = self.get_object()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 101, in get_object\r\n    self.check_object_permissions(self.request, obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 339, in check_object_permissions\r\n    if not permission.has_object_permission(request, self, obj):\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 137, in has_object_permission\r\n    return self.has_permission(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 128, in has_permission\r\n    response = self.check_permissions(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 117, in check_permissions\r\n    result = check_method and check_method(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 43, in check_get_permissions\r\n    return check_user_access(request.user, view.model, 'read', obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 116, in check_user_access\r\n    result = access_method(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 216, in can_read\r\n    return bool(obj and self.get_queryset().filter(pk=obj.pk).exists())\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 200, in get_queryset\r\n    qs = self.filtered_queryset()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 886, in filtered_queryset\r\n    return qs.filter(inventory_source__inventory__in=Inventory.accessible_pk_qs(self.user, 'read_role'))\r\nNameError: global name 'qs' is not defined\r\n2017-11-28 13:08:22,116 ERROR    django.request Internal Server Error: /api/v2/inventory_updates/1219/\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/exception.py\", line 41, in inner\r\n    response = get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 249, in _legacy_get_response\r\n    response = self._get_response(request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 187, in _get_response\r\n    response = self.process_exception_by_middleware(e, request)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 185, in _get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 185, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 68, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/generics.py\", line 248, in dispatch\r\n    return super(APIView, self).dispatch(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 489, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 449, in handle_exception\r\n    self.raise_uncaught_exception(exc)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 486, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 210, in get\r\n    return self.retrieve(request, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 56, in retrieve\r\n    instance = self.get_object()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 101, in get_object\r\n    self.check_object_permissions(self.request, obj)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 339, in check_object_permissions\r\n    if not permission.has_object_permission(request, self, obj):\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 137, in has_object_permission\r\n    return self.has_permission(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 128, in has_permission\r\n    response = self.check_permissions(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 117, in check_permissions\r\n    result = check_method and check_method(request, view, obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/permissions.py\", line 43, in check_get_permissions\r\n    return check_user_access(request.user, view.model, 'read', obj)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 116, in check_user_access\r\n    result = access_method(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 216, in can_read\r\n    return bool(obj and self.get_queryset().filter(pk=obj.pk).exists())\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 200, in get_queryset\r\n    qs = self.filtered_queryset()\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/access.py\", line 886, in filtered_queryset\r\n    return qs.filter(inventory_source__inventory__in=Inventory.accessible_pk_qs(self.user, 'read_role'))\r\nNameError: global name 'qs' is not defined\r\n[pid: 29|app: 0|req: 16/37] HOSTIP () {46 vars in 2488 bytes} [Tue Nov 28 13:08:22 2017] GET /api/v2/inventory_updates/1219/ => generated 41 bytes in 49 msecs (HTTP/1.1 500) 5 headers in 177 bytes (1 switches on core 0)\r\nHOSTIP - - [28/Nov/2017:13:08:22 +0000] \"GET /api/v2/inventory_updates/1219/ HTTP/1.1\" 500 41 \"http://HOSTNAME:PORT/\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\" \"-\"\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n \r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI am not able to use the registered task value when executed playbook using isolated node functionality.\r\n##### ENVIRONMENT\r\n* AWX version: 3.4.1\r\n* AWX install method:  docker on linux,\r\n* Ansible version:  2.4\r\n* Operating System: Oracle Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n---\r\n- hosts: all\r\n  connection: local\r\n\r\n  tasks:\r\n\r\n    - name: Include user credentials\r\n      include_vars:\r\n       dir: 'vars'\r\n       files_matching: \"{{ inventory_hostname}}.yml\"\r\n\r\n\r\n    - name: Check Configure Extended access list\r\n      tags:\r\n           - acl\r\n      ios_config:\r\n        provider: \"{{ cli_n }}\"\r\n        match: exact\r\n        parents:\r\n             - ip access-list extended ABC\r\n        lines:\r\n             - permit tcp 192.168.102.0 0.0.0.255 any eq www\r\n           \r\n        before: \"no ip access-list extended ABC\"\r\n      check_mode: yes\r\n      register: Result_A\r\n\r\n    - debug:\r\n        msg: \"{{ Result_A }}\"\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nRegistered variable key value pair.\r\n##### ACTUAL RESULTS\r\nTASK [debug] *******************************************************************17:17:25\r\n83\r\nok: [10.1.2.2] => {\r\n\r\n    \"msg\": \"Hello world!\"\r\n\r\n}\r\n<!-- For bug reports, what actually happened? -->\r\nRegistered variable value not retrieved when running playbook on ISOLATED instance..\r\n##### ADDITIONAL INFORMATION\r\nIt works fine with Normal instance. i.e. using Tower/controller node.\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nCannot send slack notifications or use the slack ansible module in playbooks. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.231\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1.0\r\n* Operating System: Ubuntu\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nSimply create a slack channel, create a webhook integration, and attempt to use it as a notification, or create a playbook with a slack module and try to run it. It works just fine when running the playbook via the host machine, but it never completes from within the docker container.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBoth the notification test from within the AWX ui and the playbook with a slack module task should work.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe notification test failed. The playbook with the slack module task failed. The playbook succeeded using \"ansible-playbook\" command on the host machine, with a \"delegate_to: localhost.\"\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCanceling a job results in an activity stream entry for its related job template, although the user was not editing the JT.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLaunch a job template. Cancel the job it spawns. Inspect activity stream for job templates.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNo entry.\r\n\r\nMaybe a related entry for the job model?\r\n\r\n##### ACTUAL RESULTS\r\n\r\nGot this entry in the UI by user \"System\":\r\n\r\n```json\r\n{\r\n \"current_job\": [\r\n  \"2017-11-21 20:20:39.540844+00:00-74-successful\",\r\n  null\r\n ],\r\n \"last_job\": [\r\n  \"2017-11-21 20:11:50.543293+00:00-50-canceled\",\r\n  \"2017-11-21 20:20:39.540844+00:00-74-successful\"\r\n ],\r\n \"last_job_failed\": [\r\n  true,\r\n  false\r\n ],\r\n \"last_job_run\": [\r\n  \"2017-11-22 01:53:54.496975+00:00\",\r\n  \"2017-11-22 01:54:22.307195+00:00\"\r\n ],\r\n \"status\": [\r\n  \"running\",\r\n  \"successful\"\r\n ]\r\n}\r\n```\r\n\r\nIn the API:\r\n\r\nhttps://gist.github.com/AlanCoding/48ea62f3b7293fb102b45086843f9ef0\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nN/A\r\n"},{"labels":["api",null,null],"text":"The library `python-ldap` has fixed a bug that blocked us from upgrading pytest here:\r\n\r\nhttps://github.com/python-ldap/python-ldap/pull/35\r\n\r\nWhen that is released, we can upgrade pytest to >3.0."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nWhile  deleting an ec2 inventory source the following was observed:\r\n\r\n```\r\nawx_1        | 19:02:17 uwsgi.1     | 2017-11-14 19:02:17,163 ERROR    django.request Internal Server Error: /api/v2/inventory_sources/22/hosts/\r\nawx_1        | 19:02:17 uwsgi.1     | Traceback (most recent call last):\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/core/handlers/base.py\", line 132, in get_response\r\nawx_1        | 19:02:17 uwsgi.1     |     response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/utils/decorators.py\", line 145, in inner\r\nawx_1        | 19:02:17 uwsgi.1     |     return func(*args, **kwargs)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/views/decorators/csrf.py\", line 58, in wrapped_view\r\nawx_1        | 19:02:17 uwsgi.1     |     return view_func(*args, **kwargs)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/views/generic/base.py\", line 71, in view\r\nawx_1        | 19:02:17 uwsgi.1     |     return self.dispatch(request, *args, **kwargs)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"./awx/api/generics.py\", line 246, in dispatch\r\nawx_1        | 19:02:17 uwsgi.1     |     return super(APIView, self).dispatch(request, *args, **kwargs)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 466, in dispatch\r\nawx_1        | 19:02:17 uwsgi.1     |     response = self.handle_exception(exc)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/views.py\", line 463, in dispatch\r\nawx_1        | 19:02:17 uwsgi.1     |     response = handler(request, *args, **kwargs)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/generics.py\", line 220, in delete\r\nawx_1        | 19:02:17 uwsgi.1     |     return self.destroy(request, *args, **kwargs)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"./awx/api/generics.py\", line 466, in destroy\r\nawx_1        | 19:02:17 uwsgi.1     |     self.perform_list_destroy(instance_list)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"./awx/api/generics.py\", line 476, in perform_list_destroy\r\nawx_1        | 19:02:17 uwsgi.1     |     self.perform_destroy(instance, check_permission=False)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"./awx/api/generics.py\", line 452, in perform_destroy\r\nawx_1        | 19:02:17 uwsgi.1     |     super(DestroyAPIView, self).perform_destroy(instance)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/rest_framework/mixins.py\", line 91, in perform_destroy\r\nawx_1        | 19:02:17 uwsgi.1     |     instance.delete()\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"./awx/main/models/inventory.py\", line 604, in delete\r\nawx_1        | 19:02:17 uwsgi.1     |     super(Host, self).delete(*args, **kwargs)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\", line 896, in delete\r\nawx_1        | 19:02:17 uwsgi.1     |     collector.delete()\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/deletion.py\", line 309, in delete\r\nawx_1        | 19:02:17 uwsgi.1     |     query.delete_batch(pk_list, self.using)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/sql/subqueries.py\", line 41, in delete_batch\r\nawx_1        | 19:02:17 uwsgi.1     |     self.do_query(self.get_meta().db_table, self.where, using=using)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/sql/subqueries.py\", line 26, in do_query\r\nawx_1        | 19:02:17 uwsgi.1     |     self.get_compiler(using).execute_sql(NO_RESULTS)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\", line 840, in execute_sql\r\nawx_1        | 19:02:17 uwsgi.1     |     cursor.execute(sql, params)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\", line 79, in execute\r\nawx_1        | 19:02:17 uwsgi.1     |     return super(CursorDebugWrapper, self).execute(sql, params)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\", line 64, in execute\r\nawx_1        | 19:02:17 uwsgi.1     |     return self.cursor.execute(sql, params)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/utils.py\", line 98, in __exit__\r\nawx_1        | 19:02:17 uwsgi.1     |     six.reraise(dj_exc_type, dj_exc_value, traceback)\r\nawx_1        | 19:02:17 uwsgi.1     |   File \"/venv/awx/lib/python2.7/site-packages/django/db/backends/utils.py\", line 64, in execute\r\nawx_1        | 19:02:17 uwsgi.1     |     return self.cursor.execute(sql, params)\r\nawx_1        | 19:02:17 uwsgi.1     | OperationalError: deadlock detected\r\nawx_1        | 19:02:17 uwsgi.1     | DETAIL:  Process 2534 waits for ShareLock on transaction 24363; blocked by process 2535.\r\nawx_1        | 19:02:17 uwsgi.1     | Process 2535 waits for ShareLock on transaction 24358; blocked by process 2534.\r\nawx_1        | 19:02:17 uwsgi.1     | HINT:  See server log for query details.\r\nawx_1        | 19:02:17 uwsgi.1     | CONTEXT:  while deleting tuple (0,74) in relation \"main_group_hosts\"\r\n```\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2.2\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1) Create and sync an ec2 inventory source\r\n2) Send delete requests to the inventory source's related hosts and groups endpoints.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSuccessful, performant deletion.\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n500 error and no hosts deleted.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAfter SAML configured, got 502 from django on metadata page.\r\nSeems like it cant find saml backend.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.1.229\r\n* AWX install method: docker for linux\r\n* Ansible version: 2.4.1.0\r\n* Operating System: centos7-core 3.10.0-327.22.2.el7.x86_64\r\n* Web Browser: Firefox 56.0 / Chromium 62.0 (Linux Mint)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nClean install, with only saml auth configured.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nCorrect metadata.xml file\r\n\r\n##### ACTUAL RESULTS\r\n<!-- For bug reports, what actually happened? -->\r\n502 bad gateway, \r\nin awx_web logs:\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/social_core/backends/utils.py\", line 57, in get_backend\r\n    raise MissingBackend(name)\r\nMissingBackend: Missing backend \"saml\" entry\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nI've done 2 setups, first was with reverse proxy for https and ssl termination, the second one (after 1st try with saml failed) was clean install, with just SAML auth configured, but result was the same, even with empty config.\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n- API\r\n\r\n##### SUMMARY\r\nEnd Date & Time in a Schedule is incorrectly inserted into the database as UTC without timezone conversion, which puts the schedule end date/time at a different time than intended.\r\n\r\nOur current workaround is to specify the date/time already converted to UTC, i.e.:\r\n\r\nBug:\r\n\r\nStart date: 11/21/17 - 12:00:00 CST\r\nEnd date: 11/23/17 - 12:00:00 CST <---- this end date/time will actually be 06:00:00 CST in the DB\r\n\r\nWorkaround:\r\n\r\nStart date: 11/21/17 - 12:00:00 CST\r\nEnd date: 11/23/17 - 18:00:00 UTC <---- this end date/time will actually be 12:00:00 CST in the DB\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.223\r\n* AWX install method: official image\r\n* Ansible version:  2.4.1\r\n* Operating System: Centos 7.6\r\n* Web Browser: Chrome/Safari\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nIn Schedules:\r\n\r\n1. Set a non-UTC local time zone\r\n2. Specify an end date & time\r\n3. Save Schedule\r\n4. Look at the DB row or refresh the UI, the time will now show an incorrect time.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nEnd date & time should be in local time, and should be inserted into the DB with time zone conversion.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nEnd time is inserted directly as UTC with no time zone conversion (workaround pictured)\r\n\r\n<img width=\"1333\" alt=\"screen shot 2017-11-24 at 2 40 35 pm\" src=\"https://user-images.githubusercontent.com/2091431/33223521-ea104314-d125-11e7-99c3-1c525d43a477.png\">\r\n\r\n<img width=\"612\" alt=\"screen shot 2017-11-24 at 2 42 45 pm\" src=\"https://user-images.githubusercontent.com/2091431/33223536-0bb8a9b6-d126-11e7-84f0-a19ca1130b93.png\">\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCloudForms inventory import fails with django.core.exceptions.ValidationError. Have tried with both a \"normal\" Cloudforms user credential and an \"admin\" one but same result both times.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.225 \r\n* AWX install method: docker for mac\r\n* Ansible version:  2.4.1\r\n* Operating System: MacOS 10.12.6\r\n* Web Browser: Chrome 62\r\n* Cloudforms: 4.2 (Management engine Version 5.7.3.2.20170621144854_6c833cc)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n1. Create new inventory source with source type of Red Hat Cloudforms\r\n2. Run sync\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n* Inventory import successfully completes.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n* Inventory import fails with \"django.core.exceptions.ValidationError: [u\\\"'<object object at 0x7830fe0>' value must be either True or False.\\\"]\" error\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nLog file:\r\n```\r\n2017-11-23 01:44:04,433 INFO     awx.main.commands.inventory_import Updating inventory 2: CF\r\n2017-11-23 01:44:04,472 INFO     awx.main.commands.inventory_import Reading Ansible inventory source: /usr/lib/python2.7/site-packages/awx/plugins/inventory/cloudforms.py\r\n2017-11-23 01:44:34,698 INFO     awx.main.commands.inventory_import Processing JSON output...\r\n2017-11-23 01:44:34,720 INFO     awx.main.commands.inventory_import Loaded 322 groups, 266 hosts\r\n...\r\n2017-11-23 01:44:34,739 WARNING  awx.main.commands.inventory_import Host \\\"<redacted1>\\\" has no \\\"id\\\" variable\r\n2017-11-23 01:44:34,739 WARNING  awx.main.commands.inventory_import Host \\\"<redacted2>\\\" has no \\\"id\\\" variable\r\n2017-11-23 01:44:34,739 WARNING  awx.main.commands.inventory_import Host \\\"<redacted3>\\\" has no \\\"id\\\" variable\r\n...\r\n2017-11-23 01:44:38,254 INFO     awx.main.commands.inventory_import Group \\\"<redacted4>_ovf\\\" added\r\n2017-11-23 01:44:38,261 INFO     awx.main.commands.inventory_import Group \\\"<redacted5>_ovf\\\" added\r\n2017-11-23 01:44:38,269 INFO     awx.main.commands.inventory_import Group \\\"location\\\" added\r\n2017-11-23 01:44:38,276 INFO     awx.main.commands.inventory_import Group \\\"redhat\\\" added\r\n2017-11-23 01:44:38,283 INFO     awx.main.commands.inventory_import Group \\\"tags\\\" added\r\n2017-11-23 01:44:38,290 INFO     awx.main.commands.inventory_import Group \\\"type\\\" added\r\n2017-11-23 01:44:38,298 INFO     awx.main.commands.inventory_import Group \\\"vendor\\\" added\r\nTraceback (most recent call last):\r\n  File \\\"/usr/bin/awx-manage\\\", line 9, in <module>\r\n    load_entry_point('awx==1.0.1.225', 'console_scripts', 'awx-manage')()\r\n  File \\\"/usr/lib/python2.7/site-packages/awx/__init__.py\\\", line 109, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\\\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\\\", line 356, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\\\", line 283, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\\\", line 330, in execute\r\n    output = self.handle(*args, **options)\r\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\\\", line 1020, in handle\r\n    self.load_into_database()\r\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\\\", line 892, in load_into_database\r\n    self._create_update_hosts()\r\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\\\", line 798, in _create_update_hosts\r\n    db_host = self.inventory.hosts.update_or_create(name=mem_host_name, defaults=host_attrs)[0]\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/related_descriptors.py\\\", line 665, in update_or_create\r\n    return super(RelatedManager, self.db_manager(db)).update_or_create(**kwargs)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\\\", line 85, in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\\\", line 482, in update_or_create\r\n    obj, created = self._create_object_from_params(lookup, params)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\\\", line 498, in _create_object_from_params\r\n    obj = self.create(**params)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\\\", line 394, in create\r\n    obj.save(force_insert=True, using=self.db)\r\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\\\", line 665, in save\r\n    super(Host, self).save(*args, **kwargs)\r\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/models/base.py\\\", line 264, in save\r\n    super(PrimordialModel, self).save(*args, **kwargs)\r\n  File \\\"/usr/lib/python2.7/site-packages/awx/main/models/base.py\\\", line 159, in save\r\n    super(CreatedModifiedModel, self).save(*args, **kwargs)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\\\", line 808, in save\r\n    force_update=force_update, update_fields=update_fields)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\\\", line 838, in save_base\r\n    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\\\", line 924, in _save_table\r\n    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/base.py\\\", line 963, in _do_insert\r\n    using=using, raw=raw)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/manager.py\\\", line 85, in manager_method\r\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/query.py\\\", line 1076, in _insert\r\n    return query.get_compiler(using=using).execute_sql(return_id)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\\\", line 1106, in execute_sql\r\n    for sql, params in self.as_sql():\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\\\", line 1059, in as_sql\r\n    for obj in self.query.objs\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/sql/compiler.py\\\", line 998, in prepare_value\r\n    value = field.get_db_prep_save(value, connection=self.connection)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/__init__.py\\\", line 770, in get_db_prep_save\r\n    prepared=False)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/__init__.py\\\", line 762, in get_db_prep_value\r\n    value = self.get_prep_value(value)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/__init__.py\\\", line 1043, in get_prep_value\r\n    return self.to_python(value)\r\n  File \\\"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/db/models/fields/__init__.py\\\", line 1036, in to_python\r\n    params={'value': value},\r\ndjango.core.exceptions.ValidationError: [u\\\"'<object object at 0x6aa0f40>' value must be either True or False.\\\"]\r\n```"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nI'd like to attach superuser role to two groups, AWX interface will allow saving such configuration, but it silently ignores the second group provided. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.111\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: \r\n* Web Browser: \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI'm setting is_superuser flag for two groups (Admins and Superadmins in example bellow)\r\n\r\n```json\r\n{\r\n \"is_superuser\": [\r\n \t\"CN=Admins,OU=Groups,DC=example,DC=com\",\r\n        \"CN=Superadmins,OU=Groups,DC=example,DC=com\"\r\n ]\r\n}\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nConfiguration is saved as provided, users from either group can log in and will be superusers.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nWhen I provide such configuration in the admin interface, AWX will accept the configuration, but when visiting the settings again, it will show configuration reduced to a version, that's using just the first group:\r\n\r\n```json\r\n{\r\n \"is_superuser\": \"CN=Admins,OU=Groups,DC=example,DC=com\"\r\n}\r\n```\r\n\r\nAlso only the \"Admins\" group users will get superuser rights upon logging in.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis can be obviously worked around by creating a group in LDAP, that will contain both groups, but sometimes that might be impractical from organization perspective. At least, AWX should warn about such configuration and fail to save it.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf an instance in an instance group is at or over capacity, but the instance group is not over capacity, that instance can still get more jobs and, when the capacity is exceeded, the percentage will become negative for the instance.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLaunch several jobs against a particular instance group, such that the capacity of a particular instance is exceeded.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe instance that is at capacity would not be assigned additional work, but work would rather be assigned to the node on which capacity remains\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe work may be assigned to the instance that is at or above capacity.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nAWX task and was stop working after restart container with RabbitMQ\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.167\r\n* AWX install method: docker on linux\r\n* Web Browser: FireFox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nJust restart container with RabbitMQ. Web and Task containers will lost connection.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nContinue working.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIn Web showing pending status for jobs."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nuri module will output the password argument in plaintext to the event_data.task_args field within the job_events list\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.50\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Red Hat Enterprise Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nexamine the job_events list for any job that includes a uri task with a password\r\n\r\n##### EXPECTED RESULTS\r\n\r\nblanked out password similar to how vault passwords are handled within job_events\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\"event_data\": {\r\n                \"play_pattern\": \"linux\",\r\n                \"play\": \"Generate oAuth Token\",\r\n                \"event_loop\": null,\r\n                \"task_args\": \"body=username=username&password=password\"\r\n\r\n*username and password have been substituted"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThis is an old issue, ~Tower 3.0, moving this to AWX. \r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun the following integration test ...\r\n\r\n```\r\ntests/api/test_jobs.py::Test_Update_On_Launch::test_inventory[aws] PASSED\r\ntests/api/test_jobs.py::Test_Update_On_Launch::test_inventory[aws] ERROR\r\n__________________________________________________________ ERROR at teardown of Test_Update_On_Launch.test_inventory[aws] ___________________________________________________________\r\nTraceback (most recent call last):\r\n  File \"/Users/jlaska/Projects/tower-qa.git/tests/lib/common/api/pages/base.py\", line 162, in delete\r\n    return self.handle_request(r)\r\n  File \"/Users/jlaska/Projects/tower-qa.git/tests/lib/common/api/pages/base.py\", line 132, in handle_request\r\n    raise common.exceptions.InternalServerError_Exception(exc_str, data)\r\nInternalServerError_Exception: ('Internal Server Error (500) received', {})\r\n```\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\n2015-06-20 13:54:42,853 ERROR    django.request Internal Server Error: /api/v1/groups/3631/\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python2.7/site-packages/django/core/handlers/base.py\", line 112, in get_response\r\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\r\n  File \"/usr/lib64/python2.7/site-packages/django/db/transaction.py\", line 371, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/usr/lib64/python2.7/site-packages/django/views/generic/base.py\", line 69, in view\r\n    return self.dispatch(request, *args, **kwargs)\r\n  File \"/usr/lib64/python2.7/site-packages/django/views/decorators/csrf.py\", line 57, in wrapped_view\r\n    return view_func(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/lib/site-packages/rest_framework/views.py\", line 400, in dispatch\r\n    response = self.handle_exception(exc)\r\n  File \"/usr/lib/python2.7/site-packages/awx/lib/site-packages/rest_framework/views.py\", line 397, in dispatch\r\n    response = handler(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/lib/site-packages/rest_framework/generics.py\", line 497, in delete\r\n    return self.destroy(request, *args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/api/views.py\", line 1399, in destroy\r\n  File \"/usr/lib64/python2.7/site-packages/django/db/transaction.py\", line 371, in inner\r\n    return func(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\", line 593, in mark_inactive_recursive\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/models/inventory.py\", line 586, in mark_actual\r\n  File \"/usr/lib64/python2.7/site-packages/django/db/models/query.py\", line 493, in update\r\n    rows = query.get_compiler(self.db).execute_sql(None)\r\n  File \"/usr/lib64/python2.7/site-packages/django/db/models/sql/compiler.py\", line 980, in execute_sql\r\n    cursor = super(SQLUpdateCompiler, self).execute_sql(result_type)\r\n  File \"/usr/lib64/python2.7/site-packages/django/db/models/sql/compiler.py\", line 786, in execute_sql\r\n    cursor.execute(sql, params)\r\n  File \"/usr/lib64/python2.7/site-packages/django/db/backends/util.py\", line 53, in execute\r\n    return self.cursor.execute(sql, params)\r\n  File \"/usr/lib64/python2.7/site-packages/django/db/utils.py\", line 99, in __exit__\r\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\r\n  File \"/usr/lib64/python2.7/site-packages/django/db/backends/util.py\", line 53, in execute\r\n    return self.cursor.execute(sql, params)\r\nOperationalError: deadlock detected\r\nDETAIL:  Process 24823 waits for ShareLock on transaction 46387; blocked by process 29587.\r\nProcess 29587 waits for ShareLock on transaction 46453; blocked by process 24823.\r\nHINT:  See server log for query details.\r\nCONTEXT:  while updating tuple (305,4) in relation \"main_host\"\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\nPostgres log:\r\n\r\n```\r\n< 2015-06-20 17:54:42.851 UTC >ERROR:  deadlock detected\r\n< 2015-06-20 17:54:42.851 UTC >DETAIL:  Process 24823 waits for ShareLock on transaction 46387; blocked by process 29587.\r\n        Process 29587 waits for ShareLock on transaction 46453; blocked by process 24823.\r\n        Process 24823: UPDATE \"main_host\" SET \"active\" = false WHERE \"main_host\".\"id\" IN (4554, 4546, 4544, 4541, 4540, 4532, 4527, 4519, 4503, 4502, 4501, 4556, 4531, 4548, 4536, 4530, 4537, 4542, 4529, 4525, 4552, 4533, 4555, 4553, 4551, 4550, 4549, 4547, 4545, 4538, 4535, 4528, 4526, 4524, 4523, 4522, 4521, 4520, 4517, 4513, 4512, 4511, 4510, 4509, 4508, 4507, 4506, 4505, 4504, 4539, 4518, 4534, 4514, 4543, 4516, 4515)\r\n        Process 29587: UPDATE \"main_group\" SET \"modified\" = '2015-06-20 17:54:41.875553+00:00', \"modified_by_id\" = NULL, \"has_active_failures\" = true, \"hosts_with_active_failures\" = 4 WHERE \"main_group\".\"id\" = 3632\r\n< 2015-06-20 17:54:42.851 UTC >HINT:  See server log for query details.\r\n< 2015-06-20 17:54:42.851 UTC >CONTEXT:  while updating tuple (305,4) in relation \"main_host\"\r\n< 2015-06-20 17:54:42.851 UTC >STATEMENT:  UPDATE \"main_host\" SET \"active\" = false WHERE \"main_host\".\"id\" IN (4554, 4546, 4544, 4541, 4540, 4532, 4527, 4519, 4503, 4502, 4501, 4556, 4531, 4548, 4536, 4530, 4537, 4542, 4529, 4525, 4552, 4533, 4555, 4553, 4551, 4550, 4549, 4547, 4545, 4538, 4535, 4528, 4526, 4524, 4523, 4522, 4521, 4520, 4517, 4513, 4512, 4511, 4510, 4509, 4508, 4507, 4506, 4505, 4504, 4539, 4518, 4534, 4514, 4543, 4516, 4515)\r\n```\r\n\r\n\"Assuming I'm understanding correctly, this error happens because a DELETE request is issued while asynchronous work (calculated fields or cascade deletion)? Is there a way I can instrument integration to detect and wait for any asynchronous processing to complete?\"\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCurrently username field is limited to max 30 characters. Its possible to have username >30 chars, especially in case where email id is used as the username. It should be either increased or at least  be configurable to change the max size.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n - Document\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI use the ssh public key authentication, it works well when I run the task with ansible.And when I set an wrong private key in awx,it works well too. So what does the ssh private key used for?\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System:centos 7\r\n* Web Browser:\r\nchrome\r\n##### STEPS TO REPRODUCE\r\n1、Make the ansible to run successfuly with the ssh public key authentication;\r\n2、Set a wrong ssh private key in the awx,the template run well too;\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\nTwo questions:\r\n1、I generate the ssh private key in the ansible master node(same as the awx task node),it that right?\r\n2、It seems that the ssh private key effecs nothing?\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nConnection reset by peer message in logs during fresh install. Eventually this same message shows up before during Job execution\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.223\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.4.1\r\n* Operating System: Centos 7.3\r\n* Web Browser:  Chrome 62\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nInstall as per instructions in docker/playbook method in install guide.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nInstall logs are without errors\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nWe see exception Control command error: error\r\n```\r\n[2017-11-20 22:31:04,214: DEBUG/ForkPoolWorker-1] Channel open\r\n[2017-11-20 22:31:04,227: DEBUG/ForkPoolWorker-1] Start from server, version: 0.9, properties: {'information': 'Licensed under the MPL.  See http://www.rabbitmq.com/', 'product': 'RabbitMQ', 'copyright': 'Copyright (C) 2007-2017 Pivotal Software, Inc.', 'capabilities': {'exchange_exchange_bindings': True, 'connection.blocked': True, 'authentication_failure_close': True, 'direct_reply_to': True, 'basic.nack': True, 'per_consumer_qos': True, 'consumer_priorities': True, 'consumer_cancel_notify': True, 'publisher_confirms': True}, 'cluster_name': 'rabbit@a518adfcba80', 'platform': 'Erlang/OTP 19.2.1', 'version': '3.6.14'}, mechanisms: ['AMQPLAIN', 'PLAIN'], locales: [u'en_US']\r\n[2017-11-20 22:31:04,229: DEBUG/ForkPoolWorker-1] using channel_id: 1\r\n[2017-11-20 22:31:04,229: DEBUG/ForkPoolWorker-1] Channel open\r\n[2017-11-20 22:31:04,231: DEBUG/MainProcess] pidbox received method active() [reply_to:{u'routing_key': u'96b1ee4c-5253-3275-99fe-0dc342057215', u'exchange': u'reply.celery.pidbox'} ticket:222bd936-4e7e-4036-b512-ac65dae9eef7]\r\n[2017-11-20 22:31:04,232: ERROR/MainProcess] Control command error: error(104, 'Connection reset by peer')\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/worker/pidbox.py\", line 42, in on_message\r\n    self.node.handle_message(body, message)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 129, in handle_message\r\n    return self.dispatch(**body)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 112, in dispatch\r\n    ticket=ticket)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 135, in reply\r\n    serializer=self.mailbox.serializer)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/pidbox.py\", line 265, in _publish_reply\r\n    **opts\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 181, in publish\r\n    exchange_name, declare,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 194, in _publish\r\n    [maybe_declare(entity) for entity in declare]\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/messaging.py\", line 102, in maybe_declare\r\n    return maybe_declare(entity, self.channel, retry, **retry_policy)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/common.py\", line 129, in maybe_declare\r\n    return _maybe_declare(entity, declared, ident, channel, orig)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/common.py\", line 135, in _maybe_declare\r\n    entity.declare(channel=channel)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/kombu/entity.py\", line 185, in declare\r\n    nowait=nowait, passive=passive,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/channel.py\", line 616, in exchange_declare\r\n    wait=None if nowait else spec.Exchange.DeclareOk,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/abstract_channel.py\", line 50, in send_method\r\n    conn.frame_writer(1, self.channel_id, sig, args, content)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/method_framing.py\", line 166, in write_frame\r\n    write(view[:offset])\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/amqp/transport.py\", line 258, in write\r\n    self._write(s)\r\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\r\n    return getattr(self._sock,name)(*args)\r\nerror: [Errno 104] Connection reset by peer\r\n[2017-11-20 22:31:04,242: DEBUG/MainProcess] Closed channel #2\r\n[2017-11-20 22:31:04,242: DEBUG/MainProcess] using channel_id: 2\r\n[2017-11-20 22:31:04,243: DEBUG/MainProcess] Channel open\r\n```\r\n##### ADDITIONAL INFORMATION\r\nGenerally things and jobs seems to run ok. But this exception keeps occuring on each Job Run.\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nOther errors seen during Job Runs:\r\n````\r\n2017-11-21 00:29:28,216 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\n[2017-11-21 00:29:28,216: DEBUG/ForkPoolWorker-129] Going to update inventory computed fields\r\n[2017-11-21 00:29:28,228: ERROR/MainProcess] Pool callback raised exception: TypeError('handle_work_error() takes at least 4 arguments (4 given)',)\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/billiard/pool.py\", line 1747, in safe_apply_callback\r\n    fun(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/worker/request.py\", line 366, in on_failure\r\n    self.id, exc, request=self, store_result=self.store_errors,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/backends/base.py\", line 168, in mark_as_failure\r\n    self._call_task_errbacks(request, exc, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/backends/base.py\", line 175, in _call_task_errbacks\r\n    errback(request, exc, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/canvas.py\", line 178, in __call__\r\n    return self.type(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 630, in __protected_call__\r\n    return orig(self, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 380, in __call__\r\n    return self.run(*args, **kwargs)\r\nTypeError: handle_work_error() takes at least 4 arguments (4 given)\r\n2017-11-21 00:29:28,266 DEBUG    awx.main.models.inventory Finished updating inventory computed fields\r\n[2017-11-21 00:29:28,266: DEBUG/ForkPoolWorker-129] Finished updating inventory computed fields\r\n\r\n\r\n\r\n2017-11-21 00:29:28,016 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\n2017-11-21 00:29:28,058 DEBUG    awx.main.models.inventory Finished updating inventory computed fields\r\n2017-11-21 00:29:28,058 WARNING  awx.main.consumers Group sending is currently disabled. Would have sent the following message\r\nChannel: jobs-summary, Payload: {'unified_job_id': 4, 'group_name': 'jobs'}\r\n2017-11-21 00:29:28,194 WARNING  awx.main.consumers Group sending is currently disabled. Would have sent the following message\r\nChannel: jobs-status_changed, Payload: {'status': 'failed', 'unified_job_id': 4, 'group_name': 'jobs'}\r\n[2017-11-21 00:29:28,194: WARNING/ForkPoolWorker-128] Group sending is currently disabled. Would have sent the following message\r\nChannel: jobs-status_changed, Payload: {'status': 'failed', 'unified_job_id': 4, 'group_name': 'jobs'}\r\n[2017-11-21 00:29:28,197: INFO/MainProcess] Received task: awx.main.tasks.update_inventory_computed_fields[f30c4d04-d33c-4f51-9b64-db4a5374fda7]\r\n[2017-11-21 00:29:28,198: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x3014cf8> (args:('awx.main.tasks.update_inventory_computed_fields', 'f30c4d04-d33c-4f51-9b64-db4a5374fda7', {'origin': 'gen469@awx', 'lang': 'py', 'task': 'awx.main.tasks.update_inventory_computed_fields', 'group': None, 'root_id': '12b3968e-303c-4a8d-9182-289365f0161f', u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u''}, 'expires': None, u'correlation_id': 'f30c4d04-d33c-4f51-9b64-db4a5374fda7', 'retries': 0, 'timelimit': [None, None], 'argsrepr': '(2, True)', 'eta': None, 'parent_id': '75da9786-f194-46e3-a29f-c433da73f055', u'reply_to': '418ff41a-8535-3908-9e46-afed985bd76c', 'id': 'f30c4d04-d33c-4f51-9b64-db4a5374fda7', 'kwargsrepr': '{}'}, u'[[2, true], {}, {\"chord\": null, \"callbacks\": null, \"errbacks\": null, \"chain\": null}]', 'application/json', 'utf-8') kwargs:{})\r\n[2017-11-21 00:29:28,200: DEBUG/MainProcess] Task accepted: awx.main.tasks.update_inventory_computed_fields[f30c4d04-d33c-4f51-9b64-db4a5374fda7] pid:470\r\n[2017-11-21 00:29:28,204: WARNING/ForkPoolWorker-128] /var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py:549: RuntimeWarning: Exception raised outside body: TypeError('handle_work_error() takes at least 4 arguments (4 given)',):\r\nTraceback (most recent call last):\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 388, in trace_task\r\n    I, R, state, retval = on_error(task_request, exc, uuid)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 330, in on_error\r\n    task, request, eager=eager, call_errbacks=call_errbacks,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 164, in handle_error_state\r\n    call_errbacks=call_errbacks)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 209, in handle_failure\r\n    call_errbacks=call_errbacks,\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/backends/base.py\", line 168, in mark_as_failure\r\n    self._call_task_errbacks(request, exc, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/backends/base.py\", line 175, in _call_task_errbacks\r\n    errback(request, exc, traceback)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/canvas.py\", line 178, in __call__\r\n    return self.type(*args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/trace.py\", line 630, in __protected_call__\r\n    return orig(self, *args, **kwargs)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/celery/app/task.py\", line 380, in __call__\r\n    return self.run(*args, **kwargs)\r\nTypeError: handle_work_error() takes at least 4 arguments (4 given)\r\n  exc, exc_info.traceback)))\r\n2017-11-21 00:29:28,216 DEBUG    awx.main.models.inventory Going to update inventory computed fields\r\n[2017-11-21 00:29:28,216: DEBUG/ForkPoolWorker-129] Going to update inventory computed fields\r\n````\r\n\r\nThese seem simple argument count errors."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nPOST to a job's relaunch endpoint when it has a credential that requires passwords, not providing the passwords, creates a job with \"new\" status, which never goes away.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - Create a credential that asks for ssh password\r\n - Attach this to a JT, launch it, provide the password\r\n - POST to `/api/v2/jobs/N/relaunch/` where N was that previous job, and provide `{}` request data\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA 400 status response is returned\r\n\r\nA new job is not created.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nA 400 status response is returned.\r\n\r\nA job is created. This job has `\"status\": \"new\"`, which is not good.\r\n\r\nNew job is not started, left in \"new\" state.\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nAllow using network modules (ios_command, aireos_command, etc) for ad-hoc commands. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.223\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1\r\n* Operating System: Centos 7.4\r\n* Web Browser: Chrome 62\r\n\r\n##### STEPS TO REPRODUCE\r\n- Select a group or host in the inventory that contains network devices. \r\n- Click RUN COMMAND\r\n\r\n##### EXPECTED RESULTS\r\nThe user should be able to select the Network Credential and set the connection method to local thus allowing the execution of network modules.\r\n\r\n##### ACTUAL RESULTS\r\nIt is only possible to select Machine Credentials and there is no option to set the connection type as local, making it impossible to successfully run network modules.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n - Django Framework\r\n- Task Scheduler\r\n\r\n##### SUMMARY\r\nThe awx_task log is full of Debug messages, filling /var/log/messages. We wanted to set the global logging level to INFO, so that messages like \r\n\r\n[2017-11-20 11:11:26,258: DEBUG/MainProcess] awx.main.scheduler.tasks.run_task_manager sent. id->71bf8b50-bbf9-4869-ab93-cc7235721148\r\n[2017-11-20 11:11:26,260: DEBUG/MainProcess] beat: Waking up in 9.97 seconds.\r\n\r\nwon't appear anymore in the log. However setting \r\n\r\nLOGGING['handlers']['console'] = {\r\n    '()': 'logging.StreamHandler',\r\n    'level': 'INFO',\r\n    'formatter': 'simple',\r\n}\r\n\r\nseems to have only partial effect, as those messages are still appearing, but the django settings accessed via awx-manage shell prints:\r\n\r\nconsole: {(): logging.StreamHandler, formatter: simple, level: INFO}\r\n\r\nAt the moment there seems no setting via the UI or in the /etc/tower/settings.py where you can set the global log level to Info.\r\n\r\nFrom the django settings accessed by awx-manage I can see that there are some loggers set to DEBUG, but I haven't found where they are set to those values:\r\n\r\nloggers:\r\n  awx:\r\n    handlers: [console]\r\n    level: INFO\r\n  awx.analytics:\r\n    handlers: [http_receiver]\r\n    level: INFO\r\n    propagate: false\r\n  awx.api.permissions:\r\n    handlers: ['null']\r\n    propagate: false\r\n  awx.conf:\r\n    handlers: ['null']\r\n    level: WARNING\r\n  awx.conf.settings:\r\n    handlers: ['null']\r\n    level: WARNING\r\n  awx.isolated.manager.playbooks:\r\n    handlers: [console]\r\n    propagate: false\r\n  awx.main:\r\n    handlers: ['null']\r\n  awx.main.access:\r\n    handlers: ['null']\r\n    propagate: false\r\n  awx.main.commands.inventory_import:\r\n    handlers: [console]\r\n    propagate: false\r\n  awx.main.commands.run_callback_receiver:\r\n    handlers: [console]\r\n  awx.main.consumers:\r\n    handlers: ['null']\r\n  awx.main.scheduler:\r\n    handlers: [console]\r\n    level: INFO\r\n  awx.main.signals:\r\n    handlers: ['null']\r\n    propagate: false\r\n  awx.main.tasks:\r\n    handlers: [console]\r\n  django:\r\n    handlers: [console]\r\n  django.request:\r\n    handlers: [console]\r\n    level: WARNING\r\n  django_auth_ldap:\r\n    handlers: [console]\r\n    level: DEBUG\r\n  py.warnings:\r\n    handlers: [console]\r\n  rbac_migrations:\r\n    handlers: [console]\r\n    level: DEBUG\r\n  rest_framework.request:\r\n    handlers: [console]\r\n    level: WARNING\r\n    propagate: false\r\n  social:\r\n    handlers: [console]\r\n    level: DEBUG\r\n  system_tracking_migrations:\r\n    handlers: [console]\r\n    level: DEBUG\r\n\r\nIs the only current way in changing those values to INFO by setting those directly in the django settings.py for each entry separately?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.54\r\n* AWX install method: local docker with self build containers\r\n* Ansible version:  2.4.1.0\r\n* Operating System: RHEL7\r\n* Web Browser: Yandex\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSet LOGGING['handlers']['console']['level'] to 'INFO' in /etc/tower/settings.py\r\nSet LOGGING['loggers']['awx.main.scheduler'] to 'INFO' in /etc/tower/settings.py\r\n\r\n##### EXPECTED RESULTS\r\n\r\nOnly INFO logging messages in logging\r\nOnly INFO log messages for awx.main.scheduler\r\n\r\n##### ACTUAL RESULTS\r\n\r\nStill debug log messages for awx.main.scheduler\r\n\r\n[2017-11-20 11:11:26,258: DEBUG/MainProcess] awx.main.scheduler.tasks.run_task_manager sent. id->71bf8b50-bbf9-4869-ab93-cc7235721148\r\n[2017-11-20 11:11:26,260: DEBUG/MainProcess] beat: Waking up in 9.97 seconds.\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently Perforce SCM type supported is not supported\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nWhen I pass valid YAML for an injector that isn't a valid injector configuration, the error is not user-friendly.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.x\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nWrite a new credential type.\r\n\r\nEnter the following YAML as an injector, because you forgot the syntax:\r\n```\r\nextra_vars:\r\n - 'a': \"{{ b }}\"\r\n - 'c': \"{{ d }}\"\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nNot sure, something like:\r\n\r\n`List passed, expected dictionary`.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n`[OrderedDict([('a', '{{ b }}')]), OrderedDict([('c', '{{ d }}')])] is not of type 'object'`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nProbably applies to inputs as well.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nI cannot inject unicode extra vars with a custom credential type.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.any\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a custom credential type\r\n2. Unleash the dragon in the injector\r\n```\r\nextra_vars:\r\n  '🐉🐉🐉': '{{ dragon_name }}'\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSucceeds (this works when setting regular extra_vars)\r\n\r\n##### ACTUAL RESULTS\r\n\r\nValidation error:\r\n`'\\U0001f409\\U0001f409\\U0001f409' does not match any of the regexes: '^[a-zA-Z_]+[a-zA-Z0-9_]*$'`\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen creating a workflow template in a brand new vanilla install, I receive the error message:\r\n\r\nERROR! \r\nFiltering on password fields is not allowed.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1.0\r\n* Operating System: Ubuntu\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nSimply attempt to create a new workflow template\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expected to be presented with the workflow graph editor\r\n\r\n##### ACTUAL RESULTS\r\n\r\n![image](https://user-images.githubusercontent.com/29128098/32875933-0013854e-ca60-11e7-80e4-d0920db55803.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nThe sum of the capacity percentage of a single-instance and the capacity percentage of the instance group containing the single instance are very different.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nEither noting the difference or adjusting the behavior will make the meaning more clear when estimating the remaining capacity available."},{"labels":["api",null,null,null,null,null,null],"text":"`python-memcached` had a unicode handling bug:\r\n\r\nhttps://github.com/linsomniac/python-memcached/issues/79\r\n\r\nSo we fixed it ourselves in awx:\r\n\r\nhttps://github.com/ansible/awx/commit/64a973ae0249f7995c6800d932499c4710eb0295\r\n\r\nThis bug is now fixed via https://github.com/linsomniac/python-memcached/pull/135\r\nWhen a new release of `python-memcached` is available on PyPI, we should remove our fix and update to the latest `python-memcached`.  Namely, we should be able to just revert this block of code:\r\n\r\nhttps://github.com/ansible/awx/commit/64a973ae0249f7995c6800d932499c4710eb0295#diff-5f33708f03c52c38947eae52c21a1407R91\r\n\r\n...update the required version of `python-memcached` in https://github.com/ansible/awx/blob/devel/requirements/requirements.txt, and confirm that awx tests still pass."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf the API client provides job template related resources on launch (creds, inventory), the API would give a 403 response.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - Create a job template set to prompt for everything on launch\r\n - Log in as a user with execute_role to the job template, and nothing else\r\n - Launch the job in the UI\r\n\r\n##### EXPECTED RESULTS\r\nThis is the same as launching the JT without providing new resources. The execute_role should be enough to launch.\r\n\r\n##### ACTUAL RESULTS\r\nPermission denied for not having access to related resources that are already attached to the job template.\r\n\r\n##### ADDITIONAL INFORMATION\r\nhttps://github.com/ansible/awx/pull/649"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nAdd to AWX play and task level detail to the job details page, including started and elapsed times for individual plays and tasks listed in the job details.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis feature would be used to conveniently evaluate the performance of particular plays and tasks in the context of overall job execution, with relevant information in a common location with other job details.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\n1. Create job template\r\n2. Set inventory to prompt on launch (no default)\r\n3. Enable provisioning callback\r\n4. Hit save\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n\r\n##### EXPECTED RESULTS\r\n\r\nError (because that isn't going to work)\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSucceeds. AWX 500s if you hit the callback.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nRegular job launch returns job ID.\r\n\r\nProvisioning callback does not. Can't think of a security reason why not to.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.any\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null],"text":"Mockup:\r\n\r\n<img width=\"501\" alt=\"mockup\" src=\"https://user-images.githubusercontent.com/1342624/32793088-f8cf8e8c-c932-11e7-9bf2-0c0c7d9873ed.png\">\r\n\r\nCurrently, we do not have the information present in the list endpoint to make displaying the \"credentials\" row as a group of tags as the mockup shows."},{"labels":["api",null,null],"text":"Mockup:\r\n\r\n<img width=\"501\" alt=\"mockup\" src=\"https://user-images.githubusercontent.com/1342624/32793015-c8326470-c932-11e7-889f-82fb349b42cb.png\">\r\n\r\nCurrently, the list endpoint does not include the datetime or user's username/id necessary to add the \"last used\" row as present in the mockup."},{"labels":["api",null,null],"text":"Mockup for context:\r\n\r\n<img width=\"501\" alt=\"mockup\" src=\"https://user-images.githubusercontent.com/1342624/32792954-aa7c9ea0-c932-11e7-8635-11e8b398664b.png\">\r\n\r\nThe goal of showing \"modified by\" in the list is to give an idea to the user as to when the last time the template form was updated.\r\n\r\nIf the value is updated on launch, it more-or-less is redundant with the last used information."},{"labels":["api",null,null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nIn the gce.py script there is an option to set 'INVENTORY_IP_TYPE' to 'internal or 'external'. this instructs gce.py to set the \"ansible_ssh_host:\" to the private IP instead of defaulting to the public IP. I looking at ways of setting this environmental variable in the docker-compose.yml, but I think it would be way cooler if it was a selectable box on the UI when creating a Dynamic GCE Inventory.\r\n\r\nIf anyone's open to discuss how to accomplish this then I might take a crack at it.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: X.Y.Z\r\n* AWX install method: docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System: Windows\r\n* Web Browser: Chrome\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0\r\n* Operating System:centos 7\r\n* Web Browser:chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n1,config a project with subversion crendential;\r\n2,run the project;\r\n\r\n##### EXPECTED RESULTS\r\ncheckout successfully\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": \"/usr/bin/svn --non-interactive --trust-server-cert --no-auth-cache --username yangl --password '********' checkout -r HEAD https://10.2.30.79/svn/yl01 /var/lib/awx/projects/_7__yl01_proj\", \"failed\": true, \"msg\": \"svn: E175002: Unable to connect to a repository at URL 'https://10.2.30.79/svn/yl01'\\nsvn: E175002: OPTIONS of 'https://10.2.30.79/svn/yl01': Server certificate verification failed: certificate issued for a different hostname, issuer is not trusted (https://10.2.30.79)\", \"rc\": 1, \"stderr\": \"svn: E175002: Unable to connect to a repository at URL 'https://10.2.30.79/svn/yl01'\\nsvn: E175002: OPTIONS of 'https://10.2.30.79/svn/yl01': Server certificate verification failed: certificate issued for a different hostname, issuer is not trusted (https://10.2.30.79)\\n\", \"stderr_lines\": [\"svn: E175002: Unable to connect to a repository at URL 'https://10.2.30.79/svn/yl01'\", \"svn: E175002: OPTIONS of 'https://10.2.30.79/svn/yl01': Server certificate verification failed: certificate issued for a different hostname, issuer is not trusted (https://10.2.30.79)\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n\r\n##### ADDITIONAL INFORMATION\r\n1、It worked well when I copy the command and run in the terminal ;\r\n2、Worked well too when I used the ansible playbook to checkout the svn;\r\n3、awx failed screenshot:\r\n![s2 ag yttvb4qgdxkdhwej](https://user-images.githubusercontent.com/16607114/32760012-430430d6-c927-11e7-9d30-5c88b41c06f8.png)\r\n\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently increasing log verbosity to debug LDAP increases verbosity for all Tower logs. If a user only requires LDAP logs, this introduces increased difficulty in filtering and managing those logs. This feature is to split off LDAP logging to be targeted specifically. A UI option to turn this on would be preferred.\r\n"},{"labels":["api",null,null],"text":"Group sending in `asgi_rabbitmq` has a race condition that results in threads never returning. We've disabled group sending to the websockets to get around this issue."},{"labels":["api",null],"text":"A bug being masked by `import *` and `try/except`\r\n\r\nhttps://github.com/ansible/awx/blob/devel/awx/api/views.py#L364\r\n\r\n![pasted image at 2017_11_10 11_55 am](https://user-images.githubusercontent.com/27317/32673205-38651efa-c61c-11e7-9f6e-e7891fac5c8d.png)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nJust deployed awx on OCP 3.5 following this [guide](https://developers.redhat.com/blog/2017/10/16/guide-starting-use-awx-top-openshift-upstream-red-hat-ansible-tower/) and now attempting to set up LDAP / AD. When we click save the page refreshes & the filled in boxes stay, however, if you browse to another area data in the fields is lost.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.1.157\r\n* AWX install method: openshift\r\nopenshift v3.5.5.31\r\nkubernetes v1.5.2+43a9be4\r\n* Ansible version: Ansible 2.4.1.0\r\n* Operating System: Red Hat Enterprise Linux Server release 7.3 (Maipo)\r\n* Web Browser: \r\nMac OS X 10_12_6 Chrome/61.0.3163.100\r\nMac OS X 10.12 Firefox/56.0\r\n\r\n##### STEPS TO REPRODUCE\r\nLog in with default admin / password > settings > authentication > subcategory LDAP > fill in text fields > click save.\r\n\r\n##### EXPECTED RESULTS\r\nExpected settings to be saved.\r\n\r\n##### ACTUAL RESULTS\r\nPaged refreshed however data in fields is not saved if you browse to another section in awx.\r\n\r\n##### ADDITIONAL INFORMATION\r\nPlease note, that we do not have any external load balancers in front of OCP, other than using the native HAProxy.\r\n\r\nSee the following errors in the logs\r\n>2017/11/10 16:57:24 [error] 39#0: *39 connect() failed (111: Connection refused) while connecting to upstream, client: 10.1.0.1, server: _, request: \"PATCH /api/v2/settings/all/ HTTP/1.1\", upstream: \"uwsgi://[::1]:8050\", host: \"awxui.openshift.server.com\", referrer: \"http://awxui.openshift.server.com/\"\r\n2017/11/10 16:57:24 [warn] 39#0: *39 upstream server temporarily disabled while connecting to upstream, client: 10.1.0.1, server: _, request: \"PATCH /api/v2/settings/all/ HTTP/1.1\", upstream: \"uwsgi://[::1]:8050\", host: \"awxui.openshift.server.com\", referrer: \"http://awxui.openshift.server.com/\"\r\n2017-11-10 16:57:24,957 WARNING  awx.api.generics status 400 received by user admin attempting to access /api/v2/settings/all/ from 10.1.0.1\r\n[pid: 34|app: 0|req: 1/22] 10.1.0.1 () {60 vars in 3571 bytes} [Fri Nov 10 16:57:24 2017] PATCH /api/v2/settings/all/ => generated 54 bytes in 439 msecs (HTTP/1.1 400) 7 headers in 248 bytes (1 switches on core 0)\r\n10.1.0.1 - - [10/Nov/2017:16:57:24 +0000] \"PATCH /api/v2/settings/all/ HTTP/1.1\" 400 65 \"http://awxui.openshift.server.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36\" \"167.209.70.250\"\r\nerror: unexpected EOF\r\n\r\nWorking on gathering and making all logs available.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n##### COMPONENT NAME\r\n - API\r\n##### SUMMARY\r\nsdtout api  for example  /api/v2/jobs/216/stdout/ not work the result is always the message\r\n**stdout capture is missing**\r\nBut in AWX the standard output of job work fine.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX api v2\r\n* AWX install method: docker on linux\r\n* Ansible version:  X.Y.Z\r\n* Operating System:RHEL 7.x\r\n* Web Browser:All\r\n\r\n##### STEPS TO REPRODUCE\r\nExecute a job on AWX UI\r\ncall the api /api/v2/jobs/{ID}/stdout/\r\nwhere ID = Job ID\r\n\r\n##### EXPECTED RESULTS\r\n\r\nstandard output of executed jobs with JSON format\r\n\r\n##### ACTUAL RESULTS\r\n\r\n**stdout capture is missing**\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n \r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nHello guys, i have a job without valid project ( no playbook, because my url wrong ) and when i launch this project in job section i see that my job template is running, and i'm don't have ability to delete or terminate this, why? i wanna to force delete this job.i'm click on cancel button, the windows with (Are you sure you want to cancel the job below?) i'm click on ok and nothing changes.\r\njob is still running\r\n\r\n##### ENVIRONMENT\r\n* AWX version 1.0.1.120\r\n* AWX install method: , docker on linux\r\n* Ansible version:  2.4.1.0\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Mozila\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n\r\nset the wrong scm url to github and launch project\r\n\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nIt would be better for users if they could create a single Notification Template per 'DESTINATION CHANNEL' and when enabling the notification in a job template, If users are able to override the defaults placed in the Notification Template.\r\nWhen sharing the CHANNEL with multiple teams, it is useful to be able to overwrite LABEL and COLOR for each job the team runs.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.X\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n- If it is able to overide within job template, users do not have to create multiple NOTIFICATION templates for the same HipChat channel.\r\n- For Example UI (Just Idea) : TEMPLATES > %JOB_TEMPLATE% > NOTIFICATIONS > SUCCESS | FAILURE | 'NOTIFICATION LABEL' | 'NOTIFICATION COLOR'"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThe API for inventories/hosts currently has two ways to determine the last time a job was run on a host:\r\n- the `last_job` summary field\r\n- the `recent_jobs` array\r\n\r\nHowever, both of these are cleared when job history is cleaned up. This makes it impossible to find the last time a job was run on the host. Ideally, there would at least be a timestamp that would persist.\r\n\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.any\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nYay computed fields.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n- AWX-TASK Container\r\n\r\n##### SUMMARY\r\nWhen cloning a Git Repo over SSH which has submodules, the Submodules fail to clone.\r\nThis is with cert or password auth. The credentials get used for the main repo, but are not applyed to the Submodule. This is because AWX sets the username when cloning the main repo, but does not do that for submodules.\r\n\r\nSo This will Fail\r\n```\r\n[submodule \"roles/yourrole\"]\r\n\tpath = roles/yourrole\r\n\turl = ssh://git.yourserver.com:29418/ansible/roles/yourrole.git\r\n```\r\n\r\nWhen adding a username in `.gitmodules` the clone works and the cert gets used correctly by awx. Howerver this is bad practice as other users of that Repo fail to clone it because they always have a wrong user.\r\n```\r\n[submodule \"roles/yourrole\"]\r\n\tpath = roles/yourrole\r\n\turl = ssh://awxuser@git.yourserver.com:29418/ansible/roles/yourrole.git\r\n```\r\n\r\n\r\nAs a Workaround , one can add this in `/etc/ssh/ssh_conf` to force that username on a specific server in the `awx_task` container.\r\n```\r\nHost git.yourserver.com\r\n        HostName git.yourserver.com\r\n        User awxuser\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.100\r\n* AWX install method: docker / open source installer via playbook\r\n* Ansible version:  2.4.0.0\r\n* Operating System: RHEL7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nClone Project wirth submodules over SSH. The submodules must not specefy a username.\r\n\r\n```\r\n[submodule \"roles/yourrole\"]\r\n\tpath = roles/yourrole\r\n\turl = ssh://git.yourserver.com:29418/ansible/roles/yourrole.git\r\n```\r\n\r\nAll hase to be done over SSH and authentication is required for the Git Server.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nClone submodules works with the Username and the Password/cert of the Credentials that are used to clone the Project in AWX.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": \"/usr/bin/git submodule foreach /usr/bin/git fetch\", \"failed\": true, \"msg\": \"Permission denied (password,keyboard-interactive,publickey).\\r\\nfatal: Could not read from remote repository.\\n\\nPlease make sure you have the correct access rights\\nand the repository exists.\\nStopping at 'roles/yourrole'; script returned non-zero status.\", \"rc\": 1, \"stderr\": \"Permission denied (password,keyboard-interactive,publickey).\\r\\nfatal: Could not read from remote repository.\\n\\nPlease make sure you have the correct access rights\\nand the repository exists.\\nStopping at 'roles/yourrole'; script returned non-zero status.\\n\", \"stderr_lines\": [\"Permission denied (password,keyboard-interactive,publickey).\", \"fatal: Could not read from remote repository.\", \"\", \"Please make sure you have the correct access rights\", \"and the repository exists.\", \"Stopping at 'roles/yourrole'; script returned non-zero status.\"], \"stdout\": \"Entering 'roles/yourrole'\\n\", \"stdout_lines\": [\"Entering 'roles/yourrole'\"]}\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI am trying to deploy a playbook on a remote host, deploying some docker containers like Mysql for example, but when using delegate_to: mysql to create DB inside the container it gives me:\r\n\r\n```\r\ndocker: executable file not found in PATH\r\n```\r\n\r\nBecause docker is not present on awx-task container. \r\nIs it possible to use docker remote host to deploy the playbook on the remote host and then use delegate_to to get inside the container host.\r\n\r\nOr to install docker inside awx-task so it can use it to delegate_to: directly on the remote container host.\r\n\r\n##### ENVIRONMENT\r\n* AWX version:1.0.1.153 \r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1.0\r\n* Operating System: Ubuntu Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nDeploy the following playbook\r\n\r\n```\r\n- hosts: all\r\n  become: yes\r\n  gather_facts: False\r\n  vars:\r\n   - ansible_python_interpreter: /usr/bin/python2.7\r\n   - ansible_sudo_pass:\r\n  tasks:\r\n    - name: Mysql docker container UP\r\n      docker_container:\r\n        name: db\r\n        image: mysql:latest\r\n        state: started\r\n        restart_policy: always\r\n        env:\r\n          MYSQL_ROOT_PASSWORD: \r\n\r\n    - name: add Mysql container to inventory\r\n      add_host:\r\n        name: db\r\n        ansible_connection: docker\r\n        ansible_user: root\r\n        ansible_docker_extra_args: \"-H=tcp://remotehost:2375\"\r\n      changed_when: False\r\n\r\n    - name: install DB\r\n      delegate_to: db\r\n      gather_facts: False\r\n      mysql_db:\r\n        name: test\r\n        state: present\r\n\r\n```\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nTo install DB on remote docker container\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n```\r\ndocker: executable file not found in PATH\r\n```\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nTried to install docker on awx-task docker container and it will not show the following error anymore:\r\n```\r\ndocker: executable file not found in PATH\r\n```\r\n\r\nBut instead shows that the docker daemon is not active.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nThe list of searchable fields in the UI (in the search 'KEY') is driven off the OPTIONS list for the API, plus `related_search` fields.\r\n\r\nHowever, not all fields returned in OPTIONS are searchable, and some that aren't listed in OPTIONS are.\r\n\r\nAs we can't change the OPTIONS request (as it's used for GET/POST validation by the UI, etc), we should introduce a new concept of 'searchable fields' in the API that the UI can use to populate the search key.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nOpen search key.\r\nAttempt to use all items listed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nIf you add permissions for a team with no members, they won't appear in the UI on the managed object.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Create a team\r\n- Don't put anyone in the team\r\n- Go to some object\r\n- Give that team a permission to the object\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSome indication in that object's \"Permissions\" tab that a permission has been assigned to it.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo visible view of permissions unless\r\na) a user is added to the team\r\nb) you go to the 'granted permissions' tab of the team\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n \r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n- name: Terminate instances\r\n  hosts: localhost\r\n  connection: local\r\n  tasks:\r\n    - name: Terminate instances that were previously launched\r\n      ec2:\r\n        state: 'absent'\r\n        instance_ids: '{{ ec2.instance_ids }}'\r\n\r\nERROR! no action detected in task. This often indicates a misspelled module name, or incorrect module path.\r\n\r\nThe error appears to have been in '/root/myplatform/site.yml': line 40, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n\r\n    - name: Terminate instances\r\n      ^ here\r\n\r\n\r\nThe error appears to have been in '/root/myplatform/site.yml': line 40, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n\r\n    - name: Terminate instances\r\n      ^ here\r\n\r\nexception type: <class 'ansible.errors.AnsibleParserError'>\r\nexception: no action detected in task. This often indicates a misspelled module name, or incorrect module path.\r\n\r\nThe error appears to have been in '/root/myplatform/site.yml': line 40, column 7, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n    - name: Terminate instances\r\n      ^ here\r\n\r\n##### ENVIRONMENT\r\nansible 2.4.0.0\r\n\r\n* Operating System:\r\nCentos 7\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nSemantics:\r\n- have a 'file' survey type\r\n- this uses a file upload widget in the survey taker\r\n- the uploaded file is stored as a base64-encoded extra var in the specified variable\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSet appropriate limits to not DoS the system.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe already pull playbooks from source control - it would be neat if the job template & workflow definitions (including surveys, potentially even roles) could be sourced from there as well.\r\n\r\n(Probably a very large discussion of *how* this would work, and what to support, is required.)\r\n\r\n##### ENVIRONMENT\r\n* AWX version: any\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThe logging service configured could be down, or suffer a transient error.\r\n\r\nHaving a minimal level of 'retry' would avoid message/data loss.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nNot valid for LOG_AGGREGATOR_PROTOCOL=UDP, obvs.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nOur social and LDAP auth can map users into orgs and teams by assorted attributes. \r\n\r\nThe request is to be able to map them into *roles* (team admin, execute on inventory) via attributes.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n1. The syntax for this must be manageable in the interface. \r\n\r\n2. It could be argued that it might be simpler to define a team with the associated roles, and map into that."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nA job run links to the various items associated with the job.\r\n\r\nHowever, these are all the current state of those items, which may bear zero relation to the state of those items when the job is launched.\r\n\r\nAs a auditing user looking at the history of job runs, I want to see in a job run the state of the job as it was launched and ran, rather than having to attempt to reconstruct it via activity stream entries if the inventory/credential/template/etc has changed since then.\r\n\r\n(This also affects job relaunch.)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis is almost certainly API-breaking, and might require rethinking of the database."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nWe have the ability to search and filter based on stored facts with `host_filter`.\r\n\r\nWe do *not* have the ability to do this for variables. You can do a free-text search, but it's not particularly useful (especially depending on var format).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.whatever\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nrelated to issue: https://github.com/ansible/awx/issues/458\r\nWhen a job has associated objects removed from it (projects, inventory, credentials, and template), a system auditor can no longer access the job id, but the admin can.  Not sure why there is any case, where the system wide auditor cannot read a job.\r\n\r\nfrom the UI:\r\nInsufficient Permissions: You do not have permission to view this job.\r\nusing the cli (as a system auditor): tower_cli.exceptions.Forbidden: You don't have permission to do that.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.0.588\r\n* AWX install method:  docker\r\n* Ansible version:  Ansible 2.4.0.0 \r\n* Operating System: RHEL 7.4\r\n* Web Browser: FF ESR 52.3\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nrun a job as a normal user under any organization.\r\nAfter the job is run, delete the template, inventory, project, and credentials associated with the job.\r\n\r\nQuery the job that was run using a user that is a system auditor for the AWX instance.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAble to query the job to get stdout and status.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nauditor is unable to query the job\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nCould not run provisioning callback jobs when using loadbalancer IP/host. \r\n`$ curl --data \"host_config_key=ac2960188ddd70b965fedcd037b57732\" https://tower.staging.hcom:443/api/v2/job_templates/24/callback/ -XPOST\r\n{\"msg\":\"No matching host could be found!\"}`\r\n\r\nwhere https://tower.staging.hcom:443 is load-balancer VIP\r\nNecessary REMOTE_HOST_HEADERS are set correctly.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1-143\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4\r\n* Operating System: Linux\r\n* Web Browser: curl\r\n\r\n##### STEPS TO REPRODUCE\r\nRun callback job using LB host\r\n\r\n##### EXPECTED RESULTS\r\nCallback job is executed successfully basing on \"REMOTE_ADDR\" HTTP header. \r\n\r\n##### ACTUAL RESULTS\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nRun job using LP IP-address:\r\n`$ curl --data \"host_config_key=ac2960188ddd70b965fedcd037b57731\" https://tower.staging.hcom:443/api/v2/job_templates/24/callback/ -XPOST\r\n{\"msg\":\"No matching host could be found!\"}`\r\n\r\nActual HTTP header which is sent from LB:\r\n\r\n> POST /api/v2/job_templates/24/callback/ HTTP/1.1\r\n> User-Agent: curl/7.29.0\r\n> Host: tower.staging.hcom\r\n> Accept: */*\r\n> Content-Length: 48\r\n> Content-Type: application/x-www-form-urlencoded\r\n> REMOTE_ADDR: 10.187.106.161\r\n> host_config_key=ac2960188ddd70b965fedcd037b57731\r\n> 11:33:56.249775 IP 10.187.64.17.51905 > 10.187.65.120.http: Flags [.], ack 1424990846, win 8190, length 0\r\n\r\nAWX settings:\r\n`    \"REMOTE_HOST_HEADERS\": [\r\n        \"True-Client-IP\",\r\n        \"REMOTE_ADDR\",\r\n        \"REMOTE_HOST\"\r\n    ],`\r\n\r\nSo, LB correctly sets REMOTE_ADDR header which is configured in AWX system settings - \"REMOTE HOST HEADERS\" but AWX still rejects such callback job execution.\r\n\r\nLogs:\r\n`2017-11-02 16:41:51,837 WARNING  awx.api.generics status 400 received by user AnonymousUser attempting to access /api/v2/job_templates/24/callback/ from 10.187.64.17\r\n10.187.64.17 - - [02/Nov/2017:16:41:51 +0000] \"POST /api/v2/job_templates/24/callback/ HTTP/1.1\" 400 53 \"-\" \"curl/7.29.0\" \"-\"\r\n[pid: 318|app: 0|req: 795/24358] 10.187.64.17 () {36 vars in 530 bytes} [Thu Nov  2 16:41:51 2017] POST /api/v2/job_templates/24/callback/ => generated 42 bytes in 60 msecs (HTTP/1.1 400) 6 headers in 191 bytes (1 switches on core 0)`\r\n\r\nwhere 10.187.64.17 is LB address, not actual client address.\r\n\r\nWhen calling AWX host directly everything works fine (AWX recognizes remote host as one from inventory):\r\n\r\n`curl --data \"host_config_key=ac2960188ddd70b965fedcd037b57732\" http://chhlapphot830/api/v2/job_templates/24/callback/`\r\n\r\n`10.187.106.161 - - [02/Nov/2017:16:44:43 +0000] \"POST /api/v2/job_templates/24/callback/ HTTP/1.1\" 201 5 \"-\" \"curl/7.29.0\" \"-\"\r\n[pid: 404|app: 0|req: 61/24393] 10.187.106.161 () {36 vars in 527 bytes} [Thu Nov  2 16:44:42 2017] POST /api/v2/job_templates/24/callback/ => generated 0 bytes in 227 msecs (HTTP/1.1 201) 6 headers in 204 bytes (1 switches on core 0)\r\n[pid: 376|app: 0|req: 234/24394] 10.187.64.17 () {46 vars in 2333 bytes} [Thu Nov  2 16:44:44 2017] GET /api/v2/dashboard/graphs/jobs/?period=month&job_type=all => generated 1126 bytes in 49 msecs (HTTP/1.1 200) 7 headers in 202 bytes (1 switches on core 0)`\r\n <!-- For bug reports, what actually happened? -->\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n\r\n - API\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nWhen looking up if a user is part of a group in LDAP Tower is using the primary UID of the user and compares it with the members listed in the group. But its possible that in the group we don't have the UID of the user, and are using other custom field. We need to be able to specify in the Tower configuration which entry of the user to use in looking up group membership.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.x\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nCurrently since group search by default is using uid, the group search fails. "},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently AWX only supports a single IP/FQDN for the RADIUS and TACACS+ authentication method. I think that it should be support multiple IP/FQDN for the RADIUS and TACACS+.\r\n\r\n##### ENVIRONMEN \r\n* AWX version: 1.0.X\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Login as a Admin user via WebUI\r\n2. SETTINGS > EDIT CONFIGURATION > AUTHENTICATION > SUB CATEGORY > RADIUS|TACACS+\r\n3. RADIUS SERVER and TACACS+ SERVER parameters do not support multiple IP/FQDN\r\n\r\n##### EXPECTED RESULTS\r\n\r\nRADIUS SERVER and TACACS+ SERVER parameters can be set multiple IP/FQDN like LDAP_SERVER_URI\r\n\r\n##### ACTUAL RESULTS\r\n\r\nRADIUS SERVER and TACACS+ SERVER parameters do not support multiple IP/FQDN\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nN/A\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWorkflow job template nodes have no `diff_mode` field.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n\r\n##### STEPS TO REPRODUCE\r\nGo to create a WFJT node.\r\n\r\n##### EXPECTED RESULTS\r\nin addition to `job_type`, `limit`, etc., `diff_mode` is not there when creating a node that references a job template with `ask_diff_mode_on_launch` set to True.\r\n\r\n##### ACTUAL RESULTS\r\nNo option. It was added as a prompt-able field, but not made available on the nodes.\r\n\r\n##### ADDITIONAL INFORMATION\r\nRelated to https://github.com/ansible/awx/issues/169\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nFeature request to add a  listtype option in tower survey to correctly parse a list that you pass for a variable. As it stands now you have to pass a list in yml format and for user experience it would be nice if you could pass a list just comma separated or how you do it when you specify a --limit\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2\r\n* AWX install method: Linxus\r\n* Ansible version:  lastest\r\n* Operating System: RHEL 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nNo steps needed as it's a feature request.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n##### ACTUAL RESULTS\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nI have a dynamic inventory script that used to work in AWX when it was using Ansible 2.3, but now I get the following warning, and no tasks are executed, *BUT* AWX shows the job as successful.\r\n\r\n```\r\n [WARNING]:  * Failed to parse /tmp/awx_318_V8mVNi/inventory with yaml plugin:\r\nSyntax Error while loading YAML.   The error appears to have been in\r\n'/tmp/awx_318_V8mVNi/inventory': line 3, column 718, but may be elsewhere in\r\nthe file depending on the exact syntax problem.  The offending line appears to\r\nbe:\r\n[...]\r\n```\r\n\r\nThe output of my dynamic script is actually ok, but the script that AWX is generating outputs invalid JSON when ran:\r\n\r\n```\r\n[root@awx x]# ./awx_314_QzQbYO/inventory > /dev/null\r\n[root@awx x]# echo $?\r\n0\r\n[root@awx x]# ./awx_314_QzQbYO/inventory | jq .\r\nparse error: Invalid numeric literal at line 1, column 76884\r\n```\r\n\r\nAfter some digging, I found that the quotations inside of a string aren't being escaped when AWX writes out the inventory script:\r\n```json\r\n[...]\r\n \"_meta\":\r\n  \"host1\":\r\n   {\"ansible_ssh_common_args\": \"-o ProxyCommand=\"ssh -W %h:%p -q user@host2\"\"}\r\n```\r\nThe input inventory script outputs:\r\n```json\r\n        \"ansible_ssh_common_args\": \"-o ProxyCommand=\\\"ssh -W %h:%p -q user@host2\\\"\"\r\n```\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.120\r\n* AWX install method: docker\r\n* Ansible version:  2.4.1.0 \r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd a host variable with quotations inside of it, then try to run a playbook.  This may require the result of a dynamic inventory script, I've not tried using the UI inventory.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nBacon to fall from the sky, or my playbook to run.  It also should have also marked the job as failed.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo bacon and my playbook doesn't run.  Job shows as succeeded in the UI.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen I update an inventory and look at the jobs list, I can't tell _which_ inventory _source_ I updated\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker for mac\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate 1 inventories, and 2 inventory sources inside of it.\r\n\r\nLaunch both inventory sources.\r\n\r\nGo to JOBS in UI.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI can tell apart updates from the 2 different sources.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nCannot.\r\n\r\nThe API generates the name for the inventory updates.\r\n\r\n###### my example\r\n\r\nIn the API for both updates, you find:\r\n\r\n```json\r\n \"name\": \"Custom Script Example\",\r\n ```\r\n\r\nthe user experience for the inventory sources view:\r\n(you can easily tell the two apart here)\r\n\r\n![screen shot 2017-11-01 at 10 05 40 am](https://user-images.githubusercontent.com/1385596/32278601-8c7e4a84-beec-11e7-93a5-bdda08146a44.png)\r\n\r\n\r\nfor the jobs list:\r\n(you can not tell the two apart at all)\r\n\r\n![screen shot 2017-11-01 at 10 05 53 am](https://user-images.githubusercontent.com/1385596/32278629-9fb03d2e-beec-11e7-81c8-64f07cafbd06.png)\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPing @trahman73 \r\n\r\nThe API can solve this by changing its algorithm for how it names the inventory update.\r\n\r\nNote that when the UI navigates to the inventory update details view, it erroneously gives the NAME as the name of the inventory source.\r\n\r\nOne suggestion might be to have the inventory update name be `(<inventory name> + <inventory source name>)`."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nmaster playbook that imports others doesn't show up in the playbook selection drop-down list.\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.35\r\n* AWX install method: docker\r\n* Ansible version:  2.4.0\r\n* Operating System: Fedora\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nCommit a master playbook that import other to your project, without adding a -hosts attribute\r\n- import_playbook: play1.yml\r\n- import_playbook: play2.yml  \r\n- import_playbook: play2.yml\r\n\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe master playbook should appear in the drop-down list\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe master playbook doesn't show up. Only if I do this, it appears:\r\n\r\n```\r\n- hosts: all\r\n  gather_facts: no\r\n\r\n- import_playbook: play1.yml\r\n- import_playbook: play2.yml  \r\n- import_playbook: play2.yml\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAuthencation setting not save to database\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.120\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1.0 \r\n* Operating System: Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nThe LDAP authentication setting ok in the web page, but after logout and login again, I found out the setting not there. go the database and found out the setting not updated to the database. So, just update the database manually, and then it works.\r\nsometimes you can see the setting was lost when you change the other tab and then go back.\r\nlooks like the setting stored in user session but database update failed. \r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.1\r\n* Operating System: CentOS 7.4\r\n* Web Browser: Chrome on Mac\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. On a new install of AWX, log in and navigate to Settings -> AUTHENTICATION.\r\n2. In the Sub Category drop-down, select LDAP.\r\n3. In the LDAP Server URI field, attempt to add a non-FQDN server name such as: \r\n\r\nldaps://ldap:636\r\n\r\n4. Click Save.\r\n5. Navigate to Instance Groups and back to Settings.\r\n6. The LDAP Server URI was not saved.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe non-FQDN hostname should be honored and saved.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe following log is seen when attempting to save the non-FQDN hostname:\r\n\r\n```10.255.255.10 - - [31/Oct/2017:16:11:58 +0000] \"PATCH /api/v2/settings/all/ HTTP/1.1\" 400 57 \"http://awxhost/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Safari/604.1.38\" \"-\"```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIt is not possible to check out a SCM URL using subversion because the password is not correctly placed into the command string that runs.\r\n\r\n##### ENVIRONMENT\r\n- AWX version:  1.0.1.120\r\n- AWX install method: docker on linux\r\n - Ansible version:  2.4.1.0\r\n- Operating System: Centos 7.4\r\n- Web Browser: 52.4.0 (64-bit)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n- Create a new credentials(Source Control)\r\n- Double check username/password\r\n\r\n- Create a new project using the created credentials\r\n- Start an SCM update\r\n\r\nAt this point it will fail.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nCorrectly checking out the repository\r\n\r\n##### ACTUAL RESULTS\r\n\r\nTASK [update project using svn with auth] ************************************** fatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": \"/usr/bin/svn --non-interactive --trust-server-cert --no-auth-cache --username testUser --password '********' checkout -r HEAD https://test.test.com/test/ /var/lib/awx/projects/_6__linuxtest\", \"failed\": true, \"msg\": \"svn: E170001: Unable to connect to a repository at URL 'https://test.test.com/test/'\\nsvn: E170001: OPTIONS of 'https://test.test.com/test/': authorization failed: Could not authenticate to server: rejected Basic challenge (https://test.test.com)\", \"rc\": 1, \"stderr\": \"svn: E170001: Unable to connect to a repository at URL 'https://test.test.com/test/'\\nsvn: E170001: OPTIONS of 'https://test.test.com/test/': authorization failed: Could not authenticate to server: rejected Basic challenge (https://test.test.com/test/)\\n\", \"stderr_lines\": [\"svn: E170001: Unable to connect to a repository at URL 'https://test.test.com/test/'\", \"svn: E170001: OPTIONS of 'https://test.test.com/test/': authorization failed: Could not authenticate to server: rejected Basic challenge (https://test.test.com/test/)\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWhen you run the command in the shell of the docker container and replace the password manually it successfully checks out the folder. \r\n\r\n```\r\nsvn --non-interactive --trust-server-cert --no-auth-cache --username testUser --password 'manuallyTypedPassword' checkout -r HEAD https://test.test.com/test/\r\n```\r\n\r\nAll the auth caches have been cleared. I think that it may not correctly be escaping the password or something similar?\r\n\r\n"},{"labels":["api",null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAdd an interface which allows users to replace the CACERT bundles used within Tower for custom cacerts. This allows users to add a cacert bundle for requests for scenarios such as winrm interfacing with Windows hosts using custom signed certificates. This is to circumvent modifying the cacert bundle on the backend of the Tower server and losing custom changes during upgrades/re-installations.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2+\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### SUMMARY\r\nThere should be a way for job templates to be source controlled repo aka git.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis feature can used  if we have 2 ansible instances. Dev and prod. And then if we have a promotion model for all our playbooks from dev to prod. But then right now the job templates needs to be created manually.\r\n\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.93\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: UBUNTU 16.04\r\n* Web Browser: Firefox 45.8\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI configured the VMWare source in a new Inventory. It is discovering the VM Guests and creating the groups as configured in the UI.\r\n\r\nThen I create a new Job Template using the Hello World playbook of the ansible examples to make sure that all is working.\r\n\r\nWhen I run the job template, it ends successfully, but I get at the output (STDOUT) the following error, impeding it to execute the playbook.\r\n\r\n [WARNING]:  * Failed to parse /tmp/awx_58_88J1ON/inventory with script plugin:\r\nlocal variable 'err' referenced before assignment\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/script.py\", line 99, in parse\r\n    raise AnsibleError(\"failed to parse executable inventory script results from {0}: {1}\\n{2}\".format(path, to_native(e), err))\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThis should run without any error.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThis is the STD OUT...\r\n\r\nIdentity added: /tmp/awx_58_88J1ON/credential_4 (/tmp/awx_58_88J1ON/credential_4)\r\nansible-playbook 2.4.0.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\nUsing /etc/ansible/ansible.cfg as config file\r\n **[WARNING]:  * Failed to parse /tmp/awx_58_88J1ON/inventory with script plugin:\r\nlocal variable 'err' referenced before assignment\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/script.py\", line 99, in parse\r\n    raise AnsibleError(\"failed to parse executable inventory script results from {0}: {1}\\n{2}\".format(path, to_native(e), err))**\r\n [WARNING]:  * Failed to parse /tmp/awx_58_88J1ON/inventory with ini plugin:\r\n/tmp/awx_58_88J1ON/inventory:3: Expected key=value host variable assignment,\r\ngot: {all: {hosts: [HOST-1A, HOST-1B, HOST-1C, HOST-1D, HOST-1E]}, _meta:\r\n{hostvars: {HOST-1D: {resourcepool: {_moId: resgroup-827, name: Resources},\r\nalarmactionsenabled: true, configissue: [], tag: [], datastore: [],\r\ntriggeredalarmstate: [], layout: {disk: [], swapfile: [HUS150-VOL211]\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/ini.py\", line 129, in parse\r\n    self._parse(path, data)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/ini.py\", line 208, in _parse\r\n    hosts, port, variables = self._parse_host_definition(line)\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/ini.py\", line 303, in _parse_host_definition\r\n    self._raise_error(\"Expected key=value host variable assignment, got: %s\" % (t))\r\n  File \"/usr/lib/python2.7/site-packages/ansible/plugins/inventory/ini.py\", line 134, in _raise_error\r\n    raise AnsibleError(\"%s:%d: \" % (self._filename, self.lineno) + message)\r\n [WARNING]: Unable to parse /tmp/awx_58_88J1ON/inventory as an inventory source\r\n [WARNING]: No inventory was parsed, only implicit localhost is available\r\n [WARNING]: Could not match supplied host pattern, ignoring: all\r\n [WARNING]: provided hosts list is empty, only localhost is available\r\nPLAYBOOK: hello_world.yml ******************************************************\r\n1 plays in hello_world.yml\r\nPLAY [Hello World Sample] ******************************************************\r\n21:00:13\r\nskipping: no hosts matched\r\nPLAY RECAP *********************************************************************\r\n21:00:13\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\nAny workflow template created with a survey not working for non-admin (normal-users), the workflow template survey comes up blank.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: All\r\n* AWX install docker on linux\r\n* Ansible version:  All\r\n* Operating System: CentOS7 and RHEL 7.4/7.3\r\n* Web Browser: Chrome/Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\nCreate any workflow\r\nAttach/create a survey\r\nAssign normal-user execute or even admin permission to workflow\r\nLunch the workflow as normal-user\r\n\r\n##### EXPECTED RESULTS\r\nSee the survey questions\r\n\r\n##### ACTUAL RESULTS\r\nSurvey questions missing\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nThe UI used to use the `team` field or the `user` field to designate the \"owner\" a long time in the past. It no longer uses this, but the API still caries logic for it. This logic should be on the deprecation schedule.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker for mac\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\ndo OPTIONS request for `/api/v2/credentials/`, or post with user or team fields in the body.\r\n\r\nIt's confusing to have fields valid for creation, but not valid for editing.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nInstead of this design, the user who creates the credential should be automatically assigned admin_role, like we do with job templates.\r\n\r\nWe have a serializer dedicated to this specific task.\r\n\r\nhttps://github.com/ansible/awx/blob/a0f1c8fc7c490fa368731690ca8c781b1dce5e2c/awx/api/serializers.py#L2162-L2236\r\n\r\nThat entire thing can be removed when we get rid of these.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf you modify a survey, changing questions to/from password-type, the default value will break.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System:\r\n* Web Browser:\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n - Create a survey in the UI\r\n - Either\r\n   - modify a survey type question to text\r\n   - modify a text question to be survey type\r\n - launch a job without answering questions, inspect values of variables\r\n\r\n##### EXPECTED RESULTS\r\n\r\nDefaults are preserved after modification?\r\n\r\nMore realistic: modification request returns error code with message about how to resolve the problem.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n - password-->non-password\r\n   - default becomes literal string \"$encrypted$\"\r\n - non-password-->password\r\n   - shows as \"$encrypted$\", but actually a hashed value that's passed to playbook\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nWill overlap with some concerns related to https://github.com/ansible/awx/issues/169\r\n"},{"labels":["api",null,null,null,null],"text":"We are using `with_items` for internal use in several playbooks:\r\n\r\nhttps://github.com/ansible/awx/search?q=with_items\r\n\r\nThese are being removed in a future version of Ansible.\r\n\r\n```\r\n[DEPRECATION WARNING]: with_ type loops are being phased out, use the 'loop' keyword instead. This feature will be removed in version 2.9. Deprecation warnings can be disabled\r\n by setting deprecation_warnings=False in ansible.cfg.\r\n```\r\n\r\nThose uses should be replaced with the new pattern, except for the test in the \"old\" folder. That test should just be removed completely."},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n\r\n##### SUMMARY\r\nAdd ability to limit fields in output for all get list requests (get projects list, get inventory list, get job templates list etc.)\r\n`https://.../?fields=id,description`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWill be included only `id` and `description` fields in output json.\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nAfter updating the docker images (awx-task and awx-web) and waiting a few minutes I launch the first job which requires an inventory sync. That inventory sync fails with `IOError: Source does not exist: /var/lib/awx/projects/_6__p1/hosts`\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.1.93\r\n* AWX install method: docker\r\n* Ansible version:  2.4.0.0\r\n* Operating System: CentOS 7.3\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Update docker images\r\n\r\n```\r\ndocker stop <awx_web and task>\r\ndocker pull ansible/awx_task\r\ndocker pull ansible/awx_web\r\n```\r\n\r\n2. Launch containers\r\n\r\n```\r\nansible-playbook -i inventory installer.yml\r\n```\r\n\r\n3. Wait a few moments then trigger job template via API\r\n\r\n##### EXPECTED RESULTS\r\n\r\nI expected job to run\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nJob fails with the following output\r\n\r\n```\r\n2017-10-25 15:09:01,086 INFO     awx.main.commands.inventory_import Updating inventory 3: j1\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/awx-manage\", line 9, in <module>\r\n    load_entry_point('awx==1.0.1.93', 'console_scripts', 'awx-manage')()\r\n  File \"/usr/lib/python2.7/site-packages/awx/__init__.py\", line 107, in manage\r\n    execute_from_command_line(sys.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 354, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/__init__.py\", line 346, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 394, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 445, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/awx/lib/python2.7/site-packages/django/core/management/base.py\", line 661, in handle\r\n    return self.handle_noargs(**options)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 1000, in handle_noargs\r\n    self.is_custom)\r\n  File \"/usr/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 234, in load_inventory_source\r\n    raise IOError('Source does not exist: %s' % source)\r\nIOError: Source does not exist: /var/lib/awx/projects/_6__p1/hosts\r\n```\r\n\r\nThe second launch of this same job succeeds.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nCurrently there is no way (that I can find) to add inventory and limit to an API call (or via the UI) when launching a workflow job template. Regular job templates include this functionality. \r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.1.50\r\n* AWX install method: docker\r\n* Ansible version:  2.4.0\r\n* Operating System: Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - Notifications\r\n\r\n##### SUMMARY\r\nI have a template with 50 hosts. When the job completions notification are sent (I use a webhook callback), they only contain data for ~16 hosts. If I immediately use the API to retrieve \"job_host_summaries\", I get only ~30 hosts. After a few secs, all the hosts are retrievable using the API.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0.588\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\nSince this is a timing problem, I don't know how to replicate it exactly, but with my setup (50 hosts and AWX hosted on a powerful server), even with the \"Hello World\" project, the notifications are sent too early\r\n\r\n##### ADDITIONAL INFORMATION\r\nhttps://github.com/ansible/awx/blob/73ece87e6895377b36cb7f19fb9d2bc414dad6cc/awx/main/models/jobs.py#L633\r\nAccording to this, this problem is known, but only wait for any host data to be available, but not all of it."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIf a JT has no survey and `\"ask_variables_on_launch\": false`, you can still force it to launch with your own variables by making a schedule that defines those variables inside of `extra_data`.\r\n\r\n##### ENVIRONMENT\r\nN/A\r\n\r\n##### STEPS TO REPRODUCE\r\n - Create a JT that does not prompt for variables and has no survey\r\n - Create a schedule that runs that JT, provide extra variables `foobar: foobaz`\r\n\r\n##### EXPECTED RESULTS\r\n\r\n1. Validation error saving the schedule\r\n2. Job does not have extra_vars of `foobar: foobaz`\r\n\r\n##### ACTUAL RESULTS\r\nno error saving.\r\n\r\njob has those extra_vars.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRealized while trying to scope out some things around https://github.com/ansible/awx/issues/169\r\n\r\nThis line of thinking will also lead us down a rabbit hole around what workflow extra variables can mean, artifacts, etc."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nI am attempting to setup ldap integrations to our AD. With the setup there is no feature to allow me to get feedback in regards to errors when querying AD. I am only allowed to save. So far, I have been unsuccessful in configuring this auth mechanism. Do you have additional documentation with steps on setting this up?\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.1.93\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: CentOS Linux release 7.2.1511 \r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nLog into AWX, Settings, Authentication, LDAP\r\n\r\n##### EXPECTED RESULTS\r\n\r\nConnection to Active Directory\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":" - Bug Report\r\n - UI\r\n\r\n##### SUMMARY\r\nAfter having successfully deployed AWX on an Openshift cluster following this blog post (https://developers.redhat.com/blog/2017/10/16/guide-starting-use-awx-top-openshift-upstream-red-hat-ansible-tower/); we are unable to start a deployement. The fetch of the playbook is failing on a \"permission denied on /tmp\"\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.1.93\r\n* AWX install method: openshift\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nDefine a new deployement.\r\n - Project creation is working fine and git repo is correctly fetched (using git credentials)\r\n- Inventory is defined (some variables in the json field of one group)\r\n- Create the template and associate everything.\r\n\r\nWe have a user dedicated to ansible on targeted hosts and are sudoers NOPASSWD.\r\n\r\nThe fetch of the  of the repo seems to work as the Project name appear with a green point on the task detail.\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe task should start and working correctly\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\nThe task hang in error with the following trace : \r\n```\r\nTraceback (most recent call last):\r\nFile \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 786, in run\r\nsafe_args = self.build_safe_args(instance, **kwargs)\r\nFile \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 1161, in build_safe_args\r\nreturn self.build_args(job, display=True, **kwargs)\r\nFile \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 1088, in build_args\r\nargs = ['ansible-playbook', '-i', self.build_inventory(job, **kwargs)]\r\nFile \"/usr/lib/python2.7/site-packages/awx/main/tasks.py\", line 681, in build_inventory\r\nwith open(path, 'w') as f:\r\nIOError: [Errno 13] Permission denied: u'/tmp/awx_28_Ee1gSY/inventory'\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nThe same scenario is being run correctly on an Ansible Tower (evaluation mode) version 3.1.3 "},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nI am trying to clone a repository from our internal Bitbucket server. The server runs with a self signed certificate. The clone operation breaks due to `Peer's Certificate issuer is not recognized`.\r\n\r\nAs a workaround, I tried to disabled SSL verification via the `.gitconfig` for the `root` user on the `awx-task` container, but with no luck. The process forked by AWX seems to ignore that. Second problem would be that this is just a transient solution.\r\n\r\nThe following Stackoverflow post describes another issue related to this:\r\nhttps://serverfault.com/questions/877530/git-called-by-awx-ignores-manually-installed-root-ca\r\n\r\n**This is essentially a showstopper for us, as we cannot clone Ansible provisioning code without pain.**\r\n\r\n##### ENVIRONMENT\r\n* AWX version: `1.0.1.81`\r\n* AWX install method: docker on CentOS 7 \r\n* Ansible version:  `2.4.0.0`\r\n* Web Browser: Chrome `62.0.3202.62`\r\n\r\n##### STEPS TO REPRODUCE\r\n* Create new credential entity for your repo via UI\r\n* Create new `Project` via the UI\r\n  * Use afore created credentials\r\n  * Use HTTPS protocol, use Git repo secured by self signed certificate\r\n\r\n##### EXPECTED RESULTS\r\n* Add a checkbox to the `Project` creation page that disables SSL verification for the given project\r\n* The forked `git clone` task command needs to leverage that setting\r\n* In result, the repo with the self-signed cert can be cloned\r\n\r\n##### ACTUAL RESULTS\r\n* Repo cannot be cloned due to certificate trust error\r\n\r\n##### ADDITIONAL INFORMATION\r\n![awx-git-clone-error](https://user-images.githubusercontent.com/282736/31938091-d6985bdc-b8b6-11e7-9fd6-8dffa1a89b70.png)\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCurrently if a credential type set up an environment variable injector, like `\"ENV_NAME\": \"{{some_input_value}}\"`, but the input value is not provided in credential `inputs`, the environment variable will still be set up as an empty string: `ENV_NAME=''`.\r\n\r\nIn reality, however, it is usually preferred the environment variable is *not set in the first place* if the value is not given, rather than providing an empty environment variable.\r\n\r\nIt would be better if we figure out a way of doing that.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: N/A\r\n* AWX install method: docker for mac\r\n* Ansible version: N/A\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nPing @ryanpetrello for opinion.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nCan the tower-cli have an option to upload inventories?\r\n\r\nInstead of creating the inventory object and adding groups and hosts.\r\n\r\nSimiliar to the functionality that the admin can use tower-manage (tower-manage inventory_import option).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: AWX 1.0.0.588\r\n* AWX install method:  docker on linux\r\n* Ansible version: Ansible 2.4.0.0\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n\r\n##### ACTUAL RESULTS\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen using credentials (specifically tested with Cloudforms credentials), a password with a string interpolation special character (\"%\") causes the parser to raise an exception. This can be fixed by \"escaping\" the character in the password with \"%%\". So, a password that's \"hello%world\" could be input as \"hello%%world\" and it will work (no exception and successful password string). \r\n\r\n##### ENVIRONMENT\r\n* AWX version: ansible-tower 3.1.5 (1.el7)\r\n* AWX install method: ansible-tower-setup-3.1.5.tar.gz + install.sh\r\n* Ansible version:  2.3.2.0 (2.el7)\r\n* Operating System: Red Hat Enterprise Linux Server release 7.4 (Maipo)\r\n* Web Browser: Chrome 61.0.3163.100 (Windows 10)\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nAdd a new Cloudforms credential with a password containing a \"%\" symbol. Use that credential in a dynamic inventory source (also to Cloudforms). \r\n\r\n##### EXPECTED RESULTS\r\n\r\nPassword is accepted and sent as seen in the text box input. \r\n\r\n##### ACTUAL RESULTS\r\n\r\nInventory sync failed because of a string interpolation failure (parsing the password). \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nException log:\r\n\r\n```\r\n  1.339 INFO     Updating inventory 3: Cloudforms Dynamic\r\n    1.358 INFO     Reading executable JSON source: /var/lib/awx/venv/tower/lib/python2.7/site-packages/awx/plugins/inventory/cloudforms.py\r\n    1.474 ERROR    Failed to load JSON from: \r\nTraceback (most recent call last):\r\n  File \"/usr/bin/tower-manage\", line 9, in <module>\r\n    load_entry_point('ansible-tower==3.1.5', 'console_scripts', 'tower-manage')()\r\n  File \"/lib/python2.7/site-packages/awx/__init__.py\", line 105, in manage\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/django/core/management/__init__.py\", line 354, in execute_from_command_line\r\n    utility.execute()\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/django/core/management/__init__.py\", line 346, in execute\r\n    self.fetch_command(subcommand).run_from_argv(self.argv)\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/django/core/management/base.py\", line 394, in run_from_argv\r\n    self.execute(*args, **cmd_options)\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/django/core/management/base.py\", line 445, in execute\r\n    output = self.handle(*args, **options)\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/django/core/management/base.py\", line 661, in handle\r\n    return self.handle_noargs(**options)\r\n  File \"/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 1290, in handle_noargs\r\n  File \"/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 503, in load_inventory_source\r\n  File \"/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 392, in load\r\n  File \"/lib/python2.7/site-packages/awx/main/management/commands/inventory_import.py\", line 380, in command_to_json\r\nRuntimeError: ['/var/lib/awx/venv/tower/lib/python2.7/site-packages/awx/plugins/inventory/cloudforms.py', '--list'] failed (rc=1) with output: Traceback (most recent call last):\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/awx/plugins/inventory/cloudforms.py\", line 464, in <module>\r\n    CloudFormsInventory()\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/awx/plugins/inventory/cloudforms.py\", line 51, in __init__\r\n    self.read_settings()\r\n  File \"/var/lib/awx/venv/tower/lib/python2.7/site-packages/awx/plugins/inventory/cloudforms.py\", line 140, in read_settings\r\n    self.cloudforms_pw = config.get('cloudforms', 'password')\r\n  File \"/usr/lib64/python2.7/ConfigParser.py\", line 623, in get\r\n    return self._interpolate(section, option, value, d)\r\n  File \"/usr/lib64/python2.7/ConfigParser.py\", line 691, in _interpolate\r\n    self._interpolate_some(option, L, rawval, section, vars, 1)\r\n  File \"/usr/lib64/python2.7/ConfigParser.py\", line 732, in _interpolate_some\r\n    \"'%%' must be followed by '%%' or '(', found: %r\" % (rest,))\r\nConfigParser.InterpolationSyntaxError: '%' must be followed by '%' or '(', found: '%7K'\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n\r\n##### SUMMARY\r\n[According to the documentation](http://docs.ansible.com/ansible-tower/latest/html/administration/tipsandtricks.html#locate-and-configure-the-ansible-configuration-file), an `ansible.cfg` adjacent to a playbook should be picked up and used by Ansible Tower during job run. This is not working.\r\n\r\nInstead, `ansible.cfg` inside a project is only read if it is at the root of the project.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 3.2.1.21\r\n* AWX install method: AMI provided by Ansible\r\n* Ansible version:  2.4.0.0\r\n* Operating System: CentOS 7.4.1708\r\n* Web Browser: Safari 11.0 (12604.1.38.1.7)\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a new project using [this repo](https://github.com/samdoran/bugdemo.git) and the `master` branch.\r\n2. Create a Job Template that runs `subdir/bug.yml` with Show Changes enabled and set the verbosity to 3(Debug).\r\n3. Run the Job Template.\r\n\r\n<img width=\"1008\" alt=\"screen shot 2017-10-20 at 12 38 02\" src=\"https://user-images.githubusercontent.com/4047861/31832758-23eb89a0-b596-11e7-83d4-79670f84357c.png\">\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAnsible will see the `ansible.cfg` adjacent to the playbook and use that. It will be reflected in the debug output:\r\n\r\n```\r\nIdentity added: /tmp/awx_66_RIxb4K/credential_3 (/tmp/awx_66_RIxb4K/credential_3)\r\nansible-playbook 2.4.0.0\r\n  config file = /var/lib/awx/projects/_6__bug_demo/subdir/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\nUsing /var/lib/awx/projects/_6__bug_demo/subdir/ansible.cfg as config file\r\n\r\n...\r\n\r\nTASK [Create a file using setting in ansible.cfg] ******************************\r\ntask path: /var/lib/awx/projects/_6__bug_demo/subdir/bug.yml:7\r\n\r\n...\r\n\r\n--- before: /tmp/template.txt\r\n+++ after: /tmp/tmpyRyXCE/template.j2\r\n@@ -1,2 +1,2 @@\r\n-# Ansible managed\r\n+# SET IN ADJACENT ANSIBLE.CFG\r\n # The line above should read SET IN ADJACENT ANSIBLE.CFG\r\n```\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAnsible does not see the config file and does not use settings specificed in the `ansible.cfg` adjacent to the playbook in the repository.\r\n\r\n```\r\nIdentity added: /tmp/awx_48_0lFZ3j/credential_3 (/tmp/awx_48_0lFZ3j/credential_3)\r\nansible-playbook 2.4.0.0\r\n  config file = None\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\nNo config file found; using defaults\r\nParsed /tmp/awx_48_0lFZ3j/tmpQ7jDnB.awxrest.py inventory source with script plugin\r\n\r\n...\r\n\r\nTASK [Create a file using setting in ansible.cfg] ******************************\r\ntask path: /var/lib/awx/projects/_6__bug_demo/subdir/bug.yml:7\r\n\r\n...\r\n\r\n--- before: /tmp/template.txt\r\n+++ after: /tmp/tmpcNJ5lq/template.j2\r\n@@ -1,2 +1,2 @@\r\n+# Ansible managed\r\n # The line above should read SET IN ADJACENT ANSIBLE.CFG\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nDisable job isolation seems to have no affect on this bug — behavior is the same in both cases.\r\n\r\nI also have a branch in that bug repo that puts an `ansible.cfg` file at the root of the repo. If you change the Project to use the `top-level-config` branch, then run the same Job Template, you can see that the config file at the root of the repo, not adjacent to the playbook, gets picked up. This should not be the case.\r\n\r\n```\r\nIdentity added: /tmp/awx_66_RIxb4K/credential_3 (/tmp/awx_66_RIxb4K/credential_3)\r\nansible-playbook 2.4.0.0\r\n  config file = /var/lib/awx/projects/_6__bug_demo/ansible.cfg\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible-playbook\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\nUsing /var/lib/awx/projects/_6__bug_demo/ansible.cfg as config file\r\nParsed /tmp/awx_66_RIxb4K/tmpbDIjjO.awxrest.py inventory source with script plugin\r\n\r\n...\r\n\r\nTASK [Create a file using setting in ansible.cfg] ******************************\r\ntask path: /var/lib/awx/projects/_6__bug_demo/subdir/bug.yml:7\r\n\r\n...\r\n\r\n--- before: /tmp/template.txt\r\n+++ after: /tmp/tmpyRyXCE/template.j2\r\n@@ -1,2 +1,2 @@\r\n-# Ansible managed\r\n+# SET IN PROJECT ROOT ANSIBLE.CFG\r\n # The line above should read SET IN ADJACENT ANSIBLE.CFG\r\n\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nWorkflow job templates do not allow arbitrary extra_vars entry on launch.\r\n\r\n##### STEPS TO REPRODUCE\r\nEdit a workflow job template.\r\n\r\n##### EXPECTED RESULTS\r\nAbility to prompt for variables on launch.\r\n\r\n##### ACTUAL RESULTS\r\nIt has survey option (which go into extra_vars), but no ability to prompt for variables on launch like you can with a JT, which allows for arbitrary extra_vars entry on launch.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nField `ask_variables_on_launch` on JT:\r\n\r\nhttps://github.com/ansible/awx/blob/764356bf477f339dfa933dce7eb825940c3fc2fd/awx/main/models/jobs.py#L248-L251\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - Installer\r\n\r\n##### SUMMARY\r\nWhen `http_proxy` variable is set in the installer inventory `awxrest.py` will try to use the proxy when making requests to the AWX API (http://awxweb:8052). That will cause an error since the proxy will not be able to access that internal URL.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.77\r\n* AWX install method: docker on linux (official images)\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Centos 7.4\r\n* Web Browser: Chrome 60\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Set `http_proxy` variable in installer inventory\r\n2. After installing AWX run any template\r\n\r\n##### EXPECTED RESULTS\r\nThe template should run without a problem\r\n\r\n##### ACTUAL RESULTS\r\nThe template will call ansible-playbook that will use the `awxrest.py` inventory script. The script will make a request to AWX API honoring http_proxy environment variable and fail.\r\n\r\n##### ADDITIONAL INFORMATION\r\nIncluding `awxweb` in the no_proxy variable solves the issue. This information should be included in the documentation and inventory comments. Another option is to have the container always include `awxweb` to the `no_proxy` environment variable. Or change the script to bypass proxy for local URLs.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nFound this issue when trying saving credential with null foreign keys\r\n\r\n##### ENVIRONMENT\r\n* AWX version: Any\r\n* AWX install method: docker for mac\r\n* Ansible version:  N/A\r\n* Operating System: N/A\r\n* Web Browser: N/A\r\n\r\n##### STEPS TO REPRODUCE\r\n- In AWX server, enter `shell_plus`,\r\n- In `shell_plus`, run `cred = Credential(name='hey', organization=None, credential_type=CredentialType.objects.get(pk=1), inputs={})`. Make sure the to-be-created credential won't conflict with existing ones.\r\n\r\n##### EXPECTED RESULTS\r\nCredential is created.\r\n\r\n##### ACTUAL RESULTS\r\nStack overflow with looping\r\n```\r\n...\r\n/awx_devel/awx/main/models/credential.pyc in __getattr__(self, item)\r\n    254         if item in V1Credential.FIELDS:\r\n    255             return self.inputs.get(item, V1Credential.FIELDS[item].default)\r\n--> 256         elif item in self.inputs:\r\n    257             return self.inputs[item]\r\n    258         raise AttributeError(item)\r\n\r\n/awx_devel/awx/main/models/credential.pyc in __getattr__(self, item)\r\n    254         if item in V1Credential.FIELDS:\r\n    255             return self.inputs.get(item, V1Credential.FIELDS[item].default)\r\n--> 256         elif item in self.inputs:\r\n    257             return self.inputs[item]\r\n    258         raise AttributeError(item)\r\n\r\n/awx_devel/awx/main/models/credential.pyc in __getattr__(self, item)\r\n    254         if item in V1Credential.FIELDS:\r\n    255             return self.inputs.get(item, V1Credential.FIELDS[item].default)\r\n--> 256         elif item in self.inputs:\r\n    257             return self.inputs[item]\r\n    258         raise AttributeError(item)\r\n...\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\nSetting null foreign keys like `\"organization\": null` is not permitted from API browser. That's probably why this issue has been hidden."},{"labels":["api"],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen using Tower to run the playbook with containing the win_pexec module, it would return error, which is working fine in Ansible core\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: 3.0.3\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.3.0\r\n* Operating System:\r\n* Web Browser:\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThe config in the yml is:\r\n- name: Application Release Execution\r\n  win_psexec:\r\n    chdir: '{{release_folder}}/'\r\n    command: cmd.exe /c \"{{release_folder}}/appRelease.bat >> {{release_folder}}/release.log\"\r\n    executable: '{{psexec_path}}'\r\n    hostnames: localhost\r\n    username: '{{appserver_username}}'\r\n    password: '{{appserver_password}}'\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\nERROR! no action detected in task. This often indicates a misspelled module name, or incorrect module path.\r\n\r\nThe error appears to have been in '/var/lib/awx/projects/_1232__<project_name>/roles/appserver/tasks/release.yml': line 1, column 3, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n\r\n- name: Application Release Execution\r\n  ^ here\r\n\r\n\r\nThe error appears to have been in '/var/lib/awx/projects/_1232__<project_name>/roles/appserver/tasks/release.yml': line 1, column 3, but may\r\nbe elsewhere in the file depending on the exact syntax problem.\r\n\r\nThe offending line appears to be:\r\n\r\n\r\n- name: Application Release Execution\r\n  ^ here\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen authenticating via LDAP (Active Directory), seeing sporadic login failures. I see errors in the awx_web container logs\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.0.588\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.3.2.0\r\n* Operating System: RHEL 7\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLogin via web UI. Logins sporadically fail. Can't reproduce the issue for local accounts (admin, etc.)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nLDAP Logins should consistently work\r\n\r\n##### ACTUAL RESULTS\r\n\r\nSporadic login failure/timeout\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n```\r\n2017/10/18 14:56:51 [warn] 597#0: *314 upstream server temporarily disabled while reading response header from upstream, client: 10.0.1.33, server: _, request: \"POST /api/v2/authtoken/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"host1.xxx.com\", referrer: \"http://host1.xxx.com/\"\r\n2017/10/18 14:56:51 [error] 597#0: *314 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 10.0.1.33, server: _, request: \"POST /api/v2/authtoken/ HTTP/1.1\", upstream: \"uwsgi://127.0.0.1:8050\", host: \"host1.xxx.com\", referrer: \"http://host1.xxx.com/\"\r\n10.0.1.33 - - [18/Oct/2017:14:56:51 +0000] \"POST /api/v2/authtoken/ HTTP/1.1\" 504 585 \"http://host1.xxx.com/\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36\" \"-\"\r\nWed Oct 18 14:56:52 2017 - *** HARAKIRI ON WORKER 1 (pid: 720, try: 1) ***\r\nWed Oct 18 14:56:52 2017 - HARAKIRI !!! worker 1 status !!!\r\nWed Oct 18 14:56:52 2017 - HARAKIRI [core 0] 10.95.126.12 - POST /api/v2/authtoken/ since 1508338491\r\nWed Oct 18 14:56:52 2017 - HARAKIRI !!! end of worker 1 status !!!\r\nDAMN ! worker 1 (pid: 720) died, killed by signal 9 :( trying respawn ...\r\nRespawned uWSGI worker 1 (new pid: 743)\r\nWSGI app 0 (mountpoint='') ready in 2 seconds on interpreter 0x1e3c560 pid: 743 (default app)\r\n```\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nAnsible 2.5 will adjust the playbook stats returned via callback... AWX may need updated for this.\r\nFiling for tracking reasons.\r\n\r\nAFAIK, the UI does not use this event, so it's just on the API side for now.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nhttps://github.com/ansible/ansible/issues/31245"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n - API\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nThis is half Feature Idea, half Bug because this makes ansible galaxy bearly useable in AWX/Tower.\r\n\r\nAs described in http://docs.ansible.com/ansible-tower/3.2.1/html/userguide/projects.html#ansible-galaxy-support , AWX is capable of running ansible-galaxy to load dependencys like Roles over a Ansible mechanism. Unfortunaly AWX/Tower seem to fail providing authentication credentials to galaxy. Thus it is not possible to safely clone from git repositoriy or provide any requirements where authentication is required.\r\n\r\n##### ENVIRONMENT\r\n\r\n- AWX version: 1.0.1.32\r\n- AWX install method: docker install via local build\r\n- Ansible version:  2.4.0.0\r\n- Host System: RHEL 7.4\r\n- Web Browser: Chrome\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThe project must include a roles/requirements.yml file with git requirements which require authentication for cloning.\r\n\r\nMy requirements contain following.\r\n```\r\n# Install a role from a specific git branch\r\n- name: myrole\r\n  src: ansible-awx@mydomain:8081/2911-ansible/roles/myrole.git\r\n  scm: git\r\n  version: master\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nThe clone of roles defined in requirements.yml should work.\r\nAt least the credentials for the project should be used for cloning from the same git server via ansible galaxy.\r\nIn the best case, the requirements.yml get detected and parsed after the clone of the project and AWX could somehow implement a method to even supply different credentials to different entrys in the requirements.yml\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nThe Cloning of a whole project with a requirements.yml is sucessfull however when running a template , ansiblegalaxy gets executed (which was skipped when cloning a whole project) and is cloning the roles without password or empty Passwort possibly because none where provided in the URI\r\n\r\n```\r\nTASK [fetch galaxy roles from requirements.yml] ********************************\r\nThe authenticity of host 'mydomain (10.xx.xx.xx)' can't be established.\r\nECDSA key fingerprint is SHA256:blabla\r\nECDSA key fingerprint is MD5:blabla\r\nAre you sure you want to continue connecting (yes/no)? \r\nansible-awx@mydomain's password: \r\nansible-awx@mydomain's password: \r\nansible-awx@mydomain's password: \r\nfatal: [localhost]: FAILED! => {\"changed\": true, \"cmd\": [\"ansible-galaxy\", \"install\", \"-r\", \"requirements.yml\", \"-p\", \r\n[.....]\r\n```\r\n\r\nSo as workaround one would have to add the credentials to the git SCM what nobody should ever do.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nCould be combined with #106 "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIt can take a very long time to run an ad hoc command against a _single_ host if that host exists inside of a larger inventory.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCreate an inventory with a large number of groups & hosts, then run a simple ad hoc command against a single host.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe output of `awxrest.py` (soon to be from internal method on Host model) should return only the hosts that the command is being ran against.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPassing the script contents of the entire inventory to Ansible can take a long time, bottlenecking the command run.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nAfter merging https://github.com/ansible/awx/pull/459 the implementation of this will be much more simple.\r\n\r\n`ansible-inventory` takes an option `--list-hosts`, which is analogous to --limit in playbook commands. Proof:\r\n\r\n```\r\n$ ansible-inventory --list-hosts hello_world -i static/just_hello_world --list\r\n{\r\n    \"_meta\": {\r\n        \"hostvars\": {\r\n            \"hello_world\": {}\r\n        }\r\n    }, \r\n    \"all\": {\r\n        \"children\": [\r\n            \"ungrouped\"\r\n        ]\r\n    }, \r\n    \"ungrouped\": {\r\n        \"hosts\": [\r\n            \"hello_world\"\r\n        ]\r\n    }\r\n}\r\n```\r\n\r\n(EDIT: this example was superficial and the functionality doesn't actually exist)\r\n\r\nTo keep the interface standard, that means we should allow use of a queryparam `list_hosts`, which will accept a list of hosts, in the same format that --limit does.\r\n\r\nThis should then be used anytime we're running an ad hoc command, because it will not affect the functionality of the command. We can not use this speedup for playbooks, because it will affect variables that can be accessed in the playbook."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAdd an organization-level role that would allow a user to execute all templates in the organization\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0\r\n\r\n##### STEPS TO REPRODUCE\r\nThis would allow assignment of general execute permissions to users without requiring assignment to teams or assignment of permissions at the template level.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nUser that launched a job, cannot see the job in the following scenario:\r\n\r\n1. I created a user X that is an Admin of a created organization, and the Admin gave privileges to user X to use a project. \r\n2. User x dynamically creates an inventory and template and then executes the template (successfully), and user can see the job at this point.\r\n3. User x then deletes the inventory and template, now User x cannot see the job even though User X is the one that launched the job.\r\n\r\nThis was done through the UI and cli with the same results.\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: 1.0.0.588\r\n* AWX install method: docker\r\n* Ansible version:  2.4.0.0\r\n* Operating System: RHEL 7.4\r\n* Web Browser: Firefox 52.3\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nexplained in the summary\r\n\r\n##### EXPECTED RESULTS\r\n\r\nUser X can see the job that User X launched\r\n\r\n##### ACTUAL RESULTS\r\n\r\nUser X cannot see the job that they launched it.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nSatellite 6 inventory does not list hosts that are not managed by Foreman, leaving the inventory incomplete. I think this is different from a behavior I used to see in AWX 1.0.0 and Ansible 2.3. This is a necessary behavior, as I am migrating old hosts to be Foreman-managed using Ansible.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.31\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Configure a Satellite 6 inventory\r\n1. Add a host to Satellite 6 that is not \"managed\"\r\n1. Sync the inventory\r\n1. The new host is not listed in Hosts.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe new host should be listed in Hosts.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe new host is not listed in Hosts, or used as part of the inventory.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nRunning an old copy of the Foreman remote inventory script on another machine, I am able to see the un-managed hosts alongside hostvars and `groups['all']`. This makes the AWX behavior even stranger. \r\n\r\nThe unmanaged hosts cannot even be iterated over with `groups['all']`."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nec2.py is out of date with that of the ansible-contrib version.\r\n\r\n##### ENVIRONMENT\r\nn/a\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nLook at [current awx ec2.py](https://github.com/ansible/awx/blob/devel/awx/plugins/inventory/ec2.py) and look at [current contrib ec2.py](https://github.com/ansible/ansible/blob/devel/contrib/inventory/ec2.py)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI want to be able to use the IAM Sts:AssumeRole feature so that I don't have to provide AWX with credentials to the AWS accounts it needs to, when instead it can pivot using the credentials given to the machine via its instance profile.\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nThere is no way to get a changed state in the AWX UI to detect configuration drift.  You either get a failed with an associated red dot or passed with an associated green dot.  Same with notifications.  This is particularly useful for detecting configuration drift on network equipment now that AWX added `diff`.  An operator could see that there is an out-of-compliance devices with either a yellow dot and/or notification, then go see what the actual difference is on that device.\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: X.Y.Z\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nN/A\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nN/A\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nN/A\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nN/A"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n- AWX task?\r\n\r\n##### SUMMARY\r\n\r\nWhen I ran a Job a second time against a set of host I've just rebuilt with `terraform`, it fails due to the host keys being different, invoking a possible spoofing attack. \r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.1.31\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4\r\n* Operating System: Centos7 docker's image\r\n* Web Browser: Chrome Version 61.0.3163.100 \r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n* Create a set of virtual machines\r\n* Execute a Job template a first time\r\n* Destroy then provision again the same set of VM\r\n* Execute again the same Job template\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAs said in the issue #387, host keys are ignored, thus the job execution should not fail for such a reason.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nAt the second execution, it fails with this output:\r\n```\r\nfatal: [node1.test]: UNREACHABLE! => {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\\r\\n@       WARNING: POSSIBLE DNS SPOOFING DETECTED!          @\\r\\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\\r\\nThe ECDSA host key for node1.test.somedomain.com has changed,\\r\\nand the key for the corresponding IP address xxx.xxx.xxx.xxx \\r\\nis unknown. This could either mean that\\r\\nDNS SPOOFING is happening or the IP address for the host\\r\\nand its host key have changed at the same time.\\r\\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\\r\\n@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @\\r\\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\\r\\nIT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!\\r\\nSomeone could be eavesdropping on you right now (man-in-the-middle attack)!\\r\\nIt is also possible that a host key has just been changed.\\r\\nThe fingerprint for the ECDSA key sent by the …\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nawx/api/serializers.py:\r\n```\r\n    def get_external_account(self, obj):\r\n        account_type = None\r\n        if getattr(settings, 'AUTH_LDAP_SERVER_URI', None) and feature_enabled('ldap'):\r\n            try:\r\n                if obj.pk and obj.profile.ldap_dn and not obj.has_usable_password():\r\n                    account_type = \"ldap\"\r\n            except AttributeError:\r\n                pass\r\n        if (getattr(settings, 'SOCIAL_AUTH_GOOGLE_OAUTH2_KEY', None) or\r\n                getattr(settings, 'SOCIAL_AUTH_GITHUB_KEY', None) or\r\n                getattr(settings, 'SOCIAL_AUTH_GITHUB_ORG_KEY', None) or\r\n                getattr(settings, 'SOCIAL_AUTH_GITHUB_TEAM_KEY', None) or\r\n                getattr(settings, 'SOCIAL_AUTH_SAML_ENABLED_IDPS', None)) and obj.social_auth.all():\r\n            account_type = \"social\"\r\n        if (getattr(settings, 'RADIUS_SERVER', None) or\r\n                getattr(settings, 'TACACSPLUS_HOST', None)) and obj.enterprise_auth.all():\r\n            account_type = \"enterprise\"\r\n        return account_type\r\n```\r\n\r\nThis field appears to be entirely informational. Any reason to not have it just be the account source ('google-oath', 'saml', etc.)\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nFor all our authentication providers, we have hardcoded icons and tooltip names, i.e., a Google icon and 'Sign in with Google'.\r\n\r\nWe should allow setting a 'name'  for a configuration. This name would be used in the tooltip. For example, setting the 'name' of the configuration to 'frobozz.com google domain'  would change the login tooltip to 'Login with frobozz.com google domain'.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.x\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis would just be a field on the login configurartion.\r\n\r\nA custom icon could be an additional enhancement on top of this.\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n\r\n##### SUMMARY\r\nAdd ability to adjust the timezone for notifications sent from Tower. For example: email notifications are currently hard coded to utilize UTC and cannot be modified.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 3.2+\r\n\r\n##### ADDITIONAL INFORMATION\r\n`$ date -u && cat /var/spool/mail/toweruser`\r\n\r\n```\r\nMon Oct 16 18:51:46 UTC 2017\r\nFrom donotreply@tower.example.com  Mon Oct 16 14:51:43 2017\r\nReturn-Path: <donotreply@tower.example.com>\r\nX-Original-To: toweruser@tower.example.com\r\nDelivered-To: toweruser@tower.example.com\r\nReceived: from tower.example.com (tower.example.com [127.0.0.1])\r\n        by tower.example.com (Postfix) with ESMTP id E1E8C20C978C\r\n        for <toweruser@tower.example.com>; Mon, 16 Oct 2017 14:51:43 -0400 (EDT)\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=\"utf-8\"\r\nContent-Transfer-Encoding: 7bit\r\nSubject: Job #25 'Demo Job Template' succeeded:\r\n https://tower.example.com/#/jobs/25\r\nFrom: donotreply@tower.example.com\r\nTo: toweruser@tower.example.com\r\nDate: Mon, 16 Oct 2017 18:51:43 -0000\r\nMessage-ID: <20171016185143.29044.83729@tower.example.com>\r\n\r\nJob #25 had status successful, view details at https://tower.example.com/#/jobs/25\r\n\r\n{\r\n    \"status\": \"successful\", \r\n    \"credential\": \"Demo Credential\", \r\n    \"name\": \"Demo Job Template\", \r\n    \"started\": \"2017-10-16T18:51:36.678918+00:00\", \r\n    \"extra_vars\": \"{}\", \r\n    \"traceback\": \"\", \r\n    \"friendly_name\": \"Job\", \r\n    \"created_by\": \"admin\", \r\n    \"project\": \"Demo Project\", \r\n    \"url\": \"https://tower.example.com/#/jobs/25\", \r\n    \"finished\": \"2017-10-16T18:51:43.589154+00:00\", \r\n    \"hosts\": {\r\n        \"localhost\": {\r\n            \"skipped\": 0, \r\n            \"ok\": 2, \r\n            \"changed\": 0, \r\n            \"dark\": 0, \r\n            \"failed\": false, \r\n            \"processed\": 1, \r\n            \"failures\": 0\r\n        }\r\n    }, \r\n    \"playbook\": \"hello_world.yml\", \r\n    \"limit\": \"\", \r\n    \"id\": 25, \r\n    \"inventory\": \"Demo Inventory\"\r\n}\r\n```"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe allow people to save 'artifacts' for a job via the `set_stats` module that is used for later steps in a workflow.\r\n\r\nWe should display these in job details.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe have generic clean-up options for old jobs. People ask for multiple enhancements to this:\r\n- only SCM updates\r\n- only inventory updates\r\n- per-job cleanup (on the 'COMPLETED JOBS' page for a particular job)\r\n- per-org cleanup\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nOptions include doing a batch delete (dependent on https://github.com/ansible/awx/issues/19) or a new management job (dependent on writing it)\r\n"},{"labels":["api",null,null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe support github.com OAuth for connecting to Tower.\r\n\r\nWe should support GitHub Enterprise as well (it's supported by the underlying library).\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nTo see the current job status, the execution steps and the real elapsed time, users must reload the webpage manually. AWX should provide these job informations update on the fly to the UI.\r\n\r\n##### ENVIRONMENT\r\n* AWX version:  1.0.1.31\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.4.0\r\n* Operating System: VirtualBox 5.2.26 - Centos 7 (AWX using official github installation guide)\r\n* Web Browser: MacOS Sierra --> Google ChromeVersion 61.0.3163.100 (Official Build) (64-bit) and Safari Version 11.0 (12604.1.38.1.7)\r\n\r\n##### STEPS TO REPRODUCE\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n1 - Create a job template.\r\n2 - Go to the JOBS view.\r\n3 - Choose it on the list.\r\n4 - Click in the launch/Relaunch(Rocket) button.\r\n5 - The status of the execution will modify to \"PENDING\" status and it will not be updated any more. \r\n6 - Reload the webpage and verify the new job status and the tasks log.\r\n\r\n##### EXPECTED RESULTS\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nAfter launch/Relaunch the Job, the job status view must load all the new job informations automatically. Users wants to see the job changes and its status on the fly. (Like Jenkins Console screen, for example).\r\n\r\n##### ACTUAL RESULTS\r\n<!-- For bug reports, what actually happened? -->\r\nUsers must reload the JOB webpage manually to be able to see the real job status and task logs.\r\n\r\n##### ADDITIONAL INFORMATION\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\nScreen Recorder of this issue:\r\n\r\nhttps://youtu.be/gB8X2VSf5XE"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea - Documentation\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nPiggybacking on https://github.com/ansible/awx/issues/166, the idea is that things created by a user in a team are created in a 'team' context by default and accessible by that team.\r\n\r\nExample:\r\n- Credentials created by the user are automatically assigned to the team (not the user)\r\n- JTs created by the user are automatically permissioned to the team\r\n- Schedules created by the user are editiable and manageable by the team\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nI think to do this in the most user-obvious and \"makes sense\" way, we'd need to logically map \"the team that gave the user permission to do the thing\" -> \"the team that is assigned to it.\"\r\n\r\nFor example, a user may be in 3 teams A, B, and C, but if team B is the one who can access the job template, team B is the one that can modify the schedules they create for it.\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nWhen a project is deleted from the UI the directories are left orphan on all nodes in the cluster. This leads to another manual step of deleting projects from the file system. It also balloons the size of the /var partition\r\n##### ENVIRONMENT\r\nAWX version: 1.0.1\r\nAnsible version: 2.4\r\nOperating System: RHEL 7\r\nWeb Browser: Chrome\r\n<!--\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n1. create project in UI\r\n2. delete project in UI\r\n3. navigate to file system on clusters \r\n\r\n##### EXPECTED RESULTS\r\nExpected that the files are cleaned when deleted from the UI\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\nIdeally deleting the files from the UI would remove them from all nodes in the cluster/instance group\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nValidation fails on complex LDAP User Search filters.\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: 1.0.1.8\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0\r\n* Operating System: CentOS 7\r\n* Web Browser: Firefox 55.0.3\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nFor example trying to use a nested group search filter will trigger \"Invalid filter\" error.\r\n\r\n```json\r\n[\r\n \"ou=Hosting,dc=domain,dc=local\",\r\n \"SCOPE_SUBTREE\",\r\n \"(&(objectClass=user)(memberOf:1.2.840.113556.1.4.1941:=CN=app_awx_users,ou=awx,ou=applicationgroups,ou=hosting,dc=domain,dc=local)(sAMAccountName=%(user)s))\"\r\n]\r\n```\r\n\r\nThat means that the valid users are members of nested groups that are in turn members of the APP_AWX_Users group. This is common in large AD because it's not realistic to add individual users to an application group when you need access for entire departments.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nSave the form.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nForm is not saved, red text appears under Ldap User Search box saying \"Invalid filter: ...\".\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n\r\nMy LDAP backend is Microsoft AD 2008 DFL.\r\n\r\nI have tried using the Ldap Group Type and Ldap Require Group to set a parent group with group members but none of the Group Types with Nested in the name have worked to lookup my user which is nested in one of the child-group members of the specified group DN in LDAP Require Group.\r\n\r\nSo when this doesn't work I use a more complex filter to search nested groups and that's when I ran into the validation bug. \r\n\r\nI did not submit a PR immediately because I think there should be a discussion whether this type of validation of LDAP filters is sound or not. And if the fix should be to add more characters to the regex so that this one example of a complex filter passes, or to avoid doing regex validation of LDAP filters altogether. \r\n\r\nSpeaking to a person on IRC they claim that with an IPA backend and Group Type set to NestedMemberDNGroupType they are able to use nested group memberships without a complex filter. \r\n\r\nI am unable to do this with an AD 2008 DFL backend. Unless I disable the regex validation and use a complex filter like the example I provided earlier."},{"labels":["api",null,null],"text":"##### Issue Type\r\n - Bug Report\r\n\r\n### Summary\r\n\r\nawx uses the `pexpect` library (https://pypi.python.org/pypi/pexpect) to interact with tasks it launches.  `pexpect` uses a pseudoterminal to interact with spawned processes; its implementation has _very poor_ performance for processes that write large quantities of data to stdout or stderr.  It gets significantly worse as the size of the output stream moves upwards.\r\n\r\n### Steps To Reproduce:\r\n\r\nLaunch an adhoc command in awx that prints ~50MB to stdout:\r\n\r\n`base64 /dev/urandom | head -c 50000000 > /tmp/large && cat /tmp/large && rm -f /tmp/large`\r\n\r\n### Expected Results:\r\n\r\nThe job finishes in a reasonable amount of time.  When `base64 /dev/urandom | head -c 50000000 > /tmp/large && cat /tmp/large && rm -f /tmp/large` is run outside of awx on moderate hardware, it finishes (and prints) in 30 seconds or less.\r\n\r\n### Actual Results:\r\n\r\nWhen run in awx, it can take 30 minutes to an hour+ for `pexpect` to finish reading and for the task to be marked as successful.\r\n\r\n```\r\n[root@awx /]# ps -ef | grep 544\r\nroot       544   484 16 21:17 ?        00:00:52 python manage.py celeryd -l DEBUG -B -Ofair --autoreload --autoscale=100,4 --schedule=/celerybeat-schedule -Q tower_scheduler,tower_broadcast_all,tower,awx, -n celery@awx\r\nroot       627   544  0 21:21 pts/1    00:00:00 /usr/bin/bwrap --unshare-pid --dev-bind / / --bind /tmp/awx_proot_RPuUm_/tmpUnraHj /awx_devel/awx/job_status --bind /tmp/awx_proot_RPuUm_/tmpKzsnac /tmp --bind /tmp/awx_proot_RPuUm_/tmpJtGeuj /var/lib/awx --bind /tmp/awx_proot_RPuUm_/tmpOL9Yy8 /var/log --bind /tmp/awx_97_7ANRVf /tmp/awx_97_7ANRVf --bind /venv/ansible /venv/ansible --bind /venv/awx /venv/awx --chdir /tmp/awx_97_7ANRVf ansible -i /awx_devel/awx/plugins/inventory/awxrest.py -u ryan -m shell -a cat /large all\r\n\r\n[root@awx /]# strace -p 544 -s 200\r\nProcess 544 attached\r\nmunmap(0x7f59a8aeb000, 52842496)        = 0\r\nwrite(33, \"\\33[0;32m\", 7)               = 7\r\nselect(0, NULL, NULL, NULL, {0, 100})   = 0 (Timeout)\r\nmmap(NULL, 52858880, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f59abd42000\r\nmunmap(0x7f59a5886000, 52842496)        = 0\r\nwait4(627, 0x7ffff29bff04, WNOHANG, NULL) = 0\r\nwait4(627, 0x7ffff29bff04, WNOHANG, NULL) = 0\r\nselect(37, [36], [], [], {0, 128232})   = 1 (in [36], left {0, 128228})\r\nread(36, \"\\r\\n\\33[0;32mahpzYQt2+QCd24SHaTOvV886IevFDQuWCUhkXoNIkzvRlBFZ4+GSx7xa6FXZH6j9RQXlO79ismgZ\\33[0m\\r\\n\\33[0;32mSm4rBs6jKoaD40348n3dDZgUYDrql/I+zLK3AYA/YWPDHFXrNGOMYXdcqI/g5DwEJZuaqX4ZC1QB\\33[0m\\r\\n\\33[0;32mvI0hM92tSgs4D\"..., 2000) = 2000\r\nread(36, \"le8MZKA/Fc1UpAcFgrzp0qG8MUwQd6fPbpvWCqkeW1i\\33[0m\\r\\n\\33[0;32mUPJK40bqtKPNWFwhDwQSn5I94T0hmy8HFJIHAfrP8oscWX6b4crKgN8QeggmW+8NK8RWmb26a4VY\\33[0m\\r\\n\\33[0;32m7PQULw0/ZXT670l4xlhNFIYvNezANgIc6b3DNguC01y2/EYm/EQ5abT\"..., 2000) = 2000\r\nread(36, \"M\\33[0m\\r\\n\\33[0;32m3Nza3oDg7o54MYucWVI/Lar2eWLBmgcDKe4dBI+tCV3PIf91PjqwrCyk/5ePMu899Hu6e5YH6IF/\\33[0m\\r\\n\\33[0;32m00oXmKktJXEnh7prLb2cYtQx5XnLI8n7NoP86CFLdtJ82h921ORnvhlwrsVcIRk0xTvvfr8hH5JR\\33[0m\\r\\n\\33[0;32mA3J3iBBt\"..., 2000) = 2000\r\n```\r\n\r\n...this tight select/read loop of 2k chunks goes on for some time:\r\n\r\nhttps://github.com/pexpect/pexpect/blob/master/pexpect/expect.py#L99\r\nhttps://github.com/pexpect/pexpect/blob/master/pexpect/pty_spawn.py#L406\r\nhttps://github.com/pexpect/pexpect/blob/master/pexpect/spawnbase.py#L152\r\n\r\n### Additional Information:\r\n\r\nThis issue was originally noticed due to verbose Satellite6 inventory imports which produced ~50MB of stdout data.\r\n\r\n`pexpect` has a configurable `maxread` that can be used to increase the number of bytes read:\r\nhttps://github.com/pexpect/pexpect/blob/master/pexpect/pty_spawn.py#L34\r\n\r\n...but the pty seems to impose an OS-dependent upper limit (looks like 2k on my Macbook Pro), so simply bumping `maxread` doesn't help."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nAWX backend is not only a REST service provider, but also a client to multiple third-party services, like log aggregators, notification backends, inventory sources and SSO providers. Ideally when AWX communicates with these services (via HTTPS in most of the cases), user should have the freedom to use custom CA certificates for verification, and to toggle off CA cert verification in general.\r\n\r\nThis issue is meant to be a tracker of all issues and pull requests that's related to providing CA cert verification toggle and customization for one or more third-party services, so that we can implement global verification toggle and customization Tower configurations when we have enough individual solutions.\r\n\r\nThis won't be an easy one-off work, as AWX rely on a non-trivial number of services, and individual implementation could be quite scattered around the code base. So any issues or pull requests that could enrich the list below is more than welcomed.\r\n\r\n- [x] Logging handlers.\r\n- [ ] Openstack inventory source: #404 #405.\r\n- [ ] LDAP auth provider: #411.\r\n- [ ] source control: #490 "},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nIn a job template, I think it would be great to be able to select multiple inventories. Also a feature like being able to target every hosts in every inventories for a job would be fantastic. "},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - Installer\r\n\r\n##### SUMMARY\r\nI cannot use SSL encrypted LDAP authentication because I see no way to provide my CA certificate to the containers or have an option in the installer to disable certificate verification.\r\n\r\nWhen logging in a certificate verification error comes up. \r\n\r\nIt would be awesome to have a `additional_ca_certificate` or `skip_verify_ssl` variable in the insaller inventory.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: d02221702fd680cd38068ec49597a7b627228c04\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.3.2.0\r\n* Operating System: Centos 7 (epel)\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n* Configure ansible-awx to use SSL encrypted ldap auth\r\n* Login\r\n\r\n##### EXPECTED RESULTS\r\nSuccessful login\r\n\r\n##### ACTUAL RESULTS\r\n```\r\n2017-10-12 10:06:12,414 DEBUG    django_auth_ldap Initiating TLS\r\n2017-10-12 10:06:12,426 WARNING  django_auth_ldap Caught LDAPError while authenticating username: CONNECT_ERROR({'info': \"TLS error -8172:Peer's certificate issuer has been marked as not trusted by the user.\", 'desc': 'Connect error'},)\r\n```\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWhen running a playbook locally I get a different result from running a playbook from AWX. When running locally, the vsphere_guest task returns as 'changed' with a proper object (`vm`) to iterate on. When running from AWX, I get an 'ok' and the following returned on the task:\r\n\r\n```\r\n{\r\n    \"_ansible_parsed\": true,\r\n    \"changed\": false,\r\n    \"_ansible_no_log\": false,\r\n    \"failed\": false,\r\n    \"_ansible_item_result\": true,\r\n    \"item\": {\r\n        \"vm_name\": \"ansible-test-deleteme\",\r\n        \"esxi_host\": \"REDACTED\",\r\n        \"num_cpus\": 2,\r\n        \"memory\": 2048,\r\n        \"datastore\": \"REDACTED\",\r\n        \"storage_gb\": 20\r\n    },\r\n    \"invocation\": {\r\n        \"module_args\": \"\"\r\n    },\r\n    \"msg\": \"vm ansible-test-deleteme not present\"\r\n}\r\n```\r\n\r\nNotably the `msg` field reporting back that the vm isn't present, resulting in the `vm` object being invalid for the rest of my play.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1\r\n* AWX install method: Docker on Linux\r\n* Ansible version:  2.3.0\r\n* Operating System: Ubuntu 16.04\r\n* Web Browser: Firefox\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nRun the task included below.\r\n\r\nOn AWX, have a prompt for extra variables, input and object such as:\r\n\r\n```\r\nvms:\r\n  - vm_name: \"ansible-test-deleteme\"\r\n    storage_gb: 20\r\n    memory: 2048\r\n    num_cpus: 2\r\n    datastore: \"REDACTED\"\r\n    esxi_host: \"REDACTED\"\r\n```\r\n\r\nand a survey for the following:\r\n\r\n```\r\nad_password\r\nad_username\r\n```\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe VM object should register as \"changed\" and register an object 'vm' to consume\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe above is returned from the task, and then when trying to grab `vm.ansible_facts.hw_eth0.ipaddresses` the entire play fails since `vm` does not exist:\r\n\r\n```\r\n{\r\n    \"msg\": \"The conditional check 'vm.ansible_facts.hw_eth0.ipaddresses' failed. The error was: error while evaluating conditional (vm.ansible_facts.hw_eth0.ipaddresses): 'dict object' has no attribute 'ansible_facts'\",\r\n    \"failed\": true\r\n}\r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nvsphere_guest task example:\r\n\r\n```\r\n- name: Create the VM instance\r\n  vsphere_guest:\r\n    vcenter_hostname: \"{{ vcenter_hostname }}\"\r\n    username: REDACTED\\{{ ad_username }}\r\n    password: \"{{ ad_password }}\"\r\n    guest: \"{{ item.vm_name }}\"\r\n    state: powered_on\r\n    vm_disk:\r\n      disk1:\r\n        size_gb: \"{{ item.storage_gb }}\"\r\n        type: thin\r\n        datastore: \"{{ item.datastore }}\"\r\n        folder: REDACTED\r\n    vm_nic:\r\n      nic1:\r\n        type: e1000\r\n        network: \"PG-VM\"\r\n        network_type: dvs\r\n    vm_hardware:\r\n      memory_mb: \"{{ item.memory }}\"\r\n      num_cpus: \"{{ item.num_cpus }}\"\r\n      osid: ubuntu64Guest\r\n      scsi: paravirtual\r\n      vm_cdrom:\r\n        type: \"iso\"\r\n        iso_path: \"REDACTED\"\r\n    vm_hw_version: vmx-08\r\n    esxi:\r\n      datacenter: REDACTED\r\n      hostname: \"{{ item.esxi_host }}\"\r\n    validate_certs: no\r\n  with_items:\r\n    - \"{{ vms }}\"\r\n```\r\n\r\nExample extra variables that was generated:\r\n\r\n```\r\nvms:\r\n  - vm_name: \"ansible-test-deleteme\"\r\n    storage_gb: 20\r\n    memory: 2048\r\n    num_cpus: 2\r\n    datastore: \"REDACTED\"\r\n    esxi_host: \"REDACTED\"\r\n\r\nad_username: $encrypted$\r\nad_password: $encrypted$\r\n```\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nOur upstream dependency `os-client-config` [support it](https://docs.openstack.org/os-client-config/latest/user/configuration.html). `tasks.py` should be modified to officially support it, too."},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWe have an immensely powerful search/filter feature... but it's hard to use.\r\n\r\nExample use case: \"I want to query for all job templates using an AWS credential\".\r\n\r\nAnswer: `job_template.extra_credentials.credential_type.name:\"Amazon Web Services\"`\r\n\r\nThis requires knowing the following about the API structure:\r\n- that you go through the 'job_template' redirect from the unified job template view\r\n- that the credentials are stored in `extra_credentials`\r\n- that you now need to look at `credential_type`\r\n- that it's delineated by `name`, not a `kind:aws` or similar\r\n\r\nIn essence, you need to either know the API like the back of your hand, or have the API browser open in another tab to craft the query.\r\n\r\nWe should do better.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.x\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\nAfter upgrading from 1.0.561 I started getting this error running any of my job templates:\r\n\r\n`ERROR! Unexpected Exception, this is probably a bug: 'ascii' codec can't decode byte 0xc3 in position 1551: ordinal not in range(128)`\r\n\r\nI tried to upgrade from every new tag since 1.0.0.588 with the same results\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.1.8\r\n* AWX install method: docker on linux (official builds)\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Centos 7.4\r\n* Web Browser: Chrome 60\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Upgrade AWX\r\n2. Run a job template\r\n\r\n##### EXPECTED RESULTS\r\n\r\nThe job template should run as before the upgrade\r\n\r\n##### ACTUAL RESULTS\r\n\r\nThe playbook fails with the error message:\r\n\r\n`ERROR! Unexpected Exception, this is probably a bug: 'ascii' codec can't decode byte 0xc3 in position 1382: ordinal not in range(128)\r\n`\r\n\r\nThe position varies from one template to another\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\ndebug output:\r\n`\r\nIdentity added: /tmp/awx_427_Qd0YLs/credential_2 (/tmp/awx_427_Qd0YLs/credential_2)\r\n2\r\nansible-playbook 2.4.0.0\r\n3\r\n  config file = /etc/ansible/ansible.cfg\r\n4\r\n  configured module search path = [u'/var/lib/awx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n5\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n6\r\n  executable location = /usr/bin/ansible-playbook\r\n7\r\n  python version = 2.7.5 (default, Aug  4 2017, 00:39:18) [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)]\r\n8\r\nUsing /etc/ansible/ansible.cfg as config file\r\n9\r\nERROR! Unexpected Exception, this is probably a bug: 'ascii' codec can't decode byte 0xc3 in position 1382: ordinal not in range(128)\r\n10\r\nthe full traceback was:\r\n12\r\nTraceback (most recent call last):\r\n13\r\n  File \"/usr/bin/ansible-playbook\", line 106, in <module>\r\n14\r\n    exit_code = cli.run()\r\n15\r\n  File \"/usr/lib/python2.7/site-packages/ansible/cli/playbook.py\", line 104, in run\r\n16\r\n    loader, inventory, variable_manager = self._play_prereqs(self.options)\r\n17\r\n  File \"/usr/lib/python2.7/site-packages/ansible/cli/__init__.py\", line 784, in _play_prereqs\r\n18\r\n    inventory = InventoryManager(loader=loader, sources=options.inventory)\r\n19\r\n  File \"/usr/lib/python2.7/site-packages/ansible/inventory/manager.py\", line 144, in __init__\r\n20\r\n    self.parse_sources()\r\n21\r\n  File \"/usr/lib/python2.7/site-packages/ansible/inventory/manager.py\", line 205, in parse_sources\r\n22\r\n    parse = self.parse_source(source, cache=cache)\r\n23\r\n  File \"/usr/lib/python2.7/site-packages/ansible/inventory/manager.py\", line 280, in parse_source\r\n24\r\n    display.warning('\\n* Failed to parse %s with %s plugin: %s' % (to_native(fail['src']), fail['plugin'], to_native(fail['exc'])))\r\n25\r\n  File \"/usr/lib/python2.7/site-packages/ansible/utils/display.py\", line 220, in warning\r\n26\r\n    self.display(new_msg, color=C.COLOR_WARN, stderr=True)\r\n27\r\n  File \"/usr/lib/python2.7/site-packages/ansible/utils/display.py\", line 114, in display\r\n28\r\n    msg = stringc(msg, color)\r\n29\r\n  File \"/usr/lib/python2.7/site-packages/ansible/utils/color.py\", line 93, in stringc\r\n30\r\n    return u\"\\n\".join([u\"\\033[%sm%s\\033\" % (color_code, t) for t in text.split(u'\\n')])\r\n31\r\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 1382: ordinal not in range(128)\r\n`"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nThe AWX Task container has a different local time than my Foreman instance, to which it reports facts. Whenever facts are reported to Foreman, Foreman marks their timestamp as \"four hours ago.\" This leaves those hosts appearing out-of-sync.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0.524\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.3.1.0\r\n* Operating System: CentOS Linux 7\r\n\r\n##### EXPECTED RESULTS\r\n\r\nAWX Task container should either match host timezone, or be configurable.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nUnable to  write ldap filter or  bind DN  with not english names, for example:\r\nCN=BindLdapUser,OU=AWXAdmins,OU=**Администраторы**,DC=somecompany,DC=com\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.0.553\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2.3.2.0\r\n\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. In UI open:  **Settings** -> **AUTHENTICATION** -> select **LDAP**\r\n2. Insert in the field LDAP BIND DN or LDAP REQUIRE GROUP something like this:\r\n    `CN=BindLdapUser,OU=AWXAdmins,OU=Администраторы,DC=somecompany,DC=com`\r\n3.  Try click **SAVE** button.\r\n\r\n##### EXPECTED RESULTS\r\nSaved settings and worked LDAP authentication.\r\n\r\n##### ACTUAL RESULTS\r\nError in message box:\r\n`Failed to save settings. Returned status: undefined . A server error has occurred`\r\n\r\n\r\n##### ADDITIONAL INFORMATION\r\nIf DN or LDAP  composed  only from english letters settings normally save.\r\n\r\nBelow piece  log of java console from my browser:\r\n\r\n```\r\nvendor.a4f215857035eea92e41.js:29 [Deprecation] Synchronous XMLHttpRequest on the main thread is deprecated because of its detrimental effects to the end user's experience. For more help, check https://xhr.spec.whatwg.org/.\r\nsend @ vendor.a4f215857035eea92e41.js:29\r\nvendor.a4f215857035eea92e41.js:436 TypeError: document.on is not a function\r\n    at atSideNavLink (http://some_awx_inst/static/js/app.4099ea5a2541e18632df.js:403:1526394)\r\n    at http://some_awx_inst/static/js/vendor.a4f215857035eea92e41.js:436:70281\r\n    at invokeLinkFn (http://some_awx_inst/static/js/vendor.a4f215857035eea92e41.js:436:70399)\r\n    at nodeLinkFn (http://some_awx_inst/static/js/vendor.a4f215857035eea92e41.js:436:55720)\r\n    at http://some_awx_inst/static/js/vendor.a4f215857035eea92e41.js:436:65511\r\n    at processQueue (http://some_awx_inst/static/js/vendor.a4f215857035eea92e41.js:436:117543)\r\n    at http://some_awx_inst/static/js/vendor.a4f215857035eea92e41.js:436:117810\r\n    at Scope.$eval (http://some_awx_inst/static/js/vendor.a4f215857035eea92e41.js:436:130738)\r\n    at Scope.$digest (http://some_awx_inst/static/js/vendor.a5f215857035eea92e41.js:436:128538)\r\n    at Scope.$apply (http://some_awx_inst/static/js/vendor.a4f215857035eea92e41.js:436:131164) <div class=\"at-Layout-side ng-isolate-scope\" ng-class=\"{'at-Layout-side--expanded': vm.isExpanded &amp;&amp; layoutVm.isLoggedIn}\" ng-show=\"layoutVm.isLoggedIn &amp;&amp; !layoutVm.licenseIsMissing\">\r\n(anonymous) @ vendor.a4f215857035eea92e41.js:436\r\n/static/languages/ru_RU.json Failed to load resource: the server responded with a status of 404 (Not Found)\r\nvendor.a4f215857035eea92e41.js:436 TypeError: Cannot set property 'loggedIn' of undefined\r\n    at app.4099ea5a2541e18632df.js:403\r\n    at processQueue (vendor.a4f215857035eea92e41.js:436)\r\n    at vendor.a4f215857035eea92e41.js:436\r\n    at Scope.$eval (vendor.a4f215857035eea92e41.js:436)\r\n    at Scope.$digest (vendor.a4f215857035eea92e41.js:436)\r\n    at Scope.$apply (vendor.a4f215857035eea92e41.js:436)\r\n    at done (vendor.a4f215857035eea92e41.js:436)\r\n    at completeRequest (vendor.a4f215857035eea92e41.js:436)\r\n    at XMLHttpRequest.xhr.onload (vendor.a4f215857035eea92e41.js:436)\r\n(anonymous) @ vendor.a4f215857035eea92e41.js:436\r\n/#/login:1 This page includes a password or credit card input in a non-secure context. A warning has been added to the URL bar. For more information, see https://goo.gl/zmWq3m.\r\napp.4099ea5a2541e18632df.js:403 promise resolved, and readyState: undefined\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 Socket deleted: undefined\r\napp.4099ea5a2541e18632df.js:403 promise resolved, and readyState: undefined\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\napp.4099ea5a2541e18632df.js:403 socket readyState at emit: 1\r\n/api/v2/settings/all/ Failed to load resource: the server responded with a status of 400 (BAD REQUEST)\r\n/api/v2/settings/all/ Failed to load resource: the server responded with a status of 500 (INTERNAL SERVER ERROR)\r\nvendor.a4f215857035eea92e41.js:436 PATCH http://some_awx_inst/api/v2/settings/all/ 500 (INTERNAL SERVER ERROR)\r\n(anonymous) @ vendor.a4f215857035eea92e41.js:436\r\nsendReq @ vendor.a4f215857035eea92e41.js:436\r\nserverRequest @ vendor.a4f215857035eea92e41.js:436\r\nprocessQueue @ vendor.a4f215857035eea92e41.js:436\r\n(anonymous) @ vendor.a4f215857035eea92e41.js:436\r\n$eval @ vendor.a4f215857035eea92e41.js:436\r\n$digest @ vendor.a4f215857035eea92e41.js:436\r\n$apply @ vendor.a4f215857035eea92e41.js:436\r\n(anonymous) @ vendor.a4f215857035eea92e41.js:436\r\ndispatch @ vendor.a4f215857035eea92e41.js:29\r\nelemData.handle @ vendor.a4f215857035eea92e41.js:29\r\n\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nIn my playbook, I need to become a \"non-root\" user (become_user: user1).\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: 1.0.0.573\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.1\r\n* Operating System: RHEL 7.3\r\n* Web Browser:\r\n-->Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nOn playbook with become \"non-root\" user escalation.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nOn Ansible Tower, launching the same playbook I have no error and we see a sudo in the debug message : \r\n\r\n`\r\nEXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=ansible -o ConnectTimeout=60 -o ControlPath=/tmp/ansible_tower_mnllKi/cp/%h%p%r server1 '/bin/sh -c '\"'\"'**sudo -H -S -n -u user1 /bin/sh -c '\"'\"'\"'\"'\"'\"'\"'\"'echo BECOME-SUCCESS-jkukqsralylqokbrfuyaizwikoucnypn; /usr/bin/python**'\"'\"'\"'\"'\"'\"'\"'\"' && sleep 0'\"'\"''\u001b \r\n`\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\nAWX displays the following error : \r\n\r\n \"msg\": \"Failed to set permissions on the temporary files Ansible needs to create when becoming an unprivileged user (rc: 1, err: chown: changing ownership of `/tmp/ansible-tmp-1507640208.53-227607229839391/': Operation not permitted\\nchown: changing ownership of `/tmp/ansible-tmp-1507640208.53-227607229839391/command.py': Operation not permitted\\n}). For information on working around this, see https://docs.ansible.com/ansible/become.html#becoming-an-unprivileged-user\".\r\n\r\nIn debug mode, the following message is display : \r\n\r\nSSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=ansible -o ConnectTimeout=60 -o ControlPath=/tmp/awx_253_i9fKoF/cp/%h%p%r server1 '/bin/sh -c '\"'\"'**chown user1 /tmp/ansible-tmp-1507640208.53-227607229839391/ /tmp/ansible-tmp-1507640208.53-227607229839391/command.py** && sleep 0'\"'\"''\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nI'm using LDAP for user authentication. (but i can reproduce the error with local users as well)\r\nI have a user, who is an Admin, but it can't add surveys to job templates. \r\nThis is the error i get:\r\nERROR!\r\nYou do not have permission to perform this action.\r\n\r\nApparently only the default Admin user can do that\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.0.561\r\n* AWX install method:  docker on linux (from docker hub)\r\n* Ansible version:  \r\n* Operating System: MacOS Sierra\r\n* Web Browser: Chrome\r\n\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\nLogin as a users, with admin roles, different from the local admin user.\r\nCreate a new job template, add a survey.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\nTo Be able to add the survey\r\n##### ACTUAL RESULTS\r\nUnable to add survey\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nRunning a template to execute a playbook fails with ssh unreachable because of strict key checking, I have set host_key_checking = False in ansible.cfg on both containers\r\nOn a standard Ansible installation not having to use an assortment of containers this option works as it is designed. \r\n\r\n##### ENVIRONMENT\r\n* AWX version: Unsure, Cloned as of last week\r\n* AWX install method: Playbook with docker\r\n* Ansible version:  2.3.2\r\n* Operating System: RHEL6.9\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\nStandard installation, happens when running any playbook, as the containers have never connected to the hosts (host_key_checking disables the initial part of ssh'ing to a new box where it asks a yes/no question about adding to known_hosts file)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nWhen using host_key_checking = False in the ansible.cfg file used it should skip the strict key checking, I've added it to both containers as it seems a bit vague as to which container is doing the actual connections\r\n\r\n##### ACTUAL RESULTS\r\n\r\nPlaybook fails with SSH Unreachable\r\n\r\n##### ADDITIONAL INFORMATION\r\nhttp://docs.ansible.com/ansible/latest/intro_getting_started.html#host-key-checking\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nJob permanently in \"Running\" state. Other jobs from the same template get queued.\r\n\r\nCancel button not effective. In the meantime I rebooted AWX machine, the job is still in the running state, the started time is the original one (i.e. it does not start again on reboot).\r\n\r\nJobs created from other templates work (start, finish) properly.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0.588\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  2.4.0.0\r\n* Operating System: CentOS 7\r\n* Web Browser: Chrome 61 / macOS\r\n\r\n##### STEPS TO REPRODUCE\r\nNot sure yet... This is more of a question how this can be resolved in its current state.\r\n\r\n##### ADDITIONAL INFORMATION\r\nPlaybook stopped running on gathering facts:\r\n\r\n```\r\nSSH password: \r\n\r\nPLAY [all] *********************************************************************19:02:44\r\n\r\nTASK [Gathering Facts] *********************************************************19:02:44\r\n```\r\n"},{"labels":["api"],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nIn my projects I have several playbooks organized by folder. For example:\r\n```\r\n├── playbooks\r\n│   ├── network\r\n│   │   └── facts.yml\r\n│   ├── spectrum\r\n│   │   ├── common\r\n│   │   │   ├── _fix_start_ss.yml\r\n│   │   │   └── _restrict.yml\r\n│   │   ├── files\r\n│   │   │   └── fixedStartSS.pl\r\n│   │   ├── patch\r\n│   │   │   ├── _apply_patch.yml\r\n│   │   │   ├── main.yml\r\n│   │   ├── recover\r\n│   │   │   ├── filter_plugins -> ../../../plugins/filter_plugins/\r\n│   │   │   ├── main.yml\r\n│   │   │   └── _recover.yml\r\n│   └── wlc\r\n│       └── sysinfo.yml\r\n└── plugins\r\n    └── filter_plugins\r\n        └── lsprimary.py\r\n```\r\n\r\nIf I want to reuse the lsprimary filter plugin I need to copy it to every playbook or create a symlink. AWX should load the plugins from the plugins folder in the root of the project, like its done for roles.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0.561\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Centos 7.4"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - Installer\r\n\r\n##### SUMMARY\r\nPostgreSQL 10.0 was just released. It features great improvements such as more efficient streaming replication, faster performance, and better user security by using SHA256 instead of MD5 for users' password hashes. Since this is the development environment for Ansible Tower, it would be great to see this version supported and tested out for a future release of Tower (3.3 or 3.4).\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0-588\r\n* AWX install method: all\r\n\r\n##### STEPS TO REPRODUCE\r\nInstall AWX. It will deploy a PostgreSQL 9.6 container.\r\n\r\n##### EXPECTED RESULTS\r\nInstalling AWX should deploy and use PostgreSQL 10.0.\r\n\r\n##### ACTUAL RESULTS\r\nPostgreSQL 9.6 is installed and used.\r\n\r\n##### ADDITIONAL INFORMATION\r\nRelease highlights: https://www.postgresql.org/about/news/1786/\r\nMajor upgrades notes for PostgreSQL 9 to 10: https://www.postgresql.org/docs/10/static/release-10.html#idm46046834255504\r\nFull release notes: https://www.postgresql.org/docs/10/static/release-10.html"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n- Feature Idea\r\n\r\n##### COMPONENT NAME\r\n- API\r\n - UI\r\n\r\n##### SUMMARY\r\nAs an AWX user I should be able to create a smart inventory smart host filter based on host vars associated with a host. The behavior of this feature should be the same as how a user can create a smart host filter based on `ansible_facts`.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nA dictionary called something like `host_vars` should be created that can be searched like this with a smart host filter:\r\n\r\n`host_vars.my_cool_hostvar:foo`\r\n\r\n##### ACTUAL RESULTS\r\n\r\nI would expect this to only result in showing hosts that have a host variable `my_cool_hostvar` set to `foo`.\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen you launch a job, the API returns the full serialization of the new job, _as if_ you performed a GET to the job detail view.\r\n\r\nWhen you update a project, it returns a minimal response like `{\"project_update\": 42}`.\r\n\r\nArguably, the project update endpoint (and others) should follow suit and return the full serialization of the newly-created object.\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nPOST to `/api/v2/job_templates/N/launch/`\r\n\r\nPOST to `/api/v2/projects/N/update/`\r\n\r\n##### EXPECTED RESULTS\r\n\r\nconsistency\r\n\r\n##### ACTUAL RESULTS\r\n\r\nsomewhat similar"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWhen you run a playbook, it ends with a summary of what hosts were changed.\r\n\r\nNot so for inventory imports. For the purpose of allowing tools that integrate with AWX to write idempotent logic, we should produce a simple True/False metric with inventory imports that signifies whether any host/group/variables content was changed, or it if was an effective no-op.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: all\r\n* AWX install method: N/A\r\n* Ansible version:  all\r\n\r\n##### EXPECTED RESULTS\r\n\r\nA \"changed\" flag at the end of an inventory import. Possibly in the API for inventory imports.\r\n\r\n##### ACTUAL RESULTS\r\n\r\nLogs, but these are non-obvious and likely incomplete.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nSomeone using the awx-manage inventory import command might also like to have this info.\r\n\r\nThis could also apply for system jobs.\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Documentation\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nMy mercurial repository requires a SSL certificate to authenticate. How can I configure it in AWX ?\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: devel\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0\r\n* Operating System: Linux\r\n* Web Browser: Chrome\r\n-->\r\n\r\n"},{"labels":["api",null,null],"text":"Not sure whether this has been reported before. I will still report it nonetheless. Thank you for your help.\r\n\r\n##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nI can't login using default credentials after a standard installation of AWX.\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: latest\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Debian Jessie\r\n* Web Browser: Chrome, Firefox\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Install AWX on docker on Debian Jessie as documented.\r\n2. Login using default credentials (admin password)\r\n\r\n##### EXPECTED RESULTS\r\n\r\nIt shouldn't log me out\r\n\r\n##### ACTUAL RESULTS\r\n\r\nIt logs me out immediately after I log in using default credentials. I did not change any values in inventory file prior to build.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nThis is the requests as shown under Developer Tools\r\n\r\n<img width=\"522\" alt=\"2017-10-04_1116\" src=\"https://user-images.githubusercontent.com/4113595/31158627-91e207ca-a8f5-11e7-94fd-8f296cfc36ee.png\">\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\n\r\nHello. I am having a problem performing callbacks from a job template in the UI. I currently have 2 hosts in inventory, but when I browse to the callback job in the API, it displays:\r\n\r\n\"matching_hosts\": []\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: 1.0.0.312\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.3.1.0\r\n* Operating System:\r\n* Web Browser: Chrome\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\nRun curl command from client requesting callback:\r\n\r\ncurl -d \"host_config_key=KEY\" http://awxweb:80/api/v2/job_templates/12/callback/\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\nExpected job template to run\r\n\r\n##### ACTUAL RESULTS\r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\nReceive error message on client:\r\n\r\n{\"msg\":\"No matching host could be found!\"}\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null,null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nproject checkout with the `subversion` module fails when `scm_password` is used with a Jinja `{{ | quote}}`\r\n\r\n##### ENVIRONMENT\r\n* AWX version:  1.0.0.561\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: Arch Linux\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\n1. Create a Subversion credential (user/pass, not SSH key)\r\n2. Create a project that checks out a repository using this key\r\n3. Run the update job for the project.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nno errors\r\n\r\n##### ACTUAL RESULTS\r\n\r\n```\r\nUsing /etc/ansible/ansible.cfg as config file\r\n[DEPRECATION WARNING]: DEFAULT_ASK_SUDO_PASS option, In favor of become which \r\nis a generic framework . This feature will be removed in version 2.8. \r\nDeprecation warnings can be disabled by setting deprecation_warnings=False in \r\nansible.cfg.\r\n\r\nPLAY [all] *********************************************************************\r\n\r\nTASK [delete project directory before update] **********************************\r\nok: [localhost]\r\n\r\nTASK [update project using git and accept hostkey] *****************************\r\nskipping: [localhost]\r\n\r\nTASK [Set the git repository version] ******************************************\r\nskipping: [localhost]\r\n\r\nTASK [update project using git] ************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Set the git repository version] ******************************************\r\nskipping: [localhost]\r\n\r\nTASK [update project using hg] *************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Set the hg repository version] *******************************************\r\nskipping: [localhost]\r\n\r\nTASK [update project using svn] ************************************************\r\nskipping: [localhost]\r\n\r\nTASK [Set the svn repository version] ******************************************\r\nskipping: [localhost]\r\n\r\nTASK [update project using svn with auth] **************************************\r\nfatal: [localhost]: FAILED! => {\"changed\": false, \"cmd\": \"/usr/bin/svn --non-interactive --trust-server-cert --no-auth-cache --username RO_USER --password '********' checkout -r HEAD https://svnrepo1/projects/trunk/admin/ansible /var/lib/awx/projects/_6__eai_ansible\", \"failed\": true, \"msg\": \"svn: E170001: Unable to connect to a repository at URL 'https://svnrepo1/projects/trunk/admin/ansible'\\nsvn: E170001: OPTIONS of 'https://svnrepo1/projects/trunk/admin/ansible': authorization failed: Could not authenticate to server: rejected Basic challenge (https://svnrepo1)\", \"rc\": 1, \"stderr\": \"svn: E170001: Unable to connect to a repository at URL 'https://svnrepo1/projects/trunk/admin/ansible'\\nsvn: E170001: OPTIONS of 'https://svnrepo1/projects/trunk/admin/ansible': authorization failed: Could not authenticate to server: rejected Basic challenge (https://svnrepo1)\\n\", \"stderr_lines\": [\"svn: E170001: Unable to connect to a repository at URL 'https://svnrepo1/projects/trunk/admin/ansible'\", \"svn: E170001: OPTIONS of 'https://svnrepo1/projects/trunk/admin/ansible': authorization failed: Could not authenticate to server: rejected Basic challenge (https://svnrepo1)\"], \"stdout\": \"\", \"stdout_lines\": []}\r\n\r\nPLAY RECAP *********************************************************************\r\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1   \r\n```\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nIn looking at the `awx/playbooks/project_update.yml`, I was able to reproduce this by itself on Ansible Core : ansible/ansible#31250\r\n\r\nIf you take out the Jinja callout to `quote` for `scm_password`, it works successfully.  I don't know if that means that `quote` is broken, or how it's passed along within the `subversion` module."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nAnsible in 2.4 supports multiple vault credentials, each with its own ID. AWX needs to support this as well.\r\n\r\nThis breaks the 1-1 vault credential/job template mapping, and therefore requires some work.\r\n\r\nLikely has knock-on effects for #223 \r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nCurrently, our GCP credentials are:\r\n- service account email\r\n- project name\r\n- key\r\n\r\nHowever, current GCP best practice is to use the JSON format of their credentials (which is what GCP gives you by default). This JSON file contains all the above data (and more).\r\n\r\nWe should move to just supporting the JSON format, rather than requiring people to cut and paste values out of the JSON.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nInventory variable name/value for determining whether a host is active from ENV, with fallback to **./awx/settings/defaults.py** with fallback to defautls.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0.592 / latest\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0\r\n* Operating System: CentOS 7\r\n\r\n##### STEPS TO REPRODUCE\r\nset ENV variable for source based inventory in my case, but should be more genral like in your code\r\n- SCM_ENABLED_VAR\r\n- SCM_ENABLED_VALUE\r\n\r\n```\r\n./awx/main/tasks.py:        if getattr(settings, '%s_ENABLED_VAR' % src.upper(), False):\r\n./awx/main/tasks.py:                        getattr(settings, '%s_ENABLED_VAR' % src.upper())])\r\n./awx/main/tasks.py:        if getattr(settings, '%s_ENABLED_VALUE' % src.upper(), False):\r\n./awx/main/tasks.py:                        getattr(settings, '%s_ENABLED_VALUE' % src.upper())])\r\n```\r\n\r\n##### EXPECTED RESULTS\r\nthe hosts enabled state is changed for hosts, where the **ENABLED_VAR** and **ENABLED_VALUE** matches for given source type.\r\n\r\n##### ACTUAL RESULTS\r\nWhens et ENV variabel for SMC based inventory, nothing happens. The **installer/image_build/files/settings.py** needs to be changed and the docker image full rebuild is needed.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nGeneraly, consider to read more variables from ENV, where UI allows to set it."},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nThere are likely cases where multiple secret/temp files are necessary for managed credential types (e.g. [winrm certificate auth](https://github.com/diyan/pywinrm/#valid-transport-options) requires `cert_pem` and `cert_key_pem` files).\r\n\r\nThis should be backwards compatible w/ current `template`/`{{tower.filename}}` syntax.\r\n\r\n##### EXPECTED RESULTS\r\n\r\nSomething like:\r\n\r\n```\r\n\"injectors\": {\r\n    \"file\": {\r\n        \"template.cert\": \"{{cert}}\",\r\n        \"template.key\": \"{{key}}\"\r\n    },\r\n    \"env\": {\r\n        \"MY_CERT\": \"{{tower.filename.cert}}\",\r\n        \"MY_KEY\": \"{{tower.filename.key}}\"\r\n    }\r\n}\r\n```"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nExample, from GitHub:\r\n\r\n![screenshot from 2016-08-26 15-41-33](https://cloud.githubusercontent.com/assets/5208768/18018209/a1d31c9a-6ba3-11e6-86bd-d91d9871bc18.png)\r\n\r\nThis provides more meaningful content on the key than our current `$encrypted$` display.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nAn example:\r\n\r\n-  Click 'add users to team'.\r\n- Select all users\r\n- Hit submit.\r\n- Users are added to team\r\n- Click 'add users to team' again\r\n- All users still available for selection\r\n\r\nThis is global paradigm across the app - we don't filter \"already applied\" items out of available choices. (Other examples: inventory host/group association.)\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nFiled as UI feature. May need API query help.\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nAnsible 2.0 supports the verify_commit option on checkout:\r\n\r\n```\r\nif yes, when cloning or checking out a version verify the signature of a GPG signed commit.\r\nThis requires git version>=2.1.0 to be installed.\r\nThe commit MUST be signed and the public key MUST be trusted in the GPG trustdb.\r\n```\r\n\r\nThis would require:\r\n- [ ] parameter on the project\r\n- [ ] figuring out how to use multiple keys\r\n- [ ] a gpg trustdb exposed to the checkout\r\n\r\nDoing the last of these in a way that's not gross may be complicated.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nWe currently are fixed on:\r\n- celery 3.1.17\r\n- kombu 3.0.35\r\n\r\nCurrent upstream is:\r\n- celery 4.1.0\r\n- kombu 4.1.0\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\nGiven that we're not even on the latest 3.1.x due to issues seen when upgrading, there is a high risk of complication here.\r\n"},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nCurrently the permissions structure does not allow for job template admins to cancel a scheduled job. This can cause issues if a job or workflow gets stuck.\r\n\r\n##### ENVIRONMENT\r\nAWX version: 3.1.4\r\nAnsible version: 2.4\r\nOperating System: RHEL 7\r\nWeb Browser: Chrome\r\n<!--\r\n* AWX version: X.Y.Z\r\n* AWX install method: openshift, minishift, docker on linux, docker for mac, boot2docker\r\n* Ansible version:  X.Y.Z\r\n* Operating System:\r\n* Web Browser:\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n1. schedule a job or workflow as any user\r\n2. attempt to cancel the job with a non-system admin user\r\n\r\n<!-- For bugs, please show exactly how to reproduce the problem. For new\r\nfeatures, show how the feature would be used.  -->\r\n\r\n##### EXPECTED RESULTS\r\n\r\nExpectation is that admin on job template/workflow should allow for these scheduled jobs to be canceled.\r\n\r\n\r\n<!-- For bug reports, what did you expect to happen when running the steps\r\nabove? -->\r\n\r\n##### ACTUAL RESULTS\r\n\r\nReceive a 403 access denied on the UI/API when trying to cancel a scheduled job. \r\n\r\n<!-- For bug reports, what actually happened? -->\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n<!-- Include any links to sosreport, database dumps, screenshots or other\r\ninformation. -->\r\n"},{"labels":["api",null,null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - API\r\n - UI\r\n - Installer\r\n\r\n##### SUMMARY\r\nAfter setting the splunk logging at the AWX UI, i am not able to see any logs at the splunk interface. \r\n\r\n```\r\ndocker -f logs awx_web \r\n\r\n2017-10-02 08:48:39,088 WARNING  awx.api.generics status 500 received by user admin attempting to access /api/v2/settings/logging/test/ from 10.35.100.2\r\n[pid: 443|app: 0|req: 391/8226] 10.35.100.2 () {52 vars in 2293 bytes} [Mon Oct  2 08:48:39 2017] POST /api/v2/settings/logging/test/ => generated 26 bytes in 95 msecs (HTTP/1.1 500) 7 headers in 216 bytes (1 switches on core 0)\r\n10.35.100.2 - - [02/Oct/2017:08:48:39 +0000] \"POST /api/v2/settings/logging/test/ HTTP/1.1\" 500 37 \"https://tower.app.foo.net/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36\" \r\n```\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: 1.0.0.526\r\n* AWX install method: docker on linux\r\n* Ansible version:   2.3.2.0\r\n* Operating System: Centos 7\r\n* Web Browser: Google Chrome \r\nVersion 61.0.3163.100 \r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nBelow is my settings:\r\n\r\n![screen shot 2017-10-02 at 13 07 15](https://user-images.githubusercontent.com/97524/31073056-08496446-a773-11e7-9334-a1db03b154eb.png)\r\n\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTo see some output at the splunk search:\r\n\r\nindex=awx\r\n\r\n##### ACTUAL RESULTS\r\n\r\nNo results\r\n##### ADDITIONAL INFORMATION\r\n\r\nToken is created for submitting logs. inventory outputs is as below:\r\n\r\n```\r\nlocalhost ansible_connection=local ansible_python_interpreter=\"/usr/bin/env python\"\r\n[all:vars]\r\nuse_container_for_build=true\r\nawx_official=false\r\npostgres_data_dir=/mnt/pgdocker\r\nhost_port=80\r\npg_username=awx\r\npg_password=xxx!\r\npg_database=awx\r\npg_port=5432\r\nawx_secret_key=xxx\r\n```\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\nWith the split of SSH credential and Vault credential we need to be able to add multiple credentials through API. This is not supported at the moment.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: 1.0.0.561\r\n* AWX install method: docker on linux\r\n* Ansible version:  2.4.0.0\r\n* Operating System: CentOS 7.3\r\n* Web Browser: Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI use a custom Python script with requests to process the below:\r\n\r\n  tower_job_templates:\r\n      - name: \"alpine-core - deploy\"\r\n        job_type: run\r\n        inventory: \"alpine-core\"\r\n        project: \"master-alpine-core\"\r\n        machine_credential: \"alpine-core machine-credential\"\r\n        playbook: playbooks/alpine_core/deploy.yml\r\n        extra_vars: \"env: '{{ ansible_local.local_facts.env }}'\"\r\n        survey_enabled: yes\r\n        allow_simultaneous: yes\r\n        endpoint: \"job_templates/\"\r\n\r\n##### EXPECTED RESULTS\r\n\r\nTemplate created with both Machine and Vault credential added.\r\n\r\n##### ACTUAL RESULTS\r\n\r\n[*] creating tower_job_templates; invalid response from HTTP: https://mdc-co-awx01.msgreen.dom/api/v1/job_templates/ code: 400, BAD REQUEST: {\"credential\":[\"Must either set a default value or ask to promp\r\nt on launch.\"]}\r\ninvalid response from HTTP: https://mdc-co-awx01.msgreen.dom/api/v1/job_templates/ code: 400, BAD REQUEST: {\"credential\":[\"Must either set a default value or ask to prompt on launch.\"]}\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"This is likely to be done as part of container configuration. It needs to support both standalone Docker deployments and container cluster style deployments. This also needs to be dynamic so it can be reconfigured in the application without needing to regenerate the containers. This also allows for easy propogation across the cluster in the same way we perform some other cluster-wide operations."},{"labels":["api",null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nWe would like to have the ability to add schedules where we can setup the INVENTORY and the CREDENTIALS we want that scheduled JOB to run against.\r\n\r\nRight now, the only way of doing what I need with a generic JOB is to copy it and set the values for that specific JOB and then I can add a schedule.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX version: 1.0.0.550\r\n* AWX install method:  docker on linux\r\n* Ansible version:  2,4.0\r\n* Operating System: FC26\r\n* Web Browser: Firefox/Chrome\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nI want to run the same JOB over several different clients, and I want to add different schedules for each one.\r\nI'd like the ability to chose an INVENTORY and CREDENTIALS for that specific scheduled JOB.  Also, if the job has surveys, I'd also like to be able to chose those values.  Right now that's feasible via the environment, but it'll be nice to pick it from the survey elements directly, if possible.\r\n\r\nI could be running the same JOB against 500 clients on different schedules and each client has a different CREDENTIAL to connect. \r\n\r\nThe silly way of doing it is probably via the REST API, by duplicating the JOBS with the wanted variables, including INVENTORY and CREDENTIAL, and then adding the specific schedule to it, but I think that duplication should be avoided in this case.\r\n\r\n##### EXPECTED RESULTS\r\n\r\n##### ACTUAL RESULTS\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n - Feature Idea\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\nWhen a job template is to be run at different times with different tags, the only prompting currently available is the Prompt on Launch option, which requires users to enter each desired tag explicitly and without prompting.\r\n\r\n##### ENVIRONMENT\r\n\r\n* AWX 1.0.0\r\n* Ansible 2.3.2\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nThis suggestion is to add a survey-like multi-select dialog to prompting options for job tags in template runs.  This would also allow for a default selection to be established.  The list could be either populated manually to avoid the need for parsing the playbook in advance of running it.\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\n\r\n![screenshot from 2017-09-28 14-41-25](https://user-images.githubusercontent.com/5208768/30984403-3986e62a-a45b-11e7-9d34-01d26eb9753e.png)\r\n\r\n*How* to sort it might be worth discussion (US first? Alphabetically?), but the current unsorted is odd.\r\n\r\n##### ENVIRONMENT\r\n* AWX version: currentish\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nGo to Inventory Source, select AWS, select region dropdown.\r\n\r\n##### ADDITIONAL INFORMATION\r\n"},{"labels":["api",null,null,null],"text":"##### ISSUE TYPE\r\n<!--- Pick one below and delete the rest: -->\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->\r\n - UI\r\n\r\n##### SUMMARY\r\n<!-- Briefly describe the problem. -->\r\nAny job i try to run just stays in pending. I have no other jobs running\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: latest\r\n* Ansible version:  2.3.1\r\n* Operating System: Centos 7\r\n* Web Browser: Chrome\r\n-->\r\n\r\n##### STEPS TO REPRODUCE\r\n\r\nCan't find a way\r\n\r\n##### EXPECTED RESULTS\r\nJob should run\r\n\r\n##### ACTUAL RESULTS\r\n\r\njob staying in pendning\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\noutput from awx_task log:\r\n\r\n```\r\n[2017-09-27 21:53:56,680: DEBUG/Worker-42] Running Tower task manager.\r\n2017-09-27 21:53:56,690 DEBUG    awx.main.scheduler Starting Scheduler\r\n2017-09-27 21:53:56,690 DEBUG    awx.main.scheduler Starting Scheduler\r\n[2017-09-27 21:53:56,690: DEBUG/Worker-42] Starting Scheduler\r\n2017-09-27 21:53:56,732 DEBUG    awx.main.scheduler project_update 123 (pending) is blocked from running\r\n2017-09-27 21:53:56,732 DEBUG    awx.main.scheduler project_update 123 (pending) is blocked from running\r\n[2017-09-27 21:53:56,732: DEBUG/Worker-42] project_update 123 (pending) is blocked from running\r\n[2017-09-27 21:53:56,748: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[a1bc3e85-bf92-47dc-bce7-4dc2c94a0e2d] succeeded in 0.0872339019988s: None\r\n[2017-09-27 21:54:16,590: INFO/MainProcess] Received task: awx.main.scheduler.tasks.run_task_manager[5f2404ff-bc40-4d0e-8732-28715e1e3dd6] expires:[2017-09-27 21:54:36.587988+00:00]\r\n[2017-09-27 21:54:16,591: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x5c62668> (args:(u'awx.main.scheduler.tasks.run_task_manager', u'5f2404ff-bc40-4d0e-8732-28715e1e3dd6', [], {}, {u'utc': True, u'is_eager': False, u'chord': None, u'group': None, u'args': [], u'retries': 0, u'delivery_info': {u'priority': None, u'redelivered': False, u'routing_key': u'tower', u'exchange': u'tower'}, u'expires': u'2017-09-27T21:54:36.587988+00:00', u'hostname': 'celery@localhost', u'task': u'awx.main.scheduler.tasks.run_task_manager', u'callbacks': None, u'correlation_id': u'5f2404ff-bc40-4d0e-8732-28715e1e3dd6', u'errbacks': None, u'timelimit': [None, None], u'taskset': None, u'kwargs': {}, u'eta': None, u'reply_to': u'64ec93c0-61c0-3f6d-8363-645f9f0796f5', u'id': u'5f2404ff-bc40-4d0e-8732-28715e1e3dd6', u'headers': {}}) kwargs:{})\r\n[2017-09-27 21:54:16,594: DEBUG/MainProcess] Task accepted: awx.main.scheduler.tasks.run_task_manager[5f2404ff-bc40-4d0e-8732-28715e1e3dd6] pid:198\r\n[2017-09-27 21:54:16,586: INFO/MainProcess] Scheduler: Sending due task task_manager (awx.main.scheduler.tasks.run_task_manager)\r\n[2017-09-27 21:54:16,588: DEBUG/MainProcess] awx.main.scheduler.tasks.run_task_manager sent. id->5f2404ff-bc40-4d0e-8732-28715e1e3dd6\r\n[2017-09-27 21:54:16,594: DEBUG/MainProcess] beat: Waking up in 9.95 seconds.\r\n2017-09-27 21:54:16,617 DEBUG    awx.main.scheduler Running Tower task manager.\r\n2017-09-27 21:54:16,617 DEBUG    awx.main.scheduler Running Tower task manager.\r\n[2017-09-27 21:54:16,617: DEBUG/Worker-42] Running Tower task manager.\r\n2017-09-27 21:54:16,624 DEBUG    awx.main.scheduler Starting Scheduler\r\n2017-09-27 21:54:16,624 DEBUG    awx.main.scheduler Starting Scheduler\r\n[2017-09-27 21:54:16,624: DEBUG/Worker-42] Starting Scheduler\r\n2017-09-27 21:54:16,659 DEBUG    awx.main.scheduler project_update 123 (pending) is blocked from running\r\n2017-09-27 21:54:16,659 DEBUG    awx.main.scheduler project_update 123 (pending) is blocked from running\r\n[2017-09-27 21:54:16,659: DEBUG/Worker-42] project_update 123 (pending) is blocked from running\r\n[2017-09-27 21:54:16,669: INFO/MainProcess] Task awx.main.scheduler.tasks.run_task_manager[5f2404ff-bc40-4d0e-8732-28715e1e3dd6] succeeded in 0.0774938369996s: None\r\n```"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n\r\n##### COMPONENT NAME\r\n - UI\r\n\r\n##### SUMMARY\r\nI am trying to connect awx to our Microsoft Active Directory and encounter the following problem\r\n\r\nawx only tries to establish a connection to the ad/ldap server if i write the user name : domain\\username\r\n\r\nThis fails: Filter: sAMAccountName=domain\\username\r\nthe request should look like this: sAMAccountName=username\r\n\r\nIf I only try to log in with the username, no connection to the ldap server will be established.\r\n(i can see this with tcpdump)\r\nHow can I force awx that everyone tries to go against the ldap server\r\n\r\n\r\n##### ENVIRONMENT\r\n<!--\r\n* AWX version: 1.0.0.550\r\n* Ansible version:  2.4.0\r\n* Operating System: Centos 7\r\n* Web Browser:\r\n-->\r\n"},{"labels":["api",null],"text":"##### ISSUE TYPE\r\n - Bug Report\r\n\r\n##### COMPONENT NAME\r\n - API\r\n\r\n##### SUMMARY\r\n\r\nAzure AD SAML uses multiple certificates at once when signing responses (https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-signing-key-rollover#other). This doesn't work with our SAML implementation.\r\n\r\n##### ADDITIONAL INFORMATION\r\n\r\n"}]